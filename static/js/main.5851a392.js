/*! For license information please see main.5851a392.js.LICENSE.txt */
!function(){var e={4505:function(e,t,n){"use strict";var r=n(1725);function i(e,t){if(e===t)return 0;for(var n=e.length,r=t.length,i=0,a=Math.min(n,r);i<a;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0}function a(e){return n.g.Buffer&&"function"===typeof n.g.Buffer.isBuffer?n.g.Buffer.isBuffer(e):!(null==e||!e._isBuffer)}var o=n(4613),s=Object.prototype.hasOwnProperty,u=Array.prototype.slice,l="foo"===function(){}.name;function c(e){return Object.prototype.toString.call(e)}function h(e){return!a(e)&&("function"===typeof n.g.ArrayBuffer&&("function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer))))}var f=e.exports=y,d=/\s*function\s+([^\(\s]*)\s*/;function p(e){if(o.isFunction(e)){if(l)return e.name;var t=e.toString().match(d);return t&&t[1]}}function v(e,t){return"string"===typeof e?e.length<t?e:e.slice(0,t):e}function m(e){if(l||!o.isFunction(e))return o.inspect(e);var t=p(e);return"[Function"+(t?": "+t:"")+"]"}function g(e,t,n,r,i){throw new f.AssertionError({message:n,actual:e,expected:t,operator:r,stackStartFunction:i})}function y(e,t){e||g(e,!0,t,"==",f.ok)}function b(e,t,n,r){if(e===t)return!0;if(a(e)&&a(t))return 0===i(e,t);if(o.isDate(e)&&o.isDate(t))return e.getTime()===t.getTime();if(o.isRegExp(e)&&o.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"===typeof e||null!==t&&"object"===typeof t){if(h(e)&&h(t)&&c(e)===c(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===i(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(a(e)!==a(t))return!1;var s=(r=r||{actual:[],expected:[]}).actual.indexOf(e);return-1!==s&&s===r.expected.indexOf(t)||(r.actual.push(e),r.expected.push(t),function(e,t,n,r){if(null===e||void 0===e||null===t||void 0===t)return!1;if(o.isPrimitive(e)||o.isPrimitive(t))return e===t;if(n&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var i=_(e),a=_(t);if(i&&!a||!i&&a)return!1;if(i)return b(e=u.call(e),t=u.call(t),n);var s,l,c=S(e),h=S(t);if(c.length!==h.length)return!1;for(c.sort(),h.sort(),l=c.length-1;l>=0;l--)if(c[l]!==h[l])return!1;for(l=c.length-1;l>=0;l--)if(!b(e[s=c[l]],t[s],n,r))return!1;return!0}(e,t,n,r))}return n?e===t:e==t}function _(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function x(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(n){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function w(e,t,n,r){var i;if("function"!==typeof t)throw new TypeError('"block" argument must be a function');"string"===typeof n&&(r=n,n=null),i=function(e){var t;try{e()}catch(n){t=n}return t}(t),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),e&&!i&&g(i,n,"Missing expected exception"+r);var a="string"===typeof r,s=!e&&i&&!n;if((!e&&o.isError(i)&&a&&x(i,n)||s)&&g(i,n,"Got unwanted exception"+r),e&&i&&n&&!x(i,n)||!e&&i)throw i}f.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=function(e){return v(m(e.actual),128)+" "+e.operator+" "+v(m(e.expected),128)}(this),this.generatedMessage=!0);var t=e.stackStartFunction||g;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var n=new Error;if(n.stack){var r=n.stack,i=p(t),a=r.indexOf("\n"+i);if(a>=0){var o=r.indexOf("\n",a+1);r=r.substring(o+1)}this.stack=r}}},o.inherits(f.AssertionError,Error),f.fail=g,f.ok=y,f.equal=function(e,t,n){e!=t&&g(e,t,n,"==",f.equal)},f.notEqual=function(e,t,n){e==t&&g(e,t,n,"!=",f.notEqual)},f.deepEqual=function(e,t,n){b(e,t,!1)||g(e,t,n,"deepEqual",f.deepEqual)},f.deepStrictEqual=function(e,t,n){b(e,t,!0)||g(e,t,n,"deepStrictEqual",f.deepStrictEqual)},f.notDeepEqual=function(e,t,n){b(e,t,!1)&&g(e,t,n,"notDeepEqual",f.notDeepEqual)},f.notDeepStrictEqual=function e(t,n,r){b(t,n,!0)&&g(t,n,r,"notDeepStrictEqual",e)},f.strictEqual=function(e,t,n){e!==t&&g(e,t,n,"===",f.strictEqual)},f.notStrictEqual=function(e,t,n){e===t&&g(e,t,n,"!==",f.notStrictEqual)},f.throws=function(e,t,n){w(!0,e,t,n)},f.doesNotThrow=function(e,t,n){w(!1,e,t,n)},f.ifError=function(e){if(e)throw e},f.strict=r((function e(t,n){t||g(t,!0,n,"==",e)}),f,{equal:f.strictEqual,deepEqual:f.deepStrictEqual,notEqual:f.notStrictEqual,notDeepEqual:f.notDeepStrictEqual}),f.strict.strict=f.strict;var S=Object.keys||function(e){var t=[];for(var n in e)s.call(e,n)&&t.push(n);return t}},9842:function(e){"function"===typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},6495:function(e){e.exports=function(e){return e&&"object"===typeof e&&"function"===typeof e.copy&&"function"===typeof e.fill&&"function"===typeof e.readUInt8}},4613:function(e,t,n){var r=/%[sdj%]/g;t.format=function(e){if(!m(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(o(arguments[n]));return t.join(" ")}n=1;for(var i=arguments,a=i.length,s=String(e).replace(r,(function(e){if("%%"===e)return"%";if(n>=a)return e;switch(e){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(t){return"[Circular]"}default:return e}})),u=i[n];n<a;u=i[++n])p(u)||!b(u)?s+=" "+u:s+=" "+o(u);return s},t.deprecate=function(e,r){if(g(n.g.process))return function(){return t.deprecate(e,r).apply(this,arguments)};if(!0===process.noDeprecation)return e;var i=!1;return function(){if(!i){if(process.throwDeprecation)throw new Error(r);process.traceDeprecation?console.trace(r):console.error(r),i=!0}return e.apply(this,arguments)}};var i,a={};function o(e,n){var r={seen:[],stylize:u};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),d(n)?r.showHidden=n:n&&t._extend(r,n),g(r.showHidden)&&(r.showHidden=!1),g(r.depth)&&(r.depth=2),g(r.colors)&&(r.colors=!1),g(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=s),l(r,e,r.depth)}function s(e,t){var n=o.styles[t];return n?"\x1b["+o.colors[n][0]+"m"+e+"\x1b["+o.colors[n][1]+"m":e}function u(e,t){return e}function l(e,n,r){if(e.customInspect&&n&&w(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,e);return m(i)||(i=l(e,i,r)),i}var a=function(e,t){if(g(t))return e.stylize("undefined","undefined");if(m(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(v(t))return e.stylize(""+t,"number");if(d(t))return e.stylize(""+t,"boolean");if(p(t))return e.stylize("null","null")}(e,n);if(a)return a;var o=Object.keys(n),s=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(n)),x(n)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return c(n);if(0===o.length){if(w(n)){var u=n.name?": "+n.name:"";return e.stylize("[Function"+u+"]","special")}if(y(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(_(n))return e.stylize(Date.prototype.toString.call(n),"date");if(x(n))return c(n)}var b,S="",M=!1,k=["{","}"];(f(n)&&(M=!0,k=["[","]"]),w(n))&&(S=" [Function"+(n.name?": "+n.name:"")+"]");return y(n)&&(S=" "+RegExp.prototype.toString.call(n)),_(n)&&(S=" "+Date.prototype.toUTCString.call(n)),x(n)&&(S=" "+c(n)),0!==o.length||M&&0!=n.length?r<0?y(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),b=M?function(e,t,n,r,i){for(var a=[],o=0,s=t.length;o<s;++o)E(t,String(o))?a.push(h(e,t,n,r,String(o),!0)):a.push("");return i.forEach((function(i){i.match(/^\d+$/)||a.push(h(e,t,n,r,i,!0))})),a}(e,n,r,s,o):o.map((function(t){return h(e,n,r,s,t,M)})),e.seen.pop(),function(e,t,n){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(b,S,k)):k[0]+S+k[1]}function c(e){return"["+Error.prototype.toString.call(e)+"]"}function h(e,t,n,r,i,a){var o,s,u;if((u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(s=e.stylize("[Setter]","special")),E(r,i)||(o="["+i+"]"),s||(e.seen.indexOf(u.value)<0?(s=p(n)?l(e,u.value,null):l(e,u.value,n-1)).indexOf("\n")>-1&&(s=a?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),g(o)){if(a&&i.match(/^\d+$/))return s;(o=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=e.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=e.stylize(o,"string"))}return o+": "+s}function f(e){return Array.isArray(e)}function d(e){return"boolean"===typeof e}function p(e){return null===e}function v(e){return"number"===typeof e}function m(e){return"string"===typeof e}function g(e){return void 0===e}function y(e){return b(e)&&"[object RegExp]"===S(e)}function b(e){return"object"===typeof e&&null!==e}function _(e){return b(e)&&"[object Date]"===S(e)}function x(e){return b(e)&&("[object Error]"===S(e)||e instanceof Error)}function w(e){return"function"===typeof e}function S(e){return Object.prototype.toString.call(e)}function M(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(g(i)&&(i={NODE_ENV:"production",PUBLIC_URL:"/MotionComparator",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.NODE_DEBUG||""),e=e.toUpperCase(),!a[e])if(new RegExp("\\b"+e+"\\b","i").test(i)){var n=process.pid;a[e]=function(){var r=t.format.apply(t,arguments);console.error("%s %d: %s",e,n,r)}}else a[e]=function(){};return a[e]},t.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=f,t.isBoolean=d,t.isNull=p,t.isNullOrUndefined=function(e){return null==e},t.isNumber=v,t.isString=m,t.isSymbol=function(e){return"symbol"===typeof e},t.isUndefined=g,t.isRegExp=y,t.isObject=b,t.isDate=_,t.isError=x,t.isFunction=w,t.isPrimitive=function(e){return null===e||"boolean"===typeof e||"number"===typeof e||"string"===typeof e||"symbol"===typeof e||"undefined"===typeof e},t.isBuffer=n(6495);var k=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function T(){var e=new Date,t=[M(e.getHours()),M(e.getMinutes()),M(e.getSeconds())].join(":");return[e.getDate(),k[e.getMonth()],t].join(" ")}function E(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",T(),t.format.apply(t,arguments))},t.inherits=n(9842),t._extend=function(e,t){if(!t||!b(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}},5524:function(e){e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=90)}({17:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r=n(18),i=function(){function e(){}return e.getFirstMatch=function(e,t){var n=t.match(e);return n&&n.length>0&&n[1]||""},e.getSecondMatch=function(e,t){var n=t.match(e);return n&&n.length>1&&n[2]||""},e.matchAndReturnConst=function(e,t,n){if(e.test(t))return n},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,n,r){void 0===r&&(r=!1);var i=e.getVersionPrecision(t),a=e.getVersionPrecision(n),o=Math.max(i,a),s=0,u=e.map([t,n],(function(t){var n=o-e.getVersionPrecision(t),r=t+new Array(n+1).join(".0");return e.map(r.split("."),(function(e){return new Array(20-e.length).join("0")+e})).reverse()}));for(r&&(s=o-Math.min(i,a)),o-=1;o>=s;){if(u[0][o]>u[1][o])return 1;if(u[0][o]===u[1][o]){if(o===s)return 0;o-=1}else if(u[0][o]<u[1][o])return-1}},e.map=function(e,t){var n,r=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(n=0;n<e.length;n+=1)r.push(t(e[n]));return r},e.find=function(e,t){var n,r;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(n=0,r=e.length;n<r;n+=1){var i=e[n];if(t(i,n))return i}},e.assign=function(e){for(var t,n,r=e,i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];if(Object.assign)return Object.assign.apply(Object,[e].concat(a));var s=function(){var e=a[t];"object"==typeof e&&null!==e&&Object.keys(e).forEach((function(t){r[t]=e[t]}))};for(t=0,n=a.length;t<n;t+=1)s();return e},e.getBrowserAlias=function(e){return r.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return r.BROWSER_MAP[e]||""},e}();t.default=i,e.exports=t.default},18:function(e,t,n){"use strict";t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(91))&&r.__esModule?r:{default:r},a=n(18);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(){}var t,n,r;return e.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw new Error("UserAgent should be a string");return new i.default(e,t)},e.parse=function(e){return new i.default(e).getResult()},t=e,r=[{key:"BROWSER_MAP",get:function(){return a.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return a.ENGINE_MAP}},{key:"OS_MAP",get:function(){return a.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return a.PLATFORMS_MAP}}],(n=null)&&o(t.prototype,n),r&&o(t,r),e}();t.default=s,e.exports=t.default},91:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r=u(n(92)),i=u(n(93)),a=u(n(94)),o=u(n(95)),s=u(n(17));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=s.default.find(r.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=s.default.find(i.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=s.default.find(a.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=s.default.find(o.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return s.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,n={},r=0,i={},a=0;if(Object.keys(e).forEach((function(t){var o=e[t];"string"==typeof o?(i[t]=o,a+=1):"object"==typeof o&&(n[t]=o,r+=1)})),r>0){var o=Object.keys(n),u=s.default.find(o,(function(e){return t.isOS(e)}));if(u){var l=this.satisfies(n[u]);if(void 0!==l)return l}var c=s.default.find(o,(function(e){return t.isPlatform(e)}));if(c){var h=this.satisfies(n[c]);if(void 0!==h)return h}}if(a>0){var f=Object.keys(i),d=s.default.find(f,(function(e){return t.isBrowser(e,!0)}));if(void 0!==d)return this.compareVersion(i[d])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var n=this.getBrowserName().toLowerCase(),r=e.toLowerCase(),i=s.default.getBrowserTypeByAlias(r);return t&&i&&(r=i.toLowerCase()),r===n},t.compareVersion=function(e){var t=[0],n=e,r=!1,i=this.getBrowserVersion();if("string"==typeof i)return">"===e[0]||"<"===e[0]?(n=e.substr(1),"="===e[1]?(r=!0,n=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?n=e.substr(1):"~"===e[0]&&(r=!0,n=e.substr(1)),t.indexOf(s.default.compareVersions(i,n,r))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e,t){return void 0===t&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some((function(e){return t.is(e)}))},e}();t.default=l,e.exports=t.default},92:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},a=/version\/(\d+(\.?_?\d+)+)/i,o=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},n=i.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},n=i.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},n=i.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},n=i.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},n=i.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var t={name:"Opera Touch"},n=i.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},n=i.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},n=i.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},n=i.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},n=i.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},n=i.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},n=i.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},n=i.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},n=i.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},n=i.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return n&&(t.version=n),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},n=i.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},n=i.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},n=i.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},n=i.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},n=i.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},n=i.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},n=i.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},n=i.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:"Miui"},n=i.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},n=i.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},n=i.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},n=i.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t={name:"Android Browser"},n=i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},n=i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},n=i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:i.default.getFirstMatch(t,e),version:i.default.getSecondMatch(t,e)}}}];t.default=o,e.exports=t.default},93:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},a=n(18),o=[{test:[/Roku\/DVP/],describe:function(e){var t=i.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:a.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=i.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:a.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=i.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),n=i.default.getWindowsVersionName(t);return{name:a.OS_MAP.Windows,version:t,versionName:n}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:a.OS_MAP.iOS},n=i.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return n&&(t.version=n),t}},{test:[/macintosh/i],describe:function(e){var t=i.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),n=i.default.getMacOSVersionName(t),r={name:a.OS_MAP.MacOS,version:t};return n&&(r.versionName=n),r}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=i.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:a.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t=i.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),n=i.default.getAndroidVersionName(t),r={name:a.OS_MAP.Android,version:t};return n&&(r.versionName=n),r}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=i.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),n={name:a.OS_MAP.WebOS};return t&&t.length&&(n.version=t),n}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=i.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||i.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||i.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:a.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=i.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:a.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=i.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:a.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:a.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:a.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=i.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:a.OS_MAP.PlayStation4,version:t}}}];t.default=o,e.exports=t.default},94:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},a=n(18),o=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=i.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",n={type:a.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(n.model=t),n}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:a.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:a.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:a.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:a.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:a.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:a.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),n=e.test(/like (ipod|iphone)/i);return t&&!n},describe:function(e){var t=i.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:a.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:a.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:a.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:a.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:a.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.tv}}}];t.default=o,e.exports=t.default},95:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},a=n(18),o=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:a.ENGINE_MAP.Blink};var t=i.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:a.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:a.ENGINE_MAP.Trident},n=i.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:a.ENGINE_MAP.Presto},n=i.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=e.test(/gecko/i),n=e.test(/like gecko/i);return t&&!n},describe:function(e){var t={name:a.ENGINE_MAP.Gecko},n=i.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:a.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:a.ENGINE_MAP.WebKit},n=i.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}}];t.default=o,e.exports=t.default}})},1694:function(e,t){var n;!function(){"use strict";var r={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var a=typeof n;if("string"===a||"number"===a)e.push(n);else if(Array.isArray(n)){if(n.length){var o=i.apply(null,n);o&&e.push(o)}}else if("object"===a){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var s in n)r.call(n,s)&&n[s]&&e.push(s)}}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(n=function(){return i}.apply(t,[]))||(e.exports=n)}()},2110:function(e,t,n){"use strict";var r=n(8309),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},a={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function u(e){return r.isMemo(e)?o:s[e.$$typeof]||i}s[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[r.Memo]=o;var l=Object.defineProperty,c=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,f=Object.getOwnPropertyDescriptor,d=Object.getPrototypeOf,p=Object.prototype;e.exports=function e(t,n,r){if("string"!==typeof n){if(p){var i=d(n);i&&i!==p&&e(t,i,r)}var o=c(n);h&&(o=o.concat(h(n)));for(var s=u(t),v=u(n),m=0;m<o.length;++m){var g=o[m];if(!a[g]&&(!r||!r[g])&&(!v||!v[g])&&(!s||!s[g])){var y=f(n,g);try{l(t,g,y)}catch(b){}}}}return t}},746:function(e,t){"use strict";var n="function"===typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,a=n?Symbol.for("react.fragment"):60107,o=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,u=n?Symbol.for("react.provider"):60109,l=n?Symbol.for("react.context"):60110,c=n?Symbol.for("react.async_mode"):60111,h=n?Symbol.for("react.concurrent_mode"):60111,f=n?Symbol.for("react.forward_ref"):60112,d=n?Symbol.for("react.suspense"):60113,p=n?Symbol.for("react.suspense_list"):60120,v=n?Symbol.for("react.memo"):60115,m=n?Symbol.for("react.lazy"):60116,g=n?Symbol.for("react.block"):60121,y=n?Symbol.for("react.fundamental"):60117,b=n?Symbol.for("react.responder"):60118,_=n?Symbol.for("react.scope"):60119;function x(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case c:case h:case a:case s:case o:case d:return e;default:switch(e=e&&e.$$typeof){case l:case f:case m:case v:case u:return e;default:return t}}case i:return t}}}function w(e){return x(e)===h}t.AsyncMode=c,t.ConcurrentMode=h,t.ContextConsumer=l,t.ContextProvider=u,t.Element=r,t.ForwardRef=f,t.Fragment=a,t.Lazy=m,t.Memo=v,t.Portal=i,t.Profiler=s,t.StrictMode=o,t.Suspense=d,t.isAsyncMode=function(e){return w(e)||x(e)===c},t.isConcurrentMode=w,t.isContextConsumer=function(e){return x(e)===l},t.isContextProvider=function(e){return x(e)===u},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return x(e)===f},t.isFragment=function(e){return x(e)===a},t.isLazy=function(e){return x(e)===m},t.isMemo=function(e){return x(e)===v},t.isPortal=function(e){return x(e)===i},t.isProfiler=function(e){return x(e)===s},t.isStrictMode=function(e){return x(e)===o},t.isSuspense=function(e){return x(e)===d},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===a||e===h||e===s||e===o||e===d||e===p||"object"===typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===v||e.$$typeof===u||e.$$typeof===l||e.$$typeof===f||e.$$typeof===y||e.$$typeof===b||e.$$typeof===_||e.$$typeof===g)},t.typeOf=x},8309:function(e,t,n){"use strict";e.exports=n(746)},908:function(e,t,n){var r=n(8136)(n(7009),"DataView");e.exports=r},9676:function(e,t,n){var r=n(5403),i=n(2747),a=n(6037),o=n(4154),s=n(7728);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=a,u.prototype.has=o,u.prototype.set=s,e.exports=u},8384:function(e,t,n){var r=n(3894),i=n(8699),a=n(4957),o=n(7184),s=n(7109);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=a,u.prototype.has=o,u.prototype.set=s,e.exports=u},5797:function(e,t,n){var r=n(8136)(n(7009),"Map");e.exports=r},8059:function(e,t,n){var r=n(4086),i=n(9255),a=n(9186),o=n(3423),s=n(3739);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=a,u.prototype.has=o,u.prototype.set=s,e.exports=u},8319:function(e,t,n){var r=n(8136)(n(7009),"Promise");e.exports=r},3924:function(e,t,n){var r=n(8136)(n(7009),"Set");e.exports=r},692:function(e,t,n){var r=n(8059),i=n(5774),a=n(1596);function o(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}o.prototype.add=o.prototype.push=i,o.prototype.has=a,e.exports=o},2854:function(e,t,n){var r=n(8384),i=n(511),a=n(835),o=n(707),s=n(8832),u=n(5077);function l(e){var t=this.__data__=new r(e);this.size=t.size}l.prototype.clear=i,l.prototype.delete=a,l.prototype.get=o,l.prototype.has=s,l.prototype.set=u,e.exports=l},7197:function(e,t,n){var r=n(7009).Symbol;e.exports=r},6219:function(e,t,n){var r=n(7009).Uint8Array;e.exports=r},7091:function(e,t,n){var r=n(8136)(n(7009),"WeakMap");e.exports=r},4903:function(e){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,a=[];++n<r;){var o=e[n];t(o,n,e)&&(a[i++]=o)}return a}},7538:function(e,t,n){var r=n(6478),i=n(4963),a=n(3629),o=n(5174),s=n(6800),u=n(9102),l=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=a(e),c=!n&&i(e),h=!n&&!c&&o(e),f=!n&&!c&&!h&&u(e),d=n||c||h||f,p=d?r(e.length,String):[],v=p.length;for(var m in e)!t&&!l.call(e,m)||d&&("length"==m||h&&("offset"==m||"parent"==m)||f&&("buffer"==m||"byteLength"==m||"byteOffset"==m)||s(m,v))||p.push(m);return p}},1705:function(e){e.exports=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}},7897:function(e){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},7112:function(e,t,n){var r=n(9231);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},1986:function(e,t,n){var r=n(1705),i=n(3629);e.exports=function(e,t,n){var a=t(e);return i(e)?a:r(a,n(e))}},9066:function(e,t,n){var r=n(7197),i=n(1587),a=n(3581),o=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":o&&o in Object(e)?i(e):a(e)}},4906:function(e,t,n){var r=n(9066),i=n(3141);e.exports=function(e){return i(e)&&"[object Arguments]"==r(e)}},1848:function(e,t,n){var r=n(3355),i=n(3141);e.exports=function e(t,n,a,o,s){return t===n||(null==t||null==n||!i(t)&&!i(n)?t!==t&&n!==n:r(t,n,a,o,e,s))}},3355:function(e,t,n){var r=n(2854),i=n(5305),a=n(2206),o=n(8078),s=n(8383),u=n(3629),l=n(5174),c=n(9102),h="[object Arguments]",f="[object Array]",d="[object Object]",p=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,v,m,g){var y=u(e),b=u(t),_=y?f:s(e),x=b?f:s(t),w=(_=_==h?d:_)==d,S=(x=x==h?d:x)==d,M=_==x;if(M&&l(e)){if(!l(t))return!1;y=!0,w=!1}if(M&&!w)return g||(g=new r),y||c(e)?i(e,t,n,v,m,g):a(e,t,_,n,v,m,g);if(!(1&n)){var k=w&&p.call(e,"__wrapped__"),T=S&&p.call(t,"__wrapped__");if(k||T){var E=k?e.value():e,C=T?t.value():t;return g||(g=new r),m(E,C,n,v,g)}}return!!M&&(g||(g=new r),o(e,t,n,v,m,g))}},6703:function(e,t,n){var r=n(4786),i=n(257),a=n(8092),o=n(7907),s=/^\[object .+?Constructor\]$/,u=Function.prototype,l=Object.prototype,c=u.toString,h=l.hasOwnProperty,f=RegExp("^"+c.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!a(e)||i(e))&&(r(e)?f:s).test(o(e))}},8150:function(e,t,n){var r=n(9066),i=n(4635),a=n(3141),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1,e.exports=function(e){return a(e)&&i(e.length)&&!!o[r(e)]}},3654:function(e,t,n){var r=n(2936),i=n(8836),a=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=[];for(var n in Object(e))a.call(e,n)&&"constructor"!=n&&t.push(n);return t}},6478:function(e){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},821:function(e,t,n){var r=n(6050),i=/^\s+/;e.exports=function(e){return e?e.slice(0,r(e)+1).replace(i,""):e}},6194:function(e){e.exports=function(e){return function(t){return e(t)}}},75:function(e){e.exports=function(e,t){return e.has(t)}},5525:function(e,t,n){var r=n(7009)["__core-js_shared__"];e.exports=r},5305:function(e,t,n){var r=n(692),i=n(7897),a=n(75);e.exports=function(e,t,n,o,s,u){var l=1&n,c=e.length,h=t.length;if(c!=h&&!(l&&h>c))return!1;var f=u.get(e),d=u.get(t);if(f&&d)return f==t&&d==e;var p=-1,v=!0,m=2&n?new r:void 0;for(u.set(e,t),u.set(t,e);++p<c;){var g=e[p],y=t[p];if(o)var b=l?o(y,g,p,t,e,u):o(g,y,p,e,t,u);if(void 0!==b){if(b)continue;v=!1;break}if(m){if(!i(t,(function(e,t){if(!a(m,t)&&(g===e||s(g,e,n,o,u)))return m.push(t)}))){v=!1;break}}else if(g!==y&&!s(g,y,n,o,u)){v=!1;break}}return u.delete(e),u.delete(t),v}},2206:function(e,t,n){var r=n(7197),i=n(6219),a=n(9231),o=n(5305),s=n(234),u=n(2230),l=r?r.prototype:void 0,c=l?l.valueOf:void 0;e.exports=function(e,t,n,r,l,h,f){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!h(new i(e),new i(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return a(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var d=s;case"[object Set]":var p=1&r;if(d||(d=u),e.size!=t.size&&!p)return!1;var v=f.get(e);if(v)return v==t;r|=2,f.set(e,t);var m=o(d(e),d(t),r,l,h,f);return f.delete(e),m;case"[object Symbol]":if(c)return c.call(e)==c.call(t)}return!1}},8078:function(e,t,n){var r=n(8248),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,a,o,s){var u=1&n,l=r(e),c=l.length;if(c!=r(t).length&&!u)return!1;for(var h=c;h--;){var f=l[h];if(!(u?f in t:i.call(t,f)))return!1}var d=s.get(e),p=s.get(t);if(d&&p)return d==t&&p==e;var v=!0;s.set(e,t),s.set(t,e);for(var m=u;++h<c;){var g=e[f=l[h]],y=t[f];if(a)var b=u?a(y,g,f,t,e,s):a(g,y,f,e,t,s);if(!(void 0===b?g===y||o(g,y,n,a,s):b)){v=!1;break}m||(m="constructor"==f)}if(v&&!m){var _=e.constructor,x=t.constructor;_==x||!("constructor"in e)||!("constructor"in t)||"function"==typeof _&&_ instanceof _&&"function"==typeof x&&x instanceof x||(v=!1)}return s.delete(e),s.delete(t),v}},1032:function(e,t,n){var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=r},8248:function(e,t,n){var r=n(1986),i=n(5918),a=n(2742);e.exports=function(e){return r(e,a,i)}},2799:function(e,t,n){var r=n(5964);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},8136:function(e,t,n){var r=n(6703),i=n(40);e.exports=function(e,t){var n=i(e,t);return r(n)?n:void 0}},1587:function(e,t,n){var r=n(7197),i=Object.prototype,a=i.hasOwnProperty,o=i.toString,s=r?r.toStringTag:void 0;e.exports=function(e){var t=a.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(u){}var i=o.call(e);return r&&(t?e[s]=n:delete e[s]),i}},5918:function(e,t,n){var r=n(4903),i=n(8174),a=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols,s=o?function(e){return null==e?[]:(e=Object(e),r(o(e),(function(t){return a.call(e,t)})))}:i;e.exports=s},8383:function(e,t,n){var r=n(908),i=n(5797),a=n(8319),o=n(3924),s=n(7091),u=n(9066),l=n(7907),c="[object Map]",h="[object Promise]",f="[object Set]",d="[object WeakMap]",p="[object DataView]",v=l(r),m=l(i),g=l(a),y=l(o),b=l(s),_=u;(r&&_(new r(new ArrayBuffer(1)))!=p||i&&_(new i)!=c||a&&_(a.resolve())!=h||o&&_(new o)!=f||s&&_(new s)!=d)&&(_=function(e){var t=u(e),n="[object Object]"==t?e.constructor:void 0,r=n?l(n):"";if(r)switch(r){case v:return p;case m:return c;case g:return h;case y:return f;case b:return d}return t}),e.exports=_},40:function(e){e.exports=function(e,t){return null==e?void 0:e[t]}},5403:function(e,t,n){var r=n(9620);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},2747:function(e){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},6037:function(e,t,n){var r=n(9620),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return i.call(t,e)?t[e]:void 0}},4154:function(e,t,n){var r=n(9620),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:i.call(t,e)}},7728:function(e,t,n){var r=n(9620);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},6800:function(e){var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,n){var r=typeof e;return!!(n=null==n?9007199254740991:n)&&("number"==r||"symbol"!=r&&t.test(e))&&e>-1&&e%1==0&&e<n}},5964:function(e){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},257:function(e,t,n){var r=n(5525),i=function(){var e=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=function(e){return!!i&&i in e}},2936:function(e){var t=Object.prototype;e.exports=function(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||t)}},3894:function(e){e.exports=function(){this.__data__=[],this.size=0}},8699:function(e,t,n){var r=n(7112),i=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0)&&(n==t.length-1?t.pop():i.call(t,n,1),--this.size,!0)}},4957:function(e,t,n){var r=n(7112);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},7184:function(e,t,n){var r=n(7112);e.exports=function(e){return r(this.__data__,e)>-1}},7109:function(e,t,n){var r=n(7112);e.exports=function(e,t){var n=this.__data__,i=r(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}},4086:function(e,t,n){var r=n(9676),i=n(8384),a=n(5797);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(a||i),string:new r}}},9255:function(e,t,n){var r=n(2799);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},9186:function(e,t,n){var r=n(2799);e.exports=function(e){return r(this,e).get(e)}},3423:function(e,t,n){var r=n(2799);e.exports=function(e){return r(this,e).has(e)}},3739:function(e,t,n){var r=n(2799);e.exports=function(e,t){var n=r(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}},234:function(e){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}},9620:function(e,t,n){var r=n(8136)(Object,"create");e.exports=r},8836:function(e,t,n){var r=n(2709)(Object.keys,Object);e.exports=r},9494:function(e,t,n){e=n.nmd(e);var r=n(1032),i=t&&!t.nodeType&&t,a=i&&e&&!e.nodeType&&e,o=a&&a.exports===i&&r.process,s=function(){try{var e=a&&a.require&&a.require("util").types;return e||o&&o.binding&&o.binding("util")}catch(t){}}();e.exports=s},3581:function(e){var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},2709:function(e){e.exports=function(e,t){return function(n){return e(t(n))}}},7009:function(e,t,n){var r=n(1032),i="object"==typeof self&&self&&self.Object===Object&&self,a=r||i||Function("return this")();e.exports=a},5774:function(e){e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},1596:function(e){e.exports=function(e){return this.__data__.has(e)}},2230:function(e){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}},511:function(e,t,n){var r=n(8384);e.exports=function(){this.__data__=new r,this.size=0}},835:function(e){e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},707:function(e){e.exports=function(e){return this.__data__.get(e)}},8832:function(e){e.exports=function(e){return this.__data__.has(e)}},5077:function(e,t,n){var r=n(8384),i=n(5797),a=n(8059);e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var o=n.__data__;if(!i||o.length<199)return o.push([e,t]),this.size=++n.size,this;n=this.__data__=new a(o)}return n.set(e,t),this.size=n.size,this}},7907:function(e){var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(n){}try{return e+""}catch(n){}}return""}},6050:function(e){var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},8573:function(e,t,n){var r=n(8092),i=n(72),a=n(2582),o=Math.max,s=Math.min;e.exports=function(e,t,n){var u,l,c,h,f,d,p=0,v=!1,m=!1,g=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var n=u,r=l;return u=l=void 0,p=t,h=e.apply(r,n)}function b(e){return p=e,f=setTimeout(x,t),v?y(e):h}function _(e){var n=e-d;return void 0===d||n>=t||n<0||m&&e-p>=c}function x(){var e=i();if(_(e))return w(e);f=setTimeout(x,function(e){var n=t-(e-d);return m?s(n,c-(e-p)):n}(e))}function w(e){return f=void 0,g&&u?y(e):(u=l=void 0,h)}function S(){var e=i(),n=_(e);if(u=arguments,l=this,d=e,n){if(void 0===f)return b(d);if(m)return clearTimeout(f),f=setTimeout(x,t),y(d)}return void 0===f&&(f=setTimeout(x,t)),h}return t=a(t)||0,r(n)&&(v=!!n.leading,c=(m="maxWait"in n)?o(a(n.maxWait)||0,t):c,g="trailing"in n?!!n.trailing:g),S.cancel=function(){void 0!==f&&clearTimeout(f),p=0,u=d=l=f=void 0},S.flush=function(){return void 0===f?h:w(i())},S}},9231:function(e){e.exports=function(e,t){return e===t||e!==e&&t!==t}},4963:function(e,t,n){var r=n(4906),i=n(3141),a=Object.prototype,o=a.hasOwnProperty,s=a.propertyIsEnumerable,u=r(function(){return arguments}())?r:function(e){return i(e)&&o.call(e,"callee")&&!s.call(e,"callee")};e.exports=u},3629:function(e){var t=Array.isArray;e.exports=t},1473:function(e,t,n){var r=n(4786),i=n(4635);e.exports=function(e){return null!=e&&i(e.length)&&!r(e)}},5174:function(e,t,n){e=n.nmd(e);var r=n(7009),i=n(9488),a=t&&!t.nodeType&&t,o=a&&e&&!e.nodeType&&e,s=o&&o.exports===a?r.Buffer:void 0,u=(s?s.isBuffer:void 0)||i;e.exports=u},8111:function(e,t,n){var r=n(1848);e.exports=function(e,t){return r(e,t)}},4786:function(e,t,n){var r=n(9066),i=n(8092);e.exports=function(e){if(!i(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},4635:function(e){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},8092:function(e){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},3141:function(e){e.exports=function(e){return null!=e&&"object"==typeof e}},152:function(e,t,n){var r=n(9066),i=n(3141);e.exports=function(e){return"symbol"==typeof e||i(e)&&"[object Symbol]"==r(e)}},9102:function(e,t,n){var r=n(8150),i=n(6194),a=n(9494),o=a&&a.isTypedArray,s=o?i(o):r;e.exports=s},2742:function(e,t,n){var r=n(7538),i=n(3654),a=n(1473);e.exports=function(e){return a(e)?r(e):i(e)}},763:function(e,t,n){var r;e=n.nmd(e),function(){var i,a="Expected a function",o="__lodash_hash_undefined__",s="__lodash_placeholder__",u=16,l=32,c=64,h=128,f=256,d=1/0,p=9007199254740991,v=NaN,m=4294967295,g=[["ary",h],["bind",1],["bindKey",2],["curry",8],["curryRight",u],["flip",512],["partial",l],["partialRight",c],["rearg",f]],y="[object Arguments]",b="[object Array]",_="[object Boolean]",x="[object Date]",w="[object Error]",S="[object Function]",M="[object GeneratorFunction]",k="[object Map]",T="[object Number]",E="[object Object]",C="[object Promise]",A="[object RegExp]",R="[object Set]",P="[object String]",L="[object Symbol]",D="[object WeakMap]",N="[object ArrayBuffer]",I="[object DataView]",O="[object Float32Array]",U="[object Float64Array]",F="[object Int8Array]",z="[object Int16Array]",B="[object Int32Array]",V="[object Uint8Array]",G="[object Uint8ClampedArray]",j="[object Uint16Array]",H="[object Uint32Array]",W=/\b__p \+= '';/g,Z=/\b(__p \+=) '' \+/g,q=/(__e\(.*?\)|\b__t\)) \+\n'';/g,X=/&(?:amp|lt|gt|quot|#39);/g,Y=/[&<>"']/g,K=RegExp(X.source),J=RegExp(Y.source),Q=/<%-([\s\S]+?)%>/g,$=/<%([\s\S]+?)%>/g,ee=/<%=([\s\S]+?)%>/g,te=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ne=/^\w*$/,re=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ie=/[\\^$.*+?()[\]{}|]/g,ae=RegExp(ie.source),oe=/^\s+/,se=/\s/,ue=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,le=/\{\n\/\* \[wrapped with (.+)\] \*/,ce=/,? & /,he=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,fe=/[()=,{}\[\]\/\s]/,de=/\\(\\)?/g,pe=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ve=/\w*$/,me=/^[-+]0x[0-9a-f]+$/i,ge=/^0b[01]+$/i,ye=/^\[object .+?Constructor\]$/,be=/^0o[0-7]+$/i,_e=/^(?:0|[1-9]\d*)$/,xe=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,we=/($^)/,Se=/['\n\r\u2028\u2029\\]/g,Me="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",ke="\\u2700-\\u27bf",Te="a-z\\xdf-\\xf6\\xf8-\\xff",Ee="A-Z\\xc0-\\xd6\\xd8-\\xde",Ce="\\ufe0e\\ufe0f",Ae="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Re="['\u2019]",Pe="[\\ud800-\\udfff]",Le="["+Ae+"]",De="["+Me+"]",Ne="\\d+",Ie="[\\u2700-\\u27bf]",Oe="["+Te+"]",Ue="[^\\ud800-\\udfff"+Ae+Ne+ke+Te+Ee+"]",Fe="\\ud83c[\\udffb-\\udfff]",ze="[^\\ud800-\\udfff]",Be="(?:\\ud83c[\\udde6-\\uddff]){2}",Ve="[\\ud800-\\udbff][\\udc00-\\udfff]",Ge="["+Ee+"]",je="(?:"+Oe+"|"+Ue+")",He="(?:"+Ge+"|"+Ue+")",We="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",Ze="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",qe="(?:"+De+"|"+Fe+")"+"?",Xe="[\\ufe0e\\ufe0f]?",Ye=Xe+qe+("(?:\\u200d(?:"+[ze,Be,Ve].join("|")+")"+Xe+qe+")*"),Ke="(?:"+[Ie,Be,Ve].join("|")+")"+Ye,Je="(?:"+[ze+De+"?",De,Be,Ve,Pe].join("|")+")",Qe=RegExp(Re,"g"),$e=RegExp(De,"g"),et=RegExp(Fe+"(?="+Fe+")|"+Je+Ye,"g"),tt=RegExp([Ge+"?"+Oe+"+"+We+"(?="+[Le,Ge,"$"].join("|")+")",He+"+"+Ze+"(?="+[Le,Ge+je,"$"].join("|")+")",Ge+"?"+je+"+"+We,Ge+"+"+Ze,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ne,Ke].join("|"),"g"),nt=RegExp("[\\u200d\\ud800-\\udfff"+Me+Ce+"]"),rt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,it=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],at=-1,ot={};ot[O]=ot[U]=ot[F]=ot[z]=ot[B]=ot[V]=ot[G]=ot[j]=ot[H]=!0,ot[y]=ot[b]=ot[N]=ot[_]=ot[I]=ot[x]=ot[w]=ot[S]=ot[k]=ot[T]=ot[E]=ot[A]=ot[R]=ot[P]=ot[D]=!1;var st={};st[y]=st[b]=st[N]=st[I]=st[_]=st[x]=st[O]=st[U]=st[F]=st[z]=st[B]=st[k]=st[T]=st[E]=st[A]=st[R]=st[P]=st[L]=st[V]=st[G]=st[j]=st[H]=!0,st[w]=st[S]=st[D]=!1;var ut={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},lt=parseFloat,ct=parseInt,ht="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,ft="object"==typeof self&&self&&self.Object===Object&&self,dt=ht||ft||Function("return this")(),pt=t&&!t.nodeType&&t,vt=pt&&e&&!e.nodeType&&e,mt=vt&&vt.exports===pt,gt=mt&&ht.process,yt=function(){try{var e=vt&&vt.require&&vt.require("util").types;return e||gt&&gt.binding&&gt.binding("util")}catch(t){}}(),bt=yt&&yt.isArrayBuffer,_t=yt&&yt.isDate,xt=yt&&yt.isMap,wt=yt&&yt.isRegExp,St=yt&&yt.isSet,Mt=yt&&yt.isTypedArray;function kt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function Tt(e,t,n,r){for(var i=-1,a=null==e?0:e.length;++i<a;){var o=e[i];t(r,o,n(o),e)}return r}function Et(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function Ct(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function At(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function Rt(e,t){for(var n=-1,r=null==e?0:e.length,i=0,a=[];++n<r;){var o=e[n];t(o,n,e)&&(a[i++]=o)}return a}function Pt(e,t){return!!(null==e?0:e.length)&&Vt(e,t,0)>-1}function Lt(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function Dt(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function Nt(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function It(e,t,n,r){var i=-1,a=null==e?0:e.length;for(r&&a&&(n=e[++i]);++i<a;)n=t(n,e[i],i,e);return n}function Ot(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function Ut(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var Ft=Wt("length");function zt(e,t,n){var r;return n(e,(function(e,n,i){if(t(e,n,i))return r=n,!1})),r}function Bt(e,t,n,r){for(var i=e.length,a=n+(r?1:-1);r?a--:++a<i;)if(t(e[a],a,e))return a;return-1}function Vt(e,t,n){return t===t?function(e,t,n){var r=n-1,i=e.length;for(;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):Bt(e,jt,n)}function Gt(e,t,n,r){for(var i=n-1,a=e.length;++i<a;)if(r(e[i],t))return i;return-1}function jt(e){return e!==e}function Ht(e,t){var n=null==e?0:e.length;return n?Xt(e,t)/n:v}function Wt(e){return function(t){return null==t?i:t[e]}}function Zt(e){return function(t){return null==e?i:e[t]}}function qt(e,t,n,r,i){return i(e,(function(e,i,a){n=r?(r=!1,e):t(n,e,i,a)})),n}function Xt(e,t){for(var n,r=-1,a=e.length;++r<a;){var o=t(e[r]);o!==i&&(n=n===i?o:n+o)}return n}function Yt(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function Kt(e){return e?e.slice(0,vn(e)+1).replace(oe,""):e}function Jt(e){return function(t){return e(t)}}function Qt(e,t){return Dt(t,(function(t){return e[t]}))}function $t(e,t){return e.has(t)}function en(e,t){for(var n=-1,r=e.length;++n<r&&Vt(t,e[n],0)>-1;);return n}function tn(e,t){for(var n=e.length;n--&&Vt(t,e[n],0)>-1;);return n}function nn(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}var rn=Zt({"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xdd":"Y","\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss","\u0100":"A","\u0102":"A","\u0104":"A","\u0101":"a","\u0103":"a","\u0105":"a","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\u010e":"D","\u0110":"D","\u010f":"d","\u0111":"d","\u0112":"E","\u0114":"E","\u0116":"E","\u0118":"E","\u011a":"E","\u0113":"e","\u0115":"e","\u0117":"e","\u0119":"e","\u011b":"e","\u011c":"G","\u011e":"G","\u0120":"G","\u0122":"G","\u011d":"g","\u011f":"g","\u0121":"g","\u0123":"g","\u0124":"H","\u0126":"H","\u0125":"h","\u0127":"h","\u0128":"I","\u012a":"I","\u012c":"I","\u012e":"I","\u0130":"I","\u0129":"i","\u012b":"i","\u012d":"i","\u012f":"i","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u0138":"k","\u0139":"L","\u013b":"L","\u013d":"L","\u013f":"L","\u0141":"L","\u013a":"l","\u013c":"l","\u013e":"l","\u0140":"l","\u0142":"l","\u0143":"N","\u0145":"N","\u0147":"N","\u014a":"N","\u0144":"n","\u0146":"n","\u0148":"n","\u014b":"n","\u014c":"O","\u014e":"O","\u0150":"O","\u014d":"o","\u014f":"o","\u0151":"o","\u0154":"R","\u0156":"R","\u0158":"R","\u0155":"r","\u0157":"r","\u0159":"r","\u015a":"S","\u015c":"S","\u015e":"S","\u0160":"S","\u015b":"s","\u015d":"s","\u015f":"s","\u0161":"s","\u0162":"T","\u0164":"T","\u0166":"T","\u0163":"t","\u0165":"t","\u0167":"t","\u0168":"U","\u016a":"U","\u016c":"U","\u016e":"U","\u0170":"U","\u0172":"U","\u0169":"u","\u016b":"u","\u016d":"u","\u016f":"u","\u0171":"u","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017b":"Z","\u017d":"Z","\u017a":"z","\u017c":"z","\u017e":"z","\u0132":"IJ","\u0133":"ij","\u0152":"Oe","\u0153":"oe","\u0149":"'n","\u017f":"s"}),an=Zt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function on(e){return"\\"+ut[e]}function sn(e){return nt.test(e)}function un(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function ln(e,t){return function(n){return e(t(n))}}function cn(e,t){for(var n=-1,r=e.length,i=0,a=[];++n<r;){var o=e[n];o!==t&&o!==s||(e[n]=s,a[i++]=n)}return a}function hn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function fn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}function dn(e){return sn(e)?function(e){var t=et.lastIndex=0;for(;et.test(e);)++t;return t}(e):Ft(e)}function pn(e){return sn(e)?function(e){return e.match(et)||[]}(e):function(e){return e.split("")}(e)}function vn(e){for(var t=e.length;t--&&se.test(e.charAt(t)););return t}var mn=Zt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var gn=function e(t){var n=(t=null==t?dt:gn.defaults(dt.Object(),t,gn.pick(dt,it))).Array,r=t.Date,se=t.Error,Me=t.Function,ke=t.Math,Te=t.Object,Ee=t.RegExp,Ce=t.String,Ae=t.TypeError,Re=n.prototype,Pe=Me.prototype,Le=Te.prototype,De=t["__core-js_shared__"],Ne=Pe.toString,Ie=Le.hasOwnProperty,Oe=0,Ue=function(){var e=/[^.]+$/.exec(De&&De.keys&&De.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Fe=Le.toString,ze=Ne.call(Te),Be=dt._,Ve=Ee("^"+Ne.call(Ie).replace(ie,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ge=mt?t.Buffer:i,je=t.Symbol,He=t.Uint8Array,We=Ge?Ge.allocUnsafe:i,Ze=ln(Te.getPrototypeOf,Te),qe=Te.create,Xe=Le.propertyIsEnumerable,Ye=Re.splice,Ke=je?je.isConcatSpreadable:i,Je=je?je.iterator:i,et=je?je.toStringTag:i,nt=function(){try{var e=fa(Te,"defineProperty");return e({},"",{}),e}catch(t){}}(),ut=t.clearTimeout!==dt.clearTimeout&&t.clearTimeout,ht=r&&r.now!==dt.Date.now&&r.now,ft=t.setTimeout!==dt.setTimeout&&t.setTimeout,pt=ke.ceil,vt=ke.floor,gt=Te.getOwnPropertySymbols,yt=Ge?Ge.isBuffer:i,Ft=t.isFinite,Zt=Re.join,yn=ln(Te.keys,Te),bn=ke.max,_n=ke.min,xn=r.now,wn=t.parseInt,Sn=ke.random,Mn=Re.reverse,kn=fa(t,"DataView"),Tn=fa(t,"Map"),En=fa(t,"Promise"),Cn=fa(t,"Set"),An=fa(t,"WeakMap"),Rn=fa(Te,"create"),Pn=An&&new An,Ln={},Dn=za(kn),Nn=za(Tn),In=za(En),On=za(Cn),Un=za(An),Fn=je?je.prototype:i,zn=Fn?Fn.valueOf:i,Bn=Fn?Fn.toString:i;function Vn(e){if(rs(e)&&!Zo(e)&&!(e instanceof Wn)){if(e instanceof Hn)return e;if(Ie.call(e,"__wrapped__"))return Ba(e)}return new Hn(e)}var Gn=function(){function e(){}return function(t){if(!ns(t))return{};if(qe)return qe(t);e.prototype=t;var n=new e;return e.prototype=i,n}}();function jn(){}function Hn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=i}function Wn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=m,this.__views__=[]}function Zn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function qn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Xn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Yn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Xn;++t<n;)this.add(e[t])}function Kn(e){var t=this.__data__=new qn(e);this.size=t.size}function Jn(e,t){var n=Zo(e),r=!n&&Wo(e),i=!n&&!r&&Ko(e),a=!n&&!r&&!i&&hs(e),o=n||r||i||a,s=o?Yt(e.length,Ce):[],u=s.length;for(var l in e)!t&&!Ie.call(e,l)||o&&("length"==l||i&&("offset"==l||"parent"==l)||a&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||ba(l,u))||s.push(l);return s}function Qn(e){var t=e.length;return t?e[Yr(0,t-1)]:i}function $n(e,t){return Oa(Ri(e),ur(t,0,e.length))}function er(e){return Oa(Ri(e))}function tr(e,t,n){(n!==i&&!Go(e[t],n)||n===i&&!(t in e))&&or(e,t,n)}function nr(e,t,n){var r=e[t];Ie.call(e,t)&&Go(r,n)&&(n!==i||t in e)||or(e,t,n)}function rr(e,t){for(var n=e.length;n--;)if(Go(e[n][0],t))return n;return-1}function ir(e,t,n,r){return dr(e,(function(e,i,a){t(r,e,n(e),a)})),r}function ar(e,t){return e&&Pi(t,Ds(t),e)}function or(e,t,n){"__proto__"==t&&nt?nt(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function sr(e,t){for(var r=-1,a=t.length,o=n(a),s=null==e;++r<a;)o[r]=s?i:Cs(e,t[r]);return o}function ur(e,t,n){return e===e&&(n!==i&&(e=e<=n?e:n),t!==i&&(e=e>=t?e:t)),e}function lr(e,t,n,r,a,o){var s,u=1&t,l=2&t,c=4&t;if(n&&(s=a?n(e,r,a,o):n(e)),s!==i)return s;if(!ns(e))return e;var h=Zo(e);if(h){if(s=function(e){var t=e.length,n=new e.constructor(t);t&&"string"==typeof e[0]&&Ie.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(e),!u)return Ri(e,s)}else{var f=va(e),d=f==S||f==M;if(Ko(e))return Mi(e,u);if(f==E||f==y||d&&!a){if(s=l||d?{}:ga(e),!u)return l?function(e,t){return Pi(e,pa(e),t)}(e,function(e,t){return e&&Pi(t,Ns(t),e)}(s,e)):function(e,t){return Pi(e,da(e),t)}(e,ar(s,e))}else{if(!st[f])return a?e:{};s=function(e,t,n){var r=e.constructor;switch(t){case N:return ki(e);case _:case x:return new r(+e);case I:return function(e,t){var n=t?ki(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case O:case U:case F:case z:case B:case V:case G:case j:case H:return Ti(e,n);case k:return new r;case T:case P:return new r(e);case A:return function(e){var t=new e.constructor(e.source,ve.exec(e));return t.lastIndex=e.lastIndex,t}(e);case R:return new r;case L:return i=e,zn?Te(zn.call(i)):{}}var i}(e,f,u)}}o||(o=new Kn);var p=o.get(e);if(p)return p;o.set(e,s),us(e)?e.forEach((function(r){s.add(lr(r,t,n,r,e,o))})):is(e)&&e.forEach((function(r,i){s.set(i,lr(r,t,n,i,e,o))}));var v=h?i:(c?l?aa:ia:l?Ns:Ds)(e);return Et(v||e,(function(r,i){v&&(r=e[i=r]),nr(s,i,lr(r,t,n,i,e,o))})),s}function cr(e,t,n){var r=n.length;if(null==e)return!r;for(e=Te(e);r--;){var a=n[r],o=t[a],s=e[a];if(s===i&&!(a in e)||!o(s))return!1}return!0}function hr(e,t,n){if("function"!=typeof e)throw new Ae(a);return La((function(){e.apply(i,n)}),t)}function fr(e,t,n,r){var i=-1,a=Pt,o=!0,s=e.length,u=[],l=t.length;if(!s)return u;n&&(t=Dt(t,Jt(n))),r?(a=Lt,o=!1):t.length>=200&&(a=$t,o=!1,t=new Yn(t));e:for(;++i<s;){var c=e[i],h=null==n?c:n(c);if(c=r||0!==c?c:0,o&&h===h){for(var f=l;f--;)if(t[f]===h)continue e;u.push(c)}else a(t,h,r)||u.push(c)}return u}Vn.templateSettings={escape:Q,evaluate:$,interpolate:ee,variable:"",imports:{_:Vn}},Vn.prototype=jn.prototype,Vn.prototype.constructor=Vn,Hn.prototype=Gn(jn.prototype),Hn.prototype.constructor=Hn,Wn.prototype=Gn(jn.prototype),Wn.prototype.constructor=Wn,Zn.prototype.clear=function(){this.__data__=Rn?Rn(null):{},this.size=0},Zn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Zn.prototype.get=function(e){var t=this.__data__;if(Rn){var n=t[e];return n===o?i:n}return Ie.call(t,e)?t[e]:i},Zn.prototype.has=function(e){var t=this.__data__;return Rn?t[e]!==i:Ie.call(t,e)},Zn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Rn&&t===i?o:t,this},qn.prototype.clear=function(){this.__data__=[],this.size=0},qn.prototype.delete=function(e){var t=this.__data__,n=rr(t,e);return!(n<0)&&(n==t.length-1?t.pop():Ye.call(t,n,1),--this.size,!0)},qn.prototype.get=function(e){var t=this.__data__,n=rr(t,e);return n<0?i:t[n][1]},qn.prototype.has=function(e){return rr(this.__data__,e)>-1},qn.prototype.set=function(e,t){var n=this.__data__,r=rr(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Xn.prototype.clear=function(){this.size=0,this.__data__={hash:new Zn,map:new(Tn||qn),string:new Zn}},Xn.prototype.delete=function(e){var t=ca(this,e).delete(e);return this.size-=t?1:0,t},Xn.prototype.get=function(e){return ca(this,e).get(e)},Xn.prototype.has=function(e){return ca(this,e).has(e)},Xn.prototype.set=function(e,t){var n=ca(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Yn.prototype.add=Yn.prototype.push=function(e){return this.__data__.set(e,o),this},Yn.prototype.has=function(e){return this.__data__.has(e)},Kn.prototype.clear=function(){this.__data__=new qn,this.size=0},Kn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Kn.prototype.get=function(e){return this.__data__.get(e)},Kn.prototype.has=function(e){return this.__data__.has(e)},Kn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof qn){var r=n.__data__;if(!Tn||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Xn(r)}return n.set(e,t),this.size=n.size,this};var dr=Ni(xr),pr=Ni(wr,!0);function vr(e,t){var n=!0;return dr(e,(function(e,r,i){return n=!!t(e,r,i)})),n}function mr(e,t,n){for(var r=-1,a=e.length;++r<a;){var o=e[r],s=t(o);if(null!=s&&(u===i?s===s&&!cs(s):n(s,u)))var u=s,l=o}return l}function gr(e,t){var n=[];return dr(e,(function(e,r,i){t(e,r,i)&&n.push(e)})),n}function yr(e,t,n,r,i){var a=-1,o=e.length;for(n||(n=ya),i||(i=[]);++a<o;){var s=e[a];t>0&&n(s)?t>1?yr(s,t-1,n,r,i):Nt(i,s):r||(i[i.length]=s)}return i}var br=Ii(),_r=Ii(!0);function xr(e,t){return e&&br(e,t,Ds)}function wr(e,t){return e&&_r(e,t,Ds)}function Sr(e,t){return Rt(t,(function(t){return $o(e[t])}))}function Mr(e,t){for(var n=0,r=(t=_i(t,e)).length;null!=e&&n<r;)e=e[Fa(t[n++])];return n&&n==r?e:i}function kr(e,t,n){var r=t(e);return Zo(e)?r:Nt(r,n(e))}function Tr(e){return null==e?e===i?"[object Undefined]":"[object Null]":et&&et in Te(e)?function(e){var t=Ie.call(e,et),n=e[et];try{e[et]=i;var r=!0}catch(o){}var a=Fe.call(e);r&&(t?e[et]=n:delete e[et]);return a}(e):function(e){return Fe.call(e)}(e)}function Er(e,t){return e>t}function Cr(e,t){return null!=e&&Ie.call(e,t)}function Ar(e,t){return null!=e&&t in Te(e)}function Rr(e,t,r){for(var a=r?Lt:Pt,o=e[0].length,s=e.length,u=s,l=n(s),c=1/0,h=[];u--;){var f=e[u];u&&t&&(f=Dt(f,Jt(t))),c=_n(f.length,c),l[u]=!r&&(t||o>=120&&f.length>=120)?new Yn(u&&f):i}f=e[0];var d=-1,p=l[0];e:for(;++d<o&&h.length<c;){var v=f[d],m=t?t(v):v;if(v=r||0!==v?v:0,!(p?$t(p,m):a(h,m,r))){for(u=s;--u;){var g=l[u];if(!(g?$t(g,m):a(e[u],m,r)))continue e}p&&p.push(m),h.push(v)}}return h}function Pr(e,t,n){var r=null==(e=Ca(e,t=_i(t,e)))?e:e[Fa(Ja(t))];return null==r?i:kt(r,e,n)}function Lr(e){return rs(e)&&Tr(e)==y}function Dr(e,t,n,r,a){return e===t||(null==e||null==t||!rs(e)&&!rs(t)?e!==e&&t!==t:function(e,t,n,r,a,o){var s=Zo(e),u=Zo(t),l=s?b:va(e),c=u?b:va(t),h=(l=l==y?E:l)==E,f=(c=c==y?E:c)==E,d=l==c;if(d&&Ko(e)){if(!Ko(t))return!1;s=!0,h=!1}if(d&&!h)return o||(o=new Kn),s||hs(e)?na(e,t,n,r,a,o):function(e,t,n,r,i,a,o){switch(n){case I:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case N:return!(e.byteLength!=t.byteLength||!a(new He(e),new He(t)));case _:case x:case T:return Go(+e,+t);case w:return e.name==t.name&&e.message==t.message;case A:case P:return e==t+"";case k:var s=un;case R:var u=1&r;if(s||(s=hn),e.size!=t.size&&!u)return!1;var l=o.get(e);if(l)return l==t;r|=2,o.set(e,t);var c=na(s(e),s(t),r,i,a,o);return o.delete(e),c;case L:if(zn)return zn.call(e)==zn.call(t)}return!1}(e,t,l,n,r,a,o);if(!(1&n)){var p=h&&Ie.call(e,"__wrapped__"),v=f&&Ie.call(t,"__wrapped__");if(p||v){var m=p?e.value():e,g=v?t.value():t;return o||(o=new Kn),a(m,g,n,r,o)}}if(!d)return!1;return o||(o=new Kn),function(e,t,n,r,a,o){var s=1&n,u=ia(e),l=u.length,c=ia(t).length;if(l!=c&&!s)return!1;var h=l;for(;h--;){var f=u[h];if(!(s?f in t:Ie.call(t,f)))return!1}var d=o.get(e),p=o.get(t);if(d&&p)return d==t&&p==e;var v=!0;o.set(e,t),o.set(t,e);var m=s;for(;++h<l;){var g=e[f=u[h]],y=t[f];if(r)var b=s?r(y,g,f,t,e,o):r(g,y,f,e,t,o);if(!(b===i?g===y||a(g,y,n,r,o):b)){v=!1;break}m||(m="constructor"==f)}if(v&&!m){var _=e.constructor,x=t.constructor;_==x||!("constructor"in e)||!("constructor"in t)||"function"==typeof _&&_ instanceof _&&"function"==typeof x&&x instanceof x||(v=!1)}return o.delete(e),o.delete(t),v}(e,t,n,r,a,o)}(e,t,n,r,Dr,a))}function Nr(e,t,n,r){var a=n.length,o=a,s=!r;if(null==e)return!o;for(e=Te(e);a--;){var u=n[a];if(s&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++a<o;){var l=(u=n[a])[0],c=e[l],h=u[1];if(s&&u[2]){if(c===i&&!(l in e))return!1}else{var f=new Kn;if(r)var d=r(c,h,l,e,t,f);if(!(d===i?Dr(h,c,3,r,f):d))return!1}}return!0}function Ir(e){return!(!ns(e)||(t=e,Ue&&Ue in t))&&($o(e)?Ve:ye).test(za(e));var t}function Or(e){return"function"==typeof e?e:null==e?au:"object"==typeof e?Zo(e)?Gr(e[0],e[1]):Vr(e):pu(e)}function Ur(e){if(!Ma(e))return yn(e);var t=[];for(var n in Te(e))Ie.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Fr(e){if(!ns(e))return function(e){var t=[];if(null!=e)for(var n in Te(e))t.push(n);return t}(e);var t=Ma(e),n=[];for(var r in e)("constructor"!=r||!t&&Ie.call(e,r))&&n.push(r);return n}function zr(e,t){return e<t}function Br(e,t){var r=-1,i=Xo(e)?n(e.length):[];return dr(e,(function(e,n,a){i[++r]=t(e,n,a)})),i}function Vr(e){var t=ha(e);return 1==t.length&&t[0][2]?Ta(t[0][0],t[0][1]):function(n){return n===e||Nr(n,e,t)}}function Gr(e,t){return xa(e)&&ka(t)?Ta(Fa(e),t):function(n){var r=Cs(n,e);return r===i&&r===t?As(n,e):Dr(t,r,3)}}function jr(e,t,n,r,a){e!==t&&br(t,(function(o,s){if(a||(a=new Kn),ns(o))!function(e,t,n,r,a,o,s){var u=Ra(e,n),l=Ra(t,n),c=s.get(l);if(c)return void tr(e,n,c);var h=o?o(u,l,n+"",e,t,s):i,f=h===i;if(f){var d=Zo(l),p=!d&&Ko(l),v=!d&&!p&&hs(l);h=l,d||p||v?Zo(u)?h=u:Yo(u)?h=Ri(u):p?(f=!1,h=Mi(l,!0)):v?(f=!1,h=Ti(l,!0)):h=[]:os(l)||Wo(l)?(h=u,Wo(u)?h=bs(u):ns(u)&&!$o(u)||(h=ga(l))):f=!1}f&&(s.set(l,h),a(h,l,r,o,s),s.delete(l));tr(e,n,h)}(e,t,s,n,jr,r,a);else{var u=r?r(Ra(e,s),o,s+"",e,t,a):i;u===i&&(u=o),tr(e,s,u)}}),Ns)}function Hr(e,t){var n=e.length;if(n)return ba(t+=t<0?n:0,n)?e[t]:i}function Wr(e,t,n){t=t.length?Dt(t,(function(e){return Zo(e)?function(t){return Mr(t,1===e.length?e[0]:e)}:e})):[au];var r=-1;t=Dt(t,Jt(la()));var i=Br(e,(function(e,n,i){var a=Dt(t,(function(t){return t(e)}));return{criteria:a,index:++r,value:e}}));return function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(i,(function(e,t){return function(e,t,n){var r=-1,i=e.criteria,a=t.criteria,o=i.length,s=n.length;for(;++r<o;){var u=Ei(i[r],a[r]);if(u)return r>=s?u:u*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)}))}function Zr(e,t,n){for(var r=-1,i=t.length,a={};++r<i;){var o=t[r],s=Mr(e,o);n(s,o)&&ei(a,_i(o,e),s)}return a}function qr(e,t,n,r){var i=r?Gt:Vt,a=-1,o=t.length,s=e;for(e===t&&(t=Ri(t)),n&&(s=Dt(e,Jt(n)));++a<o;)for(var u=0,l=t[a],c=n?n(l):l;(u=i(s,c,u,r))>-1;)s!==e&&Ye.call(s,u,1),Ye.call(e,u,1);return e}function Xr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==a){var a=i;ba(i)?Ye.call(e,i,1):fi(e,i)}}return e}function Yr(e,t){return e+vt(Sn()*(t-e+1))}function Kr(e,t){var n="";if(!e||t<1||t>p)return n;do{t%2&&(n+=e),(t=vt(t/2))&&(e+=e)}while(t);return n}function Jr(e,t){return Da(Ea(e,t,au),e+"")}function Qr(e){return Qn(Gs(e))}function $r(e,t){var n=Gs(e);return Oa(n,ur(t,0,n.length))}function ei(e,t,n,r){if(!ns(e))return e;for(var a=-1,o=(t=_i(t,e)).length,s=o-1,u=e;null!=u&&++a<o;){var l=Fa(t[a]),c=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(a!=s){var h=u[l];(c=r?r(h,l,u):i)===i&&(c=ns(h)?h:ba(t[a+1])?[]:{})}nr(u,l,c),u=u[l]}return e}var ti=Pn?function(e,t){return Pn.set(e,t),e}:au,ni=nt?function(e,t){return nt(e,"toString",{configurable:!0,enumerable:!1,value:nu(t),writable:!0})}:au;function ri(e){return Oa(Gs(e))}function ii(e,t,r){var i=-1,a=e.length;t<0&&(t=-t>a?0:a+t),(r=r>a?a:r)<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var o=n(a);++i<a;)o[i]=e[i+t];return o}function ai(e,t){var n;return dr(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n}function oi(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t===t&&i<=2147483647){for(;r<i;){var a=r+i>>>1,o=e[a];null!==o&&!cs(o)&&(n?o<=t:o<t)?r=a+1:i=a}return i}return si(e,t,au,n)}function si(e,t,n,r){var a=0,o=null==e?0:e.length;if(0===o)return 0;for(var s=(t=n(t))!==t,u=null===t,l=cs(t),c=t===i;a<o;){var h=vt((a+o)/2),f=n(e[h]),d=f!==i,p=null===f,v=f===f,m=cs(f);if(s)var g=r||v;else g=c?v&&(r||d):u?v&&d&&(r||!p):l?v&&d&&!p&&(r||!m):!p&&!m&&(r?f<=t:f<t);g?a=h+1:o=h}return _n(o,4294967294)}function ui(e,t){for(var n=-1,r=e.length,i=0,a=[];++n<r;){var o=e[n],s=t?t(o):o;if(!n||!Go(s,u)){var u=s;a[i++]=0===o?0:o}}return a}function li(e){return"number"==typeof e?e:cs(e)?v:+e}function ci(e){if("string"==typeof e)return e;if(Zo(e))return Dt(e,ci)+"";if(cs(e))return Bn?Bn.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function hi(e,t,n){var r=-1,i=Pt,a=e.length,o=!0,s=[],u=s;if(n)o=!1,i=Lt;else if(a>=200){var l=t?null:Ki(e);if(l)return hn(l);o=!1,i=$t,u=new Yn}else u=t?[]:s;e:for(;++r<a;){var c=e[r],h=t?t(c):c;if(c=n||0!==c?c:0,o&&h===h){for(var f=u.length;f--;)if(u[f]===h)continue e;t&&u.push(h),s.push(c)}else i(u,h,n)||(u!==s&&u.push(h),s.push(c))}return s}function fi(e,t){return null==(e=Ca(e,t=_i(t,e)))||delete e[Fa(Ja(t))]}function di(e,t,n,r){return ei(e,t,n(Mr(e,t)),r)}function pi(e,t,n,r){for(var i=e.length,a=r?i:-1;(r?a--:++a<i)&&t(e[a],a,e););return n?ii(e,r?0:a,r?a+1:i):ii(e,r?a+1:0,r?i:a)}function vi(e,t){var n=e;return n instanceof Wn&&(n=n.value()),It(t,(function(e,t){return t.func.apply(t.thisArg,Nt([e],t.args))}),n)}function mi(e,t,r){var i=e.length;if(i<2)return i?hi(e[0]):[];for(var a=-1,o=n(i);++a<i;)for(var s=e[a],u=-1;++u<i;)u!=a&&(o[a]=fr(o[a]||s,e[u],t,r));return hi(yr(o,1),t,r)}function gi(e,t,n){for(var r=-1,a=e.length,o=t.length,s={};++r<a;){var u=r<o?t[r]:i;n(s,e[r],u)}return s}function yi(e){return Yo(e)?e:[]}function bi(e){return"function"==typeof e?e:au}function _i(e,t){return Zo(e)?e:xa(e,t)?[e]:Ua(_s(e))}var xi=Jr;function wi(e,t,n){var r=e.length;return n=n===i?r:n,!t&&n>=r?e:ii(e,t,n)}var Si=ut||function(e){return dt.clearTimeout(e)};function Mi(e,t){if(t)return e.slice();var n=e.length,r=We?We(n):new e.constructor(n);return e.copy(r),r}function ki(e){var t=new e.constructor(e.byteLength);return new He(t).set(new He(e)),t}function Ti(e,t){var n=t?ki(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Ei(e,t){if(e!==t){var n=e!==i,r=null===e,a=e===e,o=cs(e),s=t!==i,u=null===t,l=t===t,c=cs(t);if(!u&&!c&&!o&&e>t||o&&s&&l&&!u&&!c||r&&s&&l||!n&&l||!a)return 1;if(!r&&!o&&!c&&e<t||c&&n&&a&&!r&&!o||u&&n&&a||!s&&a||!l)return-1}return 0}function Ci(e,t,r,i){for(var a=-1,o=e.length,s=r.length,u=-1,l=t.length,c=bn(o-s,0),h=n(l+c),f=!i;++u<l;)h[u]=t[u];for(;++a<s;)(f||a<o)&&(h[r[a]]=e[a]);for(;c--;)h[u++]=e[a++];return h}function Ai(e,t,r,i){for(var a=-1,o=e.length,s=-1,u=r.length,l=-1,c=t.length,h=bn(o-u,0),f=n(h+c),d=!i;++a<h;)f[a]=e[a];for(var p=a;++l<c;)f[p+l]=t[l];for(;++s<u;)(d||a<o)&&(f[p+r[s]]=e[a++]);return f}function Ri(e,t){var r=-1,i=e.length;for(t||(t=n(i));++r<i;)t[r]=e[r];return t}function Pi(e,t,n,r){var a=!n;n||(n={});for(var o=-1,s=t.length;++o<s;){var u=t[o],l=r?r(n[u],e[u],u,n,e):i;l===i&&(l=e[u]),a?or(n,u,l):nr(n,u,l)}return n}function Li(e,t){return function(n,r){var i=Zo(n)?Tt:ir,a=t?t():{};return i(n,e,la(r,2),a)}}function Di(e){return Jr((function(t,n){var r=-1,a=n.length,o=a>1?n[a-1]:i,s=a>2?n[2]:i;for(o=e.length>3&&"function"==typeof o?(a--,o):i,s&&_a(n[0],n[1],s)&&(o=a<3?i:o,a=1),t=Te(t);++r<a;){var u=n[r];u&&e(t,u,r,o)}return t}))}function Ni(e,t){return function(n,r){if(null==n)return n;if(!Xo(n))return e(n,r);for(var i=n.length,a=t?i:-1,o=Te(n);(t?a--:++a<i)&&!1!==r(o[a],a,o););return n}}function Ii(e){return function(t,n,r){for(var i=-1,a=Te(t),o=r(t),s=o.length;s--;){var u=o[e?s:++i];if(!1===n(a[u],u,a))break}return t}}function Oi(e){return function(t){var n=sn(t=_s(t))?pn(t):i,r=n?n[0]:t.charAt(0),a=n?wi(n,1).join(""):t.slice(1);return r[e]()+a}}function Ui(e){return function(t){return It($s(Ws(t).replace(Qe,"")),e,"")}}function Fi(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Gn(e.prototype),r=e.apply(n,t);return ns(r)?r:n}}function zi(e){return function(t,n,r){var a=Te(t);if(!Xo(t)){var o=la(n,3);t=Ds(t),n=function(e){return o(a[e],e,a)}}var s=e(t,n,r);return s>-1?a[o?t[s]:s]:i}}function Bi(e){return ra((function(t){var n=t.length,r=n,o=Hn.prototype.thru;for(e&&t.reverse();r--;){var s=t[r];if("function"!=typeof s)throw new Ae(a);if(o&&!u&&"wrapper"==sa(s))var u=new Hn([],!0)}for(r=u?r:n;++r<n;){var l=sa(s=t[r]),c="wrapper"==l?oa(s):i;u=c&&wa(c[0])&&424==c[1]&&!c[4].length&&1==c[9]?u[sa(c[0])].apply(u,c[3]):1==s.length&&wa(s)?u[l]():u.thru(s)}return function(){var e=arguments,r=e[0];if(u&&1==e.length&&Zo(r))return u.plant(r).value();for(var i=0,a=n?t[i].apply(this,e):r;++i<n;)a=t[i].call(this,a);return a}}))}function Vi(e,t,r,a,o,s,u,l,c,f){var d=t&h,p=1&t,v=2&t,m=24&t,g=512&t,y=v?i:Fi(e);return function i(){for(var h=arguments.length,b=n(h),_=h;_--;)b[_]=arguments[_];if(m)var x=ua(i),w=nn(b,x);if(a&&(b=Ci(b,a,o,m)),s&&(b=Ai(b,s,u,m)),h-=w,m&&h<f){var S=cn(b,x);return Xi(e,t,Vi,i.placeholder,r,b,S,l,c,f-h)}var M=p?r:this,k=v?M[e]:e;return h=b.length,l?b=Aa(b,l):g&&h>1&&b.reverse(),d&&c<h&&(b.length=c),this&&this!==dt&&this instanceof i&&(k=y||Fi(k)),k.apply(M,b)}}function Gi(e,t){return function(n,r){return function(e,t,n,r){return xr(e,(function(e,i,a){t(r,n(e),i,a)})),r}(n,e,t(r),{})}}function ji(e,t){return function(n,r){var a;if(n===i&&r===i)return t;if(n!==i&&(a=n),r!==i){if(a===i)return r;"string"==typeof n||"string"==typeof r?(n=ci(n),r=ci(r)):(n=li(n),r=li(r)),a=e(n,r)}return a}}function Hi(e){return ra((function(t){return t=Dt(t,Jt(la())),Jr((function(n){var r=this;return e(t,(function(e){return kt(e,r,n)}))}))}))}function Wi(e,t){var n=(t=t===i?" ":ci(t)).length;if(n<2)return n?Kr(t,e):t;var r=Kr(t,pt(e/dn(t)));return sn(t)?wi(pn(r),0,e).join(""):r.slice(0,e)}function Zi(e){return function(t,r,a){return a&&"number"!=typeof a&&_a(t,r,a)&&(r=a=i),t=vs(t),r===i?(r=t,t=0):r=vs(r),function(e,t,r,i){for(var a=-1,o=bn(pt((t-e)/(r||1)),0),s=n(o);o--;)s[i?o:++a]=e,e+=r;return s}(t,r,a=a===i?t<r?1:-1:vs(a),e)}}function qi(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=ys(t),n=ys(n)),e(t,n)}}function Xi(e,t,n,r,a,o,s,u,h,f){var d=8&t;t|=d?l:c,4&(t&=~(d?c:l))||(t&=-4);var p=[e,t,a,d?o:i,d?s:i,d?i:o,d?i:s,u,h,f],v=n.apply(i,p);return wa(e)&&Pa(v,p),v.placeholder=r,Na(v,e,t)}function Yi(e){var t=ke[e];return function(e,n){if(e=ys(e),(n=null==n?0:_n(ms(n),292))&&Ft(e)){var r=(_s(e)+"e").split("e");return+((r=(_s(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var Ki=Cn&&1/hn(new Cn([,-0]))[1]==d?function(e){return new Cn(e)}:cu;function Ji(e){return function(t){var n=va(t);return n==k?un(t):n==R?fn(t):function(e,t){return Dt(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Qi(e,t,r,o,d,p,v,m){var g=2&t;if(!g&&"function"!=typeof e)throw new Ae(a);var y=o?o.length:0;if(y||(t&=-97,o=d=i),v=v===i?v:bn(ms(v),0),m=m===i?m:ms(m),y-=d?d.length:0,t&c){var b=o,_=d;o=d=i}var x=g?i:oa(e),w=[e,t,r,o,d,b,_,p,v,m];if(x&&function(e,t){var n=e[1],r=t[1],i=n|r,a=i<131,o=r==h&&8==n||r==h&&n==f&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!a&&!o)return e;1&r&&(e[2]=t[2],i|=1&n?0:4);var u=t[3];if(u){var l=e[3];e[3]=l?Ci(l,u,t[4]):u,e[4]=l?cn(e[3],s):t[4]}(u=t[5])&&(l=e[5],e[5]=l?Ai(l,u,t[6]):u,e[6]=l?cn(e[5],s):t[6]);(u=t[7])&&(e[7]=u);r&h&&(e[8]=null==e[8]?t[8]:_n(e[8],t[8]));null==e[9]&&(e[9]=t[9]);e[0]=t[0],e[1]=i}(w,x),e=w[0],t=w[1],r=w[2],o=w[3],d=w[4],!(m=w[9]=w[9]===i?g?0:e.length:bn(w[9]-y,0))&&24&t&&(t&=-25),t&&1!=t)S=8==t||t==u?function(e,t,r){var a=Fi(e);return function o(){for(var s=arguments.length,u=n(s),l=s,c=ua(o);l--;)u[l]=arguments[l];var h=s<3&&u[0]!==c&&u[s-1]!==c?[]:cn(u,c);return(s-=h.length)<r?Xi(e,t,Vi,o.placeholder,i,u,h,i,i,r-s):kt(this&&this!==dt&&this instanceof o?a:e,this,u)}}(e,t,m):t!=l&&33!=t||d.length?Vi.apply(i,w):function(e,t,r,i){var a=1&t,o=Fi(e);return function t(){for(var s=-1,u=arguments.length,l=-1,c=i.length,h=n(c+u),f=this&&this!==dt&&this instanceof t?o:e;++l<c;)h[l]=i[l];for(;u--;)h[l++]=arguments[++s];return kt(f,a?r:this,h)}}(e,t,r,o);else var S=function(e,t,n){var r=1&t,i=Fi(e);return function t(){return(this&&this!==dt&&this instanceof t?i:e).apply(r?n:this,arguments)}}(e,t,r);return Na((x?ti:Pa)(S,w),e,t)}function $i(e,t,n,r){return e===i||Go(e,Le[n])&&!Ie.call(r,n)?t:e}function ea(e,t,n,r,a,o){return ns(e)&&ns(t)&&(o.set(t,e),jr(e,t,i,ea,o),o.delete(t)),e}function ta(e){return os(e)?i:e}function na(e,t,n,r,a,o){var s=1&n,u=e.length,l=t.length;if(u!=l&&!(s&&l>u))return!1;var c=o.get(e),h=o.get(t);if(c&&h)return c==t&&h==e;var f=-1,d=!0,p=2&n?new Yn:i;for(o.set(e,t),o.set(t,e);++f<u;){var v=e[f],m=t[f];if(r)var g=s?r(m,v,f,t,e,o):r(v,m,f,e,t,o);if(g!==i){if(g)continue;d=!1;break}if(p){if(!Ut(t,(function(e,t){if(!$t(p,t)&&(v===e||a(v,e,n,r,o)))return p.push(t)}))){d=!1;break}}else if(v!==m&&!a(v,m,n,r,o)){d=!1;break}}return o.delete(e),o.delete(t),d}function ra(e){return Da(Ea(e,i,Za),e+"")}function ia(e){return kr(e,Ds,da)}function aa(e){return kr(e,Ns,pa)}var oa=Pn?function(e){return Pn.get(e)}:cu;function sa(e){for(var t=e.name+"",n=Ln[t],r=Ie.call(Ln,t)?n.length:0;r--;){var i=n[r],a=i.func;if(null==a||a==e)return i.name}return t}function ua(e){return(Ie.call(Vn,"placeholder")?Vn:e).placeholder}function la(){var e=Vn.iteratee||ou;return e=e===ou?Or:e,arguments.length?e(arguments[0],arguments[1]):e}function ca(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function ha(e){for(var t=Ds(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,ka(i)]}return t}function fa(e,t){var n=function(e,t){return null==e?i:e[t]}(e,t);return Ir(n)?n:i}var da=gt?function(e){return null==e?[]:(e=Te(e),Rt(gt(e),(function(t){return Xe.call(e,t)})))}:gu,pa=gt?function(e){for(var t=[];e;)Nt(t,da(e)),e=Ze(e);return t}:gu,va=Tr;function ma(e,t,n){for(var r=-1,i=(t=_i(t,e)).length,a=!1;++r<i;){var o=Fa(t[r]);if(!(a=null!=e&&n(e,o)))break;e=e[o]}return a||++r!=i?a:!!(i=null==e?0:e.length)&&ts(i)&&ba(o,i)&&(Zo(e)||Wo(e))}function ga(e){return"function"!=typeof e.constructor||Ma(e)?{}:Gn(Ze(e))}function ya(e){return Zo(e)||Wo(e)||!!(Ke&&e&&e[Ke])}function ba(e,t){var n=typeof e;return!!(t=null==t?p:t)&&("number"==n||"symbol"!=n&&_e.test(e))&&e>-1&&e%1==0&&e<t}function _a(e,t,n){if(!ns(n))return!1;var r=typeof t;return!!("number"==r?Xo(n)&&ba(t,n.length):"string"==r&&t in n)&&Go(n[t],e)}function xa(e,t){if(Zo(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!cs(e))||(ne.test(e)||!te.test(e)||null!=t&&e in Te(t))}function wa(e){var t=sa(e),n=Vn[t];if("function"!=typeof n||!(t in Wn.prototype))return!1;if(e===n)return!0;var r=oa(n);return!!r&&e===r[0]}(kn&&va(new kn(new ArrayBuffer(1)))!=I||Tn&&va(new Tn)!=k||En&&va(En.resolve())!=C||Cn&&va(new Cn)!=R||An&&va(new An)!=D)&&(va=function(e){var t=Tr(e),n=t==E?e.constructor:i,r=n?za(n):"";if(r)switch(r){case Dn:return I;case Nn:return k;case In:return C;case On:return R;case Un:return D}return t});var Sa=De?$o:yu;function Ma(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Le)}function ka(e){return e===e&&!ns(e)}function Ta(e,t){return function(n){return null!=n&&(n[e]===t&&(t!==i||e in Te(n)))}}function Ea(e,t,r){return t=bn(t===i?e.length-1:t,0),function(){for(var i=arguments,a=-1,o=bn(i.length-t,0),s=n(o);++a<o;)s[a]=i[t+a];a=-1;for(var u=n(t+1);++a<t;)u[a]=i[a];return u[t]=r(s),kt(e,this,u)}}function Ca(e,t){return t.length<2?e:Mr(e,ii(t,0,-1))}function Aa(e,t){for(var n=e.length,r=_n(t.length,n),a=Ri(e);r--;){var o=t[r];e[r]=ba(o,n)?a[o]:i}return e}function Ra(e,t){if(("constructor"!==t||"function"!==typeof e[t])&&"__proto__"!=t)return e[t]}var Pa=Ia(ti),La=ft||function(e,t){return dt.setTimeout(e,t)},Da=Ia(ni);function Na(e,t,n){var r=t+"";return Da(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(ue,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return Et(g,(function(n){var r="_."+n[0];t&n[1]&&!Pt(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match(le);return t?t[1].split(ce):[]}(r),n)))}function Ia(e){var t=0,n=0;return function(){var r=xn(),a=16-(r-n);if(n=r,a>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(i,arguments)}}function Oa(e,t){var n=-1,r=e.length,a=r-1;for(t=t===i?r:t;++n<t;){var o=Yr(n,a),s=e[o];e[o]=e[n],e[n]=s}return e.length=t,e}var Ua=function(e){var t=Oo(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(re,(function(e,n,r,i){t.push(r?i.replace(de,"$1"):n||e)})),t}));function Fa(e){if("string"==typeof e||cs(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function za(e){if(null!=e){try{return Ne.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function Ba(e){if(e instanceof Wn)return e.clone();var t=new Hn(e.__wrapped__,e.__chain__);return t.__actions__=Ri(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Va=Jr((function(e,t){return Yo(e)?fr(e,yr(t,1,Yo,!0)):[]})),Ga=Jr((function(e,t){var n=Ja(t);return Yo(n)&&(n=i),Yo(e)?fr(e,yr(t,1,Yo,!0),la(n,2)):[]})),ja=Jr((function(e,t){var n=Ja(t);return Yo(n)&&(n=i),Yo(e)?fr(e,yr(t,1,Yo,!0),i,n):[]}));function Ha(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:ms(n);return i<0&&(i=bn(r+i,0)),Bt(e,la(t,3),i)}function Wa(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var a=r-1;return n!==i&&(a=ms(n),a=n<0?bn(r+a,0):_n(a,r-1)),Bt(e,la(t,3),a,!0)}function Za(e){return(null==e?0:e.length)?yr(e,1):[]}function qa(e){return e&&e.length?e[0]:i}var Xa=Jr((function(e){var t=Dt(e,yi);return t.length&&t[0]===e[0]?Rr(t):[]})),Ya=Jr((function(e){var t=Ja(e),n=Dt(e,yi);return t===Ja(n)?t=i:n.pop(),n.length&&n[0]===e[0]?Rr(n,la(t,2)):[]})),Ka=Jr((function(e){var t=Ja(e),n=Dt(e,yi);return(t="function"==typeof t?t:i)&&n.pop(),n.length&&n[0]===e[0]?Rr(n,i,t):[]}));function Ja(e){var t=null==e?0:e.length;return t?e[t-1]:i}var Qa=Jr($a);function $a(e,t){return e&&e.length&&t&&t.length?qr(e,t):e}var eo=ra((function(e,t){var n=null==e?0:e.length,r=sr(e,t);return Xr(e,Dt(t,(function(e){return ba(e,n)?+e:e})).sort(Ei)),r}));function to(e){return null==e?e:Mn.call(e)}var no=Jr((function(e){return hi(yr(e,1,Yo,!0))})),ro=Jr((function(e){var t=Ja(e);return Yo(t)&&(t=i),hi(yr(e,1,Yo,!0),la(t,2))})),io=Jr((function(e){var t=Ja(e);return t="function"==typeof t?t:i,hi(yr(e,1,Yo,!0),i,t)}));function ao(e){if(!e||!e.length)return[];var t=0;return e=Rt(e,(function(e){if(Yo(e))return t=bn(e.length,t),!0})),Yt(t,(function(t){return Dt(e,Wt(t))}))}function oo(e,t){if(!e||!e.length)return[];var n=ao(e);return null==t?n:Dt(n,(function(e){return kt(t,i,e)}))}var so=Jr((function(e,t){return Yo(e)?fr(e,t):[]})),uo=Jr((function(e){return mi(Rt(e,Yo))})),lo=Jr((function(e){var t=Ja(e);return Yo(t)&&(t=i),mi(Rt(e,Yo),la(t,2))})),co=Jr((function(e){var t=Ja(e);return t="function"==typeof t?t:i,mi(Rt(e,Yo),i,t)})),ho=Jr(ao);var fo=Jr((function(e){var t=e.length,n=t>1?e[t-1]:i;return n="function"==typeof n?(e.pop(),n):i,oo(e,n)}));function po(e){var t=Vn(e);return t.__chain__=!0,t}function vo(e,t){return t(e)}var mo=ra((function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,a=function(t){return sr(t,e)};return!(t>1||this.__actions__.length)&&r instanceof Wn&&ba(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:vo,args:[a],thisArg:i}),new Hn(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(i),e}))):this.thru(a)}));var go=Li((function(e,t,n){Ie.call(e,n)?++e[n]:or(e,n,1)}));var yo=zi(Ha),bo=zi(Wa);function _o(e,t){return(Zo(e)?Et:dr)(e,la(t,3))}function xo(e,t){return(Zo(e)?Ct:pr)(e,la(t,3))}var wo=Li((function(e,t,n){Ie.call(e,n)?e[n].push(t):or(e,n,[t])}));var So=Jr((function(e,t,r){var i=-1,a="function"==typeof t,o=Xo(e)?n(e.length):[];return dr(e,(function(e){o[++i]=a?kt(t,e,r):Pr(e,t,r)})),o})),Mo=Li((function(e,t,n){or(e,n,t)}));function ko(e,t){return(Zo(e)?Dt:Br)(e,la(t,3))}var To=Li((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));var Eo=Jr((function(e,t){if(null==e)return[];var n=t.length;return n>1&&_a(e,t[0],t[1])?t=[]:n>2&&_a(t[0],t[1],t[2])&&(t=[t[0]]),Wr(e,yr(t,1),[])})),Co=ht||function(){return dt.Date.now()};function Ao(e,t,n){return t=n?i:t,t=e&&null==t?e.length:t,Qi(e,h,i,i,i,i,t)}function Ro(e,t){var n;if("function"!=typeof t)throw new Ae(a);return e=ms(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=i),n}}var Po=Jr((function(e,t,n){var r=1;if(n.length){var i=cn(n,ua(Po));r|=l}return Qi(e,r,t,n,i)})),Lo=Jr((function(e,t,n){var r=3;if(n.length){var i=cn(n,ua(Lo));r|=l}return Qi(t,r,e,n,i)}));function Do(e,t,n){var r,o,s,u,l,c,h=0,f=!1,d=!1,p=!0;if("function"!=typeof e)throw new Ae(a);function v(t){var n=r,a=o;return r=o=i,h=t,u=e.apply(a,n)}function m(e){return h=e,l=La(y,t),f?v(e):u}function g(e){var n=e-c;return c===i||n>=t||n<0||d&&e-h>=s}function y(){var e=Co();if(g(e))return b(e);l=La(y,function(e){var n=t-(e-c);return d?_n(n,s-(e-h)):n}(e))}function b(e){return l=i,p&&r?v(e):(r=o=i,u)}function _(){var e=Co(),n=g(e);if(r=arguments,o=this,c=e,n){if(l===i)return m(c);if(d)return Si(l),l=La(y,t),v(c)}return l===i&&(l=La(y,t)),u}return t=ys(t)||0,ns(n)&&(f=!!n.leading,s=(d="maxWait"in n)?bn(ys(n.maxWait)||0,t):s,p="trailing"in n?!!n.trailing:p),_.cancel=function(){l!==i&&Si(l),h=0,r=c=o=l=i},_.flush=function(){return l===i?u:b(Co())},_}var No=Jr((function(e,t){return hr(e,1,t)})),Io=Jr((function(e,t,n){return hr(e,ys(t)||0,n)}));function Oo(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new Ae(a);var n=function n(){var r=arguments,i=t?t.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var o=e.apply(this,r);return n.cache=a.set(i,o)||a,o};return n.cache=new(Oo.Cache||Xn),n}function Uo(e){if("function"!=typeof e)throw new Ae(a);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Oo.Cache=Xn;var Fo=xi((function(e,t){var n=(t=1==t.length&&Zo(t[0])?Dt(t[0],Jt(la())):Dt(yr(t,1),Jt(la()))).length;return Jr((function(r){for(var i=-1,a=_n(r.length,n);++i<a;)r[i]=t[i].call(this,r[i]);return kt(e,this,r)}))})),zo=Jr((function(e,t){var n=cn(t,ua(zo));return Qi(e,l,i,t,n)})),Bo=Jr((function(e,t){var n=cn(t,ua(Bo));return Qi(e,c,i,t,n)})),Vo=ra((function(e,t){return Qi(e,f,i,i,i,t)}));function Go(e,t){return e===t||e!==e&&t!==t}var jo=qi(Er),Ho=qi((function(e,t){return e>=t})),Wo=Lr(function(){return arguments}())?Lr:function(e){return rs(e)&&Ie.call(e,"callee")&&!Xe.call(e,"callee")},Zo=n.isArray,qo=bt?Jt(bt):function(e){return rs(e)&&Tr(e)==N};function Xo(e){return null!=e&&ts(e.length)&&!$o(e)}function Yo(e){return rs(e)&&Xo(e)}var Ko=yt||yu,Jo=_t?Jt(_t):function(e){return rs(e)&&Tr(e)==x};function Qo(e){if(!rs(e))return!1;var t=Tr(e);return t==w||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!os(e)}function $o(e){if(!ns(e))return!1;var t=Tr(e);return t==S||t==M||"[object AsyncFunction]"==t||"[object Proxy]"==t}function es(e){return"number"==typeof e&&e==ms(e)}function ts(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=p}function ns(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function rs(e){return null!=e&&"object"==typeof e}var is=xt?Jt(xt):function(e){return rs(e)&&va(e)==k};function as(e){return"number"==typeof e||rs(e)&&Tr(e)==T}function os(e){if(!rs(e)||Tr(e)!=E)return!1;var t=Ze(e);if(null===t)return!0;var n=Ie.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Ne.call(n)==ze}var ss=wt?Jt(wt):function(e){return rs(e)&&Tr(e)==A};var us=St?Jt(St):function(e){return rs(e)&&va(e)==R};function ls(e){return"string"==typeof e||!Zo(e)&&rs(e)&&Tr(e)==P}function cs(e){return"symbol"==typeof e||rs(e)&&Tr(e)==L}var hs=Mt?Jt(Mt):function(e){return rs(e)&&ts(e.length)&&!!ot[Tr(e)]};var fs=qi(zr),ds=qi((function(e,t){return e<=t}));function ps(e){if(!e)return[];if(Xo(e))return ls(e)?pn(e):Ri(e);if(Je&&e[Je])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[Je]());var t=va(e);return(t==k?un:t==R?hn:Gs)(e)}function vs(e){return e?(e=ys(e))===d||e===-1/0?17976931348623157e292*(e<0?-1:1):e===e?e:0:0===e?e:0}function ms(e){var t=vs(e),n=t%1;return t===t?n?t-n:t:0}function gs(e){return e?ur(ms(e),0,m):0}function ys(e){if("number"==typeof e)return e;if(cs(e))return v;if(ns(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ns(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Kt(e);var n=ge.test(e);return n||be.test(e)?ct(e.slice(2),n?2:8):me.test(e)?v:+e}function bs(e){return Pi(e,Ns(e))}function _s(e){return null==e?"":ci(e)}var xs=Di((function(e,t){if(Ma(t)||Xo(t))Pi(t,Ds(t),e);else for(var n in t)Ie.call(t,n)&&nr(e,n,t[n])})),ws=Di((function(e,t){Pi(t,Ns(t),e)})),Ss=Di((function(e,t,n,r){Pi(t,Ns(t),e,r)})),Ms=Di((function(e,t,n,r){Pi(t,Ds(t),e,r)})),ks=ra(sr);var Ts=Jr((function(e,t){e=Te(e);var n=-1,r=t.length,a=r>2?t[2]:i;for(a&&_a(t[0],t[1],a)&&(r=1);++n<r;)for(var o=t[n],s=Ns(o),u=-1,l=s.length;++u<l;){var c=s[u],h=e[c];(h===i||Go(h,Le[c])&&!Ie.call(e,c))&&(e[c]=o[c])}return e})),Es=Jr((function(e){return e.push(i,ea),kt(Os,i,e)}));function Cs(e,t,n){var r=null==e?i:Mr(e,t);return r===i?n:r}function As(e,t){return null!=e&&ma(e,t,Ar)}var Rs=Gi((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Fe.call(t)),e[t]=n}),nu(au)),Ps=Gi((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Fe.call(t)),Ie.call(e,t)?e[t].push(n):e[t]=[n]}),la),Ls=Jr(Pr);function Ds(e){return Xo(e)?Jn(e):Ur(e)}function Ns(e){return Xo(e)?Jn(e,!0):Fr(e)}var Is=Di((function(e,t,n){jr(e,t,n)})),Os=Di((function(e,t,n,r){jr(e,t,n,r)})),Us=ra((function(e,t){var n={};if(null==e)return n;var r=!1;t=Dt(t,(function(t){return t=_i(t,e),r||(r=t.length>1),t})),Pi(e,aa(e),n),r&&(n=lr(n,7,ta));for(var i=t.length;i--;)fi(n,t[i]);return n}));var Fs=ra((function(e,t){return null==e?{}:function(e,t){return Zr(e,t,(function(t,n){return As(e,n)}))}(e,t)}));function zs(e,t){if(null==e)return{};var n=Dt(aa(e),(function(e){return[e]}));return t=la(t),Zr(e,n,(function(e,n){return t(e,n[0])}))}var Bs=Ji(Ds),Vs=Ji(Ns);function Gs(e){return null==e?[]:Qt(e,Ds(e))}var js=Ui((function(e,t,n){return t=t.toLowerCase(),e+(n?Hs(t):t)}));function Hs(e){return Qs(_s(e).toLowerCase())}function Ws(e){return(e=_s(e))&&e.replace(xe,rn).replace($e,"")}var Zs=Ui((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),qs=Ui((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Xs=Oi("toLowerCase");var Ys=Ui((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}));var Ks=Ui((function(e,t,n){return e+(n?" ":"")+Qs(t)}));var Js=Ui((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Qs=Oi("toUpperCase");function $s(e,t,n){return e=_s(e),(t=n?i:t)===i?function(e){return rt.test(e)}(e)?function(e){return e.match(tt)||[]}(e):function(e){return e.match(he)||[]}(e):e.match(t)||[]}var eu=Jr((function(e,t){try{return kt(e,i,t)}catch(n){return Qo(n)?n:new se(n)}})),tu=ra((function(e,t){return Et(t,(function(t){t=Fa(t),or(e,t,Po(e[t],e))})),e}));function nu(e){return function(){return e}}var ru=Bi(),iu=Bi(!0);function au(e){return e}function ou(e){return Or("function"==typeof e?e:lr(e,1))}var su=Jr((function(e,t){return function(n){return Pr(n,e,t)}})),uu=Jr((function(e,t){return function(n){return Pr(e,n,t)}}));function lu(e,t,n){var r=Ds(t),i=Sr(t,r);null!=n||ns(t)&&(i.length||!r.length)||(n=t,t=e,e=this,i=Sr(t,Ds(t)));var a=!(ns(n)&&"chain"in n)||!!n.chain,o=$o(e);return Et(i,(function(n){var r=t[n];e[n]=r,o&&(e.prototype[n]=function(){var t=this.__chain__;if(a||t){var n=e(this.__wrapped__),i=n.__actions__=Ri(this.__actions__);return i.push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,Nt([this.value()],arguments))})})),e}function cu(){}var hu=Hi(Dt),fu=Hi(At),du=Hi(Ut);function pu(e){return xa(e)?Wt(Fa(e)):function(e){return function(t){return Mr(t,e)}}(e)}var vu=Zi(),mu=Zi(!0);function gu(){return[]}function yu(){return!1}var bu=ji((function(e,t){return e+t}),0),_u=Yi("ceil"),xu=ji((function(e,t){return e/t}),1),wu=Yi("floor");var Su=ji((function(e,t){return e*t}),1),Mu=Yi("round"),ku=ji((function(e,t){return e-t}),0);return Vn.after=function(e,t){if("function"!=typeof t)throw new Ae(a);return e=ms(e),function(){if(--e<1)return t.apply(this,arguments)}},Vn.ary=Ao,Vn.assign=xs,Vn.assignIn=ws,Vn.assignInWith=Ss,Vn.assignWith=Ms,Vn.at=ks,Vn.before=Ro,Vn.bind=Po,Vn.bindAll=tu,Vn.bindKey=Lo,Vn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Zo(e)?e:[e]},Vn.chain=po,Vn.chunk=function(e,t,r){t=(r?_a(e,t,r):t===i)?1:bn(ms(t),0);var a=null==e?0:e.length;if(!a||t<1)return[];for(var o=0,s=0,u=n(pt(a/t));o<a;)u[s++]=ii(e,o,o+=t);return u},Vn.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var a=e[t];a&&(i[r++]=a)}return i},Vn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=n(e-1),r=arguments[0],i=e;i--;)t[i-1]=arguments[i];return Nt(Zo(r)?Ri(r):[r],yr(t,1))},Vn.cond=function(e){var t=null==e?0:e.length,n=la();return e=t?Dt(e,(function(e){if("function"!=typeof e[1])throw new Ae(a);return[n(e[0]),e[1]]})):[],Jr((function(n){for(var r=-1;++r<t;){var i=e[r];if(kt(i[0],this,n))return kt(i[1],this,n)}}))},Vn.conforms=function(e){return function(e){var t=Ds(e);return function(n){return cr(n,e,t)}}(lr(e,1))},Vn.constant=nu,Vn.countBy=go,Vn.create=function(e,t){var n=Gn(e);return null==t?n:ar(n,t)},Vn.curry=function e(t,n,r){var a=Qi(t,8,i,i,i,i,i,n=r?i:n);return a.placeholder=e.placeholder,a},Vn.curryRight=function e(t,n,r){var a=Qi(t,u,i,i,i,i,i,n=r?i:n);return a.placeholder=e.placeholder,a},Vn.debounce=Do,Vn.defaults=Ts,Vn.defaultsDeep=Es,Vn.defer=No,Vn.delay=Io,Vn.difference=Va,Vn.differenceBy=Ga,Vn.differenceWith=ja,Vn.drop=function(e,t,n){var r=null==e?0:e.length;return r?ii(e,(t=n||t===i?1:ms(t))<0?0:t,r):[]},Vn.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?ii(e,0,(t=r-(t=n||t===i?1:ms(t)))<0?0:t):[]},Vn.dropRightWhile=function(e,t){return e&&e.length?pi(e,la(t,3),!0,!0):[]},Vn.dropWhile=function(e,t){return e&&e.length?pi(e,la(t,3),!0):[]},Vn.fill=function(e,t,n,r){var a=null==e?0:e.length;return a?(n&&"number"!=typeof n&&_a(e,t,n)&&(n=0,r=a),function(e,t,n,r){var a=e.length;for((n=ms(n))<0&&(n=-n>a?0:a+n),(r=r===i||r>a?a:ms(r))<0&&(r+=a),r=n>r?0:gs(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},Vn.filter=function(e,t){return(Zo(e)?Rt:gr)(e,la(t,3))},Vn.flatMap=function(e,t){return yr(ko(e,t),1)},Vn.flatMapDeep=function(e,t){return yr(ko(e,t),d)},Vn.flatMapDepth=function(e,t,n){return n=n===i?1:ms(n),yr(ko(e,t),n)},Vn.flatten=Za,Vn.flattenDeep=function(e){return(null==e?0:e.length)?yr(e,d):[]},Vn.flattenDepth=function(e,t){return(null==e?0:e.length)?yr(e,t=t===i?1:ms(t)):[]},Vn.flip=function(e){return Qi(e,512)},Vn.flow=ru,Vn.flowRight=iu,Vn.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},Vn.functions=function(e){return null==e?[]:Sr(e,Ds(e))},Vn.functionsIn=function(e){return null==e?[]:Sr(e,Ns(e))},Vn.groupBy=wo,Vn.initial=function(e){return(null==e?0:e.length)?ii(e,0,-1):[]},Vn.intersection=Xa,Vn.intersectionBy=Ya,Vn.intersectionWith=Ka,Vn.invert=Rs,Vn.invertBy=Ps,Vn.invokeMap=So,Vn.iteratee=ou,Vn.keyBy=Mo,Vn.keys=Ds,Vn.keysIn=Ns,Vn.map=ko,Vn.mapKeys=function(e,t){var n={};return t=la(t,3),xr(e,(function(e,r,i){or(n,t(e,r,i),e)})),n},Vn.mapValues=function(e,t){var n={};return t=la(t,3),xr(e,(function(e,r,i){or(n,r,t(e,r,i))})),n},Vn.matches=function(e){return Vr(lr(e,1))},Vn.matchesProperty=function(e,t){return Gr(e,lr(t,1))},Vn.memoize=Oo,Vn.merge=Is,Vn.mergeWith=Os,Vn.method=su,Vn.methodOf=uu,Vn.mixin=lu,Vn.negate=Uo,Vn.nthArg=function(e){return e=ms(e),Jr((function(t){return Hr(t,e)}))},Vn.omit=Us,Vn.omitBy=function(e,t){return zs(e,Uo(la(t)))},Vn.once=function(e){return Ro(2,e)},Vn.orderBy=function(e,t,n,r){return null==e?[]:(Zo(t)||(t=null==t?[]:[t]),Zo(n=r?i:n)||(n=null==n?[]:[n]),Wr(e,t,n))},Vn.over=hu,Vn.overArgs=Fo,Vn.overEvery=fu,Vn.overSome=du,Vn.partial=zo,Vn.partialRight=Bo,Vn.partition=To,Vn.pick=Fs,Vn.pickBy=zs,Vn.property=pu,Vn.propertyOf=function(e){return function(t){return null==e?i:Mr(e,t)}},Vn.pull=Qa,Vn.pullAll=$a,Vn.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?qr(e,t,la(n,2)):e},Vn.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?qr(e,t,i,n):e},Vn.pullAt=eo,Vn.range=vu,Vn.rangeRight=mu,Vn.rearg=Vo,Vn.reject=function(e,t){return(Zo(e)?Rt:gr)(e,Uo(la(t,3)))},Vn.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],a=e.length;for(t=la(t,3);++r<a;){var o=e[r];t(o,r,e)&&(n.push(o),i.push(r))}return Xr(e,i),n},Vn.rest=function(e,t){if("function"!=typeof e)throw new Ae(a);return Jr(e,t=t===i?t:ms(t))},Vn.reverse=to,Vn.sampleSize=function(e,t,n){return t=(n?_a(e,t,n):t===i)?1:ms(t),(Zo(e)?$n:$r)(e,t)},Vn.set=function(e,t,n){return null==e?e:ei(e,t,n)},Vn.setWith=function(e,t,n,r){return r="function"==typeof r?r:i,null==e?e:ei(e,t,n,r)},Vn.shuffle=function(e){return(Zo(e)?er:ri)(e)},Vn.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&_a(e,t,n)?(t=0,n=r):(t=null==t?0:ms(t),n=n===i?r:ms(n)),ii(e,t,n)):[]},Vn.sortBy=Eo,Vn.sortedUniq=function(e){return e&&e.length?ui(e):[]},Vn.sortedUniqBy=function(e,t){return e&&e.length?ui(e,la(t,2)):[]},Vn.split=function(e,t,n){return n&&"number"!=typeof n&&_a(e,t,n)&&(t=n=i),(n=n===i?m:n>>>0)?(e=_s(e))&&("string"==typeof t||null!=t&&!ss(t))&&!(t=ci(t))&&sn(e)?wi(pn(e),0,n):e.split(t,n):[]},Vn.spread=function(e,t){if("function"!=typeof e)throw new Ae(a);return t=null==t?0:bn(ms(t),0),Jr((function(n){var r=n[t],i=wi(n,0,t);return r&&Nt(i,r),kt(e,this,i)}))},Vn.tail=function(e){var t=null==e?0:e.length;return t?ii(e,1,t):[]},Vn.take=function(e,t,n){return e&&e.length?ii(e,0,(t=n||t===i?1:ms(t))<0?0:t):[]},Vn.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?ii(e,(t=r-(t=n||t===i?1:ms(t)))<0?0:t,r):[]},Vn.takeRightWhile=function(e,t){return e&&e.length?pi(e,la(t,3),!1,!0):[]},Vn.takeWhile=function(e,t){return e&&e.length?pi(e,la(t,3)):[]},Vn.tap=function(e,t){return t(e),e},Vn.throttle=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new Ae(a);return ns(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Do(e,t,{leading:r,maxWait:t,trailing:i})},Vn.thru=vo,Vn.toArray=ps,Vn.toPairs=Bs,Vn.toPairsIn=Vs,Vn.toPath=function(e){return Zo(e)?Dt(e,Fa):cs(e)?[e]:Ri(Ua(_s(e)))},Vn.toPlainObject=bs,Vn.transform=function(e,t,n){var r=Zo(e),i=r||Ko(e)||hs(e);if(t=la(t,4),null==n){var a=e&&e.constructor;n=i?r?new a:[]:ns(e)&&$o(a)?Gn(Ze(e)):{}}return(i?Et:xr)(e,(function(e,r,i){return t(n,e,r,i)})),n},Vn.unary=function(e){return Ao(e,1)},Vn.union=no,Vn.unionBy=ro,Vn.unionWith=io,Vn.uniq=function(e){return e&&e.length?hi(e):[]},Vn.uniqBy=function(e,t){return e&&e.length?hi(e,la(t,2)):[]},Vn.uniqWith=function(e,t){return t="function"==typeof t?t:i,e&&e.length?hi(e,i,t):[]},Vn.unset=function(e,t){return null==e||fi(e,t)},Vn.unzip=ao,Vn.unzipWith=oo,Vn.update=function(e,t,n){return null==e?e:di(e,t,bi(n))},Vn.updateWith=function(e,t,n,r){return r="function"==typeof r?r:i,null==e?e:di(e,t,bi(n),r)},Vn.values=Gs,Vn.valuesIn=function(e){return null==e?[]:Qt(e,Ns(e))},Vn.without=so,Vn.words=$s,Vn.wrap=function(e,t){return zo(bi(t),e)},Vn.xor=uo,Vn.xorBy=lo,Vn.xorWith=co,Vn.zip=ho,Vn.zipObject=function(e,t){return gi(e||[],t||[],nr)},Vn.zipObjectDeep=function(e,t){return gi(e||[],t||[],ei)},Vn.zipWith=fo,Vn.entries=Bs,Vn.entriesIn=Vs,Vn.extend=ws,Vn.extendWith=Ss,lu(Vn,Vn),Vn.add=bu,Vn.attempt=eu,Vn.camelCase=js,Vn.capitalize=Hs,Vn.ceil=_u,Vn.clamp=function(e,t,n){return n===i&&(n=t,t=i),n!==i&&(n=(n=ys(n))===n?n:0),t!==i&&(t=(t=ys(t))===t?t:0),ur(ys(e),t,n)},Vn.clone=function(e){return lr(e,4)},Vn.cloneDeep=function(e){return lr(e,5)},Vn.cloneDeepWith=function(e,t){return lr(e,5,t="function"==typeof t?t:i)},Vn.cloneWith=function(e,t){return lr(e,4,t="function"==typeof t?t:i)},Vn.conformsTo=function(e,t){return null==t||cr(e,t,Ds(t))},Vn.deburr=Ws,Vn.defaultTo=function(e,t){return null==e||e!==e?t:e},Vn.divide=xu,Vn.endsWith=function(e,t,n){e=_s(e),t=ci(t);var r=e.length,a=n=n===i?r:ur(ms(n),0,r);return(n-=t.length)>=0&&e.slice(n,a)==t},Vn.eq=Go,Vn.escape=function(e){return(e=_s(e))&&J.test(e)?e.replace(Y,an):e},Vn.escapeRegExp=function(e){return(e=_s(e))&&ae.test(e)?e.replace(ie,"\\$&"):e},Vn.every=function(e,t,n){var r=Zo(e)?At:vr;return n&&_a(e,t,n)&&(t=i),r(e,la(t,3))},Vn.find=yo,Vn.findIndex=Ha,Vn.findKey=function(e,t){return zt(e,la(t,3),xr)},Vn.findLast=bo,Vn.findLastIndex=Wa,Vn.findLastKey=function(e,t){return zt(e,la(t,3),wr)},Vn.floor=wu,Vn.forEach=_o,Vn.forEachRight=xo,Vn.forIn=function(e,t){return null==e?e:br(e,la(t,3),Ns)},Vn.forInRight=function(e,t){return null==e?e:_r(e,la(t,3),Ns)},Vn.forOwn=function(e,t){return e&&xr(e,la(t,3))},Vn.forOwnRight=function(e,t){return e&&wr(e,la(t,3))},Vn.get=Cs,Vn.gt=jo,Vn.gte=Ho,Vn.has=function(e,t){return null!=e&&ma(e,t,Cr)},Vn.hasIn=As,Vn.head=qa,Vn.identity=au,Vn.includes=function(e,t,n,r){e=Xo(e)?e:Gs(e),n=n&&!r?ms(n):0;var i=e.length;return n<0&&(n=bn(i+n,0)),ls(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&Vt(e,t,n)>-1},Vn.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:ms(n);return i<0&&(i=bn(r+i,0)),Vt(e,t,i)},Vn.inRange=function(e,t,n){return t=vs(t),n===i?(n=t,t=0):n=vs(n),function(e,t,n){return e>=_n(t,n)&&e<bn(t,n)}(e=ys(e),t,n)},Vn.invoke=Ls,Vn.isArguments=Wo,Vn.isArray=Zo,Vn.isArrayBuffer=qo,Vn.isArrayLike=Xo,Vn.isArrayLikeObject=Yo,Vn.isBoolean=function(e){return!0===e||!1===e||rs(e)&&Tr(e)==_},Vn.isBuffer=Ko,Vn.isDate=Jo,Vn.isElement=function(e){return rs(e)&&1===e.nodeType&&!os(e)},Vn.isEmpty=function(e){if(null==e)return!0;if(Xo(e)&&(Zo(e)||"string"==typeof e||"function"==typeof e.splice||Ko(e)||hs(e)||Wo(e)))return!e.length;var t=va(e);if(t==k||t==R)return!e.size;if(Ma(e))return!Ur(e).length;for(var n in e)if(Ie.call(e,n))return!1;return!0},Vn.isEqual=function(e,t){return Dr(e,t)},Vn.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:i)?n(e,t):i;return r===i?Dr(e,t,i,n):!!r},Vn.isError=Qo,Vn.isFinite=function(e){return"number"==typeof e&&Ft(e)},Vn.isFunction=$o,Vn.isInteger=es,Vn.isLength=ts,Vn.isMap=is,Vn.isMatch=function(e,t){return e===t||Nr(e,t,ha(t))},Vn.isMatchWith=function(e,t,n){return n="function"==typeof n?n:i,Nr(e,t,ha(t),n)},Vn.isNaN=function(e){return as(e)&&e!=+e},Vn.isNative=function(e){if(Sa(e))throw new se("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Ir(e)},Vn.isNil=function(e){return null==e},Vn.isNull=function(e){return null===e},Vn.isNumber=as,Vn.isObject=ns,Vn.isObjectLike=rs,Vn.isPlainObject=os,Vn.isRegExp=ss,Vn.isSafeInteger=function(e){return es(e)&&e>=-9007199254740991&&e<=p},Vn.isSet=us,Vn.isString=ls,Vn.isSymbol=cs,Vn.isTypedArray=hs,Vn.isUndefined=function(e){return e===i},Vn.isWeakMap=function(e){return rs(e)&&va(e)==D},Vn.isWeakSet=function(e){return rs(e)&&"[object WeakSet]"==Tr(e)},Vn.join=function(e,t){return null==e?"":Zt.call(e,t)},Vn.kebabCase=Zs,Vn.last=Ja,Vn.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var a=r;return n!==i&&(a=(a=ms(n))<0?bn(r+a,0):_n(a,r-1)),t===t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,a):Bt(e,jt,a,!0)},Vn.lowerCase=qs,Vn.lowerFirst=Xs,Vn.lt=fs,Vn.lte=ds,Vn.max=function(e){return e&&e.length?mr(e,au,Er):i},Vn.maxBy=function(e,t){return e&&e.length?mr(e,la(t,2),Er):i},Vn.mean=function(e){return Ht(e,au)},Vn.meanBy=function(e,t){return Ht(e,la(t,2))},Vn.min=function(e){return e&&e.length?mr(e,au,zr):i},Vn.minBy=function(e,t){return e&&e.length?mr(e,la(t,2),zr):i},Vn.stubArray=gu,Vn.stubFalse=yu,Vn.stubObject=function(){return{}},Vn.stubString=function(){return""},Vn.stubTrue=function(){return!0},Vn.multiply=Su,Vn.nth=function(e,t){return e&&e.length?Hr(e,ms(t)):i},Vn.noConflict=function(){return dt._===this&&(dt._=Be),this},Vn.noop=cu,Vn.now=Co,Vn.pad=function(e,t,n){e=_s(e);var r=(t=ms(t))?dn(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return Wi(vt(i),n)+e+Wi(pt(i),n)},Vn.padEnd=function(e,t,n){e=_s(e);var r=(t=ms(t))?dn(e):0;return t&&r<t?e+Wi(t-r,n):e},Vn.padStart=function(e,t,n){e=_s(e);var r=(t=ms(t))?dn(e):0;return t&&r<t?Wi(t-r,n)+e:e},Vn.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),wn(_s(e).replace(oe,""),t||0)},Vn.random=function(e,t,n){if(n&&"boolean"!=typeof n&&_a(e,t,n)&&(t=n=i),n===i&&("boolean"==typeof t?(n=t,t=i):"boolean"==typeof e&&(n=e,e=i)),e===i&&t===i?(e=0,t=1):(e=vs(e),t===i?(t=e,e=0):t=vs(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var a=Sn();return _n(e+a*(t-e+lt("1e-"+((a+"").length-1))),t)}return Yr(e,t)},Vn.reduce=function(e,t,n){var r=Zo(e)?It:qt,i=arguments.length<3;return r(e,la(t,4),n,i,dr)},Vn.reduceRight=function(e,t,n){var r=Zo(e)?Ot:qt,i=arguments.length<3;return r(e,la(t,4),n,i,pr)},Vn.repeat=function(e,t,n){return t=(n?_a(e,t,n):t===i)?1:ms(t),Kr(_s(e),t)},Vn.replace=function(){var e=arguments,t=_s(e[0]);return e.length<3?t:t.replace(e[1],e[2])},Vn.result=function(e,t,n){var r=-1,a=(t=_i(t,e)).length;for(a||(a=1,e=i);++r<a;){var o=null==e?i:e[Fa(t[r])];o===i&&(r=a,o=n),e=$o(o)?o.call(e):o}return e},Vn.round=Mu,Vn.runInContext=e,Vn.sample=function(e){return(Zo(e)?Qn:Qr)(e)},Vn.size=function(e){if(null==e)return 0;if(Xo(e))return ls(e)?dn(e):e.length;var t=va(e);return t==k||t==R?e.size:Ur(e).length},Vn.snakeCase=Ys,Vn.some=function(e,t,n){var r=Zo(e)?Ut:ai;return n&&_a(e,t,n)&&(t=i),r(e,la(t,3))},Vn.sortedIndex=function(e,t){return oi(e,t)},Vn.sortedIndexBy=function(e,t,n){return si(e,t,la(n,2))},Vn.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=oi(e,t);if(r<n&&Go(e[r],t))return r}return-1},Vn.sortedLastIndex=function(e,t){return oi(e,t,!0)},Vn.sortedLastIndexBy=function(e,t,n){return si(e,t,la(n,2),!0)},Vn.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var n=oi(e,t,!0)-1;if(Go(e[n],t))return n}return-1},Vn.startCase=Ks,Vn.startsWith=function(e,t,n){return e=_s(e),n=null==n?0:ur(ms(n),0,e.length),t=ci(t),e.slice(n,n+t.length)==t},Vn.subtract=ku,Vn.sum=function(e){return e&&e.length?Xt(e,au):0},Vn.sumBy=function(e,t){return e&&e.length?Xt(e,la(t,2)):0},Vn.template=function(e,t,n){var r=Vn.templateSettings;n&&_a(e,t,n)&&(t=i),e=_s(e),t=Ss({},t,r,$i);var a,o,s=Ss({},t.imports,r.imports,$i),u=Ds(s),l=Qt(s,u),c=0,h=t.interpolate||we,f="__p += '",d=Ee((t.escape||we).source+"|"+h.source+"|"+(h===ee?pe:we).source+"|"+(t.evaluate||we).source+"|$","g"),p="//# sourceURL="+(Ie.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++at+"]")+"\n";e.replace(d,(function(t,n,r,i,s,u){return r||(r=i),f+=e.slice(c,u).replace(Se,on),n&&(a=!0,f+="' +\n__e("+n+") +\n'"),s&&(o=!0,f+="';\n"+s+";\n__p += '"),r&&(f+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),c=u+t.length,t})),f+="';\n";var v=Ie.call(t,"variable")&&t.variable;if(v){if(fe.test(v))throw new se("Invalid `variable` option passed into `_.template`")}else f="with (obj) {\n"+f+"\n}\n";f=(o?f.replace(W,""):f).replace(Z,"$1").replace(q,"$1;"),f="function("+(v||"obj")+") {\n"+(v?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(a?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var m=eu((function(){return Me(u,p+"return "+f).apply(i,l)}));if(m.source=f,Qo(m))throw m;return m},Vn.times=function(e,t){if((e=ms(e))<1||e>p)return[];var n=m,r=_n(e,m);t=la(t),e-=m;for(var i=Yt(r,t);++n<e;)t(n);return i},Vn.toFinite=vs,Vn.toInteger=ms,Vn.toLength=gs,Vn.toLower=function(e){return _s(e).toLowerCase()},Vn.toNumber=ys,Vn.toSafeInteger=function(e){return e?ur(ms(e),-9007199254740991,p):0===e?e:0},Vn.toString=_s,Vn.toUpper=function(e){return _s(e).toUpperCase()},Vn.trim=function(e,t,n){if((e=_s(e))&&(n||t===i))return Kt(e);if(!e||!(t=ci(t)))return e;var r=pn(e),a=pn(t);return wi(r,en(r,a),tn(r,a)+1).join("")},Vn.trimEnd=function(e,t,n){if((e=_s(e))&&(n||t===i))return e.slice(0,vn(e)+1);if(!e||!(t=ci(t)))return e;var r=pn(e);return wi(r,0,tn(r,pn(t))+1).join("")},Vn.trimStart=function(e,t,n){if((e=_s(e))&&(n||t===i))return e.replace(oe,"");if(!e||!(t=ci(t)))return e;var r=pn(e);return wi(r,en(r,pn(t))).join("")},Vn.truncate=function(e,t){var n=30,r="...";if(ns(t)){var a="separator"in t?t.separator:a;n="length"in t?ms(t.length):n,r="omission"in t?ci(t.omission):r}var o=(e=_s(e)).length;if(sn(e)){var s=pn(e);o=s.length}if(n>=o)return e;var u=n-dn(r);if(u<1)return r;var l=s?wi(s,0,u).join(""):e.slice(0,u);if(a===i)return l+r;if(s&&(u+=l.length-u),ss(a)){if(e.slice(u).search(a)){var c,h=l;for(a.global||(a=Ee(a.source,_s(ve.exec(a))+"g")),a.lastIndex=0;c=a.exec(h);)var f=c.index;l=l.slice(0,f===i?u:f)}}else if(e.indexOf(ci(a),u)!=u){var d=l.lastIndexOf(a);d>-1&&(l=l.slice(0,d))}return l+r},Vn.unescape=function(e){return(e=_s(e))&&K.test(e)?e.replace(X,mn):e},Vn.uniqueId=function(e){var t=++Oe;return _s(e)+t},Vn.upperCase=Js,Vn.upperFirst=Qs,Vn.each=_o,Vn.eachRight=xo,Vn.first=qa,lu(Vn,function(){var e={};return xr(Vn,(function(t,n){Ie.call(Vn.prototype,n)||(e[n]=t)})),e}(),{chain:!1}),Vn.VERSION="4.17.21",Et(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){Vn[e].placeholder=Vn})),Et(["drop","take"],(function(e,t){Wn.prototype[e]=function(n){n=n===i?1:bn(ms(n),0);var r=this.__filtered__&&!t?new Wn(this):this.clone();return r.__filtered__?r.__takeCount__=_n(n,r.__takeCount__):r.__views__.push({size:_n(n,m),type:e+(r.__dir__<0?"Right":"")}),r},Wn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),Et(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;Wn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:la(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}})),Et(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Wn.prototype[e]=function(){return this[n](1).value()[0]}})),Et(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Wn.prototype[e]=function(){return this.__filtered__?new Wn(this):this[n](1)}})),Wn.prototype.compact=function(){return this.filter(au)},Wn.prototype.find=function(e){return this.filter(e).head()},Wn.prototype.findLast=function(e){return this.reverse().find(e)},Wn.prototype.invokeMap=Jr((function(e,t){return"function"==typeof e?new Wn(this):this.map((function(n){return Pr(n,e,t)}))})),Wn.prototype.reject=function(e){return this.filter(Uo(la(e)))},Wn.prototype.slice=function(e,t){e=ms(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Wn(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==i&&(n=(t=ms(t))<0?n.dropRight(-t):n.take(t-e)),n)},Wn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Wn.prototype.toArray=function(){return this.take(m)},xr(Wn.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),a=Vn[r?"take"+("last"==t?"Right":""):t],o=r||/^find/.test(t);a&&(Vn.prototype[t]=function(){var t=this.__wrapped__,s=r?[1]:arguments,u=t instanceof Wn,l=s[0],c=u||Zo(t),h=function(e){var t=a.apply(Vn,Nt([e],s));return r&&f?t[0]:t};c&&n&&"function"==typeof l&&1!=l.length&&(u=c=!1);var f=this.__chain__,d=!!this.__actions__.length,p=o&&!f,v=u&&!d;if(!o&&c){t=v?t:new Wn(this);var m=e.apply(t,s);return m.__actions__.push({func:vo,args:[h],thisArg:i}),new Hn(m,f)}return p&&v?e.apply(this,s):(m=this.thru(h),p?r?m.value()[0]:m.value():m)})})),Et(["pop","push","shift","sort","splice","unshift"],(function(e){var t=Re[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);Vn.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(Zo(i)?i:[],e)}return this[n]((function(n){return t.apply(Zo(n)?n:[],e)}))}})),xr(Wn.prototype,(function(e,t){var n=Vn[t];if(n){var r=n.name+"";Ie.call(Ln,r)||(Ln[r]=[]),Ln[r].push({name:t,func:n})}})),Ln[Vi(i,2).name]=[{name:"wrapper",func:i}],Wn.prototype.clone=function(){var e=new Wn(this.__wrapped__);return e.__actions__=Ri(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Ri(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Ri(this.__views__),e},Wn.prototype.reverse=function(){if(this.__filtered__){var e=new Wn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Wn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Zo(e),r=t<0,i=n?e.length:0,a=function(e,t,n){var r=-1,i=n.length;for(;++r<i;){var a=n[r],o=a.size;switch(a.type){case"drop":e+=o;break;case"dropRight":t-=o;break;case"take":t=_n(t,e+o);break;case"takeRight":e=bn(e,t-o)}}return{start:e,end:t}}(0,i,this.__views__),o=a.start,s=a.end,u=s-o,l=r?s:o-1,c=this.__iteratees__,h=c.length,f=0,d=_n(u,this.__takeCount__);if(!n||!r&&i==u&&d==u)return vi(e,this.__actions__);var p=[];e:for(;u--&&f<d;){for(var v=-1,m=e[l+=t];++v<h;){var g=c[v],y=g.iteratee,b=g.type,_=y(m);if(2==b)m=_;else if(!_){if(1==b)continue e;break e}}p[f++]=m}return p},Vn.prototype.at=mo,Vn.prototype.chain=function(){return po(this)},Vn.prototype.commit=function(){return new Hn(this.value(),this.__chain__)},Vn.prototype.next=function(){this.__values__===i&&(this.__values__=ps(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?i:this.__values__[this.__index__++]}},Vn.prototype.plant=function(e){for(var t,n=this;n instanceof jn;){var r=Ba(n);r.__index__=0,r.__values__=i,t?a.__wrapped__=r:t=r;var a=r;n=n.__wrapped__}return a.__wrapped__=e,t},Vn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Wn){var t=e;return this.__actions__.length&&(t=new Wn(this)),(t=t.reverse()).__actions__.push({func:vo,args:[to],thisArg:i}),new Hn(t,this.__chain__)}return this.thru(to)},Vn.prototype.toJSON=Vn.prototype.valueOf=Vn.prototype.value=function(){return vi(this.__wrapped__,this.__actions__)},Vn.prototype.first=Vn.prototype.head,Je&&(Vn.prototype[Je]=function(){return this}),Vn}();dt._=gn,(r=function(){return gn}.call(t,n,t,e))===i||(e.exports=r)}.call(this)},72:function(e,t,n){var r=n(7009);e.exports=function(){return r.Date.now()}},8174:function(e){e.exports=function(){return[]}},9488:function(e){e.exports=function(){return!1}},2582:function(e,t,n){var r=n(821),i=n(8092),a=n(152),o=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,u=/^0o[0-7]+$/i,l=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(a(e))return NaN;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var n=s.test(e);return n||u.test(e)?l(e.slice(2),n?2:8):o.test(e)?NaN:+e}},2744:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ie}});var r=Object.prototype.toString;function i(e){return r.call(e).endsWith("Array]")}function a(e,t,n){for(var r=0,i=n(t),a=0;a<e.x.length;a++)r+=Math.abs(e.y[a]-i(e.x[a]));return r}var o=n(2963),s=n(136),u=n(9388),l=n(5671),c=n(3144),h=Object.prototype.toString;function f(e){var t=h.call(e);return t.endsWith("Array]")&&!t.includes("Big")}var d=Object.prototype.toString;function p(e){var t=d.call(e);return t.endsWith("Array]")&&!t.includes("Big")}var v=Object.prototype.toString;function m(e){var t=v.call(e);return t.endsWith("Array]")&&!t.includes("Big")}function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!m(e))throw new TypeError("input must be an array");if(0===e.length)throw new TypeError("input must not be empty");var n=t.fromIndex,r=void 0===n?0:n,i=t.toIndex,a=void 0===i?e.length:i;if(r<0||r>=e.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(a<=r||a>e.length||!Number.isInteger(a))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var o=e[r],s=r+1;s<a;s++)e[s]>o&&(o=e[s]);return o}var y=Object.prototype.toString;function b(e){var t=y.call(e);return t.endsWith("Array]")&&!t.includes("Big")}function _(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!b(e))throw new TypeError("input must be an array");if(0===e.length)throw new TypeError("input must not be empty");var n=t.fromIndex,r=void 0===n?0:n,i=t.toIndex,a=void 0===i?e.length:i;if(r<0||r>=e.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(a<=r||a>e.length||!Number.isInteger(a))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var o=e[r],s=r+1;s<a;s++)e[s]<o&&(o=e[s]);return o}function x(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!p(e))throw new TypeError("input must be an array");if(0===e.length)throw new TypeError("input must not be empty");if(void 0!==n.output){if(!p(n.output))throw new TypeError("output option must be an array if specified");t=n.output}else t=new Array(e.length);var r=_(e),i=g(e);if(r===i)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var a=n.min,o=void 0===a?n.autoMinMax?r:0:a,s=n.max,u=void 0===s?n.autoMinMax?i:1:s;if(o>=u)throw new RangeError("min option must be smaller than max option");for(var l=(u-o)/(i-r),c=0;c<e.length;c++)t[c]=(e[c]-r)*l+o;return t}var w=" ".repeat(2),S=" ".repeat(4);function M(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.maxRows,r=void 0===n?15:n,i=t.maxColumns,a=void 0===i?10:i,o=t.maxNumSize,s=void 0===o?8:o,u=t.padMinus,l=void 0===u?"auto":u;return"".concat(e.constructor.name," {\n").concat(w,"[\n").concat(S).concat(k(e,r,a,s,l),"\n").concat(w,"]\n").concat(w,"rows: ").concat(e.rows,"\n").concat(w,"columns: ").concat(e.columns,"\n}")}function k(e,t,n,r,i){var a=e.rows,o=e.columns,s=Math.min(a,t),u=Math.min(o,n),l=[];if("auto"===i){i=!1;e:for(var c=0;c<s;c++)for(var h=0;h<u;h++)if(e.get(c,h)<0){i=!0;break e}}for(var f=0;f<s;f++){for(var d=[],p=0;p<u;p++)d.push(T(e.get(f,p),r,i));l.push("".concat(d.join(" ")))}return u!==o&&(l[l.length-1]+=" ... ".concat(o-n," more columns")),s!==a&&l.push("... ".concat(a-t," more rows")),l.join("\n".concat(S))}function T(e,t,n){return(e>=0&&n?" ".concat(E(e,t-1)):E(e,t)).padEnd(t)}function E(e,t){var n=e.toString();if(n.length<=t)return n;var r=e.toFixed(t);if(r.length>t&&(r=e.toFixed(Math.max(0,t-(r.length-t)))),r.length<=t&&!r.startsWith("0.000")&&!r.startsWith("-0.000"))return r;var i=e.toExponential(t);return i.length>t&&(i=e.toExponential(Math.max(0,t-(i.length-t)))),i.slice(0)}function C(e,t,n){var r=n?e.rows:e.rows-1;if(t<0||t>r)throw new RangeError("Row index out of range")}function A(e,t,n){var r=n?e.columns:e.columns-1;if(t<0||t>r)throw new RangeError("Column index out of range")}function R(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.columns)throw new RangeError("vector size must be the same as the number of columns");return t}function P(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.rows)throw new RangeError("vector size must be the same as the number of rows");return t}function L(e,t,n,r,i){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(N("startRow",t),N("endRow",n),N("startColumn",r),N("endColumn",i),t>n||r>i||t<0||t>=e.rows||n<0||n>=e.rows||r<0||r>=e.columns||i<0||i>=e.columns)throw new RangeError("Submatrix indices are out of range")}function D(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=[],r=0;r<e;r++)n.push(t);return n}function N(e,t){if("number"!==typeof t)throw new TypeError("".concat(e," must be a number"))}function I(e){if(e.isEmpty())throw new Error("Empty matrix has no elements to index")}function O(e,t,n){for(var r=e.rows,i=e.columns,a=[],o=0;o<r;o++){for(var s=0,u=0,l=0,c=0;c<i;c++)s+=l=e.get(o,c)-n[o],u+=l*l;t?a.push((u-s*s/i)/(i-1)):a.push((u-s*s/i)/i)}return a}function U(e,t,n){for(var r=e.rows,i=e.columns,a=[],o=0;o<i;o++){for(var s=0,u=0,l=0,c=0;c<r;c++)s+=l=e.get(c,o)-n[o],u+=l*l;t?a.push((u-s*s/r)/(r-1)):a.push((u-s*s/r)/r)}return a}function F(e,t,n){for(var r=e.rows,i=e.columns,a=r*i,o=0,s=0,u=0,l=0;l<r;l++)for(var c=0;c<i;c++)o+=u=e.get(l,c)-n,s+=u*u;return t?(s-o*o/a)/(a-1):(s-o*o/a)/a}function z(e,t){for(var n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)-t[n])}function B(e,t){for(var n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)-t[r])}function V(e,t){for(var n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)-t)}function G(e){for(var t=[],n=0;n<e.rows;n++){for(var r=0,i=0;i<e.columns;i++)r+=Math.pow(e.get(n,i),2)/(e.columns-1);t.push(Math.sqrt(r))}return t}function j(e,t){for(var n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)/t[n])}function H(e){for(var t=[],n=0;n<e.columns;n++){for(var r=0,i=0;i<e.rows;i++)r+=Math.pow(e.get(i,n),2)/(e.rows-1);t.push(Math.sqrt(r))}return t}function W(e,t){for(var n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)/t[r])}function Z(e){for(var t=e.size-1,n=0,r=0;r<e.columns;r++)for(var i=0;i<e.rows;i++)n+=Math.pow(e.get(i,r),2)/t;return Math.sqrt(n)}function q(e,t){for(var n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)/t)}var X=function(){function e(){(0,l.Z)(this,e)}return(0,c.Z)(e,[{key:"size",get:function(){return this.rows*this.columns}},{key:"apply",value:function(e){if("function"!==typeof e)throw new TypeError("callback must be a function");for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)e.call(this,t,n);return this}},{key:"to1DArray",value:function(){for(var e=[],t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)e.push(this.get(t,n));return e}},{key:"to2DArray",value:function(){for(var e=[],t=0;t<this.rows;t++){e.push([]);for(var n=0;n<this.columns;n++)e[t].push(this.get(t,n))}return e}},{key:"toJSON",value:function(){return this.to2DArray()}},{key:"isRowVector",value:function(){return 1===this.rows}},{key:"isColumnVector",value:function(){return 1===this.columns}},{key:"isVector",value:function(){return 1===this.rows||1===this.columns}},{key:"isSquare",value:function(){return this.rows===this.columns}},{key:"isEmpty",value:function(){return 0===this.rows||0===this.columns}},{key:"isSymmetric",value:function(){if(this.isSquare()){for(var e=0;e<this.rows;e++)for(var t=0;t<=e;t++)if(this.get(e,t)!==this.get(t,e))return!1;return!0}return!1}},{key:"isEchelonForm",value:function(){for(var e=0,t=0,n=-1,r=!0,i=!1;e<this.rows&&r;){for(t=0,i=!1;t<this.columns&&!1===i;)0===this.get(e,t)?t++:1===this.get(e,t)&&t>n?(i=!0,n=t):(r=!1,i=!0);e++}return r}},{key:"isReducedEchelonForm",value:function(){for(var e=0,t=0,n=-1,r=!0,i=!1;e<this.rows&&r;){for(t=0,i=!1;t<this.columns&&!1===i;)0===this.get(e,t)?t++:1===this.get(e,t)&&t>n?(i=!0,n=t):(r=!1,i=!0);for(var a=t+1;a<this.rows;a++)0!==this.get(e,a)&&(r=!1);e++}return r}},{key:"echelonForm",value:function(){for(var e=this.clone(),t=0,n=0;t<e.rows&&n<e.columns;){for(var r=t,i=t;i<e.rows;i++)e.get(i,n)>e.get(r,n)&&(r=i);if(0===e.get(r,n))n++;else{e.swapRows(t,r);for(var a=e.get(t,n),o=n;o<e.columns;o++)e.set(t,o,e.get(t,o)/a);for(var s=t+1;s<e.rows;s++){var u=e.get(s,n)/e.get(t,n);e.set(s,n,0);for(var l=n+1;l<e.columns;l++)e.set(s,l,e.get(s,l)-e.get(t,l)*u)}t++,n++}}return e}},{key:"reducedEchelonForm",value:function(){for(var e=this.echelonForm(),t=e.columns,n=e.rows,r=n-1;r>=0;)if(0===e.maxRow(r))r--;else{for(var i=0,a=!1;i<n&&!1===a;)1===e.get(r,i)?a=!0:i++;for(var o=0;o<r;o++)for(var s=e.get(o,i),u=i;u<t;u++){var l=e.get(o,u)-s*e.get(r,u);e.set(o,u,l)}r--}return e}},{key:"set",value:function(){throw new Error("set method is unimplemented")}},{key:"get",value:function(){throw new Error("get method is unimplemented")}},{key:"repeat",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("object"!==typeof e)throw new TypeError("options must be an object");var t=e.rows,n=void 0===t?1:t,r=e.columns,i=void 0===r?1:r;if(!Number.isInteger(n)||n<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(i)||i<=0)throw new TypeError("columns must be a positive integer");for(var a=new K(this.rows*n,this.columns*i),o=0;o<n;o++)for(var s=0;s<i;s++)a.setSubMatrix(this,this.rows*o,this.columns*s);return a}},{key:"fill",value:function(e){for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,e);return this}},{key:"neg",value:function(){return this.mulS(-1)}},{key:"getRow",value:function(e){C(this,e);for(var t=[],n=0;n<this.columns;n++)t.push(this.get(e,n));return t}},{key:"getRowVector",value:function(e){return K.rowVector(this.getRow(e))}},{key:"setRow",value:function(e,t){C(this,e),t=R(this,t);for(var n=0;n<this.columns;n++)this.set(e,n,t[n]);return this}},{key:"swapRows",value:function(e,t){C(this,e),C(this,t);for(var n=0;n<this.columns;n++){var r=this.get(e,n);this.set(e,n,this.get(t,n)),this.set(t,n,r)}return this}},{key:"getColumn",value:function(e){A(this,e);for(var t=[],n=0;n<this.rows;n++)t.push(this.get(n,e));return t}},{key:"getColumnVector",value:function(e){return K.columnVector(this.getColumn(e))}},{key:"setColumn",value:function(e,t){A(this,e),t=P(this,t);for(var n=0;n<this.rows;n++)this.set(n,e,t[n]);return this}},{key:"swapColumns",value:function(e,t){A(this,e),A(this,t);for(var n=0;n<this.rows;n++){var r=this.get(n,e);this.set(n,e,this.get(n,t)),this.set(n,t,r)}return this}},{key:"addRowVector",value:function(e){e=R(this,e);for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e[n]);return this}},{key:"subRowVector",value:function(e){e=R(this,e);for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e[n]);return this}},{key:"mulRowVector",value:function(e){e=R(this,e);for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e[n]);return this}},{key:"divRowVector",value:function(e){e=R(this,e);for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e[n]);return this}},{key:"addColumnVector",value:function(e){e=P(this,e);for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e[t]);return this}},{key:"subColumnVector",value:function(e){e=P(this,e);for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e[t]);return this}},{key:"mulColumnVector",value:function(e){e=P(this,e);for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e[t]);return this}},{key:"divColumnVector",value:function(e){e=P(this,e);for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e[t]);return this}},{key:"mulRow",value:function(e,t){C(this,e);for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this}},{key:"mulColumn",value:function(e,t){A(this,e);for(var n=0;n<this.rows;n++)this.set(n,e,this.get(n,e)*t);return this}},{key:"max",value:function(e){if(this.isEmpty())return NaN;switch(e){case"row":for(var t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY),n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)>t[n]&&(t[n]=this.get(n,r));return t;case"column":for(var i=new Array(this.columns).fill(Number.NEGATIVE_INFINITY),a=0;a<this.rows;a++)for(var o=0;o<this.columns;o++)this.get(a,o)>i[o]&&(i[o]=this.get(a,o));return i;case void 0:for(var s=this.get(0,0),u=0;u<this.rows;u++)for(var l=0;l<this.columns;l++)this.get(u,l)>s&&(s=this.get(u,l));return s;default:throw new Error("invalid option: ".concat(e))}}},{key:"maxIndex",value:function(){I(this);for(var e=this.get(0,0),t=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)>e&&(e=this.get(n,r),t[0]=n,t[1]=r);return t}},{key:"min",value:function(e){if(this.isEmpty())return NaN;switch(e){case"row":for(var t=new Array(this.rows).fill(Number.POSITIVE_INFINITY),n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)<t[n]&&(t[n]=this.get(n,r));return t;case"column":for(var i=new Array(this.columns).fill(Number.POSITIVE_INFINITY),a=0;a<this.rows;a++)for(var o=0;o<this.columns;o++)this.get(a,o)<i[o]&&(i[o]=this.get(a,o));return i;case void 0:for(var s=this.get(0,0),u=0;u<this.rows;u++)for(var l=0;l<this.columns;l++)this.get(u,l)<s&&(s=this.get(u,l));return s;default:throw new Error("invalid option: ".concat(e))}}},{key:"minIndex",value:function(){I(this);for(var e=this.get(0,0),t=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)<e&&(e=this.get(n,r),t[0]=n,t[1]=r);return t}},{key:"maxRow",value:function(e){if(C(this,e),this.isEmpty())return NaN;for(var t=this.get(e,0),n=1;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}},{key:"maxRowIndex",value:function(e){C(this,e),I(this);for(var t=this.get(e,0),n=[e,0],r=1;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r),n[1]=r);return n}},{key:"minRow",value:function(e){if(C(this,e),this.isEmpty())return NaN;for(var t=this.get(e,0),n=1;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}},{key:"minRowIndex",value:function(e){C(this,e),I(this);for(var t=this.get(e,0),n=[e,0],r=1;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r),n[1]=r);return n}},{key:"maxColumn",value:function(e){if(A(this,e),this.isEmpty())return NaN;for(var t=this.get(0,e),n=1;n<this.rows;n++)this.get(n,e)>t&&(t=this.get(n,e));return t}},{key:"maxColumnIndex",value:function(e){A(this,e),I(this);for(var t=this.get(0,e),n=[0,e],r=1;r<this.rows;r++)this.get(r,e)>t&&(t=this.get(r,e),n[0]=r);return n}},{key:"minColumn",value:function(e){if(A(this,e),this.isEmpty())return NaN;for(var t=this.get(0,e),n=1;n<this.rows;n++)this.get(n,e)<t&&(t=this.get(n,e));return t}},{key:"minColumnIndex",value:function(e){A(this,e),I(this);for(var t=this.get(0,e),n=[0,e],r=1;r<this.rows;r++)this.get(r,e)<t&&(t=this.get(r,e),n[0]=r);return n}},{key:"diag",value:function(){for(var e=Math.min(this.rows,this.columns),t=[],n=0;n<e;n++)t.push(this.get(n,n));return t}},{key:"norm",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"frobenius",t=0;if("max"===e)return this.max();if("frobenius"===e){for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)t+=this.get(n,r)*this.get(n,r);return Math.sqrt(t)}throw new RangeError("unknown norm type: ".concat(e))}},{key:"cumulativeSum",value:function(){for(var e=0,t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)e+=this.get(t,n),this.set(t,n,e);return this}},{key:"dot",value:function(t){e.isMatrix(t)&&(t=t.to1DArray());var n=this.to1DArray();if(n.length!==t.length)throw new RangeError("vectors do not have the same size");for(var r=0,i=0;i<n.length;i++)r+=n[i]*t[i];return r}},{key:"mmul",value:function(e){e=K.checkMatrix(e);for(var t=this.rows,n=this.columns,r=e.columns,i=new K(t,r),a=new Float64Array(n),o=0;o<r;o++){for(var s=0;s<n;s++)a[s]=e.get(s,o);for(var u=0;u<t;u++){for(var l=0,c=0;c<n;c++)l+=this.get(u,c)*a[c];i.set(u,o,l)}}return i}},{key:"strassen2x2",value:function(e){e=K.checkMatrix(e);var t=new K(2,2),n=this.get(0,0),r=e.get(0,0),i=this.get(0,1),a=e.get(0,1),o=this.get(1,0),s=e.get(1,0),u=this.get(1,1),l=e.get(1,1),c=(n+u)*(r+l),h=(o+u)*r,f=n*(a-l),d=u*(s-r),p=(n+i)*l,v=c+d-p+(i-u)*(s+l),m=f+p,g=h+d,y=c-h+f+(o-n)*(r+a);return t.set(0,0,v),t.set(0,1,m),t.set(1,0,g),t.set(1,1,y),t}},{key:"strassen3x3",value:function(e){e=K.checkMatrix(e);var t=new K(3,3),n=this.get(0,0),r=this.get(0,1),i=this.get(0,2),a=this.get(1,0),o=this.get(1,1),s=this.get(1,2),u=this.get(2,0),l=this.get(2,1),c=this.get(2,2),h=e.get(0,0),f=e.get(0,1),d=e.get(0,2),p=e.get(1,0),v=e.get(1,1),m=e.get(1,2),g=e.get(2,0),y=e.get(2,1),b=e.get(2,2),_=(n-a)*(-f+v),x=(-n+a+o)*(h-f+v),w=(a+o)*(-h+f),S=n*h,M=(-n+u+l)*(h-d+m),k=(-n+u)*(d-m),T=(u+l)*(-h+d),E=(-i+l+c)*(v+g-y),C=(i-c)*(v-y),A=i*g,R=(l+c)*(-g+y),P=(-i+o+s)*(m+g-b),L=(i-s)*(m-b),D=(o+s)*(-g+b),N=S+A+r*p,I=(n+r+i-a-o-l-c)*v+x+w+S+E+A+R,O=S+M+T+(n+r+i-o-s-u-l)*m+A+P+D,U=_+o*(-h+f+p-v-m-g+b)+x+S+A+P+L,F=_+x+w+S+s*y,z=A+P+L+D+a*d,B=S+M+k+l*(-h+d+p-v-m-g+y)+E+C+A,V=E+C+A+R+u*f,G=S+M+k+T+c*b;return t.set(0,0,N),t.set(0,1,I),t.set(0,2,O),t.set(1,0,U),t.set(1,1,F),t.set(1,2,z),t.set(2,0,B),t.set(2,1,V),t.set(2,2,G),t}},{key:"mmulStrassen",value:function(t){t=K.checkMatrix(t);var n=this.clone(),r=n.rows,i=n.columns,a=t.rows,o=t.columns;function s(t,n,r){var i=t.rows,a=t.columns;if(i===n&&a===r)return t;var o=e.zeros(n,r);return o=o.setSubMatrix(t,0,0)}i!==a&&console.warn("Multiplying ".concat(r," x ").concat(i," and ").concat(a," x ").concat(o," matrix: dimensions do not match."));var u=Math.max(r,a),l=Math.max(i,o);return function t(n,r,i,a){if(i<=512||a<=512)return n.mmul(r);i%2===1&&a%2===1?(n=s(n,i+1,a+1),r=s(r,i+1,a+1)):i%2===1?(n=s(n,i+1,a),r=s(r,i+1,a)):a%2===1&&(n=s(n,i,a+1),r=s(r,i,a+1));var o=parseInt(n.rows/2,10),u=parseInt(n.columns/2,10),l=n.subMatrix(0,o-1,0,u-1),c=r.subMatrix(0,o-1,0,u-1),h=n.subMatrix(0,o-1,u,n.columns-1),f=r.subMatrix(0,o-1,u,r.columns-1),d=n.subMatrix(o,n.rows-1,0,u-1),p=r.subMatrix(o,r.rows-1,0,u-1),v=n.subMatrix(o,n.rows-1,u,n.columns-1),m=r.subMatrix(o,r.rows-1,u,r.columns-1),g=t(e.add(l,v),e.add(c,m),o,u),y=t(e.add(d,v),c,o,u),b=t(l,e.sub(f,m),o,u),_=t(v,e.sub(p,c),o,u),x=t(e.add(l,h),m,o,u),w=t(e.sub(d,l),e.add(c,f),o,u),S=t(e.sub(h,v),e.add(p,m),o,u),M=e.add(g,_);M.sub(x),M.add(S);var k=e.add(b,x),T=e.add(y,_),E=e.sub(g,y);E.add(b),E.add(w);var C=e.zeros(2*M.rows,2*M.columns);return(C=(C=(C=(C=C.setSubMatrix(M,0,0)).setSubMatrix(k,M.rows,0)).setSubMatrix(T,0,M.columns)).setSubMatrix(E,M.rows,M.columns)).subMatrix(0,i-1,0,a-1)}(n=s(n,u,l),t=s(t,u,l),u,l)}},{key:"scaleRows",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("object"!==typeof e)throw new TypeError("options must be an object");var t=e.min,n=void 0===t?0:t,r=e.max,i=void 0===r?1:r;if(!Number.isFinite(n))throw new TypeError("min must be a number");if(!Number.isFinite(i))throw new TypeError("max must be a number");if(n>=i)throw new RangeError("min must be smaller than max");for(var a=new K(this.rows,this.columns),o=0;o<this.rows;o++){var s=this.getRow(o);s.length>0&&x(s,{min:n,max:i,output:s}),a.setRow(o,s)}return a}},{key:"scaleColumns",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("object"!==typeof e)throw new TypeError("options must be an object");var t=e.min,n=void 0===t?0:t,r=e.max,i=void 0===r?1:r;if(!Number.isFinite(n))throw new TypeError("min must be a number");if(!Number.isFinite(i))throw new TypeError("max must be a number");if(n>=i)throw new RangeError("min must be smaller than max");for(var a=new K(this.rows,this.columns),o=0;o<this.columns;o++){var s=this.getColumn(o);s.length&&x(s,{min:n,max:i,output:s}),a.setColumn(o,s)}return a}},{key:"flipRows",value:function(){for(var e=Math.ceil(this.columns/2),t=0;t<this.rows;t++)for(var n=0;n<e;n++){var r=this.get(t,n),i=this.get(t,this.columns-1-n);this.set(t,n,i),this.set(t,this.columns-1-n,r)}return this}},{key:"flipColumns",value:function(){for(var e=Math.ceil(this.rows/2),t=0;t<this.columns;t++)for(var n=0;n<e;n++){var r=this.get(n,t),i=this.get(this.rows-1-n,t);this.set(n,t,i),this.set(this.rows-1-n,t,r)}return this}},{key:"kroneckerProduct",value:function(e){e=K.checkMatrix(e);for(var t=this.rows,n=this.columns,r=e.rows,i=e.columns,a=new K(t*r,n*i),o=0;o<t;o++)for(var s=0;s<n;s++)for(var u=0;u<r;u++)for(var l=0;l<i;l++)a.set(r*o+u,i*s+l,this.get(o,s)*e.get(u,l));return a}},{key:"kroneckerSum",value:function(e){if(e=K.checkMatrix(e),!this.isSquare()||!e.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");var t=this.rows,n=e.rows,r=this.kroneckerProduct(K.eye(n,n)),i=K.eye(t,t).kroneckerProduct(e);return r.add(i)}},{key:"transpose",value:function(){for(var e=new K(this.columns,this.rows),t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)e.set(n,t,this.get(t,n));return e}},{key:"sortRows",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y,t=0;t<this.rows;t++)this.setRow(t,this.getRow(t).sort(e));return this}},{key:"sortColumns",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y,t=0;t<this.columns;t++)this.setColumn(t,this.getColumn(t).sort(e));return this}},{key:"subMatrix",value:function(e,t,n,r){L(this,e,t,n,r);for(var i=new K(t-e+1,r-n+1),a=e;a<=t;a++)for(var o=n;o<=r;o++)i.set(a-e,o-n,this.get(a,o));return i}},{key:"subMatrixRow",value:function(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.columns-1),t>n||t<0||t>=this.columns||n<0||n>=this.columns)throw new RangeError("Argument out of range");for(var r=new K(e.length,n-t+1),i=0;i<e.length;i++)for(var a=t;a<=n;a++){if(e[i]<0||e[i]>=this.rows)throw new RangeError("Row index out of range: ".concat(e[i]));r.set(i,a-t,this.get(e[i],a))}return r}},{key:"subMatrixColumn",value:function(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.rows-1),t>n||t<0||t>=this.rows||n<0||n>=this.rows)throw new RangeError("Argument out of range");for(var r=new K(n-t+1,e.length),i=0;i<e.length;i++)for(var a=t;a<=n;a++){if(e[i]<0||e[i]>=this.columns)throw new RangeError("Column index out of range: ".concat(e[i]));r.set(a-t,i,this.get(a,e[i]))}return r}},{key:"setSubMatrix",value:function(e,t,n){if((e=K.checkMatrix(e)).isEmpty())return this;L(this,t,t+e.rows-1,n,n+e.columns-1);for(var r=0;r<e.rows;r++)for(var i=0;i<e.columns;i++)this.set(t+r,n+i,e.get(r,i));return this}},{key:"selection",value:function(e,t){!function(e,t){if(!f(t))throw new TypeError("row indices must be an array");for(var n=0;n<t.length;n++)if(t[n]<0||t[n]>=e.rows)throw new RangeError("row indices are out of range")}(this,e),function(e,t){if(!f(t))throw new TypeError("column indices must be an array");for(var n=0;n<t.length;n++)if(t[n]<0||t[n]>=e.columns)throw new RangeError("column indices are out of range")}(this,t);for(var n=new K(e.length,t.length),r=0;r<e.length;r++)for(var i=e[r],a=0;a<t.length;a++){var o=t[a];n.set(r,a,this.get(i,o))}return n}},{key:"trace",value:function(){for(var e=Math.min(this.rows,this.columns),t=0,n=0;n<e;n++)t+=this.get(n,n);return t}},{key:"clone",value:function(){for(var e=new K(this.rows,this.columns),t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)e.set(t,n,this.get(t,n));return e}},{key:"sum",value:function(e){switch(e){case"row":return function(e){for(var t=D(e.rows),n=0;n<e.rows;++n)for(var r=0;r<e.columns;++r)t[n]+=e.get(n,r);return t}(this);case"column":return function(e){for(var t=D(e.columns),n=0;n<e.rows;++n)for(var r=0;r<e.columns;++r)t[r]+=e.get(n,r);return t}(this);case void 0:return function(e){for(var t=0,n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)t+=e.get(n,r);return t}(this);default:throw new Error("invalid option: ".concat(e))}}},{key:"product",value:function(e){switch(e){case"row":return function(e){for(var t=D(e.rows,1),n=0;n<e.rows;++n)for(var r=0;r<e.columns;++r)t[n]*=e.get(n,r);return t}(this);case"column":return function(e){for(var t=D(e.columns,1),n=0;n<e.rows;++n)for(var r=0;r<e.columns;++r)t[r]*=e.get(n,r);return t}(this);case void 0:return function(e){for(var t=1,n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)t*=e.get(n,r);return t}(this);default:throw new Error("invalid option: ".concat(e))}}},{key:"mean",value:function(e){var t=this.sum(e);switch(e){case"row":for(var n=0;n<this.rows;n++)t[n]/=this.columns;return t;case"column":for(var r=0;r<this.columns;r++)t[r]/=this.rows;return t;case void 0:return t/this.size;default:throw new Error("invalid option: ".concat(e))}}},{key:"variance",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"===typeof e&&(t=e,e=void 0),"object"!==typeof t)throw new TypeError("options must be an object");var n=t,r=n.unbiased,i=void 0===r||r,a=n.mean,o=void 0===a?this.mean(e):a;if("boolean"!==typeof i)throw new TypeError("unbiased must be a boolean");switch(e){case"row":if(!f(o))throw new TypeError("mean must be an array");return O(this,i,o);case"column":if(!f(o))throw new TypeError("mean must be an array");return U(this,i,o);case void 0:if("number"!==typeof o)throw new TypeError("mean must be a number");return F(this,i,o);default:throw new Error("invalid option: ".concat(e))}}},{key:"standardDeviation",value:function(e,t){"object"===typeof e&&(t=e,e=void 0);var n=this.variance(e,t);if(void 0===e)return Math.sqrt(n);for(var r=0;r<n.length;r++)n[r]=Math.sqrt(n[r]);return n}},{key:"center",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"===typeof e&&(t=e,e=void 0),"object"!==typeof t)throw new TypeError("options must be an object");var n=t,r=n.center,i=void 0===r?this.mean(e):r;switch(e){case"row":if(!f(i))throw new TypeError("center must be an array");return z(this,i),this;case"column":if(!f(i))throw new TypeError("center must be an array");return B(this,i),this;case void 0:if("number"!==typeof i)throw new TypeError("center must be a number");return V(this,i),this;default:throw new Error("invalid option: ".concat(e))}}},{key:"scale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"===typeof e&&(t=e,e=void 0),"object"!==typeof t)throw new TypeError("options must be an object");var n=t.scale;switch(e){case"row":if(void 0===n)n=G(this);else if(!f(n))throw new TypeError("scale must be an array");return j(this,n),this;case"column":if(void 0===n)n=H(this);else if(!f(n))throw new TypeError("scale must be an array");return W(this,n),this;case void 0:if(void 0===n)n=Z(this);else if("number"!==typeof n)throw new TypeError("scale must be a number");return q(this,n),this;default:throw new Error("invalid option: ".concat(e))}}},{key:"toString",value:function(e){return M(this,e)}}],[{key:"from1DArray",value:function(e,t,n){if(e*t!==n.length)throw new RangeError("data length does not match given dimensions");for(var r=new K(e,t),i=0;i<e;i++)for(var a=0;a<t;a++)r.set(i,a,n[i*t+a]);return r}},{key:"rowVector",value:function(e){for(var t=new K(1,e.length),n=0;n<e.length;n++)t.set(0,n,e[n]);return t}},{key:"columnVector",value:function(e){for(var t=new K(e.length,1),n=0;n<e.length;n++)t.set(n,0,e[n]);return t}},{key:"zeros",value:function(e,t){return new K(e,t)}},{key:"ones",value:function(e,t){return new K(e,t).fill(1)}},{key:"rand",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("object"!==typeof n)throw new TypeError("options must be an object");for(var r=n.random,i=void 0===r?Math.random:r,a=new K(e,t),o=0;o<e;o++)for(var s=0;s<t;s++)a.set(o,s,i());return a}},{key:"randInt",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("object"!==typeof n)throw new TypeError("options must be an object");var r=n.min,i=void 0===r?0:r,a=n.max,o=void 0===a?1e3:a,s=n.random,u=void 0===s?Math.random:s;if(!Number.isInteger(i))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(i>=o)throw new RangeError("min must be smaller than max");for(var l=o-i,c=new K(e,t),h=0;h<e;h++)for(var f=0;f<t;f++){var d=i+Math.round(u()*l);c.set(h,f,d)}return c}},{key:"eye",value:function(e,t,n){void 0===t&&(t=e),void 0===n&&(n=1);for(var r=Math.min(e,t),i=this.zeros(e,t),a=0;a<r;a++)i.set(a,a,n);return i}},{key:"diag",value:function(e,t,n){var r=e.length;void 0===t&&(t=r),void 0===n&&(n=t);for(var i=Math.min(r,t,n),a=this.zeros(t,n),o=0;o<i;o++)a.set(o,o,e[o]);return a}},{key:"min",value:function(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);for(var n=e.rows,r=e.columns,i=new K(n,r),a=0;a<n;a++)for(var o=0;o<r;o++)i.set(a,o,Math.min(e.get(a,o),t.get(a,o)));return i}},{key:"max",value:function(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);for(var n=e.rows,r=e.columns,i=new this(n,r),a=0;a<n;a++)for(var o=0;o<r;o++)i.set(a,o,Math.max(e.get(a,o),t.get(a,o)));return i}},{key:"checkMatrix",value:function(t){return e.isMatrix(t)?t:new K(t)}},{key:"isMatrix",value:function(e){return null!=e&&"Matrix"===e.klass}}]),e}();function Y(e,t){return e-t}X.prototype.klass="Matrix","undefined"!==typeof Symbol&&(X.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return M(this)}),X.random=X.rand,X.randomInt=X.randInt,X.diagonal=X.diag,X.prototype.diagonal=X.prototype.diag,X.identity=X.eye,X.prototype.negate=X.prototype.neg,X.prototype.tensorProduct=X.prototype.kroneckerProduct;var K=function(e){(0,s.Z)(n,e);var t=(0,u.Z)(n);function n(e,r){var i;if((0,l.Z)(this,n),i=t.call(this),n.isMatrix(e))return(0,o.Z)(i,e.clone());if(Number.isInteger(e)&&e>=0){if(i.data=[],!(Number.isInteger(r)&&r>=0))throw new TypeError("nColumns must be a positive integer");for(var a=0;a<e;a++)i.data.push(new Float64Array(r))}else{if(!f(e))throw new TypeError("First argument must be a positive number or an array");var s=e;if("number"!==typeof(r=(e=s.length)?s[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");i.data=[];for(var u=0;u<e;u++){if(s[u].length!==r)throw new RangeError("Inconsistent array dimensions");if(!s[u].every((function(e){return"number"===typeof e})))throw new TypeError("Input data contains non-numeric values");i.data.push(Float64Array.from(s[u]))}}return i.rows=e,i.columns=r,i}return(0,c.Z)(n,[{key:"set",value:function(e,t,n){return this.data[e][t]=n,this}},{key:"get",value:function(e,t){return this.data[e][t]}},{key:"removeRow",value:function(e){return C(this,e),this.data.splice(e,1),this.rows-=1,this}},{key:"addRow",value:function(e,t){return void 0===t&&(t=e,e=this.rows),C(this,e,!0),t=Float64Array.from(R(this,t)),this.data.splice(e,0,t),this.rows+=1,this}},{key:"removeColumn",value:function(e){A(this,e);for(var t=0;t<this.rows;t++){for(var n=new Float64Array(this.columns-1),r=0;r<e;r++)n[r]=this.data[t][r];for(var i=e+1;i<this.columns;i++)n[i-1]=this.data[t][i];this.data[t]=n}return this.columns-=1,this}},{key:"addColumn",value:function(e,t){"undefined"===typeof t&&(t=e,e=this.columns),A(this,e,!0),t=P(this,t);for(var n=0;n<this.rows;n++){for(var r=new Float64Array(this.columns+1),i=0;i<e;i++)r[i]=this.data[n][i];for(r[i++]=t[n];i<this.columns+1;i++)r[i]=this.data[n][i-1];this.data[n]=r}return this.columns+=1,this}}]),n}(X);!function(e,t){e.prototype.add=function(e){return"number"===typeof e?this.addS(e):this.addM(e)},e.prototype.addS=function(e){for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e);return this},e.prototype.addM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.set(n,r,this.get(n,r)+e.get(n,r));return this},e.add=function(e,n){return new t(e).add(n)},e.prototype.sub=function(e){return"number"===typeof e?this.subS(e):this.subM(e)},e.prototype.subS=function(e){for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e);return this},e.prototype.subM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.set(n,r,this.get(n,r)-e.get(n,r));return this},e.sub=function(e,n){return new t(e).sub(n)},e.prototype.subtract=e.prototype.sub,e.prototype.subtractS=e.prototype.subS,e.prototype.subtractM=e.prototype.subM,e.subtract=e.sub,e.prototype.mul=function(e){return"number"===typeof e?this.mulS(e):this.mulM(e)},e.prototype.mulS=function(e){for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e);return this},e.prototype.mulM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.set(n,r,this.get(n,r)*e.get(n,r));return this},e.mul=function(e,n){return new t(e).mul(n)},e.prototype.multiply=e.prototype.mul,e.prototype.multiplyS=e.prototype.mulS,e.prototype.multiplyM=e.prototype.mulM,e.multiply=e.mul,e.prototype.div=function(e){return"number"===typeof e?this.divS(e):this.divM(e)},e.prototype.divS=function(e){for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e);return this},e.prototype.divM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.set(n,r,this.get(n,r)/e.get(n,r));return this},e.div=function(e,n){return new t(e).div(n)},e.prototype.divide=e.prototype.div,e.prototype.divideS=e.prototype.divS,e.prototype.divideM=e.prototype.divM,e.divide=e.div,e.prototype.mod=function(e){return"number"===typeof e?this.modS(e):this.modM(e)},e.prototype.modS=function(e){for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)%e);return this},e.prototype.modM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.set(n,r,this.get(n,r)%e.get(n,r));return this},e.mod=function(e,n){return new t(e).mod(n)},e.prototype.modulus=e.prototype.mod,e.prototype.modulusS=e.prototype.modS,e.prototype.modulusM=e.prototype.modM,e.modulus=e.mod,e.prototype.and=function(e){return"number"===typeof e?this.andS(e):this.andM(e)},e.prototype.andS=function(e){for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)&e);return this},e.prototype.andM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.set(n,r,this.get(n,r)&e.get(n,r));return this},e.and=function(e,n){return new t(e).and(n)},e.prototype.or=function(e){return"number"===typeof e?this.orS(e):this.orM(e)},e.prototype.orS=function(e){for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)|e);return this},e.prototype.orM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.set(n,r,this.get(n,r)|e.get(n,r));return this},e.or=function(e,n){return new t(e).or(n)},e.prototype.xor=function(e){return"number"===typeof e?this.xorS(e):this.xorM(e)},e.prototype.xorS=function(e){for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)^e);return this},e.prototype.xorM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.set(n,r,this.get(n,r)^e.get(n,r));return this},e.xor=function(e,n){return new t(e).xor(n)},e.prototype.leftShift=function(e){return"number"===typeof e?this.leftShiftS(e):this.leftShiftM(e)},e.prototype.leftShiftS=function(e){for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)<<e);return this},e.prototype.leftShiftM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.set(n,r,this.get(n,r)<<e.get(n,r));return this},e.leftShift=function(e,n){return new t(e).leftShift(n)},e.prototype.signPropagatingRightShift=function(e){return"number"===typeof e?this.signPropagatingRightShiftS(e):this.signPropagatingRightShiftM(e)},e.prototype.signPropagatingRightShiftS=function(e){for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)>>e);return this},e.prototype.signPropagatingRightShiftM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.set(n,r,this.get(n,r)>>e.get(n,r));return this},e.signPropagatingRightShift=function(e,n){return new t(e).signPropagatingRightShift(n)},e.prototype.rightShift=function(e){return"number"===typeof e?this.rightShiftS(e):this.rightShiftM(e)},e.prototype.rightShiftS=function(e){for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)>>>e);return this},e.prototype.rightShiftM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.set(n,r,this.get(n,r)>>>e.get(n,r));return this},e.rightShift=function(e,n){return new t(e).rightShift(n)},e.prototype.zeroFillRightShift=e.prototype.rightShift,e.prototype.zeroFillRightShiftS=e.prototype.rightShiftS,e.prototype.zeroFillRightShiftM=e.prototype.rightShiftM,e.zeroFillRightShift=e.rightShift,e.prototype.not=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,~this.get(e,t));return this},e.not=function(e){return new t(e).not()},e.prototype.abs=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,Math.abs(this.get(e,t)));return this},e.abs=function(e){return new t(e).abs()},e.prototype.acos=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,Math.acos(this.get(e,t)));return this},e.acos=function(e){return new t(e).acos()},e.prototype.acosh=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,Math.acosh(this.get(e,t)));return this},e.acosh=function(e){return new t(e).acosh()},e.prototype.asin=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,Math.asin(this.get(e,t)));return this},e.asin=function(e){return new t(e).asin()},e.prototype.asinh=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,Math.asinh(this.get(e,t)));return this},e.asinh=function(e){return new t(e).asinh()},e.prototype.atan=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,Math.atan(this.get(e,t)));return this},e.atan=function(e){return new t(e).atan()},e.prototype.atanh=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,Math.atanh(this.get(e,t)));return this},e.atanh=function(e){return new t(e).atanh()},e.prototype.cbrt=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,Math.cbrt(this.get(e,t)));return this},e.cbrt=function(e){return new t(e).cbrt()},e.prototype.ceil=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,Math.ceil(this.get(e,t)));return this},e.ceil=function(e){return new t(e).ceil()},e.prototype.clz32=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,Math.clz32(this.get(e,t)));return this},e.clz32=function(e){return new t(e).clz32()},e.prototype.cos=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,Math.cos(this.get(e,t)));return this},e.cos=function(e){return new t(e).cos()},e.prototype.cosh=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,Math.cosh(this.get(e,t)));return this},e.cosh=function(e){return new t(e).cosh()},e.prototype.exp=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,Math.exp(this.get(e,t)));return this},e.exp=function(e){return new t(e).exp()},e.prototype.expm1=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,Math.expm1(this.get(e,t)));return this},e.expm1=function(e){return new t(e).expm1()},e.prototype.floor=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,Math.floor(this.get(e,t)));return this},e.floor=function(e){return new t(e).floor()},e.prototype.fround=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,Math.fround(this.get(e,t)));return this},e.fround=function(e){return new t(e).fround()},e.prototype.log=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,Math.log(this.get(e,t)));return this},e.log=function(e){return new t(e).log()},e.prototype.log1p=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,Math.log1p(this.get(e,t)));return this},e.log1p=function(e){return new t(e).log1p()},e.prototype.log10=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,Math.log10(this.get(e,t)));return this},e.log10=function(e){return new t(e).log10()},e.prototype.log2=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,Math.log2(this.get(e,t)));return this},e.log2=function(e){return new t(e).log2()},e.prototype.round=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,Math.round(this.get(e,t)));return this},e.round=function(e){return new t(e).round()},e.prototype.sign=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,Math.sign(this.get(e,t)));return this},e.sign=function(e){return new t(e).sign()},e.prototype.sin=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,Math.sin(this.get(e,t)));return this},e.sin=function(e){return new t(e).sin()},e.prototype.sinh=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,Math.sinh(this.get(e,t)));return this},e.sinh=function(e){return new t(e).sinh()},e.prototype.sqrt=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,Math.sqrt(this.get(e,t)));return this},e.sqrt=function(e){return new t(e).sqrt()},e.prototype.tan=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,Math.tan(this.get(e,t)));return this},e.tan=function(e){return new t(e).tan()},e.prototype.tanh=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,Math.tanh(this.get(e,t)));return this},e.tanh=function(e){return new t(e).tanh()},e.prototype.trunc=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.set(e,t,Math.trunc(this.get(e,t)));return this},e.trunc=function(e){return new t(e).trunc()},e.pow=function(e,n){return new t(e).pow(n)},e.prototype.pow=function(e){return"number"===typeof e?this.powS(e):this.powM(e)},e.prototype.powS=function(e){for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,Math.pow(this.get(t,n),e));return this},e.prototype.powM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.set(n,r,Math.pow(this.get(n,r),e.get(n,r)));return this}}(X,K);var J=function(e){(0,s.Z)(n,e);var t=(0,u.Z)(n);function n(e){var r;return(0,l.Z)(this,n),(r=t.call(this)).data=e,r.rows=e.length,r.columns=e[0].length,r}return(0,c.Z)(n,[{key:"set",value:function(e,t,n){return this.data[e][t]=n,this}},{key:"get",value:function(e,t){return this.data[e][t]}}]),n}(X),Q=function(){function e(t){(0,l.Z)(this,e);var n,r,i,a,o,s,u,c,h,f=(t=J.checkMatrix(t)).clone(),d=f.rows,p=f.columns,v=new Float64Array(d),m=1;for(n=0;n<d;n++)v[n]=n;for(c=new Float64Array(d),r=0;r<p;r++){for(n=0;n<d;n++)c[n]=f.get(n,r);for(n=0;n<d;n++){for(h=Math.min(n,r),o=0,i=0;i<h;i++)o+=f.get(n,i)*c[i];c[n]-=o,f.set(n,r,c[n])}for(a=r,n=r+1;n<d;n++)Math.abs(c[n])>Math.abs(c[a])&&(a=n);if(a!==r){for(i=0;i<p;i++)s=f.get(a,i),f.set(a,i,f.get(r,i)),f.set(r,i,s);u=v[a],v[a]=v[r],v[r]=u,m=-m}if(r<d&&0!==f.get(r,r))for(n=r+1;n<d;n++)f.set(n,r,f.get(n,r)/f.get(r,r))}this.LU=f,this.pivotVector=v,this.pivotSign=m}return(0,c.Z)(e,[{key:"isSingular",value:function(){for(var e=this.LU,t=e.columns,n=0;n<t;n++)if(0===e.get(n,n))return!0;return!1}},{key:"solve",value:function(e){e=K.checkMatrix(e);var t=this.LU;if(t.rows!==e.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var n,r,i,a=e.columns,o=e.subMatrixRow(this.pivotVector,0,a-1),s=t.columns;for(i=0;i<s;i++)for(n=i+1;n<s;n++)for(r=0;r<a;r++)o.set(n,r,o.get(n,r)-o.get(i,r)*t.get(n,i));for(i=s-1;i>=0;i--){for(r=0;r<a;r++)o.set(i,r,o.get(i,r)/t.get(i,i));for(n=0;n<i;n++)for(r=0;r<a;r++)o.set(n,r,o.get(n,r)-o.get(i,r)*t.get(n,i))}return o}},{key:"determinant",get:function(){var e=this.LU;if(!e.isSquare())throw new Error("Matrix must be square");for(var t=this.pivotSign,n=e.columns,r=0;r<n;r++)t*=e.get(r,r);return t}},{key:"lowerTriangularMatrix",get:function(){for(var e=this.LU,t=e.rows,n=e.columns,r=new K(t,n),i=0;i<t;i++)for(var a=0;a<n;a++)i>a?r.set(i,a,e.get(i,a)):i===a?r.set(i,a,1):r.set(i,a,0);return r}},{key:"upperTriangularMatrix",get:function(){for(var e=this.LU,t=e.rows,n=e.columns,r=new K(t,n),i=0;i<t;i++)for(var a=0;a<n;a++)i<=a?r.set(i,a,e.get(i,a)):r.set(i,a,0);return r}},{key:"pivotPermutationVector",get:function(){return Array.from(this.pivotVector)}}]),e}();function $(e,t){var n=0;return Math.abs(e)>Math.abs(t)?(n=t/e,Math.abs(e)*Math.sqrt(1+n*n)):0!==t?(n=e/t,Math.abs(t)*Math.sqrt(1+n*n)):0}var ee=function(){function e(t){(0,l.Z)(this,e);var n,r,i,a,o=(t=J.checkMatrix(t)).clone(),s=t.rows,u=t.columns,c=new Float64Array(u);for(i=0;i<u;i++){var h=0;for(n=i;n<s;n++)h=$(h,o.get(n,i));if(0!==h){for(o.get(i,i)<0&&(h=-h),n=i;n<s;n++)o.set(n,i,o.get(n,i)/h);for(o.set(i,i,o.get(i,i)+1),r=i+1;r<u;r++){for(a=0,n=i;n<s;n++)a+=o.get(n,i)*o.get(n,r);for(a=-a/o.get(i,i),n=i;n<s;n++)o.set(n,r,o.get(n,r)+a*o.get(n,i))}}c[i]=-h}this.QR=o,this.Rdiag=c}return(0,c.Z)(e,[{key:"solve",value:function(e){e=K.checkMatrix(e);var t=this.QR,n=t.rows;if(e.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var r,i,a,o,s=e.columns,u=e.clone(),l=t.columns;for(a=0;a<l;a++)for(i=0;i<s;i++){for(o=0,r=a;r<n;r++)o+=t.get(r,a)*u.get(r,i);for(o=-o/t.get(a,a),r=a;r<n;r++)u.set(r,i,u.get(r,i)+o*t.get(r,a))}for(a=l-1;a>=0;a--){for(i=0;i<s;i++)u.set(a,i,u.get(a,i)/this.Rdiag[a]);for(r=0;r<a;r++)for(i=0;i<s;i++)u.set(r,i,u.get(r,i)-u.get(a,i)*t.get(r,a))}return u.subMatrix(0,l-1,0,s-1)}},{key:"isFullRank",value:function(){for(var e=this.QR.columns,t=0;t<e;t++)if(0===this.Rdiag[t])return!1;return!0}},{key:"upperTriangularMatrix",get:function(){var e,t,n=this.QR,r=n.columns,i=new K(r,r);for(e=0;e<r;e++)for(t=0;t<r;t++)e<t?i.set(e,t,n.get(e,t)):e===t?i.set(e,t,this.Rdiag[e]):i.set(e,t,0);return i}},{key:"orthogonalMatrix",get:function(){var e,t,n,r,i=this.QR,a=i.rows,o=i.columns,s=new K(a,o);for(n=o-1;n>=0;n--){for(e=0;e<a;e++)s.set(e,n,0);for(s.set(n,n,1),t=n;t<o;t++)if(0!==i.get(n,n)){for(r=0,e=n;e<a;e++)r+=i.get(e,n)*s.get(e,t);for(r=-r/i.get(n,n),e=n;e<a;e++)s.set(e,t,s.get(e,t)+r*i.get(e,n))}}return s}}]),e}(),te=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,l.Z)(this,e),(t=J.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");var r,i=t.rows,a=t.columns,o=n.computeLeftSingularVectors,s=void 0===o||o,u=n.computeRightSingularVectors,c=void 0===u||u,h=n.autoTranspose,f=void 0!==h&&h,d=Boolean(s),p=Boolean(c),v=!1;if(i<a)if(f){i=(r=t.transpose()).rows,a=r.columns,v=!0;var m=d;d=p,p=m}else r=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else r=t.clone();for(var g=Math.min(i,a),y=Math.min(i+1,a),b=new Float64Array(y),_=new K(i,g),x=new K(a,a),w=new Float64Array(a),S=new Float64Array(i),M=new Float64Array(y),k=0;k<y;k++)M[k]=k;for(var T=Math.min(i-1,a),E=Math.max(0,Math.min(a-2,i)),C=Math.max(T,E),A=0;A<C;A++){if(A<T){b[A]=0;for(var R=A;R<i;R++)b[A]=$(b[A],r.get(R,A));if(0!==b[A]){r.get(A,A)<0&&(b[A]=-b[A]);for(var P=A;P<i;P++)r.set(P,A,r.get(P,A)/b[A]);r.set(A,A,r.get(A,A)+1)}b[A]=-b[A]}for(var L=A+1;L<a;L++){if(A<T&&0!==b[A]){for(var D=0,N=A;N<i;N++)D+=r.get(N,A)*r.get(N,L);D=-D/r.get(A,A);for(var I=A;I<i;I++)r.set(I,L,r.get(I,L)+D*r.get(I,A))}w[L]=r.get(A,L)}if(d&&A<T)for(var O=A;O<i;O++)_.set(O,A,r.get(O,A));if(A<E){w[A]=0;for(var U=A+1;U<a;U++)w[A]=$(w[A],w[U]);if(0!==w[A]){w[A+1]<0&&(w[A]=0-w[A]);for(var F=A+1;F<a;F++)w[F]/=w[A];w[A+1]+=1}if(w[A]=-w[A],A+1<i&&0!==w[A]){for(var z=A+1;z<i;z++)S[z]=0;for(var B=A+1;B<i;B++)for(var V=A+1;V<a;V++)S[B]+=w[V]*r.get(B,V);for(var G=A+1;G<a;G++)for(var j=-w[G]/w[A+1],H=A+1;H<i;H++)r.set(H,G,r.get(H,G)+j*S[H])}if(p)for(var W=A+1;W<a;W++)x.set(W,A,w[W])}}var Z=Math.min(a,i+1);if(T<a&&(b[T]=r.get(T,T)),i<Z&&(b[Z-1]=0),E+1<Z&&(w[E]=r.get(E,Z-1)),w[Z-1]=0,d){for(var q=T;q<g;q++){for(var X=0;X<i;X++)_.set(X,q,0);_.set(q,q,1)}for(var Y=T-1;Y>=0;Y--)if(0!==b[Y]){for(var Q=Y+1;Q<g;Q++){for(var ee=0,te=Y;te<i;te++)ee+=_.get(te,Y)*_.get(te,Q);ee=-ee/_.get(Y,Y);for(var ne=Y;ne<i;ne++)_.set(ne,Q,_.get(ne,Q)+ee*_.get(ne,Y))}for(var re=Y;re<i;re++)_.set(re,Y,-_.get(re,Y));_.set(Y,Y,1+_.get(Y,Y));for(var ie=0;ie<Y-1;ie++)_.set(ie,Y,0)}else{for(var ae=0;ae<i;ae++)_.set(ae,Y,0);_.set(Y,Y,1)}}if(p)for(var oe=a-1;oe>=0;oe--){if(oe<E&&0!==w[oe])for(var se=oe+1;se<a;se++){for(var ue=0,le=oe+1;le<a;le++)ue+=x.get(le,oe)*x.get(le,se);ue=-ue/x.get(oe+1,oe);for(var ce=oe+1;ce<a;ce++)x.set(ce,se,x.get(ce,se)+ue*x.get(ce,oe))}for(var he=0;he<a;he++)x.set(he,oe,0);x.set(oe,oe,1)}for(var fe=Z-1,de=Number.EPSILON;Z>0;){var pe=void 0,ve=void 0;for(pe=Z-2;pe>=-1&&-1!==pe;pe--){var me=Number.MIN_VALUE+de*Math.abs(b[pe]+Math.abs(b[pe+1]));if(Math.abs(w[pe])<=me||Number.isNaN(w[pe])){w[pe]=0;break}}if(pe===Z-2)ve=4;else{var ge=void 0;for(ge=Z-1;ge>=pe&&ge!==pe;ge--){var ye=(ge!==Z?Math.abs(w[ge]):0)+(ge!==pe+1?Math.abs(w[ge-1]):0);if(Math.abs(b[ge])<=de*ye){b[ge]=0;break}}ge===pe?ve=3:ge===Z-1?ve=1:(ve=2,pe=ge)}switch(pe++,ve){case 1:var be=w[Z-2];w[Z-2]=0;for(var _e=Z-2;_e>=pe;_e--){var xe=$(b[_e],be),we=b[_e]/xe,Se=be/xe;if(b[_e]=xe,_e!==pe&&(be=-Se*w[_e-1],w[_e-1]=we*w[_e-1]),p)for(var Me=0;Me<a;Me++)xe=we*x.get(Me,_e)+Se*x.get(Me,Z-1),x.set(Me,Z-1,-Se*x.get(Me,_e)+we*x.get(Me,Z-1)),x.set(Me,_e,xe)}break;case 2:var ke=w[pe-1];w[pe-1]=0;for(var Te=pe;Te<Z;Te++){var Ee=$(b[Te],ke),Ce=b[Te]/Ee,Ae=ke/Ee;if(b[Te]=Ee,ke=-Ae*w[Te],w[Te]=Ce*w[Te],d)for(var Re=0;Re<i;Re++)Ee=Ce*_.get(Re,Te)+Ae*_.get(Re,pe-1),_.set(Re,pe-1,-Ae*_.get(Re,Te)+Ce*_.get(Re,pe-1)),_.set(Re,Te,Ee)}break;case 3:var Pe=Math.max(Math.abs(b[Z-1]),Math.abs(b[Z-2]),Math.abs(w[Z-2]),Math.abs(b[pe]),Math.abs(w[pe])),Le=b[Z-1]/Pe,De=b[Z-2]/Pe,Ne=w[Z-2]/Pe,Ie=b[pe]/Pe,Oe=w[pe]/Pe,Ue=((De+Le)*(De-Le)+Ne*Ne)/2,Fe=Le*Ne*(Le*Ne),ze=0;0===Ue&&0===Fe||(ze=Fe/(Ue+(ze=Ue<0?0-Math.sqrt(Ue*Ue+Fe):Math.sqrt(Ue*Ue+Fe))));for(var Be=(Ie+Le)*(Ie-Le)+ze,Ve=Ie*Oe,Ge=pe;Ge<Z-1;Ge++){var je=$(Be,Ve);0===je&&(je=Number.MIN_VALUE);var He=Be/je,We=Ve/je;if(Ge!==pe&&(w[Ge-1]=je),Be=He*b[Ge]+We*w[Ge],w[Ge]=He*w[Ge]-We*b[Ge],Ve=We*b[Ge+1],b[Ge+1]=He*b[Ge+1],p)for(var Ze=0;Ze<a;Ze++)je=He*x.get(Ze,Ge)+We*x.get(Ze,Ge+1),x.set(Ze,Ge+1,-We*x.get(Ze,Ge)+He*x.get(Ze,Ge+1)),x.set(Ze,Ge,je);if(0===(je=$(Be,Ve))&&(je=Number.MIN_VALUE),He=Be/je,We=Ve/je,b[Ge]=je,Be=He*w[Ge]+We*b[Ge+1],b[Ge+1]=-We*w[Ge]+He*b[Ge+1],Ve=We*w[Ge+1],w[Ge+1]=He*w[Ge+1],d&&Ge<i-1)for(var qe=0;qe<i;qe++)je=He*_.get(qe,Ge)+We*_.get(qe,Ge+1),_.set(qe,Ge+1,-We*_.get(qe,Ge)+He*_.get(qe,Ge+1)),_.set(qe,Ge,je)}w[Z-2]=Be,1;break;case 4:if(b[pe]<=0&&(b[pe]=b[pe]<0?-b[pe]:0,p))for(var Xe=0;Xe<=fe;Xe++)x.set(Xe,pe,-x.get(Xe,pe));for(;pe<fe&&!(b[pe]>=b[pe+1]);){var Ye=b[pe];if(b[pe]=b[pe+1],b[pe+1]=Ye,p&&pe<a-1)for(var Ke=0;Ke<a;Ke++)Ye=x.get(Ke,pe+1),x.set(Ke,pe+1,x.get(Ke,pe)),x.set(Ke,pe,Ye);if(d&&pe<i-1)for(var Je=0;Je<i;Je++)Ye=_.get(Je,pe+1),_.set(Je,pe+1,_.get(Je,pe)),_.set(Je,pe,Ye);pe++}0,Z--}}if(v){var Qe=x;x=_,_=Qe}this.m=i,this.n=a,this.s=b,this.U=_,this.V=x}return(0,c.Z)(e,[{key:"solve",value:function(e){for(var t=e,n=this.threshold,r=this.s.length,i=K.zeros(r,r),a=0;a<r;a++)Math.abs(this.s[a])<=n?i.set(a,a,0):i.set(a,a,1/this.s[a]);for(var o=this.U,s=this.rightSingularVectors,u=s.mmul(i),l=s.rows,c=o.rows,h=K.zeros(l,c),f=0;f<l;f++)for(var d=0;d<c;d++){for(var p=0,v=0;v<r;v++)p+=u.get(f,v)*o.get(d,v);h.set(f,d,p)}return h.mmul(t)}},{key:"solveForDiagonal",value:function(e){return this.solve(K.diag(e))}},{key:"inverse",value:function(){for(var e=this.V,t=this.threshold,n=e.rows,r=e.columns,i=new K(n,this.s.length),a=0;a<n;a++)for(var o=0;o<r;o++)Math.abs(this.s[o])>t&&i.set(a,o,e.get(a,o)/this.s[o]);for(var s=this.U,u=s.rows,l=s.columns,c=new K(n,u),h=0;h<n;h++)for(var f=0;f<u;f++){for(var d=0,p=0;p<l;p++)d+=i.get(h,p)*s.get(f,p);c.set(h,f,d)}return c}},{key:"condition",get:function(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}},{key:"norm2",get:function(){return this.s[0]}},{key:"rank",get:function(){for(var e=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,t=0,n=this.s,r=0,i=n.length;r<i;r++)n[r]>e&&t++;return t}},{key:"diagonal",get:function(){return Array.from(this.s)}},{key:"threshold",get:function(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}},{key:"leftSingularVectors",get:function(){return this.U}},{key:"rightSingularVectors",get:function(){return this.V}},{key:"diagonalMatrix",get:function(){return K.diag(this.s)}}]),e}();function ne(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e=J.checkMatrix(e),t=J.checkMatrix(t),n?new te(e).solve(t):e.isSquare()?new Q(e).solve(t):new ee(e).solve(t)}function re(e,t,n,r,i){for(var a=n*r*r,o=K.eye(t.length,t.length,a),s=i(t),u=new Float64Array(e.x.length),l=0;l<e.x.length;l++)u[l]=s(e.x[l]);var c=function(e,t,n,r,i){for(var a=n.length,o=e.x.length,s=new Array(a),u=0;u<a;u++){s[u]=new Array(o);var l=n.slice();l[u]+=r;for(var c=i(l),h=0;h<o;h++)s[u][h]=t[h]-c(e.x[h])}return new K(s)}(e,u,t,r,i),h=function(e,t){for(var n=e.x.length,r=new Array(n),i=0;i<n;i++)r[i]=[e.y[i]-t[i]];return new K(r)}(e,u),f=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e=J.checkMatrix(e),t?new te(e).inverse():ne(e,K.eye(e.rows))}(o.add(c.mmul(c.transpose())));return(t=(t=new K([t])).sub(f.mmul(c).mmul(h).mul(r).transpose())).to1DArray()}function ie(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.maxIterations,o=void 0===r?100:r,s=n.gradientDifference,u=void 0===s?.1:s,l=n.damping,c=void 0===l?0:l,h=n.errorTolerance,f=void 0===h?.01:h,d=n.minValues,p=n.maxValues,v=n.initialValues;if(c<=0)throw new Error("The damping option must be a positive number");if(!e.x||!e.y)throw new Error("The data parameter must have x and y elements");if(!i(e.x)||e.x.length<2||!i(e.y)||e.y.length<2)throw new Error("The data parameter elements must be an array with more than 2 points");if(e.x.length!==e.y.length)throw new Error("The data parameter elements must have the same size");var m=v||new Array(t.length).fill(1),g=m.length;if(p=p||new Array(g).fill(Number.MAX_SAFE_INTEGER),d=d||new Array(g).fill(Number.MIN_SAFE_INTEGER),p.length!==d.length)throw new Error("minValues and maxValues must be the same size");if(!i(m))throw new Error("initialValues must be an array");var y,b=a(e,m,t),_=b<=f;for(y=0;y<o&&!_;y++){m=re(e,m,c,u,t);for(var x=0;x<g;x++)m[x]=Math.min(Math.max(d[x],m[x]),p[x]);if(b=a(e,m,t),isNaN(b))break;_=b<=f}return{parameterValues:m,parameterError:b,iterations:y}}},1725:function(e){"use strict";var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function i(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(i){return!1}}()?Object.assign:function(e,a){for(var o,s,u=i(e),l=1;l<arguments.length;l++){for(var c in o=Object(arguments[l]))n.call(o,c)&&(u[c]=o[c]);if(t){s=t(o);for(var h=0;h<s.length;h++)r.call(o,s[h])&&(u[s[h]]=o[s[h]])}}return u}},888:function(e,t,n){"use strict";var r=n(9047);function i(){}function a(){}a.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,a,o){if(o!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:i};return n.PropTypes=n,n}},2007:function(e,t,n){e.exports=n(888)()},9047:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},5743:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.popupWindowBorder=t.popupSupported=t.isSafari=t.gerWindowBorder=void 0;var i=r(n(5524)),a="object"===typeof window?i.default.getParser(window.navigator.userAgent):null;function o(){switch(null===a||void 0===a?void 0:a.getOSName(!0)){case"windows":var e;switch(a.getBrowserName(!0)){case"firefox":e=[68,8,8];break;case"microsoft edge":e=[62,8,8];break;default:e=[60,8,8]}return window.devicePixelRatio>1&&(e[0]-=2,e[1]-=1,e[2]-=1),e;case"macos":switch(a.getBrowserName(!0)){case"safari":return[22,0,0];case"firefox":return[59,0,0];default:return[51,0,0]}}return[60,8,8]}t.gerWindowBorder=o,t.isSafari="safari"===(null===a||void 0===a?void 0:a.getBrowserName(!0)),t.popupSupported="desktop"===(null===a||void 0===a?void 0:a.getPlatformType()),t.popupWindowBorder=o()},2270:function(e,t,n){"use strict";var r=n(6690).default,i=n(9728).default,a=n(7424).default;t.fA=t.xj=void 0;var o=n(5743);function s(e){var t=o.gerWindowBorder(),n=a(t,3),r=n[0],i=n[1],s=n[2];e.outerWidth===e.screen.availWidth&&(i=0,s=0);var u=(e.outerWidth-2*i)/e.innerWidth,l=(e.outerHeight-r-s)/e.innerHeight,c=Math.min(l,u);return c=c>1.8?Math.round(c):c>.73?Math.round(20*c)/20:2/Math.round(2/c)}function u(e){var t=e?s(e):1,n=e.outerWidth-e.innerWidth*t>>1,r=Math.round(e.outerHeight-e.innerHeight*t);return n>32?n=8:r-=n,[n,r,t]}var l=function(){function e(){r(this,e)}return i(e,[{key:"init",value:function(e,t,n,r,i,a,o,s){this.scaleX=o/n,this.scaleY=s/r,this.offsetX=i-e*this.scaleX,this.offsetY=a-t*this.scaleY}},{key:"map",value:function(e){return{x:e.x*this.scaleX+this.offsetX,y:e.y*this.scaleY+this.offsetY}}},{key:"revertMap",value:function(e){return{x:(e.x-this.offsetX)/this.scaleX,y:(e.y-this.offsetY)/this.scaleY}}}]),e}();t.xj=function e(t,n){if(!t)return null;var r,i=t.getBoundingClientRect(),o=new l;if(o.init(0,0,t.offsetWidth,t.offsetHeight,i.x,i.y,i.width,i.height),n){var s=o.map({x:n.left,y:n.top}),c=s.x,h=s.y,f=o.map({x:n.left+n.width,y:n.top+n.height});r={left:c,top:h,width:f.x-c,height:f.y-h}}else r={left:i.left,top:i.top,width:i.width,height:i.height};var d=t.ownerDocument.defaultView;if(!d)return i;if(d.frameElement)return e(d.frameElement,r);var p=u(d),v=a(p,3),m=v[0],g=v[1],y=v[2];return 1!==y&&(r.left*=y,r.top*=y,r.width*=y,r.height*=y),r.left+=d.screenX+m,r.top+=d.screenY+g,r},t.fA=function e(t,n,r){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!t)return null;if(n){if(r={left:n.screenX,top:n.screenY,width:n.outerWidth,height:n.outerHeight},i){var s=a(o.popupWindowBorder,3),c=s[0],h=s[1],f=s[2];r.left+=h,r.top+=c,r.width-=2*h,r.height-=c+f}}else if(!r)return null;var d=t.ownerDocument,p=d.defaultView;if(!p)return r;if(p.frameElement)r=e(p.frameElement,null,r);else{var v=u(p),m=a(v,3),g=m[0],y=m[1],b=m[2];r.left-=p.screenX+g,r.top-=p.screenY+y,1!==b&&(r.left/=b,r.top/=b,r.width/=b,r.height/=b)}var _=t.getBoundingClientRect(),x=new l;x.init(0,0,t.offsetWidth,t.offsetHeight,_.x,_.y,_.width,_.height);var w=x.revertMap({x:r.left,y:r.top}),S=w.x,M=w.y,k=x.revertMap({x:r.left+r.width,y:r.top+r.height}),T=k.x,E=k.y;return{left:S,top:M,width:T-S,height:E-M}}},4501:function(e,t){"use strict";var n="function"===typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,a=n?Symbol.for("react.fragment"):60107,o=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,u=n?Symbol.for("react.provider"):60109,l=n?Symbol.for("react.context"):60110,c=n?Symbol.for("react.async_mode"):60111,h=n?Symbol.for("react.concurrent_mode"):60111,f=n?Symbol.for("react.forward_ref"):60112,d=n?Symbol.for("react.suspense"):60113,p=n?Symbol.for("react.suspense_list"):60120,v=n?Symbol.for("react.memo"):60115,m=n?Symbol.for("react.lazy"):60116,g=n?Symbol.for("react.block"):60121,y=n?Symbol.for("react.fundamental"):60117,b=n?Symbol.for("react.responder"):60118,_=n?Symbol.for("react.scope"):60119;function x(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case c:case h:case a:case s:case o:case d:return e;default:switch(e=e&&e.$$typeof){case l:case f:case m:case v:case u:return e;default:return t}}case i:return t}}}function w(e){return x(e)===h}t.isFragment=function(e){return x(e)===a},t.isMemo=function(e){return x(e)===v}},3873:function(e,t,n){"use strict";e.exports=n(4501)},4463:function(e,t,n){"use strict";var r=n(2791),i=n(5296);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function u(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(s[e]=t,e=0;e<t.length;e++)o.add(t[e])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},p={};function v(e,t,n,r,i,a,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new v(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new v(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new v(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new v(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new v(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new v(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)}));var g=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var i=m.hasOwnProperty(t)?m[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!h.call(p,e)||!h.call(d,e)&&(f.test(e)?p[e]=!0:(d[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(g,y);m[t]=new v(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(g,y);m[t]=new v(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(g,y);m[t]=new v(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)}));var _=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),w=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),E=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),L=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var N=Symbol.iterator;function I(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=N&&e[N]||e["@@iterator"])?e:null}var O,U=Object.assign;function F(e){if(void 0===O)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);O=t&&t[1]||""}return"\n"+O+e}var z=!1;function B(e,t){if(!e||z)return"";z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&"string"===typeof l.stack){for(var i=l.stack.split("\n"),a=r.stack.split("\n"),o=i.length-1,s=a.length-1;1<=o&&0<=s&&i[o]!==a[s];)s--;for(;1<=o&&0<=s;o--,s--)if(i[o]!==a[s]){if(1!==o||1!==s)do{if(o--,0>--s||i[o]!==a[s]){var u="\n"+i[o].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=o&&0<=s);break}}}finally{z=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function V(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=B(e.type,!1);case 11:return e=B(e.type.render,!1);case 1:return e=B(e.type,!0);default:return""}}function G(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case w:return"Portal";case k:return"Profiler";case M:return"StrictMode";case A:return"Suspense";case R:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case E:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case P:return null!==(t=e.displayName||null)?t:G(e.type)||"Memo";case L:t=e._payload,e=e._init;try{return G(e(t))}catch(n){}}return null}function j(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return G(t);case 8:return t===M?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Z(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function q(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=W(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function X(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return U({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function K(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function Q(e,t){J(e,t);var n=H(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&X(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return U({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(te(n)){if(1<n.length)throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function ae(e,t){var n=H(t.value),r=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ue(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var le,ce=function(e){return"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction((function(){return e(t,n)}))}:e}((function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((le=le||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=le.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}}));function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},de=["Webkit","ms","Moz","O"];function pe(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ve(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=pe(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(fe).forEach((function(e){de.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var me=U({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ge(e,t){if(t){if(me[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function ye(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function _e(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var xe=null,we=null,Se=null;function Me(e){if(e=vi(e)){if("function"!==typeof xe)throw Error(a(280));var t=e.stateNode;t&&(t=gi(t),xe(e.stateNode,e.type,t))}}function ke(e){we?Se?Se.push(e):Se=[e]:we=e}function Te(){if(we){var e=we,t=Se;if(Se=we=null,Me(e),t)for(e=0;e<t.length;e++)Me(t[e])}}function Ee(e,t){return e(t)}function Ce(){}var Ae=!1;function Re(e,t,n){if(Ae)return e(t,n);Ae=!0;try{return Ee(e,t,n)}finally{Ae=!1,(null!==we||null!==Se)&&(Ce(),Te())}}function Pe(e,t){var n=e.stateNode;if(null===n)return null;var r=gi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var Le=!1;if(c)try{var De={};Object.defineProperty(De,"passive",{get:function(){Le=!0}}),window.addEventListener("test",De,De),window.removeEventListener("test",De,De)}catch(tc){Le=!1}function Ne(e,t,n,r,i,a,o,s,u){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(c){this.onError(c)}}var Ie=!1,Oe=null,Ue=!1,Fe=null,ze={onError:function(e){Ie=!0,Oe=e}};function Be(e,t,n,r,i,a,o,s,u){Ie=!1,Oe=null,Ne.apply(ze,arguments)}function Ve(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ge(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function je(e){if(Ve(e)!==e)throw Error(a(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return je(i),e;if(o===r)return je(i),t;o=o.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,u=i.child;u;){if(u===n){s=!0,n=i,r=o;break}if(u===r){s=!0,r=i,n=o;break}u=u.sibling}if(!s){for(u=o.child;u;){if(u===n){s=!0,n=o,r=i;break}if(u===r){s=!0,r=o,n=i;break}u=u.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e))?We(e):null}function We(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=We(e);if(null!==t)return t;e=e.sibling}return null}var Ze=i.unstable_scheduleCallback,qe=i.unstable_cancelCallback,Xe=i.unstable_shouldYield,Ye=i.unstable_requestPaint,Ke=i.unstable_now,Je=i.unstable_getCurrentPriorityLevel,Qe=i.unstable_ImmediatePriority,$e=i.unstable_UserBlockingPriority,et=i.unstable_NormalPriority,tt=i.unstable_LowPriority,nt=i.unstable_IdlePriority,rt=null,it=null;var at=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(ot(e)/st|0)|0},ot=Math.log,st=Math.LN2;var ut=64,lt=4194304;function ct(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,o=268435455&n;if(0!==o){var s=o&~i;0!==s?r=ct(s):0!==(a&=o)&&(r=ct(a))}else 0!==(o=n&~i)?r=ct(o):0!==a&&(r=ct(a));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(a=t&-t)||16===i&&0!==(4194240&a)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-at(t)),r|=e[n],t&=~i;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function dt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function pt(){var e=ut;return 0===(4194240&(ut<<=1))&&(ut=64),e}function vt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function mt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function gt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-at(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var yt=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var _t,xt,wt,St,Mt,kt=!1,Tt=[],Et=null,Ct=null,At=null,Rt=new Map,Pt=new Map,Lt=[],Dt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Nt(e,t){switch(e){case"focusin":case"focusout":Et=null;break;case"dragenter":case"dragleave":Ct=null;break;case"mouseover":case"mouseout":At=null;break;case"pointerover":case"pointerout":Rt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pt.delete(t.pointerId)}}function It(e,t,n,r,i,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},null!==t&&(null!==(t=vi(t))&&xt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ot(e){var t=pi(e.target);if(null!==t){var n=Ve(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ge(n)))return e.blockedOn=t,void Mt(e.priority,(function(){wt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ut(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Xt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=vi(n))&&xt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);be=r,n.target.dispatchEvent(r),be=null,t.shift()}return!0}function Ft(e,t,n){Ut(e)&&n.delete(t)}function zt(){kt=!1,null!==Et&&Ut(Et)&&(Et=null),null!==Ct&&Ut(Ct)&&(Ct=null),null!==At&&Ut(At)&&(At=null),Rt.forEach(Ft),Pt.forEach(Ft)}function Bt(e,t){e.blockedOn===t&&(e.blockedOn=null,kt||(kt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,zt)))}function Vt(e){function t(t){return Bt(t,e)}if(0<Tt.length){Bt(Tt[0],e);for(var n=1;n<Tt.length;n++){var r=Tt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Et&&Bt(Et,e),null!==Ct&&Bt(Ct,e),null!==At&&Bt(At,e),Rt.forEach(t),Pt.forEach(t),n=0;n<Lt.length;n++)(r=Lt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Lt.length&&null===(n=Lt[0]).blockedOn;)Ot(n),null===n.blockedOn&&Lt.shift()}var Gt=_.ReactCurrentBatchConfig,jt=!0;function Ht(e,t,n,r){var i=yt,a=Gt.transition;Gt.transition=null;try{yt=1,Zt(e,t,n,r)}finally{yt=i,Gt.transition=a}}function Wt(e,t,n,r){var i=yt,a=Gt.transition;Gt.transition=null;try{yt=4,Zt(e,t,n,r)}finally{yt=i,Gt.transition=a}}function Zt(e,t,n,r){if(jt){var i=Xt(e,t,n,r);if(null===i)Br(e,t,r,qt,n),Nt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Et=It(Et,e,t,n,r,i),!0;case"dragenter":return Ct=It(Ct,e,t,n,r,i),!0;case"mouseover":return At=It(At,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return Rt.set(a,It(Rt.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Pt.set(a,It(Pt.get(a)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Nt(e,r),4&t&&-1<Dt.indexOf(e)){for(;null!==i;){var a=vi(i);if(null!==a&&_t(a),null===(a=Xt(e,t,n,r))&&Br(e,t,r,qt,n),a===i)break;i=a}null!==i&&r.stopPropagation()}else Br(e,t,r,null,n)}}var qt=null;function Xt(e,t,n,r){if(qt=null,null!==(e=pi(e=_e(r))))if(null===(t=Ve(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ge(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return qt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Qe:return 1;case $e:return 4;case et:case tt:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Kt=null,Jt=null,Qt=null;function $t(){if(Qt)return Qt;var e,t,n=Jt,r=n.length,i="value"in Kt?Kt.value:Kt.textContent,a=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[a-t];t++);return Qt=i.slice(e,1<t?1-t:void 0)}function en(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function tn(){return!0}function nn(){return!1}function rn(e){function t(t,n,r,i,a){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?tn:nn,this.isPropagationStopped=nn,this}return U(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=tn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=tn)},persist:function(){},isPersistent:tn}),t}var an,on,sn,un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ln=rn(un),cn=U({},un,{view:0,detail:0}),hn=rn(cn),fn=U({},cn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==sn&&(sn&&"mousemove"===e.type?(an=e.screenX-sn.screenX,on=e.screenY-sn.screenY):on=an=0,sn=e),an)},movementY:function(e){return"movementY"in e?e.movementY:on}}),dn=rn(fn),pn=rn(U({},fn,{dataTransfer:0})),vn=rn(U({},cn,{relatedTarget:0})),mn=rn(U({},un,{animationName:0,elapsedTime:0,pseudoElement:0})),gn=rn(U({},un,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),yn=rn(U({},un,{data:0})),bn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_n={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=xn[e])&&!!t[e]}function Sn(){return wn}var Mn=rn(U({},cn,{key:function(e){if(e.key){var t=bn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=en(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?_n[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sn,charCode:function(e){return"keypress"===e.type?en(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?en(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),kn=rn(U({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Tn=rn(U({},cn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sn})),En=rn(U({},un,{propertyName:0,elapsedTime:0,pseudoElement:0})),Cn=rn(U({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),An=[9,13,27,32],Rn=c&&"CompositionEvent"in window,Pn=null;c&&"documentMode"in document&&(Pn=document.documentMode);var Ln=c&&"TextEvent"in window&&!Pn,Dn=c&&(!Rn||Pn&&8<Pn&&11>=Pn),Nn=String.fromCharCode(32),In=!1;function On(e,t){switch(e){case"keyup":return-1!==An.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Un(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Fn=!1;var zn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Bn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!zn[e.type]:"textarea"===t}function Vn(e,t,n,r){ke(r),0<(t=Gr(t,"onChange")).length&&(n=new ln("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Gn=null,jn=null;function Hn(e){Nr(e,0)}function Wn(e){if(q(mi(e)))return e}function Zn(e,t){if("change"===e)return t}var qn=!1;if(c){var Xn;if(c){var Yn="oninput"in document;if(!Yn){var Kn=document.createElement("div");Kn.setAttribute("oninput","return;"),Yn="function"===typeof Kn.oninput}Xn=Yn}else Xn=!1;qn=Xn&&(!document.documentMode||9<document.documentMode)}function Jn(){Gn&&(Gn.detachEvent("onpropertychange",Qn),jn=Gn=null)}function Qn(e){if("value"===e.propertyName&&Wn(jn)){var t=[];Vn(t,jn,e,_e(e)),Re(Hn,t)}}function $n(e,t,n){"focusin"===e?(Jn(),jn=n,(Gn=t).attachEvent("onpropertychange",Qn)):"focusout"===e&&Jn()}function er(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Wn(jn)}function tr(e,t){if("click"===e)return Wn(t)}function nr(e,t){if("input"===e||"change"===e)return Wn(t)}var rr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ir(e,t){if(rr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!h.call(t,i)||!rr(e[i],t[i]))return!1}return!0}function ar(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function or(e,t){var n,r=ar(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ar(r)}}function sr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?sr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ur(){for(var e=window,t=X();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=X((e=t.contentWindow).document)}return t}function lr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function cr(e){var t=ur(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&sr(n.ownerDocument.documentElement,n)){if(null!==r&&lr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=void 0===r.end?a:Math.min(r.end,i),!e.extend&&a>r&&(i=r,r=a,a=i),i=or(n,a);var o=or(n,r);i&&o&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var hr=c&&"documentMode"in document&&11>=document.documentMode,fr=null,dr=null,pr=null,vr=!1;function mr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;vr||null==fr||fr!==X(r)||("selectionStart"in(r=fr)&&lr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},pr&&ir(pr,r)||(pr=r,0<(r=Gr(dr,"onSelect")).length&&(t=new ln("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=fr)))}function gr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var yr={animationend:gr("Animation","AnimationEnd"),animationiteration:gr("Animation","AnimationIteration"),animationstart:gr("Animation","AnimationStart"),transitionend:gr("Transition","TransitionEnd")},br={},_r={};function xr(e){if(br[e])return br[e];if(!yr[e])return e;var t,n=yr[e];for(t in n)if(n.hasOwnProperty(t)&&t in _r)return br[e]=n[t];return e}c&&(_r=document.createElement("div").style,"AnimationEvent"in window||(delete yr.animationend.animation,delete yr.animationiteration.animation,delete yr.animationstart.animation),"TransitionEvent"in window||delete yr.transitionend.transition);var wr=xr("animationend"),Sr=xr("animationiteration"),Mr=xr("animationstart"),kr=xr("transitionend"),Tr=new Map,Er="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Cr(e,t){Tr.set(e,t),u(t,[e])}for(var Ar=0;Ar<Er.length;Ar++){var Rr=Er[Ar];Cr(Rr.toLowerCase(),"on"+(Rr[0].toUpperCase()+Rr.slice(1)))}Cr(wr,"onAnimationEnd"),Cr(Sr,"onAnimationIteration"),Cr(Mr,"onAnimationStart"),Cr("dblclick","onDoubleClick"),Cr("focusin","onFocus"),Cr("focusout","onBlur"),Cr(kr,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pr));function Dr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,o,s,u,l){if(Be.apply(this,arguments),Ie){if(!Ie)throw Error(a(198));var c=Oe;Ie=!1,Oe=null,Ue||(Ue=!0,Fe=c)}}(r,t,void 0,e),e.currentTarget=null}function Nr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],u=s.instance,l=s.currentTarget;if(s=s.listener,u!==a&&i.isPropagationStopped())break e;Dr(i,s,l),a=u}else for(o=0;o<r.length;o++){if(u=(s=r[o]).instance,l=s.currentTarget,s=s.listener,u!==a&&i.isPropagationStopped())break e;Dr(i,s,l),a=u}}}if(Ue)throw e=Fe,Ue=!1,Fe=null,e}function Ir(e,t){var n=t[hi];void 0===n&&(n=t[hi]=new Set);var r=e+"__bubble";n.has(r)||(zr(t,e,2,!1),n.add(r))}function Or(e,t,n){var r=0;t&&(r|=4),zr(n,e,r,t)}var Ur="_reactListening"+Math.random().toString(36).slice(2);function Fr(e){if(!e[Ur]){e[Ur]=!0,o.forEach((function(t){"selectionchange"!==t&&(Lr.has(t)||Or(t,!1,e),Or(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ur]||(t[Ur]=!0,Or("selectionchange",!1,t))}}function zr(e,t,n,r){switch(Yt(t)){case 1:var i=Ht;break;case 4:i=Wt;break;default:i=Zt}n=i.bind(null,t,n,e),i=void 0,!Le||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Br(e,t,n,r,i){var a=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var s=r.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var u=o.tag;if((3===u||4===u)&&((u=o.stateNode.containerInfo)===i||8===u.nodeType&&u.parentNode===i))return;o=o.return}for(;null!==s;){if(null===(o=pi(s)))return;if(5===(u=o.tag)||6===u){r=a=o;continue e}s=s.parentNode}}r=r.return}Re((function(){var r=a,i=_e(n),o=[];e:{var s=Tr.get(e);if(void 0!==s){var u=ln,l=e;switch(e){case"keypress":if(0===en(n))break e;case"keydown":case"keyup":u=Mn;break;case"focusin":l="focus",u=vn;break;case"focusout":l="blur",u=vn;break;case"beforeblur":case"afterblur":u=vn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=dn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=pn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=Tn;break;case wr:case Sr:case Mr:u=mn;break;case kr:u=En;break;case"scroll":u=hn;break;case"wheel":u=Cn;break;case"copy":case"cut":case"paste":u=gn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=kn}var c=0!==(4&t),h=!c&&"scroll"===e,f=c?null!==s?s+"Capture":null:s;c=[];for(var d,p=r;null!==p;){var v=(d=p).stateNode;if(5===d.tag&&null!==v&&(d=v,null!==f&&(null!=(v=Pe(p,f))&&c.push(Vr(p,v,d)))),h)break;p=p.return}0<c.length&&(s=new u(s,l,null,n,i),o.push({event:s,listeners:c}))}}if(0===(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===be||!(l=n.relatedTarget||n.fromElement)||!pi(l)&&!l[ci])&&(u||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,u?(u=r,null!==(l=(l=n.relatedTarget||n.toElement)?pi(l):null)&&(l!==(h=Ve(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(u=null,l=r),u!==l)){if(c=dn,v="onMouseLeave",f="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(c=kn,v="onPointerLeave",f="onPointerEnter",p="pointer"),h=null==u?s:mi(u),d=null==l?s:mi(l),(s=new c(v,p+"leave",u,n,i)).target=h,s.relatedTarget=d,v=null,pi(i)===r&&((c=new c(f,p+"enter",l,n,i)).target=d,c.relatedTarget=h,v=c),h=v,u&&l)e:{for(f=l,p=0,d=c=u;d;d=jr(d))p++;for(d=0,v=f;v;v=jr(v))d++;for(;0<p-d;)c=jr(c),p--;for(;0<d-p;)f=jr(f),d--;for(;p--;){if(c===f||null!==f&&c===f.alternate)break e;c=jr(c),f=jr(f)}c=null}else c=null;null!==u&&Hr(o,s,u,c,!1),null!==l&&null!==h&&Hr(o,h,l,c,!0)}if("select"===(u=(s=r?mi(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===u&&"file"===s.type)var m=Zn;else if(Bn(s))if(qn)m=nr;else{m=er;var g=$n}else(u=s.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(m=tr);switch(m&&(m=m(e,r))?Vn(o,m,n,i):(g&&g(e,s,r),"focusout"===e&&(g=s._wrapperState)&&g.controlled&&"number"===s.type&&ee(s,"number",s.value)),g=r?mi(r):window,e){case"focusin":(Bn(g)||"true"===g.contentEditable)&&(fr=g,dr=r,pr=null);break;case"focusout":pr=dr=fr=null;break;case"mousedown":vr=!0;break;case"contextmenu":case"mouseup":case"dragend":vr=!1,mr(o,n,i);break;case"selectionchange":if(hr)break;case"keydown":case"keyup":mr(o,n,i)}var y;if(Rn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Fn?On(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Dn&&"ko"!==n.locale&&(Fn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Fn&&(y=$t()):(Jt="value"in(Kt=i)?Kt.value:Kt.textContent,Fn=!0)),0<(g=Gr(r,b)).length&&(b=new yn(b,e,null,n,i),o.push({event:b,listeners:g}),y?b.data=y:null!==(y=Un(n))&&(b.data=y))),(y=Ln?function(e,t){switch(e){case"compositionend":return Un(t);case"keypress":return 32!==t.which?null:(In=!0,Nn);case"textInput":return(e=t.data)===Nn&&In?null:e;default:return null}}(e,n):function(e,t){if(Fn)return"compositionend"===e||!Rn&&On(e,t)?(e=$t(),Qt=Jt=Kt=null,Fn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Dn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Gr(r,"onBeforeInput")).length&&(i=new yn("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=y))}Nr(o,t)}))}function Vr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Gr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=Pe(e,n))&&r.unshift(Vr(e,a,i)),null!=(a=Pe(e,t))&&r.push(Vr(e,a,i))),e=e.return}return r}function jr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Hr(e,t,n,r,i){for(var a=t._reactName,o=[];null!==n&&n!==r;){var s=n,u=s.alternate,l=s.stateNode;if(null!==u&&u===r)break;5===s.tag&&null!==l&&(s=l,i?null!=(u=Pe(n,a))&&o.unshift(Vr(n,u,s)):i||null!=(u=Pe(n,a))&&o.push(Vr(n,u,s))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Wr=/\r\n?/g,Zr=/\u0000|\uFFFD/g;function qr(e){return("string"===typeof e?e:""+e).replace(Wr,"\n").replace(Zr,"")}function Xr(e,t,n){if(t=qr(t),qr(e)!==t&&n)throw Error(a(425))}function Yr(){}var Kr=null,Jr=null;function Qr(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var $r="function"===typeof setTimeout?setTimeout:void 0,ei="function"===typeof clearTimeout?clearTimeout:void 0,ti="function"===typeof Promise?Promise:void 0,ni="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ti?function(e){return ti.resolve(null).then(e).catch(ri)}:$r;function ri(e){setTimeout((function(){throw e}))}function ii(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Vt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Vt(t)}function ai(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function oi(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var si=Math.random().toString(36).slice(2),ui="__reactFiber$"+si,li="__reactProps$"+si,ci="__reactContainer$"+si,hi="__reactEvents$"+si,fi="__reactListeners$"+si,di="__reactHandles$"+si;function pi(e){var t=e[ui];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ci]||n[ui]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=oi(e);null!==e;){if(n=e[ui])return n;e=oi(e)}return t}n=(e=n).parentNode}return null}function vi(e){return!(e=e[ui]||e[ci])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function mi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function gi(e){return e[li]||null}var yi=[],bi=-1;function _i(e){return{current:e}}function xi(e){0>bi||(e.current=yi[bi],yi[bi]=null,bi--)}function wi(e,t){bi++,yi[bi]=e.current,e.current=t}var Si={},Mi=_i(Si),ki=_i(!1),Ti=Si;function Ei(e,t){var n=e.type.contextTypes;if(!n)return Si;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in n)a[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Ci(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ai(){xi(ki),xi(Mi)}function Ri(e,t,n){if(Mi.current!==Si)throw Error(a(168));wi(Mi,t),wi(ki,n)}function Pi(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(a(108,j(e)||"Unknown",i));return U({},n,r)}function Li(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Si,Ti=Mi.current,wi(Mi,e),wi(ki,ki.current),!0}function Di(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=Pi(e,t,Ti),r.__reactInternalMemoizedMergedChildContext=e,xi(ki),xi(Mi),wi(Mi,e)):xi(ki),wi(ki,n)}var Ni=null,Ii=!1,Oi=!1;function Ui(e){null===Ni?Ni=[e]:Ni.push(e)}function Fi(){if(!Oi&&null!==Ni){Oi=!0;var e=0,t=yt;try{var n=Ni;for(yt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Ni=null,Ii=!1}catch(i){throw null!==Ni&&(Ni=Ni.slice(e+1)),Ze(Qe,Fi),i}finally{yt=t,Oi=!1}}return null}var zi=[],Bi=0,Vi=null,Gi=0,ji=[],Hi=0,Wi=null,Zi=1,qi="";function Xi(e,t){zi[Bi++]=Gi,zi[Bi++]=Vi,Vi=e,Gi=t}function Yi(e,t,n){ji[Hi++]=Zi,ji[Hi++]=qi,ji[Hi++]=Wi,Wi=e;var r=Zi;e=qi;var i=32-at(r)-1;r&=~(1<<i),n+=1;var a=32-at(t)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Zi=1<<32-at(t)+i|n<<i|r,qi=a+e}else Zi=1<<a|n<<i|r,qi=e}function Ki(e){null!==e.return&&(Xi(e,1),Yi(e,1,0))}function Ji(e){for(;e===Vi;)Vi=zi[--Bi],zi[Bi]=null,Gi=zi[--Bi],zi[Bi]=null;for(;e===Wi;)Wi=ji[--Hi],ji[Hi]=null,qi=ji[--Hi],ji[Hi]=null,Zi=ji[--Hi],ji[Hi]=null}var Qi=null,$i=null,ea=!1,ta=null;function na(e,t){var n=El(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function ra(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,Qi=e,$i=ai(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,Qi=e,$i=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Wi?{id:Zi,overflow:qi}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=El(18,null,null,0)).stateNode=t,n.return=e,e.child=n,Qi=e,$i=null,!0);default:return!1}}function ia(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function aa(e){if(ea){var t=$i;if(t){var n=t;if(!ra(e,t)){if(ia(e))throw Error(a(418));t=ai(n.nextSibling);var r=Qi;t&&ra(e,t)?na(r,n):(e.flags=-4097&e.flags|2,ea=!1,Qi=e)}}else{if(ia(e))throw Error(a(418));e.flags=-4097&e.flags|2,ea=!1,Qi=e}}}function oa(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Qi=e}function sa(e){if(e!==Qi)return!1;if(!ea)return oa(e),ea=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!Qr(e.type,e.memoizedProps)),t&&(t=$i)){if(ia(e))throw ua(),Error(a(418));for(;t;)na(e,t),t=ai(t.nextSibling)}if(oa(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){$i=ai(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}$i=null}}else $i=Qi?ai(e.stateNode.nextSibling):null;return!0}function ua(){for(var e=$i;e;)e=ai(e.nextSibling)}function la(){$i=Qi=null,ea=!1}function ca(e){null===ta?ta=[e]:ta.push(e)}var ha=_.ReactCurrentBatchConfig;function fa(e,t){if(e&&e.defaultProps){for(var n in t=U({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var da=_i(null),pa=null,va=null,ma=null;function ga(){ma=va=pa=null}function ya(e){var t=da.current;xi(da),e._currentValue=t}function ba(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function _a(e,t){pa=e,ma=va=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ms=!0),e.firstContext=null)}function xa(e){var t=e._currentValue;if(ma!==e)if(e={context:e,memoizedValue:t,next:null},null===va){if(null===pa)throw Error(a(308));va=e,pa.dependencies={lanes:0,firstContext:e}}else va=va.next=e;return t}var wa=null;function Sa(e){null===wa?wa=[e]:wa.push(e)}function Ma(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Sa(t)):(n.next=i.next,i.next=n),t.interleaved=n,ka(e,r)}function ka(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ta=!1;function Ea(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ca(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Aa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ra(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Mu)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,ka(e,n)}return null===(i=r.interleaved)?(t.next=t,Sa(r)):(t.next=i.next,i.next=t),r.interleaved=t,ka(e,n)}function Pa(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,gt(e,n)}}function La(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?i=a=o:a=a.next=o,n=n.next}while(null!==n);null===a?i=a=t:a=a.next=t}else i=a=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Da(e,t,n,r){var i=e.updateQueue;Ta=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var u=s,l=u.next;u.next=null,null===o?a=l:o.next=l,o=u;var c=e.alternate;null!==c&&((s=(c=c.updateQueue).lastBaseUpdate)!==o&&(null===s?c.firstBaseUpdate=l:s.next=l,c.lastBaseUpdate=u))}if(null!==a){var h=i.baseState;for(o=0,c=l=u=null,s=a;;){var f=s.lane,d=s.eventTime;if((r&f)===f){null!==c&&(c=c.next={eventTime:d,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var p=e,v=s;switch(f=t,d=n,v.tag){case 1:if("function"===typeof(p=v.payload)){h=p.call(d,h,f);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(f="function"===typeof(p=v.payload)?p.call(d,h,f):p)||void 0===f)break e;h=U({},h,f);break e;case 2:Ta=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(f=i.effects)?i.effects=[s]:f.push(s))}else d={eventTime:d,lane:f,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===c?(l=c=d,u=h):c=c.next=d,o|=f;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(f=s).next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}if(null===c&&(u=h),i.baseState=u,i.firstBaseUpdate=l,i.lastBaseUpdate=c,null!==(t=i.shared.interleaved)){i=t;do{o|=i.lane,i=i.next}while(i!==t)}else null===a&&(i.shared.lanes=0);Lu|=o,e.lanes=o,e.memoizedState=h}}function Na(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(a(191,i));i.call(r)}}}var Ia=(new r.Component).refs;function Oa(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:U({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Ua={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Ku(),i=Ju(e),a=Aa(r,i);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Ra(e,a,i))&&(Qu(t,e,i,r),Pa(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Ku(),i=Ju(e),a=Aa(r,i);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Ra(e,a,i))&&(Qu(t,e,i,r),Pa(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ku(),r=Ju(e),i=Aa(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Ra(e,i,r))&&(Qu(t,e,r,n),Pa(t,e,r))}};function Fa(e,t,n,r,i,a,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,o):!t.prototype||!t.prototype.isPureReactComponent||(!ir(n,r)||!ir(i,a))}function za(e,t,n){var r=!1,i=Si,a=t.contextType;return"object"===typeof a&&null!==a?a=xa(a):(i=Ci(t)?Ti:Mi.current,a=(r=null!==(r=t.contextTypes)&&void 0!==r)?Ei(e,i):Si),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Ua,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function Ba(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Ua.enqueueReplaceState(t,t.state,null)}function Va(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=Ia,Ea(e);var a=t.contextType;"object"===typeof a&&null!==a?i.context=xa(a):(a=Ci(t)?Ti:Mi.current,i.context=Ei(e,a)),i.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(Oa(e,t,a,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&Ua.enqueueReplaceState(i,i.state,null),Da(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function Ga(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var i=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=i.refs;t===Ia&&(t=i.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function ja(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ha(e){return(0,e._init)(e._payload)}function Wa(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Al(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function u(e,t,n,r){return null===t||6!==t.tag?((t=Dl(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function l(e,t,n,r){var a=n.type;return a===S?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===L&&Ha(a)===t.type)?((r=i(t,n.props)).ref=Ga(e,t,n),r.return=e,r):((r=Rl(n.type,n.key,n.props,null,e.mode,r)).ref=Ga(e,t,n),r.return=e,r)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Nl(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function h(e,t,n,r,a){return null===t||7!==t.tag?((t=Pl(n,e.mode,r,a)).return=e,t):((t=i(t,n)).return=e,t)}function f(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Dl(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case x:return(n=Rl(t.type,t.key,t.props,null,e.mode,n)).ref=Ga(e,null,t),n.return=e,n;case w:return(t=Nl(t,e.mode,n)).return=e,t;case L:return f(e,(0,t._init)(t._payload),n)}if(te(t)||I(t))return(t=Pl(t,e.mode,n,null)).return=e,t;ja(e,t)}return null}function d(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:u(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case x:return n.key===i?l(e,t,n,r):null;case w:return n.key===i?c(e,t,n,r):null;case L:return d(e,t,(i=n._init)(n._payload),r)}if(te(n)||I(n))return null!==i?null:h(e,t,n,r,null);ja(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return u(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case x:return l(t,e=e.get(null===r.key?n:r.key)||null,r,i);case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case L:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||I(r))return h(t,e=e.get(n)||null,r,i,null);ja(t,r)}return null}function v(i,a,s,u){for(var l=null,c=null,h=a,v=a=0,m=null;null!==h&&v<s.length;v++){h.index>v?(m=h,h=null):m=h.sibling;var g=d(i,h,s[v],u);if(null===g){null===h&&(h=m);break}e&&h&&null===g.alternate&&t(i,h),a=o(g,a,v),null===c?l=g:c.sibling=g,c=g,h=m}if(v===s.length)return n(i,h),ea&&Xi(i,v),l;if(null===h){for(;v<s.length;v++)null!==(h=f(i,s[v],u))&&(a=o(h,a,v),null===c?l=h:c.sibling=h,c=h);return ea&&Xi(i,v),l}for(h=r(i,h);v<s.length;v++)null!==(m=p(h,i,v,s[v],u))&&(e&&null!==m.alternate&&h.delete(null===m.key?v:m.key),a=o(m,a,v),null===c?l=m:c.sibling=m,c=m);return e&&h.forEach((function(e){return t(i,e)})),ea&&Xi(i,v),l}function m(i,s,u,l){var c=I(u);if("function"!==typeof c)throw Error(a(150));if(null==(u=c.call(u)))throw Error(a(151));for(var h=c=null,v=s,m=s=0,g=null,y=u.next();null!==v&&!y.done;m++,y=u.next()){v.index>m?(g=v,v=null):g=v.sibling;var b=d(i,v,y.value,l);if(null===b){null===v&&(v=g);break}e&&v&&null===b.alternate&&t(i,v),s=o(b,s,m),null===h?c=b:h.sibling=b,h=b,v=g}if(y.done)return n(i,v),ea&&Xi(i,m),c;if(null===v){for(;!y.done;m++,y=u.next())null!==(y=f(i,y.value,l))&&(s=o(y,s,m),null===h?c=y:h.sibling=y,h=y);return ea&&Xi(i,m),c}for(v=r(i,v);!y.done;m++,y=u.next())null!==(y=p(v,i,m,y.value,l))&&(e&&null!==y.alternate&&v.delete(null===y.key?m:y.key),s=o(y,s,m),null===h?c=y:h.sibling=y,h=y);return e&&v.forEach((function(e){return t(i,e)})),ea&&Xi(i,m),c}return function e(r,a,o,u){if("object"===typeof o&&null!==o&&o.type===S&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case x:e:{for(var l=o.key,c=a;null!==c;){if(c.key===l){if((l=o.type)===S){if(7===c.tag){n(r,c.sibling),(a=i(c,o.props.children)).return=r,r=a;break e}}else if(c.elementType===l||"object"===typeof l&&null!==l&&l.$$typeof===L&&Ha(l)===c.type){n(r,c.sibling),(a=i(c,o.props)).ref=Ga(r,c,o),a.return=r,r=a;break e}n(r,c);break}t(r,c),c=c.sibling}o.type===S?((a=Pl(o.props.children,r.mode,u,o.key)).return=r,r=a):((u=Rl(o.type,o.key,o.props,null,r.mode,u)).ref=Ga(r,a,o),u.return=r,r=u)}return s(r);case w:e:{for(c=o.key;null!==a;){if(a.key===c){if(4===a.tag&&a.stateNode.containerInfo===o.containerInfo&&a.stateNode.implementation===o.implementation){n(r,a.sibling),(a=i(a,o.children||[])).return=r,r=a;break e}n(r,a);break}t(r,a),a=a.sibling}(a=Nl(o,r.mode,u)).return=r,r=a}return s(r);case L:return e(r,a,(c=o._init)(o._payload),u)}if(te(o))return v(r,a,o,u);if(I(o))return m(r,a,o,u);ja(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==a&&6===a.tag?(n(r,a.sibling),(a=i(a,o)).return=r,r=a):(n(r,a),(a=Dl(o,r.mode,u)).return=r,r=a),s(r)):n(r,a)}}var Za=Wa(!0),qa=Wa(!1),Xa={},Ya=_i(Xa),Ka=_i(Xa),Ja=_i(Xa);function Qa(e){if(e===Xa)throw Error(a(174));return e}function $a(e,t){switch(wi(Ja,t),wi(Ka,e),wi(Ya,Xa),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ue(null,"");break;default:t=ue(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}xi(Ya),wi(Ya,t)}function eo(){xi(Ya),xi(Ka),xi(Ja)}function to(e){Qa(Ja.current);var t=Qa(Ya.current),n=ue(t,e.type);t!==n&&(wi(Ka,e),wi(Ya,n))}function no(e){Ka.current===e&&(xi(Ya),xi(Ka))}var ro=_i(0);function io(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ao=[];function oo(){for(var e=0;e<ao.length;e++)ao[e]._workInProgressVersionPrimary=null;ao.length=0}var so=_.ReactCurrentDispatcher,uo=_.ReactCurrentBatchConfig,lo=0,co=null,ho=null,fo=null,po=!1,vo=!1,mo=0,go=0;function yo(){throw Error(a(321))}function bo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!rr(e[n],t[n]))return!1;return!0}function _o(e,t,n,r,i,o){if(lo=o,co=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,so.current=null===e||null===e.memoizedState?rs:is,e=n(r,i),vo){o=0;do{if(vo=!1,mo=0,25<=o)throw Error(a(301));o+=1,fo=ho=null,t.updateQueue=null,so.current=as,e=n(r,i)}while(vo)}if(so.current=ns,t=null!==ho&&null!==ho.next,lo=0,fo=ho=co=null,po=!1,t)throw Error(a(300));return e}function xo(){var e=0!==mo;return mo=0,e}function wo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===fo?co.memoizedState=fo=e:fo=fo.next=e,fo}function So(){if(null===ho){var e=co.alternate;e=null!==e?e.memoizedState:null}else e=ho.next;var t=null===fo?co.memoizedState:fo.next;if(null!==t)fo=t,ho=e;else{if(null===e)throw Error(a(310));e={memoizedState:(ho=e).memoizedState,baseState:ho.baseState,baseQueue:ho.baseQueue,queue:ho.queue,next:null},null===fo?co.memoizedState=fo=e:fo=fo.next=e}return fo}function Mo(e,t){return"function"===typeof t?t(e):t}function ko(e){var t=So(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=ho,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,r=r.baseState;var u=s=null,l=null,c=o;do{var h=c.lane;if((lo&h)===h)null!==l&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var f={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===l?(u=l=f,s=r):l=l.next=f,co.lanes|=h,Lu|=h}c=c.next}while(null!==c&&c!==o);null===l?s=r:l.next=u,rr(r,t.memoizedState)||(ms=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=l,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{o=i.lane,co.lanes|=o,Lu|=o,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function To(e){var t=So(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{o=e(o,s.action),s=s.next}while(s!==i);rr(o,t.memoizedState)||(ms=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Eo(){}function Co(e,t){var n=co,r=So(),i=t(),o=!rr(r.memoizedState,i);if(o&&(r.memoizedState=i,ms=!0),r=r.queue,Bo(Po.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==fo&&1&fo.memoizedState.tag){if(n.flags|=2048,Io(9,Ro.bind(null,n,r,i,t),void 0,null),null===ku)throw Error(a(349));0!==(30&lo)||Ao(n,t,i)}return i}function Ao(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=co.updateQueue)?(t={lastEffect:null,stores:null},co.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ro(e,t,n,r){t.value=n,t.getSnapshot=r,Lo(t)&&Do(e)}function Po(e,t,n){return n((function(){Lo(t)&&Do(e)}))}function Lo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!rr(e,n)}catch(r){return!0}}function Do(e){var t=ka(e,1);null!==t&&Qu(t,e,1,-1)}function No(e){var t=wo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Mo,lastRenderedState:e},t.queue=e,e=e.dispatch=Qo.bind(null,co,e),[t.memoizedState,e]}function Io(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=co.updateQueue)?(t={lastEffect:null,stores:null},co.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Oo(){return So().memoizedState}function Uo(e,t,n,r){var i=wo();co.flags|=e,i.memoizedState=Io(1|t,n,void 0,void 0===r?null:r)}function Fo(e,t,n,r){var i=So();r=void 0===r?null:r;var a=void 0;if(null!==ho){var o=ho.memoizedState;if(a=o.destroy,null!==r&&bo(r,o.deps))return void(i.memoizedState=Io(t,n,a,r))}co.flags|=e,i.memoizedState=Io(1|t,n,a,r)}function zo(e,t){return Uo(8390656,8,e,t)}function Bo(e,t){return Fo(2048,8,e,t)}function Vo(e,t){return Fo(4,2,e,t)}function Go(e,t){return Fo(4,4,e,t)}function jo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ho(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Fo(4,4,jo.bind(null,t,e),n)}function Wo(){}function Zo(e,t){var n=So();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&bo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function qo(e,t){var n=So();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&bo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Xo(e,t,n){return 0===(21&lo)?(e.baseState&&(e.baseState=!1,ms=!0),e.memoizedState=n):(rr(n,t)||(n=pt(),co.lanes|=n,Lu|=n,e.baseState=!0),t)}function Yo(e,t){var n=yt;yt=0!==n&&4>n?n:4,e(!0);var r=uo.transition;uo.transition={};try{e(!1),t()}finally{yt=n,uo.transition=r}}function Ko(){return So().memoizedState}function Jo(e,t,n){var r=Ju(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},$o(e))es(t,n);else if(null!==(n=Ma(e,t,n,r))){Qu(n,e,r,Ku()),ts(n,t,r)}}function Qo(e,t,n){var r=Ju(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if($o(e))es(t,i);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=a(o,n);if(i.hasEagerState=!0,i.eagerState=s,rr(s,o)){var u=t.interleaved;return null===u?(i.next=i,Sa(t)):(i.next=u.next,u.next=i),void(t.interleaved=i)}}catch(l){}null!==(n=Ma(e,t,i,r))&&(Qu(n,e,r,i=Ku()),ts(n,t,r))}}function $o(e){var t=e.alternate;return e===co||null!==t&&t===co}function es(e,t){vo=po=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ts(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,gt(e,n)}}var ns={readContext:xa,useCallback:yo,useContext:yo,useEffect:yo,useImperativeHandle:yo,useInsertionEffect:yo,useLayoutEffect:yo,useMemo:yo,useReducer:yo,useRef:yo,useState:yo,useDebugValue:yo,useDeferredValue:yo,useTransition:yo,useMutableSource:yo,useSyncExternalStore:yo,useId:yo,unstable_isNewReconciler:!1},rs={readContext:xa,useCallback:function(e,t){return wo().memoizedState=[e,void 0===t?null:t],e},useContext:xa,useEffect:zo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Uo(4194308,4,jo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Uo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Uo(4,2,e,t)},useMemo:function(e,t){var n=wo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=wo();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Jo.bind(null,co,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},wo().memoizedState=e},useState:No,useDebugValue:Wo,useDeferredValue:function(e){return wo().memoizedState=e},useTransition:function(){var e=No(!1),t=e[0];return e=Yo.bind(null,e[1]),wo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=co,i=wo();if(ea){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===ku)throw Error(a(349));0!==(30&lo)||Ao(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,zo(Po.bind(null,r,o,e),[e]),r.flags|=2048,Io(9,Ro.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=wo(),t=ku.identifierPrefix;if(ea){var n=qi;t=":"+t+"R"+(n=(Zi&~(1<<32-at(Zi)-1)).toString(32)+n),0<(n=mo++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=go++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},is={readContext:xa,useCallback:Zo,useContext:xa,useEffect:Bo,useImperativeHandle:Ho,useInsertionEffect:Vo,useLayoutEffect:Go,useMemo:qo,useReducer:ko,useRef:Oo,useState:function(){return ko(Mo)},useDebugValue:Wo,useDeferredValue:function(e){return Xo(So(),ho.memoizedState,e)},useTransition:function(){return[ko(Mo)[0],So().memoizedState]},useMutableSource:Eo,useSyncExternalStore:Co,useId:Ko,unstable_isNewReconciler:!1},as={readContext:xa,useCallback:Zo,useContext:xa,useEffect:Bo,useImperativeHandle:Ho,useInsertionEffect:Vo,useLayoutEffect:Go,useMemo:qo,useReducer:To,useRef:Oo,useState:function(){return To(Mo)},useDebugValue:Wo,useDeferredValue:function(e){var t=So();return null===ho?t.memoizedState=e:Xo(t,ho.memoizedState,e)},useTransition:function(){return[To(Mo)[0],So().memoizedState]},useMutableSource:Eo,useSyncExternalStore:Co,useId:Ko,unstable_isNewReconciler:!1};function os(e,t){try{var n="",r=t;do{n+=V(r),r=r.return}while(r);var i=n}catch(a){i="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:i,digest:null}}function ss(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function us(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ls="function"===typeof WeakMap?WeakMap:Map;function cs(e,t,n){(n=Aa(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Bu||(Bu=!0,Vu=r),us(0,t)},n}function hs(e,t,n){(n=Aa(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){us(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){us(0,t),"function"!==typeof r&&(null===Gu?Gu=new Set([this]):Gu.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function fs(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ls;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=xl.bind(null,e,t,n),t.then(e,e))}function ds(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ps(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Aa(-1,1)).tag=2,Ra(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var vs=_.ReactCurrentOwner,ms=!1;function gs(e,t,n,r){t.child=null===e?qa(t,null,n,r):Za(t,e.child,n,r)}function ys(e,t,n,r,i){n=n.render;var a=t.ref;return _a(t,i),r=_o(e,t,n,r,a,i),n=xo(),null===e||ms?(ea&&n&&Ki(t),t.flags|=1,gs(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Bs(e,t,i))}function bs(e,t,n,r,i){if(null===e){var a=n.type;return"function"!==typeof a||Cl(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Rl(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,_s(e,t,a,r,i))}if(a=e.child,0===(e.lanes&i)){var o=a.memoizedProps;if((n=null!==(n=n.compare)?n:ir)(o,r)&&e.ref===t.ref)return Bs(e,t,i)}return t.flags|=1,(e=Al(a,r)).ref=t.ref,e.return=t,t.child=e}function _s(e,t,n,r,i){if(null!==e){var a=e.memoizedProps;if(ir(a,r)&&e.ref===t.ref){if(ms=!1,t.pendingProps=r=a,0===(e.lanes&i))return t.lanes=e.lanes,Bs(e,t,i);0!==(131072&e.flags)&&(ms=!0)}}return Ss(e,t,n,r,i)}function xs(e,t,n){var r=t.pendingProps,i=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},wi(Au,Cu),Cu|=n;else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,wi(Au,Cu),Cu|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==a?a.baseLanes:n,wi(Au,Cu),Cu|=r}else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,wi(Au,Cu),Cu|=r;return gs(e,t,i,n),t.child}function ws(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ss(e,t,n,r,i){var a=Ci(n)?Ti:Mi.current;return a=Ei(t,a),_a(t,i),n=_o(e,t,n,r,a,i),r=xo(),null===e||ms?(ea&&r&&Ki(t),t.flags|=1,gs(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Bs(e,t,i))}function Ms(e,t,n,r,i){if(Ci(n)){var a=!0;Li(t)}else a=!1;if(_a(t,i),null===t.stateNode)zs(e,t),za(t,n,r),Va(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var u=o.context,l=n.contextType;"object"===typeof l&&null!==l?l=xa(l):l=Ei(t,l=Ci(n)?Ti:Mi.current);var c=n.getDerivedStateFromProps,h="function"===typeof c||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==r||u!==l)&&Ba(t,o,r,l),Ta=!1;var f=t.memoizedState;o.state=f,Da(t,r,o,i),u=t.memoizedState,s!==r||f!==u||ki.current||Ta?("function"===typeof c&&(Oa(t,n,c,r),u=t.memoizedState),(s=Ta||Fa(t,n,s,r,f,u,l))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),o.props=r,o.state=u,o.context=l,r=s):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Ca(e,t),s=t.memoizedProps,l=t.type===t.elementType?s:fa(t.type,s),o.props=l,h=t.pendingProps,f=o.context,"object"===typeof(u=n.contextType)&&null!==u?u=xa(u):u=Ei(t,u=Ci(n)?Ti:Mi.current);var d=n.getDerivedStateFromProps;(c="function"===typeof d||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==h||f!==u)&&Ba(t,o,r,u),Ta=!1,f=t.memoizedState,o.state=f,Da(t,r,o,i);var p=t.memoizedState;s!==h||f!==p||ki.current||Ta?("function"===typeof d&&(Oa(t,n,d,r),p=t.memoizedState),(l=Ta||Fa(t,n,l,r,f,p,u)||!1)?(c||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,u),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,u)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=u,r=l):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return ks(e,t,n,r,a,i)}function ks(e,t,n,r,i,a){ws(e,t);var o=0!==(128&t.flags);if(!r&&!o)return i&&Di(t,n,!1),Bs(e,t,a);r=t.stateNode,vs.current=t;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=Za(t,e.child,null,a),t.child=Za(t,null,s,a)):gs(e,t,s,a),t.memoizedState=r.state,i&&Di(t,n,!0),t.child}function Ts(e){var t=e.stateNode;t.pendingContext?Ri(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ri(0,t.context,!1),$a(e,t.containerInfo)}function Es(e,t,n,r,i){return la(),ca(i),t.flags|=256,gs(e,t,n,r),t.child}var Cs,As,Rs,Ps={dehydrated:null,treeContext:null,retryLane:0};function Ls(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ds(e,t,n){var r,i=t.pendingProps,o=ro.current,s=!1,u=0!==(128&t.flags);if((r=u)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),wi(ro,1&o),null===e)return aa(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(u=i.children,e=i.fallback,s?(i=t.mode,s=t.child,u={mode:"hidden",children:u},0===(1&i)&&null!==s?(s.childLanes=0,s.pendingProps=u):s=Ll(u,i,0,null),e=Pl(e,i,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ls(n),t.memoizedState=Ps,e):Ns(t,u));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,i,o,s){if(n)return 256&t.flags?(t.flags&=-257,Is(e,t,s,r=ss(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=Ll({mode:"visible",children:r.children},i,0,null),(o=Pl(o,i,s,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&Za(t,e.child,null,s),t.child.memoizedState=Ls(s),t.memoizedState=Ps,o);if(0===(1&t.mode))return Is(e,t,s,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var u=r.dgst;return r=u,Is(e,t,s,r=ss(o=Error(a(419)),r,void 0))}if(u=0!==(s&e.childLanes),ms||u){if(null!==(r=ku)){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|s))?0:i)&&i!==o.retryLane&&(o.retryLane=i,ka(e,i),Qu(r,e,i,-1))}return hl(),Is(e,t,s,r=ss(Error(a(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Sl.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,$i=ai(i.nextSibling),Qi=t,ea=!0,ta=null,null!==e&&(ji[Hi++]=Zi,ji[Hi++]=qi,ji[Hi++]=Wi,Zi=e.id,qi=e.overflow,Wi=t),(t=Ns(t,r.children)).flags|=4096,t)}(e,t,u,i,r,o,n);if(s){s=i.fallback,u=t.mode,r=(o=e.child).sibling;var l={mode:"hidden",children:i.children};return 0===(1&u)&&t.child!==o?((i=t.child).childLanes=0,i.pendingProps=l,t.deletions=null):(i=Al(o,l)).subtreeFlags=14680064&o.subtreeFlags,null!==r?s=Al(r,s):(s=Pl(s,u,n,null)).flags|=2,s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,u=null===(u=e.child.memoizedState)?Ls(n):{baseLanes:u.baseLanes|n,cachePool:null,transitions:u.transitions},s.memoizedState=u,s.childLanes=e.childLanes&~n,t.memoizedState=Ps,i}return e=(s=e.child).sibling,i=Al(s,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Ns(e,t){return(t=Ll({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Is(e,t,n,r){return null!==r&&ca(r),Za(t,e.child,null,n),(e=Ns(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Os(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),ba(e.return,t,n)}function Us(e,t,n,r,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function Fs(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(gs(e,t,r.children,n),0!==(2&(r=ro.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Os(e,n,t);else if(19===e.tag)Os(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(wi(ro,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===io(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Us(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===io(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Us(t,!0,n,null,a);break;case"together":Us(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function zs(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Bs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Lu|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Al(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Al(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Vs(e,t){if(!ea)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Gs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function js(e,t,n){var r=t.pendingProps;switch(Ji(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gs(t),null;case 1:case 17:return Ci(t.type)&&Ai(),Gs(t),null;case 3:return r=t.stateNode,eo(),xi(ki),xi(Mi),oo(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(sa(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ta&&(nl(ta),ta=null))),Gs(t),null;case 5:no(t);var i=Qa(Ja.current);if(n=t.type,null!==e&&null!=t.stateNode)As(e,t,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(a(166));return Gs(t),null}if(e=Qa(Ya.current),sa(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[ui]=t,r[li]=o,e=0!==(1&t.mode),n){case"dialog":Ir("cancel",r),Ir("close",r);break;case"iframe":case"object":case"embed":Ir("load",r);break;case"video":case"audio":for(i=0;i<Pr.length;i++)Ir(Pr[i],r);break;case"source":Ir("error",r);break;case"img":case"image":case"link":Ir("error",r),Ir("load",r);break;case"details":Ir("toggle",r);break;case"input":K(r,o),Ir("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Ir("invalid",r);break;case"textarea":ie(r,o),Ir("invalid",r)}for(var u in ge(n,o),i=null,o)if(o.hasOwnProperty(u)){var l=o[u];"children"===u?"string"===typeof l?r.textContent!==l&&(!0!==o.suppressHydrationWarning&&Xr(r.textContent,l,e),i=["children",l]):"number"===typeof l&&r.textContent!==""+l&&(!0!==o.suppressHydrationWarning&&Xr(r.textContent,l,e),i=["children",""+l]):s.hasOwnProperty(u)&&null!=l&&"onScroll"===u&&Ir("scroll",r)}switch(n){case"input":Z(r),$(r,o,!0);break;case"textarea":Z(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Yr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{u=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=u.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=u.createElement(n,{is:r.is}):(e=u.createElement(n),"select"===n&&(u=e,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):e=u.createElementNS(e,n),e[ui]=t,e[li]=r,Cs(e,t),t.stateNode=e;e:{switch(u=ye(n,r),n){case"dialog":Ir("cancel",e),Ir("close",e),i=r;break;case"iframe":case"object":case"embed":Ir("load",e),i=r;break;case"video":case"audio":for(i=0;i<Pr.length;i++)Ir(Pr[i],e);i=r;break;case"source":Ir("error",e),i=r;break;case"img":case"image":case"link":Ir("error",e),Ir("load",e),i=r;break;case"details":Ir("toggle",e),i=r;break;case"input":K(e,r),i=Y(e,r),Ir("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=U({},r,{value:void 0}),Ir("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Ir("invalid",e)}for(o in ge(n,i),l=i)if(l.hasOwnProperty(o)){var c=l[o];"style"===o?ve(e,c):"dangerouslySetInnerHTML"===o?null!=(c=c?c.__html:void 0)&&ce(e,c):"children"===o?"string"===typeof c?("textarea"!==n||""!==c)&&he(e,c):"number"===typeof c&&he(e,""+c):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=c&&"onScroll"===o&&Ir("scroll",e):null!=c&&b(e,o,c,u))}switch(n){case"input":Z(e),$(e,r,!1);break;case"textarea":Z(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+H(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Yr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Gs(t),null;case 6:if(e&&null!=t.stateNode)Rs(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(a(166));if(n=Qa(Ja.current),Qa(Ya.current),sa(t)){if(r=t.stateNode,n=t.memoizedProps,r[ui]=t,(o=r.nodeValue!==n)&&null!==(e=Qi))switch(e.tag){case 3:Xr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[ui]=t,t.stateNode=r}return Gs(t),null;case 13:if(xi(ro),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ea&&null!==$i&&0!==(1&t.mode)&&0===(128&t.flags))ua(),la(),t.flags|=98560,o=!1;else if(o=sa(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(a(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(a(317));o[ui]=t}else la(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Gs(t),o=!1}else null!==ta&&(nl(ta),ta=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ro.current)?0===Ru&&(Ru=3):hl())),null!==t.updateQueue&&(t.flags|=4),Gs(t),null);case 4:return eo(),null===e&&Fr(t.stateNode.containerInfo),Gs(t),null;case 10:return ya(t.type._context),Gs(t),null;case 19:if(xi(ro),null===(o=t.memoizedState))return Gs(t),null;if(r=0!==(128&t.flags),null===(u=o.rendering))if(r)Vs(o,!1);else{if(0!==Ru||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(u=io(e))){for(t.flags|=128,Vs(o,!1),null!==(r=u.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(u=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=u.childLanes,o.lanes=u.lanes,o.child=u.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=u.memoizedProps,o.memoizedState=u.memoizedState,o.updateQueue=u.updateQueue,o.type=u.type,e=u.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return wi(ro,1&ro.current|2),t.child}e=e.sibling}null!==o.tail&&Ke()>Fu&&(t.flags|=128,r=!0,Vs(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=io(u))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Vs(o,!0),null===o.tail&&"hidden"===o.tailMode&&!u.alternate&&!ea)return Gs(t),null}else 2*Ke()-o.renderingStartTime>Fu&&1073741824!==n&&(t.flags|=128,r=!0,Vs(o,!1),t.lanes=4194304);o.isBackwards?(u.sibling=t.child,t.child=u):(null!==(n=o.last)?n.sibling=u:t.child=u,o.last=u)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Ke(),t.sibling=null,n=ro.current,wi(ro,r?1&n|2:1&n),t):(Gs(t),null);case 22:case 23:return sl(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Cu)&&(Gs(t),6&t.subtreeFlags&&(t.flags|=8192)):Gs(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Hs(e,t){switch(Ji(t),t.tag){case 1:return Ci(t.type)&&Ai(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return eo(),xi(ki),xi(Mi),oo(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return no(t),null;case 13:if(xi(ro),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));la()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return xi(ro),null;case 4:return eo(),null;case 10:return ya(t.type._context),null;case 22:case 23:return sl(),null;default:return null}}Cs=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},As=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Qa(Ya.current);var a,o=null;switch(n){case"input":i=Y(e,i),r=Y(e,r),o=[];break;case"select":i=U({},i,{value:void 0}),r=U({},r,{value:void 0}),o=[];break;case"textarea":i=re(e,i),r=re(e,r),o=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Yr)}for(c in ge(n,r),n=null,i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&null!=i[c])if("style"===c){var u=i[c];for(a in u)u.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(s.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in r){var l=r[c];if(u=null!=i?i[c]:void 0,r.hasOwnProperty(c)&&l!==u&&(null!=l||null!=u))if("style"===c)if(u){for(a in u)!u.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in l)l.hasOwnProperty(a)&&u[a]!==l[a]&&(n||(n={}),n[a]=l[a])}else n||(o||(o=[]),o.push(c,n)),n=l;else"dangerouslySetInnerHTML"===c?(l=l?l.__html:void 0,u=u?u.__html:void 0,null!=l&&u!==l&&(o=o||[]).push(c,l)):"children"===c?"string"!==typeof l&&"number"!==typeof l||(o=o||[]).push(c,""+l):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(s.hasOwnProperty(c)?(null!=l&&"onScroll"===c&&Ir("scroll",e),o||u===l||(o=[])):(o=o||[]).push(c,l))}n&&(o=o||[]).push("style",n);var c=o;(t.updateQueue=c)&&(t.flags|=4)}},Rs=function(e,t,n,r){n!==r&&(t.flags|=4)};var Ws=!1,Zs=!1,qs="function"===typeof WeakSet?WeakSet:Set,Xs=null;function Ys(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){_l(e,t,r)}else n.current=null}function Ks(e,t,n){try{n()}catch(r){_l(e,t,r)}}var Js=!1;function Qs(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,void 0!==a&&Ks(t,n,a)}i=i.next}while(i!==r)}}function $s(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function eu(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function tu(e){var t=e.alternate;null!==t&&(e.alternate=null,tu(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ui],delete t[li],delete t[hi],delete t[fi],delete t[di])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function nu(e){return 5===e.tag||3===e.tag||4===e.tag}function ru(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||nu(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function iu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Yr));else if(4!==r&&null!==(e=e.child))for(iu(e,t,n),e=e.sibling;null!==e;)iu(e,t,n),e=e.sibling}function au(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(au(e,t,n),e=e.sibling;null!==e;)au(e,t,n),e=e.sibling}var ou=null,su=!1;function uu(e,t,n){for(n=n.child;null!==n;)lu(e,t,n),n=n.sibling}function lu(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(rt,n)}catch(s){}switch(n.tag){case 5:Zs||Ys(n,t);case 6:var r=ou,i=su;ou=null,uu(e,t,n),su=i,null!==(ou=r)&&(su?(e=ou,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ou.removeChild(n.stateNode));break;case 18:null!==ou&&(su?(e=ou,n=n.stateNode,8===e.nodeType?ii(e.parentNode,n):1===e.nodeType&&ii(e,n),Vt(e)):ii(ou,n.stateNode));break;case 4:r=ou,i=su,ou=n.stateNode.containerInfo,su=!0,uu(e,t,n),ou=r,su=i;break;case 0:case 11:case 14:case 15:if(!Zs&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var a=i,o=a.destroy;a=a.tag,void 0!==o&&(0!==(2&a)||0!==(4&a))&&Ks(n,t,o),i=i.next}while(i!==r)}uu(e,t,n);break;case 1:if(!Zs&&(Ys(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){_l(n,t,s)}uu(e,t,n);break;case 21:uu(e,t,n);break;case 22:1&n.mode?(Zs=(r=Zs)||null!==n.memoizedState,uu(e,t,n),Zs=r):uu(e,t,n);break;default:uu(e,t,n)}}function cu(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new qs),t.forEach((function(t){var r=Ml.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function hu(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,s=t,u=s;e:for(;null!==u;){switch(u.tag){case 5:ou=u.stateNode,su=!1;break e;case 3:case 4:ou=u.stateNode.containerInfo,su=!0;break e}u=u.return}if(null===ou)throw Error(a(160));lu(o,s,i),ou=null,su=!1;var l=i.alternate;null!==l&&(l.return=null),i.return=null}catch(c){_l(i,t,c)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)fu(t,e),t=t.sibling}function fu(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(hu(t,e),du(e),4&r){try{Qs(3,e,e.return),$s(3,e)}catch(m){_l(e,e.return,m)}try{Qs(5,e,e.return)}catch(m){_l(e,e.return,m)}}break;case 1:hu(t,e),du(e),512&r&&null!==n&&Ys(n,n.return);break;case 5:if(hu(t,e),du(e),512&r&&null!==n&&Ys(n,n.return),32&e.flags){var i=e.stateNode;try{he(i,"")}catch(m){_l(e,e.return,m)}}if(4&r&&null!=(i=e.stateNode)){var o=e.memoizedProps,s=null!==n?n.memoizedProps:o,u=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===u&&"radio"===o.type&&null!=o.name&&J(i,o),ye(u,s);var c=ye(u,o);for(s=0;s<l.length;s+=2){var h=l[s],f=l[s+1];"style"===h?ve(i,f):"dangerouslySetInnerHTML"===h?ce(i,f):"children"===h?he(i,f):b(i,h,f,c)}switch(u){case"input":Q(i,o);break;case"textarea":ae(i,o);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(i,!!o.multiple,p,!1):d!==!!o.multiple&&(null!=o.defaultValue?ne(i,!!o.multiple,o.defaultValue,!0):ne(i,!!o.multiple,o.multiple?[]:"",!1))}i[li]=o}catch(m){_l(e,e.return,m)}}break;case 6:if(hu(t,e),du(e),4&r){if(null===e.stateNode)throw Error(a(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(m){_l(e,e.return,m)}}break;case 3:if(hu(t,e),du(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(m){_l(e,e.return,m)}break;case 4:default:hu(t,e),du(e);break;case 13:hu(t,e),du(e),8192&(i=e.child).flags&&(o=null!==i.memoizedState,i.stateNode.isHidden=o,!o||null!==i.alternate&&null!==i.alternate.memoizedState||(Uu=Ke())),4&r&&cu(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(Zs=(c=Zs)||h,hu(t,e),Zs=c):hu(t,e),du(e),8192&r){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!h&&0!==(1&e.mode))for(Xs=e,h=e.child;null!==h;){for(f=Xs=h;null!==Xs;){switch(p=(d=Xs).child,d.tag){case 0:case 11:case 14:case 15:Qs(4,d,d.return);break;case 1:Ys(d,d.return);var v=d.stateNode;if("function"===typeof v.componentWillUnmount){r=d,n=d.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(m){_l(r,n,m)}}break;case 5:Ys(d,d.return);break;case 22:if(null!==d.memoizedState){gu(f);continue}}null!==p?(p.return=d,Xs=p):gu(f)}h=h.sibling}e:for(h=null,f=e;;){if(5===f.tag){if(null===h){h=f;try{i=f.stateNode,c?"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none":(u=f.stateNode,s=void 0!==(l=f.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null,u.style.display=pe("display",s))}catch(m){_l(e,e.return,m)}}}else if(6===f.tag){if(null===h)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(m){_l(e,e.return,m)}}else if((22!==f.tag&&23!==f.tag||null===f.memoizedState||f===e)&&null!==f.child){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;null===f.sibling;){if(null===f.return||f.return===e)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:hu(t,e),du(e),4&r&&cu(e);case 21:}}function du(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(nu(n)){var r=n;break e}n=n.return}throw Error(a(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(he(i,""),r.flags&=-33),au(e,ru(e),i);break;case 3:case 4:var o=r.stateNode.containerInfo;iu(e,ru(e),o);break;default:throw Error(a(161))}}catch(s){_l(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function pu(e,t,n){Xs=e,vu(e,t,n)}function vu(e,t,n){for(var r=0!==(1&e.mode);null!==Xs;){var i=Xs,a=i.child;if(22===i.tag&&r){var o=null!==i.memoizedState||Ws;if(!o){var s=i.alternate,u=null!==s&&null!==s.memoizedState||Zs;s=Ws;var l=Zs;if(Ws=o,(Zs=u)&&!l)for(Xs=i;null!==Xs;)u=(o=Xs).child,22===o.tag&&null!==o.memoizedState?yu(i):null!==u?(u.return=o,Xs=u):yu(i);for(;null!==a;)Xs=a,vu(a,t,n),a=a.sibling;Xs=i,Ws=s,Zs=l}mu(e)}else 0!==(8772&i.subtreeFlags)&&null!==a?(a.return=i,Xs=a):mu(e)}}function mu(e){for(;null!==Xs;){var t=Xs;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Zs||$s(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Zs)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:fa(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Na(t,o,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Na(t,s,n)}break;case 5:var u=t.stateNode;if(null===n&&4&t.flags){n=u;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var h=c.memoizedState;if(null!==h){var f=h.dehydrated;null!==f&&Vt(f)}}}break;default:throw Error(a(163))}Zs||512&t.flags&&eu(t)}catch(d){_l(t,t.return,d)}}if(t===e){Xs=null;break}if(null!==(n=t.sibling)){n.return=t.return,Xs=n;break}Xs=t.return}}function gu(e){for(;null!==Xs;){var t=Xs;if(t===e){Xs=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Xs=n;break}Xs=t.return}}function yu(e){for(;null!==Xs;){var t=Xs;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{$s(4,t)}catch(u){_l(t,n,u)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(u){_l(t,i,u)}}var a=t.return;try{eu(t)}catch(u){_l(t,a,u)}break;case 5:var o=t.return;try{eu(t)}catch(u){_l(t,o,u)}}}catch(u){_l(t,t.return,u)}if(t===e){Xs=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Xs=s;break}Xs=t.return}}var bu,_u=Math.ceil,xu=_.ReactCurrentDispatcher,wu=_.ReactCurrentOwner,Su=_.ReactCurrentBatchConfig,Mu=0,ku=null,Tu=null,Eu=0,Cu=0,Au=_i(0),Ru=0,Pu=null,Lu=0,Du=0,Nu=0,Iu=null,Ou=null,Uu=0,Fu=1/0,zu=null,Bu=!1,Vu=null,Gu=null,ju=!1,Hu=null,Wu=0,Zu=0,qu=null,Xu=-1,Yu=0;function Ku(){return 0!==(6&Mu)?Ke():-1!==Xu?Xu:Xu=Ke()}function Ju(e){return 0===(1&e.mode)?1:0!==(2&Mu)&&0!==Eu?Eu&-Eu:null!==ha.transition?(0===Yu&&(Yu=pt()),Yu):0!==(e=yt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function Qu(e,t,n,r){if(50<Zu)throw Zu=0,qu=null,Error(a(185));mt(e,n,r),0!==(2&Mu)&&e===ku||(e===ku&&(0===(2&Mu)&&(Du|=n),4===Ru&&rl(e,Eu)),$u(e,r),1===n&&0===Mu&&0===(1&t.mode)&&(Fu=Ke()+500,Ii&&Fi()))}function $u(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-at(a),s=1<<o,u=i[o];-1===u?0!==(s&n)&&0===(s&r)||(i[o]=ft(s,t)):u<=t&&(e.expiredLanes|=s),a&=~s}}(e,t);var r=ht(e,e===ku?Eu:0);if(0===r)null!==n&&qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&qe(n),1===t)0===e.tag?function(e){Ii=!0,Ui(e)}(il.bind(null,e)):Ui(il.bind(null,e)),ni((function(){0===(6&Mu)&&Fi()})),n=null;else{switch(bt(r)){case 1:n=Qe;break;case 4:n=$e;break;case 16:default:n=et;break;case 536870912:n=nt}n=kl(n,el.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function el(e,t){if(Xu=-1,Yu=0,0!==(6&Mu))throw Error(a(327));var n=e.callbackNode;if(yl()&&e.callbackNode!==n)return null;var r=ht(e,e===ku?Eu:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=fl(e,r);else{t=r;var i=Mu;Mu|=2;var o=cl();for(ku===e&&Eu===t||(zu=null,Fu=Ke()+500,ul(e,t));;)try{pl();break}catch(u){ll(e,u)}ga(),xu.current=o,Mu=i,null!==Tu?t=0:(ku=null,Eu=0,t=Ru)}if(0!==t){if(2===t&&(0!==(i=dt(e))&&(r=i,t=tl(e,i))),1===t)throw n=Pu,ul(e,0),rl(e,r),$u(e,Ke()),n;if(6===t)rl(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!rr(a(),i))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=fl(e,r))&&(0!==(o=dt(e))&&(r=o,t=tl(e,o))),1===t))throw n=Pu,ul(e,0),rl(e,r),$u(e,Ke()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(a(345));case 2:case 5:gl(e,Ou,zu);break;case 3:if(rl(e,r),(130023424&r)===r&&10<(t=Uu+500-Ke())){if(0!==ht(e,0))break;if(((i=e.suspendedLanes)&r)!==r){Ku(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=$r(gl.bind(null,e,Ou,zu),t);break}gl(e,Ou,zu);break;case 4:if(rl(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var s=31-at(r);o=1<<s,(s=t[s])>i&&(i=s),r&=~o}if(r=i,10<(r=(120>(r=Ke()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*_u(r/1960))-r)){e.timeoutHandle=$r(gl.bind(null,e,Ou,zu),r);break}gl(e,Ou,zu);break;default:throw Error(a(329))}}}return $u(e,Ke()),e.callbackNode===n?el.bind(null,e):null}function tl(e,t){var n=Iu;return e.current.memoizedState.isDehydrated&&(ul(e,t).flags|=256),2!==(e=fl(e,t))&&(t=Ou,Ou=n,null!==t&&nl(t)),e}function nl(e){null===Ou?Ou=e:Ou.push.apply(Ou,e)}function rl(e,t){for(t&=~Nu,t&=~Du,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),r=1<<n;e[n]=-1,t&=~r}}function il(e){if(0!==(6&Mu))throw Error(a(327));yl();var t=ht(e,0);if(0===(1&t))return $u(e,Ke()),null;var n=fl(e,t);if(0!==e.tag&&2===n){var r=dt(e);0!==r&&(t=r,n=tl(e,r))}if(1===n)throw n=Pu,ul(e,0),rl(e,t),$u(e,Ke()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,gl(e,Ou,zu),$u(e,Ke()),null}function al(e,t){var n=Mu;Mu|=1;try{return e(t)}finally{0===(Mu=n)&&(Fu=Ke()+500,Ii&&Fi())}}function ol(e){null!==Hu&&0===Hu.tag&&0===(6&Mu)&&yl();var t=Mu;Mu|=1;var n=Su.transition,r=yt;try{if(Su.transition=null,yt=1,e)return e()}finally{yt=r,Su.transition=n,0===(6&(Mu=t))&&Fi()}}function sl(){Cu=Au.current,xi(Au)}function ul(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ei(n)),null!==Tu)for(n=Tu.return;null!==n;){var r=n;switch(Ji(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ai();break;case 3:eo(),xi(ki),xi(Mi),oo();break;case 5:no(r);break;case 4:eo();break;case 13:case 19:xi(ro);break;case 10:ya(r.type._context);break;case 22:case 23:sl()}n=n.return}if(ku=e,Tu=e=Al(e.current,null),Eu=Cu=t,Ru=0,Pu=null,Nu=Du=Lu=0,Ou=Iu=null,null!==wa){for(t=0;t<wa.length;t++)if(null!==(r=(n=wa[t]).interleaved)){n.interleaved=null;var i=r.next,a=n.pending;if(null!==a){var o=a.next;a.next=i,r.next=o}n.pending=r}wa=null}return e}function ll(e,t){for(;;){var n=Tu;try{if(ga(),so.current=ns,po){for(var r=co.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}po=!1}if(lo=0,fo=ho=co=null,vo=!1,mo=0,wu.current=null,null===n||null===n.return){Ru=1,Pu=t,Tu=null;break}e:{var o=e,s=n.return,u=n,l=t;if(t=Eu,u.flags|=32768,null!==l&&"object"===typeof l&&"function"===typeof l.then){var c=l,h=u,f=h.tag;if(0===(1&h.mode)&&(0===f||11===f||15===f)){var d=h.alternate;d?(h.updateQueue=d.updateQueue,h.memoizedState=d.memoizedState,h.lanes=d.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=ds(s);if(null!==p){p.flags&=-257,ps(p,s,u,0,t),1&p.mode&&fs(o,c,t),l=c;var v=(t=p).updateQueue;if(null===v){var m=new Set;m.add(l),t.updateQueue=m}else v.add(l);break e}if(0===(1&t)){fs(o,c,t),hl();break e}l=Error(a(426))}else if(ea&&1&u.mode){var g=ds(s);if(null!==g){0===(65536&g.flags)&&(g.flags|=256),ps(g,s,u,0,t),ca(os(l,u));break e}}o=l=os(l,u),4!==Ru&&(Ru=2),null===Iu?Iu=[o]:Iu.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,La(o,cs(0,l,t));break e;case 1:u=l;var y=o.type,b=o.stateNode;if(0===(128&o.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Gu||!Gu.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t,La(o,hs(o,u,t));break e}}o=o.return}while(null!==o)}ml(n)}catch(_){t=_,Tu===n&&null!==n&&(Tu=n=n.return);continue}break}}function cl(){var e=xu.current;return xu.current=ns,null===e?ns:e}function hl(){0!==Ru&&3!==Ru&&2!==Ru||(Ru=4),null===ku||0===(268435455&Lu)&&0===(268435455&Du)||rl(ku,Eu)}function fl(e,t){var n=Mu;Mu|=2;var r=cl();for(ku===e&&Eu===t||(zu=null,ul(e,t));;)try{dl();break}catch(i){ll(e,i)}if(ga(),Mu=n,xu.current=r,null!==Tu)throw Error(a(261));return ku=null,Eu=0,Ru}function dl(){for(;null!==Tu;)vl(Tu)}function pl(){for(;null!==Tu&&!Xe();)vl(Tu)}function vl(e){var t=bu(e.alternate,e,Cu);e.memoizedProps=e.pendingProps,null===t?ml(e):Tu=t,wu.current=null}function ml(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=js(n,t,Cu)))return void(Tu=n)}else{if(null!==(n=Hs(n,t)))return n.flags&=32767,void(Tu=n);if(null===e)return Ru=6,void(Tu=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Tu=t);Tu=t=e}while(null!==t);0===Ru&&(Ru=5)}function gl(e,t,n){var r=yt,i=Su.transition;try{Su.transition=null,yt=1,function(e,t,n,r){do{yl()}while(null!==Hu);if(0!==(6&Mu))throw Error(a(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-at(n),a=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~a}}(e,o),e===ku&&(Tu=ku=null,Eu=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||ju||(ju=!0,kl(et,(function(){return yl(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Su.transition,Su.transition=null;var s=yt;yt=1;var u=Mu;Mu|=4,wu.current=null,function(e,t){if(Kr=jt,lr(e=ur())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(x){n=null;break e}var s=0,u=-1,l=-1,c=0,h=0,f=e,d=null;t:for(;;){for(var p;f!==n||0!==i&&3!==f.nodeType||(u=s+i),f!==o||0!==r&&3!==f.nodeType||(l=s+r),3===f.nodeType&&(s+=f.nodeValue.length),null!==(p=f.firstChild);)d=f,f=p;for(;;){if(f===e)break t;if(d===n&&++c===i&&(u=s),d===o&&++h===r&&(l=s),null!==(p=f.nextSibling))break;d=(f=d).parentNode}f=p}n=-1===u||-1===l?null:{start:u,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Jr={focusedElem:e,selectionRange:n},jt=!1,Xs=t;null!==Xs;)if(e=(t=Xs).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Xs=e;else for(;null!==Xs;){t=Xs;try{var v=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==v){var m=v.memoizedProps,g=v.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:fa(t.type,m),g);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var _=t.stateNode.containerInfo;1===_.nodeType?_.textContent="":9===_.nodeType&&_.documentElement&&_.removeChild(_.documentElement);break;default:throw Error(a(163))}}catch(x){_l(t,t.return,x)}if(null!==(e=t.sibling)){e.return=t.return,Xs=e;break}Xs=t.return}v=Js,Js=!1}(e,n),fu(n,e),cr(Jr),jt=!!Kr,Jr=Kr=null,e.current=n,pu(n,e,i),Ye(),Mu=u,yt=s,Su.transition=o}else e.current=n;if(ju&&(ju=!1,Hu=e,Wu=i),0===(o=e.pendingLanes)&&(Gu=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),$u(e,Ke()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Bu)throw Bu=!1,e=Vu,Vu=null,e;0!==(1&Wu)&&0!==e.tag&&yl(),0!==(1&(o=e.pendingLanes))?e===qu?Zu++:(Zu=0,qu=e):Zu=0,Fi()}(e,t,n,r)}finally{Su.transition=i,yt=r}return null}function yl(){if(null!==Hu){var e=bt(Wu),t=Su.transition,n=yt;try{if(Su.transition=null,yt=16>e?16:e,null===Hu)var r=!1;else{if(e=Hu,Hu=null,Wu=0,0!==(6&Mu))throw Error(a(331));var i=Mu;for(Mu|=4,Xs=e.current;null!==Xs;){var o=Xs,s=o.child;if(0!==(16&Xs.flags)){var u=o.deletions;if(null!==u){for(var l=0;l<u.length;l++){var c=u[l];for(Xs=c;null!==Xs;){var h=Xs;switch(h.tag){case 0:case 11:case 15:Qs(8,h,o)}var f=h.child;if(null!==f)f.return=h,Xs=f;else for(;null!==Xs;){var d=(h=Xs).sibling,p=h.return;if(tu(h),h===c){Xs=null;break}if(null!==d){d.return=p,Xs=d;break}Xs=p}}}var v=o.alternate;if(null!==v){var m=v.child;if(null!==m){v.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(null!==m)}}Xs=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,Xs=s;else e:for(;null!==Xs;){if(0!==(2048&(o=Xs).flags))switch(o.tag){case 0:case 11:case 15:Qs(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,Xs=y;break e}Xs=o.return}}var b=e.current;for(Xs=b;null!==Xs;){var _=(s=Xs).child;if(0!==(2064&s.subtreeFlags)&&null!==_)_.return=s,Xs=_;else e:for(s=b;null!==Xs;){if(0!==(2048&(u=Xs).flags))try{switch(u.tag){case 0:case 11:case 15:$s(9,u)}}catch(w){_l(u,u.return,w)}if(u===s){Xs=null;break e}var x=u.sibling;if(null!==x){x.return=u.return,Xs=x;break e}Xs=u.return}}if(Mu=i,Fi(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(rt,e)}catch(w){}r=!0}return r}finally{yt=n,Su.transition=t}}return!1}function bl(e,t,n){e=Ra(e,t=cs(0,t=os(n,t),1),1),t=Ku(),null!==e&&(mt(e,1,t),$u(e,t))}function _l(e,t,n){if(3===e.tag)bl(e,e,n);else for(;null!==t;){if(3===t.tag){bl(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Gu||!Gu.has(r))){t=Ra(t,e=hs(t,e=os(n,e),1),1),e=Ku(),null!==t&&(mt(t,1,e),$u(t,e));break}}t=t.return}}function xl(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=Ku(),e.pingedLanes|=e.suspendedLanes&n,ku===e&&(Eu&n)===n&&(4===Ru||3===Ru&&(130023424&Eu)===Eu&&500>Ke()-Uu?ul(e,0):Nu|=n),$u(e,t)}function wl(e,t){0===t&&(0===(1&e.mode)?t=1:(t=lt,0===(130023424&(lt<<=1))&&(lt=4194304)));var n=Ku();null!==(e=ka(e,t))&&(mt(e,t,n),$u(e,n))}function Sl(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),wl(e,n)}function Ml(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(t),wl(e,n)}function kl(e,t){return Ze(e,t)}function Tl(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function El(e,t,n,r){return new Tl(e,t,n,r)}function Cl(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Al(e,t){var n=e.alternate;return null===n?((n=El(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Rl(e,t,n,r,i,o){var s=2;if(r=e,"function"===typeof e)Cl(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case S:return Pl(n.children,i,o,t);case M:s=8,i|=8;break;case k:return(e=El(12,n,t,2|i)).elementType=k,e.lanes=o,e;case A:return(e=El(13,n,t,i)).elementType=A,e.lanes=o,e;case R:return(e=El(19,n,t,i)).elementType=R,e.lanes=o,e;case D:return Ll(n,i,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case T:s=10;break e;case E:s=9;break e;case C:s=11;break e;case P:s=14;break e;case L:s=16,r=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=El(s,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function Pl(e,t,n,r){return(e=El(7,e,r,t)).lanes=n,e}function Ll(e,t,n,r){return(e=El(22,e,r,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function Dl(e,t,n){return(e=El(6,e,null,t)).lanes=n,e}function Nl(e,t,n){return(t=El(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Il(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vt(0),this.expirationTimes=vt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Ol(e,t,n,r,i,a,o,s,u){return e=new Il(e,t,n,s,u),1===t?(t=1,!0===a&&(t|=8)):t=0,a=El(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ea(a),e}function Ul(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function Fl(e){if(!e)return Si;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ci(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(Ci(n))return Pi(e,n,t)}return t}function zl(e,t,n,r,i,a,o,s,u){return(e=Ol(n,r,!0,e,0,a,0,s,u)).context=Fl(null),n=e.current,(a=Aa(r=Ku(),i=Ju(n))).callback=void 0!==t&&null!==t?t:null,Ra(n,a,i),e.current.lanes=i,mt(e,i,r),$u(e,r),e}function Bl(e,t,n,r){var i=t.current,a=Ku(),o=Ju(i);return n=Fl(n),null===t.context?t.context=n:t.pendingContext=n,(t=Aa(a,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Ra(i,t,o))&&(Qu(e,i,o,a),Pa(e,i,o)),o}function Vl(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gl(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function jl(e,t){Gl(e,t),(e=e.alternate)&&Gl(e,t)}bu=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||ki.current)ms=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return ms=!1,function(e,t,n){switch(t.tag){case 3:Ts(t),la();break;case 5:to(t);break;case 1:Ci(t.type)&&Li(t);break;case 4:$a(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;wi(da,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(wi(ro,1&ro.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ds(e,t,n):(wi(ro,1&ro.current),null!==(e=Bs(e,t,n))?e.sibling:null);wi(ro,1&ro.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Fs(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),wi(ro,ro.current),r)break;return null;case 22:case 23:return t.lanes=0,xs(e,t,n)}return Bs(e,t,n)}(e,t,n);ms=0!==(131072&e.flags)}else ms=!1,ea&&0!==(1048576&t.flags)&&Yi(t,Gi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;zs(e,t),e=t.pendingProps;var i=Ei(t,Mi.current);_a(t,n),i=_o(null,t,r,e,i,n);var o=xo();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ci(r)?(o=!0,Li(t)):o=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Ea(t),i.updater=Ua,t.stateNode=i,i._reactInternals=t,Va(t,r,e,n),t=ks(null,t,r,!0,o,n)):(t.tag=0,ea&&o&&Ki(t),gs(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(zs(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Cl(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===C)return 11;if(e===P)return 14}return 2}(r),e=fa(r,e),i){case 0:t=Ss(null,t,r,e,n);break e;case 1:t=Ms(null,t,r,e,n);break e;case 11:t=ys(null,t,r,e,n);break e;case 14:t=bs(null,t,r,fa(r.type,e),n);break e}throw Error(a(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Ss(e,t,r,i=t.elementType===r?i:fa(r,i),n);case 1:return r=t.type,i=t.pendingProps,Ms(e,t,r,i=t.elementType===r?i:fa(r,i),n);case 3:e:{if(Ts(t),null===e)throw Error(a(387));r=t.pendingProps,i=(o=t.memoizedState).element,Ca(e,t),Da(t,r,null,n);var s=t.memoizedState;if(r=s.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Es(e,t,r,n,i=os(Error(a(423)),t));break e}if(r!==i){t=Es(e,t,r,n,i=os(Error(a(424)),t));break e}for($i=ai(t.stateNode.containerInfo.firstChild),Qi=t,ea=!0,ta=null,n=qa(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(la(),r===i){t=Bs(e,t,n);break e}gs(e,t,r,n)}t=t.child}return t;case 5:return to(t),null===e&&aa(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,s=i.children,Qr(r,i)?s=null:null!==o&&Qr(r,o)&&(t.flags|=32),ws(e,t),gs(e,t,s,n),t.child;case 6:return null===e&&aa(t),null;case 13:return Ds(e,t,n);case 4:return $a(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Za(t,null,r,n):gs(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,ys(e,t,r,i=t.elementType===r?i:fa(r,i),n);case 7:return gs(e,t,t.pendingProps,n),t.child;case 8:case 12:return gs(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,s=i.value,wi(da,r._currentValue),r._currentValue=s,null!==o)if(rr(o.value,s)){if(o.children===i.children&&!ki.current){t=Bs(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var u=o.dependencies;if(null!==u){s=o.child;for(var l=u.firstContext;null!==l;){if(l.context===r){if(1===o.tag){(l=Aa(-1,n&-n)).tag=2;var c=o.updateQueue;if(null!==c){var h=(c=c.shared).pending;null===h?l.next=l:(l.next=h.next,h.next=l),c.pending=l}}o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),ba(o.return,n,t),u.lanes|=n;break}l=l.next}}else if(10===o.tag)s=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(a(341));s.lanes|=n,null!==(u=s.alternate)&&(u.lanes|=n),ba(s,n,t),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===t){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}gs(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,_a(t,n),r=r(i=xa(i)),t.flags|=1,gs(e,t,r,n),t.child;case 14:return i=fa(r=t.type,t.pendingProps),bs(e,t,r,i=fa(r.type,i),n);case 15:return _s(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:fa(r,i),zs(e,t),t.tag=1,Ci(r)?(e=!0,Li(t)):e=!1,_a(t,n),za(t,r,i),Va(t,r,i,n),ks(null,t,r,!0,e,n);case 19:return Fs(e,t,n);case 22:return xs(e,t,n)}throw Error(a(156,t.tag))};var Hl="function"===typeof reportError?reportError:function(e){console.error(e)};function Wl(e){this._internalRoot=e}function Zl(e){this._internalRoot=e}function ql(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Yl(){}function Kl(e,t,n,r,i){var a=n._reactRootContainer;if(a){var o=a;if("function"===typeof i){var s=i;i=function(){var e=Vl(o);s.call(e)}}Bl(t,o,e,i)}else o=function(e,t,n,r,i){if(i){if("function"===typeof r){var a=r;r=function(){var e=Vl(o);a.call(e)}}var o=zl(t,r,e,0,null,!1,0,"",Yl);return e._reactRootContainer=o,e[ci]=o.current,Fr(8===e.nodeType?e.parentNode:e),ol(),o}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var s=r;r=function(){var e=Vl(u);s.call(e)}}var u=Ol(e,0,!1,null,0,!1,0,"",Yl);return e._reactRootContainer=u,e[ci]=u.current,Fr(8===e.nodeType?e.parentNode:e),ol((function(){Bl(t,u,n,r)})),u}(n,t,e,i,r);return Vl(o)}Zl.prototype.render=Wl.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Bl(e,t,null,null)},Zl.prototype.unmount=Wl.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;ol((function(){Bl(null,e,null,null)})),t[ci]=null}},Zl.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Lt.length&&0!==t&&t<Lt[n].priority;n++);Lt.splice(n,0,e),0===n&&Ot(e)}},_t=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ct(t.pendingLanes);0!==n&&(gt(t,1|n),$u(t,Ke()),0===(6&Mu)&&(Fu=Ke()+500,Fi()))}break;case 13:ol((function(){var t=ka(e,1);if(null!==t){var n=Ku();Qu(t,e,1,n)}})),jl(e,1)}},xt=function(e){if(13===e.tag){var t=ka(e,134217728);if(null!==t)Qu(t,e,134217728,Ku());jl(e,134217728)}},wt=function(e){if(13===e.tag){var t=Ju(e),n=ka(e,t);if(null!==n)Qu(n,e,t,Ku());jl(e,t)}},St=function(){return yt},Mt=function(e,t){var n=yt;try{return yt=e,t()}finally{yt=n}},xe=function(e,t,n){switch(t){case"input":if(Q(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=gi(r);if(!i)throw Error(a(90));q(r),Q(r,i)}}}break;case"textarea":ae(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ee=al,Ce=ol;var Jl={usingClientEntryPoint:!1,Events:[vi,mi,gi,ke,Te,al]},Ql={findFiberByHostInstance:pi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},$l={bundleType:Ql.bundleType,version:Ql.version,rendererPackageName:Ql.rendererPackageName,rendererConfig:Ql.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:Ql.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ec=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ec.isDisabled&&ec.supportsFiber)try{rt=ec.inject($l),it=ec}catch(tc){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Jl,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!ql(t))throw Error(a(200));return Ul(e,t,null,n)},t.createRoot=function(e,t){if(!ql(e))throw Error(a(299));var n=!1,r="",i=Hl;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Ol(e,1,!1,null,0,n,0,r,i),e[ci]=t.current,Fr(8===e.nodeType?e.parentNode:e),new Wl(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return ol(e)},t.hydrate=function(e,t,n){if(!Xl(t))throw Error(a(200));return Kl(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!ql(e))throw Error(a(405));var r=null!=n&&n.hydratedSources||null,i=!1,o="",s=Hl;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=zl(t,null,e,1,null!=n?n:null,i,0,o,s),e[ci]=t.current,Fr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Zl(t)},t.render=function(e,t,n){if(!Xl(t))throw Error(a(200));return Kl(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Xl(e))throw Error(a(40));return!!e._reactRootContainer&&(ol((function(){Kl(null,null,e,!1,(function(){e._reactRootContainer=null,e[ci]=null}))})),!0)},t.unstable_batchedUpdates=al,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Xl(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return Kl(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},1250:function(e,t,n){"use strict";var r=n(4164);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},4164:function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4463)},6374:function(e,t,n){"use strict";var r=n(2791),i=Symbol.for("react.element"),a=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var r,a={},l=null,c=null;for(r in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(c=t.ref),t)o.call(t,r)&&!u.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:i,type:e,key:l,ref:c,props:a,_owner:s.current}}t.Fragment=a,t.jsx=l,t.jsxs=l},9117:function(e,t){"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),u=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),d=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,m={};function g(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=g.prototype;var _=b.prototype=new y;_.constructor=b,v(_,g.prototype),_.isPureReactComponent=!0;var x=Array.isArray,w=Object.prototype.hasOwnProperty,S={current:null},M={key:!0,ref:!0,__self:!0,__source:!0};function k(e,t,r){var i,a={},o=null,s=null;if(null!=t)for(i in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)w.call(t,i)&&!M.hasOwnProperty(i)&&(a[i]=t[i]);var u=arguments.length-2;if(1===u)a.children=r;else if(1<u){for(var l=Array(u),c=0;c<u;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(i in u=e.defaultProps)void 0===a[i]&&(a[i]=u[i]);return{$$typeof:n,type:e,key:o,ref:s,props:a,_owner:S.current}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var E=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function A(e,t,i,a,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0}}if(u)return o=o(u=e),e=""===a?"."+C(u,0):a,x(o)?(i="",null!=e&&(i=e.replace(E,"$&/")+"/"),A(o,t,i,"",(function(e){return e}))):null!=o&&(T(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,i+(!o.key||u&&u.key===o.key?"":(""+o.key).replace(E,"$&/")+"/")+e)),t.push(o)),1;if(u=0,a=""===a?".":a+":",x(e))for(var l=0;l<e.length;l++){var c=a+C(s=e[l],l);u+=A(s,t,i,c,o)}else if(c=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=d&&e[d]||e["@@iterator"])?e:null}(e),"function"===typeof c)for(e=c.call(e),l=0;!(s=e.next()).done;)u+=A(s=s.value,t,i,c=a+C(s,l++),o);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return u}function R(e,t,n){if(null==e)return e;var r=[],i=0;return A(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function P(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var L={current:null},D={transition:null},N={ReactCurrentDispatcher:L,ReactCurrentBatchConfig:D,ReactCurrentOwner:S};t.Children={map:R,forEach:function(e,t,n){R(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return R(e,(function(){t++})),t},toArray:function(e){return R(e,(function(e){return e}))||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=g,t.Fragment=i,t.Profiler=o,t.PureComponent=b,t.StrictMode=a,t.Suspense=c,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=N,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=v({},e.props),a=e.key,o=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,s=S.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(l in t)w.call(t,l)&&!M.hasOwnProperty(l)&&(i[l]=void 0===t[l]&&void 0!==u?u[l]:t[l])}var l=arguments.length-2;if(1===l)i.children=r;else if(1<l){u=Array(l);for(var c=0;c<l;c++)u[c]=arguments[c+2];i.children=u}return{$$typeof:n,type:e.type,key:a,ref:o,props:i,_owner:s}},t.createContext=function(e){return(e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=k,t.createFactory=function(e){var t=k.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:f,_payload:{_status:-1,_result:e},_init:P}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return L.current.useCallback(e,t)},t.useContext=function(e){return L.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return L.current.useDeferredValue(e)},t.useEffect=function(e,t){return L.current.useEffect(e,t)},t.useId=function(){return L.current.useId()},t.useImperativeHandle=function(e,t,n){return L.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return L.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return L.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return L.current.useMemo(e,t)},t.useReducer=function(e,t,n){return L.current.useReducer(e,t,n)},t.useRef=function(e){return L.current.useRef(e)},t.useState=function(e){return L.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return L.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return L.current.useTransition()},t.version="18.2.0"},2791:function(e,t,n){"use strict";e.exports=n(9117)},184:function(e,t,n){"use strict";e.exports=n(6374)},6813:function(e,t){"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<a(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var s=2*(r+1)-1,u=e[s],l=s+1,c=e[l];if(0>a(u,n))l<i&&0>a(c,u)?(e[r]=c,e[l]=n,r=l):(e[r]=u,e[s]=n,r=s);else{if(!(l<i&&0>a(c,n)))break e;e[r]=c,e[l]=n,r=l}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,u=s.now();t.unstable_now=function(){return s.now()-u}}var l=[],c=[],h=1,f=null,d=3,p=!1,v=!1,m=!1,g="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function _(e){for(var t=r(c);null!==t;){if(null===t.callback)i(c);else{if(!(t.startTime<=e))break;i(c),t.sortIndex=t.expirationTime,n(l,t)}t=r(c)}}function x(e){if(m=!1,_(e),!v)if(null!==r(l))v=!0,D(w);else{var t=r(c);null!==t&&N(x,t.startTime-e)}}function w(e,n){v=!1,m&&(m=!1,y(T),T=-1),p=!0;var a=d;try{for(_(n),f=r(l);null!==f&&(!(f.expirationTime>n)||e&&!A());){var o=f.callback;if("function"===typeof o){f.callback=null,d=f.priorityLevel;var s=o(f.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?f.callback=s:f===r(l)&&i(l),_(n)}else i(l);f=r(l)}if(null!==f)var u=!0;else{var h=r(c);null!==h&&N(x,h.startTime-n),u=!1}return u}finally{f=null,d=a,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,M=!1,k=null,T=-1,E=5,C=-1;function A(){return!(t.unstable_now()-C<E)}function R(){if(null!==k){var e=t.unstable_now();C=e;var n=!0;try{n=k(!0,e)}finally{n?S():(M=!1,k=null)}}else M=!1}if("function"===typeof b)S=function(){b(R)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,L=P.port2;P.port1.onmessage=R,S=function(){L.postMessage(null)}}else S=function(){g(R,0)};function D(e){k=e,M||(M=!0,S())}function N(e,n){T=g((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){v||p||(v=!0,D(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var n=d;d=t;try{return e()}finally{d=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=d;d=e;try{return t()}finally{d=n}},t.unstable_scheduleCallback=function(e,i,a){var o=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?o+a:o:a=o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:a,expirationTime:s=a+s,sortIndex:-1},a>o?(e.sortIndex=a,n(c,e),null===r(l)&&e===r(c)&&(m?(y(T),T=-1):m=!0,N(x,a-o))):(e.sortIndex=s,n(l,e),v||p||(v=!0,D(w))),e},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(e){var t=d;return function(){var n=d;d=t;try{return e.apply(this,arguments)}finally{d=n}}}},5296:function(e,t,n){"use strict";e.exports=n(6813)},9613:function(e){e.exports=function(e,t,n,r){var i=n?n.call(r,e,t):void 0;if(void 0!==i)return!!i;if(e===t)return!0;if("object"!==typeof e||!e||"object"!==typeof t||!t)return!1;var a=Object.keys(e),o=Object.keys(t);if(a.length!==o.length)return!1;for(var s=Object.prototype.hasOwnProperty.bind(t),u=0;u<a.length;u++){var l=a[u];if(!s(l))return!1;var c=e[l],h=t[l];if(!1===(i=n?n.call(r,c,h,l):void 0)||void 0===i&&c!==h)return!1}return!0}},8562:function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(1667));function a(e,t){var n=function(n){return i.empty(e).map((function(){return i.filled(t,n)}))},r=[];return r.push(n(-1)),r.push(n(1/0)),r.push(n(0)),r}function o(e,t,n,r,i){t=Math.floor(t);var a=e[0][t],o=e[1][t];e[2][t];if(n>=o[0])return 0;for(var u=0;u<a.length;u++)if(r===a[u])return 0;return s(e,t,n,r,i)}function s(e,t,n,r,i){var a=e[0][t],o=e[1][t],s=e[2][t];if(n>=o[0])return 0;o[0]=n,a[0]=r,s[0]=i;for(var u=0,l=0;;){var c=2*u+1,h=c+1,f=e[0][0].length;if(c>=f)break;if(h>=f){if(!(o[c]>n))break;l=c}else if(o[c]>=o[h]){if(!(n<o[c]))break;l=c}else{if(!(n<o[h]))break;l=h}o[u]=o[l],a[u]=a[l],s[u]=s[l],u=l}return o[u]=n,a[u]=r,s[u]=i,1}function u(e,t,n,r){for(;2*r+1<n;){var i=2*r+1,a=i+1,o=r;if(e[o]<e[i]&&(o=i),a<n&&e[o]<e[a]&&(o=a),o===r)break;var s=e[r];e[r]=e[o],e[o]=s;var u=t[r];t[r]=t[o],t[o]=u,r=o}}t.makeHeap=a,t.rejectionSample=function(e,t,n){for(var r=i.zeros(e),a=0;a<e;a++){for(var o=!0,s=0;o;){s=i.tauRandInt(t,n);for(var u=!1,l=0;l<a;l++)if(s===r[l]){u=!0;break}u||(o=!1)}r[a]=s}return r},t.heapPush=o,t.uncheckedHeapPush=s,t.buildCandidates=function(e,t,n,r,s){for(var u=a(t,r),l=0;l<t;l++)for(var c=0;c<n;c++)if(!(e[0][l][c]<0)){var h=e[0][l][c],f=e[2][l][c],d=i.tauRand(s);o(u,l,d,h,f),o(u,h,d,l,f),e[2][l][c]=0}return u},t.deheapSort=function(e){for(var t=e[0],n=e[1],r=0;r<t.length;r++)for(var i=t[r],a=n[r],o=0;o<i.length-1;o++){var s=i.length-o-1,l=a.length-o-1,c=i[0];i[0]=i[s],i[s]=c;var h=a[0];a[0]=a[l],a[l]=h,u(a,i,l,0)}return{indices:t,weights:n}},t.smallestFlagged=function(e,t){for(var n=e[0][t],r=e[1][t],i=e[2][t],a=1/0,o=-1,s=0;s>n.length;s++)1===i[s]&&r[s]<a&&(a=r[s],o=s);return o>=0?(i[o]=0,Math.floor(n[o])):-1}},1842:function(e,t,n){"use strict";var r=n(3858);t.u=r.UMAP},3901:function(e,t,n){"use strict";var r,i=this&&this.__read||function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,a=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o},a=this&&this.__values||function(e){var t="function"===typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(1667)),u=function(){function e(e,t,n,r){if(this.entries=new Map,this.nRows=0,this.nCols=0,e.length!==t.length||e.length!==n.length)throw new Error("rows, cols and values arrays must all have the same length");this.nRows=r[0],this.nCols=r[1];for(var i=0;i<n.length;i++){var a=e[i],o=t[i];this.checkDims(a,o);var s=this.makeKey(a,o);this.entries.set(s,{value:n[i],row:a,col:o})}}return e.prototype.makeKey=function(e,t){return e+":"+t},e.prototype.checkDims=function(e,t){if(!(e<this.nRows&&t<this.nCols))throw new Error("row and/or col specified outside of matrix dimensions")},e.prototype.set=function(e,t,n){this.checkDims(e,t);var r=this.makeKey(e,t);this.entries.has(r)?this.entries.get(r).value=n:this.entries.set(r,{value:n,row:e,col:t})},e.prototype.get=function(e,t,n){void 0===n&&(n=0),this.checkDims(e,t);var r=this.makeKey(e,t);return this.entries.has(r)?this.entries.get(r).value:n},e.prototype.getAll=function(e){void 0===e&&(e=!0);var t=[];return this.entries.forEach((function(e){t.push(e)})),e&&t.sort((function(e,t){return e.row===t.row?e.col-t.col:e.row-t.row})),t},e.prototype.getDims=function(){return[this.nRows,this.nCols]},e.prototype.getRows=function(){return Array.from(this.entries,(function(e){var t=i(e,2);t[0];return t[1].row}))},e.prototype.getCols=function(){return Array.from(this.entries,(function(e){var t=i(e,2);t[0];return t[1].col}))},e.prototype.getValues=function(){return Array.from(this.entries,(function(e){var t=i(e,2);t[0];return t[1].value}))},e.prototype.forEach=function(e){this.entries.forEach((function(t){return e(t.value,t.row,t.col)}))},e.prototype.map=function(t){var n=[];this.entries.forEach((function(e){n.push(t(e.value,e.row,e.col))}));var r=[this.nRows,this.nCols];return new e(this.getRows(),this.getCols(),n,r)},e.prototype.toArray=function(){var e=this,t=s.empty(this.nRows).map((function(){return s.zeros(e.nCols)}));return this.entries.forEach((function(e){t[e.row][e.col]=e.value})),t},e}();t.SparseMatrix=u,t.transpose=function(e){var t=[],n=[],r=[];e.forEach((function(e,i,a){t.push(i),n.push(a),r.push(e)}));var i=[e.nCols,e.nRows];return new u(n,t,r,i)},t.identity=function(e){for(var t=i(e,1)[0],n=new u([],[],[],e),r=0;r<t;r++)n.set(r,r,1);return n},t.pairwiseMultiply=function(e,t){return c(e,t,(function(e,t){return e*t}))},t.add=function(e,t){return c(e,t,(function(e,t){return e+t}))},t.subtract=function(e,t){return c(e,t,(function(e,t){return e-t}))},t.maximum=function(e,t){return c(e,t,(function(e,t){return e>t?e:t}))},t.multiplyScalar=function(e,t){return e.map((function(e){return e*t}))},t.eliminateZeros=function(e){for(var t=new Set,n=e.getValues(),r=e.getRows(),i=e.getCols(),a=0;a<n.length;a++)0===n[a]&&t.add(a);var o=function(e,n){return!t.has(n)},s=n.filter(o),l=r.filter(o),c=i.filter(o);return new u(l,c,s,e.getDims())},t.normalize=function(e,t){var n,r;void 0===t&&(t="l2");var i=l[t],o=new Map;e.forEach((function(e,t,n){var r=o.get(t)||[];r.push(n),o.set(t,r)}));var s=new u([],[],[],e.getDims()),c=function(t){for(var n=o.get(t).sort(),r=n.map((function(n){return e.get(t,n)})),a=i(r),u=0;u<a.length;u++)s.set(t,n[u],a[u])};try{for(var h=a(o.keys()),f=h.next();!f.done;f=h.next()){c(f.value)}}catch(d){n={error:d}}finally{try{f&&!f.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}return s};var l=((r={}).max=function(e){for(var t=-1/0,n=0;n<e.length;n++)t=e[n]>t?e[n]:t;return e.map((function(e){return e/t}))},r.l1=function(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return e.map((function(e){return e/t}))},r.l2=function(e){for(var t=0,n=0;n<e.length;n++)t+=Math.pow(e[n],2);return e.map((function(e){return Math.sqrt(Math.pow(e,2)/t)}))},r);function c(e,t,n){for(var r=new Set,i=[],a=[],o=[],s=function(r,s){i.push(r),a.push(s);var u=n(e.get(r,s),t.get(r,s));o.push(u)},l=e.getValues(),c=e.getRows(),h=e.getCols(),f=0;f<l.length;f++){var d=(g=c[f])+":"+(y=h[f]);r.add(d),s(g,y)}var p=t.getValues(),v=t.getRows(),m=t.getCols();for(f=0;f<p.length;f++){var g,y;d=(g=v[f])+":"+(y=m[f]);r.has(d)||s(g,y)}var b=[e.nRows,e.nCols];return new u(i,a,o,b)}t.getCSR=function(e){var t=[];e.forEach((function(e,n,r){t.push({value:e,row:n,col:r})})),t.sort((function(e,t){return e.row===t.row?e.col-t.col:e.row-t.row}));for(var n=[],r=[],i=[],a=-1,o=0;o<t.length;o++){var s=t[o],u=s.row,l=s.col,c=s.value;u!==a&&(a=u,i.push(o)),n.push(l),r.push(c)}return{indices:n,values:r,indptr:i}}},1790:function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"===typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(8562)),o=i(n(3901)),s=i(n(4083)),u=i(n(1667));t.makeNNDescent=function(e,t){return function(n,r,i,o,s,l,c,h){void 0===o&&(o=10),void 0===s&&(s=50),void 0===l&&(l=.001),void 0===c&&(c=.5),void 0===h&&(h=!0);for(var f=n.length,d=a.makeHeap(n.length,i),p=0;p<n.length;p++)for(var v=a.rejectionSample(i,n.length,t),m=0;m<v.length;m++){var g=e(n[p],n[v[m]]);a.heapPush(d,p,g,v[m],1),a.heapPush(d,v[m],g,p,1)}if(h)for(var y=0;y<r.length;y++)for(p=0;p<r[y].length&&!(r[y][p]<0);p++)for(m=p+1;m<r[y].length&&!(r[y][m]<0);m++){g=e(n[r[y][p]],n[r[y][m]]);a.heapPush(d,r[y][p],g,r[y][m],1),a.heapPush(d,r[y][m],g,r[y][p],1)}for(y=0;y<o;y++){var b=a.buildCandidates(d,f,i,s,t),_=0;for(p=0;p<f;p++)for(m=0;m<s;m++){var x=Math.floor(b[0][p][m]);if(!(x<0||u.tauRand(t)<c))for(var w=0;w<s;w++){var S=Math.floor(b[0][p][w]),M=b[2][p][m],k=b[2][p][w];if(!(S<0||!M&&!k)){g=e(n[x],n[S]);_+=a.heapPush(d,x,g,S,1),_+=a.heapPush(d,S,g,x,1)}}}if(_<=l*i*n.length)break}return a.deheapSort(d)}},t.makeInitializations=function(e){return{initFromRandom:function(t,n,r,i,o){for(var s=0;s<r.length;s++)for(var l=u.rejectionSample(t,n.length,o),c=0;c<l.length;c++)if(!(l[c]<0)){var h=e(n[l[c]],r[s]);a.heapPush(i,s,h,l[c],1)}},initFromTree:function(t,n,r,i,o){for(var u=0;u<r.length;u++)for(var l=s.searchFlatTree(r[u],t,o),c=0;c<l.length;c++){if(l[c]<0)return;var h=e(n[l[c]],r[u]);a.heapPush(i,u,h,l[c],1)}}}},t.makeInitializedNNSearch=function(e){return function(t,n,i,s){for(var u,l,c=o.getCSR(n),h=c.indices,f=c.indptr,d=0;d<s.length;d++)for(var p=new Set(i[0][d]);;){var v=a.smallestFlagged(i,d);if(-1===v)break;var m=h.slice(f[v],f[v+1]);try{for(var g=r(m),y=g.next();!y.done;y=g.next()){var b=y.value;if(b!==v&&-1!==b&&!p.has(b)){var _=e(t[b],s[d]);a.uncheckedHeapPush(i,d,_,b,1),p.add(b)}}}catch(x){u={error:x}}finally{try{y&&!y.done&&(l=g.return)&&l.call(g)}finally{if(u)throw u.error}}}return i}},t.initializeSearch=function(e,t,n,i,o,s,u){var l,c,h=a.makeHeap(n.length,i);if(o(i,t,n,h,u),e)try{for(var f=r(e),d=f.next();!d.done;d=f.next()){s(d.value,t,n,h,u)}}catch(p){l={error:p}}finally{try{d&&!d.done&&(c=f.return)&&c.call(f)}finally{if(l)throw l.error}}return h}},4083:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,a=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e},a=this&&this.__values||function(e){var t="function"===typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(1667)),u=function(e,t,n,r){this.hyperplanes=e,this.offsets=t,this.children=n,this.indices=r};function l(e,t,n,r,i){if(void 0===n&&(n=30),t.length>n){var a=function(e,t,n){var r=e[0].length,i=s.tauRandInt(t.length,n),a=s.tauRandInt(t.length,n);a=(a+=i===a?1:0)%t.length;for(var o=t[i],u=t[a],l=0,c=s.zeros(r),h=0;h<c.length;h++)c[h]=e[o][h]-e[u][h],l-=c[h]*(e[o][h]+e[u][h])/2;var f=0,d=0,p=s.zeros(t.length);for(h=0;h<t.length;h++){for(var v=l,m=0;m<r;m++)v+=c[m]*e[t[h]][m];0===v?(p[h]=s.tauRandInt(2,n),0===p[h]?f+=1:d+=1):v>0?(p[h]=0,f+=1):(p[h]=1,d+=1)}var g=s.zeros(f),y=s.zeros(d);f=0,d=0;for(h=0;h<p.length;h++)0===p[h]?(g[f]=t[h],f+=1):(y[d]=t[h],d+=1);return{indicesLeft:g,indicesRight:y,hyperplane:c,offset:l}}(e,t,i),o=a.indicesLeft,u=a.indicesRight,c=a.hyperplane,h=a.offset;return{leftChild:l(e,o,n,r+1,i),rightChild:l(e,u,n,r+1,i),isLeaf:!1,hyperplane:c,offset:h}}return{indices:t,isLeaf:!0}}function c(e,t,n,r,a,o,s){var u;if(e.isLeaf)return r[o][0]=-s,(u=a[s]).splice.apply(u,i([0,e.indices.length],e.indices)),{nodeNum:o,leafNum:s+=1};t[o]=e.hyperplane,n[o]=e.offset,r[o][0]=o+1;var l=o,h=c(e.leftChild,t,n,r,a,o+1,s);return o=h.nodeNum,s=h.leafNum,r[l][1]=o+1,{nodeNum:(h=c(e.rightChild,t,n,r,a,o+1,s)).nodeNum,leafNum:h.leafNum}}function h(e){return e.isLeaf?1:1+h(e.leftChild)+h(e.rightChild)}function f(e){return e.isLeaf?1:f(e.leftChild)+f(e.rightChild)}function d(e,t,n,r){for(var i=t,a=0;a<n.length;a++)i+=e[a]*n[a];return 0===i?s.tauRandInt(2,r):i>0?0:1}t.FlatTree=u,t.makeForest=function(e,t,n,r){var i=Math.max(10,t),a=s.range(n).map((function(t,n){return function(e,t,n,r){void 0===t&&(t=30);var i=s.range(e.length);return l(e,i,t,n,r)}(e,i,n,r)})),o=a.map((function(e){return function(e,t){var n=h(e),r=f(e),i=s.range(n).map((function(){return s.zeros(e.hyperplane?e.hyperplane.length:0)})),a=s.zeros(n),o=s.range(n).map((function(){return[-1,-1]})),l=s.range(r).map((function(){return s.range(t).map((function(){return-1}))}));return c(e,i,a,o,l,0,0),new u(i,a,o,l)}(e,i)}));return o},t.makeLeafArray=function(e){var t,n;if(e.length>0){var r=[];try{for(var o=a(e),s=o.next();!s.done;s=o.next()){var u=s.value;r.push.apply(r,i(u.indices))}}catch(l){t={error:l}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r}return[[-1]]},t.searchFlatTree=function(e,t,n){for(var r=0;t.children[r][0]>0;){r=0===d(t.hyperplanes[r],t.offsets[r],e,n)?t.children[r][0]:t.children[r][1]}var i=-1*t.children[r][0];return t.indices[i]}},3858:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{u(r.next(e))}catch(t){a(t)}}function s(e){try{u(r.throw(e))}catch(t){a(t)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(o,s)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(s){a=[6,s],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},a=this&&this.__read||function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,a=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(a(arguments[t]));return e},s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=s(n(8562)),c=s(n(3901)),h=s(n(1790)),f=s(n(4083)),d=s(n(1667)),p=u(n(2744)),v=1e-5,m=.001,g=function(){function e(e){void 0===e&&(e={});var t=this;this.learningRate=1,this.localConnectivity=1,this.minDist=.1,this.nComponents=2,this.nEpochs=0,this.nNeighbors=15,this.negativeSampleRate=5,this.random=Math.random,this.repulsionStrength=1,this.setOpMixRatio=1,this.spread=1,this.transformQueueSize=4,this.targetMetric="categorical",this.targetWeight=.5,this.targetNNeighbors=this.nNeighbors,this.distanceFn=y,this.isInitialized=!1,this.rpForest=[],this.embedding=[],this.optimizationState=new b;var n=function(n){void 0!==e[n]&&(t[n]=e[n])};n("distanceFn"),n("learningRate"),n("localConnectivity"),n("minDist"),n("nComponents"),n("nEpochs"),n("nNeighbors"),n("negativeSampleRate"),n("random"),n("repulsionStrength"),n("setOpMixRatio"),n("spread"),n("transformQueueSize")}return e.prototype.fit=function(e){return this.initializeFit(e),this.optimizeLayout(),this.embedding},e.prototype.fitAsync=function(e,t){return void 0===t&&(t=function(){return!0}),r(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return this.initializeFit(e),[4,this.optimizeLayoutAsync(t)];case 1:return n.sent(),[2,this.embedding]}}))}))},e.prototype.setSupervisedProjection=function(e,t){void 0===t&&(t={}),this.Y=e,this.targetMetric=t.targetMetric||this.targetMetric,this.targetWeight=t.targetWeight||this.targetWeight,this.targetNNeighbors=t.targetNNeighbors||this.targetNNeighbors},e.prototype.setPrecomputedKNN=function(e,t){this.knnIndices=e,this.knnDistances=t},e.prototype.initializeFit=function(e){if(e.length<=this.nNeighbors)throw new Error("Not enough data points ("+e.length+") to create nNeighbors: "+this.nNeighbors+".  Add more data points or adjust the configuration.");if(this.X===e&&this.isInitialized)return this.getNEpochs();if(this.X=e,!this.knnIndices&&!this.knnDistances){var t=this.nearestNeighbors(e);this.knnIndices=t.knnIndices,this.knnDistances=t.knnDistances}this.graph=this.fuzzySimplicialSet(e,this.nNeighbors,this.setOpMixRatio),this.makeSearchFns(),this.searchGraph=this.makeSearchGraph(e),this.processGraphForSupervisedProjection();var n=this.initializeSimplicialSetEmbedding(),r=n.head,i=n.tail,a=n.epochsPerSample;return this.optimizationState.head=r,this.optimizationState.tail=i,this.optimizationState.epochsPerSample=a,this.initializeOptimization(),this.prepareForOptimizationLoop(),this.isInitialized=!0,this.getNEpochs()},e.prototype.makeSearchFns=function(){var e=h.makeInitializations(this.distanceFn),t=e.initFromTree,n=e.initFromRandom;this.initFromTree=t,this.initFromRandom=n,this.search=h.makeInitializedNNSearch(this.distanceFn)},e.prototype.makeSearchGraph=function(e){for(var t=this.knnIndices,n=this.knnDistances,r=[e.length,e.length],i=new c.SparseMatrix([],[],[],r),a=0;a<t.length;a++)for(var o=t[a],s=n[a],u=0;u<o.length;u++){var l=o[u],h=s[u];h>0&&i.set(a,l,h)}var f=c.transpose(i);return c.maximum(i,f)},e.prototype.transform=function(e){var t=this,n=this.X;if(void 0===n||0===n.length)throw new Error("No data has been fit.");var r=Math.floor(this.nNeighbors*this.transformQueueSize);r=Math.min(n.length,r);var i=h.initializeSearch(this.rpForest,n,e,r,this.initFromRandom,this.initFromTree,this.random),a=this.search(n,this.searchGraph,i,e),o=l.deheapSort(a),s=o.indices,u=o.weights;s=s.map((function(e){return e.slice(0,t.nNeighbors)})),u=u.map((function(e){return e.slice(0,t.nNeighbors)}));var f=Math.max(0,this.localConnectivity-1),p=this.smoothKNNDistance(u,this.nNeighbors,f),v=p.sigmas,m=p.rhos,g=this.computeMembershipStrengths(s,u,v,m),y=g.rows,b=g.cols,_=g.vals,x=[e.length,n.length],w=new c.SparseMatrix(y,b,_,x),S=c.normalize(w,"l1"),M=c.getCSR(S),T=e.length,E=k(d.reshape2d(M.indices,T,this.nNeighbors),d.reshape2d(M.values,T,this.nNeighbors),this.embedding),C=this.nEpochs?this.nEpochs/3:w.nRows<=1e4?100:30,A=w.getValues().reduce((function(e,t){return t>e?t:e}),0);w=w.map((function(e){return e<A/C?0:e})),w=c.eliminateZeros(w);var R=this.makeEpochsPerSample(w.getValues(),C),P=w.getRows(),L=w.getCols();return this.assignOptimizationStateParameters({headEmbedding:E,tailEmbedding:this.embedding,head:P,tail:L,currentEpoch:0,nEpochs:C,nVertices:w.getDims()[1],epochsPerSample:R}),this.prepareForOptimizationLoop(),this.optimizeLayout()},e.prototype.processGraphForSupervisedProjection=function(){var e=this.Y,t=this.X;if(e){if(e.length!==t.length)throw new Error("Length of X and y must be equal");if("categorical"===this.targetMetric){var n=this.targetWeight<1?1/(1-this.targetWeight)*2.5:1e12;this.graph=this.categoricalSimplicialSetIntersection(this.graph,e,n)}}},e.prototype.step=function(){var e=this.optimizationState.currentEpoch;return e<this.getNEpochs()&&this.optimizeLayoutStep(e),this.optimizationState.currentEpoch},e.prototype.getEmbedding=function(){return this.embedding},e.prototype.nearestNeighbors=function(e){var t=this.distanceFn,n=this.nNeighbors,r=h.makeNNDescent(t,this.random),i=5+Math.floor(function(e){return.5===e?0:Math.round(e)}(Math.pow(e.length,.5)/20)),a=Math.max(5,Math.floor(Math.round(function(e){return Math.log(e)/Math.log(2)}(e.length))));this.rpForest=f.makeForest(e,n,i,this.random);var o=r(e,f.makeLeafArray(this.rpForest),n,a);return{knnIndices:o.indices,knnDistances:o.weights}},e.prototype.fuzzySimplicialSet=function(e,t,n){void 0===n&&(n=1);var r=this,i=r.knnIndices,a=void 0===i?[]:i,o=r.knnDistances,s=void 0===o?[]:o,u=r.localConnectivity,l=this.smoothKNNDistance(s,t,u),h=l.sigmas,f=l.rhos,d=this.computeMembershipStrengths(a,s,h,f),p=d.rows,v=d.cols,m=d.vals,g=[e.length,e.length],y=new c.SparseMatrix(p,v,m,g),b=c.transpose(y),_=c.pairwiseMultiply(y,b),x=c.subtract(c.add(y,b),_),w=c.multiplyScalar(x,n),S=c.multiplyScalar(_,1-n);return c.add(w,S)},e.prototype.categoricalSimplicialSetIntersection=function(e,t,n,r){void 0===r&&(r=1);var i=S(e,t,r,n);return M(i=c.eliminateZeros(i))},e.prototype.smoothKNNDistance=function(e,t,n,r,i){void 0===n&&(n=1),void 0===r&&(r=64),void 0===i&&(i=1);for(var a=Math.log(t)/Math.log(2)*i,o=d.zeros(e.length),s=d.zeros(e.length),u=0;u<e.length;u++){var l=0,c=1/0,h=1,f=e[u],p=f.filter((function(e){return e>0}));if(p.length>=n){var g=Math.floor(n),y=n-g;g>0?(o[u]=p[g-1],y>v&&(o[u]+=y*(p[g]-p[g-1]))):o[u]=y*p[0]}else p.length>0&&(o[u]=d.max(p));for(var b=0;b<r;b++){for(var _=0,x=1;x<e[u].length;x++){var w=e[u][x]-o[u];_+=w>0?Math.exp(-w/h):1}if(Math.abs(_-a)<v)break;_>a?h=(l+(c=h))/2:(l=h,c===1/0?h*=2:h=(l+c)/2)}if(s[u]=h,o[u]>0){var S=d.mean(f);s[u]<m*S&&(s[u]=m*S)}else{var M=d.mean(e.map(d.mean));s[u]<m*M&&(s[u]=m*M)}}return{sigmas:s,rhos:o}},e.prototype.computeMembershipStrengths=function(e,t,n,r){for(var i=e.length,a=e[0].length,o=d.zeros(i*a),s=d.zeros(i*a),u=d.zeros(i*a),l=0;l<i;l++)for(var c=0;c<a;c++){var h=0;-1!==e[l][c]&&(h=e[l][c]===l?0:t[l][c]-r[l]<=0?1:Math.exp(-(t[l][c]-r[l])/n[l]),o[l*a+c]=l,s[l*a+c]=e[l][c],u[l*a+c]=h)}return{rows:o,cols:s,vals:u}},e.prototype.initializeSimplicialSetEmbedding=function(){for(var e=this,t=this.getNEpochs(),n=this.nComponents,r=this.graph.getValues(),i=0,a=0;a<r.length;a++){var o=r[a];i<r[a]&&(i=o)}var s=this.graph.map((function(e){return e<i/t?0:e}));this.embedding=d.zeros(s.nRows).map((function(){return d.zeros(n).map((function(){return 20*d.tauRand(e.random)-10}))}));var u=[],l=[],c=[],h=s.getAll();for(a=0;a<h.length;a++){var f=h[a];f.value&&(u.push(f.value),c.push(f.row),l.push(f.col))}return{head:l,tail:c,epochsPerSample:this.makeEpochsPerSample(u,t)}},e.prototype.makeEpochsPerSample=function(e,t){var n=d.filled(e.length,-1),r=d.max(e),i=e.map((function(e){return e/r*t}));return i.forEach((function(e,r){e>0&&(n[r]=t/i[r])})),n},e.prototype.assignOptimizationStateParameters=function(e){Object.assign(this.optimizationState,e)},e.prototype.prepareForOptimizationLoop=function(){var e=this,t=e.repulsionStrength,n=e.learningRate,r=e.negativeSampleRate,i=this.optimizationState,a=i.epochsPerSample,s=i.headEmbedding,u=i.tailEmbedding,l=s[0].length,c=s.length===u.length,h=a.map((function(e){return e/r})),f=o(h),d=o(a);this.assignOptimizationStateParameters({epochOfNextSample:d,epochOfNextNegativeSample:f,epochsPerNegativeSample:h,moveOther:c,initialAlpha:n,alpha:n,gamma:t,dim:l})},e.prototype.initializeOptimization=function(){var e=this.embedding,t=this.embedding,n=this.optimizationState,r=n.head,i=n.tail,a=n.epochsPerSample,o=this.getNEpochs(),s=this.graph.nCols,u=w(this.spread,this.minDist),l=u.a,c=u.b;this.assignOptimizationStateParameters({headEmbedding:e,tailEmbedding:t,head:r,tail:i,epochsPerSample:a,a:l,b:c,nEpochs:o,nVertices:s})},e.prototype.optimizeLayoutStep=function(e){for(var t=this.optimizationState,n=t.head,r=t.tail,i=t.headEmbedding,a=t.tailEmbedding,o=t.epochsPerSample,s=t.epochOfNextSample,u=t.epochOfNextNegativeSample,l=t.epochsPerNegativeSample,c=t.moveOther,h=t.initialAlpha,f=t.alpha,p=t.gamma,v=t.a,m=t.b,g=t.dim,y=t.nEpochs,b=t.nVertices,w=0;w<o.length;w++)if(!(s[w]>e)){var S=n[w],M=r[w],k=i[S],T=a[M],E=x(k,T),C=0;E>0&&(C=-2*v*m*Math.pow(E,m-1),C/=v*Math.pow(E,m)+1);for(var A=0;A<g;A++){var R=_(C*(k[A]-T[A]),4);k[A]+=R*f,c&&(T[A]+=-R*f)}s[w]+=o[w];for(var P=Math.floor((e-u[w])/l[w]),L=0;L<P;L++){var D=d.tauRandInt(b,this.random),N=a[D],I=x(k,N),O=0;if(I>0)O=2*p*m,O/=(.001+I)*(v*Math.pow(I,m)+1);else if(S===D)continue;for(A=0;A<g;A++){R=4;O>0&&(R=_(O*(k[A]-N[A]),4)),k[A]+=R*f}}u[w]+=P*l[w]}return t.alpha=h*(1-e/y),t.currentEpoch+=1,i},e.prototype.optimizeLayoutAsync=function(e){var t=this;return void 0===e&&(e=function(){return!0}),new Promise((function(n,a){var o=function o(){return r(t,void 0,void 0,(function(){var t,r,s,u,l,c;return i(this,(function(i){try{if(t=this.optimizationState,r=t.nEpochs,s=t.currentEpoch,this.embedding=this.optimizeLayoutStep(s),u=this.optimizationState.currentEpoch,l=!1===e(u),c=u===r,l||c)return[2,n(c)];setTimeout((function(){return o()}),0)}catch(h){a(h)}return[2]}))}))};setTimeout((function(){return o()}),0)}))},e.prototype.optimizeLayout=function(e){void 0===e&&(e=function(){return!0});for(var t=!1,n=[];!t;){var r=this.optimizationState,i=r.nEpochs,a=r.currentEpoch;n=this.optimizeLayoutStep(a);var o=this.optimizationState.currentEpoch,s=!1===e(o);t=o===i||s}return n},e.prototype.getNEpochs=function(){var e=this.graph;if(this.nEpochs>0)return this.nEpochs;var t=e.nRows;return t<=2500?500:t<=5e3?400:t<=7500?300:200},e}();function y(e,t){for(var n=0,r=0;r<e.length;r++)n+=Math.pow(e[r]-t[r],2);return Math.sqrt(n)}t.UMAP=g,t.euclidean=y,t.cosine=function(e,t){for(var n=0,r=0,i=0,a=0;a<e.length;a++)n+=e[a]*t[a],r+=Math.pow(e[a],2),i+=Math.pow(t[a],2);return 0===r&&0===i?0:0===r||0===i?1:1-n/Math.sqrt(r*i)};var b=function(){this.currentEpoch=0,this.headEmbedding=[],this.tailEmbedding=[],this.head=[],this.tail=[],this.epochsPerSample=[],this.epochOfNextSample=[],this.epochOfNextNegativeSample=[],this.epochsPerNegativeSample=[],this.moveOther=!0,this.initialAlpha=1,this.alpha=1,this.gamma=1,this.a=1.5769434603113077,this.b=.8950608779109733,this.dim=2,this.nEpochs=500,this.nVertices=0};function _(e,t){return e>t?t:e<-t?-t:e}function x(e,t){for(var n=0,r=0;r<e.length;r++)n+=Math.pow(e[r]-t[r],2);return n}function w(e,t){var n=d.linear(0,3*e,300).map((function(e){return e<t?1:e})),r=d.zeros(n.length).map((function(r,i){return n[i]>=t?Math.exp(-(n[i]-t)/e):r})),i={x:n,y:r},o={damping:1.5,initialValues:[.5,.5],gradientDifference:.1,maxIterations:100,errorTolerance:.01},s=p.default(i,(function(e){var t=a(e,2),n=t[0],r=t[1];return function(e){return 1/(1+n*Math.pow(e,2*r))}}),o).parameterValues,u=a(s,2);return{a:u[0],b:u[1]}}function S(e,t,n,r){return void 0===n&&(n=1),void 0===r&&(r=5),e.map((function(e,i,a){return-1===t[i]||-1===t[a]?e*Math.exp(-n):t[i]!==t[a]?e*Math.exp(-r):e}))}function M(e){e=c.normalize(e,"max");var t=c.transpose(e),n=c.pairwiseMultiply(t,e);return e=c.add(e,c.subtract(t,n)),c.eliminateZeros(e)}function k(e,t,n){for(var r=d.zeros(e.length).map((function(e){return d.zeros(n[0].length)})),i=0;i<e.length;i++)for(var a=0;a<e[0].length;a++)for(var o=0;o<n[0].length;o++){var s=e[i][a];r[i][o]+=t[i][a]*n[s][o]}return r}t.findABParams=w,t.fastIntersection=S,t.resetLocalConnectivity=M,t.initTransform=k},1667:function(e,t){"use strict";var n=this&&this.__values||function(e){var t="function"===typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};function r(e,t){return Math.floor(t()*e)}function i(e){for(var t=[],n=0;n<e;n++)t.push(void 0);return t}function a(e,t){return i(e).map((function(){return t}))}function o(e){return a(e,0)}function s(e){return e.reduce((function(e,t){return e+t}))}Object.defineProperty(t,"__esModule",{value:!0}),t.tauRandInt=r,t.tauRand=function(e){return e()},t.norm=function(e){var t,r,i=0;try{for(var a=n(e),o=a.next();!o.done;o=a.next()){var s=o.value;i+=Math.pow(s,2)}}catch(u){t={error:u}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return Math.sqrt(i)},t.empty=i,t.range=function(e){return i(e).map((function(e,t){return t}))},t.filled=a,t.zeros=o,t.ones=function(e){return a(e,1)},t.linear=function(e,t,n){return i(n).map((function(r,i){return e+i*((t-e)/(n-1))}))},t.sum=s,t.mean=function(e){return s(e)/e.length},t.max=function(e){for(var t=0,n=0;n<e.length;n++)t=e[n]>t?e[n]:t;return t},t.max2d=function(e){for(var t=0,n=0;n<e.length;n++)for(var r=0;r<e[n].length;r++)t=e[n][r]>t?e[n][r]:t;return t},t.rejectionSample=function(e,t,n){for(var i=o(e),a=0;a<e;a++)for(var s=!0;s;){for(var u=r(t,n),l=!1,c=0;c<a;c++)if(u===i[c]){l=!0;break}l||(s=!1),i[a]=u}return i},t.reshape2d=function(e,t,n){var r=[],i=0;if(e.length!==t*n)throw new Error("Array dimensions must match input length.");for(var a=0;a<t;a++){for(var o=[],s=0;s<n;s++)o.push(e[i]),i+=1;r.push(o),1}return r}},3897:function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.__esModule=!0,e.exports.default=e.exports},5372:function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},6690:function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},9728:function(e,t,n){var r=n(4062);function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,r(i.key),i)}}e.exports=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},8872:function(e){e.exports=function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],u=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return s}},e.exports.__esModule=!0,e.exports.default=e.exports},2218:function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},7424:function(e,t,n){var r=n(5372),i=n(8872),a=n(6116),o=n(2218);e.exports=function(e,t){return r(e)||i(e,t)||a(e,t)||o()},e.exports.__esModule=!0,e.exports.default=e.exports},5036:function(e,t,n){var r=n(8698).default;e.exports=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},4062:function(e,t,n){var r=n(8698).default,i=n(5036);e.exports=function(e){var t=i(e,"string");return"symbol"===r(t)?t:String(t)},e.exports.__esModule=!0,e.exports.default=e.exports},8698:function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},6116:function(e,t,n){var r=n(3897);e.exports=function(e,t){if(e){if("string"===typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},1501:function(e){e.exports=function(){"use strict";for(var e=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=1),e<t?t:e>n?n:e},t=e,n=function(e){e._clipped=!1,e._unclipped=e.slice(0);for(var n=0;n<=3;n++)n<3?((e[n]<0||e[n]>255)&&(e._clipped=!0),e[n]=t(e[n],0,255)):3===n&&(e[n]=t(e[n],0,1));return e},r={},i=0,a=["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"];i<a.length;i+=1){var o=a[i];r["[object "+o+"]"]=o.toLowerCase()}var s=function(e){return r[Object.prototype.toString.call(e)]||"object"},u=s,l=function(e,t){return void 0===t&&(t=null),e.length>=3?Array.prototype.slice.call(e):"object"==u(e[0])&&t?t.split("").filter((function(t){return void 0!==e[0][t]})).map((function(t){return e[0][t]})):e[0]},c=s,h=function(e){if(e.length<2)return null;var t=e.length-1;return"string"==c(e[t])?e[t].toLowerCase():null},f=Math.PI,d={clip_rgb:n,limit:e,type:s,unpack:l,last:h,PI:f,TWOPI:2*f,PITHIRD:f/3,DEG2RAD:f/180,RAD2DEG:180/f},p={format:{},autodetect:[]},v=d.last,m=d.clip_rgb,g=d.type,y=p,b=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=this;if("object"===g(e[0])&&e[0].constructor&&e[0].constructor===this.constructor)return e[0];var r=v(e),i=!1;if(!r){i=!0,y.sorted||(y.autodetect=y.autodetect.sort((function(e,t){return t.p-e.p})),y.sorted=!0);for(var a=0,o=y.autodetect;a<o.length;a+=1){var s=o[a];if(r=s.test.apply(s,e))break}}if(!y.format[r])throw new Error("unknown format: "+e);var u=y.format[r].apply(null,i?e:e.slice(0,-1));n._rgb=m(u),3===n._rgb.length&&n._rgb.push(1)};b.prototype.toString=function(){return"function"==g(this.hex)?this.hex():"["+this._rgb.join(",")+"]"};var _=b,x=function e(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];return new(Function.prototype.bind.apply(e.Color,[null].concat(t)))};x.Color=_,x.version="2.4.2";var w=x,S=d.unpack,M=Math.max,k=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=S(e,"rgb"),r=n[0],i=n[1],a=n[2],o=1-M(r/=255,M(i/=255,a/=255)),s=o<1?1/(1-o):0;return[(1-r-o)*s,(1-i-o)*s,(1-a-o)*s,o]},T=k,E=d.unpack,C=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=(e=E(e,"cmyk"))[0],r=e[1],i=e[2],a=e[3],o=e.length>4?e[4]:1;return 1===a?[0,0,0,o]:[n>=1?0:255*(1-n)*(1-a),r>=1?0:255*(1-r)*(1-a),i>=1?0:255*(1-i)*(1-a),o]},A=C,R=w,P=_,L=p,D=d.unpack,N=d.type,I=T;P.prototype.cmyk=function(){return I(this._rgb)},R.cmyk=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(P,[null].concat(e,["cmyk"])))},L.format.cmyk=A,L.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=D(e,"cmyk"),"array"===N(e)&&4===e.length)return"cmyk"}});var O=d.unpack,U=d.last,F=function(e){return Math.round(100*e)/100},z=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=O(e,"hsla"),r=U(e)||"lsa";return n[0]=F(n[0]||0),n[1]=F(100*n[1])+"%",n[2]=F(100*n[2])+"%","hsla"===r||n.length>3&&n[3]<1?(n[3]=n.length>3?n[3]:1,r="hsla"):n.length=3,r+"("+n.join(",")+")"},B=z,V=d.unpack,G=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=(e=V(e,"rgba"))[0],r=e[1],i=e[2];n/=255,r/=255,i/=255;var a,o,s=Math.min(n,r,i),u=Math.max(n,r,i),l=(u+s)/2;return u===s?(a=0,o=Number.NaN):a=l<.5?(u-s)/(u+s):(u-s)/(2-u-s),n==u?o=(r-i)/(u-s):r==u?o=2+(i-n)/(u-s):i==u&&(o=4+(n-r)/(u-s)),(o*=60)<0&&(o+=360),e.length>3&&void 0!==e[3]?[o,a,l,e[3]]:[o,a,l]},j=G,H=d.unpack,W=d.last,Z=B,q=j,X=Math.round,Y=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=H(e,"rgba"),r=W(e)||"rgb";return"hsl"==r.substr(0,3)?Z(q(n),r):(n[0]=X(n[0]),n[1]=X(n[1]),n[2]=X(n[2]),("rgba"===r||n.length>3&&n[3]<1)&&(n[3]=n.length>3?n[3]:1,r="rgba"),r+"("+n.slice(0,"rgb"===r?3:4).join(",")+")")},K=Y,J=d.unpack,Q=Math.round,$=function(){for(var e,t=[],n=arguments.length;n--;)t[n]=arguments[n];var r,i,a,o=(t=J(t,"hsl"))[0],s=t[1],u=t[2];if(0===s)r=i=a=255*u;else{var l=[0,0,0],c=[0,0,0],h=u<.5?u*(1+s):u+s-u*s,f=2*u-h,d=o/360;l[0]=d+1/3,l[1]=d,l[2]=d-1/3;for(var p=0;p<3;p++)l[p]<0&&(l[p]+=1),l[p]>1&&(l[p]-=1),6*l[p]<1?c[p]=f+6*(h-f)*l[p]:2*l[p]<1?c[p]=h:3*l[p]<2?c[p]=f+(h-f)*(2/3-l[p])*6:c[p]=f;r=(e=[Q(255*c[0]),Q(255*c[1]),Q(255*c[2])])[0],i=e[1],a=e[2]}return t.length>3?[r,i,a,t[3]]:[r,i,a,1]},ee=$,te=ee,ne=p,re=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,ie=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,ae=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,oe=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,se=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,ue=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,le=Math.round,ce=function(e){var t;if(e=e.toLowerCase().trim(),ne.format.named)try{return ne.format.named(e)}catch(p){}if(t=e.match(re)){for(var n=t.slice(1,4),r=0;r<3;r++)n[r]=+n[r];return n[3]=1,n}if(t=e.match(ie)){for(var i=t.slice(1,5),a=0;a<4;a++)i[a]=+i[a];return i}if(t=e.match(ae)){for(var o=t.slice(1,4),s=0;s<3;s++)o[s]=le(2.55*o[s]);return o[3]=1,o}if(t=e.match(oe)){for(var u=t.slice(1,5),l=0;l<3;l++)u[l]=le(2.55*u[l]);return u[3]=+u[3],u}if(t=e.match(se)){var c=t.slice(1,4);c[1]*=.01,c[2]*=.01;var h=te(c);return h[3]=1,h}if(t=e.match(ue)){var f=t.slice(1,4);f[1]*=.01,f[2]*=.01;var d=te(f);return d[3]=+t[4],d}};ce.test=function(e){return re.test(e)||ie.test(e)||ae.test(e)||oe.test(e)||se.test(e)||ue.test(e)};var he=ce,fe=w,de=_,pe=p,ve=d.type,me=K,ge=he;de.prototype.css=function(e){return me(this._rgb,e)},fe.css=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(de,[null].concat(e,["css"])))},pe.format.css=ge,pe.autodetect.push({p:5,test:function(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];if(!t.length&&"string"===ve(e)&&ge.test(e))return"css"}});var ye=_,be=w,_e=p,xe=d.unpack;_e.format.gl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=xe(e,"rgba");return n[0]*=255,n[1]*=255,n[2]*=255,n},be.gl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(ye,[null].concat(e,["gl"])))},ye.prototype.gl=function(){var e=this._rgb;return[e[0]/255,e[1]/255,e[2]/255,e[3]]};var we=d.unpack,Se=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n,r=we(e,"rgb"),i=r[0],a=r[1],o=r[2],s=Math.min(i,a,o),u=Math.max(i,a,o),l=u-s,c=100*l/255,h=s/(255-l)*100;return 0===l?n=Number.NaN:(i===u&&(n=(a-o)/l),a===u&&(n=2+(o-i)/l),o===u&&(n=4+(i-a)/l),(n*=60)<0&&(n+=360)),[n,c,h]},Me=Se,ke=d.unpack,Te=Math.floor,Ee=function(){for(var e,t,n,r,i,a,o=[],s=arguments.length;s--;)o[s]=arguments[s];var u,l,c,h=(o=ke(o,"hcg"))[0],f=o[1],d=o[2];d*=255;var p=255*f;if(0===f)u=l=c=d;else{360===h&&(h=0),h>360&&(h-=360),h<0&&(h+=360);var v=Te(h/=60),m=h-v,g=d*(1-f),y=g+p*(1-m),b=g+p*m,_=g+p;switch(v){case 0:u=(e=[_,b,g])[0],l=e[1],c=e[2];break;case 1:u=(t=[y,_,g])[0],l=t[1],c=t[2];break;case 2:u=(n=[g,_,b])[0],l=n[1],c=n[2];break;case 3:u=(r=[g,y,_])[0],l=r[1],c=r[2];break;case 4:u=(i=[b,g,_])[0],l=i[1],c=i[2];break;case 5:u=(a=[_,g,y])[0],l=a[1],c=a[2]}}return[u,l,c,o.length>3?o[3]:1]},Ce=Ee,Ae=d.unpack,Re=d.type,Pe=w,Le=_,De=p,Ne=Me;Le.prototype.hcg=function(){return Ne(this._rgb)},Pe.hcg=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(Le,[null].concat(e,["hcg"])))},De.format.hcg=Ce,De.autodetect.push({p:1,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=Ae(e,"hcg"),"array"===Re(e)&&3===e.length)return"hcg"}});var Ie=d.unpack,Oe=d.last,Ue=Math.round,Fe=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=Ie(e,"rgba"),r=n[0],i=n[1],a=n[2],o=n[3],s=Oe(e)||"auto";void 0===o&&(o=1),"auto"===s&&(s=o<1?"rgba":"rgb");var u="000000"+((r=Ue(r))<<16|(i=Ue(i))<<8|(a=Ue(a))).toString(16);u=u.substr(u.length-6);var l="0"+Ue(255*o).toString(16);switch(l=l.substr(l.length-2),s.toLowerCase()){case"rgba":return"#"+u+l;case"argb":return"#"+l+u;default:return"#"+u}},ze=Fe,Be=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,Ve=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,Ge=function(e){if(e.match(Be)){4!==e.length&&7!==e.length||(e=e.substr(1)),3===e.length&&(e=(e=e.split(""))[0]+e[0]+e[1]+e[1]+e[2]+e[2]);var t=parseInt(e,16);return[t>>16,t>>8&255,255&t,1]}if(e.match(Ve)){5!==e.length&&9!==e.length||(e=e.substr(1)),4===e.length&&(e=(e=e.split(""))[0]+e[0]+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]);var n=parseInt(e,16);return[n>>24&255,n>>16&255,n>>8&255,Math.round((255&n)/255*100)/100]}throw new Error("unknown hex color: "+e)},je=w,He=_,We=d.type,Ze=p,qe=ze;He.prototype.hex=function(e){return qe(this._rgb,e)},je.hex=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(He,[null].concat(e,["hex"])))},Ze.format.hex=Ge,Ze.autodetect.push({p:4,test:function(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];if(!t.length&&"string"===We(e)&&[3,4,5,6,7,8,9].indexOf(e.length)>=0)return"hex"}});var Xe=d.unpack,Ye=d.TWOPI,Ke=Math.min,Je=Math.sqrt,Qe=Math.acos,$e=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n,r=Xe(e,"rgb"),i=r[0],a=r[1],o=r[2],s=Ke(i/=255,a/=255,o/=255),u=(i+a+o)/3,l=u>0?1-s/u:0;return 0===l?n=NaN:(n=(i-a+(i-o))/2,n/=Je((i-a)*(i-a)+(i-o)*(a-o)),n=Qe(n),o>a&&(n=Ye-n),n/=Ye),[360*n,l,u]},et=$e,tt=d.unpack,nt=d.limit,rt=d.TWOPI,it=d.PITHIRD,at=Math.cos,ot=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n,r,i,a=(e=tt(e,"hsi"))[0],o=e[1],s=e[2];return isNaN(a)&&(a=0),isNaN(o)&&(o=0),a>360&&(a-=360),a<0&&(a+=360),(a/=360)<1/3?r=1-((i=(1-o)/3)+(n=(1+o*at(rt*a)/at(it-rt*a))/3)):a<2/3?i=1-((n=(1-o)/3)+(r=(1+o*at(rt*(a-=1/3))/at(it-rt*a))/3)):n=1-((r=(1-o)/3)+(i=(1+o*at(rt*(a-=2/3))/at(it-rt*a))/3)),[255*(n=nt(s*n*3)),255*(r=nt(s*r*3)),255*(i=nt(s*i*3)),e.length>3?e[3]:1]},st=ot,ut=d.unpack,lt=d.type,ct=w,ht=_,ft=p,dt=et;ht.prototype.hsi=function(){return dt(this._rgb)},ct.hsi=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(ht,[null].concat(e,["hsi"])))},ft.format.hsi=st,ft.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=ut(e,"hsi"),"array"===lt(e)&&3===e.length)return"hsi"}});var pt=d.unpack,vt=d.type,mt=w,gt=_,yt=p,bt=j;gt.prototype.hsl=function(){return bt(this._rgb)},mt.hsl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(gt,[null].concat(e,["hsl"])))},yt.format.hsl=ee,yt.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=pt(e,"hsl"),"array"===vt(e)&&3===e.length)return"hsl"}});var _t=d.unpack,xt=Math.min,wt=Math.max,St=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n,r,i,a=(e=_t(e,"rgb"))[0],o=e[1],s=e[2],u=xt(a,o,s),l=wt(a,o,s),c=l-u;return i=l/255,0===l?(n=Number.NaN,r=0):(r=c/l,a===l&&(n=(o-s)/c),o===l&&(n=2+(s-a)/c),s===l&&(n=4+(a-o)/c),(n*=60)<0&&(n+=360)),[n,r,i]},Mt=St,kt=d.unpack,Tt=Math.floor,Et=function(){for(var e,t,n,r,i,a,o=[],s=arguments.length;s--;)o[s]=arguments[s];var u,l,c,h=(o=kt(o,"hsv"))[0],f=o[1],d=o[2];if(d*=255,0===f)u=l=c=d;else{360===h&&(h=0),h>360&&(h-=360),h<0&&(h+=360);var p=Tt(h/=60),v=h-p,m=d*(1-f),g=d*(1-f*v),y=d*(1-f*(1-v));switch(p){case 0:u=(e=[d,y,m])[0],l=e[1],c=e[2];break;case 1:u=(t=[g,d,m])[0],l=t[1],c=t[2];break;case 2:u=(n=[m,d,y])[0],l=n[1],c=n[2];break;case 3:u=(r=[m,g,d])[0],l=r[1],c=r[2];break;case 4:u=(i=[y,m,d])[0],l=i[1],c=i[2];break;case 5:u=(a=[d,m,g])[0],l=a[1],c=a[2]}}return[u,l,c,o.length>3?o[3]:1]},Ct=Et,At=d.unpack,Rt=d.type,Pt=w,Lt=_,Dt=p,Nt=Mt;Lt.prototype.hsv=function(){return Nt(this._rgb)},Pt.hsv=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(Lt,[null].concat(e,["hsv"])))},Dt.format.hsv=Ct,Dt.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=At(e,"hsv"),"array"===Rt(e)&&3===e.length)return"hsv"}});var It={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},Ot=It,Ut=d.unpack,Ft=Math.pow,zt=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=Ut(e,"rgb"),r=n[0],i=n[1],a=n[2],o=Gt(r,i,a),s=o[0],u=o[1],l=116*u-16;return[l<0?0:l,500*(s-u),200*(u-o[2])]},Bt=function(e){return(e/=255)<=.04045?e/12.92:Ft((e+.055)/1.055,2.4)},Vt=function(e){return e>Ot.t3?Ft(e,1/3):e/Ot.t2+Ot.t0},Gt=function(e,t,n){return e=Bt(e),t=Bt(t),n=Bt(n),[Vt((.4124564*e+.3575761*t+.1804375*n)/Ot.Xn),Vt((.2126729*e+.7151522*t+.072175*n)/Ot.Yn),Vt((.0193339*e+.119192*t+.9503041*n)/Ot.Zn)]},jt=zt,Ht=It,Wt=d.unpack,Zt=Math.pow,qt=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n,r,i,a=(e=Wt(e,"lab"))[0],o=e[1],s=e[2];return r=(a+16)/116,n=isNaN(o)?r:r+o/500,i=isNaN(s)?r:r-s/200,r=Ht.Yn*Yt(r),n=Ht.Xn*Yt(n),i=Ht.Zn*Yt(i),[Xt(3.2404542*n-1.5371385*r-.4985314*i),Xt(-.969266*n+1.8760108*r+.041556*i),Xt(.0556434*n-.2040259*r+1.0572252*i),e.length>3?e[3]:1]},Xt=function(e){return 255*(e<=.00304?12.92*e:1.055*Zt(e,1/2.4)-.055)},Yt=function(e){return e>Ht.t1?e*e*e:Ht.t2*(e-Ht.t0)},Kt=qt,Jt=d.unpack,Qt=d.type,$t=w,en=_,tn=p,nn=jt;en.prototype.lab=function(){return nn(this._rgb)},$t.lab=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(en,[null].concat(e,["lab"])))},tn.format.lab=Kt,tn.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=Jt(e,"lab"),"array"===Qt(e)&&3===e.length)return"lab"}});var rn=d.unpack,an=d.RAD2DEG,on=Math.sqrt,sn=Math.atan2,un=Math.round,ln=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=rn(e,"lab"),r=n[0],i=n[1],a=n[2],o=on(i*i+a*a),s=(sn(a,i)*an+360)%360;return 0===un(1e4*o)&&(s=Number.NaN),[r,o,s]},cn=ln,hn=d.unpack,fn=jt,dn=cn,pn=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=hn(e,"rgb"),r=n[0],i=n[1],a=n[2],o=fn(r,i,a),s=o[0],u=o[1],l=o[2];return dn(s,u,l)},vn=pn,mn=d.unpack,gn=d.DEG2RAD,yn=Math.sin,bn=Math.cos,_n=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=mn(e,"lch"),r=n[0],i=n[1],a=n[2];return isNaN(a)&&(a=0),[r,bn(a*=gn)*i,yn(a)*i]},xn=_n,wn=d.unpack,Sn=xn,Mn=Kt,kn=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=(e=wn(e,"lch"))[0],r=e[1],i=e[2],a=Sn(n,r,i),o=a[0],s=a[1],u=a[2],l=Mn(o,s,u);return[l[0],l[1],l[2],e.length>3?e[3]:1]},Tn=kn,En=d.unpack,Cn=Tn,An=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=En(e,"hcl").reverse();return Cn.apply(void 0,n)},Rn=An,Pn=d.unpack,Ln=d.type,Dn=w,Nn=_,In=p,On=vn;Nn.prototype.lch=function(){return On(this._rgb)},Nn.prototype.hcl=function(){return On(this._rgb).reverse()},Dn.lch=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(Nn,[null].concat(e,["lch"])))},Dn.hcl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(Nn,[null].concat(e,["hcl"])))},In.format.lch=Tn,In.format.hcl=Rn,["lch","hcl"].forEach((function(e){return In.autodetect.push({p:2,test:function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];if(t=Pn(t,e),"array"===Ln(t)&&3===t.length)return e}})}));var Un={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},Fn=_,zn=p,Bn=d.type,Vn=Un,Gn=Ge,jn=ze;Fn.prototype.name=function(){for(var e=jn(this._rgb,"rgb"),t=0,n=Object.keys(Vn);t<n.length;t+=1){var r=n[t];if(Vn[r]===e)return r.toLowerCase()}return e},zn.format.named=function(e){if(e=e.toLowerCase(),Vn[e])return Gn(Vn[e]);throw new Error("unknown color name: "+e)},zn.autodetect.push({p:5,test:function(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];if(!t.length&&"string"===Bn(e)&&Vn[e.toLowerCase()])return"named"}});var Hn=d.unpack,Wn=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=Hn(e,"rgb");return(n[0]<<16)+(n[1]<<8)+n[2]},Zn=Wn,qn=d.type,Xn=function(e){if("number"==qn(e)&&e>=0&&e<=16777215)return[e>>16,e>>8&255,255&e,1];throw new Error("unknown num color: "+e)},Yn=Xn,Kn=w,Jn=_,Qn=p,$n=d.type,er=Zn;Jn.prototype.num=function(){return er(this._rgb)},Kn.num=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(Jn,[null].concat(e,["num"])))},Qn.format.num=Yn,Qn.autodetect.push({p:5,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(1===e.length&&"number"===$n(e[0])&&e[0]>=0&&e[0]<=16777215)return"num"}});var tr=w,nr=_,rr=p,ir=d.unpack,ar=d.type,or=Math.round;nr.prototype.rgb=function(e){return void 0===e&&(e=!0),!1===e?this._rgb.slice(0,3):this._rgb.slice(0,3).map(or)},nr.prototype.rgba=function(e){return void 0===e&&(e=!0),this._rgb.slice(0,4).map((function(t,n){return n<3?!1===e?t:or(t):t}))},tr.rgb=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(nr,[null].concat(e,["rgb"])))},rr.format.rgb=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=ir(e,"rgba");return void 0===n[3]&&(n[3]=1),n},rr.autodetect.push({p:3,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=ir(e,"rgba"),"array"===ar(e)&&(3===e.length||4===e.length&&"number"==ar(e[3])&&e[3]>=0&&e[3]<=1))return"rgb"}});var sr=Math.log,ur=function(e){var t,n,r,i=e/100;return i<66?(t=255,n=i<6?0:-155.25485562709179-.44596950469579133*(n=i-2)+104.49216199393888*sr(n),r=i<20?0:.8274096064007395*(r=i-10)-254.76935184120902+115.67994401066147*sr(r)):(t=351.97690566805693+.114206453784165*(t=i-55)-40.25366309332127*sr(t),n=325.4494125711974+.07943456536662342*(n=i-50)-28.0852963507957*sr(n),r=255),[t,n,r,1]},lr=ur,cr=d.unpack,hr=Math.round,fr=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];for(var n,r=cr(e,"rgb"),i=r[0],a=r[2],o=1e3,s=4e4,u=.4;s-o>u;){var l=lr(n=.5*(s+o));l[2]/l[0]>=a/i?s=n:o=n}return hr(n)},dr=w,pr=_,vr=p,mr=fr;pr.prototype.temp=pr.prototype.kelvin=pr.prototype.temperature=function(){return mr(this._rgb)},dr.temp=dr.kelvin=dr.temperature=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(pr,[null].concat(e,["temp"])))},vr.format.temp=vr.format.kelvin=vr.format.temperature=ur;var gr=d.unpack,yr=Math.cbrt,br=Math.pow,_r=Math.sign,xr=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=gr(e,"rgb"),r=n[0],i=n[1],a=n[2],o=[Sr(r/255),Sr(i/255),Sr(a/255)],s=o[0],u=o[1],l=o[2],c=yr(.4122214708*s+.5363325363*u+.0514459929*l),h=yr(.2119034982*s+.6806995451*u+.1073969566*l),f=yr(.0883024619*s+.2817188376*u+.6299787005*l);return[.2104542553*c+.793617785*h-.0040720468*f,1.9779984951*c-2.428592205*h+.4505937099*f,.0259040371*c+.7827717662*h-.808675766*f]},wr=xr;function Sr(e){var t=Math.abs(e);return t<.04045?e/12.92:(_r(e)||1)*br((t+.055)/1.055,2.4)}var Mr=d.unpack,kr=Math.pow,Tr=Math.sign,Er=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=(e=Mr(e,"lab"))[0],r=e[1],i=e[2],a=kr(n+.3963377774*r+.2158037573*i,3),o=kr(n-.1055613458*r-.0638541728*i,3),s=kr(n-.0894841775*r-1.291485548*i,3);return[255*Ar(4.0767416621*a-3.3077115913*o+.2309699292*s),255*Ar(-1.2684380046*a+2.6097574011*o-.3413193965*s),255*Ar(-.0041960863*a-.7034186147*o+1.707614701*s),e.length>3?e[3]:1]},Cr=Er;function Ar(e){var t=Math.abs(e);return t>.0031308?(Tr(e)||1)*(1.055*kr(t,1/2.4)-.055):12.92*e}var Rr=d.unpack,Pr=d.type,Lr=w,Dr=_,Nr=p,Ir=wr;Dr.prototype.oklab=function(){return Ir(this._rgb)},Lr.oklab=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(Dr,[null].concat(e,["oklab"])))},Nr.format.oklab=Cr,Nr.autodetect.push({p:3,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=Rr(e,"oklab"),"array"===Pr(e)&&3===e.length)return"oklab"}});var Or=d.unpack,Ur=wr,Fr=cn,zr=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=Or(e,"rgb"),r=n[0],i=n[1],a=n[2],o=Ur(r,i,a),s=o[0],u=o[1],l=o[2];return Fr(s,u,l)},Br=zr,Vr=d.unpack,Gr=xn,jr=Cr,Hr=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=(e=Vr(e,"lch"))[0],r=e[1],i=e[2],a=Gr(n,r,i),o=a[0],s=a[1],u=a[2],l=jr(o,s,u);return[l[0],l[1],l[2],e.length>3?e[3]:1]},Wr=Hr,Zr=d.unpack,qr=d.type,Xr=w,Yr=_,Kr=p,Jr=Br;Yr.prototype.oklch=function(){return Jr(this._rgb)},Xr.oklch=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(Yr,[null].concat(e,["oklch"])))},Kr.format.oklch=Wr,Kr.autodetect.push({p:3,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=Zr(e,"oklch"),"array"===qr(e)&&3===e.length)return"oklch"}});var Qr=_,$r=d.type;Qr.prototype.alpha=function(e,t){return void 0===t&&(t=!1),void 0!==e&&"number"===$r(e)?t?(this._rgb[3]=e,this):new Qr([this._rgb[0],this._rgb[1],this._rgb[2],e],"rgb"):this._rgb[3]},_.prototype.clipped=function(){return this._rgb._clipped||!1};var ei=_,ti=It;ei.prototype.darken=function(e){void 0===e&&(e=1);var t=this,n=t.lab();return n[0]-=ti.Kn*e,new ei(n,"lab").alpha(t.alpha(),!0)},ei.prototype.brighten=function(e){return void 0===e&&(e=1),this.darken(-e)},ei.prototype.darker=ei.prototype.darken,ei.prototype.brighter=ei.prototype.brighten,_.prototype.get=function(e){var t=e.split("."),n=t[0],r=t[1],i=this[n]();if(r){var a=n.indexOf(r)-("ok"===n.substr(0,2)?2:0);if(a>-1)return i[a];throw new Error("unknown channel "+r+" in mode "+n)}return i};var ni=_,ri=d.type,ii=Math.pow,ai=1e-7,oi=20;ni.prototype.luminance=function(e){if(void 0!==e&&"number"===ri(e)){if(0===e)return new ni([0,0,0,this._rgb[3]],"rgb");if(1===e)return new ni([255,255,255,this._rgb[3]],"rgb");var t=this.luminance(),n="rgb",r=oi,i=function t(i,a){var o=i.interpolate(a,.5,n),s=o.luminance();return Math.abs(e-s)<ai||!r--?o:s>e?t(i,o):t(o,a)},a=(t>e?i(new ni([0,0,0]),this):i(this,new ni([255,255,255]))).rgb();return new ni(a.concat([this._rgb[3]]))}return si.apply(void 0,this._rgb.slice(0,3))};var si=function(e,t,n){return.2126*(e=ui(e))+.7152*(t=ui(t))+.0722*(n=ui(n))},ui=function(e){return(e/=255)<=.03928?e/12.92:ii((e+.055)/1.055,2.4)},li={},ci=_,hi=d.type,fi=li,di=function(e,t,n){void 0===n&&(n=.5);for(var r=[],i=arguments.length-3;i-- >0;)r[i]=arguments[i+3];var a=r[0]||"lrgb";if(fi[a]||r.length||(a=Object.keys(fi)[0]),!fi[a])throw new Error("interpolation mode "+a+" is not defined");return"object"!==hi(e)&&(e=new ci(e)),"object"!==hi(t)&&(t=new ci(t)),fi[a](e,t,n).alpha(e.alpha()+n*(t.alpha()-e.alpha()))},pi=_,vi=di;pi.prototype.mix=pi.prototype.interpolate=function(e,t){void 0===t&&(t=.5);for(var n=[],r=arguments.length-2;r-- >0;)n[r]=arguments[r+2];return vi.apply(void 0,[this,e,t].concat(n))};var mi=_;mi.prototype.premultiply=function(e){void 0===e&&(e=!1);var t=this._rgb,n=t[3];return e?(this._rgb=[t[0]*n,t[1]*n,t[2]*n,n],this):new mi([t[0]*n,t[1]*n,t[2]*n,n],"rgb")};var gi=_,yi=It;gi.prototype.saturate=function(e){void 0===e&&(e=1);var t=this,n=t.lch();return n[1]+=yi.Kn*e,n[1]<0&&(n[1]=0),new gi(n,"lch").alpha(t.alpha(),!0)},gi.prototype.desaturate=function(e){return void 0===e&&(e=1),this.saturate(-e)};var bi=_,_i=d.type;bi.prototype.set=function(e,t,n){void 0===n&&(n=!1);var r=e.split("."),i=r[0],a=r[1],o=this[i]();if(a){var s=i.indexOf(a)-("ok"===i.substr(0,2)?2:0);if(s>-1){if("string"==_i(t))switch(t.charAt(0)){case"+":case"-":o[s]+=+t;break;case"*":o[s]*=+t.substr(1);break;case"/":o[s]/=+t.substr(1);break;default:o[s]=+t}else{if("number"!==_i(t))throw new Error("unsupported value for Color.set");o[s]=t}var u=new bi(o,i);return n?(this._rgb=u._rgb,this):u}throw new Error("unknown channel "+a+" in mode "+i)}return o};var xi=_,wi=function(e,t,n){var r=e._rgb,i=t._rgb;return new xi(r[0]+n*(i[0]-r[0]),r[1]+n*(i[1]-r[1]),r[2]+n*(i[2]-r[2]),"rgb")};li.rgb=wi;var Si=_,Mi=Math.sqrt,ki=Math.pow,Ti=function(e,t,n){var r=e._rgb,i=r[0],a=r[1],o=r[2],s=t._rgb,u=s[0],l=s[1],c=s[2];return new Si(Mi(ki(i,2)*(1-n)+ki(u,2)*n),Mi(ki(a,2)*(1-n)+ki(l,2)*n),Mi(ki(o,2)*(1-n)+ki(c,2)*n),"rgb")};li.lrgb=Ti;var Ei=_,Ci=function(e,t,n){var r=e.lab(),i=t.lab();return new Ei(r[0]+n*(i[0]-r[0]),r[1]+n*(i[1]-r[1]),r[2]+n*(i[2]-r[2]),"lab")};li.lab=Ci;var Ai=_,Ri=function(e,t,n,r){var i,a,o,s,u,l,c,h,f,d,p,v,m;return"hsl"===r?(o=e.hsl(),s=t.hsl()):"hsv"===r?(o=e.hsv(),s=t.hsv()):"hcg"===r?(o=e.hcg(),s=t.hcg()):"hsi"===r?(o=e.hsi(),s=t.hsi()):"lch"===r||"hcl"===r?(r="hcl",o=e.hcl(),s=t.hcl()):"oklch"===r&&(o=e.oklch().reverse(),s=t.oklch().reverse()),"h"!==r.substr(0,1)&&"oklch"!==r||(u=(i=o)[0],c=i[1],f=i[2],l=(a=s)[0],h=a[1],d=a[2]),isNaN(u)||isNaN(l)?isNaN(u)?isNaN(l)?v=Number.NaN:(v=l,1!=f&&0!=f||"hsv"==r||(p=h)):(v=u,1!=d&&0!=d||"hsv"==r||(p=c)):v=u+n*(l>u&&l-u>180?l-(u+360):l<u&&u-l>180?l+360-u:l-u),void 0===p&&(p=c+n*(h-c)),m=f+n*(d-f),new Ai("oklch"===r?[m,p,v]:[v,p,m],r)},Pi=Ri,Li=function(e,t,n){return Pi(e,t,n,"lch")};li.lch=Li,li.hcl=Li;var Di=_,Ni=function(e,t,n){var r=e.num(),i=t.num();return new Di(r+n*(i-r),"num")};li.num=Ni;var Ii=Ri,Oi=function(e,t,n){return Ii(e,t,n,"hcg")};li.hcg=Oi;var Ui=Ri,Fi=function(e,t,n){return Ui(e,t,n,"hsi")};li.hsi=Fi;var zi=Ri,Bi=function(e,t,n){return zi(e,t,n,"hsl")};li.hsl=Bi;var Vi=Ri,Gi=function(e,t,n){return Vi(e,t,n,"hsv")};li.hsv=Gi;var ji=_,Hi=function(e,t,n){var r=e.oklab(),i=t.oklab();return new ji(r[0]+n*(i[0]-r[0]),r[1]+n*(i[1]-r[1]),r[2]+n*(i[2]-r[2]),"oklab")};li.oklab=Hi;var Wi=Ri,Zi=function(e,t,n){return Wi(e,t,n,"oklch")};li.oklch=Zi;var qi=_,Xi=d.clip_rgb,Yi=Math.pow,Ki=Math.sqrt,Ji=Math.PI,Qi=Math.cos,$i=Math.sin,ea=Math.atan2,ta=function(e,t,n){void 0===t&&(t="lrgb"),void 0===n&&(n=null);var r=e.length;n||(n=Array.from(new Array(r)).map((function(){return 1})));var i=r/n.reduce((function(e,t){return e+t}));if(n.forEach((function(e,t){n[t]*=i})),e=e.map((function(e){return new qi(e)})),"lrgb"===t)return na(e,n);for(var a=e.shift(),o=a.get(t),s=[],u=0,l=0,c=0;c<o.length;c++)if(o[c]=(o[c]||0)*n[0],s.push(isNaN(o[c])?0:n[0]),"h"===t.charAt(c)&&!isNaN(o[c])){var h=o[c]/180*Ji;u+=Qi(h)*n[0],l+=$i(h)*n[0]}var f=a.alpha()*n[0];e.forEach((function(e,r){var i=e.get(t);f+=e.alpha()*n[r+1];for(var a=0;a<o.length;a++)if(!isNaN(i[a]))if(s[a]+=n[r+1],"h"===t.charAt(a)){var c=i[a]/180*Ji;u+=Qi(c)*n[r+1],l+=$i(c)*n[r+1]}else o[a]+=i[a]*n[r+1]}));for(var d=0;d<o.length;d++)if("h"===t.charAt(d)){for(var p=ea(l/s[d],u/s[d])/Ji*180;p<0;)p+=360;for(;p>=360;)p-=360;o[d]=p}else o[d]=o[d]/s[d];return f/=r,new qi(o,t).alpha(f>.99999?1:f,!0)},na=function(e,t){for(var n=e.length,r=[0,0,0,0],i=0;i<e.length;i++){var a=e[i],o=t[i]/n,s=a._rgb;r[0]+=Yi(s[0],2)*o,r[1]+=Yi(s[1],2)*o,r[2]+=Yi(s[2],2)*o,r[3]+=s[3]*o}return r[0]=Ki(r[0]),r[1]=Ki(r[1]),r[2]=Ki(r[2]),r[3]>.9999999&&(r[3]=1),new qi(Xi(r))},ra=w,ia=d.type,aa=Math.pow,oa=function(e){var t="rgb",n=ra("#ccc"),r=0,i=[0,1],a=[],o=[0,0],s=!1,u=[],l=!1,c=0,h=1,f=!1,d={},p=!0,v=1,m=function(e){if((e=e||["#fff","#000"])&&"string"===ia(e)&&ra.brewer&&ra.brewer[e.toLowerCase()]&&(e=ra.brewer[e.toLowerCase()]),"array"===ia(e)){1===e.length&&(e=[e[0],e[0]]),e=e.slice(0);for(var t=0;t<e.length;t++)e[t]=ra(e[t]);a.length=0;for(var n=0;n<e.length;n++)a.push(n/(e.length-1))}return x(),u=e},g=function(e){if(null!=s){for(var t=s.length-1,n=0;n<t&&e>=s[n];)n++;return n-1}return 0},y=function(e){return e},b=function(e){return e},_=function(e,r){var i,l;if(null==r&&(r=!1),isNaN(e)||null===e)return n;l=r?e:s&&s.length>2?g(e)/(s.length-2):h!==c?(e-c)/(h-c):1,l=b(l),r||(l=y(l)),1!==v&&(l=aa(l,v)),l=o[0]+l*(1-o[0]-o[1]),l=Math.min(1,Math.max(0,l));var f=Math.floor(1e4*l);if(p&&d[f])i=d[f];else{if("array"===ia(u))for(var m=0;m<a.length;m++){var _=a[m];if(l<=_){i=u[m];break}if(l>=_&&m===a.length-1){i=u[m];break}if(l>_&&l<a[m+1]){l=(l-_)/(a[m+1]-_),i=ra.interpolate(u[m],u[m+1],l,t);break}}else"function"===ia(u)&&(i=u(l));p&&(d[f]=i)}return i},x=function(){return d={}};m(e);var w=function(e){var t=ra(_(e));return l&&t[l]?t[l]():t};return w.classes=function(e){if(null!=e){if("array"===ia(e))s=e,i=[e[0],e[e.length-1]];else{var t=ra.analyze(i);s=0===e?[t.min,t.max]:ra.limits(t,"e",e)}return w}return s},w.domain=function(e){if(!arguments.length)return i;c=e[0],h=e[e.length-1],a=[];var t=u.length;if(e.length===t&&c!==h)for(var n=0,r=Array.from(e);n<r.length;n+=1){var o=r[n];a.push((o-c)/(h-c))}else{for(var s=0;s<t;s++)a.push(s/(t-1));if(e.length>2){var l=e.map((function(t,n){return n/(e.length-1)})),f=e.map((function(e){return(e-c)/(h-c)}));f.every((function(e,t){return l[t]===e}))||(b=function(e){if(e<=0||e>=1)return e;for(var t=0;e>=f[t+1];)t++;var n=(e-f[t])/(f[t+1]-f[t]);return l[t]+n*(l[t+1]-l[t])})}}return i=[c,h],w},w.mode=function(e){return arguments.length?(t=e,x(),w):t},w.range=function(e,t){return m(e),w},w.out=function(e){return l=e,w},w.spread=function(e){return arguments.length?(r=e,w):r},w.correctLightness=function(e){return null==e&&(e=!0),f=e,x(),y=f?function(e){for(var t=_(0,!0).lab()[0],n=_(1,!0).lab()[0],r=t>n,i=_(e,!0).lab()[0],a=t+(n-t)*e,o=i-a,s=0,u=1,l=20;Math.abs(o)>.01&&l-- >0;)r&&(o*=-1),o<0?(s=e,e+=.5*(u-e)):(u=e,e+=.5*(s-e)),i=_(e,!0).lab()[0],o=i-a;return e}:function(e){return e},w},w.padding=function(e){return null!=e?("number"===ia(e)&&(e=[e,e]),o=e,w):o},w.colors=function(t,n){arguments.length<2&&(n="hex");var r=[];if(0===arguments.length)r=u.slice(0);else if(1===t)r=[w(.5)];else if(t>1){var a=i[0],o=i[1]-a;r=sa(0,t,!1).map((function(e){return w(a+e/(t-1)*o)}))}else{e=[];var l=[];if(s&&s.length>2)for(var c=1,h=s.length,f=1<=h;f?c<h:c>h;f?c++:c--)l.push(.5*(s[c-1]+s[c]));else l=i;r=l.map((function(e){return w(e)}))}return ra[n]&&(r=r.map((function(e){return e[n]()}))),r},w.cache=function(e){return null!=e?(p=e,w):p},w.gamma=function(e){return null!=e?(v=e,w):v},w.nodata=function(e){return null!=e?(n=ra(e),w):n},w};function sa(e,t,n){for(var r=[],i=e<t,a=n?i?t+1:t-1:t,o=e;i?o<a:o>a;i?o++:o--)r.push(o);return r}var ua=_,la=oa,ca=function(e){for(var t=[1,1],n=1;n<e;n++){for(var r=[1],i=1;i<=t.length;i++)r[i]=(t[i]||0)+t[i-1];t=r}return t},ha=function(e){var t,n,r,i,a,o,s;if(2===(e=e.map((function(e){return new ua(e)}))).length)t=e.map((function(e){return e.lab()})),a=t[0],o=t[1],i=function(e){var t=[0,1,2].map((function(t){return a[t]+e*(o[t]-a[t])}));return new ua(t,"lab")};else if(3===e.length)n=e.map((function(e){return e.lab()})),a=n[0],o=n[1],s=n[2],i=function(e){var t=[0,1,2].map((function(t){return(1-e)*(1-e)*a[t]+2*(1-e)*e*o[t]+e*e*s[t]}));return new ua(t,"lab")};else if(4===e.length){var u;r=e.map((function(e){return e.lab()})),a=r[0],o=r[1],s=r[2],u=r[3],i=function(e){var t=[0,1,2].map((function(t){return(1-e)*(1-e)*(1-e)*a[t]+3*(1-e)*(1-e)*e*o[t]+3*(1-e)*e*e*s[t]+e*e*e*u[t]}));return new ua(t,"lab")}}else{if(!(e.length>=5))throw new RangeError("No point in running bezier with only one color.");var l,c,h;l=e.map((function(e){return e.lab()})),h=e.length-1,c=ca(h),i=function(e){var t=1-e,n=[0,1,2].map((function(n){return l.reduce((function(r,i,a){return r+c[a]*Math.pow(t,h-a)*Math.pow(e,a)*i[n]}),0)}));return new ua(n,"lab")}}return i},fa=function(e){var t=ha(e);return t.scale=function(){return la(t)},t},da=w,pa=function e(t,n,r){if(!e[r])throw new Error("unknown blend mode "+r);return e[r](t,n)},va=function(e){return function(t,n){var r=da(n).rgb(),i=da(t).rgb();return da.rgb(e(r,i))}},ma=function(e){return function(t,n){var r=[];return r[0]=e(t[0],n[0]),r[1]=e(t[1],n[1]),r[2]=e(t[2],n[2]),r}},ga=function(e){return e},ya=function(e,t){return e*t/255},ba=function(e,t){return e>t?t:e},_a=function(e,t){return e>t?e:t},xa=function(e,t){return 255*(1-(1-e/255)*(1-t/255))},wa=function(e,t){return t<128?2*e*t/255:255*(1-2*(1-e/255)*(1-t/255))},Sa=function(e,t){return 255*(1-(1-t/255)/(e/255))},Ma=function(e,t){return 255===e||(e=t/255*255/(1-e/255))>255?255:e};pa.normal=va(ma(ga)),pa.multiply=va(ma(ya)),pa.screen=va(ma(xa)),pa.overlay=va(ma(wa)),pa.darken=va(ma(ba)),pa.lighten=va(ma(_a)),pa.dodge=va(ma(Ma)),pa.burn=va(ma(Sa));for(var ka=pa,Ta=d.type,Ea=d.clip_rgb,Ca=d.TWOPI,Aa=Math.pow,Ra=Math.sin,Pa=Math.cos,La=w,Da=function(e,t,n,r,i){void 0===e&&(e=300),void 0===t&&(t=-1.5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=[0,1]);var a,o=0;"array"===Ta(i)?a=i[1]-i[0]:(a=0,i=[i,i]);var s=function(s){var u=Ca*((e+120)/360+t*s),l=Aa(i[0]+a*s,r),c=(0!==o?n[0]+s*o:n)*l*(1-l)/2,h=Pa(u),f=Ra(u);return La(Ea([255*(l+c*(-.14861*h+1.78277*f)),255*(l+c*(-.29227*h-.90649*f)),255*(l+c*(1.97294*h)),1]))};return s.start=function(t){return null==t?e:(e=t,s)},s.rotations=function(e){return null==e?t:(t=e,s)},s.gamma=function(e){return null==e?r:(r=e,s)},s.hue=function(e){return null==e?n:("array"===Ta(n=e)?0===(o=n[1]-n[0])&&(n=n[1]):o=0,s)},s.lightness=function(e){return null==e?i:("array"===Ta(e)?(i=e,a=e[1]-e[0]):(i=[e,e],a=0),s)},s.scale=function(){return La.scale(s)},s.hue(n),s},Na=_,Ia="0123456789abcdef",Oa=Math.floor,Ua=Math.random,Fa=function(){for(var e="#",t=0;t<6;t++)e+=Ia.charAt(Oa(16*Ua()));return new Na(e,"hex")},za=s,Ba=Math.log,Va=Math.pow,Ga=Math.floor,ja=Math.abs,Ha=function(e,t){void 0===t&&(t=null);var n={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0};return"object"===za(e)&&(e=Object.values(e)),e.forEach((function(e){t&&"object"===za(e)&&(e=e[t]),void 0===e||null===e||isNaN(e)||(n.values.push(e),n.sum+=e,e<n.min&&(n.min=e),e>n.max&&(n.max=e),n.count+=1)})),n.domain=[n.min,n.max],n.limits=function(e,t){return Wa(n,e,t)},n},Wa=function(e,t,n){void 0===t&&(t="equal"),void 0===n&&(n=7),"array"==za(e)&&(e=Ha(e));var r=e.min,i=e.max,a=e.values.sort((function(e,t){return e-t}));if(1===n)return[r,i];var o=[];if("c"===t.substr(0,1)&&(o.push(r),o.push(i)),"e"===t.substr(0,1)){o.push(r);for(var s=1;s<n;s++)o.push(r+s/n*(i-r));o.push(i)}else if("l"===t.substr(0,1)){if(r<=0)throw new Error("Logarithmic scales are only possible for values > 0");var u=Math.LOG10E*Ba(r),l=Math.LOG10E*Ba(i);o.push(r);for(var c=1;c<n;c++)o.push(Va(10,u+c/n*(l-u)));o.push(i)}else if("q"===t.substr(0,1)){o.push(r);for(var h=1;h<n;h++){var f=(a.length-1)*h/n,d=Ga(f);if(d===f)o.push(a[d]);else{var p=f-d;o.push(a[d]*(1-p)+a[d+1]*p)}}o.push(i)}else if("k"===t.substr(0,1)){var v,m=a.length,g=new Array(m),y=new Array(n),b=!0,_=0,x=null;(x=[]).push(r);for(var w=1;w<n;w++)x.push(r+w/n*(i-r));for(x.push(i);b;){for(var S=0;S<n;S++)y[S]=0;for(var M=0;M<m;M++)for(var k=a[M],T=Number.MAX_VALUE,E=void 0,C=0;C<n;C++){var A=ja(x[C]-k);A<T&&(T=A,E=C),y[E]++,g[M]=E}for(var R=new Array(n),P=0;P<n;P++)R[P]=null;for(var L=0;L<m;L++)null===R[v=g[L]]?R[v]=a[L]:R[v]+=a[L];for(var D=0;D<n;D++)R[D]*=1/y[D];b=!1;for(var N=0;N<n;N++)if(R[N]!==x[N]){b=!0;break}x=R,++_>200&&(b=!1)}for(var I={},O=0;O<n;O++)I[O]=[];for(var U=0;U<m;U++)I[v=g[U]].push(a[U]);for(var F=[],z=0;z<n;z++)F.push(I[z][0]),F.push(I[z][I[z].length-1]);F=F.sort((function(e,t){return e-t})),o.push(F[0]);for(var B=1;B<F.length;B+=2){var V=F[B];isNaN(V)||-1!==o.indexOf(V)||o.push(V)}}return o},Za={analyze:Ha,limits:Wa},qa=_,Xa=function(e,t){e=new qa(e),t=new qa(t);var n=e.luminance(),r=t.luminance();return n>r?(n+.05)/(r+.05):(r+.05)/(n+.05)},Ya=_,Ka=Math.sqrt,Ja=Math.pow,Qa=Math.min,$a=Math.max,eo=Math.atan2,to=Math.abs,no=Math.cos,ro=Math.sin,io=Math.exp,ao=Math.PI,oo=function(e,t,n,r,i){void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=1);var a=function(e){return 360*e/(2*ao)},o=function(e){return 2*ao*e/360};e=new Ya(e),t=new Ya(t);var s=Array.from(e.lab()),u=s[0],l=s[1],c=s[2],h=Array.from(t.lab()),f=h[0],d=h[1],p=h[2],v=(u+f)/2,m=(Ka(Ja(l,2)+Ja(c,2))+Ka(Ja(d,2)+Ja(p,2)))/2,g=.5*(1-Ka(Ja(m,7)/(Ja(m,7)+Ja(25,7)))),y=l*(1+g),b=d*(1+g),_=Ka(Ja(y,2)+Ja(c,2)),x=Ka(Ja(b,2)+Ja(p,2)),w=(_+x)/2,S=a(eo(c,y)),M=a(eo(p,b)),k=S>=0?S:S+360,T=M>=0?M:M+360,E=to(k-T)>180?(k+T+360)/2:(k+T)/2,C=1-.17*no(o(E-30))+.24*no(o(2*E))+.32*no(o(3*E+6))-.2*no(o(4*E-63)),A=T-k;A=to(A)<=180?A:T<=k?A+360:A-360,A=2*Ka(_*x)*ro(o(A)/2);var R=f-u,P=x-_,L=1+.015*Ja(v-50,2)/Ka(20+Ja(v-50,2)),D=1+.045*w,N=1+.015*w*C,I=30*io(-Ja((E-275)/25,2)),O=-2*Ka(Ja(w,7)/(Ja(w,7)+Ja(25,7)))*ro(2*o(I)),U=Ka(Ja(R/(n*L),2)+Ja(P/(r*D),2)+Ja(A/(i*N),2)+O*(P/(r*D))*(A/(i*N)));return $a(0,Qa(100,U))},so=_,uo=function(e,t,n){void 0===n&&(n="lab"),e=new so(e),t=new so(t);var r=e.get(n),i=t.get(n),a=0;for(var o in r){var s=(r[o]||0)-(i[o]||0);a+=s*s}return Math.sqrt(a)},lo=_,co=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];try{return new(Function.prototype.bind.apply(lo,[null].concat(e))),!0}catch(n){return!1}},ho=w,fo=oa,po={cool:function(){return fo([ho.hsl(180,1,.9),ho.hsl(250,.7,.4)])},hot:function(){return fo(["#000","#f00","#ff0","#fff"]).mode("rgb")}},vo={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},mo=0,go=Object.keys(vo);mo<go.length;mo+=1){var yo=go[mo];vo[yo.toLowerCase()]=vo[yo]}var bo=vo,_o=w;return _o.average=ta,_o.bezier=fa,_o.blend=ka,_o.cubehelix=Da,_o.mix=_o.interpolate=di,_o.random=Fa,_o.scale=oa,_o.analyze=Za.analyze,_o.contrast=Xa,_o.deltaE=oo,_o.distance=uo,_o.limits=Za.limits,_o.valid=co,_o.scales=po,_o.colors=Un,_o.brewer=bo,_o}()},7326:function(e,t,n){"use strict";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,{Z:function(){return r}})},5671:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,{Z:function(){return r}})},3144:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(9142);function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(0,r.Z)(i.key),i)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}},9388:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(1120),i=n(8814),a=n(2963);function o(e){var t=(0,i.Z)();return function(){var n,i=(0,r.Z)(e);if(t){var o=(0,r.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,a.Z)(this,n)}}},1120:function(e,t,n){"use strict";function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}n.d(t,{Z:function(){return r}})},136:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(9611);function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(0,r.Z)(e,t)}},8814:function(e,t,n){"use strict";function r(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}n.d(t,{Z:function(){return r}})},2963:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(1002),i=n(7326);function a(e,t){if(t&&("object"===(0,r.Z)(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,i.Z)(e)}},9611:function(e,t,n){"use strict";function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}n.d(t,{Z:function(){return r}})},9142:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(1002);function i(e){var t=function(e,t){if("object"!==(0,r.Z)(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==(0,r.Z)(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===(0,r.Z)(t)?t:String(t)}},1002:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n.d(t,{Z:function(){return r}})}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.m=e,n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var a=Object.create(null);n.r(a);var o={};e=e||[null,t({}),t([]),t(t)];for(var s=2&i&&r;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((function(e){o[e]=function(){return r[e]}}));return o.default=function(){return r},n.d(a,o),a}}(),n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,r){return n.f[r](e,t),t}),[]))},n.u=function(e){return"static/js/"+e+".9064070b.chunk.js"},n.miniCssF=function(e){},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={},t="MotionComparator:";n.l=function(r,i,a,o){if(e[r])e[r].push(i);else{var s,u;if(void 0!==a)for(var l=document.getElementsByTagName("script"),c=0;c<l.length;c++){var h=l[c];if(h.getAttribute("src")==r||h.getAttribute("data-webpack")==t+a){s=h;break}}s||(u=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+a),s.src=r),e[r]=[i];var f=function(t,n){s.onerror=s.onload=null,clearTimeout(d);var i=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((function(e){return e(n)})),t)return t(n)},d=setTimeout(f.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=f.bind(null,s.onerror),s.onload=f.bind(null,s.onload),u&&document.head.appendChild(s)}}}(),n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},n.p="/MotionComparator/",function(){var e={179:0};n.f.j=function(t,r){var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var a=new Promise((function(n,r){i=e[t]=[n,r]}));r.push(i[2]=a);var o=n.p+n.u(t),s=new Error;n.l(o,(function(r){if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var a=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+a+": "+o+")",s.name="ChunkLoadError",s.type=a,s.request=o,i[1](s)}}),"chunk-"+t,t)}};var t=function(t,r){var i,a,o=r[0],s=r[1],u=r[2],l=0;if(o.some((function(t){return 0!==e[t]}))){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(u)u(n)}for(t&&t(r);l<o.length;l++)a=o[l],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0},r=self.webpackChunkMotionComparator=self.webpackChunkMotionComparator||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}(),n.nc=void 0,function(){"use strict";var e={};n.r(e),n.d(e,{ACESFilmicToneMapping:function(){return Mi},AddEquation:function(){return qr},AddOperation:function(){return bi},AdditiveAnimationBlendMode:function(){return vo},AdditiveBlending:function(){return jr},AlphaFormat:function(){return ia},AlwaysDepth:function(){return ci},AlwaysStencilFunc:function(){return Wo},AmbientLight:function(){return Pm},AmbientLightProbe:function(){return Xm},AnimationClip:function(){return nm},AnimationLoader:function(){return cm},AnimationMixer:function(){return Cg},AnimationObjectGroup:function(){return Tg},AnimationUtils:function(){return jv},ArcCurve:function(){return wp},ArrayCamera:function(){return Wf},ArrowHelper:function(){return gy},Audio:function(){return og},AudioAnalyser:function(){return fg},AudioContext:function(){return Wm},AudioListener:function(){return ag},AudioLoader:function(){return Zm},AxesHelper:function(){return yy},AxisHelper:function(){return qy},BackSide:function(){return Ur},BasicDepthPacking:function(){return To},BasicShadowMap:function(){return Lr},BinaryTextureLoader:function(){return Qy},Bone:function(){return Ld},BooleanKeyframeTrack:function(){return Yv},BoundingBoxHelper:function(){return Xy},Box2:function(){return Fg},Box3:function(){return Us},Box3Helper:function(){return py},BoxBufferGeometry:function(){return Hl},BoxGeometry:function(){return Hl},BoxHelper:function(){return dy},BufferAttribute:function(){return ol},BufferGeometry:function(){return Ml},BufferGeometryLoader:function(){return zm},ByteType:function(){return qi},Cache:function(){return im},Camera:function(){return Yl},CameraHelper:function(){return uy},CanvasRenderer:function(){return eb},CanvasTexture:function(){return lp},CatmullRomCurve3:function(){return Cp},CineonToneMapping:function(){return Si},CircleBufferGeometry:function(){return cp},CircleGeometry:function(){return cp},ClampToEdgeWrapping:function(){return Ni},Clock:function(){return $m},Color:function(){return nl},ColorKeyframeTrack:function(){return Kv},CompressedTexture:function(){return up},CompressedTextureLoader:function(){return hm},ConeBufferGeometry:function(){return fp},ConeGeometry:function(){return fp},CubeCamera:function(){return Ql},CubeReflectionMapping:function(){return Ei},CubeRefractionMapping:function(){return Ci},CubeTexture:function(){return $l},CubeTextureLoader:function(){return dm},CubeUVReflectionMapping:function(){return Pi},CubeUVRefractionMapping:function(){return Li},CubicBezierCurve:function(){return Lp},CubicBezierCurve3:function(){return Dp},CubicInterpolant:function(){return Wv},CullFaceBack:function(){return Ar},CullFaceFront:function(){return Rr},CullFaceFrontBack:function(){return Pr},CullFaceNone:function(){return Cr},Curve:function(){return _p},CurvePath:function(){return Bp},CustomBlending:function(){return Zr},CustomToneMapping:function(){return ki},CylinderBufferGeometry:function(){return hp},CylinderGeometry:function(){return hp},Cylindrical:function(){return Og},DataTexture:function(){return Dd},DataTexture2DArray:function(){return Yc},DataTexture3D:function(){return th},DataTextureLoader:function(){return pm},DataUtils:function(){return wy},DecrementStencilOp:function(){return No},DecrementWrapStencilOp:function(){return Oo},DefaultLoadingManager:function(){return om},DepthFormat:function(){return ca},DepthStencilFormat:function(){return ha},DepthTexture:function(){return Yf},DirectionalLight:function(){return Rm},DirectionalLightHelper:function(){return ay},DiscreteInterpolant:function(){return qv},DodecahedronBufferGeometry:function(){return pp},DodecahedronGeometry:function(){return pp},DoubleSide:function(){return Fr},DstAlphaFactor:function(){return ii},DstColorFactor:function(){return oi},DynamicBufferAttribute:function(){return Uy},DynamicCopyUsage:function(){return $o},DynamicDrawUsage:function(){return qo},DynamicReadUsage:function(){return Ko},EdgesGeometry:function(){return bp},EdgesHelper:function(){return Yy},EllipseCurve:function(){return xp},EqualDepth:function(){return di},EqualStencilFunc:function(){return Bo},EquirectangularReflectionMapping:function(){return Ai},EquirectangularRefractionMapping:function(){return Ri},Euler:function(){return xu},EventDispatcher:function(){return rs},ExtrudeBufferGeometry:function(){return yv},ExtrudeGeometry:function(){return yv},FaceColors:function(){return Ty},FileLoader:function(){return lm},FlatShading:function(){return zr},Float16BufferAttribute:function(){return pl},Float32Attribute:function(){return Wy},Float32BufferAttribute:function(){return vl},Float64Attribute:function(){return Zy},Float64BufferAttribute:function(){return ml},FloatType:function(){return Qi},Fog:function(){return nd},FogExp2:function(){return td},Font:function(){return sb},FontLoader:function(){return ob},FrontSide:function(){return Or},Frustum:function(){return sc},GLBufferAttribute:function(){return Pg},GLSL1:function(){return ts},GLSL3:function(){return ns},GammaEncoding:function(){return xo},GreaterDepth:function(){return vi},GreaterEqualDepth:function(){return pi},GreaterEqualStencilFunc:function(){return Ho},GreaterStencilFunc:function(){return Go},GridHelper:function(){return ey},Group:function(){return Zf},HalfFloatType:function(){return $i},HemisphereLight:function(){return gm},HemisphereLightHelper:function(){return $g},HemisphereLightProbe:function(){return qm},IcosahedronBufferGeometry:function(){return _v},IcosahedronGeometry:function(){return _v},ImageBitmapLoader:function(){return Hm},ImageLoader:function(){return fm},ImageUtils:function(){return ks},ImmediateRenderObject:function(){return ub},IncrementStencilOp:function(){return Do},IncrementWrapStencilOp:function(){return Io},InstancedBufferAttribute:function(){return Ud},InstancedBufferGeometry:function(){return Um},InstancedInterleavedBuffer:function(){return Rg},InstancedMesh:function(){return Gd},Int16Attribute:function(){return Vy},Int16BufferAttribute:function(){return cl},Int32Attribute:function(){return jy},Int32BufferAttribute:function(){return fl},Int8Attribute:function(){return Fy},Int8BufferAttribute:function(){return sl},IntType:function(){return Ki},InterleavedBuffer:function(){return id},InterleavedBufferAttribute:function(){return od},Interpolant:function(){return Hv},InterpolateDiscrete:function(){return so},InterpolateLinear:function(){return uo},InterpolateSmooth:function(){return lo},InvertStencilOp:function(){return Uo},JSONLoader:function(){return tb},KeepStencilOp:function(){return Po},KeyframeTrack:function(){return Xv},LOD:function(){return kd},LatheBufferGeometry:function(){return xv},LatheGeometry:function(){return xv},Layers:function(){return wu},LensFlare:function(){return rb},LessDepth:function(){return hi},LessEqualDepth:function(){return fi},LessEqualStencilFunc:function(){return Vo},LessStencilFunc:function(){return zo},Light:function(){return mm},LightProbe:function(){return Nm},Line:function(){return Yd},Line3:function(){return Vg},LineBasicMaterial:function(){return jd},LineCurve:function(){return Np},LineCurve3:function(){return Ip},LineDashedMaterial:function(){return Vv},LineLoop:function(){return $d},LinePieces:function(){return My},LineSegments:function(){return Qd},LineStrip:function(){return Sy},LinearEncoding:function(){return bo},LinearFilter:function(){return Vi},LinearInterpolant:function(){return Zv},LinearMipMapLinearFilter:function(){return Wi},LinearMipMapNearestFilter:function(){return ji},LinearMipmapLinearFilter:function(){return Hi},LinearMipmapNearestFilter:function(){return Gi},LinearToneMapping:function(){return xi},Loader:function(){return sm},LoaderUtils:function(){return Om},LoadingManager:function(){return am},LoopOnce:function(){return io},LoopPingPong:function(){return oo},LoopRepeat:function(){return ao},LuminanceAlphaFormat:function(){return ua},LuminanceFormat:function(){return sa},MOUSE:function(){return Tr},Material:function(){return Yu},MaterialLoader:function(){return Im},Math:function(){return ms},MathUtils:function(){return ms},Matrix3:function(){return ys},Matrix4:function(){return hu},MaxEquation:function(){return Jr},Mesh:function(){return Gl},MeshBasicMaterial:function(){return rl},MeshDepthMaterial:function(){return zf},MeshDistanceMaterial:function(){return Bf},MeshFaceMaterial:function(){return Cy},MeshLambertMaterial:function(){return zv},MeshMatcapMaterial:function(){return Bv},MeshNormalMaterial:function(){return Fv},MeshPhongMaterial:function(){return Ov},MeshPhysicalMaterial:function(){return Iv},MeshStandardMaterial:function(){return Nv},MeshToonMaterial:function(){return Uv},MinEquation:function(){return Kr},MirroredRepeatWrapping:function(){return Ii},MixOperation:function(){return yi},MultiMaterial:function(){return Ay},MultiplyBlending:function(){return Wr},MultiplyOperation:function(){return gi},NearestFilter:function(){return Oi},NearestMipMapLinearFilter:function(){return Bi},NearestMipMapNearestFilter:function(){return Fi},NearestMipmapLinearFilter:function(){return zi},NearestMipmapNearestFilter:function(){return Ui},NeverDepth:function(){return li},NeverStencilFunc:function(){return Fo},NoBlending:function(){return Vr},NoColors:function(){return ky},NoToneMapping:function(){return _i},NormalAnimationBlendMode:function(){return po},NormalBlending:function(){return Gr},NotEqualDepth:function(){return mi},NotEqualStencilFunc:function(){return jo},NumberKeyframeTrack:function(){return Jv},Object3D:function(){return Ou},ObjectLoader:function(){return Bm},ObjectSpaceNormalMap:function(){return Ao},OctahedronBufferGeometry:function(){return wv},OctahedronGeometry:function(){return wv},OneFactor:function(){return $r},OneMinusDstAlphaFactor:function(){return ai},OneMinusDstColorFactor:function(){return si},OneMinusSrcAlphaFactor:function(){return ri},OneMinusSrcColorFactor:function(){return ti},OrthographicCamera:function(){return _c},PCFShadowMap:function(){return Dr},PCFSoftShadowMap:function(){return Nr},PMREMGenerator:function(){return Uc},ParametricGeometry:function(){return ib},Particle:function(){return Py},ParticleBasicMaterial:function(){return Ny},ParticleSystem:function(){return Ly},ParticleSystemMaterial:function(){return Iy},Path:function(){return Vp},PerspectiveCamera:function(){return Kl},Plane:function(){return ic},PlaneBufferGeometry:function(){return cc},PlaneGeometry:function(){return cc},PlaneHelper:function(){return vy},PointCloud:function(){return Ry},PointCloudMaterial:function(){return Dy},PointLight:function(){return Cm},PointLightHelper:function(){return Yg},Points:function(){return ap},PointsMaterial:function(){return ep},PolarGridHelper:function(){return ty},PolyhedronBufferGeometry:function(){return dp},PolyhedronGeometry:function(){return dp},PositionalAudio:function(){return hg},PropertyBinding:function(){return kg},PropertyMixer:function(){return dg},QuadraticBezierCurve:function(){return Op},QuadraticBezierCurve3:function(){return Up},Quaternion:function(){return Ds},QuaternionKeyframeTrack:function(){return $v},QuaternionLinearInterpolant:function(){return Qv},REVISION:function(){return kr},RGBADepthPacking:function(){return Eo},RGBAFormat:function(){return oa},RGBAIntegerFormat:function(){return ga},RGBA_ASTC_10x10_Format:function(){return Ba},RGBA_ASTC_10x5_Format:function(){return Ua},RGBA_ASTC_10x6_Format:function(){return Fa},RGBA_ASTC_10x8_Format:function(){return za},RGBA_ASTC_12x10_Format:function(){return Va},RGBA_ASTC_12x12_Format:function(){return Ga},RGBA_ASTC_4x4_Format:function(){return Aa},RGBA_ASTC_5x4_Format:function(){return Ra},RGBA_ASTC_5x5_Format:function(){return Pa},RGBA_ASTC_6x5_Format:function(){return La},RGBA_ASTC_6x6_Format:function(){return Da},RGBA_ASTC_8x5_Format:function(){return Na},RGBA_ASTC_8x6_Format:function(){return Ia},RGBA_ASTC_8x8_Format:function(){return Oa},RGBA_BPTC_Format:function(){return ja},RGBA_ETC2_EAC_Format:function(){return Ca},RGBA_PVRTC_2BPPV1_Format:function(){return ka},RGBA_PVRTC_4BPPV1_Format:function(){return Ma},RGBA_S3TC_DXT1_Format:function(){return ba},RGBA_S3TC_DXT3_Format:function(){return _a},RGBA_S3TC_DXT5_Format:function(){return xa},RGBDEncoding:function(){return ko},RGBEEncoding:function(){return wo},RGBEFormat:function(){return la},RGBFormat:function(){return aa},RGBIntegerFormat:function(){return ma},RGBM16Encoding:function(){return Mo},RGBM7Encoding:function(){return So},RGB_ETC1_Format:function(){return Ta},RGB_ETC2_Format:function(){return Ea},RGB_PVRTC_2BPPV1_Format:function(){return Sa},RGB_PVRTC_4BPPV1_Format:function(){return wa},RGB_S3TC_DXT1_Format:function(){return ya},RGFormat:function(){return pa},RGIntegerFormat:function(){return va},RawShaderMaterial:function(){return xc},Ray:function(){return cu},Raycaster:function(){return Lg},RectAreaLight:function(){return Lm},RedFormat:function(){return fa},RedIntegerFormat:function(){return da},ReinhardToneMapping:function(){return wi},RepeatWrapping:function(){return Di},ReplaceStencilOp:function(){return Lo},ReverseSubtractEquation:function(){return Yr},RingBufferGeometry:function(){return Sv},RingGeometry:function(){return Sv},SRGB8_ALPHA8_ASTC_10x10_Format:function(){return to},SRGB8_ALPHA8_ASTC_10x5_Format:function(){return Qa},SRGB8_ALPHA8_ASTC_10x6_Format:function(){return $a},SRGB8_ALPHA8_ASTC_10x8_Format:function(){return eo},SRGB8_ALPHA8_ASTC_12x10_Format:function(){return no},SRGB8_ALPHA8_ASTC_12x12_Format:function(){return ro},SRGB8_ALPHA8_ASTC_4x4_Format:function(){return Ha},SRGB8_ALPHA8_ASTC_5x4_Format:function(){return Wa},SRGB8_ALPHA8_ASTC_5x5_Format:function(){return Za},SRGB8_ALPHA8_ASTC_6x5_Format:function(){return qa},SRGB8_ALPHA8_ASTC_6x6_Format:function(){return Xa},SRGB8_ALPHA8_ASTC_8x5_Format:function(){return Ya},SRGB8_ALPHA8_ASTC_8x6_Format:function(){return Ka},SRGB8_ALPHA8_ASTC_8x8_Format:function(){return Ja},Scene:function(){return rd},SceneUtils:function(){return nb},ShaderChunk:function(){return hc},ShaderLib:function(){return dc},ShaderMaterial:function(){return Xl},ShadowMaterial:function(){return Dv},Shape:function(){return Gp},ShapeBufferGeometry:function(){return Mv},ShapeGeometry:function(){return Mv},ShapePath:function(){return by},ShapeUtils:function(){return vv},ShortType:function(){return Xi},Skeleton:function(){return Od},SkeletonHelper:function(){return qg},SkinnedMesh:function(){return Pd},SmoothShading:function(){return Br},Sphere:function(){return nu},SphereBufferGeometry:function(){return kv},SphereGeometry:function(){return kv},Spherical:function(){return Ig},SphericalHarmonics3:function(){return Dm},SplineCurve:function(){return Fp},SpotLight:function(){return Sm},SpotLightHelper:function(){return jg},Sprite:function(){return xd},SpriteMaterial:function(){return ud},SrcAlphaFactor:function(){return ni},SrcAlphaSaturateFactor:function(){return ui},SrcColorFactor:function(){return ei},StaticCopyUsage:function(){return Qo},StaticDrawUsage:function(){return Zo},StaticReadUsage:function(){return Yo},StereoCamera:function(){return Qm},StreamCopyUsage:function(){return es},StreamDrawUsage:function(){return Xo},StreamReadUsage:function(){return Jo},StringKeyframeTrack:function(){return em},SubtractEquation:function(){return Xr},SubtractiveBlending:function(){return Hr},TOUCH:function(){return Er},TangentSpaceNormalMap:function(){return Co},TetrahedronBufferGeometry:function(){return Tv},TetrahedronGeometry:function(){return Tv},TextGeometry:function(){return ab},Texture:function(){return Es},TextureLoader:function(){return vm},TorusBufferGeometry:function(){return Ev},TorusGeometry:function(){return Ev},TorusKnotBufferGeometry:function(){return Cv},TorusKnotGeometry:function(){return Cv},Triangle:function(){return qu},TriangleFanDrawMode:function(){return yo},TriangleStripDrawMode:function(){return go},TrianglesDrawMode:function(){return mo},TubeBufferGeometry:function(){return Av},TubeGeometry:function(){return Av},UVMapping:function(){return Ti},Uint16Attribute:function(){return Gy},Uint16BufferAttribute:function(){return hl},Uint32Attribute:function(){return Hy},Uint32BufferAttribute:function(){return dl},Uint8Attribute:function(){return zy},Uint8BufferAttribute:function(){return ul},Uint8ClampedAttribute:function(){return By},Uint8ClampedBufferAttribute:function(){return ll},Uniform:function(){return Ag},UniformsLib:function(){return fc},UniformsUtils:function(){return ql},UnsignedByteType:function(){return Zi},UnsignedInt248Type:function(){return ra},UnsignedIntType:function(){return Ji},UnsignedShort4444Type:function(){return ea},UnsignedShort5551Type:function(){return ta},UnsignedShort565Type:function(){return na},UnsignedShortType:function(){return Yi},VSMShadowMap:function(){return Ir},Vector2:function(){return gs},Vector3:function(){return Ns},Vector4:function(){return As},VectorKeyframeTrack:function(){return tm},Vertex:function(){return Oy},VertexColors:function(){return Ey},VideoTexture:function(){return sp},WebGL1Renderer:function(){return ed},WebGLCubeRenderTarget:function(){return ec},WebGLMultipleRenderTargets:function(){return Ps},WebGLMultisampleRenderTarget:function(){return Ls},WebGLRenderTarget:function(){return Rs},WebGLRenderTargetCube:function(){return $y},WebGLRenderer:function(){return $f},WebGLUtils:function(){return Hf},WireframeGeometry:function(){return Rv},WireframeHelper:function(){return Ky},WrapAroundEnding:function(){return fo},XHRLoader:function(){return Jy},ZeroCurvatureEnding:function(){return co},ZeroFactor:function(){return Qr},ZeroSlopeEnding:function(){return ho},ZeroStencilOp:function(){return Ro},sRGBEncoding:function(){return _o}});var t=n(2791),r=n.t(t,2),i=n(1250);function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function o(e,t){if(e){if("string"===typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function s(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=o(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}var u=n(5671),l=n(3144),c=n(7326),h=n(136),f=n(9388),d=n(4505),p=n.n(d);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(u){s=!0,i=u}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}(e,t)||w(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e){return function(e){if(Array.isArray(e))return S(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||w(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){if(e){if("string"===typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var M=function(){},k={},T={},E=null,C={mark:M,measure:M};try{"undefined"!==typeof window&&(k=window),"undefined"!==typeof document&&(T=document),"undefined"!==typeof MutationObserver&&(E=MutationObserver),"undefined"!==typeof performance&&(C=performance)}catch(_2){}var A,R,P,L,D,N=(k.navigator||{}).userAgent,I=void 0===N?"":N,O=k,U=T,F=E,z=C,B=(O.document,!!U.documentElement&&!!U.head&&"function"===typeof U.addEventListener&&"function"===typeof U.createElement),V=~I.indexOf("MSIE")||~I.indexOf("Trident/"),G="svg-inline--fa",j="data-fa-i2svg",H="data-fa-pseudo-element",W="data-prefix",Z="data-icon",q="fontawesome-i2svg",X=["HTML","HEAD","STYLE","SCRIPT"],Y=function(){try{return!0}catch(_2){return!1}}(),K="classic",J="sharp",Q=[K,J];function $(e){return new Proxy(e,{get:function(e,t){return t in e?e[t]:e.classic}})}var ee=$((b(A={},K,{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit","fa-kit":"kit"}),b(A,J,{fa:"solid",fass:"solid","fa-solid":"solid",fasr:"regular","fa-regular":"regular",fasl:"light","fa-light":"light"}),A)),te=$((b(R={},K,{solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"}),b(R,J,{solid:"fass",regular:"fasr",light:"fasl"}),R)),ne=$((b(P={},K,{fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"}),b(P,J,{fass:"fa-solid",fasr:"fa-regular",fasl:"fa-light"}),P)),re=$((b(L={},K,{"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"}),b(L,J,{"fa-solid":"fass","fa-regular":"fasr","fa-light":"fasl"}),L)),ie=/fa(s|r|l|t|d|b|k|ss|sr|sl)?[\-\ ]/,ae="fa-layers-text",oe=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp|Kit)?.*/i,se=$((b(D={},K,{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"}),b(D,J,{900:"fass",400:"fasr",300:"fasl"}),D)),ue=[1,2,3,4,5,6,7,8,9,10],le=ue.concat([11,12,13,14,15,16,17,18,19,20]),ce=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],he="duotone-group",fe="swap-opacity",de="primary",pe="secondary",ve=new Set;Object.keys(te.classic).map(ve.add.bind(ve)),Object.keys(te.sharp).map(ve.add.bind(ve));var me=[].concat(Q,x(ve),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",he,fe,de,pe]).concat(ue.map((function(e){return"".concat(e,"x")}))).concat(le.map((function(e){return"w-".concat(e)}))),ge=O.FontAwesomeConfig||{};if(U&&"function"===typeof U.querySelector){[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach((function(e){var t=_(e,2),n=t[0],r=t[1],i=function(e){return""===e||"false"!==e&&("true"===e||e)}(function(e){var t=U.querySelector("script["+e+"]");if(t)return t.getAttribute(e)}(n));void 0!==i&&null!==i&&(ge[r]=i)}))}var ye={styleDefault:"solid",familyDefault:"classic",cssPrefix:"fa",replacementClass:G,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};ge.familyPrefix&&(ge.cssPrefix=ge.familyPrefix);var be=m(m({},ye),ge);be.autoReplaceSvg||(be.observeMutations=!1);var _e={};Object.keys(ye).forEach((function(e){Object.defineProperty(_e,e,{enumerable:!0,set:function(t){be[e]=t,xe.forEach((function(e){return e(_e)}))},get:function(){return be[e]}})})),Object.defineProperty(_e,"familyPrefix",{enumerable:!0,set:function(e){be.cssPrefix=e,xe.forEach((function(e){return e(_e)}))},get:function(){return be.cssPrefix}}),O.FontAwesomeConfig=_e;var xe=[];var we=16,Se={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function Me(){for(var e=12,t="";e-- >0;)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return t}function ke(e){for(var t=[],n=(e||[]).length>>>0;n--;)t[n]=e[n];return t}function Te(e){return e.classList?ke(e.classList):(e.getAttribute("class")||"").split(" ").filter((function(e){return e}))}function Ee(e){return"".concat(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Ce(e){return Object.keys(e||{}).reduce((function(t,n){return t+"".concat(n,": ").concat(e[n].trim(),";")}),"")}function Ae(e){return e.size!==Se.size||e.x!==Se.x||e.y!==Se.y||e.rotate!==Se.rotate||e.flipX||e.flipY}function Re(){var e="fa",t=G,n=_e.cssPrefix,r=_e.replacementClass,i=':root, :host {\n  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";\n  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";\n  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";\n  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";\n  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";\n  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-regular: normal 400 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-light: normal 300 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";\n}\n\nsvg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {\n  overflow: visible;\n  box-sizing: content-box;\n}\n\n.svg-inline--fa {\n  display: var(--fa-display, inline-block);\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-2xs {\n  vertical-align: 0.1em;\n}\n.svg-inline--fa.fa-xs {\n  vertical-align: 0em;\n}\n.svg-inline--fa.fa-sm {\n  vertical-align: -0.0714285705em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.2em;\n}\n.svg-inline--fa.fa-xl {\n  vertical-align: -0.25em;\n}\n.svg-inline--fa.fa-2xl {\n  vertical-align: -0.3125em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-li {\n  width: var(--fa-li-width, 2em);\n  top: 0.25em;\n}\n.svg-inline--fa.fa-fw {\n  width: var(--fa-fw-width, 1.25em);\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: var(--fa-counter-background-color, #ff253a);\n  border-radius: var(--fa-counter-border-radius, 1em);\n  box-sizing: border-box;\n  color: var(--fa-inverse, #fff);\n  line-height: var(--fa-counter-line-height, 1);\n  max-width: var(--fa-counter-max-width, 5em);\n  min-width: var(--fa-counter-min-width, 1.5em);\n  overflow: hidden;\n  padding: var(--fa-counter-padding, 0.25em 0.5em);\n  right: var(--fa-right, 0);\n  text-overflow: ellipsis;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-counter-scale, 0.25));\n          transform: scale(var(--fa-counter-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: var(--fa-bottom, 0);\n  right: var(--fa-right, 0);\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: var(--fa-bottom, 0);\n  left: var(--fa-left, 0);\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  top: var(--fa-top, 0);\n  right: var(--fa-right, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: var(--fa-left, 0);\n  right: auto;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-2xs {\n  font-size: 0.625em;\n  line-height: 0.1em;\n  vertical-align: 0.225em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n  line-height: 0.0833333337em;\n  vertical-align: 0.125em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n  line-height: 0.0714285718em;\n  vertical-align: 0.0535714295em;\n}\n\n.fa-lg {\n  font-size: 1.25em;\n  line-height: 0.05em;\n  vertical-align: -0.075em;\n}\n\n.fa-xl {\n  font-size: 1.5em;\n  line-height: 0.0416666682em;\n  vertical-align: -0.125em;\n}\n\n.fa-2xl {\n  font-size: 2em;\n  line-height: 0.03125em;\n  vertical-align: -0.1875em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: var(--fa-li-margin, 2.5em);\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: calc(var(--fa-li-width, 2em) * -1);\n  position: absolute;\n  text-align: center;\n  width: var(--fa-li-width, 2em);\n  line-height: inherit;\n}\n\n.fa-border {\n  border-color: var(--fa-border-color, #eee);\n  border-radius: var(--fa-border-radius, 0.1em);\n  border-style: var(--fa-border-style, solid);\n  border-width: var(--fa-border-width, 0.08em);\n  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);\n}\n\n.fa-pull-left {\n  float: left;\n  margin-right: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-pull-right {\n  float: right;\n  margin-left: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-beat {\n  -webkit-animation-name: fa-beat;\n          animation-name: fa-beat;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-bounce {\n  -webkit-animation-name: fa-bounce;\n          animation-name: fa-bounce;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n}\n\n.fa-fade {\n  -webkit-animation-name: fa-fade;\n          animation-name: fa-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-beat-fade {\n  -webkit-animation-name: fa-beat-fade;\n          animation-name: fa-beat-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-flip {\n  -webkit-animation-name: fa-flip;\n          animation-name: fa-flip;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-shake {\n  -webkit-animation-name: fa-shake;\n          animation-name: fa-shake;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 2s);\n          animation-duration: var(--fa-animation-duration, 2s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin-reverse {\n  --fa-animation-direction: reverse;\n}\n\n.fa-pulse,\n.fa-spin-pulse {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));\n          animation-timing-function: var(--fa-animation-timing, steps(8));\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .fa-beat,\n.fa-bounce,\n.fa-fade,\n.fa-beat-fade,\n.fa-flip,\n.fa-pulse,\n.fa-shake,\n.fa-spin,\n.fa-spin-pulse {\n    -webkit-animation-delay: -1ms;\n            animation-delay: -1ms;\n    -webkit-animation-duration: 1ms;\n            animation-duration: 1ms;\n    -webkit-animation-iteration-count: 1;\n            animation-iteration-count: 1;\n    -webkit-transition-delay: 0s;\n            transition-delay: 0s;\n    -webkit-transition-duration: 0s;\n            transition-duration: 0s;\n  }\n}\n@-webkit-keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@-webkit-keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@-webkit-keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@-webkit-keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@-webkit-keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@-webkit-keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both,\n.fa-flip-horizontal.fa-flip-vertical {\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n.fa-rotate-by {\n  -webkit-transform: rotate(var(--fa-rotate-angle, none));\n          transform: rotate(var(--fa-rotate-angle, none));\n}\n\n.fa-stack {\n  display: inline-block;\n  vertical-align: middle;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n  z-index: var(--fa-stack-z-index, auto);\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}\n\n.sr-only,\n.fa-sr-only {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.sr-only-focusable:not(:focus),\n.fa-sr-only-focusable:not(:focus) {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse,\n.fa-duotone.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}';if(n!==e||r!==t){var a=new RegExp("\\.".concat(e,"\\-"),"g"),o=new RegExp("\\--".concat(e,"\\-"),"g"),s=new RegExp("\\.".concat(t),"g");i=i.replace(a,".".concat(n,"-")).replace(o,"--".concat(n,"-")).replace(s,".".concat(r))}return i}var Pe=!1;function Le(){_e.autoAddCss&&!Pe&&(!function(e){if(e&&B){var t=U.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=e;for(var n=U.head.childNodes,r=null,i=n.length-1;i>-1;i--){var a=n[i],o=(a.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(r=a)}U.head.insertBefore(t,r)}}(Re()),Pe=!0)}var De={mixout:function(){return{dom:{css:Re,insertCss:Le}}},hooks:function(){return{beforeDOMElementCreation:function(){Le()},beforeI2svg:function(){Le()}}}},Ne=O||{};Ne.___FONT_AWESOME___||(Ne.___FONT_AWESOME___={}),Ne.___FONT_AWESOME___.styles||(Ne.___FONT_AWESOME___.styles={}),Ne.___FONT_AWESOME___.hooks||(Ne.___FONT_AWESOME___.hooks={}),Ne.___FONT_AWESOME___.shims||(Ne.___FONT_AWESOME___.shims=[]);var Ie=Ne.___FONT_AWESOME___,Oe=[],Ue=!1;function Fe(e){B&&(Ue?setTimeout(e,0):Oe.push(e))}function ze(e){var t=e.tag,n=e.attributes,r=void 0===n?{}:n,i=e.children,a=void 0===i?[]:i;return"string"===typeof e?Ee(e):"<".concat(t," ").concat(function(e){return Object.keys(e||{}).reduce((function(t,n){return t+"".concat(n,'="').concat(Ee(e[n]),'" ')}),"").trim()}(r),">").concat(a.map(ze).join(""),"</").concat(t,">")}function Be(e,t,n){if(e&&e[t]&&e[t][n])return{prefix:t,iconName:n,icon:e[t][n]}}B&&((Ue=(U.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(U.readyState))||U.addEventListener("DOMContentLoaded",(function e(){U.removeEventListener("DOMContentLoaded",e),Ue=1,Oe.map((function(e){return e()}))})));var Ve=function(e,t,n,r){var i,a,o,s=Object.keys(e),u=s.length,l=void 0!==r?function(e,t){return function(n,r,i,a){return e.call(t,n,r,i,a)}}(t,r):t;for(void 0===n?(i=1,o=e[s[0]]):(i=0,o=n);i<u;i++)o=l(o,e[a=s[i]],a,e);return o};function Ge(e){var t=function(e){for(var t=[],n=0,r=e.length;n<r;){var i=e.charCodeAt(n++);if(i>=55296&&i<=56319&&n<r){var a=e.charCodeAt(n++);56320==(64512&a)?t.push(((1023&i)<<10)+(1023&a)+65536):(t.push(i),n--)}else t.push(i)}return t}(e);return 1===t.length?t[0].toString(16):null}function je(e){return Object.keys(e).reduce((function(t,n){var r=e[n];return!!r.icon?t[r.iconName]=r.icon:t[n]=r,t}),{})}function He(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.skipHooks,i=void 0!==r&&r,a=je(t);"function"!==typeof Ie.hooks.addPack||i?Ie.styles[e]=m(m({},Ie.styles[e]||{}),a):Ie.hooks.addPack(e,je(t)),"fas"===e&&He("fa",t)}var We,Ze,qe,Xe=Ie.styles,Ye=Ie.shims,Ke=(b(We={},K,Object.values(ne.classic)),b(We,J,Object.values(ne.sharp)),We),Je=null,Qe={},$e={},et={},tt={},nt={},rt=(b(Ze={},K,Object.keys(ee.classic)),b(Ze,J,Object.keys(ee.sharp)),Ze);function it(e,t){var n,r=t.split("-"),i=r[0],a=r.slice(1).join("-");return i!==e||""===a||(n=a,~me.indexOf(n))?null:a}var at,ot=function(){var e=function(e){return Ve(Xe,(function(t,n,r){return t[r]=Ve(n,e,{}),t}),{})};Qe=e((function(e,t,n){(t[3]&&(e[t[3]]=n),t[2])&&t[2].filter((function(e){return"number"===typeof e})).forEach((function(t){e[t.toString(16)]=n}));return e})),$e=e((function(e,t,n){(e[n]=n,t[2])&&t[2].filter((function(e){return"string"===typeof e})).forEach((function(t){e[t]=n}));return e})),nt=e((function(e,t,n){var r=t[2];return e[n]=n,r.forEach((function(t){e[t]=n})),e}));var t="far"in Xe||_e.autoFetchSvg,n=Ve(Ye,(function(e,n){var r=n[0],i=n[1],a=n[2];return"far"!==i||t||(i="fas"),"string"===typeof r&&(e.names[r]={prefix:i,iconName:a}),"number"===typeof r&&(e.unicodes[r.toString(16)]={prefix:i,iconName:a}),e}),{names:{},unicodes:{}});et=n.names,tt=n.unicodes,Je=ht(_e.styleDefault,{family:_e.familyDefault})};function st(e,t){return(Qe[e]||{})[t]}function ut(e,t){return(nt[e]||{})[t]}function lt(e){return et[e]||{prefix:null,iconName:null}}function ct(){return Je}at=function(e){Je=ht(e.styleDefault,{family:_e.familyDefault})},xe.push(at),ot();function ht(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.family,r=void 0===n?K:n,i=ee[r][e],a=te[r][e]||te[r][i],o=e in Ie.styles?e:null;return a||o||null}var ft=(b(qe={},K,Object.keys(ne.classic)),b(qe,J,Object.keys(ne.sharp)),qe);function dt(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.skipLookups,i=void 0!==r&&r,a=(b(t={},K,"".concat(_e.cssPrefix,"-").concat(K)),b(t,J,"".concat(_e.cssPrefix,"-").concat(J)),t),o=null,s=K;(e.includes(a.classic)||e.some((function(e){return ft.classic.includes(e)})))&&(s=K),(e.includes(a.sharp)||e.some((function(e){return ft.sharp.includes(e)})))&&(s=J);var u=e.reduce((function(e,t){var n=it(_e.cssPrefix,t);if(Xe[t]?(t=Ke[s].includes(t)?re[s][t]:t,o=t,e.prefix=t):rt[s].indexOf(t)>-1?(o=t,e.prefix=ht(t,{family:s})):n?e.iconName=n:t!==_e.replacementClass&&t!==a.classic&&t!==a.sharp&&e.rest.push(t),!i&&e.prefix&&e.iconName){var r="fa"===o?lt(e.iconName):{},u=ut(e.prefix,e.iconName);r.prefix&&(o=null),e.iconName=r.iconName||u||e.iconName,e.prefix=r.prefix||e.prefix,"far"!==e.prefix||Xe.far||!Xe.fas||_e.autoFetchSvg||(e.prefix="fas")}return e}),{prefix:null,iconName:null,rest:[]});return(e.includes("fa-brands")||e.includes("fab"))&&(u.prefix="fab"),(e.includes("fa-duotone")||e.includes("fad"))&&(u.prefix="fad"),u.prefix||s!==J||!Xe.fass&&!_e.autoFetchSvg||(u.prefix="fass",u.iconName=ut(u.prefix,u.iconName)||u.iconName),"fa"!==u.prefix&&"fa"!==o||(u.prefix=ct()||"fas"),u}var pt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.definitions={}}var t,n,r;return t=e,n=[{key:"add",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n.reduce(this._pullDefinitions,{});Object.keys(i).forEach((function(t){e.definitions[t]=m(m({},e.definitions[t]||{}),i[t]),He(t,i[t]);var n=ne.classic[t];n&&He(n,i[t]),ot()}))}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(e,t){var n=t.prefix&&t.iconName&&t.icon?{0:t}:t;return Object.keys(n).map((function(t){var r=n[t],i=r.prefix,a=r.iconName,o=r.icon,s=o[2];e[i]||(e[i]={}),s.length>0&&s.forEach((function(t){"string"===typeof t&&(e[i][t]=o)})),e[i][a]=o})),e}}],n&&y(t.prototype,n),r&&y(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),vt=[],mt={},gt={},yt=Object.keys(gt);function bt(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var a=mt[e]||[];return a.forEach((function(e){t=e.apply(null,[t].concat(r))})),t}function _t(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=mt[e]||[];i.forEach((function(e){e.apply(null,n)}))}function xt(){var e=arguments[0],t=Array.prototype.slice.call(arguments,1);return gt[e]?gt[e].apply(null,t):void 0}function wt(e){"fa"===e.prefix&&(e.prefix="fas");var t=e.iconName,n=e.prefix||ct();if(t)return t=ut(n,t)||t,Be(St.definitions,n,t)||Be(Ie.styles,n,t)}var St=new pt,Mt={i2svg:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return B?(_t("beforeI2svg",e),xt("pseudoElements2svg",e),xt("i2svg",e)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.autoReplaceSvgRoot;!1===_e.autoReplaceSvg&&(_e.autoReplaceSvg=!0),_e.observeMutations=!0,Fe((function(){Tt({autoReplaceSvgRoot:t}),_t("watch",e)}))}},kt={noAuto:function(){_e.autoReplaceSvg=!1,_e.observeMutations=!1,_t("noAuto")},config:_e,dom:Mt,parse:{icon:function(e){if(null===e)return null;if("object"===g(e)&&e.prefix&&e.iconName)return{prefix:e.prefix,iconName:ut(e.prefix,e.iconName)||e.iconName};if(Array.isArray(e)&&2===e.length){var t=0===e[1].indexOf("fa-")?e[1].slice(3):e[1],n=ht(e[0]);return{prefix:n,iconName:ut(n,t)||t}}if("string"===typeof e&&(e.indexOf("".concat(_e.cssPrefix,"-"))>-1||e.match(ie))){var r=dt(e.split(" "),{skipLookups:!0});return{prefix:r.prefix||ct(),iconName:ut(r.prefix,r.iconName)||r.iconName}}if("string"===typeof e){var i=ct();return{prefix:i,iconName:ut(i,e)||e}}}},library:St,findIconDefinition:wt,toHtml:ze},Tt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.autoReplaceSvgRoot,n=void 0===t?U:t;(Object.keys(Ie.styles).length>0||_e.autoFetchSvg)&&B&&_e.autoReplaceSvg&&kt.dom.i2svg({node:n})};function Et(e,t){return Object.defineProperty(e,"abstract",{get:t}),Object.defineProperty(e,"html",{get:function(){return e.abstract.map((function(e){return ze(e)}))}}),Object.defineProperty(e,"node",{get:function(){if(B){var t=U.createElement("div");return t.innerHTML=e.html,t.children}}}),e}function Ct(e){var t=e.icons,n=t.main,r=t.mask,i=e.prefix,a=e.iconName,o=e.transform,s=e.symbol,u=e.title,l=e.maskId,c=e.titleId,h=e.extra,f=e.watchable,d=void 0!==f&&f,p=r.found?r:n,v=p.width,g=p.height,y="fak"===i,b=[_e.replacementClass,a?"".concat(_e.cssPrefix,"-").concat(a):""].filter((function(e){return-1===h.classes.indexOf(e)})).filter((function(e){return""!==e||!!e})).concat(h.classes).join(" "),_={children:[],attributes:m(m({},h.attributes),{},{"data-prefix":i,"data-icon":a,class:b,role:h.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(v," ").concat(g)})},x=y&&!~h.classes.indexOf("fa-fw")?{width:"".concat(v/g*16*.0625,"em")}:{};d&&(_.attributes[j]=""),u&&(_.children.push({tag:"title",attributes:{id:_.attributes["aria-labelledby"]||"title-".concat(c||Me())},children:[u]}),delete _.attributes.title);var w=m(m({},_),{},{prefix:i,iconName:a,main:n,mask:r,maskId:l,transform:o,symbol:s,styles:m(m({},x),h.styles)}),S=r.found&&n.found?xt("generateAbstractMask",w)||{children:[],attributes:{}}:xt("generateAbstractIcon",w)||{children:[],attributes:{}},M=S.children,k=S.attributes;return w.children=M,w.attributes=k,s?function(e){var t=e.prefix,n=e.iconName,r=e.children,i=e.attributes,a=e.symbol,o=!0===a?"".concat(t,"-").concat(_e.cssPrefix,"-").concat(n):a;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:m(m({},i),{},{id:o}),children:r}]}]}(w):function(e){var t=e.children,n=e.main,r=e.mask,i=e.attributes,a=e.styles,o=e.transform;if(Ae(o)&&n.found&&!r.found){var s={x:n.width/n.height/2,y:.5};i.style=Ce(m(m({},a),{},{"transform-origin":"".concat(s.x+o.x/16,"em ").concat(s.y+o.y/16,"em")}))}return[{tag:"svg",attributes:i,children:t}]}(w)}function At(e){var t=e.content,n=e.width,r=e.height,i=e.transform,a=e.title,o=e.extra,s=e.watchable,u=void 0!==s&&s,l=m(m(m({},o.attributes),a?{title:a}:{}),{},{class:o.classes.join(" ")});u&&(l[j]="");var c=m({},o.styles);Ae(i)&&(c.transform=function(e){var t=e.transform,n=e.width,r=void 0===n?16:n,i=e.height,a=void 0===i?16:i,o=e.startCentered,s=void 0!==o&&o,u="";return u+=s&&V?"translate(".concat(t.x/we-r/2,"em, ").concat(t.y/we-a/2,"em) "):s?"translate(calc(-50% + ".concat(t.x/we,"em), calc(-50% + ").concat(t.y/we,"em)) "):"translate(".concat(t.x/we,"em, ").concat(t.y/we,"em) "),u+="scale(".concat(t.size/we*(t.flipX?-1:1),", ").concat(t.size/we*(t.flipY?-1:1),") "),u+"rotate(".concat(t.rotate,"deg) ")}({transform:i,startCentered:!0,width:n,height:r}),c["-webkit-transform"]=c.transform);var h=Ce(c);h.length>0&&(l.style=h);var f=[];return f.push({tag:"span",attributes:l,children:[t]}),a&&f.push({tag:"span",attributes:{class:"sr-only"},children:[a]}),f}function Rt(e){var t=e.content,n=e.title,r=e.extra,i=m(m(m({},r.attributes),n?{title:n}:{}),{},{class:r.classes.join(" ")}),a=Ce(r.styles);a.length>0&&(i.style=a);var o=[];return o.push({tag:"span",attributes:i,children:[t]}),n&&o.push({tag:"span",attributes:{class:"sr-only"},children:[n]}),o}var Pt=Ie.styles;function Lt(e){var t=e[0],n=e[1],r=_(e.slice(4),1)[0];return{found:!0,width:t,height:n,icon:Array.isArray(r)?{tag:"g",attributes:{class:"".concat(_e.cssPrefix,"-").concat(he)},children:[{tag:"path",attributes:{class:"".concat(_e.cssPrefix,"-").concat(pe),fill:"currentColor",d:r[0]}},{tag:"path",attributes:{class:"".concat(_e.cssPrefix,"-").concat(de),fill:"currentColor",d:r[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:r}}}}var Dt={found:!1,width:512,height:512};function Nt(e,t){var n=t;return"fa"===t&&null!==_e.styleDefault&&(t=ct()),new Promise((function(r,i){xt("missingIconAbstract");if("fa"===n){var a=lt(e)||{};e=a.iconName||e,t=a.prefix||t}if(e&&t&&Pt[t]&&Pt[t][e])return r(Lt(Pt[t][e]));!function(e,t){Y||_e.showMissingIcons||!e||console.error('Icon with name "'.concat(e,'" and prefix "').concat(t,'" is missing.'))}(e,t),r(m(m({},Dt),{},{icon:_e.showMissingIcons&&e&&xt("missingIconAbstract")||{}}))}))}var It=function(){},Ot=_e.measurePerformance&&z&&z.mark&&z.measure?z:{mark:It,measure:It},Ut='FA "6.4.0"',Ft=function(e){Ot.mark("".concat(Ut," ").concat(e," ends")),Ot.measure("".concat(Ut," ").concat(e),"".concat(Ut," ").concat(e," begins"),"".concat(Ut," ").concat(e," ends"))},zt=function(e){return Ot.mark("".concat(Ut," ").concat(e," begins")),function(){return Ft(e)}},Bt=function(){};function Vt(e){return"string"===typeof(e.getAttribute?e.getAttribute(j):null)}function Gt(e){return U.createElementNS("http://www.w3.org/2000/svg",e)}function jt(e){return U.createElement(e)}function Ht(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.ceFn,r=void 0===n?"svg"===e.tag?Gt:jt:n;if("string"===typeof e)return U.createTextNode(e);var i=r(e.tag);Object.keys(e.attributes||[]).forEach((function(t){i.setAttribute(t,e.attributes[t])}));var a=e.children||[];return a.forEach((function(e){i.appendChild(Ht(e,{ceFn:r}))})),i}var Wt={replace:function(e){var t=e[0];if(t.parentNode)if(e[1].forEach((function(e){t.parentNode.insertBefore(Ht(e),t)})),null===t.getAttribute(j)&&_e.keepOriginalSource){var n=U.createComment(function(e){var t=" ".concat(e.outerHTML," ");return"".concat(t,"Font Awesome fontawesome.com ")}(t));t.parentNode.replaceChild(n,t)}else t.remove()},nest:function(e){var t=e[0],n=e[1];if(~Te(t).indexOf(_e.replacementClass))return Wt.replace(e);var r=new RegExp("".concat(_e.cssPrefix,"-.*"));if(delete n[0].attributes.id,n[0].attributes.class){var i=n[0].attributes.class.split(" ").reduce((function(e,t){return t===_e.replacementClass||t.match(r)?e.toSvg.push(t):e.toNode.push(t),e}),{toNode:[],toSvg:[]});n[0].attributes.class=i.toSvg.join(" "),0===i.toNode.length?t.removeAttribute("class"):t.setAttribute("class",i.toNode.join(" "))}var a=n.map((function(e){return ze(e)})).join("\n");t.setAttribute(j,""),t.innerHTML=a}};function Zt(e){e()}function qt(e,t){var n="function"===typeof t?t:Bt;if(0===e.length)n();else{var r=Zt;"async"===_e.mutateApproach&&(r=O.requestAnimationFrame||Zt),r((function(){var t=!0===_e.autoReplaceSvg?Wt.replace:Wt[_e.autoReplaceSvg]||Wt.replace,r=zt("mutate");e.map(t),r(),n()}))}}var Xt=!1;function Yt(){Xt=!0}function Kt(){Xt=!1}var Jt=null;function Qt(e){if(F&&_e.observeMutations){var t=e.treeCallback,n=void 0===t?Bt:t,r=e.nodeCallback,i=void 0===r?Bt:r,a=e.pseudoElementsCallback,o=void 0===a?Bt:a,s=e.observeMutationsRoot,u=void 0===s?U:s;Jt=new F((function(e){if(!Xt){var t=ct();ke(e).forEach((function(e){if("childList"===e.type&&e.addedNodes.length>0&&!Vt(e.addedNodes[0])&&(_e.searchPseudoElements&&o(e.target),n(e.target)),"attributes"===e.type&&e.target.parentNode&&_e.searchPseudoElements&&o(e.target.parentNode),"attributes"===e.type&&Vt(e.target)&&~ce.indexOf(e.attributeName))if("class"===e.attributeName&&function(e){var t=e.getAttribute?e.getAttribute(W):null,n=e.getAttribute?e.getAttribute(Z):null;return t&&n}(e.target)){var r=dt(Te(e.target)),a=r.prefix,s=r.iconName;e.target.setAttribute(W,a||t),s&&e.target.setAttribute(Z,s)}else(function(e){return e&&e.classList&&e.classList.contains&&e.classList.contains(_e.replacementClass)})(e.target)&&i(e.target)}))}})),B&&Jt.observe(u,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function $t(e){var t=e.getAttribute("style"),n=[];return t&&(n=t.split(";").reduce((function(e,t){var n=t.split(":"),r=n[0],i=n.slice(1);return r&&i.length>0&&(e[r]=i.join(":").trim()),e}),{})),n}function en(e){var t=e.getAttribute("data-prefix"),n=e.getAttribute("data-icon"),r=void 0!==e.innerText?e.innerText.trim():"",i=dt(Te(e));return i.prefix||(i.prefix=ct()),t&&n&&(i.prefix=t,i.iconName=n),i.iconName&&i.prefix||(i.prefix&&r.length>0&&(i.iconName=function(e,t){return($e[e]||{})[t]}(i.prefix,e.innerText)||st(i.prefix,Ge(e.innerText))),!i.iconName&&_e.autoFetchSvg&&e.firstChild&&e.firstChild.nodeType===Node.TEXT_NODE&&(i.iconName=e.firstChild.data)),i}function tn(e){var t=ke(e.attributes).reduce((function(e,t){return"class"!==e.name&&"style"!==e.name&&(e[t.name]=t.value),e}),{}),n=e.getAttribute("title"),r=e.getAttribute("data-fa-title-id");return _e.autoA11y&&(n?t["aria-labelledby"]="".concat(_e.replacementClass,"-title-").concat(r||Me()):(t["aria-hidden"]="true",t.focusable="false")),t}function nn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{styleParser:!0},n=en(e),r=n.iconName,i=n.prefix,a=n.rest,o=tn(e),s=bt("parseNodeAttributes",{},e),u=t.styleParser?$t(e):[];return m({iconName:r,title:e.getAttribute("title"),titleId:e.getAttribute("data-fa-title-id"),prefix:i,transform:Se,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:a,styles:u,attributes:o}},s)}var rn=Ie.styles;function an(e){var t="nest"===_e.autoReplaceSvg?nn(e,{styleParser:!1}):nn(e);return~t.extra.classes.indexOf(ae)?xt("generateLayersText",e,t):xt("generateSvgReplacementMutation",e,t)}var on=new Set;function sn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!B)return Promise.resolve();var n=U.documentElement.classList,r=function(e){return n.add("".concat(q,"-").concat(e))},i=function(e){return n.remove("".concat(q,"-").concat(e))},a=_e.autoFetchSvg?on:Q.map((function(e){return"fa-".concat(e)})).concat(Object.keys(rn));a.includes("fa")||a.push("fa");var o=[".".concat(ae,":not([").concat(j,"])")].concat(a.map((function(e){return".".concat(e,":not([").concat(j,"])")}))).join(", ");if(0===o.length)return Promise.resolve();var s=[];try{s=ke(e.querySelectorAll(o))}catch(_2){}if(!(s.length>0))return Promise.resolve();r("pending"),i("complete");var u=zt("onTree"),l=s.reduce((function(e,t){try{var n=an(t);n&&e.push(n)}catch(_2){Y||"MissingIcon"===_2.name&&console.error(_2)}return e}),[]);return new Promise((function(e,n){Promise.all(l).then((function(n){qt(n,(function(){r("active"),r("complete"),i("pending"),"function"===typeof t&&t(),u(),e()}))})).catch((function(e){u(),n(e)}))}))}function un(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;an(e).then((function(e){e&&qt([e],t)}))}function ln(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(t||{}).icon?t:wt(t||{}),i=n.mask;return i&&(i=(i||{}).icon?i:wt(i||{})),e(r,m(m({},n),{},{mask:i}))}}Q.map((function(e){on.add("fa-".concat(e))})),Object.keys(ee.classic).map(on.add.bind(on)),Object.keys(ee.sharp).map(on.add.bind(on)),on=x(on);var cn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.transform,r=void 0===n?Se:n,i=t.symbol,a=void 0!==i&&i,o=t.mask,s=void 0===o?null:o,u=t.maskId,l=void 0===u?null:u,c=t.title,h=void 0===c?null:c,f=t.titleId,d=void 0===f?null:f,p=t.classes,v=void 0===p?[]:p,g=t.attributes,y=void 0===g?{}:g,b=t.styles,_=void 0===b?{}:b;if(e){var x=e.prefix,w=e.iconName,S=e.icon;return Et(m({type:"icon"},e),(function(){return _t("beforeDOMElementCreation",{iconDefinition:e,params:t}),_e.autoA11y&&(h?y["aria-labelledby"]="".concat(_e.replacementClass,"-title-").concat(d||Me()):(y["aria-hidden"]="true",y.focusable="false")),Ct({icons:{main:Lt(S),mask:s?Lt(s.icon):{found:!1,width:null,height:null,icon:{}}},prefix:x,iconName:w,transform:m(m({},Se),r),symbol:a,title:h,maskId:l,titleId:d,extra:{attributes:y,styles:_,classes:v}})}))}},hn={mixout:function(){return{icon:ln(cn)}},hooks:function(){return{mutationObserverCallbacks:function(e){return e.treeCallback=sn,e.nodeCallback=un,e}}},provides:function(e){e.i2svg=function(e){var t=e.node,n=void 0===t?U:t,r=e.callback;return sn(n,void 0===r?function(){}:r)},e.generateSvgReplacementMutation=function(e,t){var n=t.iconName,r=t.title,i=t.titleId,a=t.prefix,o=t.transform,s=t.symbol,u=t.mask,l=t.maskId,c=t.extra;return new Promise((function(t,h){Promise.all([Nt(n,a),u.iconName?Nt(u.iconName,u.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then((function(u){var h=_(u,2),f=h[0],d=h[1];t([e,Ct({icons:{main:f,mask:d},prefix:a,iconName:n,transform:o,symbol:s,maskId:l,title:r,titleId:i,extra:c,watchable:!0})])})).catch(h)}))},e.generateAbstractIcon=function(e){var t,n=e.children,r=e.attributes,i=e.main,a=e.transform,o=Ce(e.styles);return o.length>0&&(r.style=o),Ae(a)&&(t=xt("generateAbstractTransformGrouping",{main:i,transform:a,containerWidth:i.width,iconWidth:i.width})),n.push(t||i.icon),{children:n,attributes:r}}}},fn={mixout:function(){return{layer:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.classes,r=void 0===n?[]:n;return Et({type:"layer"},(function(){_t("beforeDOMElementCreation",{assembler:e,params:t});var n=[];return e((function(e){Array.isArray(e)?e.map((function(e){n=n.concat(e.abstract)})):n=n.concat(e.abstract)})),[{tag:"span",attributes:{class:["".concat(_e.cssPrefix,"-layers")].concat(x(r)).join(" ")},children:n}]}))}}}},dn={mixout:function(){return{counter:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.title,r=void 0===n?null:n,i=t.classes,a=void 0===i?[]:i,o=t.attributes,s=void 0===o?{}:o,u=t.styles,l=void 0===u?{}:u;return Et({type:"counter",content:e},(function(){return _t("beforeDOMElementCreation",{content:e,params:t}),Rt({content:e.toString(),title:r,extra:{attributes:s,styles:l,classes:["".concat(_e.cssPrefix,"-layers-counter")].concat(x(a))}})}))}}}},pn={mixout:function(){return{text:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.transform,r=void 0===n?Se:n,i=t.title,a=void 0===i?null:i,o=t.classes,s=void 0===o?[]:o,u=t.attributes,l=void 0===u?{}:u,c=t.styles,h=void 0===c?{}:c;return Et({type:"text",content:e},(function(){return _t("beforeDOMElementCreation",{content:e,params:t}),At({content:e,transform:m(m({},Se),r),title:a,extra:{attributes:l,styles:h,classes:["".concat(_e.cssPrefix,"-layers-text")].concat(x(s))}})}))}}},provides:function(e){e.generateLayersText=function(e,t){var n=t.title,r=t.transform,i=t.extra,a=null,o=null;if(V){var s=parseInt(getComputedStyle(e).fontSize,10),u=e.getBoundingClientRect();a=u.width/s,o=u.height/s}return _e.autoA11y&&!n&&(i.attributes["aria-hidden"]="true"),Promise.resolve([e,At({content:e.innerHTML,width:a,height:o,transform:r,title:n,extra:i,watchable:!0})])}}},vn=new RegExp('"',"ug"),mn=[1105920,1112319];function gn(e,t){var n="".concat("data-fa-pseudo-element-pending").concat(t.replace(":","-"));return new Promise((function(r,i){if(null!==e.getAttribute(n))return r();var a=ke(e.children).filter((function(e){return e.getAttribute(H)===t}))[0],o=O.getComputedStyle(e,t),s=o.getPropertyValue("font-family").match(oe),u=o.getPropertyValue("font-weight"),l=o.getPropertyValue("content");if(a&&!s)return e.removeChild(a),r();if(s&&"none"!==l&&""!==l){var c=o.getPropertyValue("content"),h=~["Sharp"].indexOf(s[2])?J:K,f=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(s[2])?te[h][s[2].toLowerCase()]:se[h][u],d=function(e){var t=e.replace(vn,""),n=function(e,t){var n,r=e.length,i=e.charCodeAt(t);return i>=55296&&i<=56319&&r>t+1&&(n=e.charCodeAt(t+1))>=56320&&n<=57343?1024*(i-55296)+n-56320+65536:i}(t,0),r=n>=mn[0]&&n<=mn[1],i=2===t.length&&t[0]===t[1];return{value:Ge(i?t[0]:t),isSecondary:r||i}}(c),p=d.value,v=d.isSecondary,g=s[0].startsWith("FontAwesome"),y=st(f,p),b=y;if(g){var _=function(e){var t=tt[e],n=st("fas",e);return t||(n?{prefix:"fas",iconName:n}:null)||{prefix:null,iconName:null}}(p);_.iconName&&_.prefix&&(y=_.iconName,f=_.prefix)}if(!y||v||a&&a.getAttribute(W)===f&&a.getAttribute(Z)===b)r();else{e.setAttribute(n,b),a&&e.removeChild(a);var x={iconName:null,title:null,titleId:null,prefix:null,transform:Se,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}},w=x.extra;w.attributes[H]=t,Nt(y,f).then((function(i){var a=Ct(m(m({},x),{},{icons:{main:i,mask:{prefix:null,iconName:null,rest:[]}},prefix:f,iconName:b,extra:w,watchable:!0})),o=U.createElement("svg");"::before"===t?e.insertBefore(o,e.firstChild):e.appendChild(o),o.outerHTML=a.map((function(e){return ze(e)})).join("\n"),e.removeAttribute(n),r()})).catch(i)}}else r()}))}function yn(e){return Promise.all([gn(e,"::before"),gn(e,"::after")])}function bn(e){return e.parentNode!==document.head&&!~X.indexOf(e.tagName.toUpperCase())&&!e.getAttribute(H)&&(!e.parentNode||"svg"!==e.parentNode.tagName)}function _n(e){if(B)return new Promise((function(t,n){var r=ke(e.querySelectorAll("*")).filter(bn).map(yn),i=zt("searchPseudoElements");Yt(),Promise.all(r).then((function(){i(),Kt(),t()})).catch((function(){i(),Kt(),n()}))}))}var xn={hooks:function(){return{mutationObserverCallbacks:function(e){return e.pseudoElementsCallback=_n,e}}},provides:function(e){e.pseudoElements2svg=function(e){var t=e.node,n=void 0===t?U:t;_e.searchPseudoElements&&_n(n)}}},wn=!1,Sn=function(e){return e.toLowerCase().split(" ").reduce((function(e,t){var n=t.toLowerCase().split("-"),r=n[0],i=n.slice(1).join("-");if(r&&"h"===i)return e.flipX=!0,e;if(r&&"v"===i)return e.flipY=!0,e;if(i=parseFloat(i),isNaN(i))return e;switch(r){case"grow":e.size=e.size+i;break;case"shrink":e.size=e.size-i;break;case"left":e.x=e.x-i;break;case"right":e.x=e.x+i;break;case"up":e.y=e.y-i;break;case"down":e.y=e.y+i;break;case"rotate":e.rotate=e.rotate+i}return e}),{size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0})},Mn={mixout:function(){return{parse:{transform:function(e){return Sn(e)}}}},hooks:function(){return{parseNodeAttributes:function(e,t){var n=t.getAttribute("data-fa-transform");return n&&(e.transform=Sn(n)),e}}},provides:function(e){e.generateAbstractTransformGrouping=function(e){var t=e.main,n=e.transform,r=e.containerWidth,i=e.iconWidth,a={transform:"translate(".concat(r/2," 256)")},o="translate(".concat(32*n.x,", ").concat(32*n.y,") "),s="scale(".concat(n.size/16*(n.flipX?-1:1),", ").concat(n.size/16*(n.flipY?-1:1),") "),u="rotate(".concat(n.rotate," 0 0)"),l={outer:a,inner:{transform:"".concat(o," ").concat(s," ").concat(u)},path:{transform:"translate(".concat(i/2*-1," -256)")}};return{tag:"g",attributes:m({},l.outer),children:[{tag:"g",attributes:m({},l.inner),children:[{tag:t.icon.tag,children:t.icon.children,attributes:m(m({},t.icon.attributes),l.path)}]}]}}}},kn={x:0,y:0,width:"100%",height:"100%"};function Tn(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.attributes&&(e.attributes.fill||t)&&(e.attributes.fill="black"),e}var En={hooks:function(){return{parseNodeAttributes:function(e,t){var n=t.getAttribute("data-fa-mask"),r=n?dt(n.split(" ").map((function(e){return e.trim()}))):{prefix:null,iconName:null,rest:[]};return r.prefix||(r.prefix=ct()),e.mask=r,e.maskId=t.getAttribute("data-fa-mask-id"),e}}},provides:function(e){e.generateAbstractMask=function(e){var t,n=e.children,r=e.attributes,i=e.main,a=e.mask,o=e.maskId,s=e.transform,u=i.width,l=i.icon,c=a.width,h=a.icon,f=function(e){var t=e.transform,n=e.containerWidth,r=e.iconWidth,i={transform:"translate(".concat(n/2," 256)")},a="translate(".concat(32*t.x,", ").concat(32*t.y,") "),o="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),s="rotate(".concat(t.rotate," 0 0)");return{outer:i,inner:{transform:"".concat(a," ").concat(o," ").concat(s)},path:{transform:"translate(".concat(r/2*-1," -256)")}}}({transform:s,containerWidth:c,iconWidth:u}),d={tag:"rect",attributes:m(m({},kn),{},{fill:"white"})},p=l.children?{children:l.children.map(Tn)}:{},v={tag:"g",attributes:m({},f.inner),children:[Tn(m({tag:l.tag,attributes:m(m({},l.attributes),f.path)},p))]},g={tag:"g",attributes:m({},f.outer),children:[v]},y="mask-".concat(o||Me()),b="clip-".concat(o||Me()),_={tag:"mask",attributes:m(m({},kn),{},{id:y,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[d,g]},x={tag:"defs",children:[{tag:"clipPath",attributes:{id:b},children:(t=h,"g"===t.tag?t.children:[t])},_]};return n.push(x,{tag:"rect",attributes:m({fill:"currentColor","clip-path":"url(#".concat(b,")"),mask:"url(#".concat(y,")")},kn)}),{children:n,attributes:r}}}},Cn={provides:function(e){var t=!1;O.matchMedia&&(t=O.matchMedia("(prefers-reduced-motion: reduce)").matches),e.missingIconAbstract=function(){var e=[],n={fill:"currentColor"},r={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};e.push({tag:"path",attributes:m(m({},n),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var i=m(m({},r),{},{attributeName:"opacity"}),a={tag:"circle",attributes:m(m({},n),{},{cx:"256",cy:"364",r:"28"}),children:[]};return t||a.children.push({tag:"animate",attributes:m(m({},r),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:m(m({},i),{},{values:"1;0;1;1;0;1;"})}),e.push(a),e.push({tag:"path",attributes:m(m({},n),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:t?[]:[{tag:"animate",attributes:m(m({},i),{},{values:"1;0;0;0;0;1;"})}]}),t||e.push({tag:"path",attributes:m(m({},n),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:m(m({},i),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:e}}}},An=[De,hn,fn,dn,pn,xn,{mixout:function(){return{dom:{unwatch:function(){Yt(),wn=!0}}}},hooks:function(){return{bootstrap:function(){Qt(bt("mutationObserverCallbacks",{}))},noAuto:function(){Jt&&Jt.disconnect()},watch:function(e){var t=e.observeMutationsRoot;wn?Kt():Qt(bt("mutationObserverCallbacks",{observeMutationsRoot:t}))}}}},Mn,En,Cn,{hooks:function(){return{parseNodeAttributes:function(e,t){var n=t.getAttribute("data-fa-symbol"),r=null!==n&&(""===n||n);return e.symbol=r,e}}}}];!function(e,t){var n=t.mixoutsTo;vt=e,mt={},Object.keys(gt).forEach((function(e){-1===yt.indexOf(e)&&delete gt[e]})),vt.forEach((function(e){var t=e.mixout?e.mixout():{};if(Object.keys(t).forEach((function(e){"function"===typeof t[e]&&(n[e]=t[e]),"object"===g(t[e])&&Object.keys(t[e]).forEach((function(r){n[e]||(n[e]={}),n[e][r]=t[e][r]}))})),e.hooks){var r=e.hooks();Object.keys(r).forEach((function(e){mt[e]||(mt[e]=[]),mt[e].push(r[e])}))}e.provides&&e.provides(gt)}))}(An,{mixoutsTo:kt});var Rn=kt.parse,Pn=kt.icon,Ln=n(2007),Dn=n.n(Ln);function Nn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function In(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nn(Object(n),!0).forEach((function(t){Un(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function On(e){return On="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},On(e)}function Un(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fn(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function zn(e){return function(e){if(Array.isArray(e))return Bn(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return Bn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Bn(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Bn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Vn(e){return t=e,(t-=0)===t?e:(e=e.replace(/[\-_\s]+(.)?/g,(function(e,t){return t?t.toUpperCase():""}))).substr(0,1).toLowerCase()+e.substr(1);var t}var Gn=["style"];function jn(e){return e.split(";").map((function(e){return e.trim()})).filter((function(e){return e})).reduce((function(e,t){var n,r=t.indexOf(":"),i=Vn(t.slice(0,r)),a=t.slice(r+1).trim();return i.startsWith("webkit")?e[(n=i,n.charAt(0).toUpperCase()+n.slice(1))]=a:e[i]=a,e}),{})}var Hn=!1;try{Hn=!0}catch(_2){}function Wn(e){return e&&"object"===On(e)&&e.prefix&&e.iconName&&e.icon?e:Rn.icon?Rn.icon(e):null===e?null:e&&"object"===On(e)&&e.prefix&&e.iconName?e:Array.isArray(e)&&2===e.length?{prefix:e[0],iconName:e[1]}:"string"===typeof e?{prefix:"fas",iconName:e}:void 0}function Zn(e,t){return Array.isArray(t)&&t.length>0||!Array.isArray(t)&&t?Un({},e,t):{}}var qn=t.forwardRef((function(e,t){var n=e.icon,r=e.mask,i=e.symbol,a=e.className,o=e.title,s=e.titleId,u=e.maskId,l=Wn(n),c=Zn("classes",[].concat(zn(function(e){var t,n=e.beat,r=e.fade,i=e.beatFade,a=e.bounce,o=e.shake,s=e.flash,u=e.spin,l=e.spinPulse,c=e.spinReverse,h=e.pulse,f=e.fixedWidth,d=e.inverse,p=e.border,v=e.listItem,m=e.flip,g=e.size,y=e.rotation,b=e.pull,_=(Un(t={"fa-beat":n,"fa-fade":r,"fa-beat-fade":i,"fa-bounce":a,"fa-shake":o,"fa-flash":s,"fa-spin":u,"fa-spin-reverse":c,"fa-spin-pulse":l,"fa-pulse":h,"fa-fw":f,"fa-inverse":d,"fa-border":p,"fa-li":v,"fa-flip":!0===m,"fa-flip-horizontal":"horizontal"===m||"both"===m,"fa-flip-vertical":"vertical"===m||"both"===m},"fa-".concat(g),"undefined"!==typeof g&&null!==g),Un(t,"fa-rotate-".concat(y),"undefined"!==typeof y&&null!==y&&0!==y),Un(t,"fa-pull-".concat(b),"undefined"!==typeof b&&null!==b),Un(t,"fa-swap-opacity",e.swapOpacity),t);return Object.keys(_).map((function(e){return _[e]?e:null})).filter((function(e){return e}))}(e)),zn(a.split(" ")))),h=Zn("transform","string"===typeof e.transform?Rn.transform(e.transform):e.transform),f=Zn("mask",Wn(r)),d=Pn(l,In(In(In(In({},c),h),f),{},{symbol:i,title:o,titleId:s,maskId:u}));if(!d)return function(){var e;!Hn&&console&&"function"===typeof console.error&&(e=console).error.apply(e,arguments)}("Could not find icon",l),null;var p=d.abstract,v={ref:t};return Object.keys(e).forEach((function(t){qn.defaultProps.hasOwnProperty(t)||(v[t]=e[t])})),Yn(p[0],v)}));qn.displayName="FontAwesomeIcon",qn.propTypes={beat:Dn().bool,border:Dn().bool,beatFade:Dn().bool,bounce:Dn().bool,className:Dn().string,fade:Dn().bool,flash:Dn().bool,mask:Dn().oneOfType([Dn().object,Dn().array,Dn().string]),maskId:Dn().string,fixedWidth:Dn().bool,inverse:Dn().bool,flip:Dn().oneOf([!0,!1,"horizontal","vertical","both"]),icon:Dn().oneOfType([Dn().object,Dn().array,Dn().string]),listItem:Dn().bool,pull:Dn().oneOf(["right","left"]),pulse:Dn().bool,rotation:Dn().oneOf([0,90,180,270]),shake:Dn().bool,size:Dn().oneOf(["2xs","xs","sm","lg","xl","2xl","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"]),spin:Dn().bool,spinPulse:Dn().bool,spinReverse:Dn().bool,symbol:Dn().oneOfType([Dn().bool,Dn().string]),title:Dn().string,titleId:Dn().string,transform:Dn().oneOfType([Dn().string,Dn().object]),swapOpacity:Dn().bool},qn.defaultProps={border:!1,className:"",mask:null,maskId:null,fixedWidth:!1,inverse:!1,flip:!1,icon:null,listItem:!1,pull:null,pulse:!1,rotation:null,size:null,spin:!1,spinPulse:!1,spinReverse:!1,beat:!1,fade:!1,beatFade:!1,bounce:!1,shake:!1,symbol:!1,title:"",titleId:null,transform:null,swapOpacity:!1};var Xn,Yn=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("string"===typeof n)return n;var i=(n.children||[]).map((function(n){return e(t,n)})),a=Object.keys(n.attributes||{}).reduce((function(e,t){var r=n.attributes[t];switch(t){case"class":e.attrs.className=r,delete n.attributes.class;break;case"style":e.attrs.style=jn(r);break;default:0===t.indexOf("aria-")||0===t.indexOf("data-")?e.attrs[t.toLowerCase()]=r:e.attrs[Vn(t)]=r}return e}),{attrs:{}}),o=r.style,s=void 0===o?{}:o,u=Fn(r,Gn);return a.attrs.style=In(In({},a.attrs.style),s),t.apply(void 0,[n.tag,In(In({},a.attrs),u)].concat(zn(i)))}.bind(null,t.createElement),Kn={prefix:"fas",iconName:"trash-can",icon:[448,512,[61460,"trash-alt"],"f2ed","M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z"]},Jn=Kn,Qn={prefix:"fas",iconName:"pause",icon:[320,512,[9208],"f04c","M48 64C21.5 64 0 85.5 0 112V400c0 26.5 21.5 48 48 48H80c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48H48zm192 0c-26.5 0-48 21.5-48 48V400c0 26.5 21.5 48 48 48h32c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48H240z"]},$n={prefix:"fas",iconName:"question",icon:[320,512,[10067,10068,61736],"3f","M80 160c0-35.3 28.7-64 64-64h32c35.3 0 64 28.7 64 64v3.6c0 21.8-11.1 42.1-29.4 53.8l-42.2 27.1c-25.2 16.2-40.4 44.1-40.4 74V320c0 17.7 14.3 32 32 32s32-14.3 32-32v-1.4c0-8.2 4.2-15.8 11-20.2l42.2-27.1c36.6-23.6 58.8-64.1 58.8-107.7V160c0-70.7-57.3-128-128-128H144C73.3 32 16 89.3 16 160c0 17.7 14.3 32 32 32s32-14.3 32-32zm80 320a40 40 0 1 0 0-80 40 40 0 1 0 0 80z"]},er={prefix:"fas",iconName:"rotate-right",icon:[512,512,["redo-alt","rotate-forward"],"f2f9","M463.5 224H472c13.3 0 24-10.7 24-24V72c0-9.7-5.8-18.5-14.8-22.2s-19.3-1.7-26.2 5.2L413.4 96.6c-87.6-86.5-228.7-86.2-315.8 1c-87.5 87.5-87.5 229.3 0 316.8s229.3 87.5 316.8 0c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0c-62.5 62.5-163.8 62.5-226.3 0s-62.5-163.8 0-226.3c62.2-62.2 162.7-62.5 225.3-1L327 183c-6.9 6.9-8.9 17.2-5.2 26.2s12.5 14.8 22.2 14.8H463.5z"]},tr={prefix:"fas",iconName:"play",icon:[384,512,[9654],"f04b","M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"]},nr={prefix:"fas",iconName:"xmark",icon:[384,512,[128473,10005,10006,10060,215,"close","multiply","remove","times"],"f00d","M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"]},rr=n(184);function ir(e){var t="string"===typeof e?{page:e}:e,n=t.page.replaceAll(" ",""),r=function(e){return e.page===Xn.None?null:e.page===Xn.Home?(0,rr.jsxs)("div",{children:[(0,rr.jsx)("h1",{children:"Motion Comparator"}),(0,rr.jsx)("p",{children:"Motion Comparator is a web-based tool that help you visualize, understand, compare, and communicate robot motion data. "}),(0,rr.jsx)("br",{}),(0,rr.jsx)("h3",{children:"Key Features"}),(0,rr.jsxs)("ul",{children:[(0,rr.jsx)("li",{children:"3D scenes"}),(0,rr.jsx)("li",{children:"Time-series plots"}),(0,rr.jsx)("li",{children:"Scrubbale timeline bar"}),(0,rr.jsx)("li",{children:"Object trace in Cartesian space"}),(0,rr.jsx)("li",{children:"Quaternion trace to encode an object's orientations"}),(0,rr.jsx)("li",{children:"UMAP graph of robot joint states"}),(0,rr.jsx)("li",{children:"Time warping to temporally align two motions"}),(0,rr.jsx)("li",{children:"Juxtaposition, superposition, and explicit encoding designs"}),(0,rr.jsx)("li",{children:"Sharable layout"})]}),(0,rr.jsx)("br",{}),(0,rr.jsx)("h3",{children:"  Panels "}),"Panels are modular visualization interfaces that can be configured and arranged into customizable layouts. Each panel have its own help page.",(0,rr.jsxs)("ul",{children:[(0,rr.jsxs)("li",{children:[ar(Xn.LoadAndSavePanel,"Load&Save panel")," loads or saves motion data.  "]}),(0,rr.jsxs)("li",{children:[ar(Xn.SelectionPanel,"Selection panel")," serves as a road map of all loaded motions. You can create 3D scenes, traces, and various visualization using this panel."]}),(0,rr.jsxs)("li",{children:[ar(Xn.GraphPanel,"Graph panel")," visualizes robot motion in time-series plots."]}),(0,rr.jsxs)("li",{children:[ar(Xn.GraphOptionPanel,"Graph option panel")," customizes the graph panel."]}),(0,rr.jsxs)("li",{children:[ar(Xn.SceneOptionPanel,"3D scene option panel")," customizes the 3D scene, e.g., lighting, background color, or specifiy time-warping objectives."]}),(0,rr.jsxs)("li",{children:[ar(Xn.RobotOptionPanel,"Robot option panel")," customizes the robot or in a 3D scene."]})]}),(0,rr.jsx)("br",{}),(0,rr.jsx)("h3",{children:" Customizable Layout "}),"[Some gifs to show how to customize layout]"]}):e.page===Xn.SelectionPanel?(0,rr.jsxs)("div",{children:[(0,rr.jsx)("h1",{children:"Selection Panel"}),(0,rr.jsx)("p",{children:ar(Xn.Home,"Home")}),(0,rr.jsx)("p",{children:" This panel lists out all motion data in the workspace. Each motion data may involve multiple robots or objects. "}),(0,rr.jsx)("h3",{children:" Open a 3D scene "}),(0,rr.jsx)("p",{children:" You can visualize a motion in a 3D scene by clicking and draging the motion name. "}),"[A gif to show how to open a 3D scene]",(0,rr.jsx)("h3",{children:" Add a ghost robot a 3D scene "}),(0,rr.jsx)("p",{children:" You can a ghost robot by clicking and draging the robot name. "}),"[A gif to show how to add a ghost robot]",(0,rr.jsx)("h3",{children:" Add a trace "}),(0,rr.jsx)("p",{children:" You can add a trace of a robot part or an object by clicking and draging its name. "}),"[A gif to show how to add a trace]"]}):e.page===Xn.GraphPanel?(0,rr.jsxs)("div",{children:[(0,rr.jsx)("h1",{children:"Graph Panel"}),(0,rr.jsx)("p",{children:ar(Xn.Home,"Home")}),(0,rr.jsx)("p",{children:" This panel contains time-series plots. "}),(0,rr.jsx)("h3",{children:" Add a line"}),(0,rr.jsxs)("p",{children:[" You can add a line by clicking and draging a robot part or an object from the ",ar(Xn.SelectionPanel,"Selection Panel"),". "]}),"[A gif to show how to add a line]",(0,rr.jsx)("h3",{children:" Open a legend "}),"[a gif to show how to click and drag to open a legend]."]}):e.page===Xn.SceneOptionPanel?(0,rr.jsx)("div",{}):e.page===Xn.LoadAndSavePanel?(0,rr.jsxs)("div",{children:[(0,rr.jsx)("h1",{children:"Load and Save Panel"}),(0,rr.jsx)("p",{children:ar(Xn.Home,"Home")}),(0,rr.jsx)("h3",{children:" Workspace "}),(0,rr.jsx)("h3",{children:" Robot motions "})]}):e.page===Xn.LoadingStarted?(0,rr.jsx)("div",{className:"LoadingMessage",children:(0,rr.jsxs)("p",{children:["Loading workspace",". Please wait a few seconds..."]})}):e.page===Xn.LoadingSuccess?null:e.page===Xn.LoadingFailed?(0,rr.jsx)("div",{className:"LoadingFailed",children:(0,rr.jsxs)("p",{children:["Failed to load workspace",e.location?"from ".concat(e.location):null,"."]})}):(lr.error('popupHelpPageContent missed a case: "'.concat(e,'"')),null)}(t);return null===r?(0,rr.jsx)(rr.Fragment,{}):(0,rr.jsxs)("div",{children:[(0,rr.jsxs)("div",{className:"HelpPopup HelpPopup-".concat(n),children:[t.page!==Xn.LoadingStarted&&(0,rr.jsx)("button",{className:"Xmark",onClick:function(){return lr.setPopupHelpPage(Xn.None)},children:(0,rr.jsx)(qn,{icon:nr})}),(0,rr.jsx)("div",{className:"content",children:r})]}),(0,rr.jsx)("div",{className:"overlay"})]})}function ar(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r="string"===typeof e?e:e.page;return(0,rr.jsx)("button",{className:n,onClick:function(){return lr.setPopupHelpPage(e)},children:t||r})}!function(e){e.None="None",e.Home="Home Page",e.LoadAndSavePanel="Load and Save Panel",e.DifferenceGraphPanel="Difference Graph Panel",e.GraphOptionPanel="Graph Option Panel",e.GraphPanel="Graph Panel",e.UmapGraphOptionPanel="Umap Graph Option Panel",e.UmapGraphPanel="Umap Graph Panel",e.TimeWarpedGraphPanel="Time Warped Graph Panel",e.SelectionPanel="Selection Panel",e.RobotOptionPanel="Robot Option Panel",e.QSceneOptionPanel="QScene Option Panel",e.SceneOptionPanel="Scene Option Panel",e.LoadingStarted="Loading Started",e.LoadingFailed="Loading Failed",e.LoadingSuccess="Loading Success"}(Xn||(Xn={}));var or=60,sr=(0,l.Z)((function e(){(0,u.Z)(this,e)}));sr.INIT="INIT",sr.VIEW_LOAD="VIEW_LOAD";var ur=(0,l.Z)((function e(){(0,u.Z)(this,e)}));ur.BUILD_PAGE="BUILD_PAGE",ur.VIEW_PAGE="VIEW_PAGE";var lr=new(function(){function e(){(0,u.Z)(this,e),this._app=void 0}return(0,l.Z)(e,[{key:"setApp",value:function(e){this._app=e}},{key:"app",value:function(){return this._app}},{key:"popupHelpPage",value:function(){return this._app?this._app.popupHelpPage():{page:Xn.None}}},{key:"setPopupHelpPage",value:function(e){this._app&&this._app.setPopupHelpPage(e)}},{key:"warn",value:function(e){this._app?this._app.warn(e):console.warn(e)}},{key:"assert",value:function(e,t){if(!1===e)throw lr.error(t),new d.AssertionError({message:t})}},{key:"error",value:function(e){this._app?this._app.error(e):console.error(e)}},{key:"recalculateTimeWarping",value:function(){void 0!==this._app&&this._app.recalculateTimeWarping()}},{key:"updateUI",value:function(){void 0!==this._app&&this._app.updateUI()}},{key:"disallowUpdateUI",value:function(){void 0!==this._app&&this._app.disallowUpdateUI()}},{key:"allowUpdateUI",value:function(){void 0!==this._app&&this._app.allowUpdateUI()}},{key:"render",value:function(){void 0!==this._app&&this._app.renderScenes()}},{key:"addAnimationTable",value:function(e){void 0!==this._app&&this._app.robotSceneManager().addAnimationTable(e)}},{key:"removeAnimationTable",value:function(e){void 0!==this._app&&this._app.robotSceneManager().removeAnimationTable(e)}}]),e}());function cr(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var hr=n(1002);function fr(){fr=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var a=t&&t.prototype instanceof m?t:m,o=Object.create(a.prototype),s=new A(r||[]);return i(o,"_invoke",{value:k(e,n,s)}),o}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=c;var f="suspendedStart",d="executing",p="completed",v={};function m(){}function g(){}function y(){}var b={};l(b,o,(function(){return this}));var _=Object.getPrototypeOf,x=_&&_(_(R([])));x&&x!==n&&r.call(x,o)&&(b=x);var w=y.prototype=m.prototype=Object.create(b);function S(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function M(e,t){function n(i,a,o,s){var u=h(e[i],e,a);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==(0,hr.Z)(c)&&r.call(c,"__await")?t.resolve(c.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(c).then((function(e){l.value=e,o(l)}),(function(e){return n("throw",e,o,s)}))}s(u.arg)}var a;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return a=a?a.then(i,i):i()}})}function k(t,n,r){var i=f;return function(a,o){if(i===d)throw new Error("Generator is already running");if(i===p){if("throw"===a)throw o;return{value:e,done:!0}}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var u=T(s,r);if(u){if(u===v)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=d;var l=h(t,n,r);if("normal"===l.type){if(i=r.done?p:"suspendedYield",l.arg===v)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(i=p,r.method="throw",r.arg=l.arg)}}}function T(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,T(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var a=h(i,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,v;var o=a.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function R(t){if(t||""===t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError((0,hr.Z)(t)+" is not iterable")}return g.prototype=y,i(w,"constructor",{value:y,configurable:!0}),i(y,"constructor",{value:g,configurable:!0}),g.displayName=l(y,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,l(e,u,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},S(M.prototype),l(M.prototype,s,(function(){return this})),t.AsyncIterator=M,t.async=function(e,n,r,i,a){void 0===a&&(a=Promise);var o=new M(c(e,n,r,i),a);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},S(w),l(w,u,"Generator"),l(w,o,(function(){return this})),l(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=R,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(C),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(u&&l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;C(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:R(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),v}},t}function dr(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(l){return void n(l)}s.done?t(u):Promise.resolve(u).then(r,i)}function pr(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){dr(a,r,i,o,s,"next",e)}function s(e){dr(a,r,i,o,s,"throw",e)}o(void 0)}))}}function vr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],u=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return s}}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var mr=n(9142);function gr(e,t,n){return(t=(0,mr.Z)(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var yr,br=n(2963),_r=n(1120);function xr(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=(0,_r.Z)(e)););return e}function wr(){return wr="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=xr(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},wr.apply(this,arguments)}function Sr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Mr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sr(Object(n),!0).forEach((function(t){gr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}for(var kr="135",Tr={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Er={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Cr=0,Ar=1,Rr=2,Pr=3,Lr=0,Dr=1,Nr=2,Ir=3,Or=0,Ur=1,Fr=2,zr=1,Br=2,Vr=0,Gr=1,jr=2,Hr=3,Wr=4,Zr=5,qr=100,Xr=101,Yr=102,Kr=103,Jr=104,Qr=200,$r=201,ei=202,ti=203,ni=204,ri=205,ii=206,ai=207,oi=208,si=209,ui=210,li=0,ci=1,hi=2,fi=3,di=4,pi=5,vi=6,mi=7,gi=0,yi=1,bi=2,_i=0,xi=1,wi=2,Si=3,Mi=4,ki=5,Ti=300,Ei=301,Ci=302,Ai=303,Ri=304,Pi=306,Li=307,Di=1e3,Ni=1001,Ii=1002,Oi=1003,Ui=1004,Fi=1004,zi=1005,Bi=1005,Vi=1006,Gi=1007,ji=1007,Hi=1008,Wi=1008,Zi=1009,qi=1010,Xi=1011,Yi=1012,Ki=1013,Ji=1014,Qi=1015,$i=1016,ea=1017,ta=1018,na=1019,ra=1020,ia=1021,aa=1022,oa=1023,sa=1024,ua=1025,la=oa,ca=1026,ha=1027,fa=1028,da=1029,pa=1030,va=1031,ma=1032,ga=1033,ya=33776,ba=33777,_a=33778,xa=33779,wa=35840,Sa=35841,Ma=35842,ka=35843,Ta=36196,Ea=37492,Ca=37496,Aa=37808,Ra=37809,Pa=37810,La=37811,Da=37812,Na=37813,Ia=37814,Oa=37815,Ua=37816,Fa=37817,za=37818,Ba=37819,Va=37820,Ga=37821,ja=36492,Ha=37840,Wa=37841,Za=37842,qa=37843,Xa=37844,Ya=37845,Ka=37846,Ja=37847,Qa=37848,$a=37849,eo=37850,to=37851,no=37852,ro=37853,io=2200,ao=2201,oo=2202,so=2300,uo=2301,lo=2302,co=2400,ho=2401,fo=2402,po=2500,vo=2501,mo=0,go=1,yo=2,bo=3e3,_o=3001,xo=3007,wo=3002,So=3004,Mo=3005,ko=3006,To=3200,Eo=3201,Co=0,Ao=1,Ro=0,Po=7680,Lo=7681,Do=7682,No=7683,Io=34055,Oo=34056,Uo=5386,Fo=512,zo=513,Bo=514,Vo=515,Go=516,jo=517,Ho=518,Wo=519,Zo=35044,qo=35048,Xo=35040,Yo=35045,Ko=35049,Jo=35041,Qo=35046,$o=35050,es=35042,ts="100",ns="300 es",rs=function(){function e(){(0,u.Z)(this,e)}return(0,l.Z)(e,[{key:"addEventListener",value:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}},{key:"hasEventListener",value:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}},{key:"removeEventListener",value:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}}},{key:"dispatchEvent",value:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=t.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,e);e.target=null}}}}]),e}(),is=[],as=0;as<256;as++)is[as]=(as<16?"0":"")+as.toString(16);var os=1234567,ss=Math.PI/180,us=180/Math.PI;function ls(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(is[255&e]+is[e>>8&255]+is[e>>16&255]+is[e>>24&255]+"-"+is[255&t]+is[t>>8&255]+"-"+is[t>>16&15|64]+is[t>>24&255]+"-"+is[63&n|128]+is[n>>8&255]+"-"+is[n>>16&255]+is[n>>24&255]+is[255&r]+is[r>>8&255]+is[r>>16&255]+is[r>>24&255]).toUpperCase()}function cs(e,t,n){return Math.max(t,Math.min(n,e))}function hs(e,t){return(e%t+t)%t}function fs(e,t,n){return(1-n)*e+n*t}function ds(e){return 0===(e&e-1)&&0!==e}function ps(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function vs(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}var ms=Object.freeze({__proto__:null,DEG2RAD:ss,RAD2DEG:us,generateUUID:ls,clamp:cs,euclideanModulo:hs,mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:fs,damp:function(e,t,n,r){return fs(e,t,1-Math.exp(-n*r))},pingpong:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(hs(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){return void 0!==e&&(os=e%2147483647),((os=16807*os%2147483647)-1)/2147483646},degToRad:function(e){return e*ss},radToDeg:function(e){return e*us},isPowerOfTwo:ds,ceilPowerOfTwo:ps,floorPowerOfTwo:vs,setQuaternionFromProperEuler:function(e,t,n,r,i){var a=Math.cos,o=Math.sin,s=a(n/2),u=o(n/2),l=a((t+r)/2),c=o((t+r)/2),h=a((t-r)/2),f=o((t-r)/2),d=a((r-t)/2),p=o((r-t)/2);switch(i){case"XYX":e.set(s*c,u*h,u*f,s*l);break;case"YZY":e.set(u*f,s*c,u*h,s*l);break;case"ZXZ":e.set(u*h,u*f,s*c,s*l);break;case"XZX":e.set(s*c,u*p,u*d,s*l);break;case"YXY":e.set(u*d,s*c,u*p,s*l);break;case"ZYZ":e.set(u*p,u*d,s*c,s*l);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}}),gs=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,u.Z)(this,t),this.x=e,this.y=n}return(0,l.Z)(t,[{key:"width",get:function(){return this.x},set:function(e){this.x=e}},{key:"height",get:function(){return this.y},set:function(e){this.y=e}},{key:"set",value:function(e,t){return this.x=e,this.y=t,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this}},{key:"add",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}},{key:"sub",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y}},{key:"cross",value:function(e){return this.x*e.y-this.y*e.x}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"angle",value:function(){var e=Math.atan2(-this.y,-this.x)+Math.PI;return e}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n}},{key:"manhattanDistanceTo",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}},{key:"fromBufferAttribute",value:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}},{key:"rotateAround",value:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*n-a*r+e.x,this.y=i*r+a*n+e.y,this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this}},{key:e,value:fr().mark((function e(){return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.x;case 2:return e.next=4,this.y;case 4:case"end":return e.stop()}}),e,this)}))}]),t}(Symbol.iterator);gs.prototype.isVector2=!0;var ys=function(){function e(){(0,u.Z)(this,e),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}return(0,l.Z)(e,[{key:"set",value:function(e,t,n,r,i,a,o,s,u){var l=this.elements;return l[0]=e,l[1]=r,l[2]=o,l[3]=t,l[4]=i,l[5]=s,l[6]=n,l[7]=a,l[8]=u,this}},{key:"identity",value:function(){return this.set(1,0,0,0,1,0,0,0,1),this}},{key:"copy",value:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}},{key:"extractBasis",value:function(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}},{key:"setFromMatrix4",value:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}},{key:"multiply",value:function(e){return this.multiplyMatrices(this,e)}},{key:"premultiply",value:function(e){return this.multiplyMatrices(e,this)}},{key:"multiplyMatrices",value:function(e,t){var n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[3],s=n[6],u=n[1],l=n[4],c=n[7],h=n[2],f=n[5],d=n[8],p=r[0],v=r[3],m=r[6],g=r[1],y=r[4],b=r[7],_=r[2],x=r[5],w=r[8];return i[0]=a*p+o*g+s*_,i[3]=a*v+o*y+s*x,i[6]=a*m+o*b+s*w,i[1]=u*p+l*g+c*_,i[4]=u*v+l*y+c*x,i[7]=u*m+l*b+c*w,i[2]=h*p+f*g+d*_,i[5]=h*v+f*y+d*x,i[8]=h*m+f*b+d*w,this}},{key:"multiplyScalar",value:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}},{key:"determinant",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],l=e[8];return t*a*l-t*o*u-n*i*l+n*o*s+r*i*u-r*a*s}},{key:"invert",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],l=e[8],c=l*a-o*u,h=o*s-l*i,f=u*i-a*s,d=t*c+n*h+r*f;if(0===d)return this.set(0,0,0,0,0,0,0,0,0);var p=1/d;return e[0]=c*p,e[1]=(r*u-l*n)*p,e[2]=(o*n-r*a)*p,e[3]=h*p,e[4]=(l*t-r*s)*p,e[5]=(r*i-o*t)*p,e[6]=f*p,e[7]=(n*s-u*t)*p,e[8]=(a*t-n*i)*p,this}},{key:"transpose",value:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}},{key:"getNormalMatrix",value:function(e){return this.setFromMatrix4(e).invert().transpose()}},{key:"transposeIntoArray",value:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}},{key:"setUvTransform",value:function(e,t,n,r,i,a,o){var s=Math.cos(i),u=Math.sin(i);return this.set(n*s,n*u,-n*(s*a+u*o)+a+e,-r*u,r*s,-r*(-u*a+s*o)+o+t,0,0,1),this}},{key:"scale",value:function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}},{key:"rotate",value:function(e){var t=Math.cos(e),n=Math.sin(e),r=this.elements,i=r[0],a=r[3],o=r[6],s=r[1],u=r[4],l=r[7];return r[0]=t*i+n*s,r[3]=t*a+n*u,r[6]=t*o+n*l,r[1]=-n*i+t*s,r[4]=-n*a+t*u,r[7]=-n*o+t*l,this}},{key:"translate",value:function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}},{key:"equals",value:function(e){for(var t=this.elements,n=e.elements,r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<9;n++)this.elements[n]=e[n+t];return this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}},{key:"clone",value:function(){return(new this.constructor).fromArray(this.elements)}}]),e}();function bs(e){if(0===e.length)return-1/0;for(var t=e[0],n=1,r=e.length;n<r;++n)e[n]>t&&(t=e[n]);return t}ys.prototype.isMatrix3=!0;var _s,xs={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function ws(e,t){return new xs[e](t)}function Ss(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function Ms(e){for(var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=3735928559^n,i=1103547991^n,a=0;a<e.length;a++)t=e.charCodeAt(a),r=Math.imul(r^t,2654435761),i=Math.imul(i^t,1597334677);return r=Math.imul(r^r>>>16,2246822507)^Math.imul(i^i>>>13,3266489909),4294967296*(2097151&(i=Math.imul(i^i>>>16,2246822507)^Math.imul(r^r>>>13,3266489909)))+(r>>>0)}var ks=function(){function e(){(0,u.Z)(this,e)}return(0,l.Z)(e,null,[{key:"getDataURL",value:function(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;var t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===_s&&(_s=Ss("canvas")),_s.width=e.width,_s.height=e.height;var n=_s.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=_s}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}}]),e}(),Ts=0,Es=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.DEFAULT_IMAGE,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.DEFAULT_MAPPING,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ni,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ni,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Vi,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Hi,h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:oa,f=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Zi,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,p=arguments.length>9&&void 0!==arguments[9]?arguments[9]:bo;return(0,u.Z)(this,n),e=t.call(this),Object.defineProperty((0,c.Z)(e),"id",{value:Ts++}),e.uuid=ls(),e.name="",e.image=r,e.mipmaps=[],e.mapping=i,e.wrapS=a,e.wrapT=o,e.magFilter=s,e.minFilter=l,e.anisotropy=d,e.format=h,e.internalFormat=null,e.type=f,e.offset=new gs(0,0),e.repeat=new gs(1,1),e.center=new gs(0,0),e.rotation=0,e.matrixAutoUpdate=!0,e.matrix=new ys,e.generateMipmaps=!0,e.premultiplyAlpha=!1,e.flipY=!0,e.unpackAlignment=4,e.encoding=p,e.userData={},e.version=0,e.onUpdate=null,e.isRenderTargetTexture=!1,e}return(0,l.Z)(n,[{key:"updateMatrix",value:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this}},{key:"toJSON",value:function(e){var t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=ls()),!t&&void 0===e.images[r.uuid]){var i;if(Array.isArray(r)){i=[];for(var a=0,o=r.length;a<o;a++)r[a].isDataTexture?i.push(Cs(r[a].image)):i.push(Cs(r[a]))}else i=Cs(r);e.images[r.uuid]={uuid:r.uuid,url:i}}n.image=r.uuid}return"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}},{key:"transformUv",value:function(e){if(this.mapping!==Ti)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Di:e.x=e.x-Math.floor(e.x);break;case Ni:e.x=e.x<0?0:1;break;case Ii:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case Di:e.y=e.y-Math.floor(e.y);break;case Ni:e.y=e.y<0?0:1;break;case Ii:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}}]),n}(rs);function Cs(e){return"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap?ks.getDataURL(e):e.data?{data:Array.prototype.slice.call(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}Es.DEFAULT_IMAGE=void 0,Es.DEFAULT_MAPPING=Ti,Es.prototype.isTexture=!0;var As=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;(0,u.Z)(this,t),this.x=e,this.y=n,this.z=r,this.w=i}return(0,l.Z)(t,[{key:"width",get:function(){return this.z},set:function(e){this.z=e}},{key:"height",get:function(){return this.w},set:function(e){this.w=e}},{key:"set",value:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setW",value:function(e){return this.w=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z,this.w)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}},{key:"add",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}},{key:"sub",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,r=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*i,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"setAxisAngleFromQuaternion",value:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}},{key:"setAxisAngleFromRotationMatrix",value:function(e){var t,n,r,i,a=.01,o=.1,s=e.elements,u=s[0],l=s[4],c=s[8],h=s[1],f=s[5],d=s[9],p=s[2],v=s[6],m=s[10];if(Math.abs(l-h)<a&&Math.abs(c-p)<a&&Math.abs(d-v)<a){if(Math.abs(l+h)<o&&Math.abs(c+p)<o&&Math.abs(d+v)<o&&Math.abs(u+f+m-3)<o)return this.set(1,0,0,0),this;t=Math.PI;var g=(u+1)/2,y=(f+1)/2,b=(m+1)/2,_=(l+h)/4,x=(c+p)/4,w=(d+v)/4;return g>y&&g>b?g<a?(n=0,r=.707106781,i=.707106781):(r=_/(n=Math.sqrt(g)),i=x/n):y>b?y<a?(n=.707106781,r=0,i=.707106781):(n=_/(r=Math.sqrt(y)),i=w/r):b<a?(n=.707106781,r=.707106781,i=0):(n=x/(i=Math.sqrt(b)),r=w/i),this.set(n,r,i,t),this}var S=Math.sqrt((v-d)*(v-d)+(c-p)*(c-p)+(h-l)*(h-l));return Math.abs(S)<.001&&(S=1),this.x=(v-d)/S,this.y=(c-p)/S,this.z=(h-l)/S,this.w=Math.acos((u+f+m-1)/2),this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}},{key:"fromBufferAttribute",value:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}},{key:e,value:fr().mark((function e(){return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.x;case 2:return e.next=4,this.y;case 4:return e.next=6,this.z;case 6:return e.next=8,this.w;case 8:case"end":return e.stop()}}),e,this)}))}]),t}(Symbol.iterator);As.prototype.isVector4=!0;var Rs=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,u.Z)(this,n),(i=t.call(this)).width=e,i.height=r,i.depth=1,i.scissor=new As(0,0,e,r),i.scissorTest=!1,i.viewport=new As(0,0,e,r),i.texture=new Es(void 0,a.mapping,a.wrapS,a.wrapT,a.magFilter,a.minFilter,a.format,a.type,a.anisotropy,a.encoding),i.texture.isRenderTargetTexture=!0,i.texture.image={width:e,height:r,depth:1},i.texture.generateMipmaps=void 0!==a.generateMipmaps&&a.generateMipmaps,i.texture.internalFormat=void 0!==a.internalFormat?a.internalFormat:null,i.texture.minFilter=void 0!==a.minFilter?a.minFilter:Vi,i.depthBuffer=void 0===a.depthBuffer||a.depthBuffer,i.stencilBuffer=void 0!==a.stencilBuffer&&a.stencilBuffer,i.depthTexture=void 0!==a.depthTexture?a.depthTexture:null,i}return(0,l.Z)(n,[{key:"setTexture",value:function(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}},{key:"setSize",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.width===e&&this.height===t&&this.depth===n||(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.image=Mr({},this.texture.image),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),n}(rs);Rs.prototype.isWebGLRenderTarget=!0;var Ps=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i){var a;(0,u.Z)(this,n);var o=(a=t.call(this,e,r)).texture;a.texture=[];for(var s=0;s<i;s++)a.texture[s]=o.clone();return a}return(0,l.Z)(n,[{key:"setSize",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(var r=0,i=this.texture.length;r<i;r++)this.texture[r].image.width=e,this.texture[r].image.height=t,this.texture[r].image.depth=n;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}},{key:"copy",value:function(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this.texture.length=0;for(var t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone();return this}}]),n}(Rs);Ps.prototype.isWebGLMultipleRenderTargets=!0;var Ls=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,u.Z)(this,n),(i=t.call(this,e,r,a)).samples=4,i.ignoreDepthForMultisampleCopy=void 0===a.ignoreDepth||a.ignoreDepth,i.useRenderToTexture=void 0!==a.useRenderToTexture&&a.useRenderToTexture,i.useRenderbuffer=!1===i.useRenderToTexture,i}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.samples=e.samples,this.useRenderToTexture=e.useRenderToTexture,this.useRenderbuffer=e.useRenderbuffer,this}}]),n}(Rs);Ls.prototype.isWebGLMultisampleRenderTarget=!0;var Ds=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;(0,u.Z)(this,e),this._x=t,this._y=n,this._z=r,this._w=i}return(0,l.Z)(e,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}},{key:"set",value:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._w)}},{key:"copy",value:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}},{key:"setFromEuler",value:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,r=e._y,i=e._z,a=e._order,o=Math.cos,s=Math.sin,u=o(n/2),l=o(r/2),c=o(i/2),h=s(n/2),f=s(r/2),d=s(i/2);switch(a){case"XYZ":this._x=h*l*c+u*f*d,this._y=u*f*c-h*l*d,this._z=u*l*d+h*f*c,this._w=u*l*c-h*f*d;break;case"YXZ":this._x=h*l*c+u*f*d,this._y=u*f*c-h*l*d,this._z=u*l*d-h*f*c,this._w=u*l*c+h*f*d;break;case"ZXY":this._x=h*l*c-u*f*d,this._y=u*f*c+h*l*d,this._z=u*l*d+h*f*c,this._w=u*l*c-h*f*d;break;case"ZYX":this._x=h*l*c-u*f*d,this._y=u*f*c+h*l*d,this._z=u*l*d-h*f*c,this._w=u*l*c+h*f*d;break;case"YZX":this._x=h*l*c+u*f*d,this._y=u*f*c+h*l*d,this._z=u*l*d-h*f*c,this._w=u*l*c-h*f*d;break;case"XZY":this._x=h*l*c-u*f*d,this._y=u*f*c-h*l*d,this._z=u*l*d+h*f*c,this._w=u*l*c+h*f*d;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!1!==t&&this._onChangeCallback(),this}},{key:"setFromAxisAngle",value:function(e,t){var n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(e){var t=e.elements,n=t[0],r=t[4],i=t[8],a=t[1],o=t[5],s=t[9],u=t[2],l=t[6],c=t[10],h=n+o+c;if(h>0){var f=.5/Math.sqrt(h+1);this._w=.25/f,this._x=(l-s)*f,this._y=(i-u)*f,this._z=(a-r)*f}else if(n>o&&n>c){var d=2*Math.sqrt(1+n-o-c);this._w=(l-s)/d,this._x=.25*d,this._y=(r+a)/d,this._z=(i+u)/d}else if(o>c){var p=2*Math.sqrt(1+o-n-c);this._w=(i-u)/p,this._x=(r+a)/p,this._y=.25*p,this._z=(s+l)/p}else{var v=2*Math.sqrt(1+c-n-o);this._w=(a-r)/v,this._x=(i+u)/v,this._y=(s+l)/v,this._z=.25*v}return this._onChangeCallback(),this}},{key:"setFromUnitVectors",value:function(e,t){var n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}},{key:"angleTo",value:function(e){return 2*Math.acos(Math.abs(cs(this.dot(e),-1,1)))}},{key:"rotateTowards",value:function(e,t){var n=this.angleTo(e);if(0===n)return this;var r=Math.min(1,t/n);return this.slerp(e,r),this}},{key:"identity",value:function(){return this.set(0,0,0,1)}},{key:"invert",value:function(){return this.conjugate()}},{key:"conjugate",value:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}},{key:"dot",value:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}},{key:"lengthSq",value:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}},{key:"length",value:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}},{key:"normalize",value:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}},{key:"premultiply",value:function(e){return this.multiplyQuaternions(e,this)}},{key:"multiplyQuaternions",value:function(e,t){var n=e._x,r=e._y,i=e._z,a=e._w,o=t._x,s=t._y,u=t._z,l=t._w;return this._x=n*l+a*o+r*u-i*s,this._y=r*l+a*s+i*o-n*u,this._z=i*l+a*u+n*s-r*o,this._w=a*l-n*o-r*s-i*u,this._onChangeCallback(),this}},{key:"slerp",value:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,r=this._y,i=this._z,a=this._w,o=a*e._w+n*e._x+r*e._y+i*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=n,this._y=r,this._z=i,this;var s=1-o*o;if(s<=Number.EPSILON){var u=1-t;return this._w=u*a+t*this._w,this._x=u*n+t*this._x,this._y=u*r+t*this._y,this._z=u*i+t*this._z,this.normalize(),this._onChangeCallback(),this}var l=Math.sqrt(s),c=Math.atan2(l,o),h=Math.sin((1-t)*c)/l,f=Math.sin(t*c)/l;return this._w=a*h+this._w*f,this._x=n*h+this._x*f,this._y=r*h+this._y*f,this._z=i*h+this._z*f,this._onChangeCallback(),this}},{key:"slerpQuaternions",value:function(e,t,n){this.copy(e).slerp(t,n)}},{key:"random",value:function(){var e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),r=2*Math.PI*Math.random(),i=2*Math.PI*Math.random();return this.set(t*Math.cos(r),n*Math.sin(i),n*Math.cos(i),t*Math.sin(r))}},{key:"equals",value:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}},{key:"fromBufferAttribute",value:function(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}},{key:"_onChange",value:function(e){return this._onChangeCallback=e,this}},{key:"_onChangeCallback",value:function(){}}],[{key:"slerp",value:function(e,t,n,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(e,t,r)}},{key:"slerpFlat",value:function(e,t,n,r,i,a,o){var s=n[r+0],u=n[r+1],l=n[r+2],c=n[r+3],h=i[a+0],f=i[a+1],d=i[a+2],p=i[a+3];if(0===o)return e[t+0]=s,e[t+1]=u,e[t+2]=l,void(e[t+3]=c);if(1===o)return e[t+0]=h,e[t+1]=f,e[t+2]=d,void(e[t+3]=p);if(c!==p||s!==h||u!==f||l!==d){var v=1-o,m=s*h+u*f+l*d+c*p,g=m>=0?1:-1,y=1-m*m;if(y>Number.EPSILON){var b=Math.sqrt(y),_=Math.atan2(b,m*g);v=Math.sin(v*_)/b,o=Math.sin(o*_)/b}var x=o*g;if(s=s*v+h*x,u=u*v+f*x,l=l*v+d*x,c=c*v+p*x,v===1-o){var w=1/Math.sqrt(s*s+u*u+l*l+c*c);s*=w,u*=w,l*=w,c*=w}}e[t]=s,e[t+1]=u,e[t+2]=l,e[t+3]=c}},{key:"multiplyQuaternionsFlat",value:function(e,t,n,r,i,a){var o=n[r],s=n[r+1],u=n[r+2],l=n[r+3],c=i[a],h=i[a+1],f=i[a+2],d=i[a+3];return e[t]=o*d+l*c+s*f-u*h,e[t+1]=s*d+l*h+u*c-o*f,e[t+2]=u*d+l*f+o*h-s*c,e[t+3]=l*d-o*c-s*h-u*f,e}}]),e}();Ds.prototype.isQuaternion=!0;var Ns=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,u.Z)(this,t),this.x=e,this.y=n,this.z=r}return(0,l.Z)(t,[{key:"set",value:function(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this.z=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}},{key:"add",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}},{key:"sub",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this.z-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this}},{key:"multiplyVectors",value:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}},{key:"applyEuler",value:function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Os.setFromEuler(e))}},{key:"applyAxisAngle",value:function(e,t){return this.applyQuaternion(Os.setFromAxisAngle(e,t))}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this}},{key:"applyNormalMatrix",value:function(e){return this.applyMatrix3(e).normalize()}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements,a=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*a,this}},{key:"applyQuaternion",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,o=e.z,s=e.w,u=s*t+a*r-o*n,l=s*n+o*t-i*r,c=s*r+i*n-a*t,h=-i*t-a*n-o*r;return this.x=u*s+h*-i+l*-o-c*-a,this.y=l*s+h*-a+c*-i-u*-o,this.z=c*s+h*-o+u*-a-l*-i,this}},{key:"project",value:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}},{key:"unproject",value:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}},{key:"transformDirection",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}},{key:"cross",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}},{key:"crossVectors",value:function(e,t){var n=e.x,r=e.y,i=e.z,a=t.x,o=t.y,s=t.z;return this.x=r*s-i*o,this.y=i*a-n*s,this.z=n*o-r*a,this}},{key:"projectOnVector",value:function(e){var t=e.lengthSq();if(0===t)return this.set(0,0,0);var n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}},{key:"projectOnPlane",value:function(e){return Is.copy(this).projectOnVector(e),this.sub(Is)}},{key:"reflect",value:function(e){return this.sub(Is.copy(e).multiplyScalar(2*this.dot(e)))}},{key:"angleTo",value:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;var n=this.dot(e)/t;return Math.acos(cs(n,-1,1))}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}},{key:"manhattanDistanceTo",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}},{key:"setFromSpherical",value:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}},{key:"setFromSphericalCoords",value:function(e,t,n){var r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}},{key:"setFromCylindrical",value:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}},{key:"setFromCylindricalCoords",value:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}},{key:"setFromMatrixPosition",value:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}},{key:"setFromMatrixScale",value:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}},{key:"setFromMatrixColumn",value:function(e,t){return this.fromArray(e.elements,4*t)}},{key:"setFromMatrix3Column",value:function(e,t){return this.fromArray(e.elements,3*t)}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}},{key:"fromBufferAttribute",value:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}},{key:"randomDirection",value:function(){var e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-Math.pow(e,2));return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}},{key:e,value:fr().mark((function e(){return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.x;case 2:return e.next=4,this.y;case 4:return e.next=6,this.z;case 6:case"end":return e.stop()}}),e,this)}))}]),t}(Symbol.iterator);Ns.prototype.isVector3=!0;var Is=new Ns,Os=new Ds,Us=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ns(1/0,1/0,1/0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ns(-1/0,-1/0,-1/0);(0,u.Z)(this,e),this.min=t,this.max=n}return(0,l.Z)(e,[{key:"set",value:function(e,t){return this.min.copy(e),this.max.copy(t),this}},{key:"setFromArray",value:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,u=e.length;s<u;s+=3){var l=e[s],c=e[s+1],h=e[s+2];l<t&&(t=l),c<n&&(n=c),h<r&&(r=h),l>i&&(i=l),c>a&&(a=c),h>o&&(o=h)}return this.min.set(t,n,r),this.max.set(i,a,o),this}},{key:"setFromBufferAttribute",value:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,u=e.count;s<u;s++){var l=e.getX(s),c=e.getY(s),h=e.getZ(s);l<t&&(t=l),c<n&&(n=c),h<r&&(r=h),l>i&&(i=l),c>a&&(a=c),h>o&&(o=h)}return this.min.set(t,n,r),this.max.set(i,a,o),this}},{key:"setFromPoints",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}},{key:"setFromCenterAndSize",value:function(e,t){var n=zs.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}},{key:"setFromObject",value:function(e){return this.makeEmpty(),this.expandByObject(e)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.min.copy(e.min),this.max.copy(e.max),this}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}},{key:"isEmpty",value:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}},{key:"getCenter",value:function(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}},{key:"getSize",value:function(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}},{key:"expandByVector",value:function(e){return this.min.sub(e),this.max.add(e),this}},{key:"expandByScalar",value:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this}},{key:"expandByObject",value:function(e){e.updateWorldMatrix(!1,!1);var t=e.geometry;void 0!==t&&(null===t.boundingBox&&t.computeBoundingBox(),Bs.copy(t.boundingBox),Bs.applyMatrix4(e.matrixWorld),this.union(Bs));for(var n=e.children,r=0,i=n.length;r<i;r++)this.expandByObject(n[r]);return this}},{key:"containsPoint",value:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}},{key:"containsBox",value:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}},{key:"getParameter",value:function(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}},{key:"intersectsBox",value:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}},{key:"intersectsSphere",value:function(e){return this.clampPoint(e.center,zs),zs.distanceToSquared(e.center)<=e.radius*e.radius}},{key:"intersectsPlane",value:function(e){var t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}},{key:"intersectsTriangle",value:function(e){if(this.isEmpty())return!1;this.getCenter(qs),Xs.subVectors(this.max,qs),Vs.subVectors(e.a,qs),Gs.subVectors(e.b,qs),js.subVectors(e.c,qs),Hs.subVectors(Gs,Vs),Ws.subVectors(js,Gs),Zs.subVectors(Vs,js);var t=[0,-Hs.z,Hs.y,0,-Ws.z,Ws.y,0,-Zs.z,Zs.y,Hs.z,0,-Hs.x,Ws.z,0,-Ws.x,Zs.z,0,-Zs.x,-Hs.y,Hs.x,0,-Ws.y,Ws.x,0,-Zs.y,Zs.x,0];return!!Js(t,Vs,Gs,js,Xs)&&(!!Js(t=[1,0,0,0,1,0,0,0,1],Vs,Gs,js,Xs)&&(Ys.crossVectors(Hs,Ws),Js(t=[Ys.x,Ys.y,Ys.z],Vs,Gs,js,Xs)))}},{key:"clampPoint",value:function(e,t){return t.copy(e).clamp(this.min,this.max)}},{key:"distanceToPoint",value:function(e){return zs.copy(e).clamp(this.min,this.max).sub(e).length()}},{key:"getBoundingSphere",value:function(e){return this.getCenter(e.center),e.radius=.5*this.getSize(zs).length(),e}},{key:"intersect",value:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"applyMatrix4",value:function(e){return this.isEmpty()||(Fs[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Fs[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Fs[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Fs[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Fs[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Fs[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Fs[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Fs[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Fs)),this}},{key:"translate",value:function(e){return this.min.add(e),this.max.add(e),this}},{key:"equals",value:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}]),e}();Us.prototype.isBox3=!0;var Fs=[new Ns,new Ns,new Ns,new Ns,new Ns,new Ns,new Ns,new Ns],zs=new Ns,Bs=new Us,Vs=new Ns,Gs=new Ns,js=new Ns,Hs=new Ns,Ws=new Ns,Zs=new Ns,qs=new Ns,Xs=new Ns,Ys=new Ns,Ks=new Ns;function Js(e,t,n,r,i){for(var a=0,o=e.length-3;a<=o;a+=3){Ks.fromArray(e,a);var s=i.x*Math.abs(Ks.x)+i.y*Math.abs(Ks.y)+i.z*Math.abs(Ks.z),u=t.dot(Ks),l=n.dot(Ks),c=r.dot(Ks);if(Math.max(-Math.max(u,l,c),Math.min(u,l,c))>s)return!1}return!0}var Qs=new Us,$s=new Ns,eu=new Ns,tu=new Ns,nu=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ns,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;(0,u.Z)(this,e),this.center=t,this.radius=n}return(0,l.Z)(e,[{key:"set",value:function(e,t){return this.center.copy(e),this.radius=t,this}},{key:"setFromPoints",value:function(e,t){var n=this.center;void 0!==t?n.copy(t):Qs.setFromPoints(e).getCenter(n);for(var r=0,i=0,a=e.length;i<a;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}},{key:"copy",value:function(e){return this.center.copy(e.center),this.radius=e.radius,this}},{key:"isEmpty",value:function(){return this.radius<0}},{key:"makeEmpty",value:function(){return this.center.set(0,0,0),this.radius=-1,this}},{key:"containsPoint",value:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}},{key:"distanceToPoint",value:function(e){return e.distanceTo(this.center)-this.radius}},{key:"intersectsSphere",value:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}},{key:"intersectsBox",value:function(e){return e.intersectsSphere(this)}},{key:"intersectsPlane",value:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}},{key:"clampPoint",value:function(e,t){var n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}},{key:"getBoundingBox",value:function(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}},{key:"applyMatrix4",value:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}},{key:"translate",value:function(e){return this.center.add(e),this}},{key:"expandByPoint",value:function(e){tu.subVectors(e,this.center);var t=tu.lengthSq();if(t>this.radius*this.radius){var n=Math.sqrt(t),r=.5*(n-this.radius);this.center.add(tu.multiplyScalar(r/n)),this.radius+=r}return this}},{key:"union",value:function(e){return eu.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint($s.copy(e.center).add(eu)),this.expandByPoint($s.copy(e.center).sub(eu)),this}},{key:"equals",value:function(e){return e.center.equals(this.center)&&e.radius===this.radius}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),ru=new Ns,iu=new Ns,au=new Ns,ou=new Ns,su=new Ns,uu=new Ns,lu=new Ns,cu=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ns,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ns(0,0,-1);(0,u.Z)(this,e),this.origin=t,this.direction=n}return(0,l.Z)(e,[{key:"set",value:function(e,t){return this.origin.copy(e),this.direction.copy(t),this}},{key:"copy",value:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}},{key:"at",value:function(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}},{key:"lookAt",value:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this}},{key:"recast",value:function(e){return this.origin.copy(this.at(e,ru)),this}},{key:"closestPointToPoint",value:function(e,t){t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}},{key:"distanceToPoint",value:function(e){return Math.sqrt(this.distanceSqToPoint(e))}},{key:"distanceSqToPoint",value:function(e){var t=ru.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(ru.copy(this.direction).multiplyScalar(t).add(this.origin),ru.distanceToSquared(e))}},{key:"distanceSqToSegment",value:function(e,t,n,r){iu.copy(e).add(t).multiplyScalar(.5),au.copy(t).sub(e).normalize(),ou.copy(this.origin).sub(iu);var i,a,o,s,u=.5*e.distanceTo(t),l=-this.direction.dot(au),c=ou.dot(this.direction),h=-ou.dot(au),f=ou.lengthSq(),d=Math.abs(1-l*l);if(d>0)if(a=l*c-h,s=u*d,(i=l*h-c)>=0)if(a>=-s)if(a<=s){var p=1/d;o=(i*=p)*(i+l*(a*=p)+2*c)+a*(l*i+a+2*h)+f}else a=u,o=-(i=Math.max(0,-(l*a+c)))*i+a*(a+2*h)+f;else a=-u,o=-(i=Math.max(0,-(l*a+c)))*i+a*(a+2*h)+f;else a<=-s?o=-(i=Math.max(0,-(-l*u+c)))*i+(a=i>0?-u:Math.min(Math.max(-u,-h),u))*(a+2*h)+f:a<=s?(i=0,o=(a=Math.min(Math.max(-u,-h),u))*(a+2*h)+f):o=-(i=Math.max(0,-(l*u+c)))*i+(a=i>0?u:Math.min(Math.max(-u,-h),u))*(a+2*h)+f;else a=l>0?-u:u,o=-(i=Math.max(0,-(l*a+c)))*i+a*(a+2*h)+f;return n&&n.copy(this.direction).multiplyScalar(i).add(this.origin),r&&r.copy(au).multiplyScalar(a).add(iu),o}},{key:"intersectSphere",value:function(e,t){ru.subVectors(e.center,this.origin);var n=ru.dot(this.direction),r=ru.dot(ru)-n*n,i=e.radius*e.radius;if(r>i)return null;var a=Math.sqrt(i-r),o=n-a,s=n+a;return o<0&&s<0?null:o<0?this.at(s,t):this.at(o,t)}},{key:"intersectsSphere",value:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}},{key:"distanceToPlane",value:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}},{key:"intersectPlane",value:function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}},{key:"intersectsPlane",value:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}},{key:"intersectBox",value:function(e,t){var n,r,i,a,o,s,u=1/this.direction.x,l=1/this.direction.y,c=1/this.direction.z,h=this.origin;return u>=0?(n=(e.min.x-h.x)*u,r=(e.max.x-h.x)*u):(n=(e.max.x-h.x)*u,r=(e.min.x-h.x)*u),l>=0?(i=(e.min.y-h.y)*l,a=(e.max.y-h.y)*l):(i=(e.max.y-h.y)*l,a=(e.min.y-h.y)*l),n>a||i>r?null:((i>n||n!==n)&&(n=i),(a<r||r!==r)&&(r=a),c>=0?(o=(e.min.z-h.z)*c,s=(e.max.z-h.z)*c):(o=(e.max.z-h.z)*c,s=(e.min.z-h.z)*c),n>s||o>r?null:((o>n||n!==n)&&(n=o),(s<r||r!==r)&&(r=s),r<0?null:this.at(n>=0?n:r,t)))}},{key:"intersectsBox",value:function(e){return null!==this.intersectBox(e,ru)}},{key:"intersectTriangle",value:function(e,t,n,r,i){su.subVectors(t,e),uu.subVectors(n,e),lu.crossVectors(su,uu);var a,o=this.direction.dot(lu);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}ou.subVectors(this.origin,e);var s=a*this.direction.dot(uu.crossVectors(ou,uu));if(s<0)return null;var u=a*this.direction.dot(su.cross(ou));if(u<0)return null;if(s+u>o)return null;var l=-a*ou.dot(lu);return l<0?null:this.at(l/o,i)}},{key:"applyMatrix4",value:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}},{key:"equals",value:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),hu=function(){function e(){(0,u.Z)(this,e),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}return(0,l.Z)(e,[{key:"set",value:function(e,t,n,r,i,a,o,s,u,l,c,h,f,d,p,v){var m=this.elements;return m[0]=e,m[4]=t,m[8]=n,m[12]=r,m[1]=i,m[5]=a,m[9]=o,m[13]=s,m[2]=u,m[6]=l,m[10]=c,m[14]=h,m[3]=f,m[7]=d,m[11]=p,m[15]=v,this}},{key:"identity",value:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}},{key:"clone",value:function(){return(new e).fromArray(this.elements)}},{key:"copy",value:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}},{key:"copyPosition",value:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}},{key:"setFromMatrix3",value:function(e){var t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}},{key:"extractBasis",value:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}},{key:"makeBasis",value:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}},{key:"extractRotation",value:function(e){var t=this.elements,n=e.elements,r=1/fu.setFromMatrixColumn(e,0).length(),i=1/fu.setFromMatrixColumn(e,1).length(),a=1/fu.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"makeRotationFromEuler",value:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,r=e.y,i=e.z,a=Math.cos(n),o=Math.sin(n),s=Math.cos(r),u=Math.sin(r),l=Math.cos(i),c=Math.sin(i);if("XYZ"===e.order){var h=a*l,f=a*c,d=o*l,p=o*c;t[0]=s*l,t[4]=-s*c,t[8]=u,t[1]=f+d*u,t[5]=h-p*u,t[9]=-o*s,t[2]=p-h*u,t[6]=d+f*u,t[10]=a*s}else if("YXZ"===e.order){var v=s*l,m=s*c,g=u*l,y=u*c;t[0]=v+y*o,t[4]=g*o-m,t[8]=a*u,t[1]=a*c,t[5]=a*l,t[9]=-o,t[2]=m*o-g,t[6]=y+v*o,t[10]=a*s}else if("ZXY"===e.order){var b=s*l,_=s*c,x=u*l,w=u*c;t[0]=b-w*o,t[4]=-a*c,t[8]=x+_*o,t[1]=_+x*o,t[5]=a*l,t[9]=w-b*o,t[2]=-a*u,t[6]=o,t[10]=a*s}else if("ZYX"===e.order){var S=a*l,M=a*c,k=o*l,T=o*c;t[0]=s*l,t[4]=k*u-M,t[8]=S*u+T,t[1]=s*c,t[5]=T*u+S,t[9]=M*u-k,t[2]=-u,t[6]=o*s,t[10]=a*s}else if("YZX"===e.order){var E=a*s,C=a*u,A=o*s,R=o*u;t[0]=s*l,t[4]=R-E*c,t[8]=A*c+C,t[1]=c,t[5]=a*l,t[9]=-o*l,t[2]=-u*l,t[6]=C*c+A,t[10]=E-R*c}else if("XZY"===e.order){var P=a*s,L=a*u,D=o*s,N=o*u;t[0]=s*l,t[4]=-c,t[8]=u*l,t[1]=P*c+N,t[5]=a*l,t[9]=L*c-D,t[2]=D*c-L,t[6]=o*l,t[10]=N*c+P}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"makeRotationFromQuaternion",value:function(e){return this.compose(pu,e,vu)}},{key:"lookAt",value:function(e,t,n){var r=this.elements;return yu.subVectors(e,t),0===yu.lengthSq()&&(yu.z=1),yu.normalize(),mu.crossVectors(n,yu),0===mu.lengthSq()&&(1===Math.abs(n.z)?yu.x+=1e-4:yu.z+=1e-4,yu.normalize(),mu.crossVectors(n,yu)),mu.normalize(),gu.crossVectors(yu,mu),r[0]=mu.x,r[4]=gu.x,r[8]=yu.x,r[1]=mu.y,r[5]=gu.y,r[9]=yu.y,r[2]=mu.z,r[6]=gu.z,r[10]=yu.z,this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}},{key:"premultiply",value:function(e){return this.multiplyMatrices(e,this)}},{key:"multiplyMatrices",value:function(e,t){var n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[4],s=n[8],u=n[12],l=n[1],c=n[5],h=n[9],f=n[13],d=n[2],p=n[6],v=n[10],m=n[14],g=n[3],y=n[7],b=n[11],_=n[15],x=r[0],w=r[4],S=r[8],M=r[12],k=r[1],T=r[5],E=r[9],C=r[13],A=r[2],R=r[6],P=r[10],L=r[14],D=r[3],N=r[7],I=r[11],O=r[15];return i[0]=a*x+o*k+s*A+u*D,i[4]=a*w+o*T+s*R+u*N,i[8]=a*S+o*E+s*P+u*I,i[12]=a*M+o*C+s*L+u*O,i[1]=l*x+c*k+h*A+f*D,i[5]=l*w+c*T+h*R+f*N,i[9]=l*S+c*E+h*P+f*I,i[13]=l*M+c*C+h*L+f*O,i[2]=d*x+p*k+v*A+m*D,i[6]=d*w+p*T+v*R+m*N,i[10]=d*S+p*E+v*P+m*I,i[14]=d*M+p*C+v*L+m*O,i[3]=g*x+y*k+b*A+_*D,i[7]=g*w+y*T+b*R+_*N,i[11]=g*S+y*E+b*P+_*I,i[15]=g*M+y*C+b*L+_*O,this}},{key:"multiplyScalar",value:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}},{key:"determinant",value:function(){var e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],a=e[1],o=e[5],s=e[9],u=e[13],l=e[2],c=e[6],h=e[10],f=e[14];return e[3]*(+i*s*c-r*u*c-i*o*h+n*u*h+r*o*f-n*s*f)+e[7]*(+t*s*f-t*u*h+i*a*h-r*a*f+r*u*l-i*s*l)+e[11]*(+t*u*c-t*o*f-i*a*c+n*a*f+i*o*l-n*u*l)+e[15]*(-r*o*l-t*s*c+t*o*h+r*a*c-n*a*h+n*s*l)}},{key:"transpose",value:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}},{key:"setPosition",value:function(e,t,n){var r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}},{key:"invert",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],l=e[8],c=e[9],h=e[10],f=e[11],d=e[12],p=e[13],v=e[14],m=e[15],g=c*v*u-p*h*u+p*s*f-o*v*f-c*s*m+o*h*m,y=d*h*u-l*v*u-d*s*f+a*v*f+l*s*m-a*h*m,b=l*p*u-d*c*u+d*o*f-a*p*f-l*o*m+a*c*m,_=d*c*s-l*p*s-d*o*h+a*p*h+l*o*v-a*c*v,x=t*g+n*y+r*b+i*_;if(0===x)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var w=1/x;return e[0]=g*w,e[1]=(p*h*i-c*v*i-p*r*f+n*v*f+c*r*m-n*h*m)*w,e[2]=(o*v*i-p*s*i+p*r*u-n*v*u-o*r*m+n*s*m)*w,e[3]=(c*s*i-o*h*i-c*r*u+n*h*u+o*r*f-n*s*f)*w,e[4]=y*w,e[5]=(l*v*i-d*h*i+d*r*f-t*v*f-l*r*m+t*h*m)*w,e[6]=(d*s*i-a*v*i-d*r*u+t*v*u+a*r*m-t*s*m)*w,e[7]=(a*h*i-l*s*i+l*r*u-t*h*u-a*r*f+t*s*f)*w,e[8]=b*w,e[9]=(d*c*i-l*p*i-d*n*f+t*p*f+l*n*m-t*c*m)*w,e[10]=(a*p*i-d*o*i+d*n*u-t*p*u-a*n*m+t*o*m)*w,e[11]=(l*o*i-a*c*i-l*n*u+t*c*u+a*n*f-t*o*f)*w,e[12]=_*w,e[13]=(l*p*r-d*c*r+d*n*h-t*p*h-l*n*v+t*c*v)*w,e[14]=(d*o*r-a*p*r-d*n*s+t*p*s+a*n*v-t*o*v)*w,e[15]=(a*c*r-l*o*r+l*n*s-t*c*s-a*n*h+t*o*h)*w,this}},{key:"scale",value:function(e){var t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this}},{key:"getMaxScaleOnAxis",value:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}},{key:"makeTranslation",value:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}},{key:"makeRotationX",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}},{key:"makeRotationY",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}},{key:"makeRotationZ",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}},{key:"makeRotationAxis",value:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=1-n,a=e.x,o=e.y,s=e.z,u=i*a,l=i*o;return this.set(u*a+n,u*o-r*s,u*s+r*o,0,u*o+r*s,l*o+n,l*s-r*a,0,u*s-r*o,l*s+r*a,i*s*s+n,0,0,0,0,1),this}},{key:"makeScale",value:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}},{key:"makeShear",value:function(e,t,n,r,i,a){return this.set(1,n,i,0,e,1,a,0,t,r,1,0,0,0,0,1),this}},{key:"compose",value:function(e,t,n){var r=this.elements,i=t._x,a=t._y,o=t._z,s=t._w,u=i+i,l=a+a,c=o+o,h=i*u,f=i*l,d=i*c,p=a*l,v=a*c,m=o*c,g=s*u,y=s*l,b=s*c,_=n.x,x=n.y,w=n.z;return r[0]=(1-(p+m))*_,r[1]=(f+b)*_,r[2]=(d-y)*_,r[3]=0,r[4]=(f-b)*x,r[5]=(1-(h+m))*x,r[6]=(v+g)*x,r[7]=0,r[8]=(d+y)*w,r[9]=(v-g)*w,r[10]=(1-(h+p))*w,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}},{key:"decompose",value:function(e,t,n){var r=this.elements,i=fu.set(r[0],r[1],r[2]).length(),a=fu.set(r[4],r[5],r[6]).length(),o=fu.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],du.copy(this);var s=1/i,u=1/a,l=1/o;return du.elements[0]*=s,du.elements[1]*=s,du.elements[2]*=s,du.elements[4]*=u,du.elements[5]*=u,du.elements[6]*=u,du.elements[8]*=l,du.elements[9]*=l,du.elements[10]*=l,t.setFromRotationMatrix(du),n.x=i,n.y=a,n.z=o,this}},{key:"makePerspective",value:function(e,t,n,r,i,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,s=2*i/(t-e),u=2*i/(n-r),l=(t+e)/(t-e),c=(n+r)/(n-r),h=-(a+i)/(a-i),f=-2*a*i/(a-i);return o[0]=s,o[4]=0,o[8]=l,o[12]=0,o[1]=0,o[5]=u,o[9]=c,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=f,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}},{key:"makeOrthographic",value:function(e,t,n,r,i,a){var o=this.elements,s=1/(t-e),u=1/(n-r),l=1/(a-i),c=(t+e)*s,h=(n+r)*u,f=(a+i)*l;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-c,o[1]=0,o[5]=2*u,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2*l,o[14]=-f,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}},{key:"equals",value:function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<16;n++)this.elements[n]=e[n+t];return this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}]),e}();hu.prototype.isMatrix4=!0;var fu=new Ns,du=new hu,pu=new Ns(0,0,0),vu=new Ns(1,1,1),mu=new Ns,gu=new Ns,yu=new Ns,bu=new hu,_u=new Ds,xu=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.DefaultOrder;(0,u.Z)(this,e),this._x=t,this._y=n,this._z=r,this._order=i}return(0,l.Z)(e,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}},{key:"set",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._order)}},{key:"copy",value:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=e.elements,i=r[0],a=r[4],o=r[8],s=r[1],u=r[5],l=r[9],c=r[2],h=r[6],f=r[10];switch(t){case"XYZ":this._y=Math.asin(cs(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-l,f),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(h,u),this._z=0);break;case"YXZ":this._x=Math.asin(-cs(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(o,f),this._z=Math.atan2(s,u)):(this._y=Math.atan2(-c,i),this._z=0);break;case"ZXY":this._x=Math.asin(cs(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-c,f),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(s,i));break;case"ZYX":this._y=Math.asin(-cs(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(h,f),this._z=Math.atan2(s,i)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(cs(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-l,u),this._y=Math.atan2(-c,i)):(this._x=0,this._y=Math.atan2(o,f));break;case"XZY":this._z=Math.asin(-cs(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(h,u),this._y=Math.atan2(o,i)):(this._x=Math.atan2(-l,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}},{key:"setFromQuaternion",value:function(e,t,n){return bu.makeRotationFromQuaternion(e),this.setFromRotationMatrix(bu,t,n)}},{key:"setFromVector3",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(e.x,e.y,e.z,t)}},{key:"reorder",value:function(e){return _u.setFromEuler(this),this.setFromQuaternion(_u,e)}},{key:"equals",value:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}},{key:"fromArray",value:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}},{key:"toVector3",value:function(e){return e?e.set(this._x,this._y,this._z):new Ns(this._x,this._y,this._z)}},{key:"_onChange",value:function(e){return this._onChangeCallback=e,this}},{key:"_onChangeCallback",value:function(){}}]),e}();xu.prototype.isEuler=!0,xu.DefaultOrder="XYZ",xu.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];var wu=function(){function e(){(0,u.Z)(this,e),this.mask=1}return(0,l.Z)(e,[{key:"set",value:function(e){this.mask=(1<<e|0)>>>0}},{key:"enable",value:function(e){this.mask|=1<<e|0}},{key:"enableAll",value:function(){this.mask=-1}},{key:"toggle",value:function(e){this.mask^=1<<e|0}},{key:"disable",value:function(e){this.mask&=~(1<<e|0)}},{key:"disableAll",value:function(){this.mask=0}},{key:"test",value:function(e){return 0!==(this.mask&e.mask)}},{key:"isEnabled",value:function(e){return 0!==(this.mask&(1<<e|0))}}]),e}(),Su=0,Mu=new Ns,ku=new Ds,Tu=new hu,Eu=new Ns,Cu=new Ns,Au=new Ns,Ru=new Ds,Pu=new Ns(1,0,0),Lu=new Ns(0,1,0),Du=new Ns(0,0,1),Nu={type:"added"},Iu={type:"removed"},Ou=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;(0,u.Z)(this,n),e=t.call(this),Object.defineProperty((0,c.Z)(e),"id",{value:Su++}),e.uuid=ls(),e.name="",e.type="Object3D",e.parent=null,e.children=[],e.up=n.DefaultUp.clone();var r=new Ns,i=new xu,a=new Ds,o=new Ns(1,1,1);return i._onChange((function(){a.setFromEuler(i,!1)})),a._onChange((function(){i.setFromQuaternion(a,void 0,!1)})),Object.defineProperties((0,c.Z)(e),{position:{configurable:!0,enumerable:!0,value:r},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:a},scale:{configurable:!0,enumerable:!0,value:o},modelViewMatrix:{value:new hu},normalMatrix:{value:new ys}}),e.matrix=new hu,e.matrixWorld=new hu,e.matrixAutoUpdate=n.DefaultMatrixAutoUpdate,e.matrixWorldNeedsUpdate=!1,e.layers=new wu,e.visible=!0,e.castShadow=!1,e.receiveShadow=!1,e.frustumCulled=!0,e.renderOrder=0,e.animations=[],e.userData={},e}return(0,l.Z)(n,[{key:"onBeforeRender",value:function(){}},{key:"onAfterRender",value:function(){}},{key:"applyMatrix4",value:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}},{key:"applyQuaternion",value:function(e){return this.quaternion.premultiply(e),this}},{key:"setRotationFromAxisAngle",value:function(e,t){this.quaternion.setFromAxisAngle(e,t)}},{key:"setRotationFromEuler",value:function(e){this.quaternion.setFromEuler(e,!0)}},{key:"setRotationFromMatrix",value:function(e){this.quaternion.setFromRotationMatrix(e)}},{key:"setRotationFromQuaternion",value:function(e){this.quaternion.copy(e)}},{key:"rotateOnAxis",value:function(e,t){return ku.setFromAxisAngle(e,t),this.quaternion.multiply(ku),this}},{key:"rotateOnWorldAxis",value:function(e,t){return ku.setFromAxisAngle(e,t),this.quaternion.premultiply(ku),this}},{key:"rotateX",value:function(e){return this.rotateOnAxis(Pu,e)}},{key:"rotateY",value:function(e){return this.rotateOnAxis(Lu,e)}},{key:"rotateZ",value:function(e){return this.rotateOnAxis(Du,e)}},{key:"translateOnAxis",value:function(e,t){return Mu.copy(e).applyQuaternion(this.quaternion),this.position.add(Mu.multiplyScalar(t)),this}},{key:"translateX",value:function(e){return this.translateOnAxis(Pu,e)}},{key:"translateY",value:function(e){return this.translateOnAxis(Lu,e)}},{key:"translateZ",value:function(e){return this.translateOnAxis(Du,e)}},{key:"localToWorld",value:function(e){return e.applyMatrix4(this.matrixWorld)}},{key:"worldToLocal",value:function(e){return e.applyMatrix4(Tu.copy(this.matrixWorld).invert())}},{key:"lookAt",value:function(e,t,n){e.isVector3?Eu.copy(e):Eu.set(e,t,n);var r=this.parent;this.updateWorldMatrix(!0,!1),Cu.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Tu.lookAt(Cu,Eu,this.up):Tu.lookAt(Eu,Cu,this.up),this.quaternion.setFromRotationMatrix(Tu),r&&(Tu.extractRotation(r.matrixWorld),ku.setFromRotationMatrix(Tu),this.quaternion.premultiply(ku.invert()))}},{key:"add",value:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Nu)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}},{key:"remove",value:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(Iu)),this}},{key:"removeFromParent",value:function(){var e=this.parent;return null!==e&&e.remove(this),this}},{key:"clear",value:function(){for(var e=0;e<this.children.length;e++){var t=this.children[e];t.parent=null,t.dispatchEvent(Iu)}return this.children.length=0,this}},{key:"attach",value:function(e){return this.updateWorldMatrix(!0,!1),Tu.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),Tu.multiply(e.parent.matrixWorld)),e.applyMatrix4(Tu),this.add(e),e.updateWorldMatrix(!1,!0),this}},{key:"getObjectById",value:function(e){return this.getObjectByProperty("id",e)}},{key:"getObjectByName",value:function(e){return this.getObjectByProperty("name",e)}},{key:"getObjectByProperty",value:function(e,t){if(this[e]===t)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}}},{key:"getWorldPosition",value:function(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}},{key:"getWorldQuaternion",value:function(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Cu,e,Au),e}},{key:"getWorldScale",value:function(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Cu,Ru,e),e}},{key:"getWorldDirection",value:function(e){this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}},{key:"raycast",value:function(){}},{key:"traverse",value:function(e){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverse(e)}},{key:"traverseVisible",value:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}}},{key:"traverseAncestors",value:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}},{key:"updateMatrix",value:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}},{key:"updateMatrixWorld",value:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}},{key:"updateWorldMatrix",value:function(e,t){var n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var r=this.children,i=0,a=r.length;i<a;i++)r[i].updateWorldMatrix(!1,!0)}},{key:"toJSON",value:function(e){var t=void 0===e||"string"===typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var o=a.shapes;if(Array.isArray(o))for(var s=0,u=o.length;s<u;s++){var l=o[s];i(e.shapes,l)}else i(e.shapes,o)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){for(var c=[],h=0,f=this.material.length;h<f;h++)c.push(i(e.materials,this.material[h]));r.material=c}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(var d=0;d<this.children.length;d++)r.children.push(this.children[d].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(var p=0;p<this.animations.length;p++){var v=this.animations[p];r.animations.push(i(e.animations,v))}}if(t){var m=S(e.geometries),g=S(e.materials),y=S(e.textures),b=S(e.images),_=S(e.shapes),x=S(e.skeletons),w=S(e.animations);m.length>0&&(n.geometries=m),g.length>0&&(n.materials=g),y.length>0&&(n.textures=y),b.length>0&&(n.images=b),_.length>0&&(n.shapes=_),x.length>0&&(n.skeletons=x),w.length>0&&(n.animations=w)}return n.object=r,n;function S(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}}},{key:"clone",value:function(e){return(new this.constructor).copy(this,e)}},{key:"copy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var r=e.children[n];this.add(r.clone())}return this}}]),n}(rs);Ou.DefaultUp=new Ns(0,1,0),Ou.DefaultMatrixAutoUpdate=!0,Ou.prototype.isObject3D=!0;var Uu=new Ns,Fu=new Ns,zu=new Ns,Bu=new Ns,Vu=new Ns,Gu=new Ns,ju=new Ns,Hu=new Ns,Wu=new Ns,Zu=new Ns,qu=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ns,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ns,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Ns;(0,u.Z)(this,e),this.a=t,this.b=n,this.c=r}return(0,l.Z)(e,[{key:"set",value:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}},{key:"setFromPointsAndIndices",value:function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}},{key:"setFromAttributeAndIndices",value:function(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}},{key:"getArea",value:function(){return Uu.subVectors(this.c,this.b),Fu.subVectors(this.a,this.b),.5*Uu.cross(Fu).length()}},{key:"getMidpoint",value:function(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}},{key:"getNormal",value:function(t){return e.getNormal(this.a,this.b,this.c,t)}},{key:"getPlane",value:function(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}},{key:"getBarycoord",value:function(t,n){return e.getBarycoord(t,this.a,this.b,this.c,n)}},{key:"getUV",value:function(t,n,r,i,a){return e.getUV(t,this.a,this.b,this.c,n,r,i,a)}},{key:"containsPoint",value:function(t){return e.containsPoint(t,this.a,this.b,this.c)}},{key:"isFrontFacing",value:function(t){return e.isFrontFacing(this.a,this.b,this.c,t)}},{key:"intersectsBox",value:function(e){return e.intersectsTriangle(this)}},{key:"closestPointToPoint",value:function(e,t){var n,r,i=this.a,a=this.b,o=this.c;Vu.subVectors(a,i),Gu.subVectors(o,i),Hu.subVectors(e,i);var s=Vu.dot(Hu),u=Gu.dot(Hu);if(s<=0&&u<=0)return t.copy(i);Wu.subVectors(e,a);var l=Vu.dot(Wu),c=Gu.dot(Wu);if(l>=0&&c<=l)return t.copy(a);var h=s*c-l*u;if(h<=0&&s>=0&&l<=0)return n=s/(s-l),t.copy(i).addScaledVector(Vu,n);Zu.subVectors(e,o);var f=Vu.dot(Zu),d=Gu.dot(Zu);if(d>=0&&f<=d)return t.copy(o);var p=f*u-s*d;if(p<=0&&u>=0&&d<=0)return r=u/(u-d),t.copy(i).addScaledVector(Gu,r);var v=l*d-f*c;if(v<=0&&c-l>=0&&f-d>=0)return ju.subVectors(o,a),r=(c-l)/(c-l+(f-d)),t.copy(a).addScaledVector(ju,r);var m=1/(v+p+h);return n=p*m,r=h*m,t.copy(i).addScaledVector(Vu,n).addScaledVector(Gu,r)}},{key:"equals",value:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}],[{key:"getNormal",value:function(e,t,n,r){r.subVectors(n,t),Uu.subVectors(e,t),r.cross(Uu);var i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}},{key:"getBarycoord",value:function(e,t,n,r,i){Uu.subVectors(r,t),Fu.subVectors(n,t),zu.subVectors(e,t);var a=Uu.dot(Uu),o=Uu.dot(Fu),s=Uu.dot(zu),u=Fu.dot(Fu),l=Fu.dot(zu),c=a*u-o*o;if(0===c)return i.set(-2,-1,-1);var h=1/c,f=(u*s-o*l)*h,d=(a*l-o*s)*h;return i.set(1-f-d,d,f)}},{key:"containsPoint",value:function(e,t,n,r){return this.getBarycoord(e,t,n,r,Bu),Bu.x>=0&&Bu.y>=0&&Bu.x+Bu.y<=1}},{key:"getUV",value:function(e,t,n,r,i,a,o,s){return this.getBarycoord(e,t,n,r,Bu),s.set(0,0),s.addScaledVector(i,Bu.x),s.addScaledVector(a,Bu.y),s.addScaledVector(o,Bu.z),s}},{key:"isFrontFacing",value:function(e,t,n,r){return Uu.subVectors(n,t),Fu.subVectors(e,t),Uu.cross(Fu).dot(r)<0}}]),e}(),Xu=0,Yu=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;return(0,u.Z)(this,n),e=t.call(this),Object.defineProperty((0,c.Z)(e),"id",{value:Xu++}),e.uuid=ls(),e.name="",e.type="Material",e.fog=!0,e.blending=Gr,e.side=Or,e.vertexColors=!1,e.opacity=1,e.format=oa,e.transparent=!1,e.blendSrc=ni,e.blendDst=ri,e.blendEquation=qr,e.blendSrcAlpha=null,e.blendDstAlpha=null,e.blendEquationAlpha=null,e.depthFunc=fi,e.depthTest=!0,e.depthWrite=!0,e.stencilWriteMask=255,e.stencilFunc=Wo,e.stencilRef=0,e.stencilFuncMask=255,e.stencilFail=Po,e.stencilZFail=Po,e.stencilZPass=Po,e.stencilWrite=!1,e.clippingPlanes=null,e.clipIntersection=!1,e.clipShadows=!1,e.shadowSide=null,e.colorWrite=!0,e.precision=null,e.polygonOffset=!1,e.polygonOffsetFactor=0,e.polygonOffsetUnits=0,e.dithering=!1,e.alphaToCoverage=!1,e.premultipliedAlpha=!1,e.visible=!0,e.toneMapped=!0,e.userData={},e.version=0,e._alphaTest=0,e}return(0,l.Z)(n,[{key:"alphaTest",get:function(){return this._alphaTest},set:function(e){this._alphaTest>0!==e>0&&this.version++,this._alphaTest=e}},{key:"onBuild",value:function(){}},{key:"onBeforeRender",value:function(){}},{key:"onBeforeCompile",value:function(){}},{key:"customProgramCacheKey",value:function(){return this.onBeforeCompile.toString()}},{key:"setValues",value:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n)if("shading"!==t){var r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===zr;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}}},{key:"toJSON",value:function(e){var t=void 0===e||"string"===typeof e;t&&(e={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Gr&&(n.blending=this.blending),this.side!==Or&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.format!==oa&&(n.format=this.format),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){var i=r(e.textures),a=r(e.images);i.length>0&&(n.textures=i),a.length>0&&(n.images=a)}return n}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.format=e.format,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var t=e.clippingPlanes,n=null;if(null!==t){var r=t.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}}]),n}(rs);Yu.prototype.isMaterial=!0;var Ku={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ju={h:0,s:0,l:0},Qu={h:0,s:0,l:0};function $u(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}function el(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function tl(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}var nl=function(){function e(t,n,r){return(0,u.Z)(this,e),void 0===n&&void 0===r?this.set(t):this.setRGB(t,n,r)}return(0,l.Z)(e,[{key:"set",value:function(e){return e&&e.isColor?this.copy(e):"number"===typeof e?this.setHex(e):"string"===typeof e&&this.setStyle(e),this}},{key:"setScalar",value:function(e){return this.r=e,this.g=e,this.b=e,this}},{key:"setHex",value:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this}},{key:"setRGB",value:function(e,t,n){return this.r=e,this.g=t,this.b=n,this}},{key:"setHSL",value:function(e,t,n){if(e=hs(e,1),t=cs(t,0,1),n=cs(n,0,1),0===t)this.r=this.g=this.b=n;else{var r=n<=.5?n*(1+t):n+t-n*t,i=2*n-r;this.r=$u(i,r,e+1/3),this.g=$u(i,r,e),this.b=$u(i,r,e-1/3)}return this}},{key:"setStyle",value:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){var r,i=n[1],a=n[2];switch(i){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,t(r[4]),this;if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,t(r[4]),this;break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){var o=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,u=parseInt(r[3],10)/100;return t(r[4]),this.setHSL(o,s,u)}}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){var l=n[1],c=l.length;if(3===c)return this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255,this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255,this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255,this;if(6===c)return this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255,this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255,this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this}},{key:"setColorName",value:function(e){var t=Ku[e.toLowerCase()];return void 0!==t?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this}},{key:"clone",value:function(){return new this.constructor(this.r,this.g,this.b)}},{key:"copy",value:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}},{key:"copyGammaToLinear",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this}},{key:"copyLinearToGamma",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=t>0?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this}},{key:"convertGammaToLinear",value:function(e){return this.copyGammaToLinear(this,e),this}},{key:"convertLinearToGamma",value:function(e){return this.copyLinearToGamma(this,e),this}},{key:"copySRGBToLinear",value:function(e){return this.r=el(e.r),this.g=el(e.g),this.b=el(e.b),this}},{key:"copyLinearToSRGB",value:function(e){return this.r=tl(e.r),this.g=tl(e.g),this.b=tl(e.b),this}},{key:"convertSRGBToLinear",value:function(){return this.copySRGBToLinear(this),this}},{key:"convertLinearToSRGB",value:function(){return this.copyLinearToSRGB(this),this}},{key:"getHex",value:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}},{key:"getHexString",value:function(){return("000000"+this.getHex().toString(16)).slice(-6)}},{key:"getHSL",value:function(e){var t,n,r=this.r,i=this.g,a=this.b,o=Math.max(r,i,a),s=Math.min(r,i,a),u=(s+o)/2;if(s===o)t=0,n=0;else{var l=o-s;switch(n=u<=.5?l/(o+s):l/(2-o-s),o){case r:t=(i-a)/l+(i<a?6:0);break;case i:t=(a-r)/l+2;break;case a:t=(r-i)/l+4}t/=6}return e.h=t,e.s=n,e.l=u,e}},{key:"getStyle",value:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}},{key:"offsetHSL",value:function(e,t,n){return this.getHSL(Ju),Ju.h+=e,Ju.s+=t,Ju.l+=n,this.setHSL(Ju.h,Ju.s,Ju.l),this}},{key:"add",value:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}},{key:"addColors",value:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}},{key:"addScalar",value:function(e){return this.r+=e,this.g+=e,this.b+=e,this}},{key:"sub",value:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}},{key:"multiply",value:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}},{key:"multiplyScalar",value:function(e){return this.r*=e,this.g*=e,this.b*=e,this}},{key:"lerp",value:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}},{key:"lerpColors",value:function(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}},{key:"lerpHSL",value:function(e,t){this.getHSL(Ju),e.getHSL(Qu);var n=fs(Ju.h,Qu.h,t),r=fs(Ju.s,Qu.s,t),i=fs(Ju.l,Qu.l,t);return this.setHSL(n,r,i),this}},{key:"equals",value:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}},{key:"fromBufferAttribute",value:function(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}},{key:"toJSON",value:function(){return this.getHex()}}]),e}();nl.NAMES=Ku,nl.prototype.isColor=!0,nl.prototype.r=1,nl.prototype.g=1,nl.prototype.b=1;var rl=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).type="MeshBasicMaterial",r.color=new nl(16777215),r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=gi,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.setValues(e),r}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}]),n}(Yu);rl.prototype.isMeshBasicMaterial=!0;var il=new Ns,al=new gs,ol=function(){function e(t,n,r){if((0,u.Z)(this,e),Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=n,this.count=void 0!==t?t.length/n:0,this.normalized=!0===r,this.usage=Zo,this.updateRange={offset:0,count:-1},this.version=0}return(0,l.Z)(e,[{key:"onUploadCallback",value:function(){}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"setUsage",value:function(e){return this.usage=e,this}},{key:"copy",value:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}},{key:"copyAt",value:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this}},{key:"copyArray",value:function(e){return this.array.set(e),this}},{key:"copyColorsArray",value:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),a=new nl),t[n++]=a.r,t[n++]=a.g,t[n++]=a.b}return this}},{key:"copyVector2sArray",value:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),a=new gs),t[n++]=a.x,t[n++]=a.y}return this}},{key:"copyVector3sArray",value:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),a=new Ns),t[n++]=a.x,t[n++]=a.y,t[n++]=a.z}return this}},{key:"copyVector4sArray",value:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),a=new As),t[n++]=a.x,t[n++]=a.y,t[n++]=a.z,t[n++]=a.w}return this}},{key:"applyMatrix3",value:function(e){if(2===this.itemSize)for(var t=0,n=this.count;t<n;t++)al.fromBufferAttribute(this,t),al.applyMatrix3(e),this.setXY(t,al.x,al.y);else if(3===this.itemSize)for(var r=0,i=this.count;r<i;r++)il.fromBufferAttribute(this,r),il.applyMatrix3(e),this.setXYZ(r,il.x,il.y,il.z);return this}},{key:"applyMatrix4",value:function(e){for(var t=0,n=this.count;t<n;t++)il.x=this.getX(t),il.y=this.getY(t),il.z=this.getZ(t),il.applyMatrix4(e),this.setXYZ(t,il.x,il.y,il.z);return this}},{key:"applyNormalMatrix",value:function(e){for(var t=0,n=this.count;t<n;t++)il.x=this.getX(t),il.y=this.getY(t),il.z=this.getZ(t),il.applyNormalMatrix(e),this.setXYZ(t,il.x,il.y,il.z);return this}},{key:"transformDirection",value:function(e){for(var t=0,n=this.count;t<n;t++)il.x=this.getX(t),il.y=this.getY(t),il.z=this.getZ(t),il.transformDirection(e),this.setXYZ(t,il.x,il.y,il.z);return this}},{key:"set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}},{key:"getX",value:function(e){return this.array[e*this.itemSize]}},{key:"setX",value:function(e,t){return this.array[e*this.itemSize]=t,this}},{key:"getY",value:function(e){return this.array[e*this.itemSize+1]}},{key:"setY",value:function(e,t){return this.array[e*this.itemSize+1]=t,this}},{key:"getZ",value:function(e){return this.array[e*this.itemSize+2]}},{key:"setZ",value:function(e,t){return this.array[e*this.itemSize+2]=t,this}},{key:"getW",value:function(e){return this.array[e*this.itemSize+3]}},{key:"setW",value:function(e,t){return this.array[e*this.itemSize+3]=t,this}},{key:"setXY",value:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this}},{key:"setXYZ",value:function(e,t,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}},{key:"setXYZW",value:function(e,t,n,r,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this}},{key:"onUpload",value:function(e){return this.onUploadCallback=e,this}},{key:"clone",value:function(){return new this.constructor(this.array,this.itemSize).copy(this)}},{key:"toJSON",value:function(){var e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==Zo&&(e.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(e.updateRange=this.updateRange),e}}]),e}();ol.prototype.isBufferAttribute=!0;var sl=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i){return(0,u.Z)(this,n),t.call(this,new Int8Array(e),r,i)}return(0,l.Z)(n)}(ol),ul=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i){return(0,u.Z)(this,n),t.call(this,new Uint8Array(e),r,i)}return(0,l.Z)(n)}(ol),ll=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i){return(0,u.Z)(this,n),t.call(this,new Uint8ClampedArray(e),r,i)}return(0,l.Z)(n)}(ol),cl=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i){return(0,u.Z)(this,n),t.call(this,new Int16Array(e),r,i)}return(0,l.Z)(n)}(ol),hl=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i){return(0,u.Z)(this,n),t.call(this,new Uint16Array(e),r,i)}return(0,l.Z)(n)}(ol),fl=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i){return(0,u.Z)(this,n),t.call(this,new Int32Array(e),r,i)}return(0,l.Z)(n)}(ol),dl=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i){return(0,u.Z)(this,n),t.call(this,new Uint32Array(e),r,i)}return(0,l.Z)(n)}(ol),pl=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i){return(0,u.Z)(this,n),t.call(this,new Uint16Array(e),r,i)}return(0,l.Z)(n)}(ol);pl.prototype.isFloat16BufferAttribute=!0;var vl=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i){return(0,u.Z)(this,n),t.call(this,new Float32Array(e),r,i)}return(0,l.Z)(n)}(ol),ml=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i){return(0,u.Z)(this,n),t.call(this,new Float64Array(e),r,i)}return(0,l.Z)(n)}(ol),gl=0,yl=new hu,bl=new Ou,_l=new Ns,xl=new Us,wl=new Us,Sl=new Ns,Ml=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;return(0,u.Z)(this,n),e=t.call(this),Object.defineProperty((0,c.Z)(e),"id",{value:gl++}),e.uuid=ls(),e.name="",e.type="BufferGeometry",e.index=null,e.attributes={},e.morphAttributes={},e.morphTargetsRelative=!1,e.groups=[],e.boundingBox=null,e.boundingSphere=null,e.drawRange={start:0,count:1/0},e.userData={},e}return(0,l.Z)(n,[{key:"getIndex",value:function(){return this.index}},{key:"setIndex",value:function(e){return Array.isArray(e)?this.index=new(bs(e)>65535?dl:hl)(e,1):this.index=e,this}},{key:"getAttribute",value:function(e){return this.attributes[e]}},{key:"setAttribute",value:function(e,t){return this.attributes[e]=t,this}},{key:"deleteAttribute",value:function(e){return delete this.attributes[e],this}},{key:"hasAttribute",value:function(e){return void 0!==this.attributes[e]}},{key:"addGroup",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:n})}},{key:"clearGroups",value:function(){this.groups=[]}},{key:"setDrawRange",value:function(e,t){this.drawRange.start=e,this.drawRange.count=t}},{key:"applyMatrix4",value:function(e){var t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var r=(new ys).getNormalMatrix(e);n.applyNormalMatrix(r),n.needsUpdate=!0}var i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}},{key:"applyQuaternion",value:function(e){return yl.makeRotationFromQuaternion(e),this.applyMatrix4(yl),this}},{key:"rotateX",value:function(e){return yl.makeRotationX(e),this.applyMatrix4(yl),this}},{key:"rotateY",value:function(e){return yl.makeRotationY(e),this.applyMatrix4(yl),this}},{key:"rotateZ",value:function(e){return yl.makeRotationZ(e),this.applyMatrix4(yl),this}},{key:"translate",value:function(e,t,n){return yl.makeTranslation(e,t,n),this.applyMatrix4(yl),this}},{key:"scale",value:function(e,t,n){return yl.makeScale(e,t,n),this.applyMatrix4(yl),this}},{key:"lookAt",value:function(e){return bl.lookAt(e),bl.updateMatrix(),this.applyMatrix4(bl.matrix),this}},{key:"center",value:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(_l).negate(),this.translate(_l.x,_l.y,_l.z),this}},{key:"setFromPoints",value:function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];t.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new vl(t,3)),this}},{key:"computeBoundingBox",value:function(){null===this.boundingBox&&(this.boundingBox=new Us);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Ns(-1/0,-1/0,-1/0),new Ns(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(var n=0,r=t.length;n<r;n++){var i=t[n];xl.setFromBufferAttribute(i),this.morphTargetsRelative?(Sl.addVectors(this.boundingBox.min,xl.min),this.boundingBox.expandByPoint(Sl),Sl.addVectors(this.boundingBox.max,xl.max),this.boundingBox.expandByPoint(Sl)):(this.boundingBox.expandByPoint(xl.min),this.boundingBox.expandByPoint(xl.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}},{key:"computeBoundingSphere",value:function(){null===this.boundingSphere&&(this.boundingSphere=new nu);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Ns,1/0);if(e){var n=this.boundingSphere.center;if(xl.setFromBufferAttribute(e),t)for(var r=0,i=t.length;r<i;r++){var a=t[r];wl.setFromBufferAttribute(a),this.morphTargetsRelative?(Sl.addVectors(xl.min,wl.min),xl.expandByPoint(Sl),Sl.addVectors(xl.max,wl.max),xl.expandByPoint(Sl)):(xl.expandByPoint(wl.min),xl.expandByPoint(wl.max))}xl.getCenter(n);for(var o=0,s=0,u=e.count;s<u;s++)Sl.fromBufferAttribute(e,s),o=Math.max(o,n.distanceToSquared(Sl));if(t)for(var l=0,c=t.length;l<c;l++)for(var h=t[l],f=this.morphTargetsRelative,d=0,p=h.count;d<p;d++)Sl.fromBufferAttribute(h,d),f&&(_l.fromBufferAttribute(e,d),Sl.add(_l)),o=Math.max(o,n.distanceToSquared(Sl));this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}},{key:"computeTangents",value:function(){var e=this.index,t=this.attributes;if(null!==e&&void 0!==t.position&&void 0!==t.normal&&void 0!==t.uv){var n=e.array,r=t.position.array,i=t.normal.array,a=t.uv.array,o=r.length/3;void 0===t.tangent&&this.setAttribute("tangent",new ol(new Float32Array(4*o),4));for(var s=t.tangent.array,u=[],l=[],c=0;c<o;c++)u[c]=new Ns,l[c]=new Ns;var h=new Ns,f=new Ns,d=new Ns,p=new gs,v=new gs,m=new gs,g=new Ns,y=new Ns,b=this.groups;0===b.length&&(b=[{start:0,count:n.length}]);for(var _=0,x=b.length;_<x;++_)for(var w=b[_],S=w.start,M=S,k=S+w.count;M<k;M+=3)O(n[M+0],n[M+1],n[M+2]);for(var T=new Ns,E=new Ns,C=new Ns,A=new Ns,R=0,P=b.length;R<P;++R)for(var L=b[R],D=L.start,N=D,I=D+L.count;N<I;N+=3)U(n[N+0]),U(n[N+1]),U(n[N+2])}else console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");function O(e,t,n){h.fromArray(r,3*e),f.fromArray(r,3*t),d.fromArray(r,3*n),p.fromArray(a,2*e),v.fromArray(a,2*t),m.fromArray(a,2*n),f.sub(h),d.sub(h),v.sub(p),m.sub(p);var i=1/(v.x*m.y-m.x*v.y);isFinite(i)&&(g.copy(f).multiplyScalar(m.y).addScaledVector(d,-v.y).multiplyScalar(i),y.copy(d).multiplyScalar(v.x).addScaledVector(f,-m.x).multiplyScalar(i),u[e].add(g),u[t].add(g),u[n].add(g),l[e].add(y),l[t].add(y),l[n].add(y))}function U(e){C.fromArray(i,3*e),A.copy(C);var t=u[e];T.copy(t),T.sub(C.multiplyScalar(C.dot(t))).normalize(),E.crossVectors(A,t);var n=E.dot(l[e])<0?-1:1;s[4*e]=T.x,s[4*e+1]=T.y,s[4*e+2]=T.z,s[4*e+3]=n}}},{key:"computeVertexNormals",value:function(){var e=this.index,t=this.getAttribute("position");if(void 0!==t){var n=this.getAttribute("normal");if(void 0===n)n=new ol(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(var r=0,i=n.count;r<i;r++)n.setXYZ(r,0,0,0);var a=new Ns,o=new Ns,s=new Ns,u=new Ns,l=new Ns,c=new Ns,h=new Ns,f=new Ns;if(e)for(var d=0,p=e.count;d<p;d+=3){var v=e.getX(d+0),m=e.getX(d+1),g=e.getX(d+2);a.fromBufferAttribute(t,v),o.fromBufferAttribute(t,m),s.fromBufferAttribute(t,g),h.subVectors(s,o),f.subVectors(a,o),h.cross(f),u.fromBufferAttribute(n,v),l.fromBufferAttribute(n,m),c.fromBufferAttribute(n,g),u.add(h),l.add(h),c.add(h),n.setXYZ(v,u.x,u.y,u.z),n.setXYZ(m,l.x,l.y,l.z),n.setXYZ(g,c.x,c.y,c.z)}else for(var y=0,b=t.count;y<b;y+=3)a.fromBufferAttribute(t,y+0),o.fromBufferAttribute(t,y+1),s.fromBufferAttribute(t,y+2),h.subVectors(s,o),f.subVectors(a,o),h.cross(f),n.setXYZ(y+0,h.x,h.y,h.z),n.setXYZ(y+1,h.x,h.y,h.z),n.setXYZ(y+2,h.x,h.y,h.z);this.normalizeNormals(),n.needsUpdate=!0}}},{key:"merge",value:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==e.attributes[r])for(var i=n[r].array,a=e.attributes[r],o=a.array,s=a.itemSize*t,u=Math.min(o.length,i.length-s),l=0,c=s;l<u;l++,c++)i[c]=o[l];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)}},{key:"normalizeNormals",value:function(){for(var e=this.attributes.normal,t=0,n=e.count;t<n;t++)Sl.fromBufferAttribute(e,t),Sl.normalize(),e.setXYZ(t,Sl.x,Sl.y,Sl.z)}},{key:"toNonIndexed",value:function(){function e(e,t){for(var n=e.array,r=e.itemSize,i=e.normalized,a=new n.constructor(t.length*r),o=0,s=0,u=0,l=t.length;u<l;u++){o=e.isInterleavedBufferAttribute?t[u]*e.data.stride+e.offset:t[u]*r;for(var c=0;c<r;c++)a[s++]=n[o++]}return new ol(a,r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;var t=new n,r=this.index.array,i=this.attributes;for(var a in i){var o=e(i[a],r);t.setAttribute(a,o)}var s=this.morphAttributes;for(var u in s){for(var l=[],c=s[u],h=0,f=c.length;h<f;h++){var d=e(c[h],r);l.push(d)}t.morphAttributes[u]=l}t.morphTargetsRelative=this.morphTargetsRelative;for(var p=this.groups,v=0,m=p.length;v<m;v++){var g=p[v];t.addGroup(g.start,g.count,g.materialIndex)}return t}},{key:"toJSON",value:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};var r=this.index;null!==r&&(e.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var i=this.attributes;for(var a in i){var o=i[a];e.data.attributes[a]=o.toJSON(e.data)}var s={},u=!1;for(var l in this.morphAttributes){for(var c=this.morphAttributes[l],h=[],f=0,d=c.length;f<d;f++){var p=c[f];h.push(p.toJSON(e.data))}h.length>0&&(s[l]=h,u=!0)}u&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);var v=this.groups;v.length>0&&(e.data.groups=JSON.parse(JSON.stringify(v)));var m=this.boundingSphere;return null!==m&&(e.data.boundingSphere={center:m.center.toArray(),radius:m.radius}),e}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var t={};this.name=e.name;var n=e.index;null!==n&&this.setIndex(n.clone(t));var r=e.attributes;for(var i in r){var a=r[i];this.setAttribute(i,a.clone(t))}var o=e.morphAttributes;for(var s in o){for(var u=[],l=o[s],c=0,h=l.length;c<h;c++)u.push(l[c].clone(t));this.morphAttributes[s]=u}this.morphTargetsRelative=e.morphTargetsRelative;for(var f=e.groups,d=0,p=f.length;d<p;d++){var v=f[d];this.addGroup(v.start,v.count,v.materialIndex)}var m=e.boundingBox;null!==m&&(this.boundingBox=m.clone());var g=e.boundingSphere;return null!==g&&(this.boundingSphere=g.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),n}(rs);Ml.prototype.isBufferGeometry=!0;var kl=new hu,Tl=new cu,El=new nu,Cl=new Ns,Al=new Ns,Rl=new Ns,Pl=new Ns,Ll=new Ns,Dl=new Ns,Nl=new Ns,Il=new Ns,Ol=new Ns,Ul=new gs,Fl=new gs,zl=new gs,Bl=new Ns,Vl=new Ns,Gl=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ml,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new rl;return(0,u.Z)(this,n),(e=t.call(this)).type="Mesh",e.geometry=r,e.material=i,e.updateMorphTargets(),e}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}},{key:"updateMorphTargets",value:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,a=r.length;i<a;i++){var o=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=i}}}}else{var s=e.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}},{key:"raycast",value:function(e,t){var n,r=this.geometry,i=this.material,a=this.matrixWorld;if(void 0!==i&&(null===r.boundingSphere&&r.computeBoundingSphere(),El.copy(r.boundingSphere),El.applyMatrix4(a),!1!==e.ray.intersectsSphere(El)&&(kl.copy(a).invert(),Tl.copy(e.ray).applyMatrix4(kl),null===r.boundingBox||!1!==Tl.intersectsBox(r.boundingBox))))if(r.isBufferGeometry){var o=r.index,s=r.attributes.position,u=r.morphAttributes.position,l=r.morphTargetsRelative,c=r.attributes.uv,h=r.attributes.uv2,f=r.groups,d=r.drawRange;if(null!==o)if(Array.isArray(i))for(var p=0,v=f.length;p<v;p++)for(var m=f[p],g=i[m.materialIndex],y=Math.max(m.start,d.start),b=Math.min(o.count,Math.min(m.start+m.count,d.start+d.count));y<b;y+=3){var _=o.getX(y),x=o.getX(y+1),w=o.getX(y+2);(n=jl(this,g,e,Tl,s,u,l,c,h,_,x,w))&&(n.faceIndex=Math.floor(y/3),n.face.materialIndex=m.materialIndex,t.push(n))}else for(var S=Math.max(0,d.start),M=Math.min(o.count,d.start+d.count);S<M;S+=3){var k=o.getX(S),T=o.getX(S+1),E=o.getX(S+2);(n=jl(this,i,e,Tl,s,u,l,c,h,k,T,E))&&(n.faceIndex=Math.floor(S/3),t.push(n))}else if(void 0!==s)if(Array.isArray(i))for(var C=0,A=f.length;C<A;C++)for(var R=f[C],P=i[R.materialIndex],L=Math.max(R.start,d.start),D=Math.min(s.count,Math.min(R.start+R.count,d.start+d.count));L<D;L+=3){(n=jl(this,P,e,Tl,s,u,l,c,h,L,L+1,L+2))&&(n.faceIndex=Math.floor(L/3),n.face.materialIndex=R.materialIndex,t.push(n))}else for(var N=Math.max(0,d.start),I=Math.min(s.count,d.start+d.count);N<I;N+=3){(n=jl(this,i,e,Tl,s,u,l,c,h,N,N+1,N+2))&&(n.faceIndex=Math.floor(N/3),t.push(n))}}else r.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}]),n}(Ou);function jl(e,t,n,r,i,a,o,s,u,l,c,h){Cl.fromBufferAttribute(i,l),Al.fromBufferAttribute(i,c),Rl.fromBufferAttribute(i,h);var f=e.morphTargetInfluences;if(a&&f){Nl.set(0,0,0),Il.set(0,0,0),Ol.set(0,0,0);for(var d=0,p=a.length;d<p;d++){var v=f[d],m=a[d];0!==v&&(Pl.fromBufferAttribute(m,l),Ll.fromBufferAttribute(m,c),Dl.fromBufferAttribute(m,h),o?(Nl.addScaledVector(Pl,v),Il.addScaledVector(Ll,v),Ol.addScaledVector(Dl,v)):(Nl.addScaledVector(Pl.sub(Cl),v),Il.addScaledVector(Ll.sub(Al),v),Ol.addScaledVector(Dl.sub(Rl),v)))}Cl.add(Nl),Al.add(Il),Rl.add(Ol)}e.isSkinnedMesh&&(e.boneTransform(l,Cl),e.boneTransform(c,Al),e.boneTransform(h,Rl));var g=function(e,t,n,r,i,a,o,s){if(null===(t.side===Ur?r.intersectTriangle(o,a,i,!0,s):r.intersectTriangle(i,a,o,t.side!==Fr,s)))return null;Vl.copy(s),Vl.applyMatrix4(e.matrixWorld);var u=n.ray.origin.distanceTo(Vl);return u<n.near||u>n.far?null:{distance:u,point:Vl.clone(),object:e}}(e,t,n,r,Cl,Al,Rl,Bl);if(g){s&&(Ul.fromBufferAttribute(s,l),Fl.fromBufferAttribute(s,c),zl.fromBufferAttribute(s,h),g.uv=qu.getUV(Bl,Cl,Al,Rl,Ul,Fl,zl,new gs)),u&&(Ul.fromBufferAttribute(u,l),Fl.fromBufferAttribute(u,c),zl.fromBufferAttribute(u,h),g.uv2=qu.getUV(Bl,Cl,Al,Rl,Ul,Fl,zl,new gs));var y={a:l,b:c,c:h,normal:new Ns,materialIndex:0};qu.getNormal(Cl,Al,Rl,y.normal),g.face=y}return g}Gl.prototype.isMesh=!0;var Hl=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;(0,u.Z)(this,n),(e=t.call(this)).type="BoxGeometry",e.parameters={width:r,height:i,depth:a,widthSegments:o,heightSegments:s,depthSegments:l};var h=(0,c.Z)(e);o=Math.floor(o),s=Math.floor(s),l=Math.floor(l);var f=[],d=[],p=[],v=[],m=0,g=0;function y(e,t,n,r,i,a,o,s,u,l,c){for(var y=a/u,b=o/l,_=a/2,x=o/2,w=s/2,S=u+1,M=l+1,k=0,T=0,E=new Ns,C=0;C<M;C++)for(var A=C*b-x,R=0;R<S;R++){var P=R*y-_;E[e]=P*r,E[t]=A*i,E[n]=w,d.push(E.x,E.y,E.z),E[e]=0,E[t]=0,E[n]=s>0?1:-1,p.push(E.x,E.y,E.z),v.push(R/u),v.push(1-C/l),k+=1}for(var L=0;L<l;L++)for(var D=0;D<u;D++){var N=m+D+S*L,I=m+D+S*(L+1),O=m+(D+1)+S*(L+1),U=m+(D+1)+S*L;f.push(N,I,U),f.push(I,O,U),T+=6}h.addGroup(g,T,c),g+=T,m+=k}return y("z","y","x",-1,-1,a,i,r,l,s,0),y("z","y","x",1,-1,a,i,-r,l,s,1),y("x","z","y",1,1,r,a,i,o,l,2),y("x","z","y",1,-1,r,a,-i,o,l,3),y("x","y","z",1,-1,r,i,a,o,s,4),y("x","y","z",-1,-1,r,i,-a,o,s,5),e.setIndex(f),e.setAttribute("position",new vl(d,3)),e.setAttribute("normal",new vl(p,3)),e.setAttribute("uv",new vl(v,2)),e}return(0,l.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}]),n}(Ml);function Wl(e){var t={};for(var n in e)for(var r in t[n]={},e[n]){var i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}return t}function Zl(e){for(var t={},n=0;n<e.length;n++){var r=Wl(e[n]);for(var i in r)t[i]=r[i]}return t}var ql={clone:Wl,merge:Zl},Xl=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).type="ShaderMaterial",r.defines={},r.uniforms={},r.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",r.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",r.linewidth=1,r.wireframe=!1,r.wireframeLinewidth=1,r.fog=!1,r.lights=!1,r.clipping=!1,r.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},r.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},r.index0AttributeName=void 0,r.uniformsNeedUpdate=!1,r.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),r.setValues(e)),r}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Wl(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}},{key:"toJSON",value:function(e){var t=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this,e);for(var r in t.glslVersion=this.glslVersion,t.uniforms={},this.uniforms){var i=this.uniforms[r].value;i&&i.isTexture?t.uniforms[r]={type:"t",value:i.toJSON(e).uuid}:i&&i.isColor?t.uniforms[r]={type:"c",value:i.getHex()}:i&&i.isVector2?t.uniforms[r]={type:"v2",value:i.toArray()}:i&&i.isVector3?t.uniforms[r]={type:"v3",value:i.toArray()}:i&&i.isVector4?t.uniforms[r]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?t.uniforms[r]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?t.uniforms[r]={type:"m4",value:i.toArray()}:t.uniforms[r]={value:i}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;var a={};for(var o in this.extensions)!0===this.extensions[o]&&(a[o]=!0);return Object.keys(a).length>0&&(t.extensions=a),t}}]),n}(Yu);Xl.prototype.isShaderMaterial=!0;var Yl=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.call(this)).type="Camera",e.matrixWorldInverse=new hu,e.projectionMatrix=new hu,e.projectionMatrixInverse=new hu,e}return(0,l.Z)(n,[{key:"copy",value:function(e,t){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}},{key:"getWorldDirection",value:function(e){this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}},{key:"updateMatrixWorld",value:function(e){wr((0,_r.Z)(n.prototype),"updateMatrixWorld",this).call(this,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}},{key:"updateWorldMatrix",value:function(e,t){wr((0,_r.Z)(n.prototype),"updateWorldMatrix",this).call(this,e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),n}(Ou);Yl.prototype.isCamera=!0;var Kl=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;return(0,u.Z)(this,n),(e=t.call(this)).type="PerspectiveCamera",e.fov=r,e.zoom=1,e.near=a,e.far=o,e.focus=10,e.aspect=i,e.view=null,e.filmGauge=35,e.filmOffset=0,e.updateProjectionMatrix(),e}return(0,l.Z)(n,[{key:"copy",value:function(e,t){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}},{key:"setFocalLength",value:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*us*Math.atan(t),this.updateProjectionMatrix()}},{key:"getFocalLength",value:function(){var e=Math.tan(.5*ss*this.fov);return.5*this.getFilmHeight()/e}},{key:"getEffectiveFOV",value:function(){return 2*us*Math.atan(Math.tan(.5*ss*this.fov)/this.zoom)}},{key:"getFilmWidth",value:function(){return this.filmGauge*Math.min(this.aspect,1)}},{key:"getFilmHeight",value:function(){return this.filmGauge/Math.max(this.aspect,1)}},{key:"setViewOffset",value:function(e,t,n,r,i,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}},{key:"clearViewOffset",value:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}},{key:"updateProjectionMatrix",value:function(){var e=this.near,t=e*Math.tan(.5*ss*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r,a=this.view;if(null!==this.view&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;i+=a.offsetX*r/o,t-=a.offsetY*n/s,r*=a.width/o,n*=a.height/s}var u=this.filmOffset;0!==u&&(i+=e*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}},{key:"toJSON",value:function(e){var t=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}]),n}(Yl);Kl.prototype.isPerspectiveCamera=!0;var Jl=90,Ql=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i){var a;if((0,u.Z)(this,n),(a=t.call(this)).type="CubeCamera",!0!==i.isWebGLCubeRenderTarget)return console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter."),(0,br.Z)(a);a.renderTarget=i;var o=new Kl(Jl,1,e,r);o.layers=a.layers,o.up.set(0,-1,0),o.lookAt(new Ns(1,0,0)),a.add(o);var s=new Kl(Jl,1,e,r);s.layers=a.layers,s.up.set(0,-1,0),s.lookAt(new Ns(-1,0,0)),a.add(s);var l=new Kl(Jl,1,e,r);l.layers=a.layers,l.up.set(0,0,1),l.lookAt(new Ns(0,1,0)),a.add(l);var c=new Kl(Jl,1,e,r);c.layers=a.layers,c.up.set(0,0,-1),c.lookAt(new Ns(0,-1,0)),a.add(c);var h=new Kl(Jl,1,e,r);h.layers=a.layers,h.up.set(0,-1,0),h.lookAt(new Ns(0,0,1)),a.add(h);var f=new Kl(Jl,1,e,r);return f.layers=a.layers,f.up.set(0,-1,0),f.lookAt(new Ns(0,0,-1)),a.add(f),a}return(0,l.Z)(n,[{key:"update",value:function(e,t){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,r=vr(this.children,6),i=r[0],a=r[1],o=r[2],s=r[3],u=r[4],l=r[5],c=e.xr.enabled,h=e.getRenderTarget();e.xr.enabled=!1;var f=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,i),e.setRenderTarget(n,1),e.render(t,a),e.setRenderTarget(n,2),e.render(t,o),e.setRenderTarget(n,3),e.render(t,s),e.setRenderTarget(n,4),e.render(t,u),n.texture.generateMipmaps=f,e.setRenderTarget(n,5),e.render(t,l),e.setRenderTarget(h),e.xr.enabled=c}}]),n}(Ou),$l=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i,a,o,s,l,c,h,f){var d;return(0,u.Z)(this,n),e=void 0!==e?e:[],r=void 0!==r?r:Ei,(d=t.call(this,e,r,i,a,o,s,l,c,h,f)).flipY=!1,d}return(0,l.Z)(n,[{key:"images",get:function(){return this.image},set:function(e){this.image=e}}]),n}(Es);$l.prototype.isCubeTexture=!0;var ec=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i){var a;return(0,u.Z)(this,n),Number.isInteger(r)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),r=i),a=t.call(this,e,e,r),r=r||{},a.texture=new $l(void 0,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),a.texture.isRenderTargetTexture=!0,a.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,a.texture.minFilter=void 0!==r.minFilter?r.minFilter:Vi,a.texture._needsFlipEnvMap=!1,a}return(0,l.Z)(n,[{key:"fromEquirectangularTexture",value:function(e,t){this.texture.type=t.type,this.texture.format=oa,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;var n={tEquirect:{value:null}},r="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",a=new Hl(5,5,5),o=new Xl({name:"CubemapFromEquirect",uniforms:Wl(n),vertexShader:r,fragmentShader:i,side:Ur,blending:Vr});o.uniforms.tEquirect.value=t;var s=new Gl(a,o),u=t.minFilter;return t.minFilter===Hi&&(t.minFilter=Vi),new Ql(1,10,this).update(e,s),t.minFilter=u,s.geometry.dispose(),s.material.dispose(),this}},{key:"clear",value:function(e,t,n,r){for(var i=e.getRenderTarget(),a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,r);e.setRenderTarget(i)}}]),n}(Rs);ec.prototype.isWebGLCubeRenderTarget=!0;var tc=new Ns,nc=new Ns,rc=new ys,ic=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ns(1,0,0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,u.Z)(this,e),this.normal=t,this.constant=n}return(0,l.Z)(e,[{key:"set",value:function(e,t){return this.normal.copy(e),this.constant=t,this}},{key:"setComponents",value:function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}},{key:"setFromNormalAndCoplanarPoint",value:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}},{key:"setFromCoplanarPoints",value:function(e,t,n){var r=tc.subVectors(n,t).cross(nc.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}},{key:"copy",value:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this}},{key:"normalize",value:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}},{key:"negate",value:function(){return this.constant*=-1,this.normal.negate(),this}},{key:"distanceToPoint",value:function(e){return this.normal.dot(e)+this.constant}},{key:"distanceToSphere",value:function(e){return this.distanceToPoint(e.center)-e.radius}},{key:"projectPoint",value:function(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}},{key:"intersectLine",value:function(e,t){var n=e.delta(tc),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;var i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(n).multiplyScalar(i).add(e.start)}},{key:"intersectsLine",value:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}},{key:"intersectsBox",value:function(e){return e.intersectsPlane(this)}},{key:"intersectsSphere",value:function(e){return e.intersectsPlane(this)}},{key:"coplanarPoint",value:function(e){return e.copy(this.normal).multiplyScalar(-this.constant)}},{key:"applyMatrix4",value:function(e,t){var n=t||rc.getNormalMatrix(e),r=this.coplanarPoint(tc).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}},{key:"translate",value:function(e){return this.constant-=e.dot(this.normal),this}},{key:"equals",value:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}();ic.prototype.isPlane=!0;var ac=new nu,oc=new Ns,sc=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ic,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ic,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ic,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new ic,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new ic,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new ic;(0,u.Z)(this,e),this.planes=[t,n,r,i,a,o]}return(0,l.Z)(e,[{key:"set",value:function(e,t,n,r,i,a){var o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(r),o[4].copy(i),o[5].copy(a),this}},{key:"copy",value:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this}},{key:"setFromProjectionMatrix",value:function(e){var t=this.planes,n=e.elements,r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],u=n[5],l=n[6],c=n[7],h=n[8],f=n[9],d=n[10],p=n[11],v=n[12],m=n[13],g=n[14],y=n[15];return t[0].setComponents(o-r,c-s,p-h,y-v).normalize(),t[1].setComponents(o+r,c+s,p+h,y+v).normalize(),t[2].setComponents(o+i,c+u,p+f,y+m).normalize(),t[3].setComponents(o-i,c-u,p-f,y-m).normalize(),t[4].setComponents(o-a,c-l,p-d,y-g).normalize(),t[5].setComponents(o+a,c+l,p+d,y+g).normalize(),this}},{key:"intersectsObject",value:function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),ac.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(ac)}},{key:"intersectsSprite",value:function(e){return ac.center.set(0,0,0),ac.radius=.7071067811865476,ac.applyMatrix4(e.matrixWorld),this.intersectsSphere(ac)}},{key:"intersectsSphere",value:function(e){for(var t=this.planes,n=e.center,r=-e.radius,i=0;i<6;i++){if(t[i].distanceToPoint(n)<r)return!1}return!0}},{key:"intersectsBox",value:function(e){for(var t=this.planes,n=0;n<6;n++){var r=t[n];if(oc.x=r.normal.x>0?e.max.x:e.min.x,oc.y=r.normal.y>0?e.max.y:e.min.y,oc.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(oc)<0)return!1}return!0}},{key:"containsPoint",value:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}();function uc(){var e=null,t=!1,n=null,r=null;function i(t,a){n(t,a),r=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function lc(e,t){var n=t.isWebGL2,r=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),r.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);var n=r.get(t);n&&(e.deleteBuffer(n.buffer),r.delete(t))},update:function(t,i){if(t.isGLBufferAttribute){var a=r.get(t);(!a||a.version<t.version)&&r.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version})}else{t.isInterleavedBufferAttribute&&(t=t.data);var o=r.get(t);void 0===o?r.set(t,function(t,r){var i=t.array,a=t.usage,o=e.createBuffer();e.bindBuffer(r,o),e.bufferData(r,i,a),t.onUploadCallback();var s=5126;return i instanceof Float32Array?s=5126:i instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):i instanceof Uint16Array?t.isFloat16BufferAttribute?n?s=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):s=5123:i instanceof Int16Array?s=5122:i instanceof Uint32Array?s=5125:i instanceof Int32Array?s=5124:i instanceof Int8Array?s=5120:(i instanceof Uint8Array||i instanceof Uint8ClampedArray)&&(s=5121),{buffer:o,type:s,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version}}(t,i)):o.version<t.version&&(!function(t,r,i){var a=r.array,o=r.updateRange;e.bindBuffer(i,t),-1===o.count?e.bufferSubData(i,0,a):(n?e.bufferSubData(i,o.offset*a.BYTES_PER_ELEMENT,a,o.offset,o.count):e.bufferSubData(i,o.offset*a.BYTES_PER_ELEMENT,a.subarray(o.offset,o.offset+o.count)),o.count=-1)}(o.buffer,t,i),o.version=t.version)}}}}var cc=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;(0,u.Z)(this,n),(e=t.call(this)).type="PlaneGeometry",e.parameters={width:r,height:i,widthSegments:a,heightSegments:o};for(var s=r/2,l=i/2,c=Math.floor(a),h=Math.floor(o),f=c+1,d=h+1,p=r/c,v=i/h,m=[],g=[],y=[],b=[],_=0;_<d;_++)for(var x=_*v-l,w=0;w<f;w++){var S=w*p-s;g.push(S,-x,0),y.push(0,0,1),b.push(w/c),b.push(1-_/h)}for(var M=0;M<h;M++)for(var k=0;k<c;k++){var T=k+f*M,E=k+f*(M+1),C=k+1+f*(M+1),A=k+1+f*M;m.push(T,E,A),m.push(E,C,A)}return e.setIndex(m),e.setAttribute("position",new vl(g,3)),e.setAttribute("normal",new vl(y,3)),e.setAttribute("uv",new vl(b,2)),e}return(0,l.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.width,e.height,e.widthSegments,e.heightSegments)}}]),n}(Ml),hc={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec;\n\t\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\t\treflectVec = reflect( - viewDir, normal );\n\t\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\t#else\n\t\t\t\treflectVec = refract( - viewDir, normal, refractionRatio );\n\t\t\t#endif\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tlightMapIrradiance *= PI;\n\t#endif\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= specularColorMapTexelToLinear( texture2D( specularColorMap, vUv ) ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= sheenColorMapTexelToLinear( texture2D( sheenColorMap, vUv ) ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] > 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform vec2 morphTargetsTextureSize;\n\t\tvec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {\n\t\t\tfloat texelIndex = float( vertexIndex * stride + offset );\n\t\t\tfloat y = floor( texelIndex / morphTargetsTextureSize.x );\n\t\t\tfloat x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tvec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );\n\t\t\treturn texture( morphTargetsTexture, morphUV ).xyz;\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\t#ifndef USE_MORPHNORMALS\n\t\t\t\tif ( morphTargetInfluences[ i ] > 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];\n\t\t\t#else\n\t\t\t\tif ( morphTargetInfluences[ i ] > 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];\n\t\t\t#endif\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( float roughness, float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( vec2 fragCoord, float roughness, float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 diffuseColor, vec3 specularColor, float specularF90,\n\t\tvec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,\n\t\tvec3 attenuationColor, float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},fc={common:{diffuse:{value:new nl(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new ys},uv2Transform:{value:new ys},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new gs(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new nl(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new nl(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ys}},sprite:{diffuse:{value:new nl(16777215)},opacity:{value:1},center:{value:new gs(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ys}}},dc={basic:{uniforms:Zl([fc.common,fc.specularmap,fc.envmap,fc.aomap,fc.lightmap,fc.fog]),vertexShader:hc.meshbasic_vert,fragmentShader:hc.meshbasic_frag},lambert:{uniforms:Zl([fc.common,fc.specularmap,fc.envmap,fc.aomap,fc.lightmap,fc.emissivemap,fc.fog,fc.lights,{emissive:{value:new nl(0)}}]),vertexShader:hc.meshlambert_vert,fragmentShader:hc.meshlambert_frag},phong:{uniforms:Zl([fc.common,fc.specularmap,fc.envmap,fc.aomap,fc.lightmap,fc.emissivemap,fc.bumpmap,fc.normalmap,fc.displacementmap,fc.fog,fc.lights,{emissive:{value:new nl(0)},specular:{value:new nl(1118481)},shininess:{value:30}}]),vertexShader:hc.meshphong_vert,fragmentShader:hc.meshphong_frag},standard:{uniforms:Zl([fc.common,fc.envmap,fc.aomap,fc.lightmap,fc.emissivemap,fc.bumpmap,fc.normalmap,fc.displacementmap,fc.roughnessmap,fc.metalnessmap,fc.fog,fc.lights,{emissive:{value:new nl(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:hc.meshphysical_vert,fragmentShader:hc.meshphysical_frag},toon:{uniforms:Zl([fc.common,fc.aomap,fc.lightmap,fc.emissivemap,fc.bumpmap,fc.normalmap,fc.displacementmap,fc.gradientmap,fc.fog,fc.lights,{emissive:{value:new nl(0)}}]),vertexShader:hc.meshtoon_vert,fragmentShader:hc.meshtoon_frag},matcap:{uniforms:Zl([fc.common,fc.bumpmap,fc.normalmap,fc.displacementmap,fc.fog,{matcap:{value:null}}]),vertexShader:hc.meshmatcap_vert,fragmentShader:hc.meshmatcap_frag},points:{uniforms:Zl([fc.points,fc.fog]),vertexShader:hc.points_vert,fragmentShader:hc.points_frag},dashed:{uniforms:Zl([fc.common,fc.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:hc.linedashed_vert,fragmentShader:hc.linedashed_frag},depth:{uniforms:Zl([fc.common,fc.displacementmap]),vertexShader:hc.depth_vert,fragmentShader:hc.depth_frag},normal:{uniforms:Zl([fc.common,fc.bumpmap,fc.normalmap,fc.displacementmap,{opacity:{value:1}}]),vertexShader:hc.meshnormal_vert,fragmentShader:hc.meshnormal_frag},sprite:{uniforms:Zl([fc.sprite,fc.fog]),vertexShader:hc.sprite_vert,fragmentShader:hc.sprite_frag},background:{uniforms:{uvTransform:{value:new ys},t2D:{value:null}},vertexShader:hc.background_vert,fragmentShader:hc.background_frag},cube:{uniforms:Zl([fc.envmap,{opacity:{value:1}}]),vertexShader:hc.cube_vert,fragmentShader:hc.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:hc.equirect_vert,fragmentShader:hc.equirect_frag},distanceRGBA:{uniforms:Zl([fc.common,fc.displacementmap,{referencePosition:{value:new Ns},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:hc.distanceRGBA_vert,fragmentShader:hc.distanceRGBA_frag},shadow:{uniforms:Zl([fc.lights,fc.fog,{color:{value:new nl(0)},opacity:{value:1}}]),vertexShader:hc.shadow_vert,fragmentShader:hc.shadow_frag}};function pc(e,t,n,r,i){var a,o,s=new nl(0),u=0,l=null,c=0,h=null;function f(e,t){n.buffers.color.setClear(e.r,e.g,e.b,t,i)}return{getClearColor:function(){return s},setClearColor:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;s.set(e),f(s,u=t)},getClearAlpha:function(){return u},setClearAlpha:function(e){f(s,u=e)},render:function(n,i){var d=!1,p=!0===i.isScene?i.background:null;p&&p.isTexture&&(p=t.get(p));var v=e.xr,m=v.getSession&&v.getSession();m&&"additive"===m.environmentBlendMode&&(p=null),null===p?f(s,u):p&&p.isColor&&(f(p,1),d=!0),(e.autoClear||d)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),p&&(p.isCubeTexture||p.mapping===Pi)?(void 0===o&&((o=new Gl(new Hl(1,1,1),new Xl({name:"BackgroundCubeMaterial",uniforms:Wl(dc.cube.uniforms),vertexShader:dc.cube.vertexShader,fragmentShader:dc.cube.fragmentShader,side:Ur,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),o.geometry.deleteAttribute("uv"),o.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(o.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(o)),o.material.uniforms.envMap.value=p,o.material.uniforms.flipEnvMap.value=p.isCubeTexture&&!1===p.isRenderTargetTexture?-1:1,l===p&&c===p.version&&h===e.toneMapping||(o.material.needsUpdate=!0,l=p,c=p.version,h=e.toneMapping),n.unshift(o,o.geometry,o.material,0,0,null)):p&&p.isTexture&&(void 0===a&&((a=new Gl(new cc(2,2),new Xl({name:"BackgroundMaterial",uniforms:Wl(dc.background.uniforms),vertexShader:dc.background.vertexShader,fragmentShader:dc.background.fragmentShader,side:Or,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(a.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(a)),a.material.uniforms.t2D.value=p,!0===p.matrixAutoUpdate&&p.updateMatrix(),a.material.uniforms.uvTransform.value.copy(p.matrix),l===p&&c===p.version&&h===e.toneMapping||(a.material.needsUpdate=!0,l=p,c=p.version,h=e.toneMapping),n.unshift(a,a.geometry,a.material,0,0,null))}}}function vc(e,t,n,r){var i=e.getParameter(34921),a=r.isWebGL2?null:t.get("OES_vertex_array_object"),o=r.isWebGL2||null!==a,s={},u=f(null),l=u;function c(t){return r.isWebGL2?e.bindVertexArray(t):a.bindVertexArrayOES(t)}function h(t){return r.isWebGL2?e.deleteVertexArray(t):a.deleteVertexArrayOES(t)}function f(e){for(var t=[],n=[],r=[],a=0;a<i;a++)t[a]=0,n[a]=0,r[a]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:r,object:e,attributes:{},index:null}}function d(){for(var e=l.newAttributes,t=0,n=e.length;t<n;t++)e[t]=0}function p(e){v(e,0)}function v(n,i){var a=l.newAttributes,o=l.enabledAttributes,s=l.attributeDivisors;(a[n]=1,0===o[n]&&(e.enableVertexAttribArray(n),o[n]=1),s[n]!==i)&&((r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),s[n]=i)}function m(){for(var t=l.newAttributes,n=l.enabledAttributes,r=0,i=n.length;r<i;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function g(t,n,i,a,o,s){!0!==r.isWebGL2||5124!==i&&5125!==i?e.vertexAttribPointer(t,n,i,a,o,s):e.vertexAttribIPointer(t,n,i,o,s)}function y(){b(),l!==u&&c((l=u).object)}function b(){u.geometry=null,u.program=null,u.wireframe=!1}return{setup:function(i,u,h,y,b){var _=!1;if(o){var x=function(t,n,i){var o=!0===i.wireframe,u=s[t.id];void 0===u&&(u={},s[t.id]=u);var l=u[n.id];void 0===l&&(l={},u[n.id]=l);var c=l[o];void 0===c&&(c=f(r.isWebGL2?e.createVertexArray():a.createVertexArrayOES()),l[o]=c);return c}(y,h,u);l!==x&&c((l=x).object),_=function(e,t){var n=l.attributes,r=e.attributes,i=0;for(var a in r){var o=n[a],s=r[a];if(void 0===o)return!0;if(o.attribute!==s)return!0;if(o.data!==s.data)return!0;i++}return l.attributesNum!==i||l.index!==t}(y,b),_&&function(e,t){var n={},r=e.attributes,i=0;for(var a in r){var o=r[a],s={};s.attribute=o,o.data&&(s.data=o.data),n[a]=s,i++}l.attributes=n,l.attributesNum=i,l.index=t}(y,b)}else{var w=!0===u.wireframe;l.geometry===y.id&&l.program===h.id&&l.wireframe===w||(l.geometry=y.id,l.program=h.id,l.wireframe=w,_=!0)}!0===i.isInstancedMesh&&(_=!0),null!==b&&n.update(b,34963),_&&(!function(i,a,o,s){if(!1===r.isWebGL2&&(i.isInstancedMesh||s.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;d();var u=s.attributes,l=o.getAttributes(),c=a.defaultAttributeValues;for(var h in l){var f=l[h];if(f.location>=0){var y=u[h];if(void 0===y&&("instanceMatrix"===h&&i.instanceMatrix&&(y=i.instanceMatrix),"instanceColor"===h&&i.instanceColor&&(y=i.instanceColor)),void 0!==y){var b=y.normalized,_=y.itemSize,x=n.get(y);if(void 0===x)continue;var w=x.buffer,S=x.type,M=x.bytesPerElement;if(y.isInterleavedBufferAttribute){var k=y.data,T=k.stride,E=y.offset;if(k&&k.isInstancedInterleavedBuffer){for(var C=0;C<f.locationSize;C++)v(f.location+C,k.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=k.meshPerAttribute*k.count)}else for(var A=0;A<f.locationSize;A++)p(f.location+A);e.bindBuffer(34962,w);for(var R=0;R<f.locationSize;R++)g(f.location+R,_/f.locationSize,S,b,T*M,(E+_/f.locationSize*R)*M)}else{if(y.isInstancedBufferAttribute){for(var P=0;P<f.locationSize;P++)v(f.location+P,y.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=y.meshPerAttribute*y.count)}else for(var L=0;L<f.locationSize;L++)p(f.location+L);e.bindBuffer(34962,w);for(var D=0;D<f.locationSize;D++)g(f.location+D,_/f.locationSize,S,b,_*M,_/f.locationSize*D*M)}}else if(void 0!==c){var N=c[h];if(void 0!==N)switch(N.length){case 2:e.vertexAttrib2fv(f.location,N);break;case 3:e.vertexAttrib3fv(f.location,N);break;case 4:e.vertexAttrib4fv(f.location,N);break;default:e.vertexAttrib1fv(f.location,N)}}}}m()}(i,u,h,y),null!==b&&e.bindBuffer(34963,n.get(b).buffer))},reset:y,resetDefaultState:b,dispose:function(){for(var e in y(),s){var t=s[e];for(var n in t){var r=t[n];for(var i in r)h(r[i].object),delete r[i];delete t[n]}delete s[e]}},releaseStatesOfGeometry:function(e){if(void 0!==s[e.id]){var t=s[e.id];for(var n in t){var r=t[n];for(var i in r)h(r[i].object),delete r[i];delete t[n]}delete s[e.id]}},releaseStatesOfProgram:function(e){for(var t in s){var n=s[t];if(void 0!==n[e.id]){var r=n[e.id];for(var i in r)h(r[i].object),delete r[i];delete n[e.id]}}},initAttributes:d,enableAttribute:p,disableUnusedAttributes:m}}function mc(e,t,n,r){var i,a=r.isWebGL2;this.setMode=function(e){i=e},this.render=function(t,r){e.drawArrays(i,t,r),n.update(r,i,1)},this.renderInstances=function(r,o,s){if(0!==s){var u,l;if(a)u=e,l="drawArraysInstanced";else if(l="drawArraysInstancedANGLE",null===(u=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[l](i,r,o,s),n.update(o,i,s)}}}function gc(e,t,n){var r;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var a="undefined"!==typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!==typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext,o=void 0!==n.precision?n.precision:"highp",s=i(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);var u=a||t.has("WEBGL_draw_buffers"),l=!0===n.logarithmicDepthBuffer,c=e.getParameter(34930),h=e.getParameter(35660),f=e.getParameter(3379),d=e.getParameter(34076),p=e.getParameter(34921),v=e.getParameter(36347),m=e.getParameter(36348),g=e.getParameter(36349),y=h>0,b=a||t.has("OES_texture_float");return{isWebGL2:a,drawBuffers:u,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===t.has("EXT_texture_filter_anisotropic")){var n=t.get("EXT_texture_filter_anisotropic");r=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:i,precision:o,logarithmicDepthBuffer:l,maxTextures:c,maxVertexTextures:h,maxTextureSize:f,maxCubemapSize:d,maxAttributes:p,maxVertexUniforms:v,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:y,floatFragmentTextures:b,floatVertexTextures:y&&b,maxSamples:a?e.getParameter(36183):0}}function yc(e){var t=this,n=null,r=0,i=!1,a=!1,o=new ic,s=new ys,u={value:null,needsUpdate:!1};function l(){u.value!==n&&(u.value=n,u.needsUpdate=r>0),t.numPlanes=r,t.numIntersection=0}function c(e,n,r,i){var a=null!==e?e.length:0,l=null;if(0!==a){if(l=u.value,!0!==i||null===l){var c=r+4*a,h=n.matrixWorldInverse;s.getNormalMatrix(h),(null===l||l.length<c)&&(l=new Float32Array(c));for(var f=0,d=r;f!==a;++f,d+=4)o.copy(e[f]).applyMatrix4(h,s),o.normal.toArray(l,d),l[d+3]=o.constant}u.value=l,u.needsUpdate=!0}return t.numPlanes=a,t.numIntersection=0,l}this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,a){var o=0!==e.length||t||0!==r||i;return i=t,n=c(e,a,0),r=e.length,o},this.beginShadows=function(){a=!0,c(null)},this.endShadows=function(){a=!1,l()},this.setState=function(t,o,s){var h=t.clippingPlanes,f=t.clipIntersection,d=t.clipShadows,p=e.get(t);if(!i||null===h||0===h.length||a&&!d)a?c(null):l();else{var v=a?0:r,m=4*v,g=p.clippingState||null;u.value=g,g=c(h,o,m,s);for(var y=0;y!==m;++y)g[y]=n[y];p.clippingState=g,this.numIntersection=f?this.numPlanes:0,this.numPlanes+=v}}}function bc(e){var t=new WeakMap;function n(e,t){return t===Ai?e.mapping=Ei:t===Ri&&(e.mapping=Ci),e}function r(e){var n=e.target;n.removeEventListener("dispose",r);var i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture&&!1===i.isRenderTargetTexture){var a=i.mapping;if(a===Ai||a===Ri){if(t.has(i))return n(t.get(i).texture,i.mapping);var o=i.image;if(o&&o.height>0){var s=e.getRenderTarget(),u=new ec(o.height/2);return u.fromEquirectangularTexture(e,i),t.set(i,u),e.setRenderTarget(s),i.addEventListener("dispose",r),n(u.texture,i.mapping)}return null}}return i},dispose:function(){t=new WeakMap}}}dc.physical={uniforms:Zl([dc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new gs(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new nl(0)},sheenColorMap:{value:null},sheenRoughness:{value:0},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new gs},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new nl(0)},specularIntensity:{value:0},specularIntensityMap:{value:null},specularColor:{value:new nl(1,1,1)},specularColorMap:{value:null}}]),vertexShader:hc.meshphysical_vert,fragmentShader:hc.meshphysical_frag};var _c=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;return(0,u.Z)(this,n),(e=t.call(this)).type="OrthographicCamera",e.zoom=1,e.view=null,e.left=r,e.right=i,e.top=a,e.bottom=o,e.near=s,e.far=l,e.updateProjectionMatrix(),e}return(0,l.Z)(n,[{key:"copy",value:function(e,t){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}},{key:"setViewOffset",value:function(e,t,n,r,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}},{key:"clearViewOffset",value:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}},{key:"updateProjectionMatrix",value:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-e,a=n+e,o=r+t,s=r-t;if(null!==this.view&&this.view.enabled){var u=(this.right-this.left)/this.view.fullWidth/this.zoom,l=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a=(i+=u*this.view.offsetX)+u*this.view.width,s=(o-=l*this.view.offsetY)-l*this.view.height}this.projectionMatrix.makeOrthographic(i,a,o,s,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}},{key:"toJSON",value:function(e){var t=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}]),n}(Yl);_c.prototype.isOrthographicCamera=!0;var xc=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).type="RawShaderMaterial",r}return(0,l.Z)(n)}(Xl);xc.prototype.isRawShaderMaterial=!0;var wc=Math.pow(2,8),Sc=[.125,.215,.35,.446,.526,.582],Mc=5+Sc.length,kc=20,Tc=(gr(yr={},bo,0),gr(yr,_o,1),gr(yr,wo,2),gr(yr,So,3),gr(yr,Mo,4),gr(yr,ko,5),gr(yr,xo,6),yr),Ec=new _c,Cc=zc(),Ac=Cc._lodPlanes,Rc=Cc._sizeLods,Pc=Cc._sigmas,Lc=new nl,Dc=null,Nc=(1+Math.sqrt(5))/2,Ic=1/Nc,Oc=[new Ns(1,1,1),new Ns(-1,1,1),new Ns(1,1,-1),new Ns(-1,1,-1),new Ns(0,Nc,Ic),new Ns(0,Nc,-Ic),new Ns(Ic,0,Nc),new Ns(-Ic,0,Nc),new Ns(Nc,Ic,0),new Ns(-Nc,Ic,0)],Uc=function(){function e(t){(0,u.Z)(this,e),this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=function(e){var t=new Float32Array(e),n=new Ns(0,1,0);return new xc({name:"SphericalGaussianBlur",defines:{n:e},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:t},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n},inputEncoding:{value:Tc[bo]},outputEncoding:{value:Tc[bo]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t".concat("\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t","\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t"),blending:Vr,depthTest:!1,depthWrite:!1})}(kc),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}return(0,l.Z)(e,[{key:"fromScene",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;Dc=this._renderer.getRenderTarget();var i=this._allocateTargets();return this._sceneToCubeUV(e,n,r,i),t>0&&this._blur(i,0,0,t),this._applyPMREM(i),this._cleanup(i),i}},{key:"fromEquirectangular",value:function(e){return this._fromTexture(e)}},{key:"fromCubemap",value:function(e){return this._fromTexture(e)}},{key:"compileCubemapShader",value:function(){null===this._cubemapShader&&(this._cubemapShader=jc(),this._compileMaterial(this._cubemapShader))}},{key:"compileEquirectangularShader",value:function(){null===this._equirectShader&&(this._equirectShader=Gc(),this._compileMaterial(this._equirectShader))}},{key:"dispose",value:function(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(var e=0;e<Ac.length;e++)Ac[e].dispose()}},{key:"_cleanup",value:function(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Dc),e.scissorTest=!1,Vc(e,0,0,e.width,e.height)}},{key:"_fromTexture",value:function(e){Dc=this._renderer.getRenderTarget();var t=this._allocateTargets(e);return this._textureToCubeUV(e,t),this._applyPMREM(t),this._cleanup(t),t}},{key:"_allocateTargets",value:function(e){var t={magFilter:Oi,minFilter:Oi,generateMipmaps:!1,type:Zi,format:la,encoding:Fc(e)?e.encoding:wo,depthBuffer:!1},n=Bc(t);return n.depthBuffer=!e,this._pingPongRenderTarget=Bc(t),n}},{key:"_compileMaterial",value:function(e){var t=new Gl(Ac[0],e);this._renderer.compile(t,Ec)}},{key:"_sceneToCubeUV",value:function(e,t,n,r){var i=new Kl(90,1,t,n),a=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],s=this._renderer,u=s.autoClear,l=s.outputEncoding,c=s.toneMapping;s.getClearColor(Lc),s.toneMapping=_i,s.outputEncoding=bo,s.autoClear=!1;var h=new rl({name:"PMREM.Background",side:Ur,depthWrite:!1,depthTest:!1}),f=new Gl(new Hl,h),d=!1,p=e.background;p?p.isColor&&(h.color.copy(p),e.background=null,d=!0):(h.color.copy(Lc),d=!0);for(var v=0;v<6;v++){var m=v%3;0==m?(i.up.set(0,a[v],0),i.lookAt(o[v],0,0)):1==m?(i.up.set(0,0,a[v]),i.lookAt(0,o[v],0)):(i.up.set(0,a[v],0),i.lookAt(0,0,o[v])),Vc(r,m*wc,v>2?wc:0,wc,wc),s.setRenderTarget(r),d&&s.render(f,i),s.render(e,i)}f.geometry.dispose(),f.material.dispose(),s.toneMapping=c,s.outputEncoding=l,s.autoClear=u,e.background=p}},{key:"_setEncoding",value:function(e,t){e.value=Tc[t.encoding]}},{key:"_textureToCubeUV",value:function(e,t){var n=this._renderer,r=e.mapping===Ei||e.mapping===Ci;r?null==this._cubemapShader&&(this._cubemapShader=jc()):null==this._equirectShader&&(this._equirectShader=Gc());var i=r?this._cubemapShader:this._equirectShader,a=new Gl(Ac[0],i),o=i.uniforms;o.envMap.value=e,r||o.texelSize.value.set(1/e.image.width,1/e.image.height),this._setEncoding(o.inputEncoding,e),this._setEncoding(o.outputEncoding,t.texture),Vc(t,0,0,3*wc,2*wc),n.setRenderTarget(t),n.render(a,Ec)}},{key:"_applyPMREM",value:function(e){var t=this._renderer,n=t.autoClear;t.autoClear=!1;for(var r=1;r<Mc;r++){var i=Math.sqrt(Pc[r]*Pc[r]-Pc[r-1]*Pc[r-1]),a=Oc[(r-1)%Oc.length];this._blur(e,r-1,r,i,a)}t.autoClear=n}},{key:"_blur",value:function(e,t,n,r,i){var a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",i),this._halfBlur(a,e,n,n,r,"longitudinal",i)}},{key:"_halfBlur",value:function(e,t,n,r,i,a,o){var s=this._renderer,u=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");var l=new Gl(Ac[r],u),c=u.uniforms,h=Rc[n]-1,f=isFinite(i)?Math.PI/(2*h):2*Math.PI/39,d=i/f,p=isFinite(i)?1+Math.floor(3*d):kc;p>kc&&console.warn("sigmaRadians, ".concat(i,", is too large and will clip, as it requested ").concat(p," samples when the maximum is set to ").concat(kc));for(var v=[],m=0,g=0;g<kc;++g){var y=g/d,b=Math.exp(-y*y/2);v.push(b),0==g?m+=b:g<p&&(m+=2*b)}for(var _=0;_<v.length;_++)v[_]=v[_]/m;c.envMap.value=e.texture,c.samples.value=p,c.weights.value=v,c.latitudinal.value="latitudinal"===a,o&&(c.poleAxis.value=o),c.dTheta.value=f,c.mipInt.value=8-n,this._setEncoding(c.inputEncoding,e.texture),this._setEncoding(c.outputEncoding,e.texture);var x=Rc[r];Vc(t,3*Math.max(0,wc-2*x),(0===r?0:2*wc)+2*x*(r>4?r-8+4:0),3*x,2*x),s.setRenderTarget(t),s.render(l,Ec)}}]),e}();function Fc(e){return void 0!==e&&e.type===Zi&&(e.encoding===bo||e.encoding===_o||e.encoding===xo)}function zc(){for(var e=[],t=[],n=[],r=8,i=0;i<Mc;i++){var a=Math.pow(2,r);t.push(a);var o=1/a;i>4?o=Sc[i-8+4-1]:0==i&&(o=0),n.push(o);for(var s=1/(a-1),u=-s/2,l=1+s/2,c=[u,u,l,u,l,l,u,u,l,l,u,l],h=new Float32Array(108),f=new Float32Array(72),d=new Float32Array(36),p=0;p<6;p++){var v=p%3*2/3-1,m=p>2?0:-1,g=[v,m,0,v+2/3,m,0,v+2/3,m+1,0,v,m,0,v+2/3,m+1,0,v,m+1,0];h.set(g,18*p),f.set(c,12*p);var y=[p,p,p,p,p,p];d.set(y,6*p)}var b=new Ml;b.setAttribute("position",new ol(h,3)),b.setAttribute("uv",new ol(f,2)),b.setAttribute("faceIndex",new ol(d,1)),e.push(b),r>4&&r--}return{_lodPlanes:e,_sizeLods:t,_sigmas:n}}function Bc(e){var t=new Rs(3*wc,3*wc,e);return t.texture.mapping=Pi,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function Vc(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function Gc(){var e=new gs(1,1);return new xc({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:e},inputEncoding:{value:Tc[bo]},outputEncoding:{value:Tc[bo]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t".concat("\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t","\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t"),blending:Vr,depthTest:!1,depthWrite:!1})}function jc(){return new xc({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:Tc[bo]},outputEncoding:{value:Tc[bo]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t".concat("\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t","\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t"),blending:Vr,depthTest:!1,depthWrite:!1})}function Hc(e){var t=new WeakMap,n=null;function r(e){var n=e.target;n.removeEventListener("dispose",r);var i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture&&!1===i.isRenderTargetTexture){var a=i.mapping,o=a===Ai||a===Ri,s=a===Ei||a===Ci;if(o||s){if(t.has(i))return t.get(i).texture;var u=i.image;if(o&&u&&u.height>0||s&&u&&function(e){for(var t=0,n=6,r=0;r<n;r++)void 0!==e[r]&&t++;return t===n}(u)){var l=e.getRenderTarget();null===n&&(n=new Uc(e));var c=o?n.fromEquirectangular(i):n.fromCubemap(i);return t.set(i,c),e.setRenderTarget(l),i.addEventListener("dispose",r),c.texture}return null}}return i},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function Wc(e){var t={};function n(n){if(void 0!==t[n])return t[n];var r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}return{has:function(e){return null!==n(e)},init:function(e){e.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(e){var t=n(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function Zc(e,t,n,r){var i={},a=new WeakMap;function o(e){var s=e.target;for(var u in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[u]);s.removeEventListener("dispose",o),delete i[s.id];var l=a.get(s);l&&(t.remove(l),a.delete(s)),r.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,n.memory.geometries--}function s(e){var n=[],r=e.index,i=e.attributes.position,o=0;if(null!==r){var s=r.array;o=r.version;for(var u=0,l=s.length;u<l;u+=3){var c=s[u+0],h=s[u+1],f=s[u+2];n.push(c,h,h,f,f,c)}}else{var d=i.array;o=i.version;for(var p=0,v=d.length/3-1;p<v;p+=3){var m=p+0,g=p+1,y=p+2;n.push(m,g,g,y,y,m)}}var b=new(bs(n)>65535?dl:hl)(n,1);b.version=o;var _=a.get(e);_&&t.remove(_),a.set(e,b)}return{get:function(e,t){return!0===i[t.id]||(t.addEventListener("dispose",o),i[t.id]=!0,n.memory.geometries++),t},update:function(e){var n=e.attributes;for(var r in n)t.update(n[r],34962);var i=e.morphAttributes;for(var a in i)for(var o=i[a],s=0,u=o.length;s<u;s++)t.update(o[s],34962)},getWireframeAttribute:function(e){var t=a.get(e);if(t){var n=e.index;null!==n&&t.version<n.version&&s(e)}else s(e);return a.get(e)}}}function qc(e,t,n,r){var i,a,o,s=r.isWebGL2;this.setMode=function(e){i=e},this.setIndex=function(e){a=e.type,o=e.bytesPerElement},this.render=function(t,r){e.drawElements(i,r,a,t*o),n.update(r,i,1)},this.renderInstances=function(r,u,l){if(0!==l){var c,h;if(s)c=e,h="drawElementsInstanced";else if(h="drawElementsInstancedANGLE",null===(c=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[h](i,u,a,r*o,l),n.update(u,i,l)}}}function Xc(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,r){switch(t.calls++,n){case 4:t.triangles+=r*(e/3);break;case 1:t.lines+=r*(e/2);break;case 3:t.lines+=r*(e-1);break;case 2:t.lines+=r*e;break;case 0:t.points+=r*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}var Yc=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return(0,u.Z)(this,n),(e=t.call(this,null)).image={data:r,width:i,height:a,depth:o},e.magFilter=Oi,e.minFilter=Oi,e.wrapR=Ni,e.generateMipmaps=!1,e.flipY=!1,e.unpackAlignment=1,e.needsUpdate=!0,e}return(0,l.Z)(n)}(Es);function Kc(e,t){return e[0]-t[0]}function Jc(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Qc(e,t){var n=1,r=t.isInterleavedBufferAttribute?t.data.array:t.array;r instanceof Int8Array?n=127:r instanceof Int16Array?n=32767:r instanceof Int32Array?n=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",r),e.divideScalar(n)}function $c(e,t,n){for(var r={},i=new Float32Array(8),a=new WeakMap,o=new Ns,s=[],u=0;u<8;u++)s[u]=[u,0];return{update:function(u,l,c,h){var f=u.morphTargetInfluences;if(!0===t.isWebGL2){var d=l.morphAttributes.position.length,p=a.get(l);if(void 0===p||p.count!==d){void 0!==p&&p.texture.dispose();var v=void 0!==l.morphAttributes.normal,m=l.morphAttributes.position,g=l.morphAttributes.normal||[],y=!0===v?2:1,b=l.attributes.position.count*y,_=1;b>t.maxTextureSize&&(_=Math.ceil(b/t.maxTextureSize),b=t.maxTextureSize);var x=new Float32Array(b*_*4*d),w=new Yc(x,b,_,d);w.format=oa,w.type=Qi;for(var S=4*y,M=0;M<d;M++)for(var k=m[M],T=g[M],E=b*_*4*M,C=0;C<k.count;C++){o.fromBufferAttribute(k,C),!0===k.normalized&&Qc(o,k);var A=C*S;x[E+A+0]=o.x,x[E+A+1]=o.y,x[E+A+2]=o.z,x[E+A+3]=0,!0===v&&(o.fromBufferAttribute(T,C),!0===T.normalized&&Qc(o,T),x[E+A+4]=o.x,x[E+A+5]=o.y,x[E+A+6]=o.z,x[E+A+7]=0)}p={count:d,texture:w,size:new gs(b,_)},a.set(l,p)}for(var R=0,P=0;P<f.length;P++)R+=f[P];var L=l.morphTargetsRelative?1:1-R;h.getUniforms().setValue(e,"morphTargetBaseInfluence",L),h.getUniforms().setValue(e,"morphTargetInfluences",f),h.getUniforms().setValue(e,"morphTargetsTexture",p.texture,n),h.getUniforms().setValue(e,"morphTargetsTextureSize",p.size)}else{var D=void 0===f?0:f.length,N=r[l.id];if(void 0===N||N.length!==D){N=[];for(var I=0;I<D;I++)N[I]=[I,0];r[l.id]=N}for(var O=0;O<D;O++){var U=N[O];U[0]=O,U[1]=f[O]}N.sort(Jc);for(var F=0;F<8;F++)F<D&&N[F][1]?(s[F][0]=N[F][0],s[F][1]=N[F][1]):(s[F][0]=Number.MAX_SAFE_INTEGER,s[F][1]=0);s.sort(Kc);for(var z=l.morphAttributes.position,B=l.morphAttributes.normal,V=0,G=0;G<8;G++){var j=s[G],H=j[0],W=j[1];H!==Number.MAX_SAFE_INTEGER&&W?(z&&l.getAttribute("morphTarget"+G)!==z[H]&&l.setAttribute("morphTarget"+G,z[H]),B&&l.getAttribute("morphNormal"+G)!==B[H]&&l.setAttribute("morphNormal"+G,B[H]),i[G]=W,V+=W):(z&&!0===l.hasAttribute("morphTarget"+G)&&l.deleteAttribute("morphTarget"+G),B&&!0===l.hasAttribute("morphNormal"+G)&&l.deleteAttribute("morphNormal"+G),i[G]=0)}var Z=l.morphTargetsRelative?1:1-V;h.getUniforms().setValue(e,"morphTargetBaseInfluence",Z),h.getUniforms().setValue(e,"morphTargetInfluences",i)}}}}function eh(e,t,n,r){var i=new WeakMap;function a(e){var t=e.target;t.removeEventListener("dispose",a),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(e){var o=r.render.frame,s=e.geometry,u=t.get(e,s);return i.get(u)!==o&&(t.update(u),i.set(u,o)),e.isInstancedMesh&&(!1===e.hasEventListener("dispose",a)&&e.addEventListener("dispose",a),n.update(e.instanceMatrix,34962),null!==e.instanceColor&&n.update(e.instanceColor,34962)),u},dispose:function(){i=new WeakMap}}}Yc.prototype.isDataTexture2DArray=!0;var th=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return(0,u.Z)(this,n),(e=t.call(this,null)).image={data:r,width:i,height:a,depth:o},e.magFilter=Oi,e.minFilter=Oi,e.wrapR=Ni,e.generateMipmaps=!1,e.flipY=!1,e.unpackAlignment=1,e.needsUpdate=!0,e}return(0,l.Z)(n)}(Es);th.prototype.isDataTexture3D=!0;var nh=new Es,rh=new Yc,ih=new th,ah=new $l,oh=[],sh=[],uh=new Float32Array(16),lh=new Float32Array(9),ch=new Float32Array(4);function hh(e,t,n){var r=e[0];if(r<=0||r>0)return e;var i=t*n,a=oh[i];if(void 0===a&&(a=new Float32Array(i),oh[i]=a),0!==t){r.toArray(a,0);for(var o=1,s=0;o!==t;++o)s+=n,e[o].toArray(a,s)}return a}function fh(e,t){if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function dh(e,t){for(var n=0,r=t.length;n<r;n++)e[n]=t[n]}function ph(e,t){var n=sh[t];void 0===n&&(n=new Int32Array(t),sh[t]=n);for(var r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function vh(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function mh(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(fh(n,t))return;e.uniform2fv(this.addr,t),dh(n,t)}}function gh(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(fh(n,t))return;e.uniform3fv(this.addr,t),dh(n,t)}}function yh(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(fh(n,t))return;e.uniform4fv(this.addr,t),dh(n,t)}}function bh(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(fh(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),dh(n,t)}else{if(fh(n,r))return;ch.set(r),e.uniformMatrix2fv(this.addr,!1,ch),dh(n,r)}}function _h(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(fh(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),dh(n,t)}else{if(fh(n,r))return;lh.set(r),e.uniformMatrix3fv(this.addr,!1,lh),dh(n,r)}}function xh(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(fh(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),dh(n,t)}else{if(fh(n,r))return;uh.set(r),e.uniformMatrix4fv(this.addr,!1,uh),dh(n,r)}}function wh(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function Sh(e,t){var n=this.cache;fh(n,t)||(e.uniform2iv(this.addr,t),dh(n,t))}function Mh(e,t){var n=this.cache;fh(n,t)||(e.uniform3iv(this.addr,t),dh(n,t))}function kh(e,t){var n=this.cache;fh(n,t)||(e.uniform4iv(this.addr,t),dh(n,t))}function Th(e,t){var n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function Eh(e,t){var n=this.cache;fh(n,t)||(e.uniform2uiv(this.addr,t),dh(n,t))}function Ch(e,t){var n=this.cache;fh(n,t)||(e.uniform3uiv(this.addr,t),dh(n,t))}function Ah(e,t){var n=this.cache;fh(n,t)||(e.uniform4uiv(this.addr,t),dh(n,t))}function Rh(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(t||nh,i)}function Ph(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||ih,i)}function Lh(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(t||ah,i)}function Dh(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||rh,i)}function Nh(e,t){e.uniform1fv(this.addr,t)}function Ih(e,t){var n=hh(t,this.size,2);e.uniform2fv(this.addr,n)}function Oh(e,t){var n=hh(t,this.size,3);e.uniform3fv(this.addr,n)}function Uh(e,t){var n=hh(t,this.size,4);e.uniform4fv(this.addr,n)}function Fh(e,t){var n=hh(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function zh(e,t){var n=hh(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function Bh(e,t){var n=hh(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function Vh(e,t){e.uniform1iv(this.addr,t)}function Gh(e,t){e.uniform2iv(this.addr,t)}function jh(e,t){e.uniform3iv(this.addr,t)}function Hh(e,t){e.uniform4iv(this.addr,t)}function Wh(e,t){e.uniform1uiv(this.addr,t)}function Zh(e,t){e.uniform2uiv(this.addr,t)}function qh(e,t){e.uniform3uiv(this.addr,t)}function Xh(e,t){e.uniform4uiv(this.addr,t)}function Yh(e,t,n){var r=t.length,i=ph(n,r);e.uniform1iv(this.addr,i);for(var a=0;a!==r;++a)n.safeSetTexture2D(t[a]||nh,i[a])}function Kh(e,t,n){var r=t.length,i=ph(n,r);e.uniform1iv(this.addr,i);for(var a=0;a!==r;++a)n.setTexture3D(t[a]||ih,i[a])}function Jh(e,t,n){var r=t.length,i=ph(n,r);e.uniform1iv(this.addr,i);for(var a=0;a!==r;++a)n.safeSetTextureCube(t[a]||ah,i[a])}function Qh(e,t,n){var r=t.length,i=ph(n,r);e.uniform1iv(this.addr,i);for(var a=0;a!==r;++a)n.setTexture2DArray(t[a]||rh,i[a])}function $h(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return vh;case 35664:return mh;case 35665:return gh;case 35666:return yh;case 35674:return bh;case 35675:return _h;case 35676:return xh;case 5124:case 35670:return wh;case 35667:case 35671:return Sh;case 35668:case 35672:return Mh;case 35669:case 35673:return kh;case 5125:return Th;case 36294:return Eh;case 36295:return Ch;case 36296:return Ah;case 35678:case 36198:case 36298:case 36306:case 35682:return Rh;case 35679:case 36299:case 36307:return Ph;case 35680:case 36300:case 36308:case 36293:return Lh;case 36289:case 36303:case 36311:case 36292:return Dh}}(t.type)}function ef(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return Nh;case 35664:return Ih;case 35665:return Oh;case 35666:return Uh;case 35674:return Fh;case 35675:return zh;case 35676:return Bh;case 5124:case 35670:return Vh;case 35667:case 35671:return Gh;case 35668:case 35672:return jh;case 35669:case 35673:return Hh;case 5125:return Wh;case 36294:return Zh;case 36295:return qh;case 36296:return Xh;case 35678:case 36198:case 36298:case 36306:case 35682:return Yh;case 35679:case 36299:case 36307:return Kh;case 35680:case 36300:case 36308:case 36293:return Jh;case 36289:case 36303:case 36311:case 36292:return Qh}}(t.type)}function tf(e){this.id=e,this.seq=[],this.map={}}ef.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),dh(t,e)},tf.prototype.setValue=function(e,t,n){for(var r=this.seq,i=0,a=r.length;i!==a;++i){var o=r[i];o.setValue(e,t[o.id],n)}};var nf=/(\w+)(\])?(\[|\.)?/g;function rf(e,t){e.seq.push(t),e.map[t.id]=t}function af(e,t,n){var r=e.name,i=r.length;for(nf.lastIndex=0;;){var a=nf.exec(r),o=nf.lastIndex,s=a[1],u="]"===a[2],l=a[3];if(u&&(s|=0),void 0===l||"["===l&&o+2===i){rf(n,void 0===l?new $h(s,e,t):new ef(s,e,t));break}var c=n.map[s];void 0===c&&rf(n,c=new tf(s)),n=c}}function of(e,t){this.seq=[],this.map={};for(var n=e.getProgramParameter(t,35718),r=0;r<n;++r){var i=e.getActiveUniform(t,r);af(i,e.getUniformLocation(t,i.name),this)}}function sf(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}of.prototype.setValue=function(e,t,n,r){var i=this.map[t];void 0!==i&&i.setValue(e,n,r)},of.prototype.setOptional=function(e,t,n){var r=t[n];void 0!==r&&this.setValue(e,n,r)},of.upload=function(e,t,n,r){for(var i=0,a=t.length;i!==a;++i){var o=t[i],s=n[o.id];!1!==s.needsUpdate&&o.setValue(e,s.value,r)}},of.seqWithValue=function(e,t){for(var n=[],r=0,i=e.length;r!==i;++r){var a=e[r];a.id in t&&n.push(a)}return n};var uf=0;function lf(e){switch(e){case bo:return["Linear","( value )"];case _o:return["sRGB","( value )"];case wo:return["RGBE","( value )"];case So:return["RGBM","( value, 7.0 )"];case Mo:return["RGBM","( value, 16.0 )"];case ko:return["RGBD","( value, 256.0 )"];case xo:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function cf(e,t,n){var r=e.getShaderParameter(t,35713),i=e.getShaderInfoLog(t).trim();return r&&""===i?"":n.toUpperCase()+"\n\n"+i+"\n\n"+function(e){for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")}(e.getShaderSource(t))}function hf(e,t){var n=lf(t);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function ff(e,t){var n=lf(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function df(e,t){var n;switch(t){case xi:n="Linear";break;case wi:n="Reinhard";break;case Si:n="OptimizedCineon";break;case Mi:n="ACESFilmic";break;case ki:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function pf(e){return""!==e}function vf(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function mf(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var gf=/^[ \t]*#include +<([\w\d./]+)>/gm;function yf(e){return e.replace(gf,bf)}function bf(e,t){var n=hc[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return yf(n)}var _f=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,xf=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function wf(e){return e.replace(xf,Mf).replace(_f,Sf)}function Sf(e,t,n,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Mf(e,t,n,r)}function Mf(e,t,n,r){for(var i="",a=parseInt(t);a<parseInt(n);a++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return i}function kf(e){var t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function Tf(e,t,n,r){var i,a,o=e.getContext(),s=n.defines,u=n.vertexShader,l=n.fragmentShader,c=function(e){var t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===Dr?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===Nr?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===Ir&&(t="SHADOWMAP_TYPE_VSM"),t}(n),h=function(e){var t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case Ei:case Ci:t="ENVMAP_TYPE_CUBE";break;case Pi:case Li:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),f=function(e){var t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case Ci:case Li:t="ENVMAP_MODE_REFRACTION"}return t}(n),d=function(e){var t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case gi:t="ENVMAP_BLENDING_MULTIPLY";break;case yi:t="ENVMAP_BLENDING_MIX";break;case bi:t="ENVMAP_BLENDING_ADD"}return t}(n),p=e.gammaFactor>0?e.gammaFactor:1,v=n.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUV||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(pf).join("\n")}(n),m=function(e){var t=[];for(var n in e){var r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(s),g=o.createProgram(),y=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?((i=[m].filter(pf).join("\n")).length>0&&(i+="\n"),(a=[v,m].filter(pf).join("\n")).length>0&&(a+="\n")):(i=[kf(n),"#define SHADER_NAME "+n.shaderName,m,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+p,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+f:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphTargets&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargets&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(pf).join("\n"),a=[v,kf(n),"#define SHADER_NAME "+n.shaderName,m,"#define GAMMA_FACTOR "+p,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+h:"",n.envMap?"#define "+f:"",n.envMap?"#define "+d:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==_i?"#define TONE_MAPPING":"",n.toneMapping!==_i?hc.tonemapping_pars_fragment:"",n.toneMapping!==_i?df("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.format===aa?"#define OPAQUE":"",hc.encodings_pars_fragment,n.map?hf("mapTexelToLinear",n.mapEncoding):"",n.matcap?hf("matcapTexelToLinear",n.matcapEncoding):"",n.envMap?hf("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMap?hf("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.specularColorMap?hf("specularColorMapTexelToLinear",n.specularColorMapEncoding):"",n.sheenColorMap?hf("sheenColorMapTexelToLinear",n.sheenColorMapEncoding):"",n.lightMap?hf("lightMapTexelToLinear",n.lightMapEncoding):"",ff("linearToOutputTexel",n.outputEncoding),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(pf).join("\n")),u=mf(u=vf(u=yf(u),n),n),l=mf(l=vf(l=yf(l),n),n),u=wf(u),l=wf(l),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(y="#version 300 es\n",i=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+i,a=["#define varying in",n.glslVersion===ns?"":"out highp vec4 pc_fragColor;",n.glslVersion===ns?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+a);var b,_,x=y+a+l,w=sf(o,35633,y+i+u),S=sf(o,35632,x);if(o.attachShader(g,w),o.attachShader(g,S),void 0!==n.index0AttributeName?o.bindAttribLocation(g,0,n.index0AttributeName):!0===n.morphTargets&&o.bindAttribLocation(g,0,"position"),o.linkProgram(g),e.debug.checkShaderErrors){var M=o.getProgramInfoLog(g).trim(),k=o.getShaderInfoLog(w).trim(),T=o.getShaderInfoLog(S).trim(),E=!0,C=!0;if(!1===o.getProgramParameter(g,35714)){E=!1;var A=cf(o,w,"vertex"),R=cf(o,S,"fragment");console.error("THREE.WebGLProgram: Shader Error "+o.getError()+" - VALIDATE_STATUS "+o.getProgramParameter(g,35715)+"\n\nProgram Info Log: "+M+"\n"+A+"\n"+R)}else""!==M?console.warn("THREE.WebGLProgram: Program Info Log:",M):""!==k&&""!==T||(C=!1);C&&(this.diagnostics={runnable:E,programLog:M,vertexShader:{log:k,prefix:i},fragmentShader:{log:T,prefix:a}})}return o.deleteShader(w),o.deleteShader(S),this.getUniforms=function(){return void 0===b&&(b=new of(o,g)),b},this.getAttributes=function(){return void 0===_&&(_=function(e,t){for(var n={},r=e.getProgramParameter(t,35721),i=0;i<r;i++){var a=e.getActiveAttrib(t,i),o=a.name,s=1;35674===a.type&&(s=2),35675===a.type&&(s=3),35676===a.type&&(s=4),n[o]={type:a.type,location:e.getAttribLocation(t,o),locationSize:s}}return n}(o,g)),_},this.destroy=function(){r.releaseStatesOfProgram(this),o.deleteProgram(g),this.program=void 0},this.name=n.shaderName,this.id=uf++,this.cacheKey=t,this.usedTimes=1,this.program=g,this.vertexShader=w,this.fragmentShader=S,this}function Ef(e,t,n,r,i,a,o){var s=[],u=i.isWebGL2,l=i.logarithmicDepthBuffer,c=i.floatVertexTextures,h=i.maxVertexUniforms,f=i.vertexTextures,d=i.precision,p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},v=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoat","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap",,"roughnessMap","metalnessMap","gradientMap","alphaMap","alphaTest","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","morphTargetsCount","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","format","specularIntensityMap","specularColorMap","specularColorMapEncoding","transmission","transmissionMap","thicknessMap","sheen","sheenColorMap","sheenColorMapEncoding","sheenRoughnessMap"];function m(e){var t;return e&&e.isTexture?t=e.encoding:e&&e.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),t=e.texture.encoding):t=bo,t}return{getParameters:function(a,s,v,g,y){var b,_,x=g.fog,w=a.isMeshStandardMaterial?g.environment:null,S=(a.isMeshStandardMaterial?n:t).get(a.envMap||w),M=p[a.type],k=y.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(c)return 1024;var n=h,r=Math.floor((n-20)/4),i=Math.min(r,t.length);return i<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+i+"."),0):i}(y):0;if(null!==a.precision&&(d=i.getMaxPrecision(a.precision))!==a.precision&&console.warn("THREE.WebGLProgram.getParameters:",a.precision,"not supported, using",d,"instead."),M){var T=dc[M];b=T.vertexShader,_=T.fragmentShader}else b=a.vertexShader,_=a.fragmentShader;var E=e.getRenderTarget(),C=a.alphaTest>0,A=a.clearcoat>0;return{isWebGL2:u,shaderID:M,shaderName:a.type,vertexShader:b,fragmentShader:_,defines:a.defines,isRawShaderMaterial:!0===a.isRawShaderMaterial,glslVersion:a.glslVersion,precision:d,instancing:!0===y.isInstancedMesh,instancingColor:!0===y.isInstancedMesh&&null!==y.instanceColor,supportsVertexTextures:f,outputEncoding:null!==E?m(E.texture):e.outputEncoding,map:!!a.map,mapEncoding:m(a.map),matcap:!!a.matcap,matcapEncoding:m(a.matcap),envMap:!!S,envMapMode:S&&S.mapping,envMapEncoding:m(S),envMapCubeUV:!!S&&(S.mapping===Pi||S.mapping===Li),lightMap:!!a.lightMap,lightMapEncoding:m(a.lightMap),aoMap:!!a.aoMap,emissiveMap:!!a.emissiveMap,emissiveMapEncoding:m(a.emissiveMap),bumpMap:!!a.bumpMap,normalMap:!!a.normalMap,objectSpaceNormalMap:a.normalMapType===Ao,tangentSpaceNormalMap:a.normalMapType===Co,clearcoat:A,clearcoatMap:A&&!!a.clearcoatMap,clearcoatRoughnessMap:A&&!!a.clearcoatRoughnessMap,clearcoatNormalMap:A&&!!a.clearcoatNormalMap,displacementMap:!!a.displacementMap,roughnessMap:!!a.roughnessMap,metalnessMap:!!a.metalnessMap,specularMap:!!a.specularMap,specularIntensityMap:!!a.specularIntensityMap,specularColorMap:!!a.specularColorMap,specularColorMapEncoding:m(a.specularColorMap),alphaMap:!!a.alphaMap,alphaTest:C,gradientMap:!!a.gradientMap,sheen:a.sheen>0,sheenColorMap:!!a.sheenColorMap,sheenColorMapEncoding:m(a.sheenColorMap),sheenRoughnessMap:!!a.sheenRoughnessMap,transmission:a.transmission>0,transmissionMap:!!a.transmissionMap,thicknessMap:!!a.thicknessMap,combine:a.combine,vertexTangents:!!a.normalMap&&!!y.geometry&&!!y.geometry.attributes.tangent,vertexColors:a.vertexColors,vertexAlphas:!0===a.vertexColors&&!!y.geometry&&!!y.geometry.attributes.color&&4===y.geometry.attributes.color.itemSize,vertexUvs:!!a.map||!!a.bumpMap||!!a.normalMap||!!a.specularMap||!!a.alphaMap||!!a.emissiveMap||!!a.roughnessMap||!!a.metalnessMap||!!a.clearcoatMap||!!a.clearcoatRoughnessMap||!!a.clearcoatNormalMap||!!a.displacementMap||!!a.transmissionMap||!!a.thicknessMap||!!a.specularIntensityMap||!!a.specularColorMap||!!a.sheenColorMap||a.sheenRoughnessMap,uvsVertexOnly:!(a.map||a.bumpMap||a.normalMap||a.specularMap||a.alphaMap||a.emissiveMap||a.roughnessMap||a.metalnessMap||a.clearcoatNormalMap||a.transmission>0||a.transmissionMap||a.thicknessMap||a.specularIntensityMap||a.specularColorMap||a.sheen>0||a.sheenColorMap||a.sheenRoughnessMap)&&!!a.displacementMap,fog:!!x,useFog:a.fog,fogExp2:x&&x.isFogExp2,flatShading:!!a.flatShading,sizeAttenuation:a.sizeAttenuation,logarithmicDepthBuffer:l,skinning:!0===y.isSkinnedMesh&&k>0,maxBones:k,useVertexTexture:c,morphTargets:!!y.geometry&&!!y.geometry.morphAttributes.position,morphNormals:!!y.geometry&&!!y.geometry.morphAttributes.normal,morphTargetsCount:y.geometry&&y.geometry.morphAttributes.position?y.geometry.morphAttributes.position.length:0,numDirLights:s.directional.length,numPointLights:s.point.length,numSpotLights:s.spot.length,numRectAreaLights:s.rectArea.length,numHemiLights:s.hemi.length,numDirLightShadows:s.directionalShadowMap.length,numPointLightShadows:s.pointShadowMap.length,numSpotLightShadows:s.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,format:a.format,dithering:a.dithering,shadowMapEnabled:e.shadowMap.enabled&&v.length>0,shadowMapType:e.shadowMap.type,toneMapping:a.toneMapped?e.toneMapping:_i,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:a.premultipliedAlpha,doubleSided:a.side===Fr,flipSided:a.side===Ur,depthPacking:void 0!==a.depthPacking&&a.depthPacking,index0AttributeName:a.index0AttributeName,extensionDerivatives:a.extensions&&a.extensions.derivatives,extensionFragDepth:a.extensions&&a.extensions.fragDepth,extensionDrawBuffers:a.extensions&&a.extensions.drawBuffers,extensionShaderTextureLOD:a.extensions&&a.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||r.has("EXT_shader_texture_lod"),customProgramCacheKey:a.customProgramCacheKey()}},getProgramCacheKey:function(t){var n=[];if(t.shaderID?n.push(t.shaderID):(n.push(Ms(t.fragmentShader)),n.push(Ms(t.vertexShader))),void 0!==t.defines)for(var r in t.defines)n.push(r),n.push(t.defines[r]);if(!1===t.isRawShaderMaterial){for(var i=0;i<v.length;i++)n.push(t[v[i]]);n.push(e.outputEncoding),n.push(e.gammaFactor)}return n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){var t,n=p[e.type];if(n){var r=dc[n];t=ql.clone(r.uniforms)}else t=e.uniforms;return t},acquireProgram:function(t,n){for(var r,i=0,o=s.length;i<o;i++){var u=s[i];if(u.cacheKey===n){++(r=u).usedTimes;break}}return void 0===r&&(r=new Tf(e,n,t,a),s.push(r)),r},releaseProgram:function(e){if(0===--e.usedTimes){var t=s.indexOf(e);s[t]=s[s.length-1],s.pop(),e.destroy()}},programs:s}}function Cf(){var e=new WeakMap;return{get:function(t){var n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function Af(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Rf(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Pf(e){var t=[],n=0,r=[],i=[],a=[],o={id:-1};function s(r,i,a,s,u,l){var c=t[n],h=e.get(a);return void 0===c?(c={id:r.id,object:r,geometry:i,material:a,program:h.program||o,groupOrder:s,renderOrder:r.renderOrder,z:u,group:l},t[n]=c):(c.id=r.id,c.object=r,c.geometry=i,c.material=a,c.program=h.program||o,c.groupOrder=s,c.renderOrder=r.renderOrder,c.z=u,c.group=l),n++,c}return{opaque:r,transmissive:i,transparent:a,init:function(){n=0,r.length=0,i.length=0,a.length=0},push:function(e,t,n,o,u,l){var c=s(e,t,n,o,u,l);n.transmission>0?i.push(c):!0===n.transparent?a.push(c):r.push(c)},unshift:function(e,t,n,o,u,l){var c=s(e,t,n,o,u,l);n.transmission>0?i.unshift(c):!0===n.transparent?a.unshift(c):r.unshift(c)},finish:function(){for(var e=n,r=t.length;e<r;e++){var i=t[e];if(null===i.id)break;i.id=null,i.object=null,i.geometry=null,i.material=null,i.program=null,i.group=null}},sort:function(e,t){r.length>1&&r.sort(e||Af),i.length>1&&i.sort(t||Rf),a.length>1&&a.sort(t||Rf)}}}function Lf(e){var t=new WeakMap;return{get:function(n,r){var i;return!1===t.has(n)?(i=new Pf(e),t.set(n,[i])):r>=t.get(n).length?(i=new Pf(e),t.get(n).push(i)):i=t.get(n)[r],i},dispose:function(){t=new WeakMap}}}function Df(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":n={direction:new Ns,color:new nl};break;case"SpotLight":n={position:new Ns,direction:new Ns,color:new nl,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Ns,color:new nl,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Ns,skyColor:new nl,groundColor:new nl};break;case"RectAreaLight":n={color:new nl,position:new Ns,halfWidth:new Ns,halfHeight:new Ns}}return e[t.id]=n,n}}}var Nf=0;function If(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function Of(e,t){for(var n=new Df,r=function(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gs};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gs,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},a=0;a<9;a++)i.probe.push(new Ns);var o=new Ns,s=new hu,u=new hu;return{setup:function(a,o){for(var s=0,u=0,l=0,c=0;c<9;c++)i.probe[c].set(0,0,0);var h=0,f=0,d=0,p=0,v=0,m=0,g=0,y=0;a.sort(If);for(var b=!0!==o?Math.PI:1,_=0,x=a.length;_<x;_++){var w=a[_],S=w.color,M=w.intensity,k=w.distance,T=w.shadow&&w.shadow.map?w.shadow.map.texture:null;if(w.isAmbientLight)s+=S.r*M*b,u+=S.g*M*b,l+=S.b*M*b;else if(w.isLightProbe)for(var E=0;E<9;E++)i.probe[E].addScaledVector(w.sh.coefficients[E],M);else if(w.isDirectionalLight){var C=n.get(w);if(C.color.copy(w.color).multiplyScalar(w.intensity*b),w.castShadow){var A=w.shadow,R=r.get(w);R.shadowBias=A.bias,R.shadowNormalBias=A.normalBias,R.shadowRadius=A.radius,R.shadowMapSize=A.mapSize,i.directionalShadow[h]=R,i.directionalShadowMap[h]=T,i.directionalShadowMatrix[h]=w.shadow.matrix,m++}i.directional[h]=C,h++}else if(w.isSpotLight){var P=n.get(w);if(P.position.setFromMatrixPosition(w.matrixWorld),P.color.copy(S).multiplyScalar(M*b),P.distance=k,P.coneCos=Math.cos(w.angle),P.penumbraCos=Math.cos(w.angle*(1-w.penumbra)),P.decay=w.decay,w.castShadow){var L=w.shadow,D=r.get(w);D.shadowBias=L.bias,D.shadowNormalBias=L.normalBias,D.shadowRadius=L.radius,D.shadowMapSize=L.mapSize,i.spotShadow[d]=D,i.spotShadowMap[d]=T,i.spotShadowMatrix[d]=w.shadow.matrix,y++}i.spot[d]=P,d++}else if(w.isRectAreaLight){var N=n.get(w);N.color.copy(S).multiplyScalar(M),N.halfWidth.set(.5*w.width,0,0),N.halfHeight.set(0,.5*w.height,0),i.rectArea[p]=N,p++}else if(w.isPointLight){var I=n.get(w);if(I.color.copy(w.color).multiplyScalar(w.intensity*b),I.distance=w.distance,I.decay=w.decay,w.castShadow){var O=w.shadow,U=r.get(w);U.shadowBias=O.bias,U.shadowNormalBias=O.normalBias,U.shadowRadius=O.radius,U.shadowMapSize=O.mapSize,U.shadowCameraNear=O.camera.near,U.shadowCameraFar=O.camera.far,i.pointShadow[f]=U,i.pointShadowMap[f]=T,i.pointShadowMatrix[f]=w.shadow.matrix,g++}i.point[f]=I,f++}else if(w.isHemisphereLight){var F=n.get(w);F.skyColor.copy(w.color).multiplyScalar(M*b),F.groundColor.copy(w.groundColor).multiplyScalar(M*b),i.hemi[v]=F,v++}}p>0&&(t.isWebGL2||!0===e.has("OES_texture_float_linear")?(i.rectAreaLTC1=fc.LTC_FLOAT_1,i.rectAreaLTC2=fc.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(i.rectAreaLTC1=fc.LTC_HALF_1,i.rectAreaLTC2=fc.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=s,i.ambient[1]=u,i.ambient[2]=l;var z=i.hash;z.directionalLength===h&&z.pointLength===f&&z.spotLength===d&&z.rectAreaLength===p&&z.hemiLength===v&&z.numDirectionalShadows===m&&z.numPointShadows===g&&z.numSpotShadows===y||(i.directional.length=h,i.spot.length=d,i.rectArea.length=p,i.point.length=f,i.hemi.length=v,i.directionalShadow.length=m,i.directionalShadowMap.length=m,i.pointShadow.length=g,i.pointShadowMap.length=g,i.spotShadow.length=y,i.spotShadowMap.length=y,i.directionalShadowMatrix.length=m,i.pointShadowMatrix.length=g,i.spotShadowMatrix.length=y,z.directionalLength=h,z.pointLength=f,z.spotLength=d,z.rectAreaLength=p,z.hemiLength=v,z.numDirectionalShadows=m,z.numPointShadows=g,z.numSpotShadows=y,i.version=Nf++)},setupView:function(e,t){for(var n=0,r=0,a=0,l=0,c=0,h=t.matrixWorldInverse,f=0,d=e.length;f<d;f++){var p=e[f];if(p.isDirectionalLight){var v=i.directional[n];v.direction.setFromMatrixPosition(p.matrixWorld),o.setFromMatrixPosition(p.target.matrixWorld),v.direction.sub(o),v.direction.transformDirection(h),n++}else if(p.isSpotLight){var m=i.spot[a];m.position.setFromMatrixPosition(p.matrixWorld),m.position.applyMatrix4(h),m.direction.setFromMatrixPosition(p.matrixWorld),o.setFromMatrixPosition(p.target.matrixWorld),m.direction.sub(o),m.direction.transformDirection(h),a++}else if(p.isRectAreaLight){var g=i.rectArea[l];g.position.setFromMatrixPosition(p.matrixWorld),g.position.applyMatrix4(h),u.identity(),s.copy(p.matrixWorld),s.premultiply(h),u.extractRotation(s),g.halfWidth.set(.5*p.width,0,0),g.halfHeight.set(0,.5*p.height,0),g.halfWidth.applyMatrix4(u),g.halfHeight.applyMatrix4(u),l++}else if(p.isPointLight){var y=i.point[r];y.position.setFromMatrixPosition(p.matrixWorld),y.position.applyMatrix4(h),r++}else if(p.isHemisphereLight){var b=i.hemi[c];b.direction.setFromMatrixPosition(p.matrixWorld),b.direction.transformDirection(h),b.direction.normalize(),c++}}},state:i}}function Uf(e,t){var n=new Of(e,t),r=[],i=[];return{init:function(){r.length=0,i.length=0},state:{lightsArray:r,shadowsArray:i,lights:n},setupLights:function(e){n.setup(r,e)},setupLightsView:function(e){n.setupView(r,e)},pushLight:function(e){r.push(e)},pushShadow:function(e){i.push(e)}}}function Ff(e,t){var n=new WeakMap;return{get:function(r){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!1===n.has(r)?(i=new Uf(e,t),n.set(r,[i])):a>=n.get(r).length?(i=new Uf(e,t),n.get(r).push(i)):i=n.get(r)[a],i},dispose:function(){n=new WeakMap}}}var zf=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).type="MeshDepthMaterial",r.depthPacking=To,r.map=null,r.alphaMap=null,r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.wireframe=!1,r.wireframeLinewidth=1,r.fog=!1,r.setValues(e),r}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}]),n}(Yu);zf.prototype.isMeshDepthMaterial=!0;var Bf=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).type="MeshDistanceMaterial",r.referencePosition=new Ns,r.nearDistance=1,r.farDistance=1e3,r.map=null,r.alphaMap=null,r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.fog=!1,r.setValues(e),r}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}]),n}(Yu);Bf.prototype.isMeshDistanceMaterial=!0;function Vf(e,t,n){var r=new sc,i=new gs,a=new gs,o=new As,s=new zf({depthPacking:Eo}),u=new Bf,l={},c=n.maxTextureSize,h={0:Ur,1:Or,2:Fr},f=new Xl({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new gs},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),d=f.clone();d.defines.HORIZONTAL_PASS=1;var p=new Ml;p.setAttribute("position",new ol(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var v=new Gl(p,f),m=this;function g(n,r){var i=t.update(v);f.defines.VSM_SAMPLES!==n.blurSamples&&(f.defines.VSM_SAMPLES=n.blurSamples,d.defines.VSM_SAMPLES=n.blurSamples,f.needsUpdate=!0,d.needsUpdate=!0),f.uniforms.shadow_pass.value=n.map.texture,f.uniforms.resolution.value=n.mapSize,f.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,i,f,v,null),d.uniforms.shadow_pass.value=n.mapPass.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,i,d,v,null)}function y(t,n,r,i,a,o,c){var f=null,d=!0===i.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(f=void 0!==d?d:!0===i.isPointLight?u:s,e.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length||r.displacementMap&&0!==r.displacementScale||r.alphaMap&&r.alphaTest>0){var p=f.uuid,v=r.uuid,m=l[p];void 0===m&&(m={},l[p]=m);var g=m[v];void 0===g&&(g=f.clone(),m[v]=g),f=g}return f.visible=r.visible,f.wireframe=r.wireframe,f.side=c===Ir?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:h[r.side],f.alphaMap=r.alphaMap,f.alphaTest=r.alphaTest,f.clipShadows=r.clipShadows,f.clippingPlanes=r.clippingPlanes,f.clipIntersection=r.clipIntersection,f.displacementMap=r.displacementMap,f.displacementScale=r.displacementScale,f.displacementBias=r.displacementBias,f.wireframeLinewidth=r.wireframeLinewidth,f.linewidth=r.linewidth,!0===i.isPointLight&&!0===f.isMeshDistanceMaterial&&(f.referencePosition.setFromMatrixPosition(i.matrixWorld),f.nearDistance=a,f.farDistance=o),f}function b(n,i,a,o,s){if(!1!==n.visible){if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&s===Ir)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,n.matrixWorld);var u=t.update(n),l=n.material;if(Array.isArray(l))for(var c=u.groups,h=0,f=c.length;h<f;h++){var d=c[h],p=l[d.materialIndex];if(p&&p.visible){var v=y(n,0,p,o,a.near,a.far,s);e.renderBufferDirect(a,null,u,v,n,d)}}else if(l.visible){var m=y(n,0,l,o,a.near,a.far,s);e.renderBufferDirect(a,null,u,m,n,null)}}for(var g=n.children,_=0,x=g.length;_<x;_++)b(g[_],i,a,o,s)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Dr,this.render=function(t,n,s){if(!1!==m.enabled&&(!1!==m.autoUpdate||!1!==m.needsUpdate)&&0!==t.length){var u=e.getRenderTarget(),l=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),f=e.state;f.setBlending(Vr),f.buffers.color.setClear(1,1,1,1),f.buffers.depth.setTest(!0),f.setScissorTest(!1);for(var d=0,p=t.length;d<p;d++){var v=t[d],y=v.shadow;if(void 0!==y){if(!1!==y.autoUpdate||!1!==y.needsUpdate){i.copy(y.mapSize);var _=y.getFrameExtents();if(i.multiply(_),a.copy(y.mapSize),(i.x>c||i.y>c)&&(i.x>c&&(a.x=Math.floor(c/_.x),i.x=a.x*_.x,y.mapSize.x=a.x),i.y>c&&(a.y=Math.floor(c/_.y),i.y=a.y*_.y,y.mapSize.y=a.y)),null===y.map&&!y.isPointLightShadow&&this.type===Ir){var x={minFilter:Vi,magFilter:Vi,format:oa};y.map=new Rs(i.x,i.y,x),y.map.texture.name=v.name+".shadowMap",y.mapPass=new Rs(i.x,i.y,x),y.camera.updateProjectionMatrix()}if(null===y.map){var w={minFilter:Oi,magFilter:Oi,format:oa};y.map=new Rs(i.x,i.y,w),y.map.texture.name=v.name+".shadowMap",y.camera.updateProjectionMatrix()}e.setRenderTarget(y.map),e.clear();for(var S=y.getViewportCount(),M=0;M<S;M++){var k=y.getViewport(M);o.set(a.x*k.x,a.y*k.y,a.x*k.z,a.y*k.w),f.viewport(o),y.updateMatrices(v,M),r=y.getFrustum(),b(n,s,y.camera,v,this.type)}y.isPointLightShadow||this.type!==Ir||g(y,s),y.needsUpdate=!1}}else console.warn("THREE.WebGLShadowMap:",v,"has no shadow.")}m.needsUpdate=!1,e.setRenderTarget(u,l,h)}}}function Gf(e,t,n){var r,i,a=n.isWebGL2;var o=new function(){var t=!1,n=new As,r=null,i=new As(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,a,o,s){!0===s&&(t*=o,r*=o,a*=o),n.set(t,r,a,o),!1===i.equals(n)&&(e.clearColor(t,r,a,o),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},s=new function(){var t=!1,n=null,r=null,i=null;return{setTest:function(e){e?F(2929):z(2929)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){if(t)switch(t){case li:e.depthFunc(512);break;case ci:e.depthFunc(519);break;case hi:e.depthFunc(513);break;case fi:e.depthFunc(515);break;case di:e.depthFunc(514);break;case pi:e.depthFunc(518);break;case vi:e.depthFunc(516);break;case mi:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);r=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,n=null,r=null,i=null}}},u=new function(){var t=!1,n=null,r=null,i=null,a=null,o=null,s=null,u=null,l=null;return{setTest:function(e){t||(e?F(2960):z(2960))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,o){r===t&&i===n&&a===o||(e.stencilFunc(t,n,o),r=t,i=n,a=o)},setOp:function(t,n,r){o===t&&s===n&&u===r||(e.stencilOp(t,n,r),o=t,s=n,u=r)},setLocked:function(e){t=e},setClear:function(t){l!==t&&(e.clearStencil(t),l=t)},reset:function(){t=!1,n=null,r=null,i=null,a=null,o=null,s=null,u=null,l=null}}},l={},c={},h=null,f=!1,d=null,p=null,v=null,m=null,g=null,y=null,b=null,_=!1,x=null,w=null,S=null,M=null,k=null,T=e.getParameter(35661),E=!1,C=0,A=e.getParameter(7938);-1!==A.indexOf("WebGL")?(C=parseFloat(/^WebGL (\d)/.exec(A)[1]),E=C>=1):-1!==A.indexOf("OpenGL ES")&&(C=parseFloat(/^OpenGL ES (\d)/.exec(A)[1]),E=C>=2);var R=null,P={},L=e.getParameter(3088),D=e.getParameter(2978),N=(new As).fromArray(L),I=(new As).fromArray(D);function O(t,n,r){var i=new Uint8Array(4),a=e.createTexture();e.bindTexture(t,a),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(var o=0;o<r;o++)e.texImage2D(n+o,0,6408,1,1,0,6408,5121,i);return a}var U={};function F(t){!0!==l[t]&&(e.enable(t),l[t]=!0)}function z(t){!1!==l[t]&&(e.disable(t),l[t]=!1)}U[3553]=O(3553,3553,1),U[34067]=O(34067,34069,6),o.setClear(0,0,0,1),s.setClear(1),u.setClear(0),F(2929),s.setFunc(fi),H(!1),W(Ar),F(2884),j(Vr);var B=(gr(r={},qr,32774),gr(r,Xr,32778),gr(r,Yr,32779),r);if(a)B[Kr]=32775,B[Jr]=32776;else{var V=t.get("EXT_blend_minmax");null!==V&&(B[Kr]=V.MIN_EXT,B[Jr]=V.MAX_EXT)}var G=(gr(i={},Qr,0),gr(i,$r,1),gr(i,ei,768),gr(i,ni,770),gr(i,ui,776),gr(i,oi,774),gr(i,ii,772),gr(i,ti,769),gr(i,ri,771),gr(i,si,775),gr(i,ai,773),i);function j(t,n,r,i,a,o,s,u){if(t!==Vr){if(!1===f&&(F(3042),f=!0),t===Zr)a=a||n,o=o||r,s=s||i,n===p&&a===g||(e.blendEquationSeparate(B[n],B[a]),p=n,g=a),r===v&&i===m&&o===y&&s===b||(e.blendFuncSeparate(G[r],G[i],G[o],G[s]),v=r,m=i,y=o,b=s),d=t,_=null;else if(t!==d||u!==_){if(p===qr&&g===qr||(e.blendEquation(32774),p=qr,g=qr),u)switch(t){case Gr:e.blendFuncSeparate(1,771,1,771);break;case jr:e.blendFunc(1,1);break;case Hr:e.blendFuncSeparate(0,0,769,771);break;case Wr:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case Gr:e.blendFuncSeparate(770,771,1,771);break;case jr:e.blendFunc(770,1);break;case Hr:e.blendFunc(0,769);break;case Wr:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}v=null,m=null,y=null,b=null,d=t,_=u}}else!0===f&&(z(3042),f=!1)}function H(t){x!==t&&(t?e.frontFace(2304):e.frontFace(2305),x=t)}function W(t){t!==Cr?(F(2884),t!==w&&(t===Ar?e.cullFace(1029):t===Rr?e.cullFace(1028):e.cullFace(1032))):z(2884),w=t}function Z(t,n,r){t?(F(32823),M===n&&k===r||(e.polygonOffset(n,r),M=n,k=r)):z(32823)}function q(t){void 0===t&&(t=33984+T-1),R!==t&&(e.activeTexture(t),R=t)}return{buffers:{color:o,depth:s,stencil:u},enable:F,disable:z,bindFramebuffer:function(t,n){return c[t]!==n&&(e.bindFramebuffer(t,n),c[t]=n,a&&(36009===t&&(c[36160]=n),36160===t&&(c[36009]=n)),!0)},useProgram:function(t){return h!==t&&(e.useProgram(t),h=t,!0)},setBlending:j,setMaterial:function(e,t){e.side===Fr?z(2884):F(2884);var n=e.side===Ur;t&&(n=!n),H(n),e.blending===Gr&&!1===e.transparent?j(Vr):j(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),s.setFunc(e.depthFunc),s.setTest(e.depthTest),s.setMask(e.depthWrite),o.setMask(e.colorWrite);var r=e.stencilWrite;u.setTest(r),r&&(u.setMask(e.stencilWriteMask),u.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),u.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),Z(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage?F(32926):z(32926)},setFlipSided:H,setCullFace:W,setLineWidth:function(t){t!==S&&(E&&e.lineWidth(t),S=t)},setPolygonOffset:Z,setScissorTest:function(e){e?F(3089):z(3089)},activeTexture:q,bindTexture:function(t,n){null===R&&q();var r=P[R];void 0===r&&(r={type:void 0,texture:void 0},P[R]=r),r.type===t&&r.texture===n||(e.bindTexture(t,n||U[t]),r.type=t,r.texture=n)},unbindTexture:function(){var t=P[R];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texStorage2D:function(){try{e.texStorage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage2D:function(){try{e.texSubImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(t){!1===N.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),N.copy(t))},viewport:function(t){!1===I.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),I.copy(t))},reset:function(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),!0===a&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),l={},R=null,P={},c={},h=null,f=!1,d=null,p=null,v=null,m=null,g=null,y=null,b=null,_=!1,x=null,w=null,S=null,M=null,k=null,N.set(0,0,e.canvas.width,e.canvas.height),I.set(0,0,e.canvas.width,e.canvas.height),o.reset(),s.reset(),u.reset()}}}function jf(e,t,n,r,i,a,o){var s,u,l,c=i.isWebGL2,h=i.maxTextures,f=i.maxCubemapSize,d=i.maxTextureSize,p=i.maxSamples,v=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):void 0,m=new WeakMap,g=!1;try{g="undefined"!==typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(V){}function y(e,t){return g?new OffscreenCanvas(e,t):Ss("canvas")}function b(e,t,n,r){var i=1;if((e.width>r||e.height>r)&&(i=r/Math.max(e.width,e.height)),i<1||!0===t){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap){var a=t?vs:Math.floor,o=a(i*e.width),s=a(i*e.height);void 0===l&&(l=y(o,s));var u=n?y(o,s):l;return u.width=o,u.height=s,u.getContext("2d").drawImage(e,0,0,o,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+o+"x"+s+")."),u}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function _(e){return ds(e.width)&&ds(e.height)}function x(e,t){return e.generateMipmaps&&t&&e.minFilter!==Oi&&e.minFilter!==Vi}function w(t){e.generateMipmap(t)}function S(n,r,i){if(!1===c)return r;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}var a=r;return 6403===r&&(5126===i&&(a=33326),5131===i&&(a=33325),5121===i&&(a=33321)),6407===r&&(5126===i&&(a=34837),5131===i&&(a=34843),5121===i&&(a=32849)),6408===r&&(5126===i&&(a=34836),5131===i&&(a=34842),5121===i&&(a=32856)),33325!==a&&33326!==a&&34842!==a&&34836!==a||t.get("EXT_color_buffer_float"),a}function M(e){return e===Oi||e===Ui||e===zi?9728:9729}function k(t){var n=t.target;n.removeEventListener("dispose",k),function(t){var n=r.get(t);if(void 0===n.__webglInit)return;e.deleteTexture(n.__webglTexture),r.remove(t)}(n),n.isVideoTexture&&m.delete(n),o.memory.textures--}function T(t){var n=t.target;n.removeEventListener("dispose",T),function(t){var n=t.texture,i=r.get(t),a=r.get(n);if(!t)return;void 0!==a.__webglTexture&&(e.deleteTexture(a.__webglTexture),o.memory.textures--);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLCubeRenderTarget)for(var s=0;s<6;s++)e.deleteFramebuffer(i.__webglFramebuffer[s]),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer[s]);else e.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer),i.__webglMultisampledFramebuffer&&e.deleteFramebuffer(i.__webglMultisampledFramebuffer),i.__webglColorRenderbuffer&&e.deleteRenderbuffer(i.__webglColorRenderbuffer),i.__webglDepthRenderbuffer&&e.deleteRenderbuffer(i.__webglDepthRenderbuffer);if(t.isWebGLMultipleRenderTargets)for(var u=0,l=n.length;u<l;u++){var c=r.get(n[u]);c.__webglTexture&&(e.deleteTexture(c.__webglTexture),o.memory.textures--),r.remove(n[u])}r.remove(n),r.remove(t)}(n)}var E=0;function C(e,t){var i=r.get(e);if(e.isVideoTexture&&function(e){var t=o.render.frame;m.get(e)!==t&&(m.set(e,t),e.update())}(e),e.version>0&&i.__version!==e.version){var a=e.image;if(void 0===a)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==a.complete)return void N(i,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+t),n.bindTexture(3553,i.__webglTexture)}function A(t,i){var o=r.get(t);t.version>0&&o.__version!==t.version?function(t,r,i){if(6!==r.image.length)return;D(t,r),n.activeTexture(33984+i),n.bindTexture(34067,t.__webglTexture),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0);for(var o=r&&(r.isCompressedTexture||r.image[0].isCompressedTexture),s=r.image[0]&&r.image[0].isDataTexture,u=[],l=0;l<6;l++)u[l]=o||s?s?r.image[l].image:r.image[l]:b(r.image[l],!1,!0,f);var h,d=_(u[0])||c,p=a.convert(r.format),v=a.convert(r.type),m=S(r.internalFormat,p,v,r.encoding);if(L(34067,r,d),o)for(var g=0;g<6;g++){h=u[g].mipmaps;for(var y=0;y<h.length;y++){var M=h[y];r.format!==oa&&r.format!==aa?null!==p?n.compressedTexImage2D(34069+g,y,m,M.width,M.height,0,M.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+g,y,m,M.width,M.height,0,p,v,M.data)}}else{h=r.mipmaps;for(var k=0;k<6;k++)if(s){n.texImage2D(34069+k,0,m,u[k].width,u[k].height,0,p,v,u[k].data);for(var T=0;T<h.length;T++){var E=h[T].image[k].image;n.texImage2D(34069+k,T+1,m,E.width,E.height,0,p,v,E.data)}}else{n.texImage2D(34069+k,0,m,p,v,u[k]);for(var C=0;C<h.length;C++){var A=h[C];n.texImage2D(34069+k,C+1,m,p,v,A.image[k])}}}x(r,d)&&w(34067);t.__version=r.version,r.onUpdate&&r.onUpdate(r)}(o,t,i):(n.activeTexture(33984+i),n.bindTexture(34067,o.__webglTexture))}var R=(gr(s={},Di,10497),gr(s,Ni,33071),gr(s,Ii,33648),s),P=(gr(u={},Oi,9728),gr(u,Ui,9984),gr(u,zi,9986),gr(u,Vi,9729),gr(u,Gi,9985),gr(u,Hi,9987),u);function L(n,a,o){if(o?(e.texParameteri(n,10242,R[a.wrapS]),e.texParameteri(n,10243,R[a.wrapT]),32879!==n&&35866!==n||e.texParameteri(n,32882,R[a.wrapR]),e.texParameteri(n,10240,P[a.magFilter]),e.texParameteri(n,10241,P[a.minFilter])):(e.texParameteri(n,10242,33071),e.texParameteri(n,10243,33071),32879!==n&&35866!==n||e.texParameteri(n,32882,33071),a.wrapS===Ni&&a.wrapT===Ni||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,10240,M(a.magFilter)),e.texParameteri(n,10241,M(a.minFilter)),a.minFilter!==Oi&&a.minFilter!==Vi&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===t.has("EXT_texture_filter_anisotropic")){var s=t.get("EXT_texture_filter_anisotropic");if(a.type===Qi&&!1===t.has("OES_texture_float_linear"))return;if(!1===c&&a.type===$i&&!1===t.has("OES_texture_half_float_linear"))return;(a.anisotropy>1||r.get(a).__currentAnisotropy)&&(e.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy)}}function D(t,n){void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",k),t.__webglTexture=e.createTexture(),o.memory.textures++)}function N(t,r,i){var o=3553;r.isDataTexture2DArray&&(o=35866),r.isDataTexture3D&&(o=32879),D(t,r),n.activeTexture(33984+i),n.bindTexture(o,t.__webglTexture),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0);var s,u=function(e){return!c&&(e.wrapS!==Ni||e.wrapT!==Ni||e.minFilter!==Oi&&e.minFilter!==Vi)}(r)&&!1===_(r.image),l=b(r.image,u,!1,d),h=_(l)||c,f=a.convert(r.format),p=a.convert(r.type),v=S(r.internalFormat,f,p,r.encoding);L(o,r,h);var m=r.mipmaps;if(r.isDepthTexture)v=6402,c?v=r.type===Qi?36012:r.type===Ji?33190:r.type===ra?35056:33189:r.type===Qi&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),r.format===ca&&6402===v&&r.type!==Yi&&r.type!==Ji&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=Yi,p=a.convert(r.type)),r.format===ha&&6402===v&&(v=34041,r.type!==ra&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=ra,p=a.convert(r.type))),n.texImage2D(3553,0,v,l.width,l.height,0,f,p,null);else if(r.isDataTexture)if(m.length>0&&h){for(var g=0,y=m.length;g<y;g++)s=m[g],n.texImage2D(3553,g,v,s.width,s.height,0,f,p,s.data);r.generateMipmaps=!1}else n.texImage2D(3553,0,v,l.width,l.height,0,f,p,l.data);else if(r.isCompressedTexture)for(var M=0,k=m.length;M<k;M++)s=m[M],r.format!==oa&&r.format!==aa?null!==f?n.compressedTexImage2D(3553,M,v,s.width,s.height,0,s.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,M,v,s.width,s.height,0,f,p,s.data);else if(r.isDataTexture2DArray)n.texImage3D(35866,0,v,l.width,l.height,l.depth,0,f,p,l.data);else if(r.isDataTexture3D)n.texImage3D(32879,0,v,l.width,l.height,l.depth,0,f,p,l.data);else{var T=function(e,t,n){return!0===x(e,n)?Math.log2(Math.max(t.width,t.height))+1:e.mipmaps.length>0?e.mipmaps.length:1}(r,l,h),E=c&&!0!==r.isVideoTexture,C=void 0===t.__version;if(m.length>0&&h){E&&C&&n.texStorage2D(3553,T,v,m[0].width,m[0].height);for(var A=0,R=m.length;A<R;A++)s=m[A],E?n.texSubImage2D(3553,A,0,0,f,p,s):n.texImage2D(3553,A,v,f,p,s);r.generateMipmaps=!1}else E?(C&&n.texStorage2D(3553,T,v,l.width,l.height),n.texSubImage2D(3553,0,0,0,f,p,l)):n.texImage2D(3553,0,v,f,p,l)}x(r,h)&&w(o),t.__version=r.version,r.onUpdate&&r.onUpdate(r)}function I(t,i,o,s,u){var l=a.convert(o.format),c=a.convert(o.type),h=S(o.internalFormat,l,c,o.encoding);r.get(i).__hasExternalTextures||(32879===u||35866===u?n.texImage3D(u,0,h,i.width,i.height,i.depth,0,l,c,null):n.texImage2D(u,0,h,i.width,i.height,0,l,c,null)),n.bindFramebuffer(36160,t),i.useRenderToTexture?v.framebufferTexture2DMultisampleEXT(36160,s,u,r.get(o).__webglTexture,0,F(i)):e.framebufferTexture2D(36160,s,u,r.get(o).__webglTexture,0),n.bindFramebuffer(36160,null)}function O(t,n,r){if(e.bindRenderbuffer(36161,t),n.depthBuffer&&!n.stencilBuffer){var i=33189;if(r||n.useRenderToTexture){var o=n.depthTexture;o&&o.isDepthTexture&&(o.type===Qi?i=36012:o.type===Ji&&(i=33190));var s=F(n);n.useRenderToTexture?v.renderbufferStorageMultisampleEXT(36161,s,i,n.width,n.height):e.renderbufferStorageMultisample(36161,s,i,n.width,n.height)}else e.renderbufferStorage(36161,i,n.width,n.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(n.depthBuffer&&n.stencilBuffer){var u=F(n);r&&n.useRenderbuffer?e.renderbufferStorageMultisample(36161,u,35056,n.width,n.height):n.useRenderToTexture?v.renderbufferStorageMultisampleEXT(36161,u,35056,n.width,n.height):e.renderbufferStorage(36161,34041,n.width,n.height),e.framebufferRenderbuffer(36160,33306,36161,t)}else{var l=!0===n.isWebGLMultipleRenderTargets?n.texture[0]:n.texture,c=a.convert(l.format),h=a.convert(l.type),f=S(l.internalFormat,c,h,l.encoding),d=F(n);r&&n.useRenderbuffer?e.renderbufferStorageMultisample(36161,d,f,n.width,n.height):n.useRenderToTexture?v.renderbufferStorageMultisampleEXT(36161,d,f,n.width,n.height):e.renderbufferStorage(36161,f,n.width,n.height)}e.bindRenderbuffer(36161,null)}function U(t){var i=r.get(t),a=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture&&!i.__autoAllocateDepthBuffer){if(a)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,i){if(i&&i.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,t),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),C(i.depthTexture,0);var a=r.get(i.depthTexture).__webglTexture,o=F(i);if(i.depthTexture.format===ca)i.useRenderToTexture?v.framebufferTexture2DMultisampleEXT(36160,36096,3553,a,0,o):e.framebufferTexture2D(36160,36096,3553,a,0);else{if(i.depthTexture.format!==ha)throw new Error("Unknown depthTexture format");i.useRenderToTexture?v.framebufferTexture2DMultisampleEXT(36160,33306,3553,a,0,o):e.framebufferTexture2D(36160,33306,3553,a,0)}}(i.__webglFramebuffer,t)}else if(a){i.__webglDepthbuffer=[];for(var o=0;o<6;o++)n.bindFramebuffer(36160,i.__webglFramebuffer[o]),i.__webglDepthbuffer[o]=e.createRenderbuffer(),O(i.__webglDepthbuffer[o],t,!1)}else n.bindFramebuffer(36160,i.__webglFramebuffer),i.__webglDepthbuffer=e.createRenderbuffer(),O(i.__webglDepthbuffer,t,!1);n.bindFramebuffer(36160,null)}function F(e){return c&&(e.useRenderbuffer||e.useRenderToTexture)?Math.min(p,e.samples):0}var z=!1,B=!1;this.allocateTextureUnit=function(){var e=E;return e>=h&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+h),E+=1,e},this.resetTextureUnits=function(){E=0},this.setTexture2D=C,this.setTexture2DArray=function(e,t){var i=r.get(e);e.version>0&&i.__version!==e.version?N(i,e,t):(n.activeTexture(33984+t),n.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(e,t){var i=r.get(e);e.version>0&&i.__version!==e.version?N(i,e,t):(n.activeTexture(33984+t),n.bindTexture(32879,i.__webglTexture))},this.setTextureCube=A,this.rebindTextures=function(e,t,n){var i=r.get(e);void 0!==t&&I(i.__webglFramebuffer,e,e.texture,36064,3553),void 0!==n&&U(e)},this.setupRenderTarget=function(t){var s=t.texture,u=r.get(t),l=r.get(s);t.addEventListener("dispose",T),!0!==t.isWebGLMultipleRenderTargets&&(void 0===l.__webglTexture&&(l.__webglTexture=e.createTexture()),l.__version=s.version,o.memory.textures++);var h=!0===t.isWebGLCubeRenderTarget,f=!0===t.isWebGLMultipleRenderTargets,d=s.isDataTexture3D||s.isDataTexture2DArray,p=_(t)||c;if(!c||s.format!==aa||s.type!==Qi&&s.type!==$i||(s.format=oa,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),h){u.__webglFramebuffer=[];for(var v=0;v<6;v++)u.__webglFramebuffer[v]=e.createFramebuffer()}else if(u.__webglFramebuffer=e.createFramebuffer(),f)if(i.drawBuffers)for(var m=t.texture,g=0,y=m.length;g<y;g++){var b=r.get(m[g]);void 0===b.__webglTexture&&(b.__webglTexture=e.createTexture(),o.memory.textures++)}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(t.useRenderbuffer)if(c){u.__webglMultisampledFramebuffer=e.createFramebuffer(),u.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,u.__webglColorRenderbuffer);var M=a.convert(s.format),k=a.convert(s.type),E=S(s.internalFormat,M,k,s.encoding),C=F(t);e.renderbufferStorageMultisample(36161,C,E,t.width,t.height),n.bindFramebuffer(36160,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,u.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(u.__webglDepthRenderbuffer=e.createRenderbuffer(),O(u.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(h){n.bindTexture(34067,l.__webglTexture),L(34067,s,p);for(var A=0;A<6;A++)I(u.__webglFramebuffer[A],t,s,36064,34069+A);x(s,p)&&w(34067),n.unbindTexture()}else if(f){for(var R=t.texture,P=0,D=R.length;P<D;P++){var N=R[P],z=r.get(N);n.bindTexture(3553,z.__webglTexture),L(3553,N,p),I(u.__webglFramebuffer,t,N,36064+P,3553),x(N,p)&&w(3553)}n.unbindTexture()}else{var B=3553;if(d)if(c)B=s.isDataTexture3D?32879:35866;else console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.");n.bindTexture(B,l.__webglTexture),L(B,s,p),I(u.__webglFramebuffer,t,s,36064,B),x(s,p)&&w(B),n.unbindTexture()}t.depthBuffer&&U(t)},this.updateRenderTargetMipmap=function(e){for(var t=_(e)||c,i=!0===e.isWebGLMultipleRenderTargets?e.texture:[e.texture],a=0,o=i.length;a<o;a++){var s=i[a];if(x(s,t)){var u=e.isWebGLCubeRenderTarget?34067:3553,l=r.get(s).__webglTexture;n.bindTexture(u,l),w(u),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(t.useRenderbuffer)if(c){var i=t.width,a=t.height,o=16384,s=[36064],u=t.stencilBuffer?33306:36096;t.depthBuffer&&s.push(u),t.ignoreDepthForMultisampleCopy||(t.depthBuffer&&(o|=256),t.stencilBuffer&&(o|=1024));var l=r.get(t);n.bindFramebuffer(36008,l.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,l.__webglFramebuffer),t.ignoreDepthForMultisampleCopy&&(e.invalidateFramebuffer(36008,[u]),e.invalidateFramebuffer(36009,[u])),e.blitFramebuffer(0,0,i,a,0,0,i,a,o,9728),e.invalidateFramebuffer(36008,s),n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,l.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.setupDepthRenderbuffer=U,this.setupFrameBufferTexture=I,this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===z&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),z=!0),e=e.texture),C(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLCubeRenderTarget&&(!1===B&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),B=!0),e=e.texture),A(e,t)}}function Hf(e,t,n){var r=n.isWebGL2;return{convert:function(e){var n;if(e===Zi)return 5121;if(e===ea)return 32819;if(e===ta)return 32820;if(e===na)return 33635;if(e===qi)return 5120;if(e===Xi)return 5122;if(e===Yi)return 5123;if(e===Ki)return 5124;if(e===Ji)return 5125;if(e===Qi)return 5126;if(e===$i)return r?5131:null!==(n=t.get("OES_texture_half_float"))?n.HALF_FLOAT_OES:null;if(e===ia)return 6406;if(e===aa)return 6407;if(e===oa)return 6408;if(e===sa)return 6409;if(e===ua)return 6410;if(e===ca)return 6402;if(e===ha)return 34041;if(e===fa)return 6403;if(e===da)return 36244;if(e===pa)return 33319;if(e===va)return 33320;if(e===ma)return 36248;if(e===ga)return 36249;if(e===ya||e===ba||e===_a||e===xa){if(null===(n=t.get("WEBGL_compressed_texture_s3tc")))return null;if(e===ya)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===ba)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===_a)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===xa)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(e===wa||e===Sa||e===Ma||e===ka){if(null===(n=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(e===wa)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===Sa)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===Ma)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===ka)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===Ta)return null!==(n=t.get("WEBGL_compressed_texture_etc1"))?n.COMPRESSED_RGB_ETC1_WEBGL:null;if((e===Ea||e===Ca)&&null!==(n=t.get("WEBGL_compressed_texture_etc"))){if(e===Ea)return n.COMPRESSED_RGB8_ETC2;if(e===Ca)return n.COMPRESSED_RGBA8_ETC2_EAC}return e===Aa||e===Ra||e===Pa||e===La||e===Da||e===Na||e===Ia||e===Oa||e===Ua||e===Fa||e===za||e===Ba||e===Va||e===Ga||e===Ha||e===Wa||e===Za||e===qa||e===Xa||e===Ya||e===Ka||e===Ja||e===Qa||e===$a||e===eo||e===to||e===no||e===ro?null!==(n=t.get("WEBGL_compressed_texture_astc"))?e:null:e===ja?null!==(n=t.get("EXT_texture_compression_bptc"))?e:null:e===ra?r?34042:null!==(n=t.get("WEBGL_depth_texture"))?n.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}var Wf=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,u.Z)(this,n),(e=t.call(this)).cameras=r,e}return(0,l.Z)(n)}(Kl);Wf.prototype.isArrayCamera=!0;var Zf=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.call(this)).type="Group",e}return(0,l.Z)(n)}(Ou);Zf.prototype.isGroup=!0;var qf={type:"move"},Xf=function(){function e(){(0,u.Z)(this,e),this._targetRay=null,this._grip=null,this._hand=null}return(0,l.Z)(e,[{key:"getHandSpace",value:function(){return null===this._hand&&(this._hand=new Zf,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}},{key:"getTargetRaySpace",value:function(){return null===this._targetRay&&(this._targetRay=new Zf,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Ns,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Ns),this._targetRay}},{key:"getGripSpace",value:function(){return null===this._grip&&(this._grip=new Zf,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Ns,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Ns),this._grip}},{key:"dispatchEvent",value:function(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}},{key:"disconnect",value:function(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}},{key:"update",value:function(e,t,n){var r=null,i=null,a=null,o=this._targetRay,u=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState)if(null!==o&&null!==(r=t.getPose(e.targetRaySpace,n))&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(qf)),l&&e.hand){a=!0;var c,h=s(e.hand.values());try{for(h.s();!(c=h.n()).done;){var f=c.value,d=t.getJointPose(f,n);if(void 0===l.joints[f.jointName]){var p=new Zf;p.matrixAutoUpdate=!1,p.visible=!1,l.joints[f.jointName]=p,l.add(p)}var v=l.joints[f.jointName];null!==d&&(v.matrix.fromArray(d.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.jointRadius=d.radius),v.visible=null!==d}}catch(b){h.e(b)}finally{h.f()}var m=l.joints["index-finger-tip"],g=l.joints["thumb-tip"],y=m.position.distanceTo(g.position);l.inputState.pinching&&y>.025?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&y<=.015&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==u&&e.gripSpace&&null!==(i=t.getPose(e.gripSpace,n))&&(u.matrix.fromArray(i.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),i.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(i.linearVelocity)):u.hasLinearVelocity=!1,i.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(i.angularVelocity)):u.hasAngularVelocity=!1);return null!==o&&(o.visible=null!==r),null!==u&&(u.visible=null!==i),null!==l&&(l.visible=null!==a),this}}]),e}(),Yf=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i,a,o,s,l,c,h,f){var d;if((0,u.Z)(this,n),(f=void 0!==f?f:ca)!==ca&&f!==ha)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");return void 0===i&&f===ca&&(i=Yi),void 0===i&&f===ha&&(i=ra),(d=t.call(this,null,a,o,s,l,c,f,i,h)).image={width:e,height:r},d.magFilter=void 0!==l?l:Oi,d.minFilter=void 0!==c?c:Oi,d.flipY=!1,d.generateMipmaps=!1,d}return(0,l.Z)(n)}(Es);Yf.prototype.isDepthTexture=!0;var Kf=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r){var i;(0,u.Z)(this,n),i=t.call(this);var a=(0,c.Z)(i),o=null,s=1,l=null,h="local-floor",f=e.extensions.has("WEBGL_multisampled_render_to_texture"),d=null,p=null,v=null,m=null,g=!1,y=null,b=r.getContextAttributes(),_=null,x=null,w=[],S=new Map,M=new Kl;M.layers.enable(1),M.viewport=new As;var k=new Kl;k.layers.enable(2),k.viewport=new As;var T=[M,k],E=new Wf;E.layers.enable(1),E.layers.enable(2);var C=null,A=null;function R(e){var t=S.get(e.inputSource);t&&t.dispatchEvent({type:e.type,data:e.inputSource})}function P(){S.forEach((function(e,t){e.disconnect(t)})),S.clear(),C=null,A=null,e.setRenderTarget(_),m=null,v=null,p=null,o=null,x=null,U.stop(),a.isPresenting=!1,a.dispatchEvent({type:"sessionend"})}function L(e){for(var t=o.inputSources,n=0;n<w.length;n++)S.set(t[n],w[n]);for(var r=0;r<e.removed.length;r++){var i=e.removed[r],a=S.get(i);a&&(a.dispatchEvent({type:"disconnected",data:i}),S.delete(i))}for(var s=0;s<e.added.length;s++){var u=e.added[s],l=S.get(u);l&&l.dispatchEvent({type:"connected",data:u})}}i.cameraAutoUpdate=!0,i.enabled=!1,i.isPresenting=!1,i.getController=function(e){var t=w[e];return void 0===t&&(t=new Xf,w[e]=t),t.getTargetRaySpace()},i.getControllerGrip=function(e){var t=w[e];return void 0===t&&(t=new Xf,w[e]=t),t.getGripSpace()},i.getHand=function(e){var t=w[e];return void 0===t&&(t=new Xf,w[e]=t),t.getHandSpace()},i.setFramebufferScaleFactor=function(e){s=e,!0===a.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},i.setReferenceSpaceType=function(e){h=e,!0===a.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},i.getReferenceSpace=function(){return l},i.getBaseLayer=function(){return null!==v?v:m},i.getBinding=function(){return p},i.getFrame=function(){return y},i.getSession=function(){return o},i.setSession=function(){var t=pr(fr().mark((function t(n){var i,u,c,d,y;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===(o=n)){t.next=23;break}if(_=e.getRenderTarget(),o.addEventListener("select",R),o.addEventListener("selectstart",R),o.addEventListener("selectend",R),o.addEventListener("squeeze",R),o.addEventListener("squeezestart",R),o.addEventListener("squeezeend",R),o.addEventListener("end",P),o.addEventListener("inputsourceschange",L),!0===b.xrCompatible){t.next=14;break}return t.next=14,r.makeXRCompatible();case 14:return void 0===o.renderState.layers||!1===e.capabilities.isWebGL2?(i={antialias:void 0!==o.renderState.layers||b.antialias,alpha:b.alpha,depth:b.depth,stencil:b.stencil,framebufferScaleFactor:s},m=new XRWebGLLayer(o,r,i),o.updateRenderState({baseLayer:m}),x=new Rs(m.framebufferWidth,m.framebufferHeight)):(g=b.antialias,u=null,c=null,d=null,b.depth&&(d=b.stencil?35056:33189,u=b.stencil?ha:ca,c=b.stencil?ra:Yi),y={colorFormat:b.alpha||g?32856:32849,depthFormat:d,scaleFactor:s},p=new XRWebGLBinding(o,r),v=p.createProjectionLayer(y),o.updateRenderState({layers:[v]}),x=g?new Ls(v.textureWidth,v.textureHeight,{format:oa,type:Zi,depthTexture:new Yf(v.textureWidth,v.textureHeight,c,void 0,void 0,void 0,void 0,void 0,void 0,u),stencilBuffer:b.stencil,ignoreDepth:v.ignoreDepthValues,useRenderToTexture:f}):new Rs(v.textureWidth,v.textureHeight,{format:b.alpha?oa:aa,type:Zi,depthTexture:new Yf(v.textureWidth,v.textureHeight,c,void 0,void 0,void 0,void 0,void 0,void 0,u),stencilBuffer:b.stencil,ignoreDepth:v.ignoreDepthValues})),this.setFoveation(0),t.next=18,o.requestReferenceSpace(h);case 18:l=t.sent,U.setContext(o),U.start(),a.isPresenting=!0,a.dispatchEvent({type:"sessionstart"});case 23:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}();var D=new Ns,N=new Ns;function I(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}i.updateCamera=function(e){if(null!==o){E.near=k.near=M.near=e.near,E.far=k.far=M.far=e.far,C===E.near&&A===E.far||(o.updateRenderState({depthNear:E.near,depthFar:E.far}),C=E.near,A=E.far);var t=e.parent,n=E.cameras;I(E,t);for(var r=0;r<n.length;r++)I(n[r],t);E.matrixWorld.decompose(E.position,E.quaternion,E.scale),e.position.copy(E.position),e.quaternion.copy(E.quaternion),e.scale.copy(E.scale),e.matrix.copy(E.matrix),e.matrixWorld.copy(E.matrixWorld);for(var i=e.children,a=0,s=i.length;a<s;a++)i[a].updateMatrixWorld(!0);2===n.length?function(e,t,n){D.setFromMatrixPosition(t.matrixWorld),N.setFromMatrixPosition(n.matrixWorld);var r=D.distanceTo(N),i=t.projectionMatrix.elements,a=n.projectionMatrix.elements,o=i[14]/(i[10]-1),s=i[14]/(i[10]+1),u=(i[9]+1)/i[5],l=(i[9]-1)/i[5],c=(i[8]-1)/i[0],h=(a[8]+1)/a[0],f=o*c,d=o*h,p=r/(-c+h),v=p*-c;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(v),e.translateZ(p),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();var m=o+p,g=s+p,y=f-v,b=d+(r-v),_=u*s/g*m,x=l*s/g*m;e.projectionMatrix.makePerspective(y,b,_,x,m,g)}(E,M,k):E.projectionMatrix.copy(M.projectionMatrix)}},i.getCamera=function(){return E},i.getFoveation=function(){return null!==v?v.fixedFoveation:null!==m?m.fixedFoveation:void 0},i.setFoveation=function(e){null!==v&&(v.fixedFoveation=e),null!==m&&void 0!==m.fixedFoveation&&(m.fixedFoveation=e)};var O=null;var U=new uc;return U.setAnimationLoop((function(t,n){if(d=n.getViewerPose(l),y=n,null!==d){var r=d.views;null!==m&&(e.setRenderTargetFramebuffer(x,m.framebuffer),e.setRenderTarget(x));var i=!1;r.length!==E.cameras.length&&(E.cameras.length=0,i=!0);for(var a=0;a<r.length;a++){var s=r[a],u=null;if(null!==m)u=m.getViewport(s);else{var c=p.getViewSubImage(v,s);u=c.viewport,0===a&&(e.setRenderTargetTextures(x,c.colorTexture,v.ignoreDepthValues?void 0:c.depthStencilTexture),e.setRenderTarget(x))}var h=T[a];h.matrix.fromArray(s.transform.matrix),h.projectionMatrix.fromArray(s.projectionMatrix),h.viewport.set(u.x,u.y,u.width,u.height),0===a&&E.matrix.copy(h.matrix),!0===i&&E.cameras.push(h)}}for(var f=o.inputSources,g=0;g<w.length;g++){var b=w[g],_=f[g];b.update(_,n,l)}O&&O(t,n),y=null})),i.setAnimationLoop=function(e){O=e},i.dispose=function(){},i}return(0,l.Z)(n)}(rs);function Jf(e){function t(t,n){t.opacity.value=n.opacity,n.color&&t.diffuse.value.copy(n.color),n.emissive&&t.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(t.map.value=n.map),n.alphaMap&&(t.alphaMap.value=n.alphaMap),n.specularMap&&(t.specularMap.value=n.specularMap),n.alphaTest>0&&(t.alphaTest.value=n.alphaTest);var r,i,a=e.get(n).envMap;a&&(t.envMap.value=a,t.flipEnvMap.value=a.isCubeTexture&&!1===a.isRenderTargetTexture?-1:1,t.reflectivity.value=n.reflectivity,t.ior.value=n.ior,t.refractionRatio.value=n.refractionRatio),n.lightMap&&(t.lightMap.value=n.lightMap,t.lightMapIntensity.value=n.lightMapIntensity),n.aoMap&&(t.aoMap.value=n.aoMap,t.aoMapIntensity.value=n.aoMapIntensity),n.map?r=n.map:n.specularMap?r=n.specularMap:n.displacementMap?r=n.displacementMap:n.normalMap?r=n.normalMap:n.bumpMap?r=n.bumpMap:n.roughnessMap?r=n.roughnessMap:n.metalnessMap?r=n.metalnessMap:n.alphaMap?r=n.alphaMap:n.emissiveMap?r=n.emissiveMap:n.clearcoatMap?r=n.clearcoatMap:n.clearcoatNormalMap?r=n.clearcoatNormalMap:n.clearcoatRoughnessMap?r=n.clearcoatRoughnessMap:n.specularIntensityMap?r=n.specularIntensityMap:n.specularColorMap?r=n.specularColorMap:n.transmissionMap?r=n.transmissionMap:n.thicknessMap?r=n.thicknessMap:n.sheenColorMap?r=n.sheenColorMap:n.sheenRoughnessMap&&(r=n.sheenRoughnessMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix)),n.aoMap?i=n.aoMap:n.lightMap&&(i=n.lightMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uv2Transform.value.copy(i.matrix))}function n(t,n){t.roughness.value=n.roughness,t.metalness.value=n.metalness,n.roughnessMap&&(t.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(t.metalnessMap.value=n.metalnessMap),n.emissiveMap&&(t.emissiveMap.value=n.emissiveMap),n.bumpMap&&(t.bumpMap.value=n.bumpMap,t.bumpScale.value=n.bumpScale,n.side===Ur&&(t.bumpScale.value*=-1)),n.normalMap&&(t.normalMap.value=n.normalMap,t.normalScale.value.copy(n.normalScale),n.side===Ur&&t.normalScale.value.negate()),n.displacementMap&&(t.displacementMap.value=n.displacementMap,t.displacementScale.value=n.displacementScale,t.displacementBias.value=n.displacementBias),e.get(n).envMap&&(t.envMapIntensity.value=n.envMapIntensity)}return{refreshFogUniforms:function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)},refreshMaterialUniforms:function(e,r,i,a,o){r.isMeshBasicMaterial?t(e,r):r.isMeshLambertMaterial?(t(e,r),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(e,r)):r.isMeshToonMaterial?(t(e,r),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap);t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===Ur&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===Ur&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshPhongMaterial?(t(e,r),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===Ur&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===Ur&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshStandardMaterial?(t(e,r),r.isMeshPhysicalMaterial?function(e,t,r){n(e,t),e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap));t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap),t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,t.side===Ur&&e.clearcoatNormalScale.value.negate()));t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=r.texture,e.transmissionSamplerSize.value.set(r.width,r.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor));e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap);t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap)}(e,r,o):n(e,r)):r.isMeshMatcapMaterial?(t(e,r),function(e,t){t.matcap&&(e.matcap.value=t.matcap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===Ur&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===Ur&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshDepthMaterial?(t(e,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshDistanceMaterial?(t(e,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias);e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(e,r)):r.isMeshNormalMaterial?(t(e,r),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===Ur&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===Ur&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(e,r),r.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,r)):r.isPointsMaterial?function(e,t,n,r){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*n,e.scale.value=.5*r,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);t.alphaTest>0&&(e.alphaTest.value=t.alphaTest);var i;t.map?i=t.map:t.alphaMap&&(i=t.alphaMap);void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uvTransform.value.copy(i.matrix))}(e,r,i,a):r.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);t.alphaTest>0&&(e.alphaTest.value=t.alphaTest);var n;t.map?n=t.map:t.alphaMap&&(n=t.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(e,r):r.isShadowMaterial?(e.color.value.copy(r.color),e.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function Qf(){var e=Ss("canvas");return e.style.display="block",e}function $f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=void 0!==e.canvas?e.canvas:Qf(),n=void 0!==e.context?e.context:null,r=void 0!==e.alpha&&e.alpha,i=void 0===e.depth||e.depth,a=void 0===e.stencil||e.stencil,o=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,u=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,l=void 0!==e.powerPreference?e.powerPreference:"default",c=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat,h=null,f=null,d=[],p=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=bo,this.physicallyCorrectLights=!1,this.toneMapping=_i,this.toneMappingExposure=1;var v=this,m=!1,g=0,y=0,b=null,_=-1,x=null,w=new As,S=new As,M=null,k=t.width,T=t.height,E=1,C=null,A=null,R=new As(0,0,k,T),P=new As(0,0,k,T),L=!1,D=[],N=new sc,I=!1,O=!1,U=null,F=new hu,z=new Ns,B={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function V(){return null===b?E:1}var G,j,H,W,Z,q,X,Y,K,J,Q,$,ee,te,ne,re,ie,ae,oe,se,ue,le,ce,he=n;function fe(e,n){for(var r=0;r<e.length;r++){var i=e[r],a=t.getContext(i,n);if(null!==a)return a}return null}try{var de={alpha:r,depth:i,stencil:a,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:u,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r".concat(kr)),t.addEventListener("webglcontextlost",ge,!1),t.addEventListener("webglcontextrestored",ye,!1),null===he){var pe=["webgl2","webgl","experimental-webgl"];if(!0===v.isWebGL1Renderer&&pe.shift(),null===(he=fe(pe,de)))throw fe(pe)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===he.getShaderPrecisionFormat&&(he.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Ue){throw console.error("THREE.WebGLRenderer: "+Ue.message),Ue}function ve(){G=new Wc(he),j=new gc(he,G,e),G.init(j),le=new Hf(he,G,j),H=new Gf(he,G,j),D[0]=1029,W=new Xc(he),Z=new Cf,q=new jf(he,G,H,Z,j,le,W),X=new bc(v),Y=new Hc(v),K=new lc(he,j),ce=new vc(he,G,K,j),J=new Zc(he,K,W,ce),Q=new eh(he,J,K,W),oe=new $c(he,j,q),re=new yc(Z),$=new Ef(v,X,Y,G,j,ce,re),ee=new Jf(Z),te=new Lf(Z),ne=new Ff(G,j),ae=new pc(v,X,H,Q,s),ie=new Vf(v,Q,j),se=new mc(he,G,W,j),ue=new qc(he,G,W,j),W.programs=$.programs,v.capabilities=j,v.extensions=G,v.properties=Z,v.renderLists=te,v.shadowMap=ie,v.state=H,v.info=W}ve();var me=new Kf(v,he);function ge(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),m=!0}function ye(){console.log("THREE.WebGLRenderer: Context Restored."),m=!1;var e=W.autoReset,t=ie.enabled,n=ie.autoUpdate,r=ie.needsUpdate,i=ie.type;ve(),W.autoReset=e,ie.enabled=t,ie.autoUpdate=n,ie.needsUpdate=r,ie.type=i}function be(e){var t=e.target;t.removeEventListener("dispose",be),_e(t)}function _e(e){xe(e),Z.remove(e)}function xe(e){var t=Z.get(e).programs;void 0!==t&&t.forEach((function(e){$.releaseProgram(e)}))}this.xr=me,this.getContext=function(){return he},this.getContextAttributes=function(){return he.getContextAttributes()},this.forceContextLoss=function(){var e=G.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=G.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return E},this.setPixelRatio=function(e){void 0!==e&&(E=e,this.setSize(k,T,!1))},this.getSize=function(e){return e.set(k,T)},this.setSize=function(e,n,r){me.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(k=e,T=n,t.width=Math.floor(e*E),t.height=Math.floor(n*E),!1!==r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return e.set(k*E,T*E).floor()},this.setDrawingBufferSize=function(e,n,r){k=e,T=n,E=r,t.width=Math.floor(e*r),t.height=Math.floor(n*r),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return e.copy(w)},this.getViewport=function(e){return e.copy(R)},this.setViewport=function(e,t,n,r){e.isVector4?R.set(e.x,e.y,e.z,e.w):R.set(e,t,n,r),H.viewport(w.copy(R).multiplyScalar(E).floor())},this.getScissor=function(e){return e.copy(P)},this.setScissor=function(e,t,n,r){e.isVector4?P.set(e.x,e.y,e.z,e.w):P.set(e,t,n,r),H.scissor(S.copy(P).multiplyScalar(E).floor())},this.getScissorTest=function(){return L},this.setScissorTest=function(e){H.setScissorTest(L=e)},this.setOpaqueSort=function(e){C=e},this.setTransparentSort=function(e){A=e},this.getClearColor=function(e){return e.copy(ae.getClearColor())},this.setClearColor=function(){ae.setClearColor.apply(ae,arguments)},this.getClearAlpha=function(){return ae.getClearAlpha()},this.setClearAlpha=function(){ae.setClearAlpha.apply(ae,arguments)},this.clear=function(e,t,n){var r=0;(void 0===e||e)&&(r|=16384),(void 0===t||t)&&(r|=256),(void 0===n||n)&&(r|=1024),he.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",ge,!1),t.removeEventListener("webglcontextrestored",ye,!1),te.dispose(),ne.dispose(),Z.dispose(),X.dispose(),Y.dispose(),Q.dispose(),ce.dispose(),me.dispose(),me.removeEventListener("sessionstart",Me),me.removeEventListener("sessionend",ke),U&&(U.dispose(),U=null),Te.stop()},this.renderBufferDirect=function(e,t,n,r,i,a){null===t&&(t=B);var o=i.isMesh&&i.matrixWorld.determinant()<0,s=Ne(e,t,n,r,i);H.setMaterial(r,o);var u=n.index,l=n.attributes.position;if(null===u){if(void 0===l||0===l.count)return}else if(0===u.count)return;var c,h=1;!0===r.wireframe&&(u=J.getWireframeAttribute(n),h=2),ce.setup(i,r,s,n,u);var f=se;null!==u&&(c=K.get(u),(f=ue).setIndex(c));var d=null!==u?u.count:l.count,p=n.drawRange.start*h,v=n.drawRange.count*h,m=null!==a?a.start*h:0,g=null!==a?a.count*h:1/0,y=Math.max(p,m),b=Math.min(d,p+v,m+g)-1,_=Math.max(0,b-y+1);if(0!==_){if(i.isMesh)!0===r.wireframe?(H.setLineWidth(r.wireframeLinewidth*V()),f.setMode(1)):f.setMode(4);else if(i.isLine){var x=r.linewidth;void 0===x&&(x=1),H.setLineWidth(x*V()),i.isLineSegments?f.setMode(1):i.isLineLoop?f.setMode(2):f.setMode(3)}else i.isPoints?f.setMode(0):i.isSprite&&f.setMode(4);if(i.isInstancedMesh)f.renderInstances(y,_,i.count);else if(n.isInstancedBufferGeometry){var w=Math.min(n.instanceCount,n._maxInstanceCount);f.renderInstances(y,_,w)}else f.render(y,_)}},this.compile=function(e,t){(f=ne.get(e)).init(),p.push(f),e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(f.pushLight(e),e.castShadow&&f.pushShadow(e))})),f.setupLights(v.physicallyCorrectLights),e.traverse((function(t){var n=t.material;if(n)if(Array.isArray(n))for(var r=0;r<n.length;r++){Le(n[r],e,t)}else Le(n,e,t)})),p.pop(),f=null};var we=null;function Se(e){we&&we(e)}function Me(){Te.stop()}function ke(){Te.start()}var Te=new uc;function Ee(e,t,n,r){if(!1!==e.visible){if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)f.pushLight(e),e.castShadow&&f.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||N.intersectsSprite(e)){r&&z.setFromMatrixPosition(e.matrixWorld).applyMatrix4(F);var i=Q.update(e),a=e.material;a.visible&&h.push(e,i,a,n,z.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==W.render.frame&&(e.skeleton.update(),e.skeleton.frame=W.render.frame),!e.frustumCulled||N.intersectsObject(e))){r&&z.setFromMatrixPosition(e.matrixWorld).applyMatrix4(F);var o=Q.update(e),s=e.material;if(Array.isArray(s))for(var u=o.groups,l=0,c=u.length;l<c;l++){var d=u[l],p=s[d.materialIndex];p&&p.visible&&h.push(e,o,p,n,z.z,d)}else s.visible&&h.push(e,o,s,n,z.z,null)}for(var v=e.children,m=0,g=v.length;m<g;m++)Ee(v[m],t,n,r)}}function Ce(e,t,n,r){var i=e.opaque,a=e.transmissive,o=e.transparent;f.setupLightsView(n),a.length>0&&Ae(i,t,n),r&&H.viewport(w.copy(r)),i.length>0&&Re(i,t,n),a.length>0&&Re(a,t,n),o.length>0&&Re(o,t,n)}function Ae(e,t,n){if(null===U){var r=!0===o&&!0===j.isWebGL2;U=new(r?Ls:Rs)(1024,1024,{generateMipmaps:!0,type:null!==le.convert($i)?$i:Zi,minFilter:Hi,magFilter:Oi,wrapS:Ni,wrapT:Ni,useRenderToTexture:G.has("WEBGL_multisampled_render_to_texture")})}var i=v.getRenderTarget();v.setRenderTarget(U),v.clear();var a=v.toneMapping;v.toneMapping=_i,Re(e,t,n),v.toneMapping=a,q.updateMultisampleRenderTarget(U),q.updateRenderTargetMipmap(U),v.setRenderTarget(i)}function Re(e,t,n){for(var r=!0===t.isScene?t.overrideMaterial:null,i=0,a=e.length;i<a;i++){var o=e[i],s=o.object,u=o.geometry,l=null===r?o.material:r,c=o.group;s.layers.test(n.layers)&&Pe(s,t,n,u,l,c)}}function Pe(e,t,n,r,i,a){e.onBeforeRender(v,t,n,r,i,a),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),i.onBeforeRender(v,t,n,r,e,a),!0===i.transparent&&i.side===Fr?(i.side=Ur,i.needsUpdate=!0,v.renderBufferDirect(n,t,r,i,e,a),i.side=Or,i.needsUpdate=!0,v.renderBufferDirect(n,t,r,i,e,a),i.side=Fr):v.renderBufferDirect(n,t,r,i,e,a),e.onAfterRender(v,t,n,r,i,a)}function Le(e,t,n){!0!==t.isScene&&(t=B);var r=Z.get(e),i=f.state.lights,a=f.state.shadowsArray,o=i.state.version,s=$.getParameters(e,i.state,a,t,n),u=$.getProgramCacheKey(s),l=r.programs;r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=(e.isMeshStandardMaterial?Y:X).get(e.envMap||r.environment),void 0===l&&(e.addEventListener("dispose",be),l=new Map,r.programs=l);var c=l.get(u);if(void 0!==c){if(r.currentProgram===c&&r.lightsStateVersion===o)return De(e,s),c}else s.uniforms=$.getUniforms(e),e.onBuild(n,s,v),e.onBeforeCompile(s,v),c=$.acquireProgram(s,u),l.set(u,c),r.uniforms=s.uniforms;var h=r.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(h.clippingPlanes=re.uniform),De(e,s),r.needsLights=Oe(e),r.lightsStateVersion=o,r.needsLights&&(h.ambientLightColor.value=i.state.ambient,h.lightProbe.value=i.state.probe,h.directionalLights.value=i.state.directional,h.directionalLightShadows.value=i.state.directionalShadow,h.spotLights.value=i.state.spot,h.spotLightShadows.value=i.state.spotShadow,h.rectAreaLights.value=i.state.rectArea,h.ltc_1.value=i.state.rectAreaLTC1,h.ltc_2.value=i.state.rectAreaLTC2,h.pointLights.value=i.state.point,h.pointLightShadows.value=i.state.pointShadow,h.hemisphereLights.value=i.state.hemi,h.directionalShadowMap.value=i.state.directionalShadowMap,h.directionalShadowMatrix.value=i.state.directionalShadowMatrix,h.spotShadowMap.value=i.state.spotShadowMap,h.spotShadowMatrix.value=i.state.spotShadowMatrix,h.pointShadowMap.value=i.state.pointShadowMap,h.pointShadowMatrix.value=i.state.pointShadowMatrix);var d=c.getUniforms(),p=of.seqWithValue(d.seq,h);return r.currentProgram=c,r.uniformsList=p,c}function De(e,t){var n=Z.get(e);n.outputEncoding=t.outputEncoding,n.instancing=t.instancing,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents}function Ne(e,t,n,r,i){!0!==t.isScene&&(t=B),q.resetTextureUnits();var a=t.fog,o=r.isMeshStandardMaterial?t.environment:null,s=null===b?v.outputEncoding:b.texture.encoding,u=(r.isMeshStandardMaterial?Y:X).get(r.envMap||o),l=!0===r.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,c=!!r.normalMap&&!!n.attributes.tangent,h=!!n.morphAttributes.position,d=!!n.morphAttributes.normal,p=n.morphAttributes.position?n.morphAttributes.position.length:0,m=Z.get(r),g=f.state.lights;if(!0===I&&(!0===O||e!==x)){var y=e===x&&r.id===_;re.setState(r,e,y)}var w=!1;r.version===m.__version?m.needsLights&&m.lightsStateVersion!==g.state.version||m.outputEncoding!==s||i.isInstancedMesh&&!1===m.instancing?w=!0:i.isInstancedMesh||!0!==m.instancing?i.isSkinnedMesh&&!1===m.skinning?w=!0:i.isSkinnedMesh||!0!==m.skinning?m.envMap!==u||r.fog&&m.fog!==a?w=!0:void 0===m.numClippingPlanes||m.numClippingPlanes===re.numPlanes&&m.numIntersection===re.numIntersection?(m.vertexAlphas!==l||m.vertexTangents!==c||m.morphTargets!==h||m.morphNormals!==d||!0===j.isWebGL2&&m.morphTargetsCount!==p)&&(w=!0):w=!0:w=!0:w=!0:(w=!0,m.__version=r.version);var S=m.currentProgram;!0===w&&(S=Le(r,t,i));var M=!1,k=!1,C=!1,A=S.getUniforms(),R=m.uniforms;if(H.useProgram(S.program)&&(M=!0,k=!0,C=!0),r.id!==_&&(_=r.id,k=!0),M||x!==e){if(A.setValue(he,"projectionMatrix",e.projectionMatrix),j.logarithmicDepthBuffer&&A.setValue(he,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),x!==e&&(x=e,k=!0,C=!0),r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshStandardMaterial||r.envMap){var P=A.map.cameraPosition;void 0!==P&&P.setValue(he,z.setFromMatrixPosition(e.matrixWorld))}(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&A.setValue(he,"isOrthographic",!0===e.isOrthographicCamera),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.isShadowMaterial||i.isSkinnedMesh)&&A.setValue(he,"viewMatrix",e.matrixWorldInverse)}if(i.isSkinnedMesh){A.setOptional(he,i,"bindMatrix"),A.setOptional(he,i,"bindMatrixInverse");var L=i.skeleton;L&&(j.floatVertexTextures?(null===L.boneTexture&&L.computeBoneTexture(),A.setValue(he,"boneTexture",L.boneTexture,q),A.setValue(he,"boneTextureSize",L.boneTextureSize)):A.setOptional(he,L,"boneMatrices"))}return!n||void 0===n.morphAttributes.position&&void 0===n.morphAttributes.normal||oe.update(i,n,r,S),(k||m.receiveShadow!==i.receiveShadow)&&(m.receiveShadow=i.receiveShadow,A.setValue(he,"receiveShadow",i.receiveShadow)),k&&(A.setValue(he,"toneMappingExposure",v.toneMappingExposure),m.needsLights&&Ie(R,C),a&&r.fog&&ee.refreshFogUniforms(R,a),ee.refreshMaterialUniforms(R,r,E,T,U),of.upload(he,m.uniformsList,R,q)),r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(of.upload(he,m.uniformsList,R,q),r.uniformsNeedUpdate=!1),r.isSpriteMaterial&&A.setValue(he,"center",i.center),A.setValue(he,"modelViewMatrix",i.modelViewMatrix),A.setValue(he,"normalMatrix",i.normalMatrix),A.setValue(he,"modelMatrix",i.matrixWorld),S}function Ie(e,t){e.ambientLightColor.needsUpdate=t,e.lightProbe.needsUpdate=t,e.directionalLights.needsUpdate=t,e.directionalLightShadows.needsUpdate=t,e.pointLights.needsUpdate=t,e.pointLightShadows.needsUpdate=t,e.spotLights.needsUpdate=t,e.spotLightShadows.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}function Oe(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}Te.setAnimationLoop(Se),"undefined"!==typeof window&&Te.setContext(window),this.setAnimationLoop=function(e){we=e,me.setAnimationLoop(e),null===e?Te.stop():Te.start()},me.addEventListener("sessionstart",Me),me.addEventListener("sessionend",ke),this.render=function(e,t){if(void 0===t||!0===t.isCamera){if(!0!==m){!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),!0===me.enabled&&!0===me.isPresenting&&(!0===me.cameraAutoUpdate&&me.updateCamera(t),t=me.getCamera()),!0===e.isScene&&e.onBeforeRender(v,e,t,b),(f=ne.get(e,p.length)).init(),p.push(f),F.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),N.setFromProjectionMatrix(F),O=this.localClippingEnabled,I=re.init(this.clippingPlanes,O,t),(h=te.get(e,d.length)).init(),d.push(h),Ee(e,t,0,v.sortObjects),h.finish(),!0===v.sortObjects&&h.sort(C,A),!0===I&&re.beginShadows();var n=f.state.shadowsArray;if(ie.render(n,e,t),!0===I&&re.endShadows(),!0===this.info.autoReset&&this.info.reset(),ae.render(h,e),f.setupLights(v.physicallyCorrectLights),t.isArrayCamera)for(var r=t.cameras,i=0,a=r.length;i<a;i++){var o=r[i];Ce(h,e,o,o.viewport)}else Ce(h,e,t);null!==b&&(q.updateMultisampleRenderTarget(b),q.updateRenderTargetMipmap(b)),!0===e.isScene&&e.onAfterRender(v,e,t),H.buffers.depth.setTest(!0),H.buffers.depth.setMask(!0),H.buffers.color.setMask(!0),H.setPolygonOffset(!1),ce.resetDefaultState(),_=-1,x=null,p.pop(),f=p.length>0?p[p.length-1]:null,d.pop(),h=d.length>0?d[d.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return g},this.getActiveMipmapLevel=function(){return y},this.getRenderTarget=function(){return b},this.setRenderTargetTextures=function(e,t,n){Z.get(e.texture).__webglTexture=t,Z.get(e.depthTexture).__webglTexture=n;var r=Z.get(e);r.__hasExternalTextures=!0,r.__hasExternalTextures&&(r.__autoAllocateDepthBuffer=void 0===n,r.__autoAllocateDepthBuffer||e.useRenderToTexture&&(console.warn("render-to-texture extension was disabled because an external texture was provided"),e.useRenderToTexture=!1,e.useRenderbuffer=!0))},this.setRenderTargetFramebuffer=function(e,t){var n=Z.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=void 0===t},this.setRenderTarget=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;b=e,g=t,y=n;var r=!0;if(e){var i=Z.get(e);void 0!==i.__useDefaultFramebuffer?(H.bindFramebuffer(36160,null),r=!1):void 0===i.__webglFramebuffer?q.setupRenderTarget(e):i.__hasExternalTextures&&q.rebindTextures(e,Z.get(e.texture).__webglTexture,Z.get(e.depthTexture).__webglTexture)}var a=null,o=!1,s=!1;if(e){var u=e.texture;(u.isDataTexture3D||u.isDataTexture2DArray)&&(s=!0);var l=Z.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(a=l[t],o=!0):a=e.useRenderbuffer?Z.get(e).__webglMultisampledFramebuffer:l,w.copy(e.viewport),S.copy(e.scissor),M=e.scissorTest}else w.copy(R).multiplyScalar(E).floor(),S.copy(P).multiplyScalar(E).floor(),M=L;var c=H.bindFramebuffer(36160,a);if(c&&j.drawBuffers&&r){var h=!1;if(e)if(e.isWebGLMultipleRenderTargets){var f=e.texture;if(D.length!==f.length||36064!==D[0]){for(var d=0,p=f.length;d<p;d++)D[d]=36064+d;D.length=f.length,h=!0}}else 1===D.length&&36064===D[0]||(D[0]=36064,D.length=1,h=!0);else 1===D.length&&1029===D[0]||(D[0]=1029,D.length=1,h=!0);h&&(j.isWebGL2?he.drawBuffers(D):G.get("WEBGL_draw_buffers").drawBuffersWEBGL(D))}if(H.viewport(w),H.scissor(S),H.setScissorTest(M),o){var v=Z.get(e.texture);he.framebufferTexture2D(36160,36064,34069+t,v.__webglTexture,n)}else if(s){var m=Z.get(e.texture),x=t||0;he.framebufferTextureLayer(36160,36064,m.__webglTexture,n||0,x)}_=-1},this.readRenderTargetPixels=function(e,t,n,r,i,a,o){if(e&&e.isWebGLRenderTarget){var s=Z.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(s=s[o]),s){H.bindFramebuffer(36160,s);try{var u=e.texture,l=u.format,c=u.type;if(l!==oa&&le.convert(l)!==he.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");var h=c===$i&&(G.has("EXT_color_buffer_half_float")||j.isWebGL2&&G.has("EXT_color_buffer_float"));if(c!==Zi&&le.convert(c)!==he.getParameter(35738)&&(c!==Qi||!(j.isWebGL2||G.has("OES_texture_float")||G.has("WEBGL_color_buffer_float")))&&!h)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===he.checkFramebufferStatus(36160)?t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&he.readPixels(t,n,r,i,le.convert(l),le.convert(c),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{var f=null!==b?Z.get(b).__webglFramebuffer:null;H.bindFramebuffer(36160,f)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Math.pow(2,-n),i=Math.floor(t.image.width*r),a=Math.floor(t.image.height*r),o=le.convert(t.format);j.isWebGL2&&(6407===o&&(o=32849),6408===o&&(o=32856)),q.setTexture2D(t,0),he.copyTexImage2D(3553,n,o,e.x,e.y,i,a,0),H.unbindTexture()},this.copyTextureToTexture=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=t.image.width,a=t.image.height,o=le.convert(n.format),s=le.convert(n.type);q.setTexture2D(n,0),he.pixelStorei(37440,n.flipY),he.pixelStorei(37441,n.premultiplyAlpha),he.pixelStorei(3317,n.unpackAlignment),t.isDataTexture?he.texSubImage2D(3553,r,e.x,e.y,i,a,o,s,t.image.data):t.isCompressedTexture?he.compressedTexSubImage2D(3553,r,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,o,t.mipmaps[0].data):he.texSubImage2D(3553,r,e.x,e.y,o,s,t.image),0===r&&n.generateMipmaps&&he.generateMipmap(3553),H.unbindTexture()},this.copyTextureToTexture3D=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(v.isWebGL1Renderer)console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");else{var a,o=e.max.x-e.min.x+1,s=e.max.y-e.min.y+1,u=e.max.z-e.min.z+1,l=le.convert(r.format),c=le.convert(r.type);if(r.isDataTexture3D)q.setTexture3D(r,0),a=32879;else{if(!r.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");q.setTexture2DArray(r,0),a=35866}he.pixelStorei(37440,r.flipY),he.pixelStorei(37441,r.premultiplyAlpha),he.pixelStorei(3317,r.unpackAlignment);var h=he.getParameter(3314),f=he.getParameter(32878),d=he.getParameter(3316),p=he.getParameter(3315),m=he.getParameter(32877),g=n.isCompressedTexture?n.mipmaps[0]:n.image;he.pixelStorei(3314,g.width),he.pixelStorei(32878,g.height),he.pixelStorei(3316,e.min.x),he.pixelStorei(3315,e.min.y),he.pixelStorei(32877,e.min.z),n.isDataTexture||n.isDataTexture3D?he.texSubImage3D(a,i,t.x,t.y,t.z,o,s,u,l,c,g.data):n.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),he.compressedTexSubImage3D(a,i,t.x,t.y,t.z,o,s,u,l,g.data)):he.texSubImage3D(a,i,t.x,t.y,t.z,o,s,u,l,c,g),he.pixelStorei(3314,h),he.pixelStorei(32878,f),he.pixelStorei(3316,d),he.pixelStorei(3315,p),he.pixelStorei(32877,m),0===i&&r.generateMipmaps&&he.generateMipmap(a),H.unbindTexture()}},this.initTexture=function(e){q.setTexture2D(e,0),H.unbindTexture()},this.resetState=function(){g=0,y=0,b=null,H.reset(),ce.reset()},"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}$f.prototype.isWebGLRenderer=!0;var ed=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n)}($f);ed.prototype.isWebGL1Renderer=!0;var td=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25e-5;(0,u.Z)(this,e),this.name="",this.color=new nl(t),this.density=n}return(0,l.Z)(e,[{key:"clone",value:function(){return new e(this.color,this.density)}},{key:"toJSON",value:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}]),e}();td.prototype.isFogExp2=!0;var nd=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;(0,u.Z)(this,e),this.name="",this.color=new nl(t),this.near=n,this.far=r}return(0,l.Z)(e,[{key:"clone",value:function(){return new e(this.color,this.near,this.far)}},{key:"toJSON",value:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}]),e}();nd.prototype.isFog=!0;var rd=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.call(this)).type="Scene",e.background=null,e.environment=null,e.fog=null,e.overrideMaterial=null,e.autoUpdate=!0,"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:(0,c.Z)(e)})),e}return(0,l.Z)(n,[{key:"copy",value:function(e,t){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}},{key:"toJSON",value:function(e){var t=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this,e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}]),n}(Ou);rd.prototype.isScene=!0;var id=function(){function e(t,n){(0,u.Z)(this,e),this.array=t,this.stride=n,this.count=void 0!==t?t.length/n:0,this.usage=Zo,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=ls()}return(0,l.Z)(e,[{key:"onUploadCallback",value:function(){}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"setUsage",value:function(e){return this.usage=e,this}},{key:"copy",value:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}},{key:"copyAt",value:function(e,t,n){e*=this.stride,n*=t.stride;for(var r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this}},{key:"set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}},{key:"clone",value:function(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ls()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);var t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}},{key:"onUpload",value:function(e){return this.onUploadCallback=e,this}},{key:"toJSON",value:function(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ls()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}]),e}();id.prototype.isInterleavedBuffer=!0;var ad=new Ns,od=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,u.Z)(this,e),this.name="",this.data=t,this.itemSize=n,this.offset=r,this.normalized=!0===i}return(0,l.Z)(e,[{key:"count",get:function(){return this.data.count}},{key:"array",get:function(){return this.data.array}},{key:"needsUpdate",set:function(e){this.data.needsUpdate=e}},{key:"applyMatrix4",value:function(e){for(var t=0,n=this.data.count;t<n;t++)ad.x=this.getX(t),ad.y=this.getY(t),ad.z=this.getZ(t),ad.applyMatrix4(e),this.setXYZ(t,ad.x,ad.y,ad.z);return this}},{key:"applyNormalMatrix",value:function(e){for(var t=0,n=this.count;t<n;t++)ad.x=this.getX(t),ad.y=this.getY(t),ad.z=this.getZ(t),ad.applyNormalMatrix(e),this.setXYZ(t,ad.x,ad.y,ad.z);return this}},{key:"transformDirection",value:function(e){for(var t=0,n=this.count;t<n;t++)ad.x=this.getX(t),ad.y=this.getY(t),ad.z=this.getZ(t),ad.transformDirection(e),this.setXYZ(t,ad.x,ad.y,ad.z);return this}},{key:"setX",value:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}},{key:"setY",value:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}},{key:"setZ",value:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}},{key:"setW",value:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}},{key:"getX",value:function(e){return this.data.array[e*this.data.stride+this.offset]}},{key:"getY",value:function(e){return this.data.array[e*this.data.stride+this.offset+1]}},{key:"getZ",value:function(e){return this.data.array[e*this.data.stride+this.offset+2]}},{key:"getW",value:function(e){return this.data.array[e*this.data.stride+this.offset+3]}},{key:"setXY",value:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this}},{key:"setXYZ",value:function(e,t,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}},{key:"setXYZW",value:function(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}},{key:"clone",value:function(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");for(var n=[],r=0;r<this.count;r++)for(var i=r*this.data.stride+this.offset,a=0;a<this.itemSize;a++)n.push(this.data.array[i+a]);return new ol(new this.array.constructor(n),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new e(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}},{key:"toJSON",value:function(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");for(var t=[],n=0;n<this.count;n++)for(var r=n*this.data.stride+this.offset,i=0;i<this.itemSize;i++)t.push(this.data.array[r+i]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}]),e}();od.prototype.isInterleavedBufferAttribute=!0;var sd,ud=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).type="SpriteMaterial",r.color=new nl(16777215),r.map=null,r.alphaMap=null,r.rotation=0,r.sizeAttenuation=!0,r.transparent=!0,r.setValues(e),r}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}]),n}(Yu);ud.prototype.isSpriteMaterial=!0;var ld=new Ns,cd=new Ns,hd=new Ns,fd=new gs,dd=new gs,pd=new hu,vd=new Ns,md=new Ns,gd=new Ns,yd=new gs,bd=new gs,_d=new gs,xd=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;if((0,u.Z)(this,n),(r=t.call(this)).type="Sprite",void 0===sd){sd=new Ml;var i=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),a=new id(i,5);sd.setIndex([0,1,2,0,2,3]),sd.setAttribute("position",new od(a,3,0,!1)),sd.setAttribute("uv",new od(a,2,3,!1))}return r.geometry=sd,r.material=void 0!==e?e:new ud,r.center=new gs(.5,.5),r}return(0,l.Z)(n,[{key:"raycast",value:function(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),cd.setFromMatrixScale(this.matrixWorld),pd.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),hd.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&cd.multiplyScalar(-hd.z);var n,r,i=this.material.rotation;0!==i&&(r=Math.cos(i),n=Math.sin(i));var a=this.center;wd(vd.set(-.5,-.5,0),hd,a,cd,n,r),wd(md.set(.5,-.5,0),hd,a,cd,n,r),wd(gd.set(.5,.5,0),hd,a,cd,n,r),yd.set(0,0),bd.set(1,0),_d.set(1,1);var o=e.ray.intersectTriangle(vd,md,gd,!1,ld);if(null!==o||(wd(md.set(-.5,.5,0),hd,a,cd,n,r),bd.set(0,1),null!==(o=e.ray.intersectTriangle(vd,gd,md,!1,ld)))){var s=e.ray.origin.distanceTo(ld);s<e.near||s>e.far||t.push({distance:s,point:ld.clone(),uv:qu.getUV(ld,vd,md,gd,yd,bd,_d,new gs),face:null,object:this})}}},{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}]),n}(Ou);function wd(e,t,n,r,i,a){fd.subVectors(e,n).addScalar(.5).multiply(r),void 0!==i?(dd.x=a*fd.x-i*fd.y,dd.y=i*fd.x+a*fd.y):dd.copy(fd),e.copy(t),e.x+=dd.x,e.y+=dd.y,e.applyMatrix4(pd)}xd.prototype.isSprite=!0;var Sd=new Ns,Md=new Ns,kd=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.call(this))._currentLevel=0,e.type="LOD",Object.defineProperties((0,c.Z)(e),{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),e.autoUpdate=!0,e}return(0,l.Z)(n,[{key:"copy",value:function(e){wr((0,_r.Z)(n.prototype),"copy",this).call(this,e,!1);for(var t=e.levels,r=0,i=t.length;r<i;r++){var a=t[r];this.addLevel(a.object.clone(),a.distance)}return this.autoUpdate=e.autoUpdate,this}},{key:"addLevel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t=Math.abs(t);var n,r=this.levels;for(n=0;n<r.length&&!(t<r[n].distance);n++);return r.splice(n,0,{distance:t,object:e}),this.add(e),this}},{key:"getCurrentLevel",value:function(){return this._currentLevel}},{key:"getObjectForDistance",value:function(e){var t=this.levels;if(t.length>0){var n,r;for(n=1,r=t.length;n<r&&!(e<t[n].distance);n++);return t[n-1].object}return null}},{key:"raycast",value:function(e,t){if(this.levels.length>0){Sd.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(Sd);this.getObjectForDistance(n).raycast(e,t)}}},{key:"update",value:function(e){var t=this.levels;if(t.length>1){Sd.setFromMatrixPosition(e.matrixWorld),Md.setFromMatrixPosition(this.matrixWorld);var n,r,i=Sd.distanceTo(Md)/e.zoom;for(t[0].object.visible=!0,n=1,r=t.length;n<r&&i>=t[n].distance;n++)t[n-1].object.visible=!1,t[n].object.visible=!0;for(this._currentLevel=n-1;n<r;n++)t[n].object.visible=!1}}},{key:"toJSON",value:function(e){var t=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this,e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];for(var r=this.levels,i=0,a=r.length;i<a;i++){var o=r[i];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}}]),n}(Ou),Td=new Ns,Ed=new As,Cd=new As,Ad=new Ns,Rd=new hu,Pd=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r){var i;return(0,u.Z)(this,n),(i=t.call(this,e,r)).type="SkinnedMesh",i.bindMode="attached",i.bindMatrix=new hu,i.bindMatrixInverse=new hu,i}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}},{key:"bind",value:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}},{key:"pose",value:function(){this.skeleton.pose()}},{key:"normalizeSkinWeights",value:function(){for(var e=new As,t=this.geometry.attributes.skinWeight,n=0,r=t.count;n<r;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);var i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}},{key:"updateMatrixWorld",value:function(e){wr((0,_r.Z)(n.prototype),"updateMatrixWorld",this).call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}},{key:"boneTransform",value:function(e,t){var n=this.skeleton,r=this.geometry;Ed.fromBufferAttribute(r.attributes.skinIndex,e),Cd.fromBufferAttribute(r.attributes.skinWeight,e),Td.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(var i=0;i<4;i++){var a=Cd.getComponent(i);if(0!==a){var o=Ed.getComponent(i);Rd.multiplyMatrices(n.bones[o].matrixWorld,n.boneInverses[o]),t.addScaledVector(Ad.copy(Td).applyMatrix4(Rd),a)}}return t.applyMatrix4(this.bindMatrixInverse)}}]),n}(Gl);Pd.prototype.isSkinnedMesh=!0;var Ld=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.call(this)).type="Bone",e}return(0,l.Z)(n)}(Ou);Ld.prototype.isBone=!0;var Dd=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,l=arguments.length>5?arguments[5]:void 0,c=arguments.length>6?arguments[6]:void 0,h=arguments.length>7?arguments[7]:void 0,f=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Oi,d=arguments.length>9&&void 0!==arguments[9]?arguments[9]:Oi,p=arguments.length>10?arguments[10]:void 0,v=arguments.length>11?arguments[11]:void 0;return(0,u.Z)(this,n),(e=t.call(this,null,l,c,h,f,d,o,s,p,v)).image={data:r,width:i,height:a},e.magFilter=f,e.minFilter=d,e.generateMipmaps=!1,e.flipY=!1,e.unpackAlignment=1,e.needsUpdate=!0,e}return(0,l.Z)(n)}(Es);Dd.prototype.isDataTexture=!0;var Nd=new hu,Id=new hu,Od=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];(0,u.Z)(this,e),this.uuid=ls(),this.bones=t.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}return(0,l.Z)(e,[{key:"init",value:function(){var e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new hu)}}},{key:"calculateInverses",value:function(){this.boneInverses.length=0;for(var e=0,t=this.bones.length;e<t;e++){var n=new hu;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}},{key:"pose",value:function(){for(var e=0,t=this.bones.length;e<t;e++){var n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(var r=0,i=this.bones.length;r<i;r++){var a=this.bones[r];a&&(a.parent&&a.parent.isBone?(a.matrix.copy(a.parent.matrixWorld).invert(),a.matrix.multiply(a.matrixWorld)):a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale))}}},{key:"update",value:function(){for(var e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,a=e.length;i<a;i++){var o=e[i]?e[i].matrixWorld:Id;Nd.multiplyMatrices(o,t[i]),Nd.toArray(n,16*i)}null!==r&&(r.needsUpdate=!0)}},{key:"clone",value:function(){return new e(this.bones,this.boneInverses)}},{key:"computeBoneTexture",value:function(){var e=Math.sqrt(4*this.bones.length);e=ps(e),e=Math.max(e,4);var t=new Float32Array(e*e*4);t.set(this.boneMatrices);var n=new Dd(t,e,e,oa,Qi);return this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}},{key:"getBoneByName",value:function(e){for(var t=0,n=this.bones.length;t<n;t++){var r=this.bones[t];if(r.name===e)return r}}},{key:"dispose",value:function(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}},{key:"fromJSON",value:function(e,t){this.uuid=e.uuid;for(var n=0,r=e.bones.length;n<r;n++){var i=e.bones[n],a=t[i];void 0===a&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),a=new Ld),this.bones.push(a),this.boneInverses.push((new hu).fromArray(e.boneInverses[n]))}return this.init(),this}},{key:"toJSON",value:function(){var e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;for(var t=this.bones,n=this.boneInverses,r=0,i=t.length;r<i;r++){var a=t[r];e.bones.push(a.uuid);var o=n[r];e.boneInverses.push(o.toArray())}return e}}]),e}(),Ud=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return(0,u.Z)(this,n),"number"===typeof i&&(o=i,i=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),(a=t.call(this,e,r,i)).meshPerAttribute=o,a}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}},{key:"toJSON",value:function(){var e=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}]),n}(ol);Ud.prototype.isInstancedBufferAttribute=!0;var Fd=new hu,zd=new hu,Bd=[],Vd=new Gl,Gd=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i){var a;return(0,u.Z)(this,n),(a=t.call(this,e,r)).instanceMatrix=new Ud(new Float32Array(16*i),16),a.instanceColor=null,a.count=i,a.frustumCulled=!1,a}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}},{key:"getColorAt",value:function(e,t){t.fromArray(this.instanceColor.array,3*e)}},{key:"getMatrixAt",value:function(e,t){t.fromArray(this.instanceMatrix.array,16*e)}},{key:"raycast",value:function(e,t){var n=this.matrixWorld,r=this.count;if(Vd.geometry=this.geometry,Vd.material=this.material,void 0!==Vd.material)for(var i=0;i<r;i++){this.getMatrixAt(i,Fd),zd.multiplyMatrices(n,Fd),Vd.matrixWorld=zd,Vd.raycast(e,Bd);for(var a=0,o=Bd.length;a<o;a++){var s=Bd[a];s.instanceId=i,s.object=this,t.push(s)}Bd.length=0}}},{key:"setColorAt",value:function(e,t){null===this.instanceColor&&(this.instanceColor=new Ud(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}},{key:"setMatrixAt",value:function(e,t){t.toArray(this.instanceMatrix.array,16*e)}},{key:"updateMorphTargets",value:function(){}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),n}(Gl);Gd.prototype.isInstancedMesh=!0;var jd=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).type="LineBasicMaterial",r.color=new nl(16777215),r.linewidth=1,r.linecap="round",r.linejoin="round",r.setValues(e),r}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this}}]),n}(Yu);jd.prototype.isLineBasicMaterial=!0;var Hd=new Ns,Wd=new Ns,Zd=new hu,qd=new cu,Xd=new nu,Yd=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ml,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new jd;return(0,u.Z)(this,n),(e=t.call(this)).type="Line",e.geometry=r,e.material=i,e.updateMorphTargets(),e}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.material=e.material,this.geometry=e.geometry,this}},{key:"computeLineDistances",value:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[0],r=1,i=t.count;r<i;r++)Hd.fromBufferAttribute(t,r-1),Wd.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=Hd.distanceTo(Wd);e.setAttribute("lineDistance",new vl(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}},{key:"raycast",value:function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Xd.copy(n.boundingSphere),Xd.applyMatrix4(r),Xd.radius+=i,!1!==e.ray.intersectsSphere(Xd)){Zd.copy(r).invert(),qd.copy(e.ray).applyMatrix4(Zd);var o=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,u=new Ns,l=new Ns,c=new Ns,h=new Ns,f=this.isLineSegments?2:1;if(n.isBufferGeometry){var d=n.index,p=n.attributes.position;if(null!==d)for(var v=Math.max(0,a.start),m=Math.min(d.count,a.start+a.count)-1;v<m;v+=f){var g=d.getX(v),y=d.getX(v+1);if(u.fromBufferAttribute(p,g),l.fromBufferAttribute(p,y),!(qd.distanceSqToSegment(u,l,h,c)>s)){h.applyMatrix4(this.matrixWorld);var b=e.ray.origin.distanceTo(h);b<e.near||b>e.far||t.push({distance:b,point:c.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}else for(var _=Math.max(0,a.start),x=Math.min(p.count,a.start+a.count)-1;_<x;_+=f){if(u.fromBufferAttribute(p,_),l.fromBufferAttribute(p,_+1),!(qd.distanceSqToSegment(u,l,h,c)>s)){h.applyMatrix4(this.matrixWorld);var w=e.ray.origin.distanceTo(h);w<e.near||w>e.far||t.push({distance:w,point:c.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}},{key:"updateMorphTargets",value:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,a=r.length;i<a;i++){var o=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=i}}}}else{var s=e.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}]),n}(Ou);Yd.prototype.isLine=!0;var Kd=new Ns,Jd=new Ns,Qd=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r){var i;return(0,u.Z)(this,n),(i=t.call(this,e,r)).type="LineSegments",i}return(0,l.Z)(n,[{key:"computeLineDistances",value:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[],r=0,i=t.count;r<i;r+=2)Kd.fromBufferAttribute(t,r),Jd.fromBufferAttribute(t,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+Kd.distanceTo(Jd);e.setAttribute("lineDistance",new vl(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}]),n}(Yd);Qd.prototype.isLineSegments=!0;var $d=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r){var i;return(0,u.Z)(this,n),(i=t.call(this,e,r)).type="LineLoop",i}return(0,l.Z)(n)}(Yd);$d.prototype.isLineLoop=!0;var ep=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).type="PointsMaterial",r.color=new nl(16777215),r.map=null,r.alphaMap=null,r.size=1,r.sizeAttenuation=!0,r.setValues(e),r}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this}}]),n}(Yu);ep.prototype.isPointsMaterial=!0;var tp=new hu,np=new cu,rp=new nu,ip=new Ns,ap=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ml,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ep;return(0,u.Z)(this,n),(e=t.call(this)).type="Points",e.geometry=r,e.material=i,e.updateMorphTargets(),e}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.material=e.material,this.geometry=e.geometry,this}},{key:"raycast",value:function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),rp.copy(n.boundingSphere),rp.applyMatrix4(r),rp.radius+=i,!1!==e.ray.intersectsSphere(rp)){tp.copy(r).invert(),np.copy(e.ray).applyMatrix4(tp);var o=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o;if(n.isBufferGeometry){var u=n.index,l=n.attributes.position;if(null!==u)for(var c=Math.max(0,a.start),h=Math.min(u.count,a.start+a.count);c<h;c++){var f=u.getX(c);ip.fromBufferAttribute(l,f),op(ip,f,s,r,e,t,this)}else for(var d=Math.max(0,a.start),p=Math.min(l.count,a.start+a.count);d<p;d++)ip.fromBufferAttribute(l,d),op(ip,d,s,r,e,t,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}},{key:"updateMorphTargets",value:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,a=r.length;i<a;i++){var o=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=i}}}}else{var s=e.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}]),n}(Ou);function op(e,t,n,r,i,a,o){var s=np.distanceSqToPoint(e);if(s<n){var u=new Ns;np.closestPointToPoint(e,u),u.applyMatrix4(r);var l=i.ray.origin.distanceTo(u);if(l<i.near||l>i.far)return;a.push({distance:l,distanceToRay:Math.sqrt(s),point:u,index:t,face:null,object:o})}}ap.prototype.isPoints=!0;var sp=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i,a,o,s,l,h,f){var d;(0,u.Z)(this,n),(d=t.call(this,e,r,i,a,o,s,l,h,f)).format=void 0!==l?l:aa,d.minFilter=void 0!==s?s:Vi,d.magFilter=void 0!==o?o:Vi,d.generateMipmaps=!1;var p=(0,c.Z)(d);return"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback((function t(){p.needsUpdate=!0,e.requestVideoFrameCallback(t)})),d}return(0,l.Z)(n,[{key:"clone",value:function(){return new this.constructor(this.image).copy(this)}},{key:"update",value:function(){var e=this.image;!1==="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}]),n}(Es);sp.prototype.isVideoTexture=!0;var up=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i,a,o,s,l,c,h,f,d,p){var v;return(0,u.Z)(this,n),(v=t.call(this,null,s,l,c,h,f,a,o,d,p)).image={width:r,height:i},v.mipmaps=e,v.flipY=!1,v.generateMipmaps=!1,v}return(0,l.Z)(n)}(Es);up.prototype.isCompressedTexture=!0;var lp=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i,a,o,s,l,c,h){var f;return(0,u.Z)(this,n),(f=t.call(this,e,r,i,a,o,s,l,c,h)).needsUpdate=!0,f}return(0,l.Z)(n)}(Es);lp.prototype.isCanvasTexture=!0;var cp=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;(0,u.Z)(this,n),(e=t.call(this)).type="CircleGeometry",e.parameters={radius:r,segments:i,thetaStart:a,thetaLength:o},i=Math.max(3,i);var s=[],l=[],c=[],h=[],f=new Ns,d=new gs;l.push(0,0,0),c.push(0,0,1),h.push(.5,.5);for(var p=0,v=3;p<=i;p++,v+=3){var m=a+p/i*o;f.x=r*Math.cos(m),f.y=r*Math.sin(m),l.push(f.x,f.y,f.z),c.push(0,0,1),d.x=(l[v]/r+1)/2,d.y=(l[v+1]/r+1)/2,h.push(d.x,d.y)}for(var g=1;g<=i;g++)s.push(g,g+1,0);return e.setIndex(s),e.setAttribute("position",new vl(l,3)),e.setAttribute("normal",new vl(c,3)),e.setAttribute("uv",new vl(h,2)),e}return(0,l.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.segments,e.thetaStart,e.thetaLength)}}]),n}(Ml),hp=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,l=arguments.length>5&&void 0!==arguments[5]&&arguments[5],h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,f=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2*Math.PI;(0,u.Z)(this,n),(e=t.call(this)).type="CylinderGeometry",e.parameters={radiusTop:r,radiusBottom:i,height:a,radialSegments:o,heightSegments:s,openEnded:l,thetaStart:h,thetaLength:f};var d=(0,c.Z)(e);o=Math.floor(o),s=Math.floor(s);var p=[],v=[],m=[],g=[],y=0,b=[],_=a/2,x=0;function w(){for(var e=new Ns,t=new Ns,n=0,u=(i-r)/a,l=0;l<=s;l++){for(var c=[],w=l/s,S=w*(i-r)+r,M=0;M<=o;M++){var k=M/o,T=k*f+h,E=Math.sin(T),C=Math.cos(T);t.x=S*E,t.y=-w*a+_,t.z=S*C,v.push(t.x,t.y,t.z),e.set(E,u,C).normalize(),m.push(e.x,e.y,e.z),g.push(k,1-w),c.push(y++)}b.push(c)}for(var A=0;A<o;A++)for(var R=0;R<s;R++){var P=b[R][A],L=b[R+1][A],D=b[R+1][A+1],N=b[R][A+1];p.push(P,L,N),p.push(L,D,N),n+=6}d.addGroup(x,n,0),x+=n}function S(e){for(var t=y,n=new gs,a=new Ns,s=0,u=!0===e?r:i,l=!0===e?1:-1,c=1;c<=o;c++)v.push(0,_*l,0),m.push(0,l,0),g.push(.5,.5),y++;for(var b=y,w=0;w<=o;w++){var S=w/o*f+h,M=Math.cos(S),k=Math.sin(S);a.x=u*k,a.y=_*l,a.z=u*M,v.push(a.x,a.y,a.z),m.push(0,l,0),n.x=.5*M+.5,n.y=.5*k*l+.5,g.push(n.x,n.y),y++}for(var T=0;T<o;T++){var E=t+T,C=b+T;!0===e?p.push(C,C+1,E):p.push(C+1,C,E),s+=3}d.addGroup(x,s,!0===e?1:2),x+=s}return w(),!1===l&&(r>0&&S(!0),i>0&&S(!1)),e.setIndex(p),e.setAttribute("position",new vl(v,3)),e.setAttribute("normal",new vl(m,3)),e.setAttribute("uv",new vl(g,2)),e}return(0,l.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}]),n}(Ml),fp=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2*Math.PI;return(0,u.Z)(this,n),(e=t.call(this,0,r,i,a,o,s,l,c)).type="ConeGeometry",e.parameters={radius:r,height:i,radialSegments:a,heightSegments:o,openEnded:s,thetaStart:l,thetaLength:c},e}return(0,l.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}]),n}(hp),dp=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(0,u.Z)(this,n),(e=t.call(this)).type="PolyhedronGeometry",e.parameters={vertices:r,indices:i,radius:a,detail:o};var s=[],l=[];function c(e){for(var t=new Ns,n=new Ns,r=new Ns,a=0;a<i.length;a+=3)m(i[a+0],t),m(i[a+1],n),m(i[a+2],r),h(t,n,r,e)}function h(e,t,n,r){for(var i=r+1,a=[],o=0;o<=i;o++){a[o]=[];for(var s=e.clone().lerp(n,o/i),u=t.clone().lerp(n,o/i),l=i-o,c=0;c<=l;c++)a[o][c]=0===c&&o===i?s:s.clone().lerp(u,c/l)}for(var h=0;h<i;h++)for(var f=0;f<2*(i-h)-1;f++){var d=Math.floor(f/2);f%2===0?(v(a[h][d+1]),v(a[h+1][d]),v(a[h][d])):(v(a[h][d+1]),v(a[h+1][d+1]),v(a[h+1][d]))}}function f(e){for(var t=new Ns,n=0;n<s.length;n+=3)t.x=s[n+0],t.y=s[n+1],t.z=s[n+2],t.normalize().multiplyScalar(e),s[n+0]=t.x,s[n+1]=t.y,s[n+2]=t.z}function d(){for(var e=new Ns,t=0;t<s.length;t+=3){e.x=s[t+0],e.y=s[t+1],e.z=s[t+2];var n=b(e)/2/Math.PI+.5,r=_(e)/Math.PI+.5;l.push(n,1-r)}g(),p()}function p(){for(var e=0;e<l.length;e+=6){var t=l[e+0],n=l[e+2],r=l[e+4],i=Math.max(t,n,r),a=Math.min(t,n,r);i>.9&&a<.1&&(t<.2&&(l[e+0]+=1),n<.2&&(l[e+2]+=1),r<.2&&(l[e+4]+=1))}}function v(e){s.push(e.x,e.y,e.z)}function m(e,t){var n=3*e;t.x=r[n+0],t.y=r[n+1],t.z=r[n+2]}function g(){for(var e=new Ns,t=new Ns,n=new Ns,r=new Ns,i=new gs,a=new gs,o=new gs,u=0,c=0;u<s.length;u+=9,c+=6){e.set(s[u+0],s[u+1],s[u+2]),t.set(s[u+3],s[u+4],s[u+5]),n.set(s[u+6],s[u+7],s[u+8]),i.set(l[c+0],l[c+1]),a.set(l[c+2],l[c+3]),o.set(l[c+4],l[c+5]),r.copy(e).add(t).add(n).divideScalar(3);var h=b(r);y(i,c+0,e,h),y(a,c+2,t,h),y(o,c+4,n,h)}}function y(e,t,n,r){r<0&&1===e.x&&(l[t]=e.x-1),0===n.x&&0===n.z&&(l[t]=r/2/Math.PI+.5)}function b(e){return Math.atan2(e.z,-e.x)}function _(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}return c(o),f(a),d(),e.setAttribute("position",new vl(s,3)),e.setAttribute("normal",new vl(s.slice(),3)),e.setAttribute("uv",new vl(l,2)),0===o?e.computeVertexNormals():e.normalizeNormals(),e}return(0,l.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.vertices,e.indices,e.radius,e.details)}}]),n}(Ml),pp=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,u.Z)(this,n);var a=(1+Math.sqrt(5))/2,o=1/a,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-o,-a,0,-o,a,0,o,-a,0,o,a,-o,-a,0,-o,a,0,o,-a,0,o,a,0,-a,0,-o,a,0,-o,-a,0,o,a,0,o],l=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];return(e=t.call(this,s,l,r,i)).type="DodecahedronGeometry",e.parameters={radius:r,detail:i},e}return(0,l.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.detail)}}]),n}(dp),vp=new Ns,mp=new Ns,gp=new Ns,yp=new qu,bp=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if((0,u.Z)(this,n),(e=t.call(this)).type="EdgesGeometry",e.parameters={geometry:r,thresholdAngle:i},null!==r){for(var a=4,o=Math.pow(10,a),s=Math.cos(ss*i),l=r.getIndex(),c=r.getAttribute("position"),h=l?l.count:c.count,f=[0,0,0],d=["a","b","c"],p=new Array(3),v={},m=[],g=0;g<h;g+=3){l?(f[0]=l.getX(g),f[1]=l.getX(g+1),f[2]=l.getX(g+2)):(f[0]=g,f[1]=g+1,f[2]=g+2);var y=yp.a,b=yp.b,_=yp.c;if(y.fromBufferAttribute(c,f[0]),b.fromBufferAttribute(c,f[1]),_.fromBufferAttribute(c,f[2]),yp.getNormal(gp),p[0]="".concat(Math.round(y.x*o),",").concat(Math.round(y.y*o),",").concat(Math.round(y.z*o)),p[1]="".concat(Math.round(b.x*o),",").concat(Math.round(b.y*o),",").concat(Math.round(b.z*o)),p[2]="".concat(Math.round(_.x*o),",").concat(Math.round(_.y*o),",").concat(Math.round(_.z*o)),p[0]!==p[1]&&p[1]!==p[2]&&p[2]!==p[0])for(var x=0;x<3;x++){var w=(x+1)%3,S=p[x],M=p[w],k=yp[d[x]],T=yp[d[w]],E="".concat(S,"_").concat(M),C="".concat(M,"_").concat(S);C in v&&v[C]?(gp.dot(v[C].normal)<=s&&(m.push(k.x,k.y,k.z),m.push(T.x,T.y,T.z)),v[C]=null):E in v||(v[E]={index0:f[x],index1:f[w],normal:gp.clone()})}}for(var A in v)if(v[A]){var R=v[A],P=R.index0,L=R.index1;vp.fromBufferAttribute(c,P),mp.fromBufferAttribute(c,L),m.push(vp.x,vp.y,vp.z),m.push(mp.x,mp.y,mp.z)}e.setAttribute("position",new vl(m,3))}return e}return(0,l.Z)(n)}(Ml),_p=function(){function e(){(0,u.Z)(this,e),this.type="Curve",this.arcLengthDivisions=200}return(0,l.Z)(e,[{key:"getPoint",value:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}},{key:"getPointAt",value:function(e,t){var n=this.getUtoTmapping(e);return this.getPoint(n,t)}},{key:"getPoints",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}},{key:"getSpacedPoints",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}},{key:"getLength",value:function(){var e=this.getLengths();return e[e.length-1]}},{key:"getLengths",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.arcLengthDivisions;if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n=[],r=this.getPoint(0),i=0;n.push(0);for(var a=1;a<=e;a++)i+=(t=this.getPoint(a/e)).distanceTo(r),n.push(i),r=t;return this.cacheArcLengths=n,n}},{key:"updateArcLengths",value:function(){this.needsUpdate=!0,this.getLengths()}},{key:"getUtoTmapping",value:function(e,t){var n,r=this.getLengths(),i=0,a=r.length;n=t||e*r[a-1];for(var o,s=0,u=a-1;s<=u;)if((o=r[i=Math.floor(s+(u-s)/2)]-n)<0)s=i+1;else{if(!(o>0)){u=i;break}u=i-1}if(r[i=u]===n)return i/(a-1);var l=r[i];return(i+(n-l)/(r[i+1]-l))/(a-1)}},{key:"getTangent",value:function(e,t){var n=1e-4,r=e-n,i=e+n;r<0&&(r=0),i>1&&(i=1);var a=this.getPoint(r),o=this.getPoint(i),s=t||(a.isVector2?new gs:new Ns);return s.copy(o).sub(a).normalize(),s}},{key:"getTangentAt",value:function(e,t){var n=this.getUtoTmapping(e);return this.getTangent(n,t)}},{key:"computeFrenetFrames",value:function(e,t){for(var n=new Ns,r=[],i=[],a=[],o=new Ns,s=new hu,u=0;u<=e;u++){var l=u/e;r[u]=this.getTangentAt(l,new Ns)}i[0]=new Ns,a[0]=new Ns;var c=Number.MAX_VALUE,h=Math.abs(r[0].x),f=Math.abs(r[0].y),d=Math.abs(r[0].z);h<=c&&(c=h,n.set(1,0,0)),f<=c&&(c=f,n.set(0,1,0)),d<=c&&n.set(0,0,1),o.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],o),a[0].crossVectors(r[0],i[0]);for(var p=1;p<=e;p++){if(i[p]=i[p-1].clone(),a[p]=a[p-1].clone(),o.crossVectors(r[p-1],r[p]),o.length()>Number.EPSILON){o.normalize();var v=Math.acos(cs(r[p-1].dot(r[p]),-1,1));i[p].applyMatrix4(s.makeRotationAxis(o,v))}a[p].crossVectors(r[p],i[p])}if(!0===t){var m=Math.acos(cs(i[0].dot(i[e]),-1,1));m/=e,r[0].dot(o.crossVectors(i[0],i[e]))>0&&(m=-m);for(var g=1;g<=e;g++)i[g].applyMatrix4(s.makeRotationAxis(r[g],m*g)),a[g].crossVectors(r[g],i[g])}return{tangents:r,normals:i,binormals:a}}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},{key:"toJSON",value:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}},{key:"fromJSON",value:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}]),e}(),xp=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6],h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return(0,u.Z)(this,n),(e=t.call(this)).type="EllipseCurve",e.aX=r,e.aY=i,e.xRadius=a,e.yRadius=o,e.aStartAngle=s,e.aEndAngle=l,e.aClockwise=c,e.aRotation=h,e}return(0,l.Z)(n,[{key:"getPoint",value:function(e,t){for(var n=t||new gs,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,a=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=a?0:r),!0!==this.aClockwise||a||(i===r?i=-r:i-=r);var o=this.aStartAngle+e*i,s=this.aX+this.xRadius*Math.cos(o),u=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var l=Math.cos(this.aRotation),c=Math.sin(this.aRotation),h=s-this.aX,f=u-this.aY;s=h*l-f*c+this.aX,u=h*c+f*l+this.aY}return n.set(s,u)}},{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},{key:"toJSON",value:function(){var e=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}},{key:"fromJSON",value:function(e){return wr((0,_r.Z)(n.prototype),"fromJSON",this).call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}]),n}(_p);xp.prototype.isEllipseCurve=!0;var wp=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i,a,o,s){var l;return(0,u.Z)(this,n),(l=t.call(this,e,r,i,i,a,o,s)).type="ArcCurve",l}return(0,l.Z)(n)}(xp);function Sp(){var e=0,t=0,n=0,r=0;function i(i,a,o,s){e=i,t=o,n=-3*i+3*a-2*o-s,r=2*i-2*a+o+s}return{initCatmullRom:function(e,t,n,r,a){i(t,n,a*(n-e),a*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,a,o,s){var u=(t-e)/a-(n-e)/(a+o)+(n-t)/o,l=(n-t)/o-(r-t)/(o+s)+(r-n)/s;i(t,n,u*=o,l*=o)},calc:function(i){var a=i*i;return e+t*i+n*a+r*(a*i)}}}wp.prototype.isArcCurve=!0;var Mp=new Ns,kp=new Sp,Tp=new Sp,Ep=new Sp,Cp=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"centripetal",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;return(0,u.Z)(this,n),(e=t.call(this)).type="CatmullRomCurve3",e.points=r,e.closed=i,e.curveType=a,e.tension=o,e}return(0,l.Z)(n,[{key:"getPoint",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ns,i=r,a=this.points,o=a.length,s=(o-(this.closed?0:1))*e,u=Math.floor(s),l=s-u;this.closed?u+=u>0?0:(Math.floor(Math.abs(u)/o)+1)*o:0===l&&u===o-1&&(u=o-2,l=1),this.closed||u>0?t=a[(u-1)%o]:(Mp.subVectors(a[0],a[1]).add(a[0]),t=Mp);var c=a[u%o],h=a[(u+1)%o];if(this.closed||u+2<o?n=a[(u+2)%o]:(Mp.subVectors(a[o-1],a[o-2]).add(a[o-1]),n=Mp),"centripetal"===this.curveType||"chordal"===this.curveType){var f="chordal"===this.curveType?.5:.25,d=Math.pow(t.distanceToSquared(c),f),p=Math.pow(c.distanceToSquared(h),f),v=Math.pow(h.distanceToSquared(n),f);p<1e-4&&(p=1),d<1e-4&&(d=p),v<1e-4&&(v=p),kp.initNonuniformCatmullRom(t.x,c.x,h.x,n.x,d,p,v),Tp.initNonuniformCatmullRom(t.y,c.y,h.y,n.y,d,p,v),Ep.initNonuniformCatmullRom(t.z,c.z,h.z,n.z,d,p,v)}else"catmullrom"===this.curveType&&(kp.initCatmullRom(t.x,c.x,h.x,n.x,this.tension),Tp.initCatmullRom(t.y,c.y,h.y,n.y,this.tension),Ep.initCatmullRom(t.z,c.z,h.z,n.z,this.tension));return i.set(kp.calc(l),Tp.calc(l),Ep.calc(l)),i}},{key:"copy",value:function(e){wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}},{key:"toJSON",value:function(){var e=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}},{key:"fromJSON",value:function(e){wr((0,_r.Z)(n.prototype),"fromJSON",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push((new Ns).fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}]),n}(_p);function Ap(e,t,n,r,i){var a=.5*(r-t),o=.5*(i-n),s=e*e;return(2*n-2*r+a+o)*(e*s)+(-3*n+3*r-2*a-o)*s+a*e+n}function Rp(e,t,n,r){return function(e,t){var n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}function Pp(e,t,n,r,i){return function(e,t){var n=1-e;return n*n*n*t}(e,t)+function(e,t){var n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,r)+function(e,t){return e*e*e*t}(e,i)}Cp.prototype.isCatmullRomCurve3=!0;var Lp=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new gs,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new gs,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new gs,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new gs;return(0,u.Z)(this,n),(e=t.call(this)).type="CubicBezierCurve",e.v0=r,e.v1=i,e.v2=a,e.v3=o,e}return(0,l.Z)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new gs,n=t,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(Pp(e,r.x,i.x,a.x,o.x),Pp(e,r.y,i.y,a.y,o.y)),n}},{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}},{key:"toJSON",value:function(){var e=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}},{key:"fromJSON",value:function(e){return wr((0,_r.Z)(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}]),n}(_p);Lp.prototype.isCubicBezierCurve=!0;var Dp=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ns,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ns,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Ns,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Ns;return(0,u.Z)(this,n),(e=t.call(this)).type="CubicBezierCurve3",e.v0=r,e.v1=i,e.v2=a,e.v3=o,e}return(0,l.Z)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ns,n=t,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(Pp(e,r.x,i.x,a.x,o.x),Pp(e,r.y,i.y,a.y,o.y),Pp(e,r.z,i.z,a.z,o.z)),n}},{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}},{key:"toJSON",value:function(){var e=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}},{key:"fromJSON",value:function(e){return wr((0,_r.Z)(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}]),n}(_p);Dp.prototype.isCubicBezierCurve3=!0;var Np=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new gs,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new gs;return(0,u.Z)(this,n),(e=t.call(this)).type="LineCurve",e.v1=r,e.v2=i,e}return(0,l.Z)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new gs,n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}},{key:"getPointAt",value:function(e,t){return this.getPoint(e,t)}},{key:"getTangent",value:function(e,t){var n=t||new gs;return n.copy(this.v2).sub(this.v1).normalize(),n}},{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return wr((0,_r.Z)(n.prototype),"fromJSON",this).call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(_p);Np.prototype.isLineCurve=!0;var Ip=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ns,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ns;return(0,u.Z)(this,n),(e=t.call(this)).type="LineCurve3",e.isLineCurve3=!0,e.v1=r,e.v2=i,e}return(0,l.Z)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ns,n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}},{key:"getPointAt",value:function(e,t){return this.getPoint(e,t)}},{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return wr((0,_r.Z)(n.prototype),"fromJSON",this).call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(_p),Op=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new gs,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new gs,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new gs;return(0,u.Z)(this,n),(e=t.call(this)).type="QuadraticBezierCurve",e.v0=r,e.v1=i,e.v2=a,e}return(0,l.Z)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new gs,n=t,r=this.v0,i=this.v1,a=this.v2;return n.set(Rp(e,r.x,i.x,a.x),Rp(e,r.y,i.y,a.y)),n}},{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return wr((0,_r.Z)(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(_p);Op.prototype.isQuadraticBezierCurve=!0;var Up=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ns,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ns,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Ns;return(0,u.Z)(this,n),(e=t.call(this)).type="QuadraticBezierCurve3",e.v0=r,e.v1=i,e.v2=a,e}return(0,l.Z)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ns,n=t,r=this.v0,i=this.v1,a=this.v2;return n.set(Rp(e,r.x,i.x,a.x),Rp(e,r.y,i.y,a.y),Rp(e,r.z,i.z,a.z)),n}},{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return wr((0,_r.Z)(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(_p);Up.prototype.isQuadraticBezierCurve3=!0;var Fp=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,u.Z)(this,n),(e=t.call(this)).type="SplineCurve",e.points=r,e}return(0,l.Z)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new gs,n=t,r=this.points,i=(r.length-1)*e,a=Math.floor(i),o=i-a,s=r[0===a?a:a-1],u=r[a],l=r[a>r.length-2?r.length-1:a+1],c=r[a>r.length-3?r.length-1:a+2];return n.set(Ap(o,s.x,u.x,l.x,c.x),Ap(o,s.y,u.y,l.y,c.y)),n}},{key:"copy",value:function(e){wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push(i.clone())}return this}},{key:"toJSON",value:function(){var e=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var i=this.points[t];e.points.push(i.toArray())}return e}},{key:"fromJSON",value:function(e){wr((0,_r.Z)(n.prototype),"fromJSON",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push((new gs).fromArray(i))}return this}}]),n}(_p);Fp.prototype.isSplineCurve=!0;var zp=Object.freeze({__proto__:null,ArcCurve:wp,CatmullRomCurve3:Cp,CubicBezierCurve:Lp,CubicBezierCurve3:Dp,EllipseCurve:xp,LineCurve:Np,LineCurve3:Ip,QuadraticBezierCurve:Op,QuadraticBezierCurve3:Up,SplineCurve:Fp}),Bp=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.call(this)).type="CurvePath",e.curves=[],e.autoClose=!1,e}return(0,l.Z)(n,[{key:"add",value:function(e){this.curves.push(e)}},{key:"closePath",value:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Np(t,e))}},{key:"getPoint",value:function(e,t){for(var n=e*this.getLength(),r=this.getCurveLengths(),i=0;i<r.length;){if(r[i]>=n){var a=r[i]-n,o=this.curves[i],s=o.getLength(),u=0===s?0:1-a/s;return o.getPointAt(u,t)}i++}return null}},{key:"getLength",value:function(){var e=this.getCurveLengths();return e[e.length-1]}},{key:"updateArcLengths",value:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}},{key:"getCurveLengths",value:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}},{key:"getSpacedPoints",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40,t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}},{key:"getPoints",value:function(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,n=[],r=0,i=this.curves;r<i.length;r++)for(var a=i[r],o=a&&a.isEllipseCurve?2*t:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?t*a.points.length:t,s=a.getPoints(o),u=0;u<s.length;u++){var l=s[u];e&&e.equals(l)||(n.push(l),e=l)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}},{key:"copy",value:function(e){wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}},{key:"toJSON",value:function(){var e=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,r=this.curves.length;t<r;t++){var i=this.curves[t];e.curves.push(i.toJSON())}return e}},{key:"fromJSON",value:function(e){wr((0,_r.Z)(n.prototype),"fromJSON",this).call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var i=e.curves[t];this.curves.push((new zp[i.type]).fromJSON(i))}return this}}]),n}(_p),Vp=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).type="Path",r.currentPoint=new gs,e&&r.setFromPoints(e),r}return(0,l.Z)(n,[{key:"setFromPoints",value:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}},{key:"moveTo",value:function(e,t){return this.currentPoint.set(e,t),this}},{key:"lineTo",value:function(e,t){var n=new Np(this.currentPoint.clone(),new gs(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}},{key:"quadraticCurveTo",value:function(e,t,n,r){var i=new Op(this.currentPoint.clone(),new gs(e,t),new gs(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this}},{key:"bezierCurveTo",value:function(e,t,n,r,i,a){var o=new Lp(this.currentPoint.clone(),new gs(e,t),new gs(n,r),new gs(i,a));return this.curves.push(o),this.currentPoint.set(i,a),this}},{key:"splineThru",value:function(e){var t=[this.currentPoint.clone()].concat(e),n=new Fp(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}},{key:"arc",value:function(e,t,n,r,i,a){var o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+o,t+s,n,r,i,a),this}},{key:"absarc",value:function(e,t,n,r,i,a){return this.absellipse(e,t,n,n,r,i,a),this}},{key:"ellipse",value:function(e,t,n,r,i,a,o,s){var u=this.currentPoint.x,l=this.currentPoint.y;return this.absellipse(e+u,t+l,n,r,i,a,o,s),this}},{key:"absellipse",value:function(e,t,n,r,i,a,o,s){var u=new xp(e,t,n,r,i,a,o,s);if(this.curves.length>0){var l=u.getPoint(0);l.equals(this.currentPoint)||this.lineTo(l.x,l.y)}this.curves.push(u);var c=u.getPoint(1);return this.currentPoint.copy(c),this}},{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.currentPoint.copy(e.currentPoint),this}},{key:"toJSON",value:function(){var e=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this);return e.currentPoint=this.currentPoint.toArray(),e}},{key:"fromJSON",value:function(e){return wr((0,_r.Z)(n.prototype),"fromJSON",this).call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}]),n}(Bp),Gp=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).uuid=ls(),r.type="Shape",r.holes=[],r}return(0,l.Z)(n,[{key:"getPointsHoles",value:function(e){for(var t=[],n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}},{key:"extractPoints",value:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}},{key:"copy",value:function(e){wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var i=e.holes[t];this.holes.push(i.clone())}return this}},{key:"toJSON",value:function(){var e=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,r=this.holes.length;t<r;t++){var i=this.holes[t];e.holes.push(i.toJSON())}return e}},{key:"fromJSON",value:function(e){wr((0,_r.Z)(n.prototype),"fromJSON",this).call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var i=e.holes[t];this.holes.push((new Vp).fromJSON(i))}return this}}]),n}(Vp),jp=function(e,t){var n,r,i,a,o,s,u,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,c=t&&t.length,h=c?t[0]*l:e.length,f=Hp(e,0,h,l,!0),d=[];if(!f||f.next===f.prev)return d;if(c&&(f=Jp(e,t,f,l)),e.length>80*l){n=i=e[0],r=a=e[1];for(var p=l;p<h;p+=l)(o=e[p])<n&&(n=o),(s=e[p+1])<r&&(r=s),o>i&&(i=o),s>a&&(a=s);u=0!==(u=Math.max(i-n,a-r))?1/u:0}return Zp(f,d,l,n,r,u),d};function Hp(e,t,n,r,i){var a,o;if(i===function(e,t,n,r){for(var i=0,a=t,o=n-r;a<n;a+=r)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}(e,t,n,r)>0)for(a=t;a<n;a+=r)o=fv(a,e[a],e[a+1],o);else for(a=n-r;a>=t;a-=r)o=fv(a,e[a],e[a+1],o);return o&&ov(o,o.next)&&(dv(o),o=o.next),o}function Wp(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!ov(r,r.next)&&0!==av(r.prev,r,r.next))r=r.next;else{if(dv(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function Zp(e,t,n,r,i,a,o){if(e){!o&&a&&function(e,t,n,r){var i=e;do{null===i.z&&(i.z=tv(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,a,o,s,u,l=1;do{for(n=e,e=null,a=null,o=0;n;){for(o++,r=n,s=0,t=0;t<l&&(s++,r=r.nextZ);t++);for(u=l;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;n=r}a.nextZ=null,l*=2}while(o>1)}(i)}(e,r,i,a);for(var s,u,l=e;e.prev!==e.next;)if(s=e.prev,u=e.next,a?Xp(e,r,i,a):qp(e))t.push(s.i/n),t.push(e.i/n),t.push(u.i/n),dv(e),e=u.next,l=u.next;else if((e=u)===l){o?1===o?Zp(e=Yp(Wp(e),t,n),t,n,r,i,a,2):2===o&&Kp(e,t,n,r,i,a):Zp(Wp(e),t,n,r,i,a,1);break}}}function qp(e){var t=e.prev,n=e,r=e.next;if(av(t,n,r)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(rv(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&av(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function Xp(e,t,n,r){var i=e.prev,a=e,o=e.next;if(av(i,a,o)>=0)return!1;for(var s=i.x<a.x?i.x<o.x?i.x:o.x:a.x<o.x?a.x:o.x,u=i.y<a.y?i.y<o.y?i.y:o.y:a.y<o.y?a.y:o.y,l=i.x>a.x?i.x>o.x?i.x:o.x:a.x>o.x?a.x:o.x,c=i.y>a.y?i.y>o.y?i.y:o.y:a.y>o.y?a.y:o.y,h=tv(s,u,t,n,r),f=tv(l,c,t,n,r),d=e.prevZ,p=e.nextZ;d&&d.z>=h&&p&&p.z<=f;){if(d!==e.prev&&d!==e.next&&rv(i.x,i.y,a.x,a.y,o.x,o.y,d.x,d.y)&&av(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,p!==e.prev&&p!==e.next&&rv(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&av(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;d&&d.z>=h;){if(d!==e.prev&&d!==e.next&&rv(i.x,i.y,a.x,a.y,o.x,o.y,d.x,d.y)&&av(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;p&&p.z<=f;){if(p!==e.prev&&p!==e.next&&rv(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&av(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function Yp(e,t,n){var r=e;do{var i=r.prev,a=r.next.next;!ov(i,a)&&sv(i,r,r.next,a)&&cv(i,a)&&cv(a,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(a.i/n),dv(r),dv(r.next),r=e=a),r=r.next}while(r!==e);return Wp(r)}function Kp(e,t,n,r,i,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&iv(o,s)){var u=hv(o,s);return o=Wp(o,o.next),u=Wp(u,u.next),Zp(o,t,n,r,i,a),void Zp(u,t,n,r,i,a)}s=s.next}o=o.next}while(o!==e)}function Jp(e,t,n,r){var i,a,o,s=[];for(i=0,a=t.length;i<a;i++)(o=Hp(e,t[i]*r,i<a-1?t[i+1]*r:e.length,r,!1))===o.next&&(o.steiner=!0),s.push(nv(o));for(s.sort(Qp),i=0;i<s.length;i++)$p(s[i],n),n=Wp(n,n.next);return n}function Qp(e,t){return e.x-t.x}function $p(e,t){if(t=function(e,t){var n,r=t,i=e.x,a=e.y,o=-1/0;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){var s=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>o){if(o=s,s===i){if(a===r.y)return r;if(a===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(i===o)return n;var u,l=n,c=n.x,h=n.y,f=1/0;r=n;do{i>=r.x&&r.x>=c&&i!==r.x&&rv(a<h?i:o,a,c,h,a<h?o:i,a,r.x,r.y)&&(u=Math.abs(a-r.y)/(i-r.x),cv(r,e)&&(u<f||u===f&&(r.x>n.x||r.x===n.x&&ev(n,r)))&&(n=r,f=u)),r=r.next}while(r!==l);return n}(e,t),t){var n=hv(t,e);Wp(t,t.next),Wp(n,n.next)}}function ev(e,t){return av(e.prev,e,t.prev)<0&&av(t.next,e,e.next)<0}function tv(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function nv(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function rv(e,t,n,r,i,a,o,s){return(i-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(r-s)-(n-o)*(t-s)>=0&&(n-o)*(a-s)-(i-o)*(r-s)>=0}function iv(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&sv(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(cv(e,t)&&cv(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{n.y>a!==n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(av(e.prev,e,t.prev)||av(e,t.prev,t))||ov(e,t)&&av(e.prev,e,e.next)>0&&av(t.prev,t,t.next)>0)}function av(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function ov(e,t){return e.x===t.x&&e.y===t.y}function sv(e,t,n,r){var i=lv(av(e,t,n)),a=lv(av(e,t,r)),o=lv(av(n,r,e)),s=lv(av(n,r,t));return i!==a&&o!==s||(!(0!==i||!uv(e,n,t))||(!(0!==a||!uv(e,r,t))||(!(0!==o||!uv(n,e,r))||!(0!==s||!uv(n,t,r)))))}function uv(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function lv(e){return e>0?1:e<0?-1:0}function cv(e,t){return av(e.prev,e,e.next)<0?av(e,t,e.next)>=0&&av(e,e.prev,t)>=0:av(e,t,e.prev)<0||av(e,e.next,t)<0}function hv(e,t){var n=new pv(e.i,e.x,e.y),r=new pv(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function fv(e,t,n,r){var i=new pv(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function dv(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function pv(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var vv=function(){function e(){(0,u.Z)(this,e)}return(0,l.Z)(e,null,[{key:"area",value:function(e){for(var t=e.length,n=0,r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n}},{key:"isClockWise",value:function(t){return e.area(t)<0}},{key:"triangulateShape",value:function(e,t){var n=[],r=[],i=[];mv(e),gv(n,e);var a=e.length;t.forEach(mv);for(var o=0;o<t.length;o++)r.push(a),a+=t[o].length,gv(n,t[o]);for(var s=jp(n,r),u=0;u<s.length;u+=3)i.push(s.slice(u,u+3));return i}}]),e}();function mv(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function gv(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}var yv=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Gp([new gs(.5,.5),new gs(-.5,.5),new gs(-.5,-.5),new gs(.5,-.5)]),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,u.Z)(this,n),(e=t.call(this)).type="ExtrudeGeometry",e.parameters={shapes:r,options:i},r=Array.isArray(r)?r:[r];for(var a=(0,c.Z)(e),o=[],s=[],l=0,h=r.length;l<h;l++){var f=r[l];d(f)}function d(e){var t=[],n=void 0!==i.curveSegments?i.curveSegments:12,r=void 0!==i.steps?i.steps:1,u=void 0!==i.depth?i.depth:1,l=void 0===i.bevelEnabled||i.bevelEnabled,c=void 0!==i.bevelThickness?i.bevelThickness:.2,h=void 0!==i.bevelSize?i.bevelSize:c-.1,f=void 0!==i.bevelOffset?i.bevelOffset:0,d=void 0!==i.bevelSegments?i.bevelSegments:3,p=i.extrudePath,v=void 0!==i.UVGenerator?i.UVGenerator:bv;void 0!==i.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),u=i.amount);var m,g,y,b,_,x=!1;p&&(m=p.getSpacedPoints(r),x=!0,l=!1,g=p.computeFrenetFrames(r,!1),y=new Ns,b=new Ns,_=new Ns),l||(d=0,c=0,h=0,f=0);var w=e.extractPoints(n),S=w.shape,M=w.holes;if(!vv.isClockWise(S)){S=S.reverse();for(var k=0,T=M.length;k<T;k++){var E=M[k];vv.isClockWise(E)&&(M[k]=E.reverse())}}for(var C=vv.triangulateShape(S,M),A=S,R=0,P=M.length;R<P;R++){var L=M[R];S=S.concat(L)}function D(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}var N=S.length,I=C.length;function O(e,t,n){var r,i,a,o=e.x-t.x,s=e.y-t.y,u=n.x-e.x,l=n.y-e.y,c=o*o+s*s,h=o*l-s*u;if(Math.abs(h)>Number.EPSILON){var f=Math.sqrt(c),d=Math.sqrt(u*u+l*l),p=t.x-s/f,v=t.y+o/f,m=((n.x-l/d-p)*l-(n.y+u/d-v)*u)/(o*l-s*u),g=(r=p+o*m-e.x)*r+(i=v+s*m-e.y)*i;if(g<=2)return new gs(r,i);a=Math.sqrt(g/2)}else{var y=!1;o>Number.EPSILON?u>Number.EPSILON&&(y=!0):o<-Number.EPSILON?u<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(l)&&(y=!0),y?(r=-s,i=o,a=Math.sqrt(c)):(r=o,i=s,a=Math.sqrt(c/2))}return new gs(r/a,i/a)}for(var U=[],F=0,z=A.length,B=z-1,V=F+1;F<z;F++,B++,V++)B===z&&(B=0),V===z&&(V=0),U[F]=O(A[F],A[B],A[V]);for(var G,j=[],H=U.concat(),W=0,Z=M.length;W<Z;W++){var q=M[W];G=[];for(var X=0,Y=q.length,K=Y-1,J=X+1;X<Y;X++,K++,J++)K===Y&&(K=0),J===Y&&(J=0),G[X]=O(q[X],q[K],q[J]);j.push(G),H=H.concat(G)}for(var Q=0;Q<d;Q++){for(var $=Q/d,ee=c*Math.cos($*Math.PI/2),te=h*Math.sin($*Math.PI/2)+f,ne=0,re=A.length;ne<re;ne++){var ie=D(A[ne],U[ne],te);Pe(ie.x,ie.y,-ee)}for(var ae=0,oe=M.length;ae<oe;ae++){var se=M[ae];G=j[ae];for(var ue=0,le=se.length;ue<le;ue++){var ce=D(se[ue],G[ue],te);Pe(ce.x,ce.y,-ee)}}}for(var he=h+f,fe=0;fe<N;fe++){var de=l?D(S[fe],H[fe],he):S[fe];x?(b.copy(g.normals[0]).multiplyScalar(de.x),y.copy(g.binormals[0]).multiplyScalar(de.y),_.copy(m[0]).add(b).add(y),Pe(_.x,_.y,_.z)):Pe(de.x,de.y,0)}for(var pe=1;pe<=r;pe++)for(var ve=0;ve<N;ve++){var me=l?D(S[ve],H[ve],he):S[ve];x?(b.copy(g.normals[pe]).multiplyScalar(me.x),y.copy(g.binormals[pe]).multiplyScalar(me.y),_.copy(m[pe]).add(b).add(y),Pe(_.x,_.y,_.z)):Pe(me.x,me.y,u/r*pe)}for(var ge=d-1;ge>=0;ge--){for(var ye=ge/d,be=c*Math.cos(ye*Math.PI/2),_e=h*Math.sin(ye*Math.PI/2)+f,xe=0,we=A.length;xe<we;xe++){var Se=D(A[xe],U[xe],_e);Pe(Se.x,Se.y,u+be)}for(var Me=0,ke=M.length;Me<ke;Me++){var Te=M[Me];G=j[Me];for(var Ee=0,Ce=Te.length;Ee<Ce;Ee++){var Ae=D(Te[Ee],G[Ee],_e);x?Pe(Ae.x,Ae.y+m[r-1].y,m[r-1].x+be):Pe(Ae.x,Ae.y,u+be)}}}function Re(e,t){for(var n=e.length;--n>=0;){var i=n,a=n-1;a<0&&(a=e.length-1);for(var o=0,s=r+2*d;o<s;o++){var u=N*o,l=N*(o+1);De(t+i+u,t+a+u,t+a+l,t+i+l)}}}function Pe(e,n,r){t.push(e),t.push(n),t.push(r)}function Le(e,t,n){Ne(e),Ne(t),Ne(n);var r=o.length/3,i=v.generateTopUV(a,o,r-3,r-2,r-1);Ie(i[0]),Ie(i[1]),Ie(i[2])}function De(e,t,n,r){Ne(e),Ne(t),Ne(r),Ne(t),Ne(n),Ne(r);var i=o.length/3,s=v.generateSideWallUV(a,o,i-6,i-3,i-2,i-1);Ie(s[0]),Ie(s[1]),Ie(s[3]),Ie(s[1]),Ie(s[2]),Ie(s[3])}function Ne(e){o.push(t[3*e+0]),o.push(t[3*e+1]),o.push(t[3*e+2])}function Ie(e){s.push(e.x),s.push(e.y)}!function(){var e=o.length/3;if(l){for(var t=0,n=N*t,i=0;i<I;i++){var s=C[i];Le(s[2]+n,s[1]+n,s[0]+n)}n=N*(t=r+2*d);for(var u=0;u<I;u++){var c=C[u];Le(c[0]+n,c[1]+n,c[2]+n)}}else{for(var h=0;h<I;h++){var f=C[h];Le(f[2],f[1],f[0])}for(var p=0;p<I;p++){var v=C[p];Le(v[0]+N*r,v[1]+N*r,v[2]+N*r)}}a.addGroup(e,o.length/3-e,0)}(),function(){var e=o.length/3,t=0;Re(A,t),t+=A.length;for(var n=0,r=M.length;n<r;n++){var i=M[n];Re(i,t),t+=i.length}a.addGroup(e,o.length/3-e,1)}()}return e.setAttribute("position",new vl(o,3)),e.setAttribute("uv",new vl(s,2)),e.computeVertexNormals(),e}return(0,l.Z)(n,[{key:"toJSON",value:function(){var e=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this);return function(e,t,n){if(n.shapes=[],Array.isArray(e))for(var r=0,i=e.length;r<i;r++){var a=e[r];n.shapes.push(a.uuid)}else n.shapes.push(e.uuid);void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON());return n}(this.parameters.shapes,this.parameters.options,e)}}],[{key:"fromJSON",value:function(e,t){for(var r=[],i=0,a=e.shapes.length;i<a;i++){var o=t[e.shapes[i]];r.push(o)}var s=e.options.extrudePath;return void 0!==s&&(e.options.extrudePath=(new zp[s.type]).fromJSON(s)),new n(r,e.options)}}]),n}(Ml),bv={generateTopUV:function(e,t,n,r,i){var a=t[3*n],o=t[3*n+1],s=t[3*r],u=t[3*r+1],l=t[3*i],c=t[3*i+1];return[new gs(a,o),new gs(s,u),new gs(l,c)]},generateSideWallUV:function(e,t,n,r,i,a){var o=t[3*n],s=t[3*n+1],u=t[3*n+2],l=t[3*r],c=t[3*r+1],h=t[3*r+2],f=t[3*i],d=t[3*i+1],p=t[3*i+2],v=t[3*a],m=t[3*a+1],g=t[3*a+2];return Math.abs(s-c)<Math.abs(o-l)?[new gs(o,1-u),new gs(l,1-h),new gs(f,1-p),new gs(v,1-g)]:[new gs(s,1-u),new gs(c,1-h),new gs(d,1-p),new gs(m,1-g)]}};var _v=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,u.Z)(this,n);var a=(1+Math.sqrt(5))/2,o=[-1,a,0,1,a,0,-1,-a,0,1,-a,0,0,-1,a,0,1,a,0,-1,-a,0,1,-a,a,0,-1,a,0,1,-a,0,-1,-a,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];return(e=t.call(this,o,s,r,i)).type="IcosahedronGeometry",e.parameters={radius:r,detail:i},e}return(0,l.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.detail)}}]),n}(dp),xv=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[new gs(0,.5),new gs(.5,0),new gs(0,-.5)],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;(0,u.Z)(this,n),(e=t.call(this)).type="LatheGeometry",e.parameters={points:r,segments:i,phiStart:a,phiLength:o},i=Math.floor(i),o=cs(o,0,2*Math.PI);for(var s=[],l=[],c=[],h=1/i,f=new Ns,d=new gs,p=0;p<=i;p++)for(var v=a+p*h*o,m=Math.sin(v),g=Math.cos(v),y=0;y<=r.length-1;y++)f.x=r[y].x*m,f.y=r[y].y,f.z=r[y].x*g,l.push(f.x,f.y,f.z),d.x=p/i,d.y=y/(r.length-1),c.push(d.x,d.y);for(var b=0;b<i;b++)for(var _=0;_<r.length-1;_++){var x=_+b*r.length,w=x,S=x+r.length,M=x+r.length+1,k=x+1;s.push(w,S,k),s.push(S,M,k)}if(e.setIndex(s),e.setAttribute("position",new vl(l,3)),e.setAttribute("uv",new vl(c,2)),e.computeVertexNormals(),o===2*Math.PI)for(var T=e.attributes.normal.array,E=new Ns,C=new Ns,A=new Ns,R=i*r.length*3,P=0,L=0;P<r.length;P++,L+=3)E.x=T[L+0],E.y=T[L+1],E.z=T[L+2],C.x=T[R+L+0],C.y=T[R+L+1],C.z=T[R+L+2],A.addVectors(E,C).normalize(),T[L+0]=T[R+L+0]=A.x,T[L+1]=T[R+L+1]=A.y,T[L+2]=T[R+L+2]=A.z;return e}return(0,l.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.points,e.segments,e.phiStart,e.phiLength)}}]),n}(Ml),wv=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,u.Z)(this,n);var a=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],o=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];return(e=t.call(this,a,o,r,i)).type="OctahedronGeometry",e.parameters={radius:r,detail:i},e}return(0,l.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.detail)}}]),n}(dp),Sv=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI;(0,u.Z)(this,n),(e=t.call(this)).type="RingGeometry",e.parameters={innerRadius:r,outerRadius:i,thetaSegments:a,phiSegments:o,thetaStart:s,thetaLength:l},a=Math.max(3,a);for(var c=[],h=[],f=[],d=[],p=r,v=(i-r)/(o=Math.max(1,o)),m=new Ns,g=new gs,y=0;y<=o;y++){for(var b=0;b<=a;b++){var _=s+b/a*l;m.x=p*Math.cos(_),m.y=p*Math.sin(_),h.push(m.x,m.y,m.z),f.push(0,0,1),g.x=(m.x/i+1)/2,g.y=(m.y/i+1)/2,d.push(g.x,g.y)}p+=v}for(var x=0;x<o;x++)for(var w=x*(a+1),S=0;S<a;S++){var M=S+w,k=M,T=M+a+1,E=M+a+2,C=M+1;c.push(k,T,C),c.push(T,E,C)}return e.setIndex(c),e.setAttribute("position",new vl(h,3)),e.setAttribute("normal",new vl(f,3)),e.setAttribute("uv",new vl(d,2)),e}return(0,l.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}]),n}(Ml),Mv=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Gp([new gs(0,.5),new gs(-.5,-.5),new gs(.5,-.5)]),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;(0,u.Z)(this,n),(e=t.call(this)).type="ShapeGeometry",e.parameters={shapes:r,curveSegments:i};var a=[],o=[],s=[],l=[],c=0,h=0;if(!1===Array.isArray(r))d(r);else for(var f=0;f<r.length;f++)d(r[f]),e.addGroup(c,h,f),c+=h,h=0;function d(e){var t=o.length/3,n=e.extractPoints(i),r=n.shape,u=n.holes;!1===vv.isClockWise(r)&&(r=r.reverse());for(var c=0,f=u.length;c<f;c++){var d=u[c];!0===vv.isClockWise(d)&&(u[c]=d.reverse())}for(var p=vv.triangulateShape(r,u),v=0,m=u.length;v<m;v++){var g=u[v];r=r.concat(g)}for(var y=0,b=r.length;y<b;y++){var _=r[y];o.push(_.x,_.y,0),s.push(0,0,1),l.push(_.x,_.y)}for(var x=0,w=p.length;x<w;x++){var S=p[x],M=S[0]+t,k=S[1]+t,T=S[2]+t;a.push(M,k,T),h+=3}}return e.setIndex(a),e.setAttribute("position",new vl(o,3)),e.setAttribute("normal",new vl(s,3)),e.setAttribute("uv",new vl(l,2)),e}return(0,l.Z)(n,[{key:"toJSON",value:function(){var e=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this);return function(e,t){if(t.shapes=[],Array.isArray(e))for(var n=0,r=e.length;n<r;n++){var i=e[n];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)}}],[{key:"fromJSON",value:function(e,t){for(var r=[],i=0,a=e.shapes.length;i<a;i++){var o=t[e.shapes[i]];r.push(o)}return new n(r,e.curveSegments)}}]),n}(Ml);var kv=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;(0,u.Z)(this,n),(e=t.call(this)).type="SphereGeometry",e.parameters={radius:r,widthSegments:i,heightSegments:a,phiStart:o,phiLength:s,thetaStart:l,thetaLength:c},i=Math.max(3,Math.floor(i)),a=Math.max(2,Math.floor(a));for(var h=Math.min(l+c,Math.PI),f=0,d=[],p=new Ns,v=new Ns,m=[],g=[],y=[],b=[],_=0;_<=a;_++){var x=[],w=_/a,S=0;0==_&&0==l?S=.5/i:_==a&&h==Math.PI&&(S=-.5/i);for(var M=0;M<=i;M++){var k=M/i;p.x=-r*Math.cos(o+k*s)*Math.sin(l+w*c),p.y=r*Math.cos(l+w*c),p.z=r*Math.sin(o+k*s)*Math.sin(l+w*c),g.push(p.x,p.y,p.z),v.copy(p).normalize(),y.push(v.x,v.y,v.z),b.push(k+S,1-w),x.push(f++)}d.push(x)}for(var T=0;T<a;T++)for(var E=0;E<i;E++){var C=d[T][E+1],A=d[T][E],R=d[T+1][E],P=d[T+1][E+1];(0!==T||l>0)&&m.push(C,A,P),(T!==a-1||h<Math.PI)&&m.push(A,R,P)}return e.setIndex(m),e.setAttribute("position",new vl(g,3)),e.setAttribute("normal",new vl(y,3)),e.setAttribute("uv",new vl(b,2)),e}return(0,l.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}]),n}(Ml),Tv=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,u.Z)(this,n);var a=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],o=[2,1,0,0,3,2,1,3,0,2,3,1];return(e=t.call(this,a,o,r,i)).type="TetrahedronGeometry",e.parameters={radius:r,detail:i},e}return(0,l.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.detail)}}]),n}(dp),Ev=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI;(0,u.Z)(this,n),(e=t.call(this)).type="TorusGeometry",e.parameters={radius:r,tube:i,radialSegments:a,tubularSegments:o,arc:s},a=Math.floor(a),o=Math.floor(o);for(var l=[],c=[],h=[],f=[],d=new Ns,p=new Ns,v=new Ns,m=0;m<=a;m++)for(var g=0;g<=o;g++){var y=g/o*s,b=m/a*Math.PI*2;p.x=(r+i*Math.cos(b))*Math.cos(y),p.y=(r+i*Math.cos(b))*Math.sin(y),p.z=i*Math.sin(b),c.push(p.x,p.y,p.z),d.x=r*Math.cos(y),d.y=r*Math.sin(y),v.subVectors(p,d).normalize(),h.push(v.x,v.y,v.z),f.push(g/o),f.push(m/a)}for(var _=1;_<=a;_++)for(var x=1;x<=o;x++){var w=(o+1)*_+x-1,S=(o+1)*(_-1)+x-1,M=(o+1)*(_-1)+x,k=(o+1)*_+x;l.push(w,S,k),l.push(S,M,k)}return e.setIndex(l),e.setAttribute("position",new vl(c,3)),e.setAttribute("normal",new vl(h,3)),e.setAttribute("uv",new vl(f,2)),e}return(0,l.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}]),n}(Ml),Cv=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:3;(0,u.Z)(this,n),(e=t.call(this)).type="TorusKnotGeometry",e.parameters={radius:r,tube:i,tubularSegments:a,radialSegments:o,p:s,q:l},a=Math.floor(a),o=Math.floor(o);for(var c=[],h=[],f=[],d=[],p=new Ns,v=new Ns,m=new Ns,g=new Ns,y=new Ns,b=new Ns,_=new Ns,x=0;x<=a;++x){var w=x/a*s*Math.PI*2;D(w,s,l,r,m),D(w+.01,s,l,r,g),b.subVectors(g,m),_.addVectors(g,m),y.crossVectors(b,_),_.crossVectors(y,b),y.normalize(),_.normalize();for(var S=0;S<=o;++S){var M=S/o*Math.PI*2,k=-i*Math.cos(M),T=i*Math.sin(M);p.x=m.x+(k*_.x+T*y.x),p.y=m.y+(k*_.y+T*y.y),p.z=m.z+(k*_.z+T*y.z),h.push(p.x,p.y,p.z),v.subVectors(p,m).normalize(),f.push(v.x,v.y,v.z),d.push(x/a),d.push(S/o)}}for(var E=1;E<=a;E++)for(var C=1;C<=o;C++){var A=(o+1)*(E-1)+(C-1),R=(o+1)*E+(C-1),P=(o+1)*E+C,L=(o+1)*(E-1)+C;c.push(A,R,L),c.push(R,P,L)}function D(e,t,n,r,i){var a=Math.cos(e),o=Math.sin(e),s=n/t*e,u=Math.cos(s);i.x=r*(2+u)*.5*a,i.y=r*(2+u)*o*.5,i.z=r*Math.sin(s)*.5}return e.setIndex(c),e.setAttribute("position",new vl(h,3)),e.setAttribute("normal",new vl(f,3)),e.setAttribute("uv",new vl(d,2)),e}return(0,l.Z)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}]),n}(Ml),Av=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Up(new Ns(-1,-1,0),new Ns(-1,1,0),new Ns(1,1,0)),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];(0,u.Z)(this,n),(e=t.call(this)).type="TubeGeometry",e.parameters={path:r,tubularSegments:i,radius:a,radialSegments:o,closed:s};var l=r.computeFrenetFrames(i,s);e.tangents=l.tangents,e.normals=l.normals,e.binormals=l.binormals;var c=new Ns,h=new Ns,f=new gs,d=new Ns,p=[],v=[],m=[],g=[];function y(){for(var e=0;e<i;e++)b(e);b(!1===s?i:0),x(),_()}function b(e){d=r.getPointAt(e/i,d);for(var t=l.normals[e],n=l.binormals[e],s=0;s<=o;s++){var u=s/o*Math.PI*2,f=Math.sin(u),m=-Math.cos(u);h.x=m*t.x+f*n.x,h.y=m*t.y+f*n.y,h.z=m*t.z+f*n.z,h.normalize(),v.push(h.x,h.y,h.z),c.x=d.x+a*h.x,c.y=d.y+a*h.y,c.z=d.z+a*h.z,p.push(c.x,c.y,c.z)}}function _(){for(var e=1;e<=i;e++)for(var t=1;t<=o;t++){var n=(o+1)*(e-1)+(t-1),r=(o+1)*e+(t-1),a=(o+1)*e+t,s=(o+1)*(e-1)+t;g.push(n,r,s),g.push(r,a,s)}}function x(){for(var e=0;e<=i;e++)for(var t=0;t<=o;t++)f.x=e/i,f.y=t/o,m.push(f.x,f.y)}return y(),e.setIndex(g),e.setAttribute("position",new vl(p,3)),e.setAttribute("normal",new vl(v,3)),e.setAttribute("uv",new vl(m,2)),e}return(0,l.Z)(n,[{key:"toJSON",value:function(){var e=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this);return e.path=this.parameters.path.toJSON(),e}}],[{key:"fromJSON",value:function(e){return new n((new zp[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}]),n}(Ml),Rv=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if((0,u.Z)(this,n),(e=t.call(this)).type="WireframeGeometry",e.parameters={geometry:r},null!==r){var i=[],a=new Set,o=new Ns,s=new Ns;if(null!==r.index){var l=r.attributes.position,c=r.index,h=r.groups;0===h.length&&(h=[{start:0,count:c.count,materialIndex:0}]);for(var f=0,d=h.length;f<d;++f)for(var p=h[f],v=p.start,m=p.count,g=v,y=v+m;g<y;g+=3)for(var b=0;b<3;b++){var _=c.getX(g+b),x=c.getX(g+(b+1)%3);o.fromBufferAttribute(l,_),s.fromBufferAttribute(l,x),!0===Pv(o,s,a)&&(i.push(o.x,o.y,o.z),i.push(s.x,s.y,s.z))}}else for(var w=r.attributes.position,S=0,M=w.count/3;S<M;S++)for(var k=0;k<3;k++){var T=3*S+k,E=3*S+(k+1)%3;o.fromBufferAttribute(w,T),s.fromBufferAttribute(w,E),!0===Pv(o,s,a)&&(i.push(o.x,o.y,o.z),i.push(s.x,s.y,s.z))}e.setAttribute("position",new vl(i,3))}return e}return(0,l.Z)(n)}(Ml);function Pv(e,t,n){var r="".concat(e.x,",").concat(e.y,",").concat(e.z,"-").concat(t.x,",").concat(t.y,",").concat(t.z),i="".concat(t.x,",").concat(t.y,",").concat(t.z,"-").concat(e.x,",").concat(e.y,",").concat(e.z);return!0!==n.has(r)&&!0!==n.has(i)&&(n.add(r,i),!0)}var Lv=Object.freeze({__proto__:null,BoxGeometry:Hl,BoxBufferGeometry:Hl,CircleGeometry:cp,CircleBufferGeometry:cp,ConeGeometry:fp,ConeBufferGeometry:fp,CylinderGeometry:hp,CylinderBufferGeometry:hp,DodecahedronGeometry:pp,DodecahedronBufferGeometry:pp,EdgesGeometry:bp,ExtrudeGeometry:yv,ExtrudeBufferGeometry:yv,IcosahedronGeometry:_v,IcosahedronBufferGeometry:_v,LatheGeometry:xv,LatheBufferGeometry:xv,OctahedronGeometry:wv,OctahedronBufferGeometry:wv,PlaneGeometry:cc,PlaneBufferGeometry:cc,PolyhedronGeometry:dp,PolyhedronBufferGeometry:dp,RingGeometry:Sv,RingBufferGeometry:Sv,ShapeGeometry:Mv,ShapeBufferGeometry:Mv,SphereGeometry:kv,SphereBufferGeometry:kv,TetrahedronGeometry:Tv,TetrahedronBufferGeometry:Tv,TorusGeometry:Ev,TorusBufferGeometry:Ev,TorusKnotGeometry:Cv,TorusKnotBufferGeometry:Cv,TubeGeometry:Av,TubeBufferGeometry:Av,WireframeGeometry:Rv}),Dv=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).type="ShadowMaterial",r.color=new nl(0),r.transparent=!0,r.setValues(e),r}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this}}]),n}(Yu);Dv.prototype.isShadowMaterial=!0;var Nv=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).defines={STANDARD:""},r.type="MeshStandardMaterial",r.color=new nl(16777215),r.roughness=1,r.metalness=0,r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new nl(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=Co,r.normalScale=new gs(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.roughnessMap=null,r.metalnessMap=null,r.alphaMap=null,r.envMap=null,r.envMapIntensity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.flatShading=!1,r.setValues(e),r}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}]),n}(Yu);Nv.prototype.isMeshStandardMaterial=!0;var Iv=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).defines={STANDARD:"",PHYSICAL:""},r.type="MeshPhysicalMaterial",r.clearcoatMap=null,r.clearcoatRoughness=0,r.clearcoatRoughnessMap=null,r.clearcoatNormalScale=new gs(1,1),r.clearcoatNormalMap=null,r.ior=1.5,Object.defineProperty((0,c.Z)(r),"reflectivity",{get:function(){return cs(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),r.sheenColor=new nl(0),r.sheenColorMap=null,r.sheenRoughness=1,r.sheenRoughnessMap=null,r.transmissionMap=null,r.thickness=0,r.thicknessMap=null,r.attenuationDistance=0,r.attenuationColor=new nl(1,1,1),r.specularIntensity=1,r.specularIntensityMap=null,r.specularColor=new nl(1,1,1),r.specularColorMap=null,r._sheen=0,r._clearcoat=0,r._transmission=0,r.setValues(e),r}return(0,l.Z)(n,[{key:"sheen",get:function(){return this._sheen},set:function(e){this._sheen>0!==e>0&&this.version++,this._sheen=e}},{key:"clearcoat",get:function(){return this._clearcoat},set:function(e){this._clearcoat>0!==e>0&&this.version++,this._clearcoat=e}},{key:"transmission",get:function(){return this._transmission},set:function(e){this._transmission>0!==e>0&&this.version++,this._transmission=e}},{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}]),n}(Nv);Iv.prototype.isMeshPhysicalMaterial=!0;var Ov=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).type="MeshPhongMaterial",r.color=new nl(16777215),r.specular=new nl(1118481),r.shininess=30,r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new nl(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=Co,r.normalScale=new gs(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=gi,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.flatShading=!1,r.setValues(e),r}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}]),n}(Yu);Ov.prototype.isMeshPhongMaterial=!0;var Uv=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).defines={TOON:""},r.type="MeshToonMaterial",r.color=new nl(16777215),r.map=null,r.gradientMap=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new nl(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=Co,r.normalScale=new gs(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.alphaMap=null,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.setValues(e),r}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}]),n}(Yu);Uv.prototype.isMeshToonMaterial=!0;var Fv=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).type="MeshNormalMaterial",r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=Co,r.normalScale=new gs(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.wireframe=!1,r.wireframeLinewidth=1,r.fog=!1,r.flatShading=!1,r.setValues(e),r}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}]),n}(Yu);Fv.prototype.isMeshNormalMaterial=!0;var zv=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).type="MeshLambertMaterial",r.color=new nl(16777215),r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new nl(0),r.emissiveIntensity=1,r.emissiveMap=null,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=gi,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.setValues(e),r}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}]),n}(Yu);zv.prototype.isMeshLambertMaterial=!0;var Bv=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).defines={MATCAP:""},r.type="MeshMatcapMaterial",r.color=new nl(16777215),r.matcap=null,r.map=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=Co,r.normalScale=new gs(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.alphaMap=null,r.flatShading=!1,r.setValues(e),r}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}}]),n}(Yu);Bv.prototype.isMeshMatcapMaterial=!0;var Vv=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).type="LineDashedMaterial",r.scale=1,r.dashSize=3,r.gapSize=1,r.setValues(e),r}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}]),n}(jd);Vv.prototype.isLineDashedMaterial=!0;var Gv=Object.freeze({__proto__:null,ShadowMaterial:Dv,SpriteMaterial:ud,RawShaderMaterial:xc,ShaderMaterial:Xl,PointsMaterial:ep,MeshPhysicalMaterial:Iv,MeshStandardMaterial:Nv,MeshPhongMaterial:Ov,MeshToonMaterial:Uv,MeshNormalMaterial:Fv,MeshLambertMaterial:zv,MeshDepthMaterial:zf,MeshDistanceMaterial:Bf,MeshBasicMaterial:rl,MeshMatcapMaterial:Bv,LineDashedMaterial:Vv,LineBasicMaterial:jd,Material:Yu}),jv={arraySlice:function(e,t,n){return jv.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"===typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,n=new Array(t),r=0;r!==t;++r)n[r]=r;return n.sort((function(t,n){return e[t]-e[n]})),n},sortedArray:function(e,t,n){for(var r=e.length,i=new e.constructor(r),a=0,o=0;o!==r;++a)for(var s=n[a]*t,u=0;u!==t;++u)i[o++]=e[s+u];return i},flattenJSON:function(e,t,n,r){for(var i=1,a=e[0];void 0!==a&&void 0===a[r];)a=e[i++];if(void 0!==a){var o=a[r];if(void 0!==o)if(Array.isArray(o))do{void 0!==(o=a[r])&&(t.push(a.time),n.push.apply(n,o)),a=e[i++]}while(void 0!==a);else if(void 0!==o.toArray)do{void 0!==(o=a[r])&&(t.push(a.time),o.toArray(n,n.length)),a=e[i++]}while(void 0!==a);else do{void 0!==(o=a[r])&&(t.push(a.time),n.push(o)),a=e[i++]}while(void 0!==a)}},subclip:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:30,a=e.clone();a.name=t;for(var o=[],s=0;s<a.tracks.length;++s){for(var u=a.tracks[s],l=u.getValueSize(),c=[],h=[],f=0;f<u.times.length;++f){var d=u.times[f]*i;if(!(d<n||d>=r)){c.push(u.times[f]);for(var p=0;p<l;++p)h.push(u.values[f*l+p])}}0!==c.length&&(u.times=jv.convertArray(c,u.times.constructor),u.values=jv.convertArray(h,u.values.constructor),o.push(u))}a.tracks=o;for(var v=1/0,m=0;m<a.tracks.length;++m)v>a.tracks[m].times[0]&&(v=a.tracks[m].times[0]);for(var g=0;g<a.tracks.length;++g)a.tracks[g].shift(-1*v);return a.resetDuration(),a},makeClipAdditive:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;r<=0&&(r=30);for(var i=n.tracks.length,a=t/r,o=function(){var t=n.tracks[s],r=t.ValueTypeName;if("bool"===r||"string"===r)return 0;var i=e.tracks.find((function(e){return e.name===t.name&&e.ValueTypeName===r}));if(void 0===i)return 0;var o=0,u=t.getValueSize();t.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(o=u/3);var l=0,c=i.getValueSize();i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(l=c/3);var h,f=t.times.length-1;if(a<=t.times[0]){var d=o,p=u-o;h=jv.arraySlice(t.values,d,p)}else if(a>=t.times[f]){var v=f*u+o,m=v+u-o;h=jv.arraySlice(t.values,v,m)}else{var g=t.createInterpolant(),y=o,b=u-o;g.evaluate(a),h=jv.arraySlice(g.resultBuffer,y,b)}"quaternion"===r&&(new Ds).fromArray(h).normalize().conjugate().toArray(h);for(var _=i.times.length,x=0;x<_;++x){var w=x*c+l;if("quaternion"===r)Ds.multiplyQuaternionsFlat(i.values,w,h,0,i.values,w);else for(var S=c-2*l,M=0;M<S;++M)i.values[w+M]-=h[M]}},s=0;s<i;++s)o();return e.blendMode=vo,e}},Hv=function(){function e(t,n,r,i){(0,u.Z)(this,e),this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new n.constructor(r),this.sampleValues=n,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}return(0,l.Z)(e,[{key:"evaluate",value:function(e){var t=this.parameterPositions,n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{var a;n:{r:if(!(e<r)){for(var o=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,i)}if(n===o)break;if(i=r,e<(r=t[++n]))break t}a=t.length;break n}if(e>=i)break e;var s=t[1];e<s&&(n=2,i=s);for(var u=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(n===u)break;if(r=i,e>=(i=t[--n-1]))break t}a=n,n=0}for(;n<a;){var l=n+a>>>1;e<t[l]?a=l:n=l+1}if(r=t[n],void 0===(i=t[n-1]))return this._cachedIndex=0,this.beforeStart_(0,e,r);if(void 0===r)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,i,e)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)}},{key:"getSettings_",value:function(){return this.settings||this.DefaultSettings_}},{key:"copySampleValue_",value:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r,a=0;a!==r;++a)t[a]=n[i+a];return t}},{key:"interpolate_",value:function(){throw new Error("call to abstract method")}},{key:"intervalChanged_",value:function(){}}]),e}();Hv.prototype.beforeStart_=Hv.prototype.copySampleValue_,Hv.prototype.afterEnd_=Hv.prototype.copySampleValue_;var Wv=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i,a){var o;return(0,u.Z)(this,n),(o=t.call(this,e,r,i,a))._weightPrev=-0,o._offsetPrev=-0,o._weightNext=-0,o._offsetNext=-0,o.DefaultSettings_={endingStart:co,endingEnd:co},o}return(0,l.Z)(n,[{key:"intervalChanged_",value:function(e,t,n){var r=this.parameterPositions,i=e-2,a=e+1,o=r[i],s=r[a];if(void 0===o)switch(this.getSettings_().endingStart){case ho:i=e,o=2*t-n;break;case fo:o=t+r[i=r.length-2]-r[i+1];break;default:i=e,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case ho:a=e,s=2*n-t;break;case fo:a=1,s=n+r[1]-r[0];break;default:a=e-1,s=t}var u=.5*(n-t),l=this.valueSize;this._weightPrev=u/(t-o),this._weightNext=u/(s-n),this._offsetPrev=i*l,this._offsetNext=a*l}},{key:"interpolate_",value:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,u=s-o,l=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,f=this._weightNext,d=(n-t)/(r-t),p=d*d,v=p*d,m=-h*v+2*h*p-h*d,g=(1+h)*v+(-1.5-2*h)*p+(-.5+h)*d+1,y=(-1-f)*v+(1.5+f)*p+.5*d,b=f*v-f*p,_=0;_!==o;++_)i[_]=m*a[l+_]+g*a[u+_]+y*a[s+_]+b*a[c+_];return i}}]),n}(Hv),Zv=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i,a){return(0,u.Z)(this,n),t.call(this,e,r,i,a)}return(0,l.Z)(n,[{key:"interpolate_",value:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,u=s-o,l=(n-t)/(r-t),c=1-l,h=0;h!==o;++h)i[h]=a[u+h]*c+a[s+h]*l;return i}}]),n}(Hv),qv=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i,a){return(0,u.Z)(this,n),t.call(this,e,r,i,a)}return(0,l.Z)(n,[{key:"interpolate_",value:function(e){return this.copySampleValue_(e-1)}}]),n}(Hv),Xv=function(){function e(t,n,r,i){if((0,u.Z)(this,e),void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===n||0===n.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=jv.convertArray(n,this.TimeBufferType),this.values=jv.convertArray(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}return(0,l.Z)(e,[{key:"InterpolantFactoryMethodDiscrete",value:function(e){return new qv(this.times,this.values,this.getValueSize(),e)}},{key:"InterpolantFactoryMethodLinear",value:function(e){return new Zv(this.times,this.values,this.getValueSize(),e)}},{key:"InterpolantFactoryMethodSmooth",value:function(e){return new Wv(this.times,this.values,this.getValueSize(),e)}},{key:"setInterpolation",value:function(e){var t;switch(e){case so:t=this.InterpolantFactoryMethodDiscrete;break;case uo:t=this.InterpolantFactoryMethodLinear;break;case lo:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}},{key:"getInterpolation",value:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return so;case this.InterpolantFactoryMethodLinear:return uo;case this.InterpolantFactoryMethodSmooth:return lo}}},{key:"getValueSize",value:function(){return this.values.length/this.times.length}},{key:"shift",value:function(e){if(0!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]+=e;return this}},{key:"scale",value:function(e){if(1!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]*=e;return this}},{key:"trim",value:function(e,t){for(var n=this.times,r=n.length,i=0,a=r-1;i!==r&&n[i]<e;)++i;for(;-1!==a&&n[a]>t;)--a;if(++a,0!==i||a!==r){i>=a&&(i=(a=Math.max(a,1))-1);var o=this.getValueSize();this.times=jv.arraySlice(n,i,a),this.values=jv.arraySlice(this.values,i*o,a*o)}return this}},{key:"validate",value:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var a=null,o=0;o!==i;o++){var s=n[o];if("number"===typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),e=!1;break}if(null!==a&&a>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),e=!1;break}a=s}if(void 0!==r&&jv.isTypedArray(r))for(var u=0,l=r.length;u!==l;++u){var c=r[u];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,u,c),e=!1;break}}return e}},{key:"optimize",value:function(){for(var e=jv.arraySlice(this.times),t=jv.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===lo,i=e.length-1,a=1,o=1;o<i;++o){var s=!1,u=e[o];if(u!==e[o+1]&&(1!==o||u!==e[0]))if(r)s=!0;else for(var l=o*n,c=l-n,h=l+n,f=0;f!==n;++f){var d=t[l+f];if(d!==t[c+f]||d!==t[h+f]){s=!0;break}}if(s){if(o!==a){e[a]=e[o];for(var p=o*n,v=a*n,m=0;m!==n;++m)t[v+m]=t[p+m]}++a}}if(i>0){e[a]=e[i];for(var g=i*n,y=a*n,b=0;b!==n;++b)t[y+b]=t[g+b];++a}return a!==e.length?(this.times=jv.arraySlice(e,0,a),this.values=jv.arraySlice(t,0,a*n)):(this.times=e,this.values=t),this}},{key:"clone",value:function(){var e=jv.arraySlice(this.times,0),t=jv.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}],[{key:"toJSON",value:function(e){var t,n=e.constructor;if(n.toJSON!==this.toJSON)t=n.toJSON(e);else{t={name:e.name,times:jv.convertArray(e.times,Array),values:jv.convertArray(e.values,Array)};var r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t}}]),e}();Xv.prototype.TimeBufferType=Float32Array,Xv.prototype.ValueBufferType=Float32Array,Xv.prototype.DefaultInterpolation=uo;var Yv=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n)}(Xv);Yv.prototype.ValueTypeName="bool",Yv.prototype.ValueBufferType=Array,Yv.prototype.DefaultInterpolation=so,Yv.prototype.InterpolantFactoryMethodLinear=void 0,Yv.prototype.InterpolantFactoryMethodSmooth=void 0;var Kv=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n)}(Xv);Kv.prototype.ValueTypeName="color";var Jv=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n)}(Xv);Jv.prototype.ValueTypeName="number";var Qv=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i,a){return(0,u.Z)(this,n),t.call(this,e,r,i,a)}return(0,l.Z)(n,[{key:"interpolate_",value:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(n-t)/(r-t),u=e*o,l=u+o;u!==l;u+=4)Ds.slerpFlat(i,0,a,u-o,a,u,s);return i}}]),n}(Hv),$v=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n,[{key:"InterpolantFactoryMethodLinear",value:function(e){return new Qv(this.times,this.values,this.getValueSize(),e)}}]),n}(Xv);$v.prototype.ValueTypeName="quaternion",$v.prototype.DefaultInterpolation=uo,$v.prototype.InterpolantFactoryMethodSmooth=void 0;var em=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n)}(Xv);em.prototype.ValueTypeName="string",em.prototype.ValueBufferType=Array,em.prototype.DefaultInterpolation=so,em.prototype.InterpolantFactoryMethodLinear=void 0,em.prototype.InterpolantFactoryMethodSmooth=void 0;var tm=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n)}(Xv);tm.prototype.ValueTypeName="vector";var nm=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:po;(0,u.Z)(this,e),this.name=t,this.tracks=r,this.duration=n,this.blendMode=i,this.uuid=ls(),this.duration<0&&this.resetDuration()}return(0,l.Z)(e,[{key:"resetDuration",value:function(){for(var e=0,t=0,n=this.tracks.length;t!==n;++t){var r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this}},{key:"trim",value:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}},{key:"validate",value:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}},{key:"optimize",value:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}},{key:"clone",value:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}},{key:"toJSON",value:function(){return this.constructor.toJSON(this)}}],[{key:"parse",value:function(e){for(var t=[],n=e.tracks,r=1/(e.fps||1),i=0,a=n.length;i!==a;++i)t.push(rm(n[i]).scale(r));var o=new this(e.name,e.duration,t,e.blendMode);return o.uuid=e.uuid,o}},{key:"toJSON",value:function(e){for(var t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode},i=0,a=n.length;i!==a;++i)t.push(Xv.toJSON(n[i]));return r}},{key:"CreateFromMorphTargetSequence",value:function(e,t,n,r){for(var i=t.length,a=[],o=0;o<i;o++){var s=[],u=[];s.push((o+i-1)%i,o,(o+1)%i),u.push(0,1,0);var l=jv.getKeyframeOrder(s);s=jv.sortedArray(s,1,l),u=jv.sortedArray(u,1,l),r||0!==s[0]||(s.push(i),u.push(u[0])),a.push(new Jv(".morphTargetInfluences["+t[o].name+"]",s,u).scale(1/n))}return new this(e,-1,a)}},{key:"findByName",value:function(e,t){var n=e;if(!Array.isArray(e)){var r=e;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null}},{key:"CreateClipsFromMorphTargetSequences",value:function(e,t,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,a=0,o=e.length;a<o;a++){var s=e[a],u=s.name.match(i);if(u&&u.length>1){var l=u[1],c=r[l];c||(r[l]=c=[]),c.push(s)}}var h=[];for(var f in r)h.push(this.CreateFromMorphTargetSequence(f,r[f],t,n));return h}},{key:"parseAnimation",value:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(e,t,n,r,i){if(0!==n.length){var a=[],o=[];jv.flattenJSON(n,a,o,r),0!==a.length&&i.push(new e(t,a,o))}},r=[],i=e.name||"default",a=e.fps||30,o=e.blendMode,s=e.length||-1,u=e.hierarchy||[],l=0;l<u.length;l++){var c=u[l].keys;if(c&&0!==c.length)if(c[0].morphTargets){var h={},f=void 0;for(f=0;f<c.length;f++)if(c[f].morphTargets)for(var d=0;d<c[f].morphTargets.length;d++)h[c[f].morphTargets[d]]=-1;for(var p in h){for(var v=[],m=[],g=0;g!==c[f].morphTargets.length;++g){var y=c[f];v.push(y.time),m.push(y.morphTarget===p?1:0)}r.push(new Jv(".morphTargetInfluence["+p+"]",v,m))}s=h.length*(a||1)}else{var b=".bones["+t[l].name+"]";n(tm,b+".position",c,"pos",r),n($v,b+".quaternion",c,"rot",r),n(tm,b+".scale",c,"scl",r)}}return 0===r.length?null:new this(i,s,r,o)}}]),e}();function rm(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Jv;case"vector":case"vector2":case"vector3":case"vector4":return tm;case"color":return Kv;case"quaternion":return $v;case"bool":case"boolean":return Yv;case"string":return em}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){var n=[],r=[];jv.flattenJSON(e.keys,n,r,"value"),e.times=n,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}var im={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},am=(0,l.Z)((function e(t,n,r){(0,u.Z)(this,e);var i=this,a=!1,o=0,s=0,l=void 0,c=[];this.onStart=void 0,this.onLoad=t,this.onProgress=n,this.onError=r,this.itemStart=function(e){s++,!1===a&&void 0!==i.onStart&&i.onStart(e,o,s),a=!0},this.itemEnd=function(e){o++,void 0!==i.onProgress&&i.onProgress(e,o,s),o===s&&(a=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)},this.resolveURL=function(e){return l?l(e):e},this.setURLModifier=function(e){return l=e,this},this.addHandler=function(e,t){return c.push(e,t),this},this.removeHandler=function(e){var t=c.indexOf(e);return-1!==t&&c.splice(t,2),this},this.getHandler=function(e){for(var t=0,n=c.length;t<n;t+=2){var r=c[t],i=c[t+1];if(r.global&&(r.lastIndex=0),r.test(e))return i}return null}})),om=new am,sm=function(){function e(t){(0,u.Z)(this,e),this.manager=void 0!==t?t:om,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}return(0,l.Z)(e,[{key:"load",value:function(){}},{key:"loadAsync",value:function(e,t){var n=this;return new Promise((function(r,i){n.load(e,r,t,i)}))}},{key:"parse",value:function(){}},{key:"setCrossOrigin",value:function(e){return this.crossOrigin=e,this}},{key:"setWithCredentials",value:function(e){return this.withCredentials=e,this}},{key:"setPath",value:function(e){return this.path=e,this}},{key:"setResourcePath",value:function(e){return this.resourcePath=e,this}},{key:"setRequestHeader",value:function(e){return this.requestHeader=e,this}}]),e}(),um={},lm=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,l.Z)(n,[{key:"load",value:function(e,t,n,r){var i=this;void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var a=im.get(e);if(void 0!==a)return this.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;if(void 0===um[e]){um[e]=[],um[e].push({onLoad:t,onProgress:n,onError:r});var o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"});fetch(o).then((function(t){if(200===t.status||0===t.status){0===t.status&&console.warn("THREE.FileLoader: HTTP Status 0 received.");var n=um[e],r=t.body.getReader(),i=t.headers.get("Content-Length"),a=i?parseInt(i):0,o=0!==a,s=0;return new ReadableStream({start:function(e){!function t(){r.read().then((function(r){var i=r.done,u=r.value;if(i)e.close();else{s+=u.byteLength;for(var l=new ProgressEvent("progress",{lengthComputable:o,loaded:s,total:a}),c=0,h=n.length;c<h;c++){var f=n[c];f.onProgress&&f.onProgress(l)}e.enqueue(u),t()}}))}()}})}throw Error('fetch for "'.concat(t.url,'" responded with ').concat(t.status,": ").concat(t.statusText))})).then((function(e){var t=new Response(e);switch(i.responseType){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"document":return t.text().then((function(e){return(new DOMParser).parseFromString(e,i.mimeType)}));case"json":return t.json();default:return t.text()}})).then((function(t){im.add(e,t);var n=um[e];delete um[e];for(var r=0,a=n.length;r<a;r++){var o=n[r];o.onLoad&&o.onLoad(t)}i.manager.itemEnd(e)})).catch((function(t){var n=um[e];delete um[e];for(var r=0,a=n.length;r<a;r++){var o=n[r];o.onError&&o.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)})),this.manager.itemStart(e)}else um[e].push({onLoad:t,onProgress:n,onError:r})}},{key:"setResponseType",value:function(e){return this.responseType=e,this}},{key:"setMimeType",value:function(e){return this.mimeType=e,this}}]),n}(sm),cm=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,l.Z)(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new lm(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(_2){r?r(_2):console.error(_2),i.manager.itemError(e)}}),n,r)}},{key:"parse",value:function(e){for(var t=[],n=0;n<e.length;n++){var r=nm.parse(e[n]);t.push(r)}return t}}]),n}(sm),hm=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,l.Z)(n,[{key:"load",value:function(e,t,n,r){var i=this,a=[],o=new up,s=new lm(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(i.withCredentials);var u=0;function l(l){s.load(e[l],(function(e){var n=i.parse(e,!0);a[l]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(u+=1)&&(1===n.mipmapCount&&(o.minFilter=Vi),o.image=a,o.format=n.format,o.needsUpdate=!0,t&&t(o))}),n,r)}if(Array.isArray(e))for(var c=0,h=e.length;c<h;++c)l(c);else s.load(e,(function(e){var n=i.parse(e,!0);if(n.isCubemap){for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){a[s]={mipmaps:[]};for(var u=0;u<n.mipmapCount;u++)a[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+u]),a[s].format=n.format,a[s].width=n.width,a[s].height=n.height}o.image=a}else o.image.width=n.width,o.image.height=n.height,o.mipmaps=n.mipmaps;1===n.mipmapCount&&(o.minFilter=Vi),o.format=n.format,o.needsUpdate=!0,t&&t(o)}),n,r);return o}}]),n}(sm),fm=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,l.Z)(n,[{key:"load",value:function(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=im.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;var o=Ss("img");function s(){l(),im.add(e,this),t&&t(this),i.manager.itemEnd(e)}function u(t){l(),r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}function l(){o.removeEventListener("load",s,!1),o.removeEventListener("error",u,!1)}return o.addEventListener("load",s,!1),o.addEventListener("error",u,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),i.manager.itemStart(e),o.src=e,o}}]),n}(sm),dm=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,l.Z)(n,[{key:"load",value:function(e,t,n,r){var i=new $l,a=new fm(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var o=0;function s(n){a.load(e[n],(function(e){i.images[n]=e,6===++o&&(i.needsUpdate=!0,t&&t(i))}),void 0,r)}for(var u=0;u<e.length;++u)s(u);return i}}]),n}(sm),pm=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,l.Z)(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new Dd,o=new lm(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(i.withCredentials),o.load(e,(function(e){var n=i.parse(e);n&&(void 0!==n.image?a.image=n.image:void 0!==n.data&&(a.image.width=n.width,a.image.height=n.height,a.image.data=n.data),a.wrapS=void 0!==n.wrapS?n.wrapS:Ni,a.wrapT=void 0!==n.wrapT?n.wrapT:Ni,a.magFilter=void 0!==n.magFilter?n.magFilter:Vi,a.minFilter=void 0!==n.minFilter?n.minFilter:Vi,a.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.encoding&&(a.encoding=n.encoding),void 0!==n.flipY&&(a.flipY=n.flipY),void 0!==n.format&&(a.format=n.format),void 0!==n.type&&(a.type=n.type),void 0!==n.mipmaps&&(a.mipmaps=n.mipmaps,a.minFilter=Hi),1===n.mipmapCount&&(a.minFilter=Vi),void 0!==n.generateMipmaps&&(a.generateMipmaps=n.generateMipmaps),a.needsUpdate=!0,t&&t(a,n))}),n,r),a}}]),n}(sm),vm=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,l.Z)(n,[{key:"load",value:function(e,t,n,r){var i=new Es,a=new fm(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,(function(e){i.image=e,i.needsUpdate=!0,void 0!==t&&t(i)}),n,r),i}}]),n}(sm),mm=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,u.Z)(this,n),(r=t.call(this)).type="Light",r.color=new nl(e),r.intensity=i,r}return(0,l.Z)(n,[{key:"dispose",value:function(){}},{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this}},{key:"toJSON",value:function(e){var t=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}]),n}(Ou);mm.prototype.isLight=!0;var gm=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i){var a;return(0,u.Z)(this,n),(a=t.call(this,e,i)).type="HemisphereLight",a.position.copy(Ou.DefaultUp),a.updateMatrix(),a.groundColor=new nl(r),a}return(0,l.Z)(n,[{key:"copy",value:function(e){return mm.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}]),n}(mm);gm.prototype.isHemisphereLight=!0;var ym=new hu,bm=new Ns,_m=new Ns,xm=function(){function e(t){(0,u.Z)(this,e),this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new gs(512,512),this.map=null,this.mapPass=null,this.matrix=new hu,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new sc,this._frameExtents=new gs(1,1),this._viewportCount=1,this._viewports=[new As(0,0,1,1)]}return(0,l.Z)(e,[{key:"getViewportCount",value:function(){return this._viewportCount}},{key:"getFrustum",value:function(){return this._frustum}},{key:"updateMatrices",value:function(e){var t=this.camera,n=this.matrix;bm.setFromMatrixPosition(e.matrixWorld),t.position.copy(bm),_m.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(_m),t.updateMatrixWorld(),ym.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(ym),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)}},{key:"getViewport",value:function(e){return this._viewports[e]}},{key:"getFrameExtents",value:function(){return this._frameExtents}},{key:"dispose",value:function(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}},{key:"copy",value:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"toJSON",value:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}]),e}(),wm=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.call(this,new Kl(50,1,.5,500))).focus=1,e}return(0,l.Z)(n,[{key:"updateMatrices",value:function(e){var t=this.camera,r=2*us*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,a=e.distance||t.far;r===t.fov&&i===t.aspect&&a===t.far||(t.fov=r,t.aspect=i,t.far=a,t.updateProjectionMatrix()),wr((0,_r.Z)(n.prototype),"updateMatrices",this).call(this,e)}},{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.focus=e.focus,this}}]),n}(xm);wm.prototype.isSpotLightShadow=!0;var Sm=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.PI/3,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;return(0,u.Z)(this,n),(i=t.call(this,e,r)).type="SpotLight",i.position.copy(Ou.DefaultUp),i.updateMatrix(),i.target=new Ou,i.distance=a,i.angle=o,i.penumbra=s,i.decay=l,i.shadow=new wm,i}return(0,l.Z)(n,[{key:"power",get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}},{key:"dispose",value:function(){this.shadow.dispose()}},{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}]),n}(mm);Sm.prototype.isSpotLight=!0;var Mm=new hu,km=new Ns,Tm=new Ns,Em=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.call(this,new Kl(90,1,.5,500)))._frameExtents=new gs(4,2),e._viewportCount=6,e._viewports=[new As(2,1,1,1),new As(0,1,1,1),new As(3,1,1,1),new As(1,1,1,1),new As(3,0,1,1),new As(1,0,1,1)],e._cubeDirections=[new Ns(1,0,0),new Ns(-1,0,0),new Ns(0,0,1),new Ns(0,0,-1),new Ns(0,1,0),new Ns(0,-1,0)],e._cubeUps=[new Ns(0,1,0),new Ns(0,1,0),new Ns(0,1,0),new Ns(0,1,0),new Ns(0,0,1),new Ns(0,0,-1)],e}return(0,l.Z)(n,[{key:"updateMatrices",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.camera,r=this.matrix,i=e.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),km.setFromMatrixPosition(e.matrixWorld),n.position.copy(km),Tm.copy(n.position),Tm.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(Tm),n.updateMatrixWorld(),r.makeTranslation(-km.x,-km.y,-km.z),Mm.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Mm)}}]),n}(xm);Em.prototype.isPointLightShadow=!0;var Cm=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return(0,u.Z)(this,n),(i=t.call(this,e,r)).type="PointLight",i.distance=a,i.decay=o,i.shadow=new Em,i}return(0,l.Z)(n,[{key:"power",get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}},{key:"dispose",value:function(){this.shadow.dispose()}},{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}]),n}(mm);Cm.prototype.isPointLight=!0;var Am=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){return(0,u.Z)(this,n),t.call(this,new _c(-5,5,5,-5,.5,500))}return(0,l.Z)(n)}(xm);Am.prototype.isDirectionalLightShadow=!0;var Rm=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r){var i;return(0,u.Z)(this,n),(i=t.call(this,e,r)).type="DirectionalLight",i.position.copy(Ou.DefaultUp),i.updateMatrix(),i.target=new Ou,i.shadow=new Am,i}return(0,l.Z)(n,[{key:"dispose",value:function(){this.shadow.dispose()}},{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}]),n}(mm);Rm.prototype.isDirectionalLight=!0;var Pm=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r){var i;return(0,u.Z)(this,n),(i=t.call(this,e,r)).type="AmbientLight",i}return(0,l.Z)(n)}(mm);Pm.prototype.isAmbientLight=!0;var Lm=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;return(0,u.Z)(this,n),(i=t.call(this,e,r)).type="RectAreaLight",i.width=a,i.height=o,i}return(0,l.Z)(n,[{key:"power",get:function(){return this.intensity*this.width*this.height*Math.PI},set:function(e){this.intensity=e/(this.width*this.height*Math.PI)}},{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.width=e.width,this.height=e.height,this}},{key:"toJSON",value:function(e){var t=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}]),n}(mm);Lm.prototype.isRectAreaLight=!0;var Dm=function(){function e(){(0,u.Z)(this,e),this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new Ns)}return(0,l.Z)(e,[{key:"set",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}},{key:"zero",value:function(){for(var e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}},{key:"getAt",value:function(e,t){var n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*r),t.addScaledVector(a[2],.488603*i),t.addScaledVector(a[3],.488603*n),t.addScaledVector(a[4],n*r*1.092548),t.addScaledVector(a[5],r*i*1.092548),t.addScaledVector(a[6],.315392*(3*i*i-1)),t.addScaledVector(a[7],n*i*1.092548),t.addScaledVector(a[8],.546274*(n*n-r*r)),t}},{key:"getIrradianceAt",value:function(e,t){var n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],1.023328*r),t.addScaledVector(a[2],1.023328*i),t.addScaledVector(a[3],1.023328*n),t.addScaledVector(a[4],.858086*n*r),t.addScaledVector(a[5],.858086*r*i),t.addScaledVector(a[6],.743125*i*i-.247708),t.addScaledVector(a[7],.858086*n*i),t.addScaledVector(a[8],.429043*(n*n-r*r)),t}},{key:"add",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}},{key:"addScaledSH",value:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}},{key:"scale",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}},{key:"lerp",value:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}},{key:"equals",value:function(e){for(var t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}},{key:"copy",value:function(e){return this.set(e.coefficients)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.coefficients,r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this}},{key:"toArray",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.coefficients,r=0;r<9;r++)n[r].toArray(e,t+3*r);return e}}],[{key:"getBasisAt",value:function(e,t){var n=e.x,r=e.y,i=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*i,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*n*i,t[8]=.546274*(n*n-r*r)}}]),e}();Dm.prototype.isSphericalHarmonics3=!0;var Nm=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Dm,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,u.Z)(this,n),(e=t.call(this,void 0,i)).sh=r,e}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.sh.copy(e.sh),this}},{key:"fromJSON",value:function(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}},{key:"toJSON",value:function(e){var t=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this,e);return t.object.sh=this.sh.toArray(),t}}]),n}(mm);Nm.prototype.isLightProbe=!0;var Im=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).textures={},r}return(0,l.Z)(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new lm(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(_2){r?r(_2):console.error(_2),i.manager.itemError(e)}}),n,r)}},{key:"parse",value:function(e){var t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var r=new Gv[e.type];if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&void 0!==r.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.sheen&&(r.sheen=e.sheen),void 0!==e.sheenColor&&(r.sheenColor=(new nl).setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(r.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==r.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==r.specular&&r.specular.setHex(e.specular),void 0!==e.specularIntensity&&(r.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==r.specularColor&&r.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearcoat&&(r.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(r.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.transmission&&(r.transmission=e.transmission),void 0!==e.thickness&&(r.thickness=e.thickness),void 0!==e.attenuationDistance&&(r.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==r.attenuationColor&&r.attenuationColor.setHex(e.attenuationColor),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.shadowSide&&(r.shadowSide=e.shadowSide),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.format&&(r.format=e.format),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(r.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(r.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(r.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(r.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(r.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(r.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(r.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(r.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),1!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.alphaToCoverage&&(r.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(r.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.toneMapped&&(r.toneMapped=e.toneMapped),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.vertexColors&&("number"===typeof e.vertexColors?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),void 0!==e.uniforms)for(var i in e.uniforms){var a=e.uniforms[i];switch(r.uniforms[i]={},a.type){case"t":r.uniforms[i].value=n(a.value);break;case"c":r.uniforms[i].value=(new nl).setHex(a.value);break;case"v2":r.uniforms[i].value=(new gs).fromArray(a.value);break;case"v3":r.uniforms[i].value=(new Ns).fromArray(a.value);break;case"v4":r.uniforms[i].value=(new As).fromArray(a.value);break;case"m3":r.uniforms[i].value=(new ys).fromArray(a.value);break;case"m4":r.uniforms[i].value=(new hu).fromArray(a.value);break;default:r.uniforms[i].value=a.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(var o in e.extensions)r.extensions[o]=e.extensions[o];if(void 0!==e.shading&&(r.flatShading=1===e.shading),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=n(e.map)),void 0!==e.matcap&&(r.matcap=n(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(r.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){var s=e.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new gs).fromArray(s)}return void 0!==e.displacementMap&&(r.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=n(e.specularMap)),void 0!==e.specularIntensityMap&&(r.specularIntensityMap=n(e.specularIntensityMap)),void 0!==e.specularColorMap&&(r.specularColorMap=n(e.specularColorMap)),void 0!==e.envMap&&(r.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(r.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(r.clearcoatNormalScale=(new gs).fromArray(e.clearcoatNormalScale)),void 0!==e.transmissionMap&&(r.transmissionMap=n(e.transmissionMap)),void 0!==e.thicknessMap&&(r.thicknessMap=n(e.thicknessMap)),void 0!==e.sheenColorMap&&(r.sheenColorMap=n(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(r.sheenRoughnessMap=n(e.sheenRoughnessMap)),r}},{key:"setTextures",value:function(e){return this.textures=e,this}}]),n}(sm),Om=function(){function e(){(0,u.Z)(this,e)}return(0,l.Z)(e,null,[{key:"decodeText",value:function(e){if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(_2){return t}}},{key:"extractUrlBase",value:function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}},{key:"resolveURL",value:function(e,t){return"string"!==typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}]),e}(),Um=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.call(this)).type="InstancedBufferGeometry",e.instanceCount=1/0,e}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.instanceCount=e.instanceCount,this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"toJSON",value:function(){var e=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this,this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}]),n}(Ml);Um.prototype.isInstancedBufferGeometry=!0;var Fm,zm=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,l.Z)(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new lm(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(_2){r?r(_2):console.error(_2),i.manager.itemError(e)}}),n,r)}},{key:"parse",value:function(e){var t={},n={};function r(e,r){if(void 0!==t[r])return t[r];var i=e.interleavedBuffers[r],a=function(e,t){if(void 0!==n[t])return n[t];var r=e.arrayBuffers[t],i=new Uint32Array(r).buffer;return n[t]=i,i}(e,i.buffer),o=ws(i.type,a),s=new id(o,i.stride);return s.uuid=i.uuid,t[r]=s,s}var i=e.isInstancedBufferGeometry?new Um:new Ml,a=e.data.index;if(void 0!==a){var o=ws(a.type,a.array);i.setIndex(new ol(o,1))}var s=e.data.attributes;for(var u in s){var l=s[u],c=void 0;if(l.isInterleavedBufferAttribute){var h=r(e.data,l.data);c=new od(h,l.itemSize,l.offset,l.normalized)}else{var f=ws(l.type,l.array);c=new(l.isInstancedBufferAttribute?Ud:ol)(f,l.itemSize,l.normalized)}void 0!==l.name&&(c.name=l.name),void 0!==l.usage&&c.setUsage(l.usage),void 0!==l.updateRange&&(c.updateRange.offset=l.updateRange.offset,c.updateRange.count=l.updateRange.count),i.setAttribute(u,c)}var d=e.data.morphAttributes;if(d)for(var p in d){for(var v=d[p],m=[],g=0,y=v.length;g<y;g++){var b=v[g],_=void 0;if(b.isInterleavedBufferAttribute){var x=r(e.data,b.data);_=new od(x,b.itemSize,b.offset,b.normalized)}else{var w=ws(b.type,b.array);_=new ol(w,b.itemSize,b.normalized)}void 0!==b.name&&(_.name=b.name),m.push(_)}i.morphAttributes[p]=m}e.data.morphTargetsRelative&&(i.morphTargetsRelative=!0);var S=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==S)for(var M=0,k=S.length;M!==k;++M){var T=S[M];i.addGroup(T.start,T.count,T.materialIndex)}var E=e.data.boundingSphere;if(void 0!==E){var C=new Ns;void 0!==E.center&&C.fromArray(E.center),i.boundingSphere=new nu(C,E.radius)}return e.name&&(i.name=e.name),e.userData&&(i.userData=e.userData),i}}]),n}(sm),Bm=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,l.Z)(n,[{key:"load",value:function(e,t,n,r){var i=this,a=""===this.path?Om.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;var o=new lm(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(n){var a=null;try{a=JSON.parse(n)}catch(s){return void 0!==r&&r(s),void console.error("THREE:ObjectLoader: Can't parse "+e+".",s.message)}var o=a.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()?i.parse(a,t):console.error("THREE.ObjectLoader: Can't load "+e)}),n,r)}},{key:"loadAsync",value:function(){var e=pr(fr().mark((function e(t,n){var r,i,a,o,s,u;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this,i=""===this.path?Om.extractUrlBase(t):this.path,this.resourcePath=this.resourcePath||i,(a=new lm(this.manager)).setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),e.next=9,a.loadAsync(t,n);case 9:if(o=e.sent,s=JSON.parse(o),void 0!==(u=s.metadata)&&void 0!==u.type&&"geometry"!==u.type.toLowerCase()){e.next=14;break}throw new Error("THREE.ObjectLoader: Can't load "+t);case 14:return e.next=16,r.parseAsync(s);case 16:return e.abrupt("return",e.sent);case 17:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"parse",value:function(e,t){var n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),a=this.parseImages(e.images,(function(){void 0!==t&&t(u)})),o=this.parseTextures(e.textures,a),s=this.parseMaterials(e.materials,o),u=this.parseObject(e.object,i,s,o,n),l=this.parseSkeletons(e.skeletons,u);if(this.bindSkeletons(u,l),void 0!==t){var c=!1;for(var h in a)if(a[h]instanceof HTMLImageElement){c=!0;break}!1===c&&t(u)}return u}},{key:"parseAsync",value:function(){var e=pr(fr().mark((function e(t){var n,r,i,a,o,s,u,l;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.parseAnimations(t.animations),r=this.parseShapes(t.shapes),i=this.parseGeometries(t.geometries,r),e.next=5,this.parseImagesAsync(t.images);case 5:return a=e.sent,o=this.parseTextures(t.textures,a),s=this.parseMaterials(t.materials,o),u=this.parseObject(t.object,i,s,o,n),l=this.parseSkeletons(t.skeletons,u),this.bindSkeletons(u,l),e.abrupt("return",u);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"parseShapes",value:function(e){var t={};if(void 0!==e)for(var n=0,r=e.length;n<r;n++){var i=(new Gp).fromJSON(e[n]);t[i.uuid]=i}return t}},{key:"parseSkeletons",value:function(e,t){var n={},r={};if(t.traverse((function(e){e.isBone&&(r[e.uuid]=e)})),void 0!==e)for(var i=0,a=e.length;i<a;i++){var o=(new Od).fromJSON(e[i],r);n[o.uuid]=o}return n}},{key:"parseGeometries",value:function(e,t){var n={};if(void 0!==e)for(var r=new zm,i=0,a=e.length;i<a;i++){var o=void 0,s=e[i];switch(s.type){case"BufferGeometry":case"InstancedBufferGeometry":o=r.parse(s);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:s.type in Lv?o=Lv[s.type].fromJSON(s,t):console.warn('THREE.ObjectLoader: Unsupported geometry type "'.concat(s.type,'"'))}o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),!0===o.isBufferGeometry&&void 0!==s.userData&&(o.userData=s.userData),n[s.uuid]=o}return n}},{key:"parseMaterials",value:function(e,t){var n={},r={};if(void 0!==e){var i=new Im;i.setTextures(t);for(var a=0,o=e.length;a<o;a++){var s=e[a];if("MultiMaterial"===s.type){for(var u=[],l=0;l<s.materials.length;l++){var c=s.materials[l];void 0===n[c.uuid]&&(n[c.uuid]=i.parse(c)),u.push(n[c.uuid])}r[s.uuid]=u}else void 0===n[s.uuid]&&(n[s.uuid]=i.parse(s)),r[s.uuid]=n[s.uuid]}}return r}},{key:"parseAnimations",value:function(e){var t={};if(void 0!==e)for(var n=0;n<e.length;n++){var r=e[n],i=nm.parse(r);t[i.uuid]=i}return t}},{key:"parseImages",value:function(e,t){var n,r=this,i={};function a(e){if("string"===typeof e){var t=e;return function(e){return r.manager.itemStart(e),n.load(e,(function(){r.manager.itemEnd(e)}),void 0,(function(){r.manager.itemError(e),r.manager.itemEnd(e)}))}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:r.resourcePath+t)}return e.data?{data:ws(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){var o=new am(t);(n=new fm(o)).setCrossOrigin(this.crossOrigin);for(var s=0,u=e.length;s<u;s++){var l=e[s],c=l.url;if(Array.isArray(c)){i[l.uuid]=[];for(var h=0,f=c.length;h<f;h++){var d=a(c[h]);null!==d&&(d instanceof HTMLImageElement?i[l.uuid].push(d):i[l.uuid].push(new Dd(d.data,d.width,d.height)))}}else{var p=a(l.url);null!==p&&(i[l.uuid]=p)}}}return i}},{key:"parseImagesAsync",value:function(){var e=pr(fr().mark((function e(t){var n,r,i,a,o,s,u,l,c,h,f,d,p,v;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=function(){return o=pr(fr().mark((function e(t){var r,a;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!==typeof t){e.next=8;break}return a=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(r=t)?r:n.resourcePath+r,e.next=5,i.loadAsync(a);case 5:return e.abrupt("return",e.sent);case 8:if(!t.data){e.next=12;break}return e.abrupt("return",{data:ws(t.type,t.data),width:t.width,height:t.height});case 12:return e.abrupt("return",null);case 13:case"end":return e.stop()}}),e)}))),o.apply(this,arguments)},a=function(e){return o.apply(this,arguments)},n=this,r={},!(void 0!==t&&t.length>0)){e.next=32;break}(i=new fm(this.manager)).setCrossOrigin(this.crossOrigin),s=0,u=t.length;case 8:if(!(s<u)){e.next=32;break}if(l=t[s],c=l.url,!Array.isArray(c)){e.next=25;break}r[l.uuid]=[],h=0,f=c.length;case 14:if(!(h<f)){e.next=23;break}return d=c[h],e.next=18,a(d);case 18:null!==(p=e.sent)&&(p instanceof HTMLImageElement?r[l.uuid].push(p):r[l.uuid].push(new Dd(p.data,p.width,p.height)));case 20:h++,e.next=14;break;case 23:e.next=29;break;case 25:return e.next=27,a(l.url);case 27:null!==(v=e.sent)&&(r[l.uuid]=v);case 29:s++,e.next=8;break;case 32:return e.abrupt("return",r);case 33:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"parseTextures",value:function(e,t){function n(e,t){return"number"===typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var r={};if(void 0!==e)for(var i=0,a=e.length;i<a;i++){var o=e[i];void 0===o.image&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),void 0===t[o.image]&&console.warn("THREE.ObjectLoader: Undefined image",o.image);var s=void 0,u=t[o.image];Array.isArray(u)?(s=new $l(u),6===u.length&&(s.needsUpdate=!0)):(s=u&&u.data?new Dd(u.data,u.width,u.height):new Es(u),u&&(s.needsUpdate=!0)),s.uuid=o.uuid,void 0!==o.name&&(s.name=o.name),void 0!==o.mapping&&(s.mapping=n(o.mapping,Vm)),void 0!==o.offset&&s.offset.fromArray(o.offset),void 0!==o.repeat&&s.repeat.fromArray(o.repeat),void 0!==o.center&&s.center.fromArray(o.center),void 0!==o.rotation&&(s.rotation=o.rotation),void 0!==o.wrap&&(s.wrapS=n(o.wrap[0],Gm),s.wrapT=n(o.wrap[1],Gm)),void 0!==o.format&&(s.format=o.format),void 0!==o.type&&(s.type=o.type),void 0!==o.encoding&&(s.encoding=o.encoding),void 0!==o.minFilter&&(s.minFilter=n(o.minFilter,jm)),void 0!==o.magFilter&&(s.magFilter=n(o.magFilter,jm)),void 0!==o.anisotropy&&(s.anisotropy=o.anisotropy),void 0!==o.flipY&&(s.flipY=o.flipY),void 0!==o.premultiplyAlpha&&(s.premultiplyAlpha=o.premultiplyAlpha),void 0!==o.unpackAlignment&&(s.unpackAlignment=o.unpackAlignment),void 0!==o.userData&&(s.userData=o.userData),r[o.uuid]=s}return r}},{key:"parseObject",value:function(e,t,n,r,i){var a,o,s;function u(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function l(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],r=0,i=e.length;r<i;r++){var a=e[r];void 0===n[a]&&console.warn("THREE.ObjectLoader: Undefined material",a),t.push(n[a])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}function c(e){return void 0===r[e]&&console.warn("THREE.ObjectLoader: Undefined texture",e),r[e]}switch(e.type){case"Scene":a=new rd,void 0!==e.background&&(Number.isInteger(e.background)?a.background=new nl(e.background):a.background=c(e.background)),void 0!==e.environment&&(a.environment=c(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?a.fog=new nd(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(a.fog=new td(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":a=new Kl(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(a.focus=e.focus),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.filmGauge&&(a.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(a.filmOffset=e.filmOffset),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new _c(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new Pm(e.color,e.intensity);break;case"DirectionalLight":a=new Rm(e.color,e.intensity);break;case"PointLight":a=new Cm(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new Lm(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new Sm(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":a=new gm(e.color,e.groundColor,e.intensity);break;case"LightProbe":a=(new Nm).fromJSON(e);break;case"SkinnedMesh":o=u(e.geometry),s=l(e.material),a=new Pd(o,s),void 0!==e.bindMode&&(a.bindMode=e.bindMode),void 0!==e.bindMatrix&&a.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(a.skeleton=e.skeleton);break;case"Mesh":o=u(e.geometry),s=l(e.material),a=new Gl(o,s);break;case"InstancedMesh":o=u(e.geometry),s=l(e.material);var h=e.count,f=e.instanceMatrix,d=e.instanceColor;(a=new Gd(o,s,h)).instanceMatrix=new Ud(new Float32Array(f.array),16),void 0!==d&&(a.instanceColor=new Ud(new Float32Array(d.array),d.itemSize));break;case"LOD":a=new kd;break;case"Line":a=new Yd(u(e.geometry),l(e.material));break;case"LineLoop":a=new $d(u(e.geometry),l(e.material));break;case"LineSegments":a=new Qd(u(e.geometry),l(e.material));break;case"PointCloud":case"Points":a=new ap(u(e.geometry),l(e.material));break;case"Sprite":a=new xd(l(e.material));break;case"Group":a=new Zf;break;case"Bone":a=new Ld;break;default:a=new Ou}if(a.uuid=e.uuid,void 0!==e.name&&(a.name=e.name),void 0!==e.matrix?(a.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(void 0!==e.position&&a.position.fromArray(e.position),void 0!==e.rotation&&a.rotation.fromArray(e.rotation),void 0!==e.quaternion&&a.quaternion.fromArray(e.quaternion),void 0!==e.scale&&a.scale.fromArray(e.scale)),void 0!==e.castShadow&&(a.castShadow=e.castShadow),void 0!==e.receiveShadow&&(a.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(a.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(a.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(a.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&a.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(a.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(a.visible=e.visible),void 0!==e.frustumCulled&&(a.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(a.renderOrder=e.renderOrder),void 0!==e.userData&&(a.userData=e.userData),void 0!==e.layers&&(a.layers.mask=e.layers),void 0!==e.children)for(var p=e.children,v=0;v<p.length;v++)a.add(this.parseObject(p[v],t,n,r,i));if(void 0!==e.animations)for(var m=e.animations,g=0;g<m.length;g++){var y=m[g];a.animations.push(i[y])}if("LOD"===e.type){void 0!==e.autoUpdate&&(a.autoUpdate=e.autoUpdate);for(var b=e.levels,_=0;_<b.length;_++){var x=b[_],w=a.getObjectByProperty("uuid",x.object);void 0!==w&&a.addLevel(w,x.distance)}}return a}},{key:"bindSkeletons",value:function(e,t){0!==Object.keys(t).length&&e.traverse((function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){var n=t[e.skeleton];void 0===n?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",e.skeleton):e.bind(n,e.bindMatrix)}}))}},{key:"setTexturePath",value:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}]),n}(sm),Vm={UVMapping:Ti,CubeReflectionMapping:Ei,CubeRefractionMapping:Ci,EquirectangularReflectionMapping:Ai,EquirectangularRefractionMapping:Ri,CubeUVReflectionMapping:Pi,CubeUVRefractionMapping:Li},Gm={RepeatWrapping:Di,ClampToEdgeWrapping:Ni,MirroredRepeatWrapping:Ii},jm={NearestFilter:Oi,NearestMipmapNearestFilter:Ui,NearestMipmapLinearFilter:zi,LinearFilter:Vi,LinearMipmapNearestFilter:Gi,LinearMipmapLinearFilter:Hi},Hm=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),r=t.call(this,e),"undefined"===typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"===typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),r.options={premultiplyAlpha:"none"},r}return(0,l.Z)(n,[{key:"setOptions",value:function(e){return this.options=e,this}},{key:"load",value:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=im.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;var o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader,fetch(e,o).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,Object.assign(i.options,{colorSpaceConversion:"none"}))})).then((function(n){im.add(e,n),t&&t(n),i.manager.itemEnd(e)})).catch((function(t){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)})),i.manager.itemStart(e)}}]),n}(sm);Hm.prototype.isImageBitmapLoader=!0;var Wm={getContext:function(){return void 0===Fm&&(Fm=new(window.AudioContext||window.webkitAudioContext)),Fm},setContext:function(e){Fm=e}},Zm=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,l.Z)(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new lm(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(n){try{var a=n.slice(0);Wm.getContext().decodeAudioData(a,(function(e){t(e)}))}catch(_2){r?r(_2):console.error(_2),i.manager.itemError(e)}}),n,r)}}]),n}(sm),qm=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;(0,u.Z)(this,n),i=t.call(this,void 0,a);var o=(new nl).set(e),s=(new nl).set(r),l=new Ns(o.r,o.g,o.b),c=new Ns(s.r,s.g,s.b),h=Math.sqrt(Math.PI),f=h*Math.sqrt(.75);return i.sh.coefficients[0].copy(l).add(c).multiplyScalar(h),i.sh.coefficients[1].copy(l).sub(c).multiplyScalar(f),i}return(0,l.Z)(n)}(Nm);qm.prototype.isHemisphereLightProbe=!0;var Xm=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;(0,u.Z)(this,n),r=t.call(this,void 0,i);var a=(new nl).set(e);return r.sh.coefficients[0].set(a.r,a.g,a.b).multiplyScalar(2*Math.sqrt(Math.PI)),r}return(0,l.Z)(n)}(Nm);Xm.prototype.isAmbientLightProbe=!0;var Ym=new hu,Km=new hu,Jm=new hu,Qm=function(){function e(){(0,u.Z)(this,e),this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Kl,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Kl,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}return(0,l.Z)(e,[{key:"update",value:function(e){var t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Jm.copy(e.projectionMatrix);var n,r,i=t.eyeSep/2,a=i*t.near/t.focus,o=t.near*Math.tan(ss*t.fov*.5)/t.zoom;Km.elements[12]=-i,Ym.elements[12]=i,n=-o*t.aspect+a,r=o*t.aspect+a,Jm.elements[0]=2*t.near/(r-n),Jm.elements[8]=(r+n)/(r-n),this.cameraL.projectionMatrix.copy(Jm),n=-o*t.aspect-a,r=o*t.aspect-a,Jm.elements[0]=2*t.near/(r-n),Jm.elements[8]=(r+n)/(r-n),this.cameraR.projectionMatrix.copy(Jm)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Km),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Ym)}}]),e}(),$m=function(){function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,u.Z)(this,e),this.autoStart=t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}return(0,l.Z)(e,[{key:"start",value:function(){this.startTime=eg(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=eg();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}]),e}();function eg(){return("undefined"===typeof performance?Date:performance).now()}var tg=new Ns,ng=new Ds,rg=new Ns,ig=new Ns,ag=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.call(this)).type="AudioListener",e.context=Wm.getContext(),e.gain=e.context.createGain(),e.gain.connect(e.context.destination),e.filter=null,e.timeDelta=0,e._clock=new $m,e}return(0,l.Z)(n,[{key:"getInput",value:function(){return this.gain}},{key:"removeFilter",value:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}},{key:"getFilter",value:function(){return this.filter}},{key:"setFilter",value:function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}},{key:"getMasterVolume",value:function(){return this.gain.gain.value}},{key:"setMasterVolume",value:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}},{key:"updateMatrixWorld",value:function(e){wr((0,_r.Z)(n.prototype),"updateMatrixWorld",this).call(this,e);var t=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(tg,ng,rg),ig.set(0,0,-1).applyQuaternion(ng),t.positionX){var i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(tg.x,i),t.positionY.linearRampToValueAtTime(tg.y,i),t.positionZ.linearRampToValueAtTime(tg.z,i),t.forwardX.linearRampToValueAtTime(ig.x,i),t.forwardY.linearRampToValueAtTime(ig.y,i),t.forwardZ.linearRampToValueAtTime(ig.z,i),t.upX.linearRampToValueAtTime(r.x,i),t.upY.linearRampToValueAtTime(r.y,i),t.upZ.linearRampToValueAtTime(r.z,i)}else t.setPosition(tg.x,tg.y,tg.z),t.setOrientation(ig.x,ig.y,ig.z,r.x,r.y,r.z)}}]),n}(Ou),og=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).type="Audio",r.listener=e,r.context=e.context,r.gain=r.context.createGain(),r.gain.connect(e.getInput()),r.autoplay=!1,r.buffer=null,r.detune=0,r.loop=!1,r.loopStart=0,r.loopEnd=0,r.offset=0,r.duration=void 0,r.playbackRate=1,r.isPlaying=!1,r.hasPlaybackControl=!0,r.source=null,r.sourceType="empty",r._startedAt=0,r._progress=0,r._connected=!1,r.filters=[],r}return(0,l.Z)(n,[{key:"getOutput",value:function(){return this.gain}},{key:"setNodeSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}},{key:"setMediaElementSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}},{key:"setMediaStreamSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}},{key:"setBuffer",value:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}},{key:"play",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){this._startedAt=this.context.currentTime+e;var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")}},{key:"pause",value:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"stop",value:function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"connect",value:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}},{key:"disconnect",value:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}},{key:"getFilters",value:function(){return this.filters}},{key:"setFilters",value:function(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}},{key:"setDetune",value:function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}},{key:"getDetune",value:function(){return this.detune}},{key:"getFilter",value:function(){return this.getFilters()[0]}},{key:"setFilter",value:function(e){return this.setFilters(e?[e]:[])}},{key:"setPlaybackRate",value:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"onEnded",value:function(){this.isPlaying=!1}},{key:"getLoop",value:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}},{key:"setLoop",value:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"setLoopStart",value:function(e){return this.loopStart=e,this}},{key:"setLoopEnd",value:function(e){return this.loopEnd=e,this}},{key:"getVolume",value:function(){return this.gain.gain.value}},{key:"setVolume",value:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}]),n}(Ou),sg=new Ns,ug=new Ds,lg=new Ns,cg=new Ns,hg=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).panner=r.context.createPanner(),r.panner.panningModel="HRTF",r.panner.connect(r.gain),r}return(0,l.Z)(n,[{key:"getOutput",value:function(){return this.panner}},{key:"getRefDistance",value:function(){return this.panner.refDistance}},{key:"setRefDistance",value:function(e){return this.panner.refDistance=e,this}},{key:"getRolloffFactor",value:function(){return this.panner.rolloffFactor}},{key:"setRolloffFactor",value:function(e){return this.panner.rolloffFactor=e,this}},{key:"getDistanceModel",value:function(){return this.panner.distanceModel}},{key:"setDistanceModel",value:function(e){return this.panner.distanceModel=e,this}},{key:"getMaxDistance",value:function(){return this.panner.maxDistance}},{key:"setMaxDistance",value:function(e){return this.panner.maxDistance=e,this}},{key:"setDirectionalCone",value:function(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}},{key:"updateMatrixWorld",value:function(e){if(wr((0,_r.Z)(n.prototype),"updateMatrixWorld",this).call(this,e),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(sg,ug,lg),cg.set(0,0,1).applyQuaternion(ug);var t=this.panner;if(t.positionX){var r=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(sg.x,r),t.positionY.linearRampToValueAtTime(sg.y,r),t.positionZ.linearRampToValueAtTime(sg.z,r),t.orientationX.linearRampToValueAtTime(cg.x,r),t.orientationY.linearRampToValueAtTime(cg.y,r),t.orientationZ.linearRampToValueAtTime(cg.z,r)}else t.setPosition(sg.x,sg.y,sg.z),t.setOrientation(cg.x,cg.y,cg.z)}}}]),n}(og),fg=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2048;(0,u.Z)(this,e),this.analyser=t.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}return(0,l.Z)(e,[{key:"getFrequencyData",value:function(){return this.analyser.getByteFrequencyData(this.data),this.data}},{key:"getAverageFrequency",value:function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length}}]),e}(),dg=function(){function e(t,n,r){var i,a,o;switch((0,u.Z)(this,e),this.binding=t,this.valueSize=r,n){case"quaternion":i=this._slerp,a=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*r),this._workIndex=5;break;case"string":case"bool":i=this._select,a=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*r);break;default:i=this._lerp,a=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*r)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=a,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}return(0,l.Z)(e,[{key:"accumulate",value:function(e,t){var n=this.buffer,r=this.valueSize,i=e*r+r,a=this.cumulativeWeight;if(0===a){for(var o=0;o!==r;++o)n[i+o]=n[o];a=t}else{var s=t/(a+=t);this._mixBufferRegion(n,i,0,s,r)}this.cumulativeWeight=a}},{key:"accumulateAdditive",value:function(e){var t=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}},{key:"apply",value:function(e){var t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){var s=t*this._origIndex;this._mixBufferRegion(n,r,s,1-i,t)}a>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(var u=t,l=t+t;u!==l;++u)if(n[u]!==n[u+t]){o.setValue(n,r);break}}},{key:"saveOriginalState",value:function(){var e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(var i=n,a=r;i!==a;++i)t[i]=t[r+i%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}},{key:"restoreOriginalState",value:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)}},{key:"_setAdditiveIdentityNumeric",value:function(){for(var e=this._addIndex*this.valueSize,t=e+this.valueSize,n=e;n<t;n++)this.buffer[n]=0}},{key:"_setAdditiveIdentityQuaternion",value:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}},{key:"_setAdditiveIdentityOther",value:function(){for(var e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize,n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}},{key:"_select",value:function(e,t,n,r,i){if(r>=.5)for(var a=0;a!==i;++a)e[t+a]=e[n+a]}},{key:"_slerp",value:function(e,t,n,r){Ds.slerpFlat(e,t,e,t,e,n,r)}},{key:"_slerpAdditive",value:function(e,t,n,r,i){var a=this._workIndex*i;Ds.multiplyQuaternionsFlat(e,a,e,t,e,n),Ds.slerpFlat(e,t,e,t,e,a,r)}},{key:"_lerp",value:function(e,t,n,r,i){for(var a=1-r,o=0;o!==i;++o){var s=t+o;e[s]=e[s]*a+e[n+o]*r}}},{key:"_lerpAdditive",value:function(e,t,n,r,i){for(var a=0;a!==i;++a){var o=t+a;e[o]=e[o]+e[n+a]*r}}}]),e}(),pg="\\[\\]\\.:\\/",vg=new RegExp("[\\[\\]\\.:\\/]","g"),mg="[^\\[\\]\\.:\\/]",gg="[^"+pg.replace("\\.","")+"]",yg=/((?:WC+[\/:])*)/.source.replace("WC",mg),bg=/(WCOD+)?/.source.replace("WCOD",gg),_g=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",mg),xg=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",mg),wg=new RegExp("^"+yg+bg+_g+xg+"$"),Sg=["material","materials","bones"],Mg=function(){function e(t,n,r){(0,u.Z)(this,e);var i=r||kg.parseTrackName(n);this._targetGroup=t,this._bindings=t.subscribe_(n,i)}return(0,l.Z)(e,[{key:"getValue",value:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)}},{key:"setValue",value:function(e,t){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)}},{key:"bind",value:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}},{key:"unbind",value:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}]),e}(),kg=function(){function e(t,n,r){(0,u.Z)(this,e),this.path=n,this.parsedPath=r||e.parseTrackName(n),this.node=e.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}return(0,l.Z)(e,[{key:"_getValue_unavailable",value:function(){}},{key:"_setValue_unavailable",value:function(){}},{key:"_getValue_direct",value:function(e,t){e[t]=this.targetObject[this.propertyName]}},{key:"_getValue_array",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)e[t++]=n[r]}},{key:"_getValue_arrayElement",value:function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}},{key:"_getValue_toArray",value:function(e,t){this.resolvedProperty.toArray(e,t)}},{key:"_setValue_direct",value:function(e,t){this.targetObject[this.propertyName]=e[t]}},{key:"_setValue_direct_setNeedsUpdate",value:function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}},{key:"_setValue_direct_setMatrixWorldNeedsUpdate",value:function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_array",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++]}},{key:"_setValue_array_setNeedsUpdate",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}},{key:"_setValue_array_setMatrixWorldNeedsUpdate",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_arrayElement",value:function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}},{key:"_setValue_arrayElement_setNeedsUpdate",value:function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}},{key:"_setValue_arrayElement_setMatrixWorldNeedsUpdate",value:function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_fromArray",value:function(e,t){this.resolvedProperty.fromArray(e,t)}},{key:"_setValue_fromArray_setNeedsUpdate",value:function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}},{key:"_setValue_fromArray_setMatrixWorldNeedsUpdate",value:function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_getValue_unbound",value:function(e,t){this.bind(),this.getValue(e,t)}},{key:"_setValue_unbound",value:function(e,t){this.bind(),this.setValue(e,t)}},{key:"bind",value:function(){var t=this.node,n=this.parsedPath,r=n.objectName,i=n.propertyName,a=n.propertyIndex;if(t||(t=e.findNode(this.rootNode,n.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(r){var o=n.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var s=0;s<t.length;s++)if(t[s].name===o){o=s;break}break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==o){if(void 0===t[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[o]}}var u=t[i];if(void 0!==u){var l=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);var c=this.BindingType.Direct;if(void 0!==a){if("morphTargetInfluences"===i){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[a]&&(a=t.morphTargetDictionary[a])}c=this.BindingType.ArrayElement,this.resolvedProperty=u,this.propertyIndex=a}else void 0!==u.fromArray&&void 0!==u.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=u):Array.isArray(u)?(c=this.BindingType.EntireArray,this.resolvedProperty=u):this.propertyName=i;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}else{var h=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+i+" but it wasn't found.",t)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")}},{key:"unbind",value:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}],[{key:"create",value:function(t,n,r){return t&&t.isAnimationObjectGroup?new e.Composite(t,n,r):new e(t,n,r)}},{key:"sanitizeNodeName",value:function(e){return e.replace(/\s/g,"_").replace(vg,"")}},{key:"parseTrackName",value:function(e){var t=wg.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==Sg.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}},{key:"findNode",value:function(e,t){if(!t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){var r=function e(n){for(var r=0;r<n.length;r++){var i=n[r];if(i.name===t||i.uuid===t)return i;var a=e(i.children);if(a)return a}return null}(e.children);if(r)return r}return null}}]),e}();kg.Composite=Mg,kg.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},kg.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},kg.prototype.GetterByBindingType=[kg.prototype._getValue_direct,kg.prototype._getValue_array,kg.prototype._getValue_arrayElement,kg.prototype._getValue_toArray],kg.prototype.SetterByBindingTypeAndVersioning=[[kg.prototype._setValue_direct,kg.prototype._setValue_direct_setNeedsUpdate,kg.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[kg.prototype._setValue_array,kg.prototype._setValue_array_setNeedsUpdate,kg.prototype._setValue_array_setMatrixWorldNeedsUpdate],[kg.prototype._setValue_arrayElement,kg.prototype._setValue_arrayElement_setNeedsUpdate,kg.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[kg.prototype._setValue_fromArray,kg.prototype._setValue_fromArray_setNeedsUpdate,kg.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var Tg=function(){function e(){(0,u.Z)(this,e),this.uuid=ls(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var n=0,r=arguments.length;n!==r;++n)t[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}return(0,l.Z)(e,[{key:"add",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,i=this._bindings,a=i.length,o=void 0,s=e.length,u=this.nCachedObjects_,l=0,c=arguments.length;l!==c;++l){var h=arguments[l],f=h.uuid,d=t[f];if(void 0===d){d=s++,t[f]=d,e.push(h);for(var p=0,v=a;p!==v;++p)i[p].push(new kg(h,n[p],r[p]))}else if(d<u){o=e[d];var m=--u,g=e[m];t[g.uuid]=d,e[d]=g,t[f]=m,e[m]=h;for(var y=0,b=a;y!==b;++y){var _=i[y],x=_[m],w=_[d];_[d]=x,void 0===w&&(w=new kg(h,n[y],r[y])),_[m]=w}}else e[d]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=u}},{key:"remove",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,i=this.nCachedObjects_,a=0,o=arguments.length;a!==o;++a){var s=arguments[a],u=s.uuid,l=t[u];if(void 0!==l&&l>=i){var c=i++,h=e[c];t[h.uuid]=l,e[l]=h,t[u]=c,e[c]=s;for(var f=0,d=r;f!==d;++f){var p=n[f],v=p[c],m=p[l];p[l]=v,p[c]=m}}}this.nCachedObjects_=i}},{key:"uncache",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,i=this.nCachedObjects_,a=e.length,o=0,s=arguments.length;o!==s;++o){var u=arguments[o],l=u.uuid,c=t[l];if(void 0!==c)if(delete t[l],c<i){var h=--i,f=e[h],d=--a,p=e[d];t[f.uuid]=c,e[c]=f,t[p.uuid]=h,e[h]=p,e.pop();for(var v=0,m=r;v!==m;++v){var g=n[v],y=g[h],b=g[d];g[c]=y,g[h]=b,g.pop()}}else{var _=--a,x=e[_];_>0&&(t[x.uuid]=c),e[c]=x,e.pop();for(var w=0,S=r;w!==S;++w){var M=n[w];M[c]=M[_],M.pop()}}}this.nCachedObjects_=i}},{key:"subscribe_",value:function(e,t){var n=this._bindingsIndicesByPath,r=n[e],i=this._bindings;if(void 0!==r)return i[r];var a=this._paths,o=this._parsedPaths,s=this._objects,u=s.length,l=this.nCachedObjects_,c=new Array(u);r=i.length,n[e]=r,a.push(e),o.push(t),i.push(c);for(var h=l,f=s.length;h!==f;++h){var d=s[h];c[h]=new kg(d,e,t)}return c}},{key:"unsubscribe_",value:function(e){var t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){var r=this._paths,i=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o];t[e[o]]=n,a[n]=s,a.pop(),i[n]=i[o],i.pop(),r[n]=r[o],r.pop()}}}]),e}();Tg.prototype.isAnimationObjectGroup=!0;var Eg=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.blendMode;(0,u.Z)(this,e),this._mixer=t,this._clip=n,this._localRoot=r,this.blendMode=i;for(var a=n.tracks,o=a.length,s=new Array(o),l={endingStart:co,endingEnd:co},c=0;c!==o;++c){var h=a[c].createInterpolant(null);s[c]=h,h.settings=l}this._interpolantSettings=l,this._interpolants=s,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=ao,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}return(0,l.Z)(e,[{key:"play",value:function(){return this._mixer._activateAction(this),this}},{key:"stop",value:function(){return this._mixer._deactivateAction(this),this.reset()}},{key:"reset",value:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}},{key:"isRunning",value:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}},{key:"isScheduled",value:function(){return this._mixer._isActiveAction(this)}},{key:"startAt",value:function(e){return this._startTime=e,this}},{key:"setLoop",value:function(e,t){return this.loop=e,this.repetitions=t,this}},{key:"setEffectiveWeight",value:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}},{key:"getEffectiveWeight",value:function(){return this._effectiveWeight}},{key:"fadeIn",value:function(e){return this._scheduleFading(e,0,1)}},{key:"fadeOut",value:function(e){return this._scheduleFading(e,1,0)}},{key:"crossFadeFrom",value:function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){var r=this._clip.duration,i=e._clip.duration,a=i/r,o=r/i;e.warp(1,a,t),this.warp(o,1,t)}return this}},{key:"crossFadeTo",value:function(e,t,n){return e.crossFadeFrom(this,t,n)}},{key:"stopFading",value:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}},{key:"setEffectiveTimeScale",value:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}},{key:"getEffectiveTimeScale",value:function(){return this._effectiveTimeScale}},{key:"setDuration",value:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}},{key:"syncWith",value:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}},{key:"halt",value:function(e){return this.warp(this._effectiveTimeScale,0,e)}},{key:"warp",value:function(e,t,n){var r=this._mixer,i=r.time,a=this.timeScale,o=this._timeScaleInterpolant;null===o&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,u=o.sampleValues;return s[0]=i,s[1]=i+n,u[0]=e/a,u[1]=t/a,this}},{key:"stopWarping",value:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}},{key:"getMixer",value:function(){return this._mixer}},{key:"getClip",value:function(){return this._clip}},{key:"getRoot",value:function(){return this._localRoot||this._mixer._root}},{key:"_update",value:function(e,t,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var a=(e-i)*n;if(a<0||0===n)return;this._startTime=null,t=n*a}t*=this._updateTimeScale(e);var o=this._updateTime(t),s=this._updateWeight(e);if(s>0){var u=this._interpolants,l=this._propertyBindings;if(this.blendMode===vo)for(var c=0,h=u.length;c!==h;++c)u[c].evaluate(o),l[c].accumulateAdditive(s);else for(var f=0,d=u.length;f!==d;++f)u[f].evaluate(o),l[f].accumulate(r,s)}}else this._updateWeight(e)}},{key:"_updateWeight",value:function(e){var t=0;if(this.enabled){t=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t}},{key:"_updateTimeScale",value:function(e){var t=0;if(!this.paused){t=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}return this._effectiveTimeScale=t,t}},{key:"_updateTime",value:function(e){var t=this._clip.duration,n=this.loop,r=this.time+e,i=this._loopCount,a=n===oo;if(0===e)return-1===i?r:a&&1===(1&i)?t-r:r;if(n===io){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),r>=t||r<0){var o=Math.floor(r/t);r-=t*o,i+=Math.abs(o);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){var u=e<0;this._setEndings(u,!u,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=r;if(a&&1===(1&i))return t-r}return r}},{key:"_setEndings",value:function(e,t,n){var r=this._interpolantSettings;n?(r.endingStart=ho,r.endingEnd=ho):(r.endingStart=e?this.zeroSlopeAtStart?ho:co:fo,r.endingEnd=t?this.zeroSlopeAtEnd?ho:co:fo)}},{key:"_scheduleFading",value:function(e,t,n){var r=this._mixer,i=r.time,a=this._weightInterpolant;null===a&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);var o=a.parameterPositions,s=a.sampleValues;return o[0]=i,s[0]=t,o[1]=i+e,s[1]=n,this}}]),e}(),Cg=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this))._root=e,r._initMemoryManager(),r._accuIndex=0,r.time=0,r.timeScale=1,r}return(0,l.Z)(n,[{key:"_bindAction",value:function(e,t){var n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,a=e._propertyBindings,o=e._interpolants,s=n.uuid,u=this._bindingsByRootAndName,l=u[s];void 0===l&&(l={},u[s]=l);for(var c=0;c!==i;++c){var h=r[c],f=h.name,d=l[f];if(void 0!==d)a[c]=d;else{if(void 0!==(d=a[c])){null===d._cacheIndex&&(++d.referenceCount,this._addInactiveBinding(d,s,f));continue}var p=t&&t._propertyBindings[c].binding.parsedPath;++(d=new dg(kg.create(n,f,p),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(d,s,f),a[c]=d}o[c].resultBuffer=d.buffer}}},{key:"_activateAction",value:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}for(var i=e._propertyBindings,a=0,o=i.length;a!==o;++a){var s=i[a];0===s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}},{key:"_deactivateAction",value:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0===--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}}},{key:"_initMemoryManager",value:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}},{key:"_isActiveAction",value:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions}},{key:"_addInactiveAction",value:function(e,t,n){var r=this._actions,i=this._actionsByClip,a=i[t];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=a;else{var o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[n]=e}},{key:"_removeInactiveAction",value:function(e){var t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;var i=e._clip.uuid,a=this._actionsByClip,o=a[i],s=o.knownActions,u=s[s.length-1],l=e._byClipCacheIndex;u._byClipCacheIndex=l,s[l]=u,s.pop(),e._byClipCacheIndex=null,delete o.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete a[i],this._removeInactiveBindingsForAction(e)}},{key:"_removeInactiveBindingsForAction",value:function(e){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0===--i.referenceCount&&this._removeInactiveBinding(i)}}},{key:"_lendAction",value:function(e){var t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}},{key:"_takeBackAction",value:function(e){var t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}},{key:"_addInactiveBinding",value:function(e,t,n){var r=this._bindingsByRootAndName,i=this._bindings,a=r[t];void 0===a&&(a={},r[t]=a),a[n]=e,e._cacheIndex=i.length,i.push(e)}},{key:"_removeInactiveBinding",value:function(e){var t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,a=this._bindingsByRootAndName,o=a[r],s=t[t.length-1],u=e._cacheIndex;s._cacheIndex=u,t[u]=s,t.pop(),delete o[i],0===Object.keys(o).length&&delete a[r]}},{key:"_lendBinding",value:function(e){var t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}},{key:"_takeBackBinding",value:function(e){var t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}},{key:"_lendControlInterpolant",value:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return void 0===n&&((n=new Zv(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=n),n}},{key:"_takeBackControlInterpolant",value:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];e.__cacheIndex=r,t[r]=e,i.__cacheIndex=n,t[n]=i}},{key:"clipAction",value:function(e,t,n){var r=t||this._root,i=r.uuid,a="string"===typeof e?nm.findByName(r,e):e,o=null!==a?a.uuid:e,s=this._actionsByClip[o],u=null;if(void 0===n&&(n=null!==a?a.blendMode:po),void 0!==s){var l=s.actionByRoot[i];if(void 0!==l&&l.blendMode===n)return l;u=s.knownActions[0],null===a&&(a=u._clip)}if(null===a)return null;var c=new Eg(this,a,t,n);return this._bindAction(c,u),this._addInactiveAction(c,o,i),c}},{key:"existingAction",value:function(e,t){var n=t||this._root,r=n.uuid,i="string"===typeof e?nm.findByName(n,e):e,a=i?i.uuid:e,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[r]||null}},{key:"stopAllAction",value:function(){for(var e=this._actions,t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}},{key:"update",value:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),a=this._accuIndex^=1,o=0;o!==n;++o){t[o]._update(r,e,i,a)}for(var s=this._bindings,u=this._nActiveBindings,l=0;l!==u;++l)s[l].apply(a);return this}},{key:"setTime",value:function(e){this.time=0;for(var t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}},{key:"getRoot",value:function(){return this._root}},{key:"uncacheClip",value:function(e){var t=this._actions,n=e.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var a=i.knownActions,o=0,s=a.length;o!==s;++o){var u=a[o];this._deactivateAction(u);var l=u._cacheIndex,c=t[t.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,c._cacheIndex=l,t[l]=c,t.pop(),this._removeInactiveBindingsForAction(u)}delete r[n]}}},{key:"uncacheRoot",value:function(e){var t=e.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var a=this._bindingsByRootAndName[t];if(void 0!==a)for(var o in a){var s=a[o];s.restoreOriginalState(),this._removeInactiveBinding(s)}}},{key:"uncacheAction",value:function(e,t){var n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}]),n}(rs);Cg.prototype._controlInterpolantsResultBuffer=new Float32Array(1);var Ag=function(){function e(t){(0,u.Z)(this,e),"string"===typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}return(0,l.Z)(e,[{key:"clone",value:function(){return new e(void 0===this.value.clone?this.value:this.value.clone())}}]),e}(),Rg=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(0,u.Z)(this,n),(i=t.call(this,e,r)).meshPerAttribute=a,i}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}},{key:"clone",value:function(e){var t=wr((0,_r.Z)(n.prototype),"clone",this).call(this,e);return t.meshPerAttribute=this.meshPerAttribute,t}},{key:"toJSON",value:function(e){var t=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this,e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}]),n}(id);Rg.prototype.isInstancedInterleavedBuffer=!0;var Pg=function(){function e(t,n,r,i,a){(0,u.Z)(this,e),this.buffer=t,this.type=n,this.itemSize=r,this.elementSize=i,this.count=a,this.version=0}return(0,l.Z)(e,[{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"setBuffer",value:function(e){return this.buffer=e,this}},{key:"setType",value:function(e,t){return this.type=e,this.elementSize=t,this}},{key:"setItemSize",value:function(e){return this.itemSize=e,this}},{key:"setCount",value:function(e){return this.count=e,this}}]),e}();Pg.prototype.isGLBufferAttribute=!0;var Lg=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;(0,u.Z)(this,e),this.ray=new cu(t,n),this.near=r,this.far=i,this.camera=null,this.layers=new wu,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}return(0,l.Z)(e,[{key:"set",value:function(e,t){this.ray.set(e,t)}},{key:"setFromCamera",value:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}},{key:"intersectObject",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return Ng(e,this,n,t),n.sort(Dg),n}},{key:"intersectObjects",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=0,i=e.length;r<i;r++)Ng(e[r],this,n,t);return n.sort(Dg),n}}]),e}();function Dg(e,t){return e.distance-t.distance}function Ng(e,t,n,r){if(e.layers.test(t.layers)&&e.raycast(t,n),!0===r)for(var i=e.children,a=0,o=i.length;a<o;a++)Ng(i[a],t,n,!0)}var Ig=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,u.Z)(this,e),this.radius=t,this.phi=n,this.theta=r,this}return(0,l.Z)(e,[{key:"set",value:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}},{key:"copy",value:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}},{key:"makeSafe",value:function(){var e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this}},{key:"setFromVector3",value:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}},{key:"setFromCartesianCoords",value:function(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(cs(t/this.radius,-1,1))),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),Og=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,u.Z)(this,e),this.radius=t,this.theta=n,this.y=r,this}return(0,l.Z)(e,[{key:"set",value:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}},{key:"copy",value:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}},{key:"setFromVector3",value:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}},{key:"setFromCartesianCoords",value:function(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),Ug=new gs,Fg=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new gs(1/0,1/0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new gs(-1/0,-1/0);(0,u.Z)(this,e),this.min=t,this.max=n}return(0,l.Z)(e,[{key:"set",value:function(e,t){return this.min.copy(e),this.max.copy(t),this}},{key:"setFromPoints",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}},{key:"setFromCenterAndSize",value:function(e,t){var n=Ug.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.min.copy(e.min),this.max.copy(e.max),this}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}},{key:"isEmpty",value:function(){return this.max.x<this.min.x||this.max.y<this.min.y}},{key:"getCenter",value:function(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}},{key:"getSize",value:function(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}},{key:"expandByVector",value:function(e){return this.min.sub(e),this.max.add(e),this}},{key:"expandByScalar",value:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this}},{key:"containsPoint",value:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}},{key:"containsBox",value:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}},{key:"getParameter",value:function(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}},{key:"intersectsBox",value:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}},{key:"clampPoint",value:function(e,t){return t.copy(e).clamp(this.min,this.max)}},{key:"distanceToPoint",value:function(e){return Ug.copy(e).clamp(this.min,this.max).sub(e).length()}},{key:"intersect",value:function(e){return this.min.max(e.min),this.max.min(e.max),this}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"translate",value:function(e){return this.min.add(e),this.max.add(e),this}},{key:"equals",value:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}]),e}();Fg.prototype.isBox2=!0;var zg=new Ns,Bg=new Ns,Vg=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ns,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ns;(0,u.Z)(this,e),this.start=t,this.end=n}return(0,l.Z)(e,[{key:"set",value:function(e,t){return this.start.copy(e),this.end.copy(t),this}},{key:"copy",value:function(e){return this.start.copy(e.start),this.end.copy(e.end),this}},{key:"getCenter",value:function(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}},{key:"delta",value:function(e){return e.subVectors(this.end,this.start)}},{key:"distanceSq",value:function(){return this.start.distanceToSquared(this.end)}},{key:"distance",value:function(){return this.start.distanceTo(this.end)}},{key:"at",value:function(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}},{key:"closestPointToPointParameter",value:function(e,t){zg.subVectors(e,this.start),Bg.subVectors(this.end,this.start);var n=Bg.dot(Bg),r=Bg.dot(zg)/n;return t&&(r=cs(r,0,1)),r}},{key:"closestPointToPoint",value:function(e,t,n){var r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}},{key:"applyMatrix4",value:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}},{key:"equals",value:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),Gg=new Ns,jg=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r){var i;(0,u.Z)(this,n),(i=t.call(this)).light=e,i.light.updateMatrixWorld(),i.matrix=e.matrixWorld,i.matrixAutoUpdate=!1,i.color=r;for(var a=new Ml,o=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],s=0,l=1;s<32;s++,l++){var c=s/32*Math.PI*2,h=l/32*Math.PI*2;o.push(Math.cos(c),Math.sin(c),1,Math.cos(h),Math.sin(h),1)}a.setAttribute("position",new vl(o,3));var f=new jd({fog:!1,toneMapped:!1});return i.cone=new Qd(a,f),i.add(i.cone),i.update(),i}return(0,l.Z)(n,[{key:"dispose",value:function(){this.cone.geometry.dispose(),this.cone.material.dispose()}},{key:"update",value:function(){this.light.updateMatrixWorld();var e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),Gg.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Gg),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}]),n}(Ou),Hg=new Ns,Wg=new hu,Zg=new hu,qg=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;(0,u.Z)(this,n);for(var i=Xg(e),a=new Ml,o=[],s=[],l=new nl(0,0,1),c=new nl(0,1,0),h=0;h<i.length;h++){var f=i[h];f.parent&&f.parent.isBone&&(o.push(0,0,0),o.push(0,0,0),s.push(l.r,l.g,l.b),s.push(c.r,c.g,c.b))}a.setAttribute("position",new vl(o,3)),a.setAttribute("color",new vl(s,3));var d=new jd({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});return(r=t.call(this,a,d)).type="SkeletonHelper",r.isSkeletonHelper=!0,r.root=e,r.bones=i,r.matrix=e.matrixWorld,r.matrixAutoUpdate=!1,r}return(0,l.Z)(n,[{key:"updateMatrixWorld",value:function(e){var t=this.bones,r=this.geometry,i=r.getAttribute("position");Zg.copy(this.root.matrixWorld).invert();for(var a=0,o=0;a<t.length;a++){var s=t[a];s.parent&&s.parent.isBone&&(Wg.multiplyMatrices(Zg,s.matrixWorld),Hg.setFromMatrixPosition(Wg),i.setXYZ(o,Hg.x,Hg.y,Hg.z),Wg.multiplyMatrices(Zg,s.parent.matrixWorld),Hg.setFromMatrixPosition(Wg),i.setXYZ(o+1,Hg.x,Hg.y,Hg.z),o+=2)}r.getAttribute("position").needsUpdate=!0,wr((0,_r.Z)(n.prototype),"updateMatrixWorld",this).call(this,e)}}]),n}(Qd);function Xg(e){var t=[];e&&e.isBone&&t.push(e);for(var n=0;n<e.children.length;n++)t.push.apply(t,Xg(e.children[n]));return t}var Yg=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i){var a;(0,u.Z)(this,n);var o=new kv(r,4,2),s=new rl({wireframe:!0,fog:!1,toneMapped:!1});return(a=t.call(this,o,s)).light=e,a.light.updateMatrixWorld(),a.color=i,a.type="PointLightHelper",a.matrix=a.light.matrixWorld,a.matrixAutoUpdate=!1,a.update(),a}return(0,l.Z)(n,[{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}},{key:"update",value:function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}]),n}(Gl),Kg=new Ns,Jg=new nl,Qg=new nl,$g=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i){var a;(0,u.Z)(this,n),(a=t.call(this)).light=e,a.light.updateMatrixWorld(),a.matrix=e.matrixWorld,a.matrixAutoUpdate=!1,a.color=i;var o=new wv(r);o.rotateY(.5*Math.PI),a.material=new rl({wireframe:!0,fog:!1,toneMapped:!1}),void 0===a.color&&(a.material.vertexColors=!0);var s=o.getAttribute("position"),l=new Float32Array(3*s.count);return o.setAttribute("color",new ol(l,3)),a.add(new Gl(o,a.material)),a.update(),a}return(0,l.Z)(n,[{key:"dispose",value:function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}},{key:"update",value:function(){var e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var t=e.geometry.getAttribute("color");Jg.copy(this.light.color),Qg.copy(this.light.groundColor);for(var n=0,r=t.count;n<r;n++){var i=n<r/2?Jg:Qg;t.setXYZ(n,i.r,i.g,i.b)}t.needsUpdate=!0}e.lookAt(Kg.setFromMatrixPosition(this.light.matrixWorld).negate())}}]),n}(Ou),ey=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4473924,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8947848;(0,u.Z)(this,n),a=new nl(a),o=new nl(o);for(var s=i/2,l=r/i,c=r/2,h=[],f=[],d=0,p=0,v=-c;d<=i;d++,v+=l){h.push(-c,0,v,c,0,v),h.push(v,0,-c,v,0,c);var m=d===s?a:o;m.toArray(f,p),p+=3,m.toArray(f,p),p+=3,m.toArray(f,p),p+=3,m.toArray(f,p),p+=3}var g=new Ml;g.setAttribute("position",new vl(h,3)),g.setAttribute("color",new vl(f,3));var y=new jd({vertexColors:!0,toneMapped:!1});return(e=t.call(this,g,y)).type="GridHelper",e}return(0,l.Z)(n)}(Qd),ty=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:64,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4473924,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:8947848;(0,u.Z)(this,n),s=new nl(s),l=new nl(l);for(var c=[],h=[],f=0;f<=i;f++){var d=f/i*(2*Math.PI),p=Math.sin(d)*r,v=Math.cos(d)*r;c.push(0,0,0),c.push(p,0,v);var m=1&f?s:l;h.push(m.r,m.g,m.b),h.push(m.r,m.g,m.b)}for(var g=0;g<=a;g++)for(var y=1&g?s:l,b=r-r/a*g,_=0;_<o;_++){var x=_/o*(2*Math.PI),w=Math.sin(x)*b,S=Math.cos(x)*b;c.push(w,0,S),h.push(y.r,y.g,y.b),x=(_+1)/o*(2*Math.PI),w=Math.sin(x)*b,S=Math.cos(x)*b,c.push(w,0,S),h.push(y.r,y.g,y.b)}var M=new Ml;M.setAttribute("position",new vl(c,3)),M.setAttribute("color",new vl(h,3));var k=new jd({vertexColors:!0,toneMapped:!1});return(e=t.call(this,M,k)).type="PolarGridHelper",e}return(0,l.Z)(n)}(Qd),ny=new Ns,ry=new Ns,iy=new Ns,ay=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i){var a;(0,u.Z)(this,n),(a=t.call(this)).light=e,a.light.updateMatrixWorld(),a.matrix=e.matrixWorld,a.matrixAutoUpdate=!1,a.color=i,void 0===r&&(r=1);var o=new Ml;o.setAttribute("position",new vl([-r,r,0,r,r,0,r,-r,0,-r,-r,0,-r,r,0],3));var s=new jd({fog:!1,toneMapped:!1});return a.lightPlane=new Yd(o,s),a.add(a.lightPlane),(o=new Ml).setAttribute("position",new vl([0,0,0,0,0,1],3)),a.targetLine=new Yd(o,s),a.add(a.targetLine),a.update(),a}return(0,l.Z)(n,[{key:"dispose",value:function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}},{key:"update",value:function(){ny.setFromMatrixPosition(this.light.matrixWorld),ry.setFromMatrixPosition(this.light.target.matrixWorld),iy.subVectors(ry,ny),this.lightPlane.lookAt(ry),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(ry),this.targetLine.scale.z=iy.length()}}]),n}(Ou),oy=new Ns,sy=new Yl,uy=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;(0,u.Z)(this,n);var i=new Ml,a=new jd({color:16777215,vertexColors:!0,toneMapped:!1}),o=[],s=[],l={},c=new nl(16755200),h=new nl(16711680),f=new nl(43775),d=new nl(16777215),p=new nl(3355443);function v(e,t,n){m(e,n),m(t,n)}function m(e,t){o.push(0,0,0),s.push(t.r,t.g,t.b),void 0===l[e]&&(l[e]=[]),l[e].push(o.length/3-1)}return v("n1","n2",c),v("n2","n4",c),v("n4","n3",c),v("n3","n1",c),v("f1","f2",c),v("f2","f4",c),v("f4","f3",c),v("f3","f1",c),v("n1","f1",c),v("n2","f2",c),v("n3","f3",c),v("n4","f4",c),v("p","n1",h),v("p","n2",h),v("p","n3",h),v("p","n4",h),v("u1","u2",f),v("u2","u3",f),v("u3","u1",f),v("c","t",d),v("p","c",p),v("cn1","cn2",p),v("cn3","cn4",p),v("cf1","cf2",p),v("cf3","cf4",p),i.setAttribute("position",new vl(o,3)),i.setAttribute("color",new vl(s,3)),(r=t.call(this,i,a)).type="CameraHelper",r.camera=e,r.camera.updateProjectionMatrix&&r.camera.updateProjectionMatrix(),r.matrix=e.matrixWorld,r.matrixAutoUpdate=!1,r.pointMap=l,r.update(),r}return(0,l.Z)(n,[{key:"update",value:function(){var e=this.geometry,t=this.pointMap;sy.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),ly("c",t,e,sy,0,0,-1),ly("t",t,e,sy,0,0,1),ly("n1",t,e,sy,-1,-1,-1),ly("n2",t,e,sy,1,-1,-1),ly("n3",t,e,sy,-1,1,-1),ly("n4",t,e,sy,1,1,-1),ly("f1",t,e,sy,-1,-1,1),ly("f2",t,e,sy,1,-1,1),ly("f3",t,e,sy,-1,1,1),ly("f4",t,e,sy,1,1,1),ly("u1",t,e,sy,.7,1.1,-1),ly("u2",t,e,sy,-.7,1.1,-1),ly("u3",t,e,sy,0,2,-1),ly("cf1",t,e,sy,-1,0,1),ly("cf2",t,e,sy,1,0,1),ly("cf3",t,e,sy,0,-1,1),ly("cf4",t,e,sy,0,1,1),ly("cn1",t,e,sy,-1,0,-1),ly("cn2",t,e,sy,1,0,-1),ly("cn3",t,e,sy,0,-1,-1),ly("cn4",t,e,sy,0,1,-1),e.getAttribute("position").needsUpdate=!0}},{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}}]),n}(Qd);function ly(e,t,n,r,i,a,o){oy.set(i,a,o).unproject(r);var s=t[e];if(void 0!==s)for(var u=n.getAttribute("position"),l=0,c=s.length;l<c;l++)u.setXYZ(s[l],oy.x,oy.y,oy.z)}var cy,hy,fy=new Us,dy=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;(0,u.Z)(this,n);var a=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),o=new Float32Array(24),s=new Ml;return s.setIndex(new ol(a,1)),s.setAttribute("position",new ol(o,3)),(r=t.call(this,s,new jd({color:i,toneMapped:!1}))).object=e,r.type="BoxHelper",r.matrixAutoUpdate=!1,r.update(),r}return(0,l.Z)(n,[{key:"update",value:function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&fy.setFromObject(this.object),!fy.isEmpty()){var t=fy.min,n=fy.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=t.x,i[4]=n.y,i[5]=n.z,i[6]=t.x,i[7]=t.y,i[8]=n.z,i[9]=n.x,i[10]=t.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=t.z,i[15]=t.x,i[16]=n.y,i[17]=t.z,i[18]=t.x,i[19]=t.y,i[20]=t.z,i[21]=n.x,i[22]=t.y,i[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}}},{key:"setFromObject",value:function(e){return this.object=e,this.update(),this}},{key:"copy",value:function(e){return Qd.prototype.copy.call(this,e),this.object=e.object,this}}]),n}(Qd),py=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;(0,u.Z)(this,n);var a=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),o=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new Ml;return s.setIndex(new ol(a,1)),s.setAttribute("position",new vl(o,3)),(r=t.call(this,s,new jd({color:i,toneMapped:!1}))).box=e,r.type="Box3Helper",r.geometry.computeBoundingSphere(),r}return(0,l.Z)(n,[{key:"updateMatrixWorld",value:function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),wr((0,_r.Z)(n.prototype),"updateMatrixWorld",this).call(this,e))}}]),n}(Qd),vy=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16776960;(0,u.Z)(this,n);var o=a,s=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],l=new Ml;l.setAttribute("position",new vl(s,3)),l.computeBoundingSphere(),(r=t.call(this,l,new jd({color:o,toneMapped:!1}))).type="PlaneHelper",r.plane=e,r.size=i;var c=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],h=new Ml;return h.setAttribute("position",new vl(c,3)),h.computeBoundingSphere(),r.add(new Gl(h,new rl({color:o,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1}))),r}return(0,l.Z)(n,[{key:"updateMatrixWorld",value:function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?Ur:Or,this.lookAt(this.plane.normal),wr((0,_r.Z)(n.prototype),"updateMatrixWorld",this).call(this,e)}}]),n}(Yd),my=new Ns,gy=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ns(0,0,1),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ns(0,0,0),a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16776960,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.2*a,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.2*s;return(0,u.Z)(this,n),(e=t.call(this)).type="ArrowHelper",void 0===cy&&((cy=new Ml).setAttribute("position",new vl([0,0,0,0,1,0],3)),(hy=new hp(0,.5,1,5,1)).translate(0,-.5,0)),e.position.copy(i),e.line=new Yd(cy,new jd({color:o,toneMapped:!1})),e.line.matrixAutoUpdate=!1,e.add(e.line),e.cone=new Gl(hy,new rl({color:o,toneMapped:!1})),e.cone.matrixAutoUpdate=!1,e.add(e.cone),e.setDirection(r),e.setLength(a,s,l),e}return(0,l.Z)(n,[{key:"setDirection",value:function(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{my.set(e.z,0,-e.x).normalize();var t=Math.acos(e.y);this.quaternion.setFromAxisAngle(my,t)}}},{key:"setLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2*e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.2*t;this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}},{key:"setColor",value:function(e){this.line.material.color.set(e),this.cone.material.color.set(e)}},{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}}]),n}(Ou),yy=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;(0,u.Z)(this,n);var i=[0,0,0,r,0,0,0,0,0,0,r,0,0,0,0,0,0,r],a=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],o=new Ml;o.setAttribute("position",new vl(i,3)),o.setAttribute("color",new vl(a,3));var s=new jd({vertexColors:!0,toneMapped:!1});return(e=t.call(this,o,s)).type="AxesHelper",e}return(0,l.Z)(n,[{key:"setColors",value:function(e,t,n){var r=new nl,i=this.geometry.attributes.color.array;return r.set(e),r.toArray(i,0),r.toArray(i,3),r.set(t),r.toArray(i,6),r.toArray(i,9),r.set(n),r.toArray(i,12),r.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}},{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}}]),n}(Qd),by=function(){function e(){(0,u.Z)(this,e),this.type="ShapePath",this.color=new nl,this.subPaths=[],this.currentPath=null}return(0,l.Z)(e,[{key:"moveTo",value:function(e,t){return this.currentPath=new Vp,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}},{key:"lineTo",value:function(e,t){return this.currentPath.lineTo(e,t),this}},{key:"quadraticCurveTo",value:function(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}},{key:"bezierCurveTo",value:function(e,t,n,r,i,a){return this.currentPath.bezierCurveTo(e,t,n,r,i,a),this}},{key:"splineThru",value:function(e){return this.currentPath.splineThru(e),this}},{key:"toShapes",value:function(e,t){function n(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n],a=new Gp;a.curves=i.curves,t.push(a)}return t}function r(e,t){for(var n=t.length,r=!1,i=n-1,a=0;a<n;i=a++){var o=t[i],s=t[a],u=s.x-o.x,l=s.y-o.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(o=t[a],u=-u,s=t[i],l=-l),e.y<o.y||e.y>s.y)continue;if(e.y===o.y){if(e.x===o.x)return!0}else{var c=l*(e.x-o.x)-u*(e.y-o.y);if(0===c)return!0;if(c<0)continue;r=!r}}else{if(e.y!==o.y)continue;if(s.x<=e.x&&e.x<=o.x||o.x<=e.x&&e.x<=s.x)return!0}}return r}var i,a,o,s=vv.isClockWise,u=this.subPaths;if(0===u.length)return[];if(!0===t)return n(u);var l=[];if(1===u.length)return a=u[0],(o=new Gp).curves=a.curves,l.push(o),l;var c=!s(u[0].getPoints());c=e?!c:c;var h,f,d=[],p=[],v=[],m=0;p[m]=void 0,v[m]=[];for(var g=0,y=u.length;g<y;g++)i=s(h=(a=u[g]).getPoints()),(i=e?!i:i)?(!c&&p[m]&&m++,p[m]={s:new Gp,p:h},p[m].s.curves=a.curves,c&&m++,v[m]=[]):v[m].push({h:a,p:h[0]});if(!p[0])return n(u);if(p.length>1){for(var b=!1,_=[],x=0,w=p.length;x<w;x++)d[x]=[];for(var S=0,M=p.length;S<M;S++)for(var k=v[S],T=0;T<k.length;T++){for(var E=k[T],C=!0,A=0;A<p.length;A++)r(E.p,p[A].p)&&(S!==A&&_.push({froms:S,tos:A,hole:T}),C?(C=!1,d[A].push(E)):b=!0);C&&d[S].push(E)}_.length>0&&(b||(v=d))}for(var R=0,P=p.length;R<P;R++){o=p[R].s,l.push(o);for(var L=0,D=(f=v[R]).length;L<D;L++)o.holes.push(f[L].h)}return l}}]),e}(),_y=new Float32Array(1),xy=new Int32Array(_y.buffer),wy=function(){function e(){(0,u.Z)(this,e)}return(0,l.Z)(e,null,[{key:"toHalfFloat",value:function(e){e>65504&&(console.warn("THREE.DataUtils.toHalfFloat(): value exceeds 65504."),e=65504),_y[0]=e;var t=xy[0],n=t>>16&32768,r=t>>12&2047,i=t>>23&255;return i<103?n:i>142?(n|=31744,n|=(255==i?0:1)&&8388607&t):i<113?n|=((r|=2048)>>114-i)+(r>>113-i&1):(n|=i-112<<10|r>>1,n+=1&r)}}]),e}(),Sy=0,My=1,ky=0,Ty=1,Ey=2;function Cy(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e}function Ay(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e}function Ry(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new ap(e,t)}function Py(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new xd(e)}function Ly(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new ap(e,t)}function Dy(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new ep(e)}function Ny(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new ep(e)}function Iy(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new ep(e)}function Oy(e,t,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Ns(e,t,n)}function Uy(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new ol(e,t).setUsage(qo)}function Fy(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new sl(e,t)}function zy(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new ul(e,t)}function By(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new ll(e,t)}function Vy(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new cl(e,t)}function Gy(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new hl(e,t)}function jy(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new fl(e,t)}function Hy(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new dl(e,t)}function Wy(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new vl(e,t)}function Zy(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new ml(e,t)}function qy(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new yy(e)}function Xy(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new dy(e,t)}function Yy(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Qd(new bp(e.geometry),new jd({color:void 0!==t?t:16777215}))}function Ky(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Qd(new Rv(e.geometry),new jd({color:void 0!==t?t:16777215}))}function Jy(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new lm(e)}function Qy(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new pm(e)}function $y(e,t,n){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new ec(e,n)}function eb(){console.error("THREE.CanvasRenderer has been removed")}function tb(){console.error("THREE.JSONLoader has been removed.")}_p.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(_p.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Vp.prototype.fromPoints=function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)},ey.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},qg.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},sm.prototype.extractUrlBase=function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Om.extractUrlBase(e)},sm.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Fg.prototype.center=function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},Fg.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Fg.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},Fg.prototype.size=function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)},Us.prototype.center=function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Us.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Us.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},Us.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},Us.prototype.size=function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)},nu.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},sc.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},Vg.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},ys.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},ys.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},ys.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},ys.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},ys.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},ys.prototype.getInverse=function(e){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},hu.prototype.extractPosition=function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},hu.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},hu.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new Ns).setFromMatrixColumn(this,3)},hu.prototype.setRotationFromQuaternion=function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},hu.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},hu.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},hu.prototype.multiplyVector4=function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},hu.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},hu.prototype.rotateAxis=function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},hu.prototype.crossVector=function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},hu.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},hu.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},hu.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},hu.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},hu.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},hu.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},hu.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},hu.prototype.makeFrustum=function(e,t,n,r,i,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,r,n,i,a)},hu.prototype.getInverse=function(e){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},ic.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},Ds.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Ds.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},cu.prototype.isIntersectionBox=function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},cu.prototype.isIntersectionPlane=function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},cu.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},qu.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},qu.prototype.barycoordFromPoint=function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},qu.prototype.midpoint=function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},qu.prototypenormal=function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},qu.prototype.plane=function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)},qu.barycoordFromPoint=function(e,t,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),qu.getBarycoord(e,t,n,r,i)},qu.normal=function(e,t,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),qu.getNormal(e,t,n,r)},Gp.prototype.extractAllPoints=function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},Gp.prototype.extrude=function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new yv(this,e)},Gp.prototype.makeGeometry=function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Mv(this,e)},gs.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},gs.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},gs.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Ns.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},Ns.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},Ns.prototype.getPositionFromMatrix=function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},Ns.prototype.getScaleFromMatrix=function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},Ns.prototype.getColumnFromMatrix=function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},Ns.prototype.applyProjection=function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},Ns.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},Ns.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},Ns.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},As.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},As.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Ou.prototype.getChildByName=function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},Ou.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Ou.prototype.translate=function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},Ou.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Ou.prototype.applyMatrix=function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(Ou.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Gl.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(Gl.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),mo},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Pd.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Kl.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(mm.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(ol.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===qo},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(qo)}}}),ol.prototype.setDynamic=function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?qo:Zo),this},ol.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},ol.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Ml.prototype.addIndex=function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},Ml.prototype.addAttribute=function(e,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new ol(arguments[1],arguments[2])))},Ml.prototype.addDrawCall=function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},Ml.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},Ml.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},Ml.prototype.removeAttribute=function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},Ml.prototype.applyMatrix=function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(Ml.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),id.prototype.setDynamic=function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?qo:Zo),this},id.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},yv.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},yv.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},yv.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},rd.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},Ag.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(Yu.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new nl}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===zr}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(Xl.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),$f.prototype.clearTarget=function(e,t,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,n,r)},$f.prototype.animate=function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},$f.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},$f.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},$f.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},$f.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},$f.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},$f.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},$f.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},$f.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},$f.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},$f.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},$f.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},$f.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},$f.prototype.enableScissorTest=function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},$f.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},$f.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},$f.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},$f.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},$f.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},$f.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},$f.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},$f.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},$f.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},$f.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties($f.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===e?_o:bo}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(Vf.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Rs.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),og.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new Zm).load(e,(function(e){t.setBuffer(e)})),this},fg.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Ql.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)},Ql.prototype.clear=function(e,t,n,r){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(e,t,n,r)},ks.crossOrigin=void 0,ks.loadTexture=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new vm;i.setCrossOrigin(this.crossOrigin);var a=i.load(e,n,void 0,r);return t&&(a.mapping=t),a},ks.loadTextureCube=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new dm;i.setCrossOrigin(this.crossOrigin);var a=i.load(e,n,void 0,r);return t&&(a.mapping=t),a},ks.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},ks.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};var nb={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function rb(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}function ib(){return console.error("THREE.ParametricGeometry has been moved to /examples/jsm/geometries/ParametricGeometry.js"),new Ml}function ab(){return console.error("THREE.TextGeometry has been moved to /examples/jsm/geometries/TextGeometry.js"),new Ml}function ob(){console.error("THREE.FontLoader has been moved to /examples/jsm/loaders/FontLoader.js")}function sb(){console.error("THREE.Font has been moved to /examples/jsm/loaders/FontLoader.js")}function ub(){console.error("THREE.ImmediateRenderObject has been removed.")}"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:kr}})),"undefined"!==typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=kr);var lb,cb=e,hb=fr().mark(xb),fb=fr().mark(Nb),db=fr().mark(Ib),pb=fr().mark(Ob);function vb(e,t){for(var n=0,r=e.length-1,i=-1;n<=r;){var a=Math.floor((n+r)/2);e[a]<t?(i=a,n=a+1):r=a-1}return i}function mb(e){var t=vr(e.split("&"),3),n=t[1],r=t[2],i=vr(r.split(" "),2)[1];return r.startsWith("joint")?"&angle&"+i:"&"+n+"&"+i}function gb(e,t,n){e.normalize();var r=void 0,i=new cb.Vector3(0,0,0);if(void 0!=t){var a=new cb.Vector3(e.x,e.y,e.z),o=new cb.Vector3(-e.x,-e.y,-e.z),s=a.distanceTo(t),u=o.distanceTo(t);r=s<u||s==u&&n?i.clone().add(a):i.clone().add(o)}else{var l=new cb.Vector3(-e.x,-e.y,-e.z);n&&(l=new cb.Vector3(e.x,e.y,e.z)),r=i.clone().add(l)}return r}function yb(e,t){for(var n=0,r=e.length-1,i=void 0;n<=r;){var a=Math.floor((n+r)/2);e[a]<=t?(i=a,n=a+1):r=a-1}return i}function bb(e,t){for(var n=0,r=e.length-1,i=void 0;n<=r;){var a=Math.floor((n+r)/2);e[a]>=t?(i=a,r=a-1):n=a+1}return i}function _b(e,t){if(void 0===e);else if(Array.isArray(e)){var n,r=s(e);try{for(r.s();!(n=r.n()).done;){_b(n.value,t)}}catch(i){r.e(i)}finally{r.f()}}else t(e)}function xb(e){var t,n,r,i,a,o;return fr().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:e=e.trim(),t=!1,n=[],r=0,i=0;case 2:if(!(i<e.length)){s.next=37;break}if(a=e[i],o=e[i+1],n[r]=n[r]||"",'"'!==a||!t||'"'!==o){s.next=10;break}n[r]+=a,++i,s.next=34;break;case 10:if('"'!==a){s.next=14;break}t=!t,s.next=34;break;case 14:if(","!==a||t){s.next=18;break}++r,s.next=34;break;case 18:if("\r"!==a||"\n"!==o||t){s.next=26;break}return s.next=21,n;case 21:r=0,n=[],++i,s.next=34;break;case 26:if("\n"!==a&&"\r"!==a||t){s.next=33;break}return s.next=29,n;case 29:r=0,n=[],s.next=34;break;case 33:n[r]+=a;case 34:i++,s.next=2;break;case 37:if(s.t0=n.length,!s.t0){s.next=41;break}return s.next=41,n;case 41:case"end":return s.stop()}}),hb)}function wb(e,t){var n=e.r,r=e.g,i=e.b,a=(n+r+i)/3;return n=kb(kb(n,a,.4),t.r,.4),r=kb(kb(r,a,.4),t.g,.4),i=kb(kb(i,a,.4),t.b,.4),new cb.Color(n,r,i)}function Sb(e){return e*(Math.PI/180)}function Mb(e){return e*(180/Math.PI)}function kb(e,t,n){return e+(t-e)*n}!function(e){e.NUMBER="number",e.STRING="string",e.STRING_AND_NUMBER="string_and_number"}(lb||(lb={}));var Tb="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",Eb=new Set;function Cb(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4,t=arguments.length>1?arguments[1]:void 0;t&&t<e&&(t=e);for(var n="",r=100,i=r;;){var a=n+Tb[Rb(0,Tb.length-1)];if(void 0!==t&&Cb.length>t)n="";else if(a.length<e||i<=0)n=a,i=r;else{if(!Eb.has(a))return Eb.add(a),a;i--}}}function Ab(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Math.random()*(t-e)+e}function Rb(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Math.round(Ab(e,t))}function Pb(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16777215,n="#"+Math.floor(Ab(e,t)).toString(16);n.length<6;)n+="0";return n}function Lb(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e<t?t:e>n?n:e}function Db(e){for(var t="",n=0,r=0;r<e.length;r++){var i=e[r];"0123456789".includes(i)?t+=i:0===n&&"."===i?(t+=i,n++):0===t.length&&"-"===i&&(t+=i)}return t}function Nb(e,t,n){var r,i,a,o;return fr().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:a=null!==n&&void 0!==n?n:1,void 0===t?(r=0,i=e):(r=e,i=t),o=r;case 3:if(!(o<i)){s.next=9;break}return s.next=6,o;case 6:o+=a,s.next=3;break;case 9:case"end":return s.stop()}}),fb)}function Ib(e){var t,n,r,i;return fr().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:t=0,n=s(e),a.prev=2,n.s();case 4:if((r=n.n()).done){a.next=10;break}return i=r.value,a.next=8,[t++,i];case 8:a.next=4;break;case 10:a.next=15;break;case 12:a.prev=12,a.t0=a.catch(2),n.e(a.t0);case 15:return a.prev=15,n.f(),a.finish(15);case 18:case"end":return a.stop()}}),db,null,[[2,12,15,18]])}function Ob(){var e,t,n,r,i,a,o,u,l,c,h=arguments;return fr().wrap((function(f){for(;;)switch(f.prev=f.next){case 0:for(e=h.length,t=new Array(e),n=0;n<e;n++)t[n]=h[n];r=t.map((function(e){return e[Symbol.iterator]()}));case 2:0,i=[],a=s(r),f.prev=5,a.s();case 7:if((o=a.n()).done){f.next=15;break}if(u=o.value,l=u.next(),c=l.value,!l.done){f.next=12;break}return f.abrupt("break",15);case 12:i.push(c);case 13:f.next=7;break;case 15:f.next=20;break;case 17:f.prev=17,f.t0=f.catch(5),a.e(f.t0);case 20:return f.prev=20,a.f(),f.finish(20);case 23:if(i.length===r.length){f.next=25;break}return f.abrupt("return");case 25:return f.next=27,i;case 27:f.next=2;break;case 29:case"end":return f.stop()}}),pb,null,[[5,17,20,23]])}function Ub(e,t){for(var n=-1,r=e.length;1+n<r;){var i=n+(r-n>>1);t(e[i])?r=i:n=i}return r}function Fb(e,t,n){return Ub(e,void 0===n?function(e){return e>=t}:function(e){return n(e)>=n(t)})}function zb(e,t){var n,r=new Map,i=s(e);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=t(a);void 0!==r.get(o)?r.set(o,[a,!1]):r.set(o,[a,!0])}}catch(p){i.e(p)}finally{i.f()}var u,l=[],c=s(r.entries());try{for(c.s();!(u=c.n()).done;){var h=vr(u.value,2),f=vr(h[1],2),d=f[0];f[1]&&l.push(d)}}catch(p){c.e(p)}finally{c.f()}return l}function Bb(e,t,n){return e.filter((function(e){return n(e)===n(t)})).length}function Vb(e){return function(){var t;e>0&&((t=console).log.apply(t,arguments),e--)}}Vb(1e3);function Gb(e){return e="Could not deserialize Animation: ".concat(e),lr.error(e),e}var jb=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(0,u.Z)(this,e),this._object=void 0,this._animationTable=void 0,this._offset=void 0,this._lengthen=void 0,this._object=t,this._animationTable=n,this._offset=r,this._lengthen=i}return(0,l.Z)(e,[{key:"copy",value:function(e,t){var n=t.get(e._object);if(void 0===n)throw Error("Object ".concat(this._object.name(),"  could not be mapped to a copy!"));return this._object=n,this._animationTable=e._animationTable.clone(),this._offset=e._offset,this._lengthen=e._lengthen,this}},{key:"clone",value:function(t){var n=t.get(this._object);if(void 0===n)throw Error("Object ".concat(this._object.name()," could not be mapped to a clone!"));return new e(n,this._animationTable.clone(),this._offset,this._lengthen)}},{key:"objectAnimating",value:function(){return this._object}},{key:"animationTable",value:function(){return this._animationTable}},{key:"startTime",value:function(){return this._animationTable.startTime()+this._offset}},{key:"endTime",value:function(){return this._animationTable.endTime()+this._offset+this._lengthen}},{key:"update",value:function(e){e+=this._offset;var t=[this.startTime(),this.endTime()],n=t[0],r=t[1],i=r+n,a=e+n;(e-=kb(0,this._lengthen,a/i))<n&&(e=n),e>r&&(e=r);var o=this._animationTable.frame(e,this._object.name());this._object.applyFrame(o)}},{key:"setOffset",value:function(e){this._offset=e,lr.render(),lr.updateUI()}},{key:"robot",value:function(){return this._object}},{key:"offset",value:function(){return this._offset}},{key:"setLengthen",value:function(e){this._lengthen=e,lr.render(),lr.updateUI()}},{key:"lengthen",value:function(){return this._lengthen}},{key:"serialize",value:function(){return{objectId:this._object.idValue(),animationTableId:this._animationTable.idValue(),offset:this._offset,lengthen:this._lengthen}}}],[{key:"deserialize",value:function(){var t=pr(fr().mark((function t(n,r,i,a){var o,s,u,l;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(o=r.get(n.objectId))){t.next=24;break}if(s=o,!(u=n.animationTableId)){t.next=21;break}if(!(l=i.get(u))){t.next=18;break}if(a){t.next=11;break}return t.abrupt("return",new e(s,l,n.offset,n.lengthen));case 11:return a._object=s,a._animationTable=l,n.offset&&(a._offset=n.offset),n.lengthen&&(a._offset=n.lengthen),t.abrupt("return",a);case 16:t.next=19;break;case 18:throw Gb("An animation table with ID ".concat(u," could not be found."));case 19:t.next=22;break;case 21:throw Gb("AnimationTable seral was not present while deserializing Animation.");case 22:t.next=25;break;case 24:throw Gb('Uknown object ID "'.concat(n.objectId,'"'));case 25:case"end":return t.stop()}}),t)})));return function(e,n,r,i){return t.apply(this,arguments)}}()}]),e}(),Hb=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Animation Group",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];(0,u.Z)(this,e),this._name=void 0,this._animations=void 0,this._name=t,this._animations=cr(n)}return(0,l.Z)(e,[{key:"setName",value:function(e){this._name=e,lr.updateUI()}},{key:"name",value:function(){return this._name}},{key:"startTime",value:function(){var e,t=1/0,n=s(this._animations);try{for(n.s();!(e=n.n()).done;){var r=e.value;t=Math.min(t,r.startTime())}}catch(i){n.e(i)}finally{n.f()}return t===1/0&&(t=0),t}},{key:"endTime",value:function(){var e,t=-1/0,n=s(this._animations);try{for(n.s();!(e=n.n()).done;){var r=e.value;t=Math.max(t,r.endTime())}}catch(i){n.e(i)}finally{n.f()}return t===-1/0&&(t=1),t}},{key:"update",value:function(e){var t,n=s(this._animations);try{for(n.s();!(t=n.n()).done;){t.value.update(e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"animations",value:function(){return this._animations}},{key:"addAnimation",value:function(e){-1===this._animations.indexOf(e)&&(this._animations.push(e),lr.updateUI())}},{key:"removeAnimation",value:function(e){var t=this._animations.indexOf(e);t>=0&&(this._animations.splice(t,1),lr.updateUI())}},{key:"copy",value:function(e,t){this._name=e.name();var n,r=s(e._animations);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.addAnimation(i.clone(t))}}catch(a){r.e(a)}finally{r.f()}return this}},{key:"clone",value:function(t){return(new e).copy(this,t)}},{key:"serialize",value:function(){var e,t=[],n=s(this._animations);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push(r.serialize())}}catch(i){n.e(i)}finally{n.f()}return{name:this._name,animations:t}}}],[{key:"deserialize",value:function(){var t=pr(fr().mark((function t(n,r,i,a){var o,u,l,c,h,f,d,p,v,m;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=null!==a&&void 0!==a?a:new e,!(u=n.animations)){t.next=12;break}n.name&&(o._name=n.name),l=[],c=s(u);try{for(c.s();!(h=c.n()).done;)f=h.value,l.push(jb.deserialize(f,r,i))}catch(g){c.e(g)}finally{c.f()}return t.next=9,Promise.all(l);case 9:d=t.sent,p=s(d);try{for(p.s();!(v=p.n()).done;)m=v.value,o.addAnimation(m)}catch(g){p.e(g)}finally{p.f()}case 12:return t.abrupt("return",o);case 13:case"end":return t.stop()}}),t)})));return function(e,n,r,i){return t.apply(this,arguments)}}()}]),e}(),Wb=n(763),Zb=n.n(Wb),qb=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30,r=arguments.length>1?arguments[1]:void 0;(0,u.Z)(this,e),this._renderFunc=void 0,this._lastTimeRendered=void 0,this._maxFPS=void 0,this._renderFuncs=void 0,this.addBoundFunc=function(e){t._renderFuncs.push(e)},this.removeBoundFunc=function(e){var n=t._renderFuncs.indexOf(e);n>-1&&t._renderFuncs.splice(n,1)},this.call=function(){void 0===t._renderFunc&&(t._renderFunc=t.renderFunc,requestAnimationFrame((function(){t.renderFunc()})))},this.forceCall=function(){t.renderFunc(!0)},this.renderFunc=function(e){var n=Date.now(),r=n-t._lastTimeRendered;if(e||r>=1e3/t._maxFPS){var i,a=s(t._renderFuncs);try{for(a.s();!(i=a.n()).done;){(0,i.value)()}}catch(o){a.e(o)}finally{a.f()}return t._lastTimeRendered=n,void(t._renderFunc=void 0)}requestAnimationFrame((function(){t.renderFunc()}))},this._lastTimeRendered=0,this._maxFPS=n,this._renderFuncs=null!==r&&void 0!==r?r:[]}return(0,l.Z)(e,[{key:"maxFPS",value:function(){return this._maxFPS}},{key:"setMaxFPS",value:function(e){this._maxFPS=e}}]),e}(),Xb=function(){function e(t,n,r,i){var a=this;(0,u.Z)(this,e),this._currTime=void 0,this._lastTimeRendered=void 0,this._endTime=void 0,this._startTime=void 0,this._maxFPS=void 0,this._wasPlaying=void 0,this._playFunc=void 0,this._renderFunc=void 0,this._render=void 0,this.time=function(){return a._currTime},this.setTime=function(e){(e=(0,Wb.clamp)(e,a._startTime,a._endTime))!==a._currTime&&(void 0===a._playFunc?(a._currTime=e,a._render.call(),lr.updateUI()):a._currTime=e)},this.start=function(){void 0===a._playFunc&&(a._playFunc=function(){var e=Date.now(),t=Math.abs(e-a._lastTimeRendered);if(!1===a._wasPlaying)return a._wasPlaying=!0,a._lastTimeRendered=e,void(void 0!==a._playFunc?requestAnimationFrame(a._playFunc):a.stop());void 0!==a._playFunc&&(a._currTime+=t/1e3,e-a._lastTimeRendered>=1e3/(2*a._maxFPS)&&(a._render.forceCall(),a._lastTimeRendered=e),void 0!==a._playFunc&&requestAnimationFrame(a._playFunc))},requestAnimationFrame(a._playFunc))},this.stop=function(){a._wasPlaying=!1,a._playFunc=void 0},this.restart=function(){a.setTime(a._startTime)},this.render=function(){var e=a._currTime;e>a._endTime?(e=a._endTime,a._currTime=a._endTime,a.stop()):e<a._startTime&&(a._currTime=0,e=a._startTime),a._renderFunc(e)},this._currTime=n,this._lastTimeRendered=0,this._startTime=n,this._endTime=r,this._maxFPS=t,this._wasPlaying=!1,this._renderFunc=i,this._render=new qb(t,[this.render])}return(0,l.Z)(e,[{key:"startTime",value:function(){return this._startTime}},{key:"setStartTime",value:function(e){(e=Math.min(e,this._endTime))!==this._startTime&&(this._startTime=e,this._currTime<e&&(this._currTime=e),lr.updateUI())}},{key:"endTime",value:function(){return this._endTime}},{key:"setEndTime",value:function(e){(e=Math.max(this._startTime,e))!==this._endTime&&(this._endTime=e,this._currTime>e&&(this._currTime=e),lr.updateUI())}},{key:"maxFPS",value:function(){return this._maxFPS}},{key:"setMaxFPS",value:function(e){this._maxFPS=Math.max(e,1),this._render.setMaxFPS(e),lr.updateUI()}}]),e}(),Yb=function(){function e(t){(0,u.Z)(this,e),this._id=void 0,this._id=null!==t&&void 0!==t?t:Cb(64,64)}return(0,l.Z)(e,[{key:"set",value:function(e){this._id=e}},{key:"value",value:function(){return this._id}},{key:"regen",value:function(){this._id=Cb(64,64)}}]),e}(),Kb=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).dracoLoader=null,r.ktx2Loader=null,r.meshoptDecoder=null,r.pluginCallbacks=[],r.register((function(e){return new t_(e)})),r.register((function(e){return new s_(e)})),r.register((function(e){return new u_(e)})),r.register((function(e){return new n_(e)})),r.register((function(e){return new r_(e)})),r.register((function(e){return new i_(e)})),r.register((function(e){return new a_(e)})),r.register((function(e){return new o_(e)})),r.register((function(e){return new $b(e)})),r.register((function(e){return new l_(e)})),r}return(0,l.Z)(n,[{key:"load",value:function(e,t,n,r){var i,a=this;i=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:Om.extractUrlBase(e),this.manager.itemStart(e);var o=function(t){r?r(t):console.error(t),a.manager.itemError(e),a.manager.itemEnd(e)},s=new lm(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,(function(n){try{a.parse(n,i,(function(n){t(n),a.manager.itemEnd(e)}),o)}catch(_2){o(_2)}}),n,o)}},{key:"setDRACOLoader",value:function(e){return this.dracoLoader=e,this}},{key:"setDDSLoader",value:function(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}},{key:"setKTX2Loader",value:function(e){return this.ktx2Loader=e,this}},{key:"setMeshoptDecoder",value:function(e){return this.meshoptDecoder=e,this}},{key:"register",value:function(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}},{key:"unregister",value:function(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}},{key:"parse",value:function(e,t,n,r){var i,a={},o={};if("string"===typeof e)i=e;else if(Om.decodeText(new Uint8Array(e,0,4))===c_){try{a[Qb.KHR_BINARY_GLTF]=new d_(e)}catch(p){return void(r&&r(p))}i=a[Qb.KHR_BINARY_GLTF].content}else i=Om.decodeText(new Uint8Array(e));var s=JSON.parse(i);if(void 0===s.asset||s.asset.version[0]<2)r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{var u=new W_(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});u.fileLoader.setRequestHeader(this.requestHeader);for(var l=0;l<this.pluginCallbacks.length;l++){var c=this.pluginCallbacks[l](u);o[c.name]=c,a[c.name]=!0}if(s.extensionsUsed)for(var h=0;h<s.extensionsUsed.length;++h){var f=s.extensionsUsed[h],d=s.extensionsRequired||[];switch(f){case Qb.KHR_MATERIALS_UNLIT:a[f]=new e_;break;case Qb.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:a[f]=new g_;break;case Qb.KHR_DRACO_MESH_COMPRESSION:a[f]=new p_(s,this.dracoLoader);break;case Qb.KHR_TEXTURE_TRANSFORM:a[f]=new v_;break;case Qb.KHR_MESH_QUANTIZATION:a[f]=new y_;break;default:d.indexOf(f)>=0&&void 0===o[f]&&console.warn('THREE.GLTFLoader: Unknown extension "'+f+'".')}}u.setExtensions(a),u.setPlugins(o),u.parse(n,r)}}},{key:"parseAsync",value:function(e,t){var n=this;return new Promise((function(r,i){n.parse(e,t,r,i)}))}}]),n}(sm);function Jb(){var e={};return{get:function(t){return e[t]},add:function(t,n){e[t]=n},remove:function(t){delete e[t]},removeAll:function(){e={}}}}var Qb={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"},$b=function(){function e(t){(0,u.Z)(this,e),this.parser=t,this.name=Qb.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}return(0,l.Z)(e,[{key:"_markDefs",value:function(){for(var e=this.parser,t=this.parser.json.nodes||[],n=0,r=t.length;n<r;n++){var i=t[n];i.extensions&&i.extensions[this.name]&&void 0!==i.extensions[this.name].light&&e._addNodeRef(this.cache,i.extensions[this.name].light)}}},{key:"_loadLight",value:function(e){var t=this.parser,n="light:"+e,r=t.cache.get(n);if(r)return r;var i,a=t.json,o=((a.extensions&&a.extensions[this.name]||{}).lights||[])[e],s=new nl(16777215);void 0!==o.color&&s.fromArray(o.color);var u=void 0!==o.range?o.range:0;switch(o.type){case"directional":(i=new Rm(s)).target.position.set(0,0,-1),i.add(i.target);break;case"point":(i=new Cm(s)).distance=u;break;case"spot":(i=new Sm(s)).distance=u,o.spot=o.spot||{},o.spot.innerConeAngle=void 0!==o.spot.innerConeAngle?o.spot.innerConeAngle:0,o.spot.outerConeAngle=void 0!==o.spot.outerConeAngle?o.spot.outerConeAngle:Math.PI/4,i.angle=o.spot.outerConeAngle,i.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,i.target.position.set(0,0,-1),i.add(i.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+o.type)}return i.position.set(0,0,0),i.decay=2,void 0!==o.intensity&&(i.intensity=o.intensity),i.name=t.createUniqueName(o.name||"light_"+e),r=Promise.resolve(i),t.cache.add(n,r),r}},{key:"createNodeAttachment",value:function(e){var t=this,n=this.parser,r=n.json.nodes[e],i=(r.extensions&&r.extensions[this.name]||{}).light;return void 0===i?null:this._loadLight(i).then((function(e){return n._getNodeRef(t.cache,i,e)}))}}]),e}(),e_=function(){function e(){(0,u.Z)(this,e),this.name=Qb.KHR_MATERIALS_UNLIT}return(0,l.Z)(e,[{key:"getMaterialType",value:function(){return rl}},{key:"extendParams",value:function(e,t,n){var r=[];e.color=new nl(1,1,1),e.opacity=1;var i=t.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){var a=i.baseColorFactor;e.color.fromArray(a),e.opacity=a[3]}void 0!==i.baseColorTexture&&r.push(n.assignTexture(e,"map",i.baseColorTexture))}return Promise.all(r)}}]),e}(),t_=function(){function e(t){(0,u.Z)(this,e),this.parser=t,this.name=Qb.KHR_MATERIALS_CLEARCOAT}return(0,l.Z)(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Iv:null}},{key:"extendMaterialParams",value:function(e,t){var n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var i=[],a=r.extensions[this.name];if(void 0!==a.clearcoatFactor&&(t.clearcoat=a.clearcoatFactor),void 0!==a.clearcoatTexture&&i.push(n.assignTexture(t,"clearcoatMap",a.clearcoatTexture)),void 0!==a.clearcoatRoughnessFactor&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),void 0!==a.clearcoatRoughnessTexture&&i.push(n.assignTexture(t,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),void 0!==a.clearcoatNormalTexture&&(i.push(n.assignTexture(t,"clearcoatNormalMap",a.clearcoatNormalTexture)),void 0!==a.clearcoatNormalTexture.scale)){var o=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new gs(o,o)}return Promise.all(i)}}]),e}(),n_=function(){function e(t){(0,u.Z)(this,e),this.parser=t,this.name=Qb.KHR_MATERIALS_SHEEN}return(0,l.Z)(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Iv:null}},{key:"extendMaterialParams",value:function(e,t){var n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var i=[];t.sheenColor=new nl(0,0,0),t.sheenRoughness=0,t.sheen=1;var a=r.extensions[this.name];return void 0!==a.sheenColorFactor&&t.sheenColor.fromArray(a.sheenColorFactor),void 0!==a.sheenRoughnessFactor&&(t.sheenRoughness=a.sheenRoughnessFactor),void 0!==a.sheenColorTexture&&i.push(n.assignTexture(t,"sheenColorMap",a.sheenColorTexture)),void 0!==a.sheenRoughnessTexture&&i.push(n.assignTexture(t,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(i)}}]),e}(),r_=function(){function e(t){(0,u.Z)(this,e),this.parser=t,this.name=Qb.KHR_MATERIALS_TRANSMISSION}return(0,l.Z)(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Iv:null}},{key:"extendMaterialParams",value:function(e,t){var n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var i=[],a=r.extensions[this.name];return void 0!==a.transmissionFactor&&(t.transmission=a.transmissionFactor),void 0!==a.transmissionTexture&&i.push(n.assignTexture(t,"transmissionMap",a.transmissionTexture)),Promise.all(i)}}]),e}(),i_=function(){function e(t){(0,u.Z)(this,e),this.parser=t,this.name=Qb.KHR_MATERIALS_VOLUME}return(0,l.Z)(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Iv:null}},{key:"extendMaterialParams",value:function(e,t){var n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var i=[],a=r.extensions[this.name];t.thickness=void 0!==a.thicknessFactor?a.thicknessFactor:0,void 0!==a.thicknessTexture&&i.push(n.assignTexture(t,"thicknessMap",a.thicknessTexture)),t.attenuationDistance=a.attenuationDistance||0;var o=a.attenuationColor||[1,1,1];return t.attenuationColor=new nl(o[0],o[1],o[2]),Promise.all(i)}}]),e}(),a_=function(){function e(t){(0,u.Z)(this,e),this.parser=t,this.name=Qb.KHR_MATERIALS_IOR}return(0,l.Z)(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Iv:null}},{key:"extendMaterialParams",value:function(e,t){var n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();var r=n.extensions[this.name];return t.ior=void 0!==r.ior?r.ior:1.5,Promise.resolve()}}]),e}(),o_=function(){function e(t){(0,u.Z)(this,e),this.parser=t,this.name=Qb.KHR_MATERIALS_SPECULAR}return(0,l.Z)(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Iv:null}},{key:"extendMaterialParams",value:function(e,t){var n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var i=[],a=r.extensions[this.name];t.specularIntensity=void 0!==a.specularFactor?a.specularFactor:1,void 0!==a.specularTexture&&i.push(n.assignTexture(t,"specularIntensityMap",a.specularTexture));var o=a.specularColorFactor||[1,1,1];return t.specularColor=new nl(o[0],o[1],o[2]),void 0!==a.specularColorTexture&&i.push(n.assignTexture(t,"specularColorMap",a.specularColorTexture).then((function(e){e.encoding=_o}))),Promise.all(i)}}]),e}(),s_=function(){function e(t){(0,u.Z)(this,e),this.parser=t,this.name=Qb.KHR_TEXTURE_BASISU}return(0,l.Z)(e,[{key:"loadTexture",value:function(e){var t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;var i=r.extensions[this.name],a=n.images[i.source],o=t.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,a,o)}}]),e}(),u_=function(){function e(t){(0,u.Z)(this,e),this.parser=t,this.name=Qb.EXT_TEXTURE_WEBP,this.isSupported=null}return(0,l.Z)(e,[{key:"loadTexture",value:function(e){var t=this.name,n=this.parser,r=n.json,i=r.textures[e];if(!i.extensions||!i.extensions[t])return null;var a=i.extensions[t],o=r.images[a.source],s=n.textureLoader;if(o.uri){var u=n.options.manager.getHandler(o.uri);null!==u&&(s=u)}return this.detectSupport().then((function(i){if(i)return n.loadTextureImage(e,o,s);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)}))}},{key:"detectSupport",value:function(){return this.isSupported||(this.isSupported=new Promise((function(e){var t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}]),e}(),l_=function(){function e(t){(0,u.Z)(this,e),this.name=Qb.EXT_MESHOPT_COMPRESSION,this.parser=t}return(0,l.Z)(e,[{key:"loadBufferView",value:function(e){var t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){var r=n.extensions[this.name],i=this.parser.getDependency("buffer",r.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([i,a.ready]).then((function(e){var t=r.byteOffset||0,n=r.byteLength||0,i=r.count,o=r.byteStride,s=new ArrayBuffer(i*o),u=new Uint8Array(e[0],t,n);return a.decodeGltfBuffer(new Uint8Array(s),i,o,u,r.mode,r.filter),s}))}return null}}]),e}(),c_="glTF",h_=1313821514,f_=5130562,d_=(0,l.Z)((function e(t){(0,u.Z)(this,e),this.name=Qb.KHR_BINARY_GLTF,this.content=null,this.body=null;var n=new DataView(t,0,12);if(this.header={magic:Om.decodeText(new Uint8Array(t.slice(0,4))),version:n.getUint32(4,!0),length:n.getUint32(8,!0)},this.header.magic!==c_)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var r=this.header.length-12,i=new DataView(t,12),a=0;a<r;){var o=i.getUint32(a,!0);a+=4;var s=i.getUint32(a,!0);if(a+=4,s===h_){var l=new Uint8Array(t,12+a,o);this.content=Om.decodeText(l)}else if(s===f_){var c=12+a;this.body=t.slice(c,c+o)}a+=o}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")})),p_=function(){function e(t,n){if((0,u.Z)(this,e),!n)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Qb.KHR_DRACO_MESH_COMPRESSION,this.json=t,this.dracoLoader=n,this.dracoLoader.preload()}return(0,l.Z)(e,[{key:"decodePrimitive",value:function(e,t){var n=this.json,r=this.dracoLoader,i=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,o={},s={},u={};for(var l in a){var c=D_[l]||l.toLowerCase();o[c]=a[l]}for(var h in e.attributes){var f=D_[h]||h.toLowerCase();if(void 0!==a[h]){var d=n.accessors[e.attributes[h]],p=A_[d.componentType];u[f]=p,s[f]=!0===d.normalized}}return t.getDependency("bufferView",i).then((function(e){return new Promise((function(t){r.decodeDracoFile(e,(function(e){for(var n in e.attributes){var r=e.attributes[n],i=s[n];void 0!==i&&(r.normalized=i)}t(e)}),o,u)}))}))}}]),e}(),v_=function(){function e(){(0,u.Z)(this,e),this.name=Qb.KHR_TEXTURE_TRANSFORM}return(0,l.Z)(e,[{key:"extendTexture",value:function(e,t){return void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}]),e}(),m_=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;(0,u.Z)(this,n),(r=t.call(this)).isGLTFSpecularGlossinessMaterial=!0;var i=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),a=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),o=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),s=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),l=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),h={specular:{value:(new nl).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};return r._extraUniforms=h,r.onBeforeCompile=function(e){for(var t in h)e.uniforms[t]=h[t];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",i).replace("#include <metalnessmap_pars_fragment>",a).replace("#include <roughnessmap_fragment>",o).replace("#include <metalnessmap_fragment>",s).replace("#include <lights_physical_fragment>",l)},Object.defineProperties((0,c.Z)(r),{specular:{get:function(){return h.specular.value},set:function(e){h.specular.value=e}},specularMap:{get:function(){return h.specularMap.value},set:function(e){h.specularMap.value=e,e?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return h.glossiness.value},set:function(e){h.glossiness.value=e}},glossinessMap:{get:function(){return h.glossinessMap.value},set:function(e){h.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete r.metalness,delete r.roughness,delete r.metalnessMap,delete r.roughnessMap,r.setValues(e),r}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}]),n}(Nv),g_=function(){function e(){(0,u.Z)(this,e),this.name=Qb.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"]}return(0,l.Z)(e,[{key:"getMaterialType",value:function(){return m_}},{key:"extendParams",value:function(e,t,n){var r=t.extensions[this.name];e.color=new nl(1,1,1),e.opacity=1;var i=[];if(Array.isArray(r.diffuseFactor)){var a=r.diffuseFactor;e.color.fromArray(a),e.opacity=a[3]}if(void 0!==r.diffuseTexture&&i.push(n.assignTexture(e,"map",r.diffuseTexture)),e.emissive=new nl(0,0,0),e.glossiness=void 0!==r.glossinessFactor?r.glossinessFactor:1,e.specular=new nl(1,1,1),Array.isArray(r.specularFactor)&&e.specular.fromArray(r.specularFactor),void 0!==r.specularGlossinessTexture){var o=r.specularGlossinessTexture;i.push(n.assignTexture(e,"glossinessMap",o)),i.push(n.assignTexture(e,"specularMap",o))}return Promise.all(i)}},{key:"createMaterial",value:function(e){var t=new m_(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=Co,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}]),e}(),y_=(0,l.Z)((function e(){(0,u.Z)(this,e),this.name=Qb.KHR_MESH_QUANTIZATION})),b_=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i,a){return(0,u.Z)(this,n),t.call(this,e,r,i,a)}return(0,l.Z)(n,[{key:"copySampleValue_",value:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r*3+r,a=0;a!==r;a++)t[a]=n[i+a];return t}}]),n}(Hv);b_.prototype.beforeStart_=b_.prototype.copySampleValue_,b_.prototype.afterEnd_=b_.prototype.copySampleValue_,b_.prototype.interpolate_=function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=2*o,u=3*o,l=r-t,c=(n-t)/l,h=c*c,f=h*c,d=e*u,p=d-u,v=-2*f+3*h,m=f-h,g=1-v,y=m-h+c,b=0;b!==o;b++){var _=a[p+b+o],x=a[p+b+s]*l,w=a[d+b+o],S=a[d+b]*l;i[b]=g*_+y*x+v*w+m*S}return i};var __=new Ds,x_=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n,[{key:"interpolate_",value:function(e,t,r,i){var a=wr((0,_r.Z)(n.prototype),"interpolate_",this).call(this,e,t,r,i);return __.fromArray(a).normalize().toArray(a),a}}]),n}(b_),w_=0,S_=1,M_=2,k_=3,T_=4,E_=5,C_=6,A_={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},R_={9728:Oi,9729:Vi,9984:Ui,9985:Gi,9986:zi,9987:Hi},P_={33071:Ni,33648:Ii,10497:Di},L_={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},D_={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},N_={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},I_={CUBICSPLINE:void 0,LINEAR:uo,STEP:so},O_="OPAQUE",U_="MASK",F_="BLEND";function z_(e,t,n){for(var r in n.extensions)void 0===e[r]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[r]=n.extensions[r])}function B_(e,t){void 0!==t.extras&&("object"===typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function V_(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var n=0,r=t.weights.length;n<r;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&Array.isArray(t.extras.targetNames)){var i=t.extras.targetNames;if(e.morphTargetInfluences.length===i.length){e.morphTargetDictionary={};for(var a=0,o=i.length;a<o;a++)e.morphTargetDictionary[i[a]]=a}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function G_(e){var t=e.extensions&&e.extensions[Qb.KHR_DRACO_MESH_COMPRESSION];return t?"draco:"+t.bufferView+":"+t.indices+":"+j_(t.attributes):e.indices+":"+j_(e.attributes)+":"+e.mode}function j_(e){for(var t="",n=Object.keys(e).sort(),r=0,i=n.length;r<i;r++)t+=n[r]+":"+e[n[r]]+";";return t}function H_(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}var W_=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,u.Z)(this,e),this.json=t,this.extensions={},this.plugins={},this.options=n,this.cache=new Jb,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.textureCache={},this.nodeNamesUsed={},"undefined"!==typeof createImageBitmap&&!1===/Firefox/.test(navigator.userAgent)?this.textureLoader=new Hm(this.options.manager):this.textureLoader=new vm(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new lm(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}return(0,l.Z)(e,[{key:"setExtensions",value:function(e){this.extensions=e}},{key:"setPlugins",value:function(e){this.plugins=e}},{key:"parse",value:function(e,t){var n=this,r=this.json,i=this.extensions;this.cache.removeAll(),this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])})).then((function(t){var a={scene:t[0][r.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:r.asset,parser:n,userData:{}};z_(i,a,r),B_(a,r),Promise.all(n._invokeAll((function(e){return e.afterRoot&&e.afterRoot(a)}))).then((function(){e(a)}))})).catch(t)}},{key:"_markDefs",value:function(){for(var e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[],r=0,i=t.length;r<i;r++)for(var a=t[r].joints,o=0,s=a.length;o<s;o++)e[a[o]].isBone=!0;for(var u=0,l=e.length;u<l;u++){var c=e[u];void 0!==c.mesh&&(this._addNodeRef(this.meshCache,c.mesh),void 0!==c.skin&&(n[c.mesh].isSkinnedMesh=!0)),void 0!==c.camera&&this._addNodeRef(this.cameraCache,c.camera)}}},{key:"_addNodeRef",value:function(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}},{key:"_getNodeRef",value:function(e,t,n){var r=this;if(e.refs[t]<=1)return n;var i=n.clone();return function e(t,n){var i=r.associations.get(t);null!=i&&r.associations.set(n,i);var a,o=s(t.children.entries());try{for(o.s();!(a=o.n()).done;){var u=vr(a.value,2),l=u[0];e(u[1],n.children[l])}}catch(c){o.e(c)}finally{o.f()}}(n,i),i.name+="_instance_"+e.uses[t]++,i}},{key:"_invokeOne",value:function(e){var t=Object.values(this.plugins);t.push(this);for(var n=0;n<t.length;n++){var r=e(t[n]);if(r)return r}return null}},{key:"_invokeAll",value:function(e){var t=Object.values(this.plugins);t.unshift(this);for(var n=[],r=0;r<t.length;r++){var i=e(t[r]);i&&n.push(i)}return n}},{key:"getDependency",value:function(e,t){var n=e+":"+t,r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this.loadNode(t);break;case"mesh":r=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":r=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":r=this.loadSkin(t);break;case"animation":r=this.loadAnimation(t);break;case"camera":r=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r}},{key:"getDependencies",value:function(e){var t=this.cache.get(e);if(!t){var n=this,r=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(r.map((function(t,r){return n.getDependency(e,r)}))),this.cache.add(e,t)}return t}},{key:"loadBuffer",value:function(e){var t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[Qb.KHR_BINARY_GLTF].body);var r=this.options;return new Promise((function(e,i){n.load(Om.resolveURL(t.uri,r.path),e,void 0,(function(){i(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))}},{key:"loadBufferView",value:function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){var n=t.byteLength||0,r=t.byteOffset||0;return e.slice(r,r+n)}))}},{key:"loadAccessor",value:function(e){var t=this,n=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse)return Promise.resolve(null);var i=[];return void 0!==r.bufferView?i.push(this.getDependency("bufferView",r.bufferView)):i.push(null),void 0!==r.sparse&&(i.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(i).then((function(e){var i,a,o=e[0],s=L_[r.type],u=A_[r.componentType],l=u.BYTES_PER_ELEMENT,c=l*s,h=r.byteOffset||0,f=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,d=!0===r.normalized;if(f&&f!==c){var p=Math.floor(h/f),v="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+p+":"+r.count,m=t.cache.get(v);m||(i=new u(o,p*f,r.count*f/l),m=new id(i,f/l),t.cache.add(v,m)),a=new od(m,s,h%f/l,d)}else i=null===o?new u(r.count*s):new u(o,h,r.count*s),a=new ol(i,s,d);if(void 0!==r.sparse){var g=L_.SCALAR,y=A_[r.sparse.indices.componentType],b=r.sparse.indices.byteOffset||0,_=r.sparse.values.byteOffset||0,x=new y(e[1],b,r.sparse.count*g),w=new u(e[2],_,r.sparse.count*s);null!==o&&(a=new ol(a.array.slice(),a.itemSize,a.normalized));for(var S=0,M=x.length;S<M;S++){var k=x[S];if(a.setX(k,w[S*s]),s>=2&&a.setY(k,w[S*s+1]),s>=3&&a.setZ(k,w[S*s+2]),s>=4&&a.setW(k,w[S*s+3]),s>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return a}))}},{key:"loadTexture",value:function(e){var t=this.json,n=this.options,r=t.textures[e],i=t.images[r.source],a=this.textureLoader;if(i.uri){var o=n.manager.getHandler(i.uri);null!==o&&(a=o)}return this.loadTextureImage(e,i,a)}},{key:"loadTextureImage",value:function(e,t,n){var r=this,i=this.json,a=this.options,o=i.textures[e],s=(t.uri||t.bufferView)+":"+o.sampler;if(this.textureCache[s])return this.textureCache[s];var u=self.URL||self.webkitURL,l=t.uri||"",c=!1;if(void 0!==t.bufferView)l=r.getDependency("bufferView",t.bufferView).then((function(e){c=!0;var n=new Blob([e],{type:t.mimeType});return l=u.createObjectURL(n)}));else if(void 0===t.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");var h=Promise.resolve(l).then((function(e){return new Promise((function(t,r){var i=t;!0===n.isImageBitmapLoader&&(i=function(e){var n=new Es(e);n.needsUpdate=!0,t(n)}),n.load(Om.resolveURL(e,a.path),i,void 0,r)}))})).then((function(t){!0===c&&u.revokeObjectURL(l),t.flipY=!1,o.name&&(t.name=o.name);var n=(i.samplers||{})[o.sampler]||{};return t.magFilter=R_[n.magFilter]||Vi,t.minFilter=R_[n.minFilter]||Hi,t.wrapS=P_[n.wrapS]||Di,t.wrapT=P_[n.wrapT]||Di,r.associations.set(t,{textures:e}),t})).catch((function(){return console.error("THREE.GLTFLoader: Couldn't load texture",l),null}));return this.textureCache[s]=h,h}},{key:"assignTexture",value:function(e,t,n){var r=this;return this.getDependency("texture",n.index).then((function(i){if(void 0===n.texCoord||0==n.texCoord||"aoMap"===t&&1==n.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),r.extensions[Qb.KHR_TEXTURE_TRANSFORM]){var a=void 0!==n.extensions?n.extensions[Qb.KHR_TEXTURE_TRANSFORM]:void 0;if(a){var o=r.associations.get(i);i=r.extensions[Qb.KHR_TEXTURE_TRANSFORM].extendTexture(i,a),r.associations.set(i,o)}}return e[t]=i,i}))}},{key:"assignFinalMaterial",value:function(e){var t=e.geometry,n=e.material,r=void 0===t.attributes.tangent,i=void 0!==t.attributes.color,a=void 0===t.attributes.normal;if(e.isPoints){var o="PointsMaterial:"+n.uuid,s=this.cache.get(o);s||(s=new ep,Yu.prototype.copy.call(s,n),s.color.copy(n.color),s.map=n.map,s.sizeAttenuation=!1,this.cache.add(o,s)),n=s}else if(e.isLine){var u="LineBasicMaterial:"+n.uuid,l=this.cache.get(u);l||(l=new jd,Yu.prototype.copy.call(l,n),l.color.copy(n.color),this.cache.add(u,l)),n=l}if(r||i||a){var c="ClonedMaterial:"+n.uuid+":";n.isGLTFSpecularGlossinessMaterial&&(c+="specular-glossiness:"),r&&(c+="derivative-tangents:"),i&&(c+="vertex-colors:"),a&&(c+="flat-shading:");var h=this.cache.get(c);h||(h=n.clone(),i&&(h.vertexColors=!0),a&&(h.flatShading=!0),r&&(h.normalScale&&(h.normalScale.y*=-1),h.clearcoatNormalScale&&(h.clearcoatNormalScale.y*=-1)),this.cache.add(c,h),this.associations.set(h,this.associations.get(n))),n=h}n.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=n}},{key:"getMaterialType",value:function(){return Nv}},{key:"loadMaterial",value:function(e){var t,n=this,r=this.json,i=this.extensions,a=r.materials[e],o={},s=a.extensions||{},u=[];if(s[Qb.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var l=i[Qb.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=l.getMaterialType(),u.push(l.extendParams(o,a,n))}else if(s[Qb.KHR_MATERIALS_UNLIT]){var c=i[Qb.KHR_MATERIALS_UNLIT];t=c.getMaterialType(),u.push(c.extendParams(o,a,n))}else{var h=a.pbrMetallicRoughness||{};if(o.color=new nl(1,1,1),o.opacity=1,Array.isArray(h.baseColorFactor)){var f=h.baseColorFactor;o.color.fromArray(f),o.opacity=f[3]}void 0!==h.baseColorTexture&&u.push(n.assignTexture(o,"map",h.baseColorTexture)),o.metalness=void 0!==h.metallicFactor?h.metallicFactor:1,o.roughness=void 0!==h.roughnessFactor?h.roughnessFactor:1,void 0!==h.metallicRoughnessTexture&&(u.push(n.assignTexture(o,"metalnessMap",h.metallicRoughnessTexture)),u.push(n.assignTexture(o,"roughnessMap",h.metallicRoughnessTexture))),t=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)})),u.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,o)}))))}!0===a.doubleSided&&(o.side=Fr);var d=a.alphaMode||O_;if(d===F_?(o.transparent=!0,o.depthWrite=!1):(o.format=aa,o.transparent=!1,d===U_&&(o.alphaTest=void 0!==a.alphaCutoff?a.alphaCutoff:.5)),void 0!==a.normalTexture&&t!==rl&&(u.push(n.assignTexture(o,"normalMap",a.normalTexture)),o.normalScale=new gs(1,1),void 0!==a.normalTexture.scale)){var p=a.normalTexture.scale;o.normalScale.set(p,p)}return void 0!==a.occlusionTexture&&t!==rl&&(u.push(n.assignTexture(o,"aoMap",a.occlusionTexture)),void 0!==a.occlusionTexture.strength&&(o.aoMapIntensity=a.occlusionTexture.strength)),void 0!==a.emissiveFactor&&t!==rl&&(o.emissive=(new nl).fromArray(a.emissiveFactor)),void 0!==a.emissiveTexture&&t!==rl&&u.push(n.assignTexture(o,"emissiveMap",a.emissiveTexture)),Promise.all(u).then((function(){var r;return r=t===m_?i[Qb.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(o):new t(o),a.name&&(r.name=a.name),r.map&&(r.map.encoding=_o),r.emissiveMap&&(r.emissiveMap.encoding=_o),B_(r,a),n.associations.set(r,{materials:e}),a.extensions&&z_(i,r,a),r}))}},{key:"createUniqueName",value:function(e){for(var t=kg.sanitizeNodeName(e||""),n=t,r=1;this.nodeNamesUsed[n];++r)n=t+"_"+r;return this.nodeNamesUsed[n]=!0,n}},{key:"loadGeometries",value:function(e){var t=this,n=this.extensions,r=this.primitiveCache;function i(e){return n[Qb.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(n){return q_(n,e,t)}))}for(var a=[],o=0,s=e.length;o<s;o++){var u=e[o],l=G_(u),c=r[l];if(c)a.push(c.promise);else{var h=void 0;h=u.extensions&&u.extensions[Qb.KHR_DRACO_MESH_COMPRESSION]?i(u):q_(new Ml,u,t),r[l]={primitive:u,promise:h},a.push(h)}}return Promise.all(a)}},{key:"loadMesh",value:function(e){for(var t,n=this,r=this.json,i=this.extensions,a=r.meshes[e],o=a.primitives,s=[],u=0,l=o.length;u<l;u++){var c=void 0===o[u].material?(void 0===(t=this.cache).DefaultMaterial&&(t.DefaultMaterial=new Nv({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Or})),t.DefaultMaterial):this.getDependency("material",o[u].material);s.push(c)}return s.push(n.loadGeometries(o)),Promise.all(s).then((function(t){for(var r=t.slice(0,t.length-1),s=t[t.length-1],u=[],l=0,c=s.length;l<c;l++){var h=s[l],f=o[l],d=void 0,p=r[l];if(f.mode===T_||f.mode===E_||f.mode===C_||void 0===f.mode)!0!==(d=!0===a.isSkinnedMesh?new Pd(h,p):new Gl(h,p)).isSkinnedMesh||d.geometry.attributes.skinWeight.normalized||d.normalizeSkinWeights(),f.mode===E_?d.geometry=X_(d.geometry,go):f.mode===C_&&(d.geometry=X_(d.geometry,yo));else if(f.mode===S_)d=new Qd(h,p);else if(f.mode===k_)d=new Yd(h,p);else if(f.mode===M_)d=new $d(h,p);else{if(f.mode!==w_)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+f.mode);d=new ap(h,p)}Object.keys(d.geometry.morphAttributes).length>0&&V_(d,a),d.name=n.createUniqueName(a.name||"mesh_"+e),B_(d,a),f.extensions&&z_(i,d,f),n.assignFinalMaterial(d),u.push(d)}for(var v=0,m=u.length;v<m;v++)n.associations.set(u[v],{meshes:e,primitives:v});if(1===u.length)return u[0];var g=new Zf;n.associations.set(g,{meshes:e});for(var y=0,b=u.length;y<b;y++)g.add(u[y]);return g}))}},{key:"loadCamera",value:function(e){var t,n=this.json.cameras[e],r=n[n.type];if(r)return"perspective"===n.type?t=new Kl(ms.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(t=new _c(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),B_(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}},{key:"loadSkin",value:function(e){var t=this.json.skins[e],n={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return n.inverseBindMatrices=e,n}))}},{key:"loadAnimation",value:function(e){for(var t=this.json.animations[e],n=[],r=[],i=[],a=[],o=[],s=0,u=t.channels.length;s<u;s++){var l=t.channels[s],c=t.samplers[l.sampler],h=l.target,f=void 0!==h.node?h.node:h.id,d=void 0!==t.parameters?t.parameters[c.input]:c.input,p=void 0!==t.parameters?t.parameters[c.output]:c.output;n.push(this.getDependency("node",f)),r.push(this.getDependency("accessor",d)),i.push(this.getDependency("accessor",p)),a.push(c),o.push(h)}return Promise.all([Promise.all(n),Promise.all(r),Promise.all(i),Promise.all(a),Promise.all(o)]).then((function(n){for(var r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],u=[],l=function(){var e,t=r[c],n=i[c],l=a[c],h=o[c],f=s[c];if(void 0===t)return 1;switch(t.updateMatrix(),t.matrixAutoUpdate=!0,N_[f.path]){case N_.weights:e=Jv;break;case N_.rotation:e=$v;break;default:e=tm}var d=t.name?t.name:t.uuid,p=void 0!==h.interpolation?I_[h.interpolation]:uo,v=[];N_[f.path]===N_.weights?t.traverse((function(e){e.morphTargetInfluences&&v.push(e.name?e.name:e.uuid)})):v.push(d);var m=l.array;if(l.normalized){for(var g=H_(m.constructor),y=new Float32Array(m.length),b=0,_=m.length;b<_;b++)y[b]=m[b]*g;m=y}for(var x=0,w=v.length;x<w;x++){var S=new e(v[x]+"."+N_[f.path],n.array,m,p);"CUBICSPLINE"===h.interpolation&&(S.createInterpolant=function(e){return new(this instanceof $v?x_:b_)(this.times,this.values,this.getValueSize()/3,e)},S.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),u.push(S)}},c=0,h=r.length;c<h;c++)l();var f=t.name?t.name:"animation_"+e;return new nm(f,void 0,u)}))}},{key:"createNodeMesh",value:function(e){var t=this.json,n=this,r=t.nodes[e];return void 0===r.mesh?null:n.getDependency("mesh",r.mesh).then((function(e){var t=n._getNodeRef(n.meshCache,r.mesh,e);return void 0!==r.weights&&t.traverse((function(e){if(e.isMesh)for(var t=0,n=r.weights.length;t<n;t++)e.morphTargetInfluences[t]=r.weights[t]})),t}))}},{key:"loadNode",value:function(e){var t=this.json,n=this.extensions,r=this,i=t.nodes[e],a=i.name?r.createUniqueName(i.name):"";return function(){var t=[],n=r._invokeOne((function(t){return t.createNodeMesh&&t.createNodeMesh(e)}));return n&&t.push(n),void 0!==i.camera&&t.push(r.getDependency("camera",i.camera).then((function(e){return r._getNodeRef(r.cameraCache,i.camera,e)}))),r._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){t.push(e)})),Promise.all(t)}().then((function(t){var o;if((o=!0===i.isBone?new Ld:t.length>1?new Zf:1===t.length?t[0]:new Ou)!==t[0])for(var s=0,u=t.length;s<u;s++)o.add(t[s]);if(i.name&&(o.userData.name=i.name,o.name=a),B_(o,i),i.extensions&&z_(n,o,i),void 0!==i.matrix){var l=new hu;l.fromArray(i.matrix),o.applyMatrix4(l)}else void 0!==i.translation&&o.position.fromArray(i.translation),void 0!==i.rotation&&o.quaternion.fromArray(i.rotation),void 0!==i.scale&&o.scale.fromArray(i.scale);return r.associations.has(o)||r.associations.set(o,{}),r.associations.get(o).nodes=e,o}))}},{key:"loadScene",value:function(e){var t=this.json,n=this.extensions,r=this.json.scenes[e],i=this,a=new Zf;r.name&&(a.name=i.createUniqueName(r.name)),B_(a,r),r.extensions&&z_(n,a,r);for(var o=r.nodes||[],u=[],l=0,c=o.length;l<c;l++)u.push(Z_(o[l],a,t,i));return Promise.all(u).then((function(){return i.associations=function(e){var t,n=new Map,r=s(i.associations);try{for(r.s();!(t=r.n()).done;){var a=vr(t.value,2),o=a[0],u=a[1];(o instanceof Yu||o instanceof Es)&&n.set(o,u)}}catch(l){r.e(l)}finally{r.f()}return e.traverse((function(e){var t=i.associations.get(e);null!=t&&n.set(e,t)})),n}(a),a}))}}]),e}();function Z_(e,t,n,r){var i=n.nodes[e];return r.getDependency("node",e).then((function(e){return void 0===i.skin?e:r.getDependency("skin",i.skin).then((function(e){for(var n=[],i=0,a=(t=e).joints.length;i<a;i++)n.push(r.getDependency("node",t.joints[i]));return Promise.all(n)})).then((function(n){return e.traverse((function(e){if(e.isMesh){for(var r=[],i=[],a=0,o=n.length;a<o;a++){var s=n[a];if(s){r.push(s);var u=new hu;void 0!==t.inverseBindMatrices&&u.fromArray(t.inverseBindMatrices.array,16*a),i.push(u)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[a])}e.bind(new Od(r,i),e.matrixWorld)}})),e}));var t})).then((function(e){t.add(e);var a=[];if(i.children)for(var o=i.children,s=0,u=o.length;s<u;s++){var l=o[s];a.push(Z_(l,e,n,r))}return Promise.all(a)}))}function q_(e,t,n){var r=t.attributes,i=[];function a(t,r){return n.getDependency("accessor",t).then((function(t){e.setAttribute(r,t)}))}for(var o in r){var s=D_[o]||o.toLowerCase();s in e.attributes||i.push(a(r[o],s))}if(void 0!==t.indices&&!e.index){var u=n.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));i.push(u)}return B_(e,t),function(e,t,n){var r=t.attributes,i=new Us;if(void 0!==r.POSITION){var a=n.json.accessors[r.POSITION],o=a.min,s=a.max;if(void 0!==o&&void 0!==s){if(i.set(new Ns(o[0],o[1],o[2]),new Ns(s[0],s[1],s[2])),a.normalized){var u=H_(A_[a.componentType]);i.min.multiplyScalar(u),i.max.multiplyScalar(u)}var l=t.targets;if(void 0!==l){for(var c=new Ns,h=new Ns,f=0,d=l.length;f<d;f++){var p=l[f];if(void 0!==p.POSITION){var v=n.json.accessors[p.POSITION],m=v.min,g=v.max;if(void 0!==m&&void 0!==g){if(h.setX(Math.max(Math.abs(m[0]),Math.abs(g[0]))),h.setY(Math.max(Math.abs(m[1]),Math.abs(g[1]))),h.setZ(Math.max(Math.abs(m[2]),Math.abs(g[2]))),v.normalized){var y=H_(A_[v.componentType]);h.multiplyScalar(y)}c.max(h)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(c)}e.boundingBox=i;var b=new nu;i.getCenter(b.center),b.radius=i.min.distanceTo(i.max)/2,e.boundingSphere=b}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}(e,t,n),Promise.all(i).then((function(){return void 0!==t.targets?function(e,t,n){for(var r=!1,i=!1,a=0,o=t.length;a<o;a++){var s=t[a];if(void 0!==s.POSITION&&(r=!0),void 0!==s.NORMAL&&(i=!0),r&&i)break}if(!r&&!i)return Promise.resolve(e);for(var u=[],l=[],c=0,h=t.length;c<h;c++){var f=t[c];if(r){var d=void 0!==f.POSITION?n.getDependency("accessor",f.POSITION):e.attributes.position;u.push(d)}if(i){var p=void 0!==f.NORMAL?n.getDependency("accessor",f.NORMAL):e.attributes.normal;l.push(p)}}return Promise.all([Promise.all(u),Promise.all(l)]).then((function(t){var n=t[0],a=t[1];return r&&(e.morphAttributes.position=n),i&&(e.morphAttributes.normal=a),e.morphTargetsRelative=!0,e}))}(e,t.targets,n):e}))}function X_(e,t){var n=e.getIndex();if(null===n){var r=[],i=e.getAttribute("position");if(void 0===i)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(var a=0;a<i.count;a++)r.push(a);e.setIndex(r),n=e.getIndex()}var o=n.count-2,s=[];if(t===yo)for(var u=1;u<=o;u++)s.push(n.getX(0)),s.push(n.getX(u)),s.push(n.getX(u+1));else for(var l=0;l<o;l++)l%2===0?(s.push(n.getX(l)),s.push(n.getX(l+1)),s.push(n.getX(l+2))):(s.push(n.getX(l+2)),s.push(n.getX(l+1)),s.push(n.getX(l)));s.length/3!==o&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var c=e.clone();return c.setIndex(s),c}var Y_=n(9611);var K_,J_,Q_=n(8814);function $_(e,t,n){return $_=(0,Q_.Z)()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&(0,Y_.Z)(i,n.prototype),i},$_.apply(null,arguments)}function ex(e){var t="function"===typeof Map?new Map:void 0;return ex=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return $_(e,arguments,(0,_r.Z)(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),(0,Y_.Z)(r,e)},ex(e)}var tx="152",nx=100,rx=301,ix=302,ax=303,ox=304,sx=306,ux=1e3,lx=1001,cx=1002,hx=1003,fx=1004,dx=1005,px=1006,vx=1008,mx=1009,gx=1012,yx=1014,bx=1015,_x=1016,xx=1020,wx=1023,Sx=1026,Mx=1027,kx=33776,Tx=33777,Ex=33778,Cx=33779,Ax=35840,Rx=35841,Px=35842,Lx=35843,Dx=37492,Nx=37496,Ix=37808,Ox=37809,Ux=37810,Fx=37811,zx=37812,Bx=37813,Vx=37814,Gx=37815,jx=37816,Hx=37817,Wx=37818,Zx=37819,qx=37820,Xx=37821,Yx=36492,Kx=36284,Jx=36285,Qx=36286,$x=2300,ew=2301,tw=2302,nw=2400,rw=2401,iw=2402,aw=2500,ow=3001,sw="",uw="srgb",lw="srgb-linear",cw="display-p3",hw=7680,fw=35044,dw="300 es",pw=1035,vw=function(){function e(){(0,u.Z)(this,e)}return(0,l.Z)(e,[{key:"addEventListener",value:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}},{key:"hasEventListener",value:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}},{key:"removeEventListener",value:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}}},{key:"dispatchEvent",value:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=t.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,e);e.target=null}}}}]),e}(),mw=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],gw=1234567,yw=Math.PI/180,bw=180/Math.PI;function _w(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(mw[255&e]+mw[e>>8&255]+mw[e>>16&255]+mw[e>>24&255]+"-"+mw[255&t]+mw[t>>8&255]+"-"+mw[t>>16&15|64]+mw[t>>24&255]+"-"+mw[63&n|128]+mw[n>>8&255]+"-"+mw[n>>16&255]+mw[n>>24&255]+mw[255&r]+mw[r>>8&255]+mw[r>>16&255]+mw[r>>24&255]).toLowerCase()}function xw(e,t,n){return Math.max(t,Math.min(n,e))}function ww(e,t){return(e%t+t)%t}function Sw(e,t,n){return(1-n)*e+n*t}function Mw(e){return 0===(e&e-1)&&0!==e}function kw(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function Tw(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function Ew(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function Cw(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}var Aw={DEG2RAD:yw,RAD2DEG:bw,generateUUID:_w,clamp:xw,euclideanModulo:ww,mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:Sw,damp:function(e,t,n,r){return Sw(e,t,1-Math.exp(-n*r))},pingpong:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(ww(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(gw=e);var t=gw+=1831565813;return t=Math.imul(t^t>>>15,1|t),(((t^=t+Math.imul(t^t>>>7,61|t))^t>>>14)>>>0)/4294967296},degToRad:function(e){return e*yw},radToDeg:function(e){return e*bw},isPowerOfTwo:Mw,ceilPowerOfTwo:kw,floorPowerOfTwo:Tw,setQuaternionFromProperEuler:function(e,t,n,r,i){var a=Math.cos,o=Math.sin,s=a(n/2),u=o(n/2),l=a((t+r)/2),c=o((t+r)/2),h=a((t-r)/2),f=o((t-r)/2),d=a((r-t)/2),p=o((r-t)/2);switch(i){case"XYX":e.set(s*c,u*h,u*f,s*l);break;case"YZY":e.set(u*f,s*c,u*h,s*l);break;case"ZXZ":e.set(u*h,u*f,s*c,s*l);break;case"XZX":e.set(s*c,u*p,u*d,s*l);break;case"YXY":e.set(u*d,s*c,u*p,s*l);break;case"ZYZ":e.set(u*p,u*d,s*c,s*l);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}},normalize:Cw,denormalize:Ew},Rw=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,u.Z)(this,t),t.prototype.isVector2=!0,this.x=e,this.y=n}return(0,l.Z)(t,[{key:"width",get:function(){return this.x},set:function(e){this.x=e}},{key:"height",get:function(){return this.y},set:function(e){this.y=e}},{key:"set",value:function(e,t){return this.x=e,this.y=t,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}},{key:"sub",value:function(e){return this.x-=e.x,this.y-=e.y,this}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y}},{key:"cross",value:function(e){return this.x*e.y-this.y*e.x}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"angle",value:function(){var e=Math.atan2(-this.y,-this.x)+Math.PI;return e}},{key:"angleTo",value:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;var n=this.dot(e)/t;return Math.acos(xw(n,-1,1))}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n}},{key:"manhattanDistanceTo",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}},{key:"fromBufferAttribute",value:function(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}},{key:"rotateAround",value:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*n-a*r+e.x,this.y=i*r+a*n+e.y,this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this}},{key:e,value:fr().mark((function e(){return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.x;case 2:return e.next=4,this.y;case 4:case"end":return e.stop()}}),e,this)}))}]),t}(Symbol.iterator),Pw=function(){function e(){(0,u.Z)(this,e),e.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}return(0,l.Z)(e,[{key:"set",value:function(e,t,n,r,i,a,o,s,u){var l=this.elements;return l[0]=e,l[1]=r,l[2]=o,l[3]=t,l[4]=i,l[5]=s,l[6]=n,l[7]=a,l[8]=u,this}},{key:"identity",value:function(){return this.set(1,0,0,0,1,0,0,0,1),this}},{key:"copy",value:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}},{key:"extractBasis",value:function(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}},{key:"setFromMatrix4",value:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}},{key:"multiply",value:function(e){return this.multiplyMatrices(this,e)}},{key:"premultiply",value:function(e){return this.multiplyMatrices(e,this)}},{key:"multiplyMatrices",value:function(e,t){var n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[3],s=n[6],u=n[1],l=n[4],c=n[7],h=n[2],f=n[5],d=n[8],p=r[0],v=r[3],m=r[6],g=r[1],y=r[4],b=r[7],_=r[2],x=r[5],w=r[8];return i[0]=a*p+o*g+s*_,i[3]=a*v+o*y+s*x,i[6]=a*m+o*b+s*w,i[1]=u*p+l*g+c*_,i[4]=u*v+l*y+c*x,i[7]=u*m+l*b+c*w,i[2]=h*p+f*g+d*_,i[5]=h*v+f*y+d*x,i[8]=h*m+f*b+d*w,this}},{key:"multiplyScalar",value:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}},{key:"determinant",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],l=e[8];return t*a*l-t*o*u-n*i*l+n*o*s+r*i*u-r*a*s}},{key:"invert",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],l=e[8],c=l*a-o*u,h=o*s-l*i,f=u*i-a*s,d=t*c+n*h+r*f;if(0===d)return this.set(0,0,0,0,0,0,0,0,0);var p=1/d;return e[0]=c*p,e[1]=(r*u-l*n)*p,e[2]=(o*n-r*a)*p,e[3]=h*p,e[4]=(l*t-r*s)*p,e[5]=(r*i-o*t)*p,e[6]=f*p,e[7]=(n*s-u*t)*p,e[8]=(a*t-n*i)*p,this}},{key:"transpose",value:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}},{key:"getNormalMatrix",value:function(e){return this.setFromMatrix4(e).invert().transpose()}},{key:"transposeIntoArray",value:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}},{key:"setUvTransform",value:function(e,t,n,r,i,a,o){var s=Math.cos(i),u=Math.sin(i);return this.set(n*s,n*u,-n*(s*a+u*o)+a+e,-r*u,r*s,-r*(-u*a+s*o)+o+t,0,0,1),this}},{key:"scale",value:function(e,t){return this.premultiply(Lw.makeScale(e,t)),this}},{key:"rotate",value:function(e){return this.premultiply(Lw.makeRotation(-e)),this}},{key:"translate",value:function(e,t){return this.premultiply(Lw.makeTranslation(e,t)),this}},{key:"makeTranslation",value:function(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}},{key:"makeRotation",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}},{key:"makeScale",value:function(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}},{key:"equals",value:function(e){for(var t=this.elements,n=e.elements,r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<9;n++)this.elements[n]=e[n+t];return this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}},{key:"clone",value:function(){return(new this.constructor).fromArray(this.elements)}}]),e}(),Lw=new Pw;function Dw(e){for(var t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;function Nw(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}var Iw={};function Ow(e){e in Iw||(Iw[e]=!0,console.warn(e))}function Uw(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function Fw(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}var zw=(new Pw).fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),Bw=(new Pw).fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]);var Vw,Gw=(gr(K_={},lw,(function(e){return e})),gr(K_,uw,(function(e){return e.convertSRGBToLinear()})),gr(K_,cw,(function(e){return e.convertSRGBToLinear().applyMatrix3(Bw)})),K_),jw=(gr(J_={},lw,(function(e){return e})),gr(J_,uw,(function(e){return e.convertLinearToSRGB()})),gr(J_,cw,(function(e){return e.applyMatrix3(zw).convertLinearToSRGB()})),J_),Hw={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(e){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!e},get workingColorSpace(){return lw},set workingColorSpace(e){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(e,t,n){if(!1===this.enabled||t===n||!t||!n)return e;var r=Gw[t],i=jw[n];if(void 0===r||void 0===i)throw new Error('Unsupported color space conversion, "'.concat(t,'" to "').concat(n,'".'));return i(r(e))},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}},Ww=function(){function e(){(0,u.Z)(this,e)}return(0,l.Z)(e,null,[{key:"getDataURL",value:function(e){if(/^data:/i.test(e.src))return e.src;if("undefined"===typeof HTMLCanvasElement)return e.src;var t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Vw&&(Vw=Nw("canvas")),Vw.width=e.width,Vw.height=e.height;var n=Vw.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Vw}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}},{key:"sRGBToLinear",value:function(e){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap){var t=Nw("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);for(var r=n.getImageData(0,0,e.width,e.height),i=r.data,a=0;a<i.length;a++)i[a]=255*Uw(i[a]/255);return n.putImageData(r,0,0),t}if(e.data){for(var o=e.data.slice(0),s=0;s<o.length;s++)o instanceof Uint8Array||o instanceof Uint8ClampedArray?o[s]=Math.floor(255*Uw(o[s]/255)):o[s]=Uw(o[s]);return{data:o,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}]),e}(),Zw=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(0,u.Z)(this,e),this.isSource=!0,this.uuid=_w(),this.data=t,this.version=0}return(0,l.Z)(e,[{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"toJSON",value:function(e){var t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];var n={uuid:this.uuid,url:""},r=this.data;if(null!==r){var i;if(Array.isArray(r)){i=[];for(var a=0,o=r.length;a<o;a++)r[a].isDataTexture?i.push(qw(r[a].image)):i.push(qw(r[a]))}else i=qw(r);n.url=i}return t||(e.images[this.uuid]=n),n}}]),e}();function qw(e){return"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap?Ww.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var Xw=0,Yw=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.DEFAULT_IMAGE,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.DEFAULT_MAPPING,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:lx,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:lx,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:px,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:vx,h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:wx,f=arguments.length>7&&void 0!==arguments[7]?arguments[7]:mx,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:n.DEFAULT_ANISOTROPY,p=arguments.length>9&&void 0!==arguments[9]?arguments[9]:sw;return(0,u.Z)(this,n),(e=t.call(this)).isTexture=!0,Object.defineProperty((0,c.Z)(e),"id",{value:Xw++}),e.uuid=_w(),e.name="",e.source=new Zw(r),e.mipmaps=[],e.mapping=i,e.channel=0,e.wrapS=a,e.wrapT=o,e.magFilter=s,e.minFilter=l,e.anisotropy=d,e.format=h,e.internalFormat=null,e.type=f,e.offset=new Rw(0,0),e.repeat=new Rw(1,1),e.center=new Rw(0,0),e.rotation=0,e.matrixAutoUpdate=!0,e.matrix=new Pw,e.generateMipmaps=!0,e.premultiplyAlpha=!1,e.flipY=!0,e.unpackAlignment=4,"string"===typeof p?e.colorSpace=p:(Ow("THREE.Texture: Property .encoding has been replaced by .colorSpace."),e.colorSpace=p===ow?uw:sw),e.userData={},e.version=0,e.onUpdate=null,e.isRenderTargetTexture=!1,e.needsPMREMUpdate=!1,e}return(0,l.Z)(n,[{key:"image",get:function(){return this.source.data},set:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.source.data=e}},{key:"updateMatrix",value:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}},{key:"toJSON",value:function(e){var t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}},{key:"transformUv",value:function(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case ux:e.x=e.x-Math.floor(e.x);break;case lx:e.x=e.x<0?0:1;break;case cx:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case ux:e.y=e.y-Math.floor(e.y);break;case lx:e.y=e.y<0?0:1;break;case cx:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}},{key:"needsUpdate",set:function(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}},{key:"encoding",get:function(){return Ow("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===uw?ow:3e3},set:function(e){Ow("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===ow?uw:sw}}]),n}(vw);Yw.DEFAULT_IMAGE=null,Yw.DEFAULT_MAPPING=300,Yw.DEFAULT_ANISOTROPY=1;var Kw=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;(0,u.Z)(this,t),t.prototype.isVector4=!0,this.x=e,this.y=n,this.z=r,this.w=i}return(0,l.Z)(t,[{key:"width",get:function(){return this.z},set:function(e){this.z=e}},{key:"height",get:function(){return this.w},set:function(e){this.w=e}},{key:"set",value:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setW",value:function(e){return this.w=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z,this.w)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}},{key:"sub",value:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,r=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*i,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"setAxisAngleFromQuaternion",value:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}},{key:"setAxisAngleFromRotationMatrix",value:function(e){var t,n,r,i,a=.01,o=.1,s=e.elements,u=s[0],l=s[4],c=s[8],h=s[1],f=s[5],d=s[9],p=s[2],v=s[6],m=s[10];if(Math.abs(l-h)<a&&Math.abs(c-p)<a&&Math.abs(d-v)<a){if(Math.abs(l+h)<o&&Math.abs(c+p)<o&&Math.abs(d+v)<o&&Math.abs(u+f+m-3)<o)return this.set(1,0,0,0),this;t=Math.PI;var g=(u+1)/2,y=(f+1)/2,b=(m+1)/2,_=(l+h)/4,x=(c+p)/4,w=(d+v)/4;return g>y&&g>b?g<a?(n=0,r=.707106781,i=.707106781):(r=_/(n=Math.sqrt(g)),i=x/n):y>b?y<a?(n=.707106781,r=0,i=.707106781):(n=_/(r=Math.sqrt(y)),i=w/r):b<a?(n=.707106781,r=.707106781,i=0):(n=x/(i=Math.sqrt(b)),r=w/i),this.set(n,r,i,t),this}var S=Math.sqrt((v-d)*(v-d)+(c-p)*(c-p)+(h-l)*(h-l));return Math.abs(S)<.001&&(S=1),this.x=(v-d)/S,this.y=(c-p)/S,this.z=(h-l)/S,this.w=Math.acos((u+f+m-1)/2),this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}},{key:"fromBufferAttribute",value:function(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}},{key:e,value:fr().mark((function e(){return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.x;case 2:return e.next=4,this.y;case 4:return e.next=6,this.z;case 6:return e.next=8,this.w;case 8:case"end":return e.stop()}}),e,this)}))}]),t}(Symbol.iterator),Jw=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,u.Z)(this,n),(e=t.call(this)).isWebGLRenderTarget=!0,e.width=r,e.height=i,e.depth=1,e.scissor=new Kw(0,0,r,i),e.scissorTest=!1,e.viewport=new Kw(0,0,r,i);var o={width:r,height:i,depth:1};return void 0!==a.encoding&&(Ow("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),a.colorSpace=a.encoding===ow?uw:sw),e.texture=new Yw(o,a.mapping,a.wrapS,a.wrapT,a.magFilter,a.minFilter,a.format,a.type,a.anisotropy,a.colorSpace),e.texture.isRenderTargetTexture=!0,e.texture.flipY=!1,e.texture.generateMipmaps=void 0!==a.generateMipmaps&&a.generateMipmaps,e.texture.internalFormat=void 0!==a.internalFormat?a.internalFormat:null,e.texture.minFilter=void 0!==a.minFilter?a.minFilter:px,e.depthBuffer=void 0===a.depthBuffer||a.depthBuffer,e.stencilBuffer=void 0!==a.stencilBuffer&&a.stencilBuffer,e.depthTexture=void 0!==a.depthTexture?a.depthTexture:null,e.samples=void 0!==a.samples?a.samples:0,e}return(0,l.Z)(n,[{key:"setSize",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.width===e&&this.height===t&&this.depth===n||(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;var t=Object.assign({},e.texture.image);return this.texture.source=new Zw(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),n}(vw),Qw=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return(0,u.Z)(this,n),(e=t.call(this,null)).isDataArrayTexture=!0,e.image={data:r,width:i,height:a,depth:o},e.magFilter=hx,e.minFilter=hx,e.wrapR=lx,e.generateMipmaps=!1,e.flipY=!1,e.unpackAlignment=1,e}return(0,l.Z)(n)}(Yw),$w=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return(0,u.Z)(this,n),(e=t.call(this,null)).isData3DTexture=!0,e.image={data:r,width:i,height:a,depth:o},e.magFilter=hx,e.minFilter=hx,e.wrapR=lx,e.generateMipmaps=!1,e.flipY=!1,e.unpackAlignment=1,e}return(0,l.Z)(n)}(Yw),eS=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;(0,u.Z)(this,t),this.isQuaternion=!0,this._x=e,this._y=n,this._z=r,this._w=i}return(0,l.Z)(t,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}},{key:"set",value:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._w)}},{key:"copy",value:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}},{key:"setFromEuler",value:function(e,t){var n=e._x,r=e._y,i=e._z,a=e._order,o=Math.cos,s=Math.sin,u=o(n/2),l=o(r/2),c=o(i/2),h=s(n/2),f=s(r/2),d=s(i/2);switch(a){case"XYZ":this._x=h*l*c+u*f*d,this._y=u*f*c-h*l*d,this._z=u*l*d+h*f*c,this._w=u*l*c-h*f*d;break;case"YXZ":this._x=h*l*c+u*f*d,this._y=u*f*c-h*l*d,this._z=u*l*d-h*f*c,this._w=u*l*c+h*f*d;break;case"ZXY":this._x=h*l*c-u*f*d,this._y=u*f*c+h*l*d,this._z=u*l*d+h*f*c,this._w=u*l*c-h*f*d;break;case"ZYX":this._x=h*l*c-u*f*d,this._y=u*f*c+h*l*d,this._z=u*l*d-h*f*c,this._w=u*l*c+h*f*d;break;case"YZX":this._x=h*l*c+u*f*d,this._y=u*f*c+h*l*d,this._z=u*l*d-h*f*c,this._w=u*l*c-h*f*d;break;case"XZY":this._x=h*l*c-u*f*d,this._y=u*f*c-h*l*d,this._z=u*l*d+h*f*c,this._w=u*l*c+h*f*d;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!1!==t&&this._onChangeCallback(),this}},{key:"setFromAxisAngle",value:function(e,t){var n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(e){var t=e.elements,n=t[0],r=t[4],i=t[8],a=t[1],o=t[5],s=t[9],u=t[2],l=t[6],c=t[10],h=n+o+c;if(h>0){var f=.5/Math.sqrt(h+1);this._w=.25/f,this._x=(l-s)*f,this._y=(i-u)*f,this._z=(a-r)*f}else if(n>o&&n>c){var d=2*Math.sqrt(1+n-o-c);this._w=(l-s)/d,this._x=.25*d,this._y=(r+a)/d,this._z=(i+u)/d}else if(o>c){var p=2*Math.sqrt(1+o-n-c);this._w=(i-u)/p,this._x=(r+a)/p,this._y=.25*p,this._z=(s+l)/p}else{var v=2*Math.sqrt(1+c-n-o);this._w=(a-r)/v,this._x=(i+u)/v,this._y=(s+l)/v,this._z=.25*v}return this._onChangeCallback(),this}},{key:"setFromUnitVectors",value:function(e,t){var n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}},{key:"angleTo",value:function(e){return 2*Math.acos(Math.abs(xw(this.dot(e),-1,1)))}},{key:"rotateTowards",value:function(e,t){var n=this.angleTo(e);if(0===n)return this;var r=Math.min(1,t/n);return this.slerp(e,r),this}},{key:"identity",value:function(){return this.set(0,0,0,1)}},{key:"invert",value:function(){return this.conjugate()}},{key:"conjugate",value:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}},{key:"dot",value:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}},{key:"lengthSq",value:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}},{key:"length",value:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}},{key:"normalize",value:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}},{key:"multiply",value:function(e){return this.multiplyQuaternions(this,e)}},{key:"premultiply",value:function(e){return this.multiplyQuaternions(e,this)}},{key:"multiplyQuaternions",value:function(e,t){var n=e._x,r=e._y,i=e._z,a=e._w,o=t._x,s=t._y,u=t._z,l=t._w;return this._x=n*l+a*o+r*u-i*s,this._y=r*l+a*s+i*o-n*u,this._z=i*l+a*u+n*s-r*o,this._w=a*l-n*o-r*s-i*u,this._onChangeCallback(),this}},{key:"slerp",value:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,r=this._y,i=this._z,a=this._w,o=a*e._w+n*e._x+r*e._y+i*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=n,this._y=r,this._z=i,this;var s=1-o*o;if(s<=Number.EPSILON){var u=1-t;return this._w=u*a+t*this._w,this._x=u*n+t*this._x,this._y=u*r+t*this._y,this._z=u*i+t*this._z,this.normalize(),this._onChangeCallback(),this}var l=Math.sqrt(s),c=Math.atan2(l,o),h=Math.sin((1-t)*c)/l,f=Math.sin(t*c)/l;return this._w=a*h+this._w*f,this._x=n*h+this._x*f,this._y=r*h+this._y*f,this._z=i*h+this._z*f,this._onChangeCallback(),this}},{key:"slerpQuaternions",value:function(e,t,n){return this.copy(e).slerp(t,n)}},{key:"random",value:function(){var e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),r=2*Math.PI*Math.random(),i=2*Math.PI*Math.random();return this.set(t*Math.cos(r),n*Math.sin(i),n*Math.cos(i),t*Math.sin(r))}},{key:"equals",value:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}},{key:"fromBufferAttribute",value:function(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}},{key:"toJSON",value:function(){return this.toArray()}},{key:"_onChange",value:function(e){return this._onChangeCallback=e,this}},{key:"_onChangeCallback",value:function(){}},{key:e,value:fr().mark((function e(){return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._x;case 2:return e.next=4,this._y;case 4:return e.next=6,this._z;case 6:return e.next=8,this._w;case 8:case"end":return e.stop()}}),e,this)}))}],[{key:"slerpFlat",value:function(e,t,n,r,i,a,o){var s=n[r+0],u=n[r+1],l=n[r+2],c=n[r+3],h=i[a+0],f=i[a+1],d=i[a+2],p=i[a+3];if(0===o)return e[t+0]=s,e[t+1]=u,e[t+2]=l,void(e[t+3]=c);if(1===o)return e[t+0]=h,e[t+1]=f,e[t+2]=d,void(e[t+3]=p);if(c!==p||s!==h||u!==f||l!==d){var v=1-o,m=s*h+u*f+l*d+c*p,g=m>=0?1:-1,y=1-m*m;if(y>Number.EPSILON){var b=Math.sqrt(y),_=Math.atan2(b,m*g);v=Math.sin(v*_)/b,o=Math.sin(o*_)/b}var x=o*g;if(s=s*v+h*x,u=u*v+f*x,l=l*v+d*x,c=c*v+p*x,v===1-o){var w=1/Math.sqrt(s*s+u*u+l*l+c*c);s*=w,u*=w,l*=w,c*=w}}e[t]=s,e[t+1]=u,e[t+2]=l,e[t+3]=c}},{key:"multiplyQuaternionsFlat",value:function(e,t,n,r,i,a){var o=n[r],s=n[r+1],u=n[r+2],l=n[r+3],c=i[a],h=i[a+1],f=i[a+2],d=i[a+3];return e[t]=o*d+l*c+s*f-u*h,e[t+1]=s*d+l*h+u*c-o*f,e[t+2]=u*d+l*f+o*h-s*c,e[t+3]=l*d-o*c-s*h-u*f,e}}]),t}(Symbol.iterator),tS=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,u.Z)(this,t),t.prototype.isVector3=!0,this.x=e,this.y=n,this.z=r}return(0,l.Z)(t,[{key:"set",value:function(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this.z=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}},{key:"sub",value:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this.z-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this}},{key:"multiplyVectors",value:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}},{key:"applyEuler",value:function(e){return this.applyQuaternion(rS.setFromEuler(e))}},{key:"applyAxisAngle",value:function(e,t){return this.applyQuaternion(rS.setFromAxisAngle(e,t))}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this}},{key:"applyNormalMatrix",value:function(e){return this.applyMatrix3(e).normalize()}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements,a=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*a,this}},{key:"applyQuaternion",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,o=e.z,s=e.w,u=s*t+a*r-o*n,l=s*n+o*t-i*r,c=s*r+i*n-a*t,h=-i*t-a*n-o*r;return this.x=u*s+h*-i+l*-o-c*-a,this.y=l*s+h*-a+c*-i-u*-o,this.z=c*s+h*-o+u*-a-l*-i,this}},{key:"project",value:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}},{key:"unproject",value:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}},{key:"transformDirection",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}},{key:"cross",value:function(e){return this.crossVectors(this,e)}},{key:"crossVectors",value:function(e,t){var n=e.x,r=e.y,i=e.z,a=t.x,o=t.y,s=t.z;return this.x=r*s-i*o,this.y=i*a-n*s,this.z=n*o-r*a,this}},{key:"projectOnVector",value:function(e){var t=e.lengthSq();if(0===t)return this.set(0,0,0);var n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}},{key:"projectOnPlane",value:function(e){return nS.copy(this).projectOnVector(e),this.sub(nS)}},{key:"reflect",value:function(e){return this.sub(nS.copy(e).multiplyScalar(2*this.dot(e)))}},{key:"angleTo",value:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;var n=this.dot(e)/t;return Math.acos(xw(n,-1,1))}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}},{key:"manhattanDistanceTo",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}},{key:"setFromSpherical",value:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}},{key:"setFromSphericalCoords",value:function(e,t,n){var r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}},{key:"setFromCylindrical",value:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}},{key:"setFromCylindricalCoords",value:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}},{key:"setFromMatrixPosition",value:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}},{key:"setFromMatrixScale",value:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}},{key:"setFromMatrixColumn",value:function(e,t){return this.fromArray(e.elements,4*t)}},{key:"setFromMatrix3Column",value:function(e,t){return this.fromArray(e.elements,3*t)}},{key:"setFromEuler",value:function(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}},{key:"setFromColor",value:function(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}},{key:"fromBufferAttribute",value:function(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}},{key:"randomDirection",value:function(){var e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-Math.pow(e,2));return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}},{key:e,value:fr().mark((function e(){return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.x;case 2:return e.next=4,this.y;case 4:return e.next=6,this.z;case 6:case"end":return e.stop()}}),e,this)}))}]),t}(Symbol.iterator),nS=new tS,rS=new eS,iS=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new tS(1/0,1/0,1/0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new tS(-1/0,-1/0,-1/0);(0,u.Z)(this,e),this.isBox3=!0,this.min=t,this.max=n}return(0,l.Z)(e,[{key:"set",value:function(e,t){return this.min.copy(e),this.max.copy(t),this}},{key:"setFromArray",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t+=3)this.expandByPoint(oS.fromArray(e,t));return this}},{key:"setFromBufferAttribute",value:function(e){this.makeEmpty();for(var t=0,n=e.count;t<n;t++)this.expandByPoint(oS.fromBufferAttribute(e,t));return this}},{key:"setFromPoints",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}},{key:"setFromCenterAndSize",value:function(e,t){var n=oS.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}},{key:"setFromObject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.makeEmpty(),this.expandByObject(e,t)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.min.copy(e.min),this.max.copy(e.max),this}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}},{key:"isEmpty",value:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}},{key:"getCenter",value:function(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}},{key:"getSize",value:function(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}},{key:"expandByVector",value:function(e){return this.min.sub(e),this.max.add(e),this}},{key:"expandByScalar",value:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this}},{key:"expandByObject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.updateWorldMatrix(!1,!1),void 0!==e.boundingBox)null===e.boundingBox&&e.computeBoundingBox(),sS.copy(e.boundingBox),sS.applyMatrix4(e.matrixWorld),this.union(sS);else{var n=e.geometry;if(void 0!==n)if(t&&void 0!==n.attributes&&void 0!==n.attributes.position)for(var r=n.attributes.position,i=0,a=r.count;i<a;i++)oS.fromBufferAttribute(r,i).applyMatrix4(e.matrixWorld),this.expandByPoint(oS);else null===n.boundingBox&&n.computeBoundingBox(),sS.copy(n.boundingBox),sS.applyMatrix4(e.matrixWorld),this.union(sS)}for(var o=e.children,s=0,u=o.length;s<u;s++)this.expandByObject(o[s],t);return this}},{key:"containsPoint",value:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}},{key:"containsBox",value:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}},{key:"getParameter",value:function(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}},{key:"intersectsBox",value:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}},{key:"intersectsSphere",value:function(e){return this.clampPoint(e.center,oS),oS.distanceToSquared(e.center)<=e.radius*e.radius}},{key:"intersectsPlane",value:function(e){var t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}},{key:"intersectsTriangle",value:function(e){if(this.isEmpty())return!1;this.getCenter(pS),vS.subVectors(this.max,pS),uS.subVectors(e.a,pS),lS.subVectors(e.b,pS),cS.subVectors(e.c,pS),hS.subVectors(lS,uS),fS.subVectors(cS,lS),dS.subVectors(uS,cS);var t=[0,-hS.z,hS.y,0,-fS.z,fS.y,0,-dS.z,dS.y,hS.z,0,-hS.x,fS.z,0,-fS.x,dS.z,0,-dS.x,-hS.y,hS.x,0,-fS.y,fS.x,0,-dS.y,dS.x,0];return!!yS(t,uS,lS,cS,vS)&&(!!yS(t=[1,0,0,0,1,0,0,0,1],uS,lS,cS,vS)&&(mS.crossVectors(hS,fS),yS(t=[mS.x,mS.y,mS.z],uS,lS,cS,vS)))}},{key:"clampPoint",value:function(e,t){return t.copy(e).clamp(this.min,this.max)}},{key:"distanceToPoint",value:function(e){return this.clampPoint(e,oS).distanceTo(e)}},{key:"getBoundingSphere",value:function(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(oS).length()),e}},{key:"intersect",value:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"applyMatrix4",value:function(e){return this.isEmpty()||(aS[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),aS[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),aS[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),aS[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),aS[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),aS[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),aS[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),aS[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(aS)),this}},{key:"translate",value:function(e){return this.min.add(e),this.max.add(e),this}},{key:"equals",value:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}]),e}(),aS=[new tS,new tS,new tS,new tS,new tS,new tS,new tS,new tS],oS=new tS,sS=new iS,uS=new tS,lS=new tS,cS=new tS,hS=new tS,fS=new tS,dS=new tS,pS=new tS,vS=new tS,mS=new tS,gS=new tS;function yS(e,t,n,r,i){for(var a=0,o=e.length-3;a<=o;a+=3){gS.fromArray(e,a);var s=i.x*Math.abs(gS.x)+i.y*Math.abs(gS.y)+i.z*Math.abs(gS.z),u=t.dot(gS),l=n.dot(gS),c=r.dot(gS);if(Math.max(-Math.max(u,l,c),Math.min(u,l,c))>s)return!1}return!0}var bS=new iS,_S=new tS,xS=new tS,wS=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new tS,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;(0,u.Z)(this,e),this.center=t,this.radius=n}return(0,l.Z)(e,[{key:"set",value:function(e,t){return this.center.copy(e),this.radius=t,this}},{key:"setFromPoints",value:function(e,t){var n=this.center;void 0!==t?n.copy(t):bS.setFromPoints(e).getCenter(n);for(var r=0,i=0,a=e.length;i<a;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}},{key:"copy",value:function(e){return this.center.copy(e.center),this.radius=e.radius,this}},{key:"isEmpty",value:function(){return this.radius<0}},{key:"makeEmpty",value:function(){return this.center.set(0,0,0),this.radius=-1,this}},{key:"containsPoint",value:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}},{key:"distanceToPoint",value:function(e){return e.distanceTo(this.center)-this.radius}},{key:"intersectsSphere",value:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}},{key:"intersectsBox",value:function(e){return e.intersectsSphere(this)}},{key:"intersectsPlane",value:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}},{key:"clampPoint",value:function(e,t){var n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}},{key:"getBoundingBox",value:function(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}},{key:"applyMatrix4",value:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}},{key:"translate",value:function(e){return this.center.add(e),this}},{key:"expandByPoint",value:function(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;_S.subVectors(e,this.center);var t=_S.lengthSq();if(t>this.radius*this.radius){var n=Math.sqrt(t),r=.5*(n-this.radius);this.center.addScaledVector(_S,r/n),this.radius+=r}return this}},{key:"union",value:function(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(xS.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(_S.copy(e.center).add(xS)),this.expandByPoint(_S.copy(e.center).sub(xS))),this)}},{key:"equals",value:function(e){return e.center.equals(this.center)&&e.radius===this.radius}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),SS=new tS,MS=new tS,kS=new tS,TS=new tS,ES=new tS,CS=new tS,AS=new tS,RS=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new tS,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new tS(0,0,-1);(0,u.Z)(this,e),this.origin=t,this.direction=n}return(0,l.Z)(e,[{key:"set",value:function(e,t){return this.origin.copy(e),this.direction.copy(t),this}},{key:"copy",value:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}},{key:"at",value:function(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}},{key:"lookAt",value:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this}},{key:"recast",value:function(e){return this.origin.copy(this.at(e,SS)),this}},{key:"closestPointToPoint",value:function(e,t){t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}},{key:"distanceToPoint",value:function(e){return Math.sqrt(this.distanceSqToPoint(e))}},{key:"distanceSqToPoint",value:function(e){var t=SS.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(SS.copy(this.origin).addScaledVector(this.direction,t),SS.distanceToSquared(e))}},{key:"distanceSqToSegment",value:function(e,t,n,r){MS.copy(e).add(t).multiplyScalar(.5),kS.copy(t).sub(e).normalize(),TS.copy(this.origin).sub(MS);var i,a,o,s,u=.5*e.distanceTo(t),l=-this.direction.dot(kS),c=TS.dot(this.direction),h=-TS.dot(kS),f=TS.lengthSq(),d=Math.abs(1-l*l);if(d>0)if(a=l*c-h,s=u*d,(i=l*h-c)>=0)if(a>=-s)if(a<=s){var p=1/d;o=(i*=p)*(i+l*(a*=p)+2*c)+a*(l*i+a+2*h)+f}else a=u,o=-(i=Math.max(0,-(l*a+c)))*i+a*(a+2*h)+f;else a=-u,o=-(i=Math.max(0,-(l*a+c)))*i+a*(a+2*h)+f;else a<=-s?o=-(i=Math.max(0,-(-l*u+c)))*i+(a=i>0?-u:Math.min(Math.max(-u,-h),u))*(a+2*h)+f:a<=s?(i=0,o=(a=Math.min(Math.max(-u,-h),u))*(a+2*h)+f):o=-(i=Math.max(0,-(l*u+c)))*i+(a=i>0?u:Math.min(Math.max(-u,-h),u))*(a+2*h)+f;else a=l>0?-u:u,o=-(i=Math.max(0,-(l*a+c)))*i+a*(a+2*h)+f;return n&&n.copy(this.origin).addScaledVector(this.direction,i),r&&r.copy(MS).addScaledVector(kS,a),o}},{key:"intersectSphere",value:function(e,t){SS.subVectors(e.center,this.origin);var n=SS.dot(this.direction),r=SS.dot(SS)-n*n,i=e.radius*e.radius;if(r>i)return null;var a=Math.sqrt(i-r),o=n-a,s=n+a;return s<0?null:o<0?this.at(s,t):this.at(o,t)}},{key:"intersectsSphere",value:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}},{key:"distanceToPlane",value:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}},{key:"intersectPlane",value:function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}},{key:"intersectsPlane",value:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}},{key:"intersectBox",value:function(e,t){var n,r,i,a,o,s,u=1/this.direction.x,l=1/this.direction.y,c=1/this.direction.z,h=this.origin;return u>=0?(n=(e.min.x-h.x)*u,r=(e.max.x-h.x)*u):(n=(e.max.x-h.x)*u,r=(e.min.x-h.x)*u),l>=0?(i=(e.min.y-h.y)*l,a=(e.max.y-h.y)*l):(i=(e.max.y-h.y)*l,a=(e.min.y-h.y)*l),n>a||i>r?null:((i>n||isNaN(n))&&(n=i),(a<r||isNaN(r))&&(r=a),c>=0?(o=(e.min.z-h.z)*c,s=(e.max.z-h.z)*c):(o=(e.max.z-h.z)*c,s=(e.min.z-h.z)*c),n>s||o>r?null:((o>n||n!==n)&&(n=o),(s<r||r!==r)&&(r=s),r<0?null:this.at(n>=0?n:r,t)))}},{key:"intersectsBox",value:function(e){return null!==this.intersectBox(e,SS)}},{key:"intersectTriangle",value:function(e,t,n,r,i){ES.subVectors(t,e),CS.subVectors(n,e),AS.crossVectors(ES,CS);var a,o=this.direction.dot(AS);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}TS.subVectors(this.origin,e);var s=a*this.direction.dot(CS.crossVectors(TS,CS));if(s<0)return null;var u=a*this.direction.dot(ES.cross(TS));if(u<0)return null;if(s+u>o)return null;var l=-a*TS.dot(AS);return l<0?null:this.at(l/o,i)}},{key:"applyMatrix4",value:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}},{key:"equals",value:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),PS=function(){function e(){(0,u.Z)(this,e),e.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}return(0,l.Z)(e,[{key:"set",value:function(e,t,n,r,i,a,o,s,u,l,c,h,f,d,p,v){var m=this.elements;return m[0]=e,m[4]=t,m[8]=n,m[12]=r,m[1]=i,m[5]=a,m[9]=o,m[13]=s,m[2]=u,m[6]=l,m[10]=c,m[14]=h,m[3]=f,m[7]=d,m[11]=p,m[15]=v,this}},{key:"identity",value:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}},{key:"clone",value:function(){return(new e).fromArray(this.elements)}},{key:"copy",value:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}},{key:"copyPosition",value:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}},{key:"setFromMatrix3",value:function(e){var t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}},{key:"extractBasis",value:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}},{key:"makeBasis",value:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}},{key:"extractRotation",value:function(e){var t=this.elements,n=e.elements,r=1/LS.setFromMatrixColumn(e,0).length(),i=1/LS.setFromMatrixColumn(e,1).length(),a=1/LS.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"makeRotationFromEuler",value:function(e){var t=this.elements,n=e.x,r=e.y,i=e.z,a=Math.cos(n),o=Math.sin(n),s=Math.cos(r),u=Math.sin(r),l=Math.cos(i),c=Math.sin(i);if("XYZ"===e.order){var h=a*l,f=a*c,d=o*l,p=o*c;t[0]=s*l,t[4]=-s*c,t[8]=u,t[1]=f+d*u,t[5]=h-p*u,t[9]=-o*s,t[2]=p-h*u,t[6]=d+f*u,t[10]=a*s}else if("YXZ"===e.order){var v=s*l,m=s*c,g=u*l,y=u*c;t[0]=v+y*o,t[4]=g*o-m,t[8]=a*u,t[1]=a*c,t[5]=a*l,t[9]=-o,t[2]=m*o-g,t[6]=y+v*o,t[10]=a*s}else if("ZXY"===e.order){var b=s*l,_=s*c,x=u*l,w=u*c;t[0]=b-w*o,t[4]=-a*c,t[8]=x+_*o,t[1]=_+x*o,t[5]=a*l,t[9]=w-b*o,t[2]=-a*u,t[6]=o,t[10]=a*s}else if("ZYX"===e.order){var S=a*l,M=a*c,k=o*l,T=o*c;t[0]=s*l,t[4]=k*u-M,t[8]=S*u+T,t[1]=s*c,t[5]=T*u+S,t[9]=M*u-k,t[2]=-u,t[6]=o*s,t[10]=a*s}else if("YZX"===e.order){var E=a*s,C=a*u,A=o*s,R=o*u;t[0]=s*l,t[4]=R-E*c,t[8]=A*c+C,t[1]=c,t[5]=a*l,t[9]=-o*l,t[2]=-u*l,t[6]=C*c+A,t[10]=E-R*c}else if("XZY"===e.order){var P=a*s,L=a*u,D=o*s,N=o*u;t[0]=s*l,t[4]=-c,t[8]=u*l,t[1]=P*c+N,t[5]=a*l,t[9]=L*c-D,t[2]=D*c-L,t[6]=o*l,t[10]=N*c+P}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"makeRotationFromQuaternion",value:function(e){return this.compose(NS,e,IS)}},{key:"lookAt",value:function(e,t,n){var r=this.elements;return FS.subVectors(e,t),0===FS.lengthSq()&&(FS.z=1),FS.normalize(),OS.crossVectors(n,FS),0===OS.lengthSq()&&(1===Math.abs(n.z)?FS.x+=1e-4:FS.z+=1e-4,FS.normalize(),OS.crossVectors(n,FS)),OS.normalize(),US.crossVectors(FS,OS),r[0]=OS.x,r[4]=US.x,r[8]=FS.x,r[1]=OS.y,r[5]=US.y,r[9]=FS.y,r[2]=OS.z,r[6]=US.z,r[10]=FS.z,this}},{key:"multiply",value:function(e){return this.multiplyMatrices(this,e)}},{key:"premultiply",value:function(e){return this.multiplyMatrices(e,this)}},{key:"multiplyMatrices",value:function(e,t){var n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[4],s=n[8],u=n[12],l=n[1],c=n[5],h=n[9],f=n[13],d=n[2],p=n[6],v=n[10],m=n[14],g=n[3],y=n[7],b=n[11],_=n[15],x=r[0],w=r[4],S=r[8],M=r[12],k=r[1],T=r[5],E=r[9],C=r[13],A=r[2],R=r[6],P=r[10],L=r[14],D=r[3],N=r[7],I=r[11],O=r[15];return i[0]=a*x+o*k+s*A+u*D,i[4]=a*w+o*T+s*R+u*N,i[8]=a*S+o*E+s*P+u*I,i[12]=a*M+o*C+s*L+u*O,i[1]=l*x+c*k+h*A+f*D,i[5]=l*w+c*T+h*R+f*N,i[9]=l*S+c*E+h*P+f*I,i[13]=l*M+c*C+h*L+f*O,i[2]=d*x+p*k+v*A+m*D,i[6]=d*w+p*T+v*R+m*N,i[10]=d*S+p*E+v*P+m*I,i[14]=d*M+p*C+v*L+m*O,i[3]=g*x+y*k+b*A+_*D,i[7]=g*w+y*T+b*R+_*N,i[11]=g*S+y*E+b*P+_*I,i[15]=g*M+y*C+b*L+_*O,this}},{key:"multiplyScalar",value:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}},{key:"determinant",value:function(){var e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],a=e[1],o=e[5],s=e[9],u=e[13],l=e[2],c=e[6],h=e[10],f=e[14];return e[3]*(+i*s*c-r*u*c-i*o*h+n*u*h+r*o*f-n*s*f)+e[7]*(+t*s*f-t*u*h+i*a*h-r*a*f+r*u*l-i*s*l)+e[11]*(+t*u*c-t*o*f-i*a*c+n*a*f+i*o*l-n*u*l)+e[15]*(-r*o*l-t*s*c+t*o*h+r*a*c-n*a*h+n*s*l)}},{key:"transpose",value:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}},{key:"setPosition",value:function(e,t,n){var r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}},{key:"invert",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],l=e[8],c=e[9],h=e[10],f=e[11],d=e[12],p=e[13],v=e[14],m=e[15],g=c*v*u-p*h*u+p*s*f-o*v*f-c*s*m+o*h*m,y=d*h*u-l*v*u-d*s*f+a*v*f+l*s*m-a*h*m,b=l*p*u-d*c*u+d*o*f-a*p*f-l*o*m+a*c*m,_=d*c*s-l*p*s-d*o*h+a*p*h+l*o*v-a*c*v,x=t*g+n*y+r*b+i*_;if(0===x)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var w=1/x;return e[0]=g*w,e[1]=(p*h*i-c*v*i-p*r*f+n*v*f+c*r*m-n*h*m)*w,e[2]=(o*v*i-p*s*i+p*r*u-n*v*u-o*r*m+n*s*m)*w,e[3]=(c*s*i-o*h*i-c*r*u+n*h*u+o*r*f-n*s*f)*w,e[4]=y*w,e[5]=(l*v*i-d*h*i+d*r*f-t*v*f-l*r*m+t*h*m)*w,e[6]=(d*s*i-a*v*i-d*r*u+t*v*u+a*r*m-t*s*m)*w,e[7]=(a*h*i-l*s*i+l*r*u-t*h*u-a*r*f+t*s*f)*w,e[8]=b*w,e[9]=(d*c*i-l*p*i-d*n*f+t*p*f+l*n*m-t*c*m)*w,e[10]=(a*p*i-d*o*i+d*n*u-t*p*u-a*n*m+t*o*m)*w,e[11]=(l*o*i-a*c*i-l*n*u+t*c*u+a*n*f-t*o*f)*w,e[12]=_*w,e[13]=(l*p*r-d*c*r+d*n*h-t*p*h-l*n*v+t*c*v)*w,e[14]=(d*o*r-a*p*r-d*n*s+t*p*s+a*n*v-t*o*v)*w,e[15]=(a*c*r-l*o*r+l*n*s-t*c*s-a*n*h+t*o*h)*w,this}},{key:"scale",value:function(e){var t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this}},{key:"getMaxScaleOnAxis",value:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}},{key:"makeTranslation",value:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}},{key:"makeRotationX",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}},{key:"makeRotationY",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}},{key:"makeRotationZ",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}},{key:"makeRotationAxis",value:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=1-n,a=e.x,o=e.y,s=e.z,u=i*a,l=i*o;return this.set(u*a+n,u*o-r*s,u*s+r*o,0,u*o+r*s,l*o+n,l*s-r*a,0,u*s-r*o,l*s+r*a,i*s*s+n,0,0,0,0,1),this}},{key:"makeScale",value:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}},{key:"makeShear",value:function(e,t,n,r,i,a){return this.set(1,n,i,0,e,1,a,0,t,r,1,0,0,0,0,1),this}},{key:"compose",value:function(e,t,n){var r=this.elements,i=t._x,a=t._y,o=t._z,s=t._w,u=i+i,l=a+a,c=o+o,h=i*u,f=i*l,d=i*c,p=a*l,v=a*c,m=o*c,g=s*u,y=s*l,b=s*c,_=n.x,x=n.y,w=n.z;return r[0]=(1-(p+m))*_,r[1]=(f+b)*_,r[2]=(d-y)*_,r[3]=0,r[4]=(f-b)*x,r[5]=(1-(h+m))*x,r[6]=(v+g)*x,r[7]=0,r[8]=(d+y)*w,r[9]=(v-g)*w,r[10]=(1-(h+p))*w,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}},{key:"decompose",value:function(e,t,n){var r=this.elements,i=LS.set(r[0],r[1],r[2]).length(),a=LS.set(r[4],r[5],r[6]).length(),o=LS.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],DS.copy(this);var s=1/i,u=1/a,l=1/o;return DS.elements[0]*=s,DS.elements[1]*=s,DS.elements[2]*=s,DS.elements[4]*=u,DS.elements[5]*=u,DS.elements[6]*=u,DS.elements[8]*=l,DS.elements[9]*=l,DS.elements[10]*=l,t.setFromRotationMatrix(DS),n.x=i,n.y=a,n.z=o,this}},{key:"makePerspective",value:function(e,t,n,r,i,a){var o=this.elements,s=2*i/(t-e),u=2*i/(n-r),l=(t+e)/(t-e),c=(n+r)/(n-r),h=-(a+i)/(a-i),f=-2*a*i/(a-i);return o[0]=s,o[4]=0,o[8]=l,o[12]=0,o[1]=0,o[5]=u,o[9]=c,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=f,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}},{key:"makeOrthographic",value:function(e,t,n,r,i,a){var o=this.elements,s=1/(t-e),u=1/(n-r),l=1/(a-i),c=(t+e)*s,h=(n+r)*u,f=(a+i)*l;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-c,o[1]=0,o[5]=2*u,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2*l,o[14]=-f,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}},{key:"equals",value:function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<16;n++)this.elements[n]=e[n+t];return this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}]),e}(),LS=new tS,DS=new PS,NS=new tS(0,0,0),IS=new tS(1,1,1),OS=new tS,US=new tS,FS=new tS,zS=new PS,BS=new eS,VS=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.DEFAULT_ORDER;(0,u.Z)(this,t),this.isEuler=!0,this._x=e,this._y=n,this._z=r,this._order=i}return(0,l.Z)(t,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}},{key:"set",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._order)}},{key:"copy",value:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=e.elements,i=r[0],a=r[4],o=r[8],s=r[1],u=r[5],l=r[9],c=r[2],h=r[6],f=r[10];switch(t){case"XYZ":this._y=Math.asin(xw(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-l,f),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(h,u),this._z=0);break;case"YXZ":this._x=Math.asin(-xw(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(o,f),this._z=Math.atan2(s,u)):(this._y=Math.atan2(-c,i),this._z=0);break;case"ZXY":this._x=Math.asin(xw(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-c,f),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(s,i));break;case"ZYX":this._y=Math.asin(-xw(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(h,f),this._z=Math.atan2(s,i)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(xw(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-l,u),this._y=Math.atan2(-c,i)):(this._x=0,this._y=Math.atan2(o,f));break;case"XZY":this._z=Math.asin(-xw(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(h,u),this._y=Math.atan2(o,i)):(this._x=Math.atan2(-l,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}},{key:"setFromQuaternion",value:function(e,t,n){return zS.makeRotationFromQuaternion(e),this.setFromRotationMatrix(zS,t,n)}},{key:"setFromVector3",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(e.x,e.y,e.z,t)}},{key:"reorder",value:function(e){return BS.setFromEuler(this),this.setFromQuaternion(BS,e)}},{key:"equals",value:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}},{key:"fromArray",value:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}},{key:"_onChange",value:function(e){return this._onChangeCallback=e,this}},{key:"_onChangeCallback",value:function(){}},{key:e,value:fr().mark((function e(){return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._x;case 2:return e.next=4,this._y;case 4:return e.next=6,this._z;case 6:return e.next=8,this._order;case 8:case"end":return e.stop()}}),e,this)}))}]),t}(Symbol.iterator);VS.DEFAULT_ORDER="XYZ";var GS=function(){function e(){(0,u.Z)(this,e),this.mask=1}return(0,l.Z)(e,[{key:"set",value:function(e){this.mask=(1<<e|0)>>>0}},{key:"enable",value:function(e){this.mask|=1<<e|0}},{key:"enableAll",value:function(){this.mask=-1}},{key:"toggle",value:function(e){this.mask^=1<<e|0}},{key:"disable",value:function(e){this.mask&=~(1<<e|0)}},{key:"disableAll",value:function(){this.mask=0}},{key:"test",value:function(e){return 0!==(this.mask&e.mask)}},{key:"isEnabled",value:function(e){return 0!==(this.mask&(1<<e|0))}}]),e}(),jS=0,HS=new tS,WS=new eS,ZS=new PS,qS=new tS,XS=new tS,YS=new tS,KS=new eS,JS=new tS(1,0,0),QS=new tS(0,1,0),$S=new tS(0,0,1),eM={type:"added"},tM={type:"removed"},nM=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;(0,u.Z)(this,n),(e=t.call(this)).isObject3D=!0,Object.defineProperty((0,c.Z)(e),"id",{value:jS++}),e.uuid=_w(),e.name="",e.type="Object3D",e.parent=null,e.children=[],e.up=n.DEFAULT_UP.clone();var r=new tS,i=new VS,a=new eS,o=new tS(1,1,1);return i._onChange((function(){a.setFromEuler(i,!1)})),a._onChange((function(){i.setFromQuaternion(a,void 0,!1)})),Object.defineProperties((0,c.Z)(e),{position:{configurable:!0,enumerable:!0,value:r},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:a},scale:{configurable:!0,enumerable:!0,value:o},modelViewMatrix:{value:new PS},normalMatrix:{value:new Pw}}),e.matrix=new PS,e.matrixWorld=new PS,e.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,e.matrixWorldNeedsUpdate=!1,e.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,e.layers=new GS,e.visible=!0,e.castShadow=!1,e.receiveShadow=!1,e.frustumCulled=!0,e.renderOrder=0,e.animations=[],e.userData={},e}return(0,l.Z)(n,[{key:"onBeforeRender",value:function(){}},{key:"onAfterRender",value:function(){}},{key:"applyMatrix4",value:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}},{key:"applyQuaternion",value:function(e){return this.quaternion.premultiply(e),this}},{key:"setRotationFromAxisAngle",value:function(e,t){this.quaternion.setFromAxisAngle(e,t)}},{key:"setRotationFromEuler",value:function(e){this.quaternion.setFromEuler(e,!0)}},{key:"setRotationFromMatrix",value:function(e){this.quaternion.setFromRotationMatrix(e)}},{key:"setRotationFromQuaternion",value:function(e){this.quaternion.copy(e)}},{key:"rotateOnAxis",value:function(e,t){return WS.setFromAxisAngle(e,t),this.quaternion.multiply(WS),this}},{key:"rotateOnWorldAxis",value:function(e,t){return WS.setFromAxisAngle(e,t),this.quaternion.premultiply(WS),this}},{key:"rotateX",value:function(e){return this.rotateOnAxis(JS,e)}},{key:"rotateY",value:function(e){return this.rotateOnAxis(QS,e)}},{key:"rotateZ",value:function(e){return this.rotateOnAxis($S,e)}},{key:"translateOnAxis",value:function(e,t){return HS.copy(e).applyQuaternion(this.quaternion),this.position.add(HS.multiplyScalar(t)),this}},{key:"translateX",value:function(e){return this.translateOnAxis(JS,e)}},{key:"translateY",value:function(e){return this.translateOnAxis(QS,e)}},{key:"translateZ",value:function(e){return this.translateOnAxis($S,e)}},{key:"localToWorld",value:function(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}},{key:"worldToLocal",value:function(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(ZS.copy(this.matrixWorld).invert())}},{key:"lookAt",value:function(e,t,n){e.isVector3?qS.copy(e):qS.set(e,t,n);var r=this.parent;this.updateWorldMatrix(!0,!1),XS.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ZS.lookAt(XS,qS,this.up):ZS.lookAt(qS,XS,this.up),this.quaternion.setFromRotationMatrix(ZS),r&&(ZS.extractRotation(r.matrixWorld),WS.setFromRotationMatrix(ZS),this.quaternion.premultiply(WS.invert()))}},{key:"add",value:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(eM)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}},{key:"remove",value:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(tM)),this}},{key:"removeFromParent",value:function(){var e=this.parent;return null!==e&&e.remove(this),this}},{key:"clear",value:function(){for(var e=0;e<this.children.length;e++){var t=this.children[e];t.parent=null,t.dispatchEvent(tM)}return this.children.length=0,this}},{key:"attach",value:function(e){return this.updateWorldMatrix(!0,!1),ZS.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),ZS.multiply(e.parent.matrixWorld)),e.applyMatrix4(ZS),this.add(e),e.updateWorldMatrix(!1,!0),this}},{key:"getObjectById",value:function(e){return this.getObjectByProperty("id",e)}},{key:"getObjectByName",value:function(e){return this.getObjectByProperty("name",e)}},{key:"getObjectByProperty",value:function(e,t){if(this[e]===t)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}}},{key:"getObjectsByProperty",value:function(e,t){var n=[];this[e]===t&&n.push(this);for(var r=0,i=this.children.length;r<i;r++){var a=this.children[r].getObjectsByProperty(e,t);a.length>0&&(n=n.concat(a))}return n}},{key:"getWorldPosition",value:function(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}},{key:"getWorldQuaternion",value:function(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(XS,e,YS),e}},{key:"getWorldScale",value:function(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(XS,KS,e),e}},{key:"getWorldDirection",value:function(e){this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}},{key:"raycast",value:function(){}},{key:"traverse",value:function(e){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverse(e)}},{key:"traverseVisible",value:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}}},{key:"traverseAncestors",value:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}},{key:"updateMatrix",value:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}},{key:"updateMatrixWorld",value:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,n=0,r=t.length;n<r;n++){var i=t[n];!0!==i.matrixWorldAutoUpdate&&!0!==e||i.updateMatrixWorld(e)}}},{key:"updateWorldMatrix",value:function(e,t){var n=this.parent;if(!0===e&&null!==n&&!0===n.matrixWorldAutoUpdate&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var r=this.children,i=0,a=r.length;i<a;i++){var o=r[i];!0===o.matrixWorldAutoUpdate&&o.updateWorldMatrix(!1,!0)}}},{key:"toJSON",value:function(e){var t=void 0===e||"string"===typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var o=a.shapes;if(Array.isArray(o))for(var s=0,u=o.length;s<u;s++){var l=o[s];i(e.shapes,l)}else i(e.shapes,o)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){for(var c=[],h=0,f=this.material.length;h<f;h++)c.push(i(e.materials,this.material[h]));r.material=c}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(var d=0;d<this.children.length;d++)r.children.push(this.children[d].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(var p=0;p<this.animations.length;p++){var v=this.animations[p];r.animations.push(i(e.animations,v))}}if(t){var m=M(e.geometries),g=M(e.materials),y=M(e.textures),b=M(e.images),_=M(e.shapes),x=M(e.skeletons),w=M(e.animations),S=M(e.nodes);m.length>0&&(n.geometries=m),g.length>0&&(n.materials=g),y.length>0&&(n.textures=y),b.length>0&&(n.images=b),_.length>0&&(n.shapes=_),x.length>0&&(n.skeletons=x),w.length>0&&(n.animations=w),S.length>0&&(n.nodes=S)}return n.object=r,n;function M(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}}},{key:"clone",value:function(e){return(new this.constructor).copy(this,e)}},{key:"copy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var r=e.children[n];this.add(r.clone())}return this}}]),n}(vw);nM.DEFAULT_UP=new tS(0,1,0),nM.DEFAULT_MATRIX_AUTO_UPDATE=!0,nM.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var rM=new tS,iM=new tS,aM=new tS,oM=new tS,sM=new tS,uM=new tS,lM=new tS,cM=new tS,hM=new tS,fM=new tS,dM=!1,pM=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new tS,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new tS,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new tS;(0,u.Z)(this,e),this.a=t,this.b=n,this.c=r}return(0,l.Z)(e,[{key:"set",value:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}},{key:"setFromPointsAndIndices",value:function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}},{key:"setFromAttributeAndIndices",value:function(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}},{key:"getArea",value:function(){return rM.subVectors(this.c,this.b),iM.subVectors(this.a,this.b),.5*rM.cross(iM).length()}},{key:"getMidpoint",value:function(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}},{key:"getNormal",value:function(t){return e.getNormal(this.a,this.b,this.c,t)}},{key:"getPlane",value:function(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}},{key:"getBarycoord",value:function(t,n){return e.getBarycoord(t,this.a,this.b,this.c,n)}},{key:"getUV",value:function(t,n,r,i,a){return!1===dM&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),dM=!0),e.getInterpolation(t,this.a,this.b,this.c,n,r,i,a)}},{key:"getInterpolation",value:function(t,n,r,i,a){return e.getInterpolation(t,this.a,this.b,this.c,n,r,i,a)}},{key:"containsPoint",value:function(t){return e.containsPoint(t,this.a,this.b,this.c)}},{key:"isFrontFacing",value:function(t){return e.isFrontFacing(this.a,this.b,this.c,t)}},{key:"intersectsBox",value:function(e){return e.intersectsTriangle(this)}},{key:"closestPointToPoint",value:function(e,t){var n,r,i=this.a,a=this.b,o=this.c;sM.subVectors(a,i),uM.subVectors(o,i),cM.subVectors(e,i);var s=sM.dot(cM),u=uM.dot(cM);if(s<=0&&u<=0)return t.copy(i);hM.subVectors(e,a);var l=sM.dot(hM),c=uM.dot(hM);if(l>=0&&c<=l)return t.copy(a);var h=s*c-l*u;if(h<=0&&s>=0&&l<=0)return n=s/(s-l),t.copy(i).addScaledVector(sM,n);fM.subVectors(e,o);var f=sM.dot(fM),d=uM.dot(fM);if(d>=0&&f<=d)return t.copy(o);var p=f*u-s*d;if(p<=0&&u>=0&&d<=0)return r=u/(u-d),t.copy(i).addScaledVector(uM,r);var v=l*d-f*c;if(v<=0&&c-l>=0&&f-d>=0)return lM.subVectors(o,a),r=(c-l)/(c-l+(f-d)),t.copy(a).addScaledVector(lM,r);var m=1/(v+p+h);return n=p*m,r=h*m,t.copy(i).addScaledVector(sM,n).addScaledVector(uM,r)}},{key:"equals",value:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}],[{key:"getNormal",value:function(e,t,n,r){r.subVectors(n,t),rM.subVectors(e,t),r.cross(rM);var i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}},{key:"getBarycoord",value:function(e,t,n,r,i){rM.subVectors(r,t),iM.subVectors(n,t),aM.subVectors(e,t);var a=rM.dot(rM),o=rM.dot(iM),s=rM.dot(aM),u=iM.dot(iM),l=iM.dot(aM),c=a*u-o*o;if(0===c)return i.set(-2,-1,-1);var h=1/c,f=(u*s-o*l)*h,d=(a*l-o*s)*h;return i.set(1-f-d,d,f)}},{key:"containsPoint",value:function(e,t,n,r){return this.getBarycoord(e,t,n,r,oM),oM.x>=0&&oM.y>=0&&oM.x+oM.y<=1}},{key:"getUV",value:function(e,t,n,r,i,a,o,s){return!1===dM&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),dM=!0),this.getInterpolation(e,t,n,r,i,a,o,s)}},{key:"getInterpolation",value:function(e,t,n,r,i,a,o,s){return this.getBarycoord(e,t,n,r,oM),s.setScalar(0),s.addScaledVector(i,oM.x),s.addScaledVector(a,oM.y),s.addScaledVector(o,oM.z),s}},{key:"isFrontFacing",value:function(e,t,n,r){return rM.subVectors(n,t),iM.subVectors(e,t),rM.cross(iM).dot(r)<0}}]),e}(),vM=0,mM=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.call(this)).isMaterial=!0,Object.defineProperty((0,c.Z)(e),"id",{value:vM++}),e.uuid=_w(),e.name="",e.type="Material",e.blending=1,e.side=0,e.vertexColors=!1,e.opacity=1,e.transparent=!1,e.blendSrc=204,e.blendDst=205,e.blendEquation=nx,e.blendSrcAlpha=null,e.blendDstAlpha=null,e.blendEquationAlpha=null,e.depthFunc=3,e.depthTest=!0,e.depthWrite=!0,e.stencilWriteMask=255,e.stencilFunc=519,e.stencilRef=0,e.stencilFuncMask=255,e.stencilFail=hw,e.stencilZFail=hw,e.stencilZPass=hw,e.stencilWrite=!1,e.clippingPlanes=null,e.clipIntersection=!1,e.clipShadows=!1,e.shadowSide=null,e.colorWrite=!0,e.precision=null,e.polygonOffset=!1,e.polygonOffsetFactor=0,e.polygonOffsetUnits=0,e.dithering=!1,e.alphaToCoverage=!1,e.premultipliedAlpha=!1,e.forceSinglePass=!1,e.visible=!0,e.toneMapped=!0,e.userData={},e.version=0,e._alphaTest=0,e}return(0,l.Z)(n,[{key:"alphaTest",get:function(){return this._alphaTest},set:function(e){this._alphaTest>0!==e>0&&this.version++,this._alphaTest=e}},{key:"onBuild",value:function(){}},{key:"onBeforeRender",value:function(){}},{key:"onBeforeCompile",value:function(){}},{key:"customProgramCacheKey",value:function(){return this.onBeforeCompile.toString()}},{key:"setValues",value:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n){var r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE.Material: '".concat(t,"' is not a property of THREE.").concat(this.type,"."))}else console.warn("THREE.Material: parameter '".concat(t,"' has value of undefined."))}}},{key:"toJSON",value:function(e){var t=void 0===e||"string"===typeof e;t&&(e={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(n.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){var i=r(e.textures),a=r(e.images);i.length>0&&(n.textures=i),a.length>0&&(n.images=a)}return n}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var t=e.clippingPlanes,n=null;if(null!==t){var r=t.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}}]),n}(vw),gM={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},yM={h:0,s:0,l:0},bM={h:0,s:0,l:0};function _M(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}var xM=function(e){function t(e,n,r){return(0,u.Z)(this,t),this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===n&&void 0===r?this.set(e):this.setRGB(e,n,r)}return(0,l.Z)(t,[{key:"set",value:function(e){return e&&e.isColor?this.copy(e):"number"===typeof e?this.setHex(e):"string"===typeof e&&this.setStyle(e),this}},{key:"setScalar",value:function(e){return this.r=e,this.g=e,this.b=e,this}},{key:"setHex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:uw;return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Hw.toWorkingColorSpace(this,t),this}},{key:"setRGB",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Hw.workingColorSpace;return this.r=e,this.g=t,this.b=n,Hw.toWorkingColorSpace(this,r),this}},{key:"setHSL",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Hw.workingColorSpace;if(e=ww(e,1),t=xw(t,0,1),n=xw(n,0,1),0===t)this.r=this.g=this.b=n;else{var i=n<=.5?n*(1+t):n+t-n*t,a=2*n-i;this.r=_M(a,i,e+1/3),this.g=_M(a,i,e),this.b=_M(a,i,e-1/3)}return Hw.toWorkingColorSpace(this,r),this}},{key:"setStyle",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:uw;function r(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}if(t=/^(\w+)\(([^\)]*)\)/.exec(e)){var i,a=t[1],o=t[2];switch(a){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(i[4]),this.setRGB(Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255,n);if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(i[4]),this.setRGB(Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100,n);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(i[4]),this.setHSL(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(t=/^\#([A-Fa-f\d]+)$/.exec(e)){var s=t[1],u=s.length;if(3===u)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,n);if(6===u)return this.setHex(parseInt(s,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}},{key:"setColorName",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:uw,n=gM[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}},{key:"clone",value:function(){return new this.constructor(this.r,this.g,this.b)}},{key:"copy",value:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}},{key:"copySRGBToLinear",value:function(e){return this.r=Uw(e.r),this.g=Uw(e.g),this.b=Uw(e.b),this}},{key:"copyLinearToSRGB",value:function(e){return this.r=Fw(e.r),this.g=Fw(e.g),this.b=Fw(e.b),this}},{key:"convertSRGBToLinear",value:function(){return this.copySRGBToLinear(this),this}},{key:"convertLinearToSRGB",value:function(){return this.copyLinearToSRGB(this),this}},{key:"getHex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:uw;return Hw.fromWorkingColorSpace(wM.copy(this),e),65536*Math.round(xw(255*wM.r,0,255))+256*Math.round(xw(255*wM.g,0,255))+Math.round(xw(255*wM.b,0,255))}},{key:"getHexString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:uw;return("000000"+this.getHex(e).toString(16)).slice(-6)}},{key:"getHSL",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Hw.workingColorSpace;Hw.fromWorkingColorSpace(wM.copy(this),t);var n,r,i=wM.r,a=wM.g,o=wM.b,s=Math.max(i,a,o),u=Math.min(i,a,o),l=(u+s)/2;if(u===s)n=0,r=0;else{var c=s-u;switch(r=l<=.5?c/(s+u):c/(2-s-u),s){case i:n=(a-o)/c+(a<o?6:0);break;case a:n=(o-i)/c+2;break;case o:n=(i-a)/c+4}n/=6}return e.h=n,e.s=r,e.l=l,e}},{key:"getRGB",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Hw.workingColorSpace;return Hw.fromWorkingColorSpace(wM.copy(this),t),e.r=wM.r,e.g=wM.g,e.b=wM.b,e}},{key:"getStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:uw;Hw.fromWorkingColorSpace(wM.copy(this),e);var t=wM.r,n=wM.g,r=wM.b;return e!==uw?"color(".concat(e," ").concat(t.toFixed(3)," ").concat(n.toFixed(3)," ").concat(r.toFixed(3),")"):"rgb(".concat(Math.round(255*t),",").concat(Math.round(255*n),",").concat(Math.round(255*r),")")}},{key:"offsetHSL",value:function(e,t,n){return this.getHSL(yM),yM.h+=e,yM.s+=t,yM.l+=n,this.setHSL(yM.h,yM.s,yM.l),this}},{key:"add",value:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}},{key:"addColors",value:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}},{key:"addScalar",value:function(e){return this.r+=e,this.g+=e,this.b+=e,this}},{key:"sub",value:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}},{key:"multiply",value:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}},{key:"multiplyScalar",value:function(e){return this.r*=e,this.g*=e,this.b*=e,this}},{key:"lerp",value:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}},{key:"lerpColors",value:function(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}},{key:"lerpHSL",value:function(e,t){this.getHSL(yM),e.getHSL(bM);var n=Sw(yM.h,bM.h,t),r=Sw(yM.s,bM.s,t),i=Sw(yM.l,bM.l,t);return this.setHSL(n,r,i),this}},{key:"setFromVector3",value:function(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}},{key:"applyMatrix3",value:function(e){var t=this.r,n=this.g,r=this.b,i=e.elements;return this.r=i[0]*t+i[3]*n+i[6]*r,this.g=i[1]*t+i[4]*n+i[7]*r,this.b=i[2]*t+i[5]*n+i[8]*r,this}},{key:"equals",value:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}},{key:"fromBufferAttribute",value:function(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}},{key:"toJSON",value:function(){return this.getHex()}},{key:e,value:fr().mark((function e(){return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.r;case 2:return e.next=4,this.g;case 4:return e.next=6,this.b;case 6:case"end":return e.stop()}}),e,this)}))}]),t}(Symbol.iterator),wM=new xM;xM.NAMES=gM;var SM=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).isMeshBasicMaterial=!0,r.type="MeshBasicMaterial",r.color=new xM(16777215),r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=0,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.fog=!0,r.setValues(e),r}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}]),n}(mM);var MM=new tS,kM=new Rw,TM=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((0,u.Z)(this,e),Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=n,this.count=void 0!==t?t.length/n:0,this.normalized=r,this.usage=fw,this.updateRange={offset:0,count:-1},this.version=0}return(0,l.Z)(e,[{key:"onUploadCallback",value:function(){}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"setUsage",value:function(e){return this.usage=e,this}},{key:"copy",value:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}},{key:"copyAt",value:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this}},{key:"copyArray",value:function(e){return this.array.set(e),this}},{key:"applyMatrix3",value:function(e){if(2===this.itemSize)for(var t=0,n=this.count;t<n;t++)kM.fromBufferAttribute(this,t),kM.applyMatrix3(e),this.setXY(t,kM.x,kM.y);else if(3===this.itemSize)for(var r=0,i=this.count;r<i;r++)MM.fromBufferAttribute(this,r),MM.applyMatrix3(e),this.setXYZ(r,MM.x,MM.y,MM.z);return this}},{key:"applyMatrix4",value:function(e){for(var t=0,n=this.count;t<n;t++)MM.fromBufferAttribute(this,t),MM.applyMatrix4(e),this.setXYZ(t,MM.x,MM.y,MM.z);return this}},{key:"applyNormalMatrix",value:function(e){for(var t=0,n=this.count;t<n;t++)MM.fromBufferAttribute(this,t),MM.applyNormalMatrix(e),this.setXYZ(t,MM.x,MM.y,MM.z);return this}},{key:"transformDirection",value:function(e){for(var t=0,n=this.count;t<n;t++)MM.fromBufferAttribute(this,t),MM.transformDirection(e),this.setXYZ(t,MM.x,MM.y,MM.z);return this}},{key:"set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}},{key:"getX",value:function(e){var t=this.array[e*this.itemSize];return this.normalized&&(t=Ew(t,this.array)),t}},{key:"setX",value:function(e,t){return this.normalized&&(t=Cw(t,this.array)),this.array[e*this.itemSize]=t,this}},{key:"getY",value:function(e){var t=this.array[e*this.itemSize+1];return this.normalized&&(t=Ew(t,this.array)),t}},{key:"setY",value:function(e,t){return this.normalized&&(t=Cw(t,this.array)),this.array[e*this.itemSize+1]=t,this}},{key:"getZ",value:function(e){var t=this.array[e*this.itemSize+2];return this.normalized&&(t=Ew(t,this.array)),t}},{key:"setZ",value:function(e,t){return this.normalized&&(t=Cw(t,this.array)),this.array[e*this.itemSize+2]=t,this}},{key:"getW",value:function(e){var t=this.array[e*this.itemSize+3];return this.normalized&&(t=Ew(t,this.array)),t}},{key:"setW",value:function(e,t){return this.normalized&&(t=Cw(t,this.array)),this.array[e*this.itemSize+3]=t,this}},{key:"setXY",value:function(e,t,n){return e*=this.itemSize,this.normalized&&(t=Cw(t,this.array),n=Cw(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}},{key:"setXYZ",value:function(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=Cw(t,this.array),n=Cw(n,this.array),r=Cw(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}},{key:"setXYZW",value:function(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=Cw(t,this.array),n=Cw(n,this.array),r=Cw(r,this.array),i=Cw(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this}},{key:"onUpload",value:function(e){return this.onUploadCallback=e,this}},{key:"clone",value:function(){return new this.constructor(this.array,this.itemSize).copy(this)}},{key:"toJSON",value:function(){var e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==fw&&(e.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(e.updateRange=this.updateRange),e}},{key:"copyColorsArray",value:function(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}},{key:"copyVector2sArray",value:function(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}},{key:"copyVector3sArray",value:function(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}},{key:"copyVector4sArray",value:function(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}]),e}(),EM=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i){return(0,u.Z)(this,n),t.call(this,new Uint16Array(e),r,i)}return(0,l.Z)(n)}(TM),CM=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i){return(0,u.Z)(this,n),t.call(this,new Uint32Array(e),r,i)}return(0,l.Z)(n)}(TM),AM=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i){return(0,u.Z)(this,n),t.call(this,new Float32Array(e),r,i)}return(0,l.Z)(n)}(TM),RM=0,PM=new PS,LM=new nM,DM=new tS,NM=new iS,IM=new iS,OM=new tS,UM=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.call(this)).isBufferGeometry=!0,Object.defineProperty((0,c.Z)(e),"id",{value:RM++}),e.uuid=_w(),e.name="",e.type="BufferGeometry",e.index=null,e.attributes={},e.morphAttributes={},e.morphTargetsRelative=!1,e.groups=[],e.boundingBox=null,e.boundingSphere=null,e.drawRange={start:0,count:1/0},e.userData={},e}return(0,l.Z)(n,[{key:"getIndex",value:function(){return this.index}},{key:"setIndex",value:function(e){return Array.isArray(e)?this.index=new(Dw(e)?CM:EM)(e,1):this.index=e,this}},{key:"getAttribute",value:function(e){return this.attributes[e]}},{key:"setAttribute",value:function(e,t){return this.attributes[e]=t,this}},{key:"deleteAttribute",value:function(e){return delete this.attributes[e],this}},{key:"hasAttribute",value:function(e){return void 0!==this.attributes[e]}},{key:"addGroup",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:n})}},{key:"clearGroups",value:function(){this.groups=[]}},{key:"setDrawRange",value:function(e,t){this.drawRange.start=e,this.drawRange.count=t}},{key:"applyMatrix4",value:function(e){var t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var r=(new Pw).getNormalMatrix(e);n.applyNormalMatrix(r),n.needsUpdate=!0}var i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}},{key:"applyQuaternion",value:function(e){return PM.makeRotationFromQuaternion(e),this.applyMatrix4(PM),this}},{key:"rotateX",value:function(e){return PM.makeRotationX(e),this.applyMatrix4(PM),this}},{key:"rotateY",value:function(e){return PM.makeRotationY(e),this.applyMatrix4(PM),this}},{key:"rotateZ",value:function(e){return PM.makeRotationZ(e),this.applyMatrix4(PM),this}},{key:"translate",value:function(e,t,n){return PM.makeTranslation(e,t,n),this.applyMatrix4(PM),this}},{key:"scale",value:function(e,t,n){return PM.makeScale(e,t,n),this.applyMatrix4(PM),this}},{key:"lookAt",value:function(e){return LM.lookAt(e),LM.updateMatrix(),this.applyMatrix4(LM.matrix),this}},{key:"center",value:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(DM).negate(),this.translate(DM.x,DM.y,DM.z),this}},{key:"setFromPoints",value:function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];t.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new AM(t,3)),this}},{key:"computeBoundingBox",value:function(){null===this.boundingBox&&(this.boundingBox=new iS);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new tS(-1/0,-1/0,-1/0),new tS(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(var n=0,r=t.length;n<r;n++){var i=t[n];NM.setFromBufferAttribute(i),this.morphTargetsRelative?(OM.addVectors(this.boundingBox.min,NM.min),this.boundingBox.expandByPoint(OM),OM.addVectors(this.boundingBox.max,NM.max),this.boundingBox.expandByPoint(OM)):(this.boundingBox.expandByPoint(NM.min),this.boundingBox.expandByPoint(NM.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}},{key:"computeBoundingSphere",value:function(){null===this.boundingSphere&&(this.boundingSphere=new wS);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new tS,1/0);if(e){var n=this.boundingSphere.center;if(NM.setFromBufferAttribute(e),t)for(var r=0,i=t.length;r<i;r++){var a=t[r];IM.setFromBufferAttribute(a),this.morphTargetsRelative?(OM.addVectors(NM.min,IM.min),NM.expandByPoint(OM),OM.addVectors(NM.max,IM.max),NM.expandByPoint(OM)):(NM.expandByPoint(IM.min),NM.expandByPoint(IM.max))}NM.getCenter(n);for(var o=0,s=0,u=e.count;s<u;s++)OM.fromBufferAttribute(e,s),o=Math.max(o,n.distanceToSquared(OM));if(t)for(var l=0,c=t.length;l<c;l++)for(var h=t[l],f=this.morphTargetsRelative,d=0,p=h.count;d<p;d++)OM.fromBufferAttribute(h,d),f&&(DM.fromBufferAttribute(e,d),OM.add(DM)),o=Math.max(o,n.distanceToSquared(OM));this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}},{key:"computeTangents",value:function(){var e=this.index,t=this.attributes;if(null!==e&&void 0!==t.position&&void 0!==t.normal&&void 0!==t.uv){var n=e.array,r=t.position.array,i=t.normal.array,a=t.uv.array,o=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new TM(new Float32Array(4*o),4));for(var s=this.getAttribute("tangent").array,u=[],l=[],c=0;c<o;c++)u[c]=new tS,l[c]=new tS;var h=new tS,f=new tS,d=new tS,p=new Rw,v=new Rw,m=new Rw,g=new tS,y=new tS,b=this.groups;0===b.length&&(b=[{start:0,count:n.length}]);for(var _=0,x=b.length;_<x;++_)for(var w=b[_],S=w.start,M=S,k=S+w.count;M<k;M+=3)O(n[M+0],n[M+1],n[M+2]);for(var T=new tS,E=new tS,C=new tS,A=new tS,R=0,P=b.length;R<P;++R)for(var L=b[R],D=L.start,N=D,I=D+L.count;N<I;N+=3)U(n[N+0]),U(n[N+1]),U(n[N+2])}else console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");function O(e,t,n){h.fromArray(r,3*e),f.fromArray(r,3*t),d.fromArray(r,3*n),p.fromArray(a,2*e),v.fromArray(a,2*t),m.fromArray(a,2*n),f.sub(h),d.sub(h),v.sub(p),m.sub(p);var i=1/(v.x*m.y-m.x*v.y);isFinite(i)&&(g.copy(f).multiplyScalar(m.y).addScaledVector(d,-v.y).multiplyScalar(i),y.copy(d).multiplyScalar(v.x).addScaledVector(f,-m.x).multiplyScalar(i),u[e].add(g),u[t].add(g),u[n].add(g),l[e].add(y),l[t].add(y),l[n].add(y))}function U(e){C.fromArray(i,3*e),A.copy(C);var t=u[e];T.copy(t),T.sub(C.multiplyScalar(C.dot(t))).normalize(),E.crossVectors(A,t);var n=E.dot(l[e])<0?-1:1;s[4*e]=T.x,s[4*e+1]=T.y,s[4*e+2]=T.z,s[4*e+3]=n}}},{key:"computeVertexNormals",value:function(){var e=this.index,t=this.getAttribute("position");if(void 0!==t){var n=this.getAttribute("normal");if(void 0===n)n=new TM(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(var r=0,i=n.count;r<i;r++)n.setXYZ(r,0,0,0);var a=new tS,o=new tS,s=new tS,u=new tS,l=new tS,c=new tS,h=new tS,f=new tS;if(e)for(var d=0,p=e.count;d<p;d+=3){var v=e.getX(d+0),m=e.getX(d+1),g=e.getX(d+2);a.fromBufferAttribute(t,v),o.fromBufferAttribute(t,m),s.fromBufferAttribute(t,g),h.subVectors(s,o),f.subVectors(a,o),h.cross(f),u.fromBufferAttribute(n,v),l.fromBufferAttribute(n,m),c.fromBufferAttribute(n,g),u.add(h),l.add(h),c.add(h),n.setXYZ(v,u.x,u.y,u.z),n.setXYZ(m,l.x,l.y,l.z),n.setXYZ(g,c.x,c.y,c.z)}else for(var y=0,b=t.count;y<b;y+=3)a.fromBufferAttribute(t,y+0),o.fromBufferAttribute(t,y+1),s.fromBufferAttribute(t,y+2),h.subVectors(s,o),f.subVectors(a,o),h.cross(f),n.setXYZ(y+0,h.x,h.y,h.z),n.setXYZ(y+1,h.x,h.y,h.z),n.setXYZ(y+2,h.x,h.y,h.z);this.normalizeNormals(),n.needsUpdate=!0}}},{key:"merge",value:function(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeGeometries() instead."),this}},{key:"normalizeNormals",value:function(){for(var e=this.attributes.normal,t=0,n=e.count;t<n;t++)OM.fromBufferAttribute(e,t),OM.normalize(),e.setXYZ(t,OM.x,OM.y,OM.z)}},{key:"toNonIndexed",value:function(){function e(e,t){for(var n=e.array,r=e.itemSize,i=e.normalized,a=new n.constructor(t.length*r),o=0,s=0,u=0,l=t.length;u<l;u++){o=e.isInterleavedBufferAttribute?t[u]*e.data.stride+e.offset:t[u]*r;for(var c=0;c<r;c++)a[s++]=n[o++]}return new TM(a,r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;var t=new n,r=this.index.array,i=this.attributes;for(var a in i){var o=e(i[a],r);t.setAttribute(a,o)}var s=this.morphAttributes;for(var u in s){for(var l=[],c=s[u],h=0,f=c.length;h<f;h++){var d=e(c[h],r);l.push(d)}t.morphAttributes[u]=l}t.morphTargetsRelative=this.morphTargetsRelative;for(var p=this.groups,v=0,m=p.length;v<m;v++){var g=p[v];t.addGroup(g.start,g.count,g.materialIndex)}return t}},{key:"toJSON",value:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};var r=this.index;null!==r&&(e.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var i=this.attributes;for(var a in i){var o=i[a];e.data.attributes[a]=o.toJSON(e.data)}var s={},u=!1;for(var l in this.morphAttributes){for(var c=this.morphAttributes[l],h=[],f=0,d=c.length;f<d;f++){var p=c[f];h.push(p.toJSON(e.data))}h.length>0&&(s[l]=h,u=!0)}u&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);var v=this.groups;v.length>0&&(e.data.groups=JSON.parse(JSON.stringify(v)));var m=this.boundingSphere;return null!==m&&(e.data.boundingSphere={center:m.center.toArray(),radius:m.radius}),e}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var t={};this.name=e.name;var n=e.index;null!==n&&this.setIndex(n.clone(t));var r=e.attributes;for(var i in r){var a=r[i];this.setAttribute(i,a.clone(t))}var o=e.morphAttributes;for(var s in o){for(var u=[],l=o[s],c=0,h=l.length;c<h;c++)u.push(l[c].clone(t));this.morphAttributes[s]=u}this.morphTargetsRelative=e.morphTargetsRelative;for(var f=e.groups,d=0,p=f.length;d<p;d++){var v=f[d];this.addGroup(v.start,v.count,v.materialIndex)}var m=e.boundingBox;null!==m&&(this.boundingBox=m.clone());var g=e.boundingSphere;return null!==g&&(this.boundingSphere=g.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),n}(vw),FM=new PS,zM=new RS,BM=new wS,VM=new tS,GM=new tS,jM=new tS,HM=new tS,WM=new tS,ZM=new tS,qM=new Rw,XM=new Rw,YM=new Rw,KM=new tS,JM=new tS,QM=new tS,$M=new tS,ek=new tS,tk=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new UM,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new SM;return(0,u.Z)(this,n),(e=t.call(this)).isMesh=!0,e.type="Mesh",e.geometry=r,e.material=i,e.updateMorphTargets(),e}return(0,l.Z)(n,[{key:"copy",value:function(e,t){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}},{key:"updateMorphTargets",value:function(){var e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){var n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var r=0,i=n.length;r<i;r++){var a=n[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}},{key:"getVertexPosition",value:function(e,t){var n=this.geometry,r=n.attributes.position,i=n.morphAttributes.position,a=n.morphTargetsRelative;t.fromBufferAttribute(r,e);var o=this.morphTargetInfluences;if(i&&o){ZM.set(0,0,0);for(var s=0,u=i.length;s<u;s++){var l=o[s],c=i[s];0!==l&&(WM.fromBufferAttribute(c,e),a?ZM.addScaledVector(WM,l):ZM.addScaledVector(WM.sub(t),l))}t.add(ZM)}return t}},{key:"raycast",value:function(e,t){var n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0!==r){if(null===n.boundingSphere&&n.computeBoundingSphere(),BM.copy(n.boundingSphere),BM.applyMatrix4(i),zM.copy(e.ray).recast(e.near),!1===BM.containsPoint(zM.origin)){if(null===zM.intersectSphere(BM,VM))return;if(zM.origin.distanceToSquared(VM)>Math.pow(e.far-e.near,2))return}FM.copy(i).invert(),zM.copy(e.ray).applyMatrix4(FM),null!==n.boundingBox&&!1===zM.intersectsBox(n.boundingBox)||this._computeIntersections(e,t)}}},{key:"_computeIntersections",value:function(e,t){var n,r=this.geometry,i=this.material,a=r.index,o=r.attributes.position,s=r.attributes.uv,u=r.attributes.uv1,l=r.attributes.normal,c=r.groups,h=r.drawRange;if(null!==a)if(Array.isArray(i))for(var f=0,d=c.length;f<d;f++)for(var p=c[f],v=i[p.materialIndex],m=Math.max(p.start,h.start),g=Math.min(a.count,Math.min(p.start+p.count,h.start+h.count));m<g;m+=3){var y=a.getX(m),b=a.getX(m+1),_=a.getX(m+2);(n=nk(this,v,e,zM,s,u,l,y,b,_))&&(n.faceIndex=Math.floor(m/3),n.face.materialIndex=p.materialIndex,t.push(n))}else for(var x=Math.max(0,h.start),w=Math.min(a.count,h.start+h.count);x<w;x+=3){var S=a.getX(x),M=a.getX(x+1),k=a.getX(x+2);(n=nk(this,i,e,zM,s,u,l,S,M,k))&&(n.faceIndex=Math.floor(x/3),t.push(n))}else if(void 0!==o)if(Array.isArray(i))for(var T=0,E=c.length;T<E;T++)for(var C=c[T],A=i[C.materialIndex],R=Math.max(C.start,h.start),P=Math.min(o.count,Math.min(C.start+C.count,h.start+h.count));R<P;R+=3){(n=nk(this,A,e,zM,s,u,l,R,R+1,R+2))&&(n.faceIndex=Math.floor(R/3),n.face.materialIndex=C.materialIndex,t.push(n))}else for(var L=Math.max(0,h.start),D=Math.min(o.count,h.start+h.count);L<D;L+=3){(n=nk(this,i,e,zM,s,u,l,L,L+1,L+2))&&(n.faceIndex=Math.floor(L/3),t.push(n))}}}]),n}(nM);function nk(e,t,n,r,i,a,o,s,u,l){e.getVertexPosition(s,GM),e.getVertexPosition(u,jM),e.getVertexPosition(l,HM);var c=function(e,t,n,r,i,a,o,s){if(null===(1===t.side?r.intersectTriangle(o,a,i,!0,s):r.intersectTriangle(i,a,o,0===t.side,s)))return null;ek.copy(s),ek.applyMatrix4(e.matrixWorld);var u=n.ray.origin.distanceTo(ek);return u<n.near||u>n.far?null:{distance:u,point:ek.clone(),object:e}}(e,t,n,r,GM,jM,HM,$M);if(c){i&&(qM.fromBufferAttribute(i,s),XM.fromBufferAttribute(i,u),YM.fromBufferAttribute(i,l),c.uv=pM.getInterpolation($M,GM,jM,HM,qM,XM,YM,new Rw)),a&&(qM.fromBufferAttribute(a,s),XM.fromBufferAttribute(a,u),YM.fromBufferAttribute(a,l),c.uv1=pM.getInterpolation($M,GM,jM,HM,qM,XM,YM,new Rw),c.uv2=c.uv1),o&&(KM.fromBufferAttribute(o,s),JM.fromBufferAttribute(o,u),QM.fromBufferAttribute(o,l),c.normal=pM.getInterpolation($M,GM,jM,HM,KM,JM,QM,new tS),c.normal.dot(r.direction)>0&&c.normal.multiplyScalar(-1));var h={a:s,b:u,c:l,normal:new tS,materialIndex:0};pM.getNormal(GM,jM,HM,h.normal),c.face=h}return c}var rk=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;(0,u.Z)(this,n),(e=t.call(this)).type="BoxGeometry",e.parameters={width:r,height:i,depth:a,widthSegments:o,heightSegments:s,depthSegments:l};var h=(0,c.Z)(e);o=Math.floor(o),s=Math.floor(s),l=Math.floor(l);var f=[],d=[],p=[],v=[],m=0,g=0;function y(e,t,n,r,i,a,o,s,u,l,c){for(var y=a/u,b=o/l,_=a/2,x=o/2,w=s/2,S=u+1,M=l+1,k=0,T=0,E=new tS,C=0;C<M;C++)for(var A=C*b-x,R=0;R<S;R++){var P=R*y-_;E[e]=P*r,E[t]=A*i,E[n]=w,d.push(E.x,E.y,E.z),E[e]=0,E[t]=0,E[n]=s>0?1:-1,p.push(E.x,E.y,E.z),v.push(R/u),v.push(1-C/l),k+=1}for(var L=0;L<l;L++)for(var D=0;D<u;D++){var N=m+D+S*L,I=m+D+S*(L+1),O=m+(D+1)+S*(L+1),U=m+(D+1)+S*L;f.push(N,I,U),f.push(I,O,U),T+=6}h.addGroup(g,T,c),g+=T,m+=k}return y("z","y","x",-1,-1,a,i,r,l,s,0),y("z","y","x",1,-1,a,i,-r,l,s,1),y("x","z","y",1,1,r,a,i,o,l,2),y("x","z","y",1,-1,r,a,-i,o,l,3),y("x","y","z",1,-1,r,i,a,o,s,4),y("x","y","z",-1,-1,r,i,-a,o,s,5),e.setIndex(f),e.setAttribute("position",new AM(d,3)),e.setAttribute("normal",new AM(p,3)),e.setAttribute("uv",new AM(v,2)),e}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new n(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}]),n}(UM);function ik(e){var t={};for(var n in e)for(var r in t[n]={},e[n]){var i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[n][r]=null):t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}return t}function ak(e){for(var t={},n=0;n<e.length;n++){var r=ik(e[n]);for(var i in r)t[i]=r[i]}return t}function ok(e){return null===e.getRenderTarget()?e.outputColorSpace:lw}var sk={clone:ik,merge:ak},uk=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).isShaderMaterial=!0,r.type="ShaderMaterial",r.defines={},r.uniforms={},r.uniformsGroups=[],r.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",r.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",r.linewidth=1,r.wireframe=!1,r.wireframeLinewidth=1,r.fog=!1,r.lights=!1,r.clipping=!1,r.forceSinglePass=!0,r.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},r.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},r.index0AttributeName=void 0,r.uniformsNeedUpdate=!1,r.glslVersion=null,void 0!==e&&r.setValues(e),r}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=ik(e.uniforms),this.uniformsGroups=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}},{key:"toJSON",value:function(e){var t=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this,e);for(var r in t.glslVersion=this.glslVersion,t.uniforms={},this.uniforms){var i=this.uniforms[r].value;i&&i.isTexture?t.uniforms[r]={type:"t",value:i.toJSON(e).uuid}:i&&i.isColor?t.uniforms[r]={type:"c",value:i.getHex()}:i&&i.isVector2?t.uniforms[r]={type:"v2",value:i.toArray()}:i&&i.isVector3?t.uniforms[r]={type:"v3",value:i.toArray()}:i&&i.isVector4?t.uniforms[r]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?t.uniforms[r]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?t.uniforms[r]={type:"m4",value:i.toArray()}:t.uniforms[r]={value:i}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;var a={};for(var o in this.extensions)!0===this.extensions[o]&&(a[o]=!0);return Object.keys(a).length>0&&(t.extensions=a),t}}]),n}(mM),lk=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.call(this)).isCamera=!0,e.type="Camera",e.matrixWorldInverse=new PS,e.projectionMatrix=new PS,e.projectionMatrixInverse=new PS,e}return(0,l.Z)(n,[{key:"copy",value:function(e,t){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}},{key:"getWorldDirection",value:function(e){this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}},{key:"updateMatrixWorld",value:function(e){wr((0,_r.Z)(n.prototype),"updateMatrixWorld",this).call(this,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}},{key:"updateWorldMatrix",value:function(e,t){wr((0,_r.Z)(n.prototype),"updateWorldMatrix",this).call(this,e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),n}(nM),ck=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;return(0,u.Z)(this,n),(e=t.call(this)).isPerspectiveCamera=!0,e.type="PerspectiveCamera",e.fov=r,e.zoom=1,e.near=a,e.far=o,e.focus=10,e.aspect=i,e.view=null,e.filmGauge=35,e.filmOffset=0,e.updateProjectionMatrix(),e}return(0,l.Z)(n,[{key:"copy",value:function(e,t){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}},{key:"setFocalLength",value:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*bw*Math.atan(t),this.updateProjectionMatrix()}},{key:"getFocalLength",value:function(){var e=Math.tan(.5*yw*this.fov);return.5*this.getFilmHeight()/e}},{key:"getEffectiveFOV",value:function(){return 2*bw*Math.atan(Math.tan(.5*yw*this.fov)/this.zoom)}},{key:"getFilmWidth",value:function(){return this.filmGauge*Math.min(this.aspect,1)}},{key:"getFilmHeight",value:function(){return this.filmGauge/Math.max(this.aspect,1)}},{key:"setViewOffset",value:function(e,t,n,r,i,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}},{key:"clearViewOffset",value:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}},{key:"updateProjectionMatrix",value:function(){var e=this.near,t=e*Math.tan(.5*yw*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r,a=this.view;if(null!==this.view&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;i+=a.offsetX*r/o,t-=a.offsetY*n/s,r*=a.width/o,n*=a.height/s}var u=this.filmOffset;0!==u&&(i+=e*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}},{key:"toJSON",value:function(e){var t=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}]),n}(lk),hk=-90,fk=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i){var a;(0,u.Z)(this,n),(a=t.call(this)).type="CubeCamera",a.renderTarget=i;var o=new ck(hk,1,e,r);o.layers=a.layers,o.up.set(0,1,0),o.lookAt(1,0,0),a.add(o);var s=new ck(hk,1,e,r);s.layers=a.layers,s.up.set(0,1,0),s.lookAt(-1,0,0),a.add(s);var l=new ck(hk,1,e,r);l.layers=a.layers,l.up.set(0,0,-1),l.lookAt(0,1,0),a.add(l);var c=new ck(hk,1,e,r);c.layers=a.layers,c.up.set(0,0,1),c.lookAt(0,-1,0),a.add(c);var h=new ck(hk,1,e,r);h.layers=a.layers,h.up.set(0,1,0),h.lookAt(0,0,1),a.add(h);var f=new ck(hk,1,e,r);return f.layers=a.layers,f.up.set(0,1,0),f.lookAt(0,0,-1),a.add(f),a}return(0,l.Z)(n,[{key:"update",value:function(e,t){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,r=vr(this.children,6),i=r[0],a=r[1],o=r[2],s=r[3],u=r[4],l=r[5],c=e.getRenderTarget(),h=e.toneMapping,f=e.xr.enabled;e.toneMapping=0,e.xr.enabled=!1;var d=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,i),e.setRenderTarget(n,1),e.render(t,a),e.setRenderTarget(n,2),e.render(t,o),e.setRenderTarget(n,3),e.render(t,s),e.setRenderTarget(n,4),e.render(t,u),n.texture.generateMipmaps=d,e.setRenderTarget(n,5),e.render(t,l),e.setRenderTarget(c),e.toneMapping=h,e.xr.enabled=f,n.texture.needsPMREMUpdate=!0}}]),n}(nM),dk=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i,a,o,s,l,c,h,f){var d;return(0,u.Z)(this,n),e=void 0!==e?e:[],r=void 0!==r?r:rx,(d=t.call(this,e,r,i,a,o,s,l,c,h,f)).isCubeTexture=!0,d.flipY=!1,d}return(0,l.Z)(n,[{key:"images",get:function(){return this.image},set:function(e){this.image=e}}]),n}(Yw),pk=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,u.Z)(this,n),(e=t.call(this,r,r,i)).isWebGLCubeRenderTarget=!0;var a={width:r,height:r,depth:1},o=[a,a,a,a,a,a];return void 0!==i.encoding&&(Ow("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===ow?uw:sw),e.texture=new dk(o,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),e.texture.isRenderTargetTexture=!0,e.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,e.texture.minFilter=void 0!==i.minFilter?i.minFilter:px,e}return(0,l.Z)(n,[{key:"fromEquirectangularTexture",value:function(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;var n={tEquirect:{value:null}},r="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",a=new rk(5,5,5),o=new uk({name:"CubemapFromEquirect",uniforms:ik(n),vertexShader:r,fragmentShader:i,side:1,blending:0});o.uniforms.tEquirect.value=t;var s=new tk(a,o),u=t.minFilter;return t.minFilter===vx&&(t.minFilter=px),new fk(1,10,this).update(e,s),t.minFilter=u,s.geometry.dispose(),s.material.dispose(),this}},{key:"clear",value:function(e,t,n,r){for(var i=e.getRenderTarget(),a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,r);e.setRenderTarget(i)}}]),n}(Jw),vk=new tS,mk=new tS,gk=new Pw,yk=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new tS(1,0,0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,u.Z)(this,e),this.isPlane=!0,this.normal=t,this.constant=n}return(0,l.Z)(e,[{key:"set",value:function(e,t){return this.normal.copy(e),this.constant=t,this}},{key:"setComponents",value:function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}},{key:"setFromNormalAndCoplanarPoint",value:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}},{key:"setFromCoplanarPoints",value:function(e,t,n){var r=vk.subVectors(n,t).cross(mk.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}},{key:"copy",value:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this}},{key:"normalize",value:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}},{key:"negate",value:function(){return this.constant*=-1,this.normal.negate(),this}},{key:"distanceToPoint",value:function(e){return this.normal.dot(e)+this.constant}},{key:"distanceToSphere",value:function(e){return this.distanceToPoint(e.center)-e.radius}},{key:"projectPoint",value:function(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}},{key:"intersectLine",value:function(e,t){var n=e.delta(vk),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;var i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(e.start).addScaledVector(n,i)}},{key:"intersectsLine",value:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}},{key:"intersectsBox",value:function(e){return e.intersectsPlane(this)}},{key:"intersectsSphere",value:function(e){return e.intersectsPlane(this)}},{key:"coplanarPoint",value:function(e){return e.copy(this.normal).multiplyScalar(-this.constant)}},{key:"applyMatrix4",value:function(e,t){var n=t||gk.getNormalMatrix(e),r=this.coplanarPoint(vk).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}},{key:"translate",value:function(e){return this.constant-=e.dot(this.normal),this}},{key:"equals",value:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),bk=new wS,_k=new tS,xk=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yk,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yk,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new yk,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new yk,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new yk,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new yk;(0,u.Z)(this,e),this.planes=[t,n,r,i,a,o]}return(0,l.Z)(e,[{key:"set",value:function(e,t,n,r,i,a){var o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(r),o[4].copy(i),o[5].copy(a),this}},{key:"copy",value:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this}},{key:"setFromProjectionMatrix",value:function(e){var t=this.planes,n=e.elements,r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],u=n[5],l=n[6],c=n[7],h=n[8],f=n[9],d=n[10],p=n[11],v=n[12],m=n[13],g=n[14],y=n[15];return t[0].setComponents(o-r,c-s,p-h,y-v).normalize(),t[1].setComponents(o+r,c+s,p+h,y+v).normalize(),t[2].setComponents(o+i,c+u,p+f,y+m).normalize(),t[3].setComponents(o-i,c-u,p-f,y-m).normalize(),t[4].setComponents(o-a,c-l,p-d,y-g).normalize(),t[5].setComponents(o+a,c+l,p+d,y+g).normalize(),this}},{key:"intersectsObject",value:function(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),bk.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{var t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),bk.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(bk)}},{key:"intersectsSprite",value:function(e){return bk.center.set(0,0,0),bk.radius=.7071067811865476,bk.applyMatrix4(e.matrixWorld),this.intersectsSphere(bk)}},{key:"intersectsSphere",value:function(e){for(var t=this.planes,n=e.center,r=-e.radius,i=0;i<6;i++){if(t[i].distanceToPoint(n)<r)return!1}return!0}},{key:"intersectsBox",value:function(e){for(var t=this.planes,n=0;n<6;n++){var r=t[n];if(_k.x=r.normal.x>0?e.max.x:e.min.x,_k.y=r.normal.y>0?e.max.y:e.min.y,_k.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(_k)<0)return!1}return!0}},{key:"containsPoint",value:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}();function wk(){var e=null,t=!1,n=null,r=null;function i(t,a){n(t,a),r=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function Sk(e,t){var n=t.isWebGL2,r=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),r.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);var n=r.get(t);n&&(e.deleteBuffer(n.buffer),r.delete(t))},update:function(t,i){if(t.isGLBufferAttribute){var a=r.get(t);(!a||a.version<t.version)&&r.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version})}else{t.isInterleavedBufferAttribute&&(t=t.data);var o=r.get(t);void 0===o?r.set(t,function(t,r){var i,a=t.array,o=t.usage,s=e.createBuffer();if(e.bindBuffer(r,s),e.bufferData(r,a,o),t.onUploadCallback(),a instanceof Float32Array)i=e.FLOAT;else if(a instanceof Uint16Array)if(t.isFloat16BufferAttribute){if(!n)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");i=e.HALF_FLOAT}else i=e.UNSIGNED_SHORT;else if(a instanceof Int16Array)i=e.SHORT;else if(a instanceof Uint32Array)i=e.UNSIGNED_INT;else if(a instanceof Int32Array)i=e.INT;else if(a instanceof Int8Array)i=e.BYTE;else if(a instanceof Uint8Array)i=e.UNSIGNED_BYTE;else{if(!(a instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+a);i=e.UNSIGNED_BYTE}return{buffer:s,type:i,bytesPerElement:a.BYTES_PER_ELEMENT,version:t.version}}(t,i)):o.version<t.version&&(!function(t,r,i){var a=r.array,o=r.updateRange;e.bindBuffer(i,t),-1===o.count?e.bufferSubData(i,0,a):(n?e.bufferSubData(i,o.offset*a.BYTES_PER_ELEMENT,a,o.offset,o.count):e.bufferSubData(i,o.offset*a.BYTES_PER_ELEMENT,a.subarray(o.offset,o.offset+o.count)),o.count=-1),r.onUploadCallback()}(o.buffer,t,i),o.version=t.version)}}}}var Mk=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;(0,u.Z)(this,n),(e=t.call(this)).type="PlaneGeometry",e.parameters={width:r,height:i,widthSegments:a,heightSegments:o};for(var s=r/2,l=i/2,c=Math.floor(a),h=Math.floor(o),f=c+1,d=h+1,p=r/c,v=i/h,m=[],g=[],y=[],b=[],_=0;_<d;_++)for(var x=_*v-l,w=0;w<f;w++){var S=w*p-s;g.push(S,-x,0),y.push(0,0,1),b.push(w/c),b.push(1-_/h)}for(var M=0;M<h;M++)for(var k=0;k<c;k++){var T=k+f*M,E=k+f*(M+1),C=k+1+f*(M+1),A=k+1+f*M;m.push(T,E,A),m.push(E,C,A)}return e.setIndex(m),e.setAttribute("position",new AM(g,3)),e.setAttribute("normal",new AM(y,3)),e.setAttribute("uv",new AM(b,2)),e}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new n(e.width,e.height,e.widthSegments,e.heightSegments)}}]),n}(UM),kk={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, vMapUv );\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_NORMALMAP_TANGENTSPACE\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal, vNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#ifdef USE_UV\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},Tk={common:{diffuse:{value:new xM(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Pw},alphaMap:{value:null},alphaMapTransform:{value:new Pw},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Pw}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Pw}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Pw}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Pw},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Pw},normalScale:{value:new Rw(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Pw},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Pw}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Pw}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Pw}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new xM(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new xM(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Pw}},sprite:{diffuse:{value:new xM(16777215)},opacity:{value:1},center:{value:new Rw(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Pw},alphaMap:{value:null},alphaTest:{value:0}}},Ek={basic:{uniforms:ak([Tk.common,Tk.specularmap,Tk.envmap,Tk.aomap,Tk.lightmap,Tk.fog]),vertexShader:kk.meshbasic_vert,fragmentShader:kk.meshbasic_frag},lambert:{uniforms:ak([Tk.common,Tk.specularmap,Tk.envmap,Tk.aomap,Tk.lightmap,Tk.emissivemap,Tk.bumpmap,Tk.normalmap,Tk.displacementmap,Tk.fog,Tk.lights,{emissive:{value:new xM(0)}}]),vertexShader:kk.meshlambert_vert,fragmentShader:kk.meshlambert_frag},phong:{uniforms:ak([Tk.common,Tk.specularmap,Tk.envmap,Tk.aomap,Tk.lightmap,Tk.emissivemap,Tk.bumpmap,Tk.normalmap,Tk.displacementmap,Tk.fog,Tk.lights,{emissive:{value:new xM(0)},specular:{value:new xM(1118481)},shininess:{value:30}}]),vertexShader:kk.meshphong_vert,fragmentShader:kk.meshphong_frag},standard:{uniforms:ak([Tk.common,Tk.envmap,Tk.aomap,Tk.lightmap,Tk.emissivemap,Tk.bumpmap,Tk.normalmap,Tk.displacementmap,Tk.roughnessmap,Tk.metalnessmap,Tk.fog,Tk.lights,{emissive:{value:new xM(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:kk.meshphysical_vert,fragmentShader:kk.meshphysical_frag},toon:{uniforms:ak([Tk.common,Tk.aomap,Tk.lightmap,Tk.emissivemap,Tk.bumpmap,Tk.normalmap,Tk.displacementmap,Tk.gradientmap,Tk.fog,Tk.lights,{emissive:{value:new xM(0)}}]),vertexShader:kk.meshtoon_vert,fragmentShader:kk.meshtoon_frag},matcap:{uniforms:ak([Tk.common,Tk.bumpmap,Tk.normalmap,Tk.displacementmap,Tk.fog,{matcap:{value:null}}]),vertexShader:kk.meshmatcap_vert,fragmentShader:kk.meshmatcap_frag},points:{uniforms:ak([Tk.points,Tk.fog]),vertexShader:kk.points_vert,fragmentShader:kk.points_frag},dashed:{uniforms:ak([Tk.common,Tk.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:kk.linedashed_vert,fragmentShader:kk.linedashed_frag},depth:{uniforms:ak([Tk.common,Tk.displacementmap]),vertexShader:kk.depth_vert,fragmentShader:kk.depth_frag},normal:{uniforms:ak([Tk.common,Tk.bumpmap,Tk.normalmap,Tk.displacementmap,{opacity:{value:1}}]),vertexShader:kk.meshnormal_vert,fragmentShader:kk.meshnormal_frag},sprite:{uniforms:ak([Tk.sprite,Tk.fog]),vertexShader:kk.sprite_vert,fragmentShader:kk.sprite_frag},background:{uniforms:{uvTransform:{value:new Pw},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:kk.background_vert,fragmentShader:kk.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:kk.backgroundCube_vert,fragmentShader:kk.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:kk.cube_vert,fragmentShader:kk.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:kk.equirect_vert,fragmentShader:kk.equirect_frag},distanceRGBA:{uniforms:ak([Tk.common,Tk.displacementmap,{referencePosition:{value:new tS},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:kk.distanceRGBA_vert,fragmentShader:kk.distanceRGBA_frag},shadow:{uniforms:ak([Tk.lights,Tk.fog,{color:{value:new xM(0)},opacity:{value:1}}]),vertexShader:kk.shadow_vert,fragmentShader:kk.shadow_frag}};Ek.physical={uniforms:ak([Ek.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Pw},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Pw},clearcoatNormalScale:{value:new Rw(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Pw},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Pw},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Pw},sheen:{value:0},sheenColor:{value:new xM(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Pw},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Pw},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Pw},transmissionSamplerSize:{value:new Rw},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Pw},attenuationDistance:{value:0},attenuationColor:{value:new xM(0)},specularColor:{value:new xM(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Pw},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Pw}}]),vertexShader:kk.meshphysical_vert,fragmentShader:kk.meshphysical_frag};var Ck={r:0,b:0,g:0};function Ak(e,t,n,r,i,a,o){var s,u,l=new xM(0),c=!0===a?0:1,h=null,f=0,d=null;function p(t,n){t.getRGB(Ck,ok(e)),r.buffers.color.setClear(Ck.r,Ck.g,Ck.b,n,o)}return{getClearColor:function(){return l},setClearColor:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;l.set(e),p(l,c=t)},getClearAlpha:function(){return c},setClearAlpha:function(e){p(l,c=e)},render:function(a,v){var m=!1,g=!0===v.isScene?v.background:null;switch(g&&g.isTexture&&(g=(v.backgroundBlurriness>0?n:t).get(g)),null===g?p(l,c):g&&g.isColor&&(p(g,1),m=!0),e.xr.getEnvironmentBlendMode()){case"opaque":m=!0;break;case"additive":r.buffers.color.setClear(0,0,0,1,o),m=!0;break;case"alpha-blend":r.buffers.color.setClear(0,0,0,0,o),m=!0}(e.autoClear||m)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),g&&(g.isCubeTexture||g.mapping===sx)?(void 0===u&&((u=new tk(new rk(1,1,1),new uk({name:"BackgroundCubeMaterial",uniforms:ik(Ek.backgroundCube.uniforms),vertexShader:Ek.backgroundCube.vertexShader,fragmentShader:Ek.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(u)),u.material.uniforms.envMap.value=g,u.material.uniforms.flipEnvMap.value=g.isCubeTexture&&!1===g.isRenderTargetTexture?-1:1,u.material.uniforms.backgroundBlurriness.value=v.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,u.material.toneMapped=g.colorSpace!==uw,h===g&&f===g.version&&d===e.toneMapping||(u.material.needsUpdate=!0,h=g,f=g.version,d=e.toneMapping),u.layers.enableAll(),a.unshift(u,u.geometry,u.material,0,0,null)):g&&g.isTexture&&(void 0===s&&((s=new tk(new Mk(2,2),new uk({name:"BackgroundMaterial",uniforms:ik(Ek.background.uniforms),vertexShader:Ek.background.vertexShader,fragmentShader:Ek.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(s.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(s)),s.material.uniforms.t2D.value=g,s.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,s.material.toneMapped=g.colorSpace!==uw,!0===g.matrixAutoUpdate&&g.updateMatrix(),s.material.uniforms.uvTransform.value.copy(g.matrix),h===g&&f===g.version&&d===e.toneMapping||(s.material.needsUpdate=!0,h=g,f=g.version,d=e.toneMapping),s.layers.enableAll(),a.unshift(s,s.geometry,s.material,0,0,null))}}}function Rk(e,t,n,r){var i=e.getParameter(e.MAX_VERTEX_ATTRIBS),a=r.isWebGL2?null:t.get("OES_vertex_array_object"),o=r.isWebGL2||null!==a,s={},u=d(null),l=u,c=!1;function h(t){return r.isWebGL2?e.bindVertexArray(t):a.bindVertexArrayOES(t)}function f(t){return r.isWebGL2?e.deleteVertexArray(t):a.deleteVertexArrayOES(t)}function d(e){for(var t=[],n=[],r=[],a=0;a<i;a++)t[a]=0,n[a]=0,r[a]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:r,object:e,attributes:{},index:null}}function p(){for(var e=l.newAttributes,t=0,n=e.length;t<n;t++)e[t]=0}function v(e){m(e,0)}function m(n,i){var a=l.newAttributes,o=l.enabledAttributes,s=l.attributeDivisors;(a[n]=1,0===o[n]&&(e.enableVertexAttribArray(n),o[n]=1),s[n]!==i)&&((r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),s[n]=i)}function g(){for(var t=l.newAttributes,n=l.enabledAttributes,r=0,i=n.length;r<i;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function y(t,n,i,a,o,s){!0!==r.isWebGL2||i!==e.INT&&i!==e.UNSIGNED_INT?e.vertexAttribPointer(t,n,i,a,o,s):e.vertexAttribIPointer(t,n,i,o,s)}function b(){_(),c=!0,l!==u&&h((l=u).object)}function _(){u.geometry=null,u.program=null,u.wireframe=!1}return{setup:function(i,u,f,b,_){var x=!1;if(o){var w=function(t,n,i){var o=!0===i.wireframe,u=s[t.id];void 0===u&&(u={},s[t.id]=u);var l=u[n.id];void 0===l&&(l={},u[n.id]=l);var c=l[o];void 0===c&&(c=d(r.isWebGL2?e.createVertexArray():a.createVertexArrayOES()),l[o]=c);return c}(b,f,u);l!==w&&h((l=w).object),x=function(e,t,n,r){var i=l.attributes,a=t.attributes,o=0,s=n.getAttributes();for(var u in s){if(s[u].location>=0){var c=i[u],h=a[u];if(void 0===h&&("instanceMatrix"===u&&e.instanceMatrix&&(h=e.instanceMatrix),"instanceColor"===u&&e.instanceColor&&(h=e.instanceColor)),void 0===c)return!0;if(c.attribute!==h)return!0;if(h&&c.data!==h.data)return!0;o++}}return l.attributesNum!==o||l.index!==r}(i,b,f,_),x&&function(e,t,n,r){var i={},a=t.attributes,o=0,s=n.getAttributes();for(var u in s){if(s[u].location>=0){var c=a[u];void 0===c&&("instanceMatrix"===u&&e.instanceMatrix&&(c=e.instanceMatrix),"instanceColor"===u&&e.instanceColor&&(c=e.instanceColor));var h={};h.attribute=c,c&&c.data&&(h.data=c.data),i[u]=h,o++}}l.attributes=i,l.attributesNum=o,l.index=r}(i,b,f,_)}else{var S=!0===u.wireframe;l.geometry===b.id&&l.program===f.id&&l.wireframe===S||(l.geometry=b.id,l.program=f.id,l.wireframe=S,x=!0)}null!==_&&n.update(_,e.ELEMENT_ARRAY_BUFFER),(x||c)&&(c=!1,function(i,a,o,s){if(!1===r.isWebGL2&&(i.isInstancedMesh||s.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;p();var u=s.attributes,l=o.getAttributes(),c=a.defaultAttributeValues;for(var h in l){var f=l[h];if(f.location>=0){var d=u[h];if(void 0===d&&("instanceMatrix"===h&&i.instanceMatrix&&(d=i.instanceMatrix),"instanceColor"===h&&i.instanceColor&&(d=i.instanceColor)),void 0!==d){var b=d.normalized,_=d.itemSize,x=n.get(d);if(void 0===x)continue;var w=x.buffer,S=x.type,M=x.bytesPerElement;if(d.isInterleavedBufferAttribute){var k=d.data,T=k.stride,E=d.offset;if(k.isInstancedInterleavedBuffer){for(var C=0;C<f.locationSize;C++)m(f.location+C,k.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=k.meshPerAttribute*k.count)}else for(var A=0;A<f.locationSize;A++)v(f.location+A);e.bindBuffer(e.ARRAY_BUFFER,w);for(var R=0;R<f.locationSize;R++)y(f.location+R,_/f.locationSize,S,b,T*M,(E+_/f.locationSize*R)*M)}else{if(d.isInstancedBufferAttribute){for(var P=0;P<f.locationSize;P++)m(f.location+P,d.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=d.meshPerAttribute*d.count)}else for(var L=0;L<f.locationSize;L++)v(f.location+L);e.bindBuffer(e.ARRAY_BUFFER,w);for(var D=0;D<f.locationSize;D++)y(f.location+D,_/f.locationSize,S,b,_*M,_/f.locationSize*D*M)}}else if(void 0!==c){var N=c[h];if(void 0!==N)switch(N.length){case 2:e.vertexAttrib2fv(f.location,N);break;case 3:e.vertexAttrib3fv(f.location,N);break;case 4:e.vertexAttrib4fv(f.location,N);break;default:e.vertexAttrib1fv(f.location,N)}}}}g()}(i,u,f,b),null!==_&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n.get(_).buffer))},reset:b,resetDefaultState:_,dispose:function(){for(var e in b(),s){var t=s[e];for(var n in t){var r=t[n];for(var i in r)f(r[i].object),delete r[i];delete t[n]}delete s[e]}},releaseStatesOfGeometry:function(e){if(void 0!==s[e.id]){var t=s[e.id];for(var n in t){var r=t[n];for(var i in r)f(r[i].object),delete r[i];delete t[n]}delete s[e.id]}},releaseStatesOfProgram:function(e){for(var t in s){var n=s[t];if(void 0!==n[e.id]){var r=n[e.id];for(var i in r)f(r[i].object),delete r[i];delete n[e.id]}}},initAttributes:p,enableAttribute:v,disableUnusedAttributes:g}}function Pk(e,t,n,r){var i,a=r.isWebGL2;this.setMode=function(e){i=e},this.render=function(t,r){e.drawArrays(i,t,r),n.update(r,i,1)},this.renderInstances=function(r,o,s){if(0!==s){var u,l;if(a)u=e,l="drawArraysInstanced";else if(l="drawArraysInstancedANGLE",null===(u=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[l](i,r,o,s),n.update(o,i,s)}}}function Lk(e,t,n){var r;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var a="undefined"!==typeof WebGL2RenderingContext&&"WebGL2RenderingContext"===e.constructor.name,o=void 0!==n.precision?n.precision:"highp",s=i(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);var u=a||t.has("WEBGL_draw_buffers"),l=!0===n.logarithmicDepthBuffer,c=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),h=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),f=e.getParameter(e.MAX_TEXTURE_SIZE),d=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),p=e.getParameter(e.MAX_VERTEX_ATTRIBS),v=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),m=e.getParameter(e.MAX_VARYING_VECTORS),g=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),y=h>0,b=a||t.has("OES_texture_float");return{isWebGL2:a,drawBuffers:u,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===t.has("EXT_texture_filter_anisotropic")){var n=t.get("EXT_texture_filter_anisotropic");r=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:i,precision:o,logarithmicDepthBuffer:l,maxTextures:c,maxVertexTextures:h,maxTextureSize:f,maxCubemapSize:d,maxAttributes:p,maxVertexUniforms:v,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:y,floatFragmentTextures:b,floatVertexTextures:y&&b,maxSamples:a?e.getParameter(e.MAX_SAMPLES):0}}function Dk(e){var t=this,n=null,r=0,i=!1,a=!1,o=new yk,s=new Pw,u={value:null,needsUpdate:!1};function l(e,n,r,i){var a=null!==e?e.length:0,l=null;if(0!==a){if(l=u.value,!0!==i||null===l){var c=r+4*a,h=n.matrixWorldInverse;s.getNormalMatrix(h),(null===l||l.length<c)&&(l=new Float32Array(c));for(var f=0,d=r;f!==a;++f,d+=4)o.copy(e[f]).applyMatrix4(h,s),o.normal.toArray(l,d),l[d+3]=o.constant}u.value=l,u.needsUpdate=!0}return t.numPlanes=a,t.numIntersection=0,l}this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){var n=0!==e.length||t||0!==r||i;return i=t,r=e.length,n},this.beginShadows=function(){a=!0,l(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(e,t){n=l(e,t,0)},this.setState=function(o,s,c){var h=o.clippingPlanes,f=o.clipIntersection,d=o.clipShadows,p=e.get(o);if(!i||null===h||0===h.length||a&&!d)a?l(null):function(){u.value!==n&&(u.value=n,u.needsUpdate=r>0);t.numPlanes=r,t.numIntersection=0}();else{var v=a?0:r,m=4*v,g=p.clippingState||null;u.value=g,g=l(h,s,m,c);for(var y=0;y!==m;++y)g[y]=n[y];p.clippingState=g,this.numIntersection=f?this.numPlanes:0,this.numPlanes+=v}}}function Nk(e){var t=new WeakMap;function n(e,t){return t===ax?e.mapping=rx:t===ox&&(e.mapping=ix),e}function r(e){var n=e.target;n.removeEventListener("dispose",r);var i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture&&!1===i.isRenderTargetTexture){var a=i.mapping;if(a===ax||a===ox){if(t.has(i))return n(t.get(i).texture,i.mapping);var o=i.image;if(o&&o.height>0){var s=new pk(o.height/2);return s.fromEquirectangularTexture(e,i),t.set(i,s),i.addEventListener("dispose",r),n(s.texture,i.mapping)}return null}}return i},dispose:function(){t=new WeakMap}}}var Ik=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;return(0,u.Z)(this,n),(e=t.call(this)).isOrthographicCamera=!0,e.type="OrthographicCamera",e.zoom=1,e.view=null,e.left=r,e.right=i,e.top=a,e.bottom=o,e.near=s,e.far=l,e.updateProjectionMatrix(),e}return(0,l.Z)(n,[{key:"copy",value:function(e,t){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}},{key:"setViewOffset",value:function(e,t,n,r,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}},{key:"clearViewOffset",value:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}},{key:"updateProjectionMatrix",value:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-e,a=n+e,o=r+t,s=r-t;if(null!==this.view&&this.view.enabled){var u=(this.right-this.left)/this.view.fullWidth/this.zoom,l=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a=(i+=u*this.view.offsetX)+u*this.view.width,s=(o-=l*this.view.offsetY)-l*this.view.height}this.projectionMatrix.makeOrthographic(i,a,o,s,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}},{key:"toJSON",value:function(e){var t=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}]),n}(lk),Ok=[.125,.215,.35,.446,.526,.582],Uk=20,Fk=new Ik,zk=new xM,Bk=null,Vk=(1+Math.sqrt(5))/2,Gk=1/Vk,jk=[new tS(1,1,1),new tS(-1,1,1),new tS(1,1,-1),new tS(-1,1,-1),new tS(0,Vk,Gk),new tS(0,Vk,-Gk),new tS(Gk,0,Vk),new tS(-Gk,0,Vk),new tS(Vk,Gk,0),new tS(-Vk,Gk,0)],Hk=function(){function e(t){(0,u.Z)(this,e),this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}return(0,l.Z)(e,[{key:"fromScene",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;Bk=this._renderer.getRenderTarget(),this._setSize(256);var i=this._allocateTargets();return i.depthBuffer=!0,this._sceneToCubeUV(e,n,r,i),t>0&&this._blur(i,0,0,t),this._applyPMREM(i),this._cleanup(i),i}},{key:"fromEquirectangular",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}},{key:"fromCubemap",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}},{key:"compileCubemapShader",value:function(){null===this._cubemapMaterial&&(this._cubemapMaterial=Xk(),this._compileMaterial(this._cubemapMaterial))}},{key:"compileEquirectangularShader",value:function(){null===this._equirectMaterial&&(this._equirectMaterial=qk(),this._compileMaterial(this._equirectMaterial))}},{key:"dispose",value:function(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}},{key:"_setSize",value:function(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}},{key:"_dispose",value:function(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(var e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}},{key:"_cleanup",value:function(e){this._renderer.setRenderTarget(Bk),e.scissorTest=!1,Zk(e,0,0,e.width,e.height)}},{key:"_fromTexture",value:function(e,t){e.mapping===rx||e.mapping===ix?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Bk=this._renderer.getRenderTarget();var n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}},{key:"_allocateTargets",value:function(){var e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:px,minFilter:px,generateMipmaps:!1,type:_x,format:wx,colorSpace:lw,depthBuffer:!1},r=Wk(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=Wk(e,t,n);var i=this._lodMax,a=function(e){for(var t=[],n=[],r=[],i=e,a=e-4+1+Ok.length,o=0;o<a;o++){var s=Math.pow(2,i);n.push(s);var u=1/s;o>e-4?u=Ok[o-e+4-1]:0===o&&(u=0),r.push(u);for(var l=1/(s-2),c=-l,h=1+l,f=[c,c,h,c,h,h,c,c,h,h,c,h],d=6,p=6,v=3,m=2,g=1,y=new Float32Array(v*p*d),b=new Float32Array(m*p*d),_=new Float32Array(g*p*d),x=0;x<d;x++){var w=x%3*2/3-1,S=x>2?0:-1,M=[w,S,0,w+2/3,S,0,w+2/3,S+1,0,w,S,0,w+2/3,S+1,0,w,S+1,0];y.set(M,v*p*x),b.set(f,m*p*x);var k=[x,x,x,x,x,x];_.set(k,g*p*x)}var T=new UM;T.setAttribute("position",new TM(y,v)),T.setAttribute("uv",new TM(b,m)),T.setAttribute("faceIndex",new TM(_,g)),t.push(T),i>4&&i--}return{lodPlanes:t,sizeLods:n,sigmas:r}}(i);this._sizeLods=a.sizeLods,this._lodPlanes=a.lodPlanes,this._sigmas=a.sigmas,this._blurMaterial=function(e,t,n){var r=new Float32Array(Uk),i=new tS(0,1,0);return new uk({name:"SphericalGaussianBlur",defines:{n:Uk,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:"".concat(e,".0")},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(i,e,t)}return r}},{key:"_compileMaterial",value:function(e){var t=new tk(this._lodPlanes[0],e);this._renderer.compile(t,Fk)}},{key:"_sceneToCubeUV",value:function(e,t,n,r){var i=new ck(90,1,t,n),a=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],s=this._renderer,u=s.autoClear,l=s.toneMapping;s.getClearColor(zk),s.toneMapping=0,s.autoClear=!1;var c=new SM({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),h=new tk(new rk,c),f=!1,d=e.background;d?d.isColor&&(c.color.copy(d),e.background=null,f=!0):(c.color.copy(zk),f=!0);for(var p=0;p<6;p++){var v=p%3;0===v?(i.up.set(0,a[p],0),i.lookAt(o[p],0,0)):1===v?(i.up.set(0,0,a[p]),i.lookAt(0,o[p],0)):(i.up.set(0,a[p],0),i.lookAt(0,0,o[p]));var m=this._cubeSize;Zk(r,v*m,p>2?m:0,m,m),s.setRenderTarget(r),f&&s.render(h,i),s.render(e,i)}h.geometry.dispose(),h.material.dispose(),s.toneMapping=l,s.autoClear=u,e.background=d}},{key:"_textureToCubeUV",value:function(e,t){var n=this._renderer,r=e.mapping===rx||e.mapping===ix;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=Xk()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=qk());var i=r?this._cubemapMaterial:this._equirectMaterial,a=new tk(this._lodPlanes[0],i);i.uniforms.envMap.value=e;var o=this._cubeSize;Zk(t,0,0,3*o,2*o),n.setRenderTarget(t),n.render(a,Fk)}},{key:"_applyPMREM",value:function(e){var t=this._renderer,n=t.autoClear;t.autoClear=!1;for(var r=1;r<this._lodPlanes.length;r++){var i=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),a=jk[(r-1)%jk.length];this._blur(e,r-1,r,i,a)}t.autoClear=n}},{key:"_blur",value:function(e,t,n,r,i){var a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",i),this._halfBlur(a,e,n,n,r,"longitudinal",i)}},{key:"_halfBlur",value:function(e,t,n,r,i,a,o){var s=this._renderer,u=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");var l=new tk(this._lodPlanes[r],u),c=u.uniforms,h=this._sizeLods[n]-1,f=isFinite(i)?Math.PI/(2*h):2*Math.PI/39,d=i/f,p=isFinite(i)?1+Math.floor(3*d):Uk;p>Uk&&console.warn("sigmaRadians, ".concat(i,", is too large and will clip, as it requested ").concat(p," samples when the maximum is set to ").concat(Uk));for(var v=[],m=0,g=0;g<Uk;++g){var y=g/d,b=Math.exp(-y*y/2);v.push(b),0===g?m+=b:g<p&&(m+=2*b)}for(var _=0;_<v.length;_++)v[_]=v[_]/m;c.envMap.value=e.texture,c.samples.value=p,c.weights.value=v,c.latitudinal.value="latitudinal"===a,o&&(c.poleAxis.value=o);var x=this._lodMax;c.dTheta.value=f,c.mipInt.value=x-n;var w=this._sizeLods[r];Zk(t,3*w*(r>x-4?r-x+4:0),4*(this._cubeSize-w),3*w,2*w),s.setRenderTarget(t),s.render(l,Fk)}}]),e}();function Wk(e,t,n){var r=new Jw(e,t,n);return r.texture.mapping=sx,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function Zk(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function qk(){return new uk({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Xk(){return new uk({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Yk(e){var t=new WeakMap,n=null;function r(e){var n=e.target;n.removeEventListener("dispose",r);var i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){var a=i.mapping,o=a===ax||a===ox,s=a===rx||a===ix;if(o||s){if(i.isRenderTargetTexture&&!0===i.needsPMREMUpdate){i.needsPMREMUpdate=!1;var u=t.get(i);return null===n&&(n=new Hk(e)),u=o?n.fromEquirectangular(i,u):n.fromCubemap(i,u),t.set(i,u),u.texture}if(t.has(i))return t.get(i).texture;var l=i.image;if(o&&l&&l.height>0||s&&l&&function(e){for(var t=0,n=6,r=0;r<n;r++)void 0!==e[r]&&t++;return t===n}(l)){null===n&&(n=new Hk(e));var c=o?n.fromEquirectangular(i):n.fromCubemap(i);return t.set(i,c),i.addEventListener("dispose",r),c.texture}return null}}return i},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function Kk(e){var t={};function n(n){if(void 0!==t[n])return t[n];var r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}return{has:function(e){return null!==n(e)},init:function(e){e.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(e){var t=n(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function Jk(e,t,n,r){var i={},a=new WeakMap;function o(e){var s=e.target;for(var u in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[u]);s.removeEventListener("dispose",o),delete i[s.id];var l=a.get(s);l&&(t.remove(l),a.delete(s)),r.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,n.memory.geometries--}function s(e){var n=[],r=e.index,i=e.attributes.position,o=0;if(null!==r){var s=r.array;o=r.version;for(var u=0,l=s.length;u<l;u+=3){var c=s[u+0],h=s[u+1],f=s[u+2];n.push(c,h,h,f,f,c)}}else{var d=i.array;o=i.version;for(var p=0,v=d.length/3-1;p<v;p+=3){var m=p+0,g=p+1,y=p+2;n.push(m,g,g,y,y,m)}}var b=new(Dw(n)?CM:EM)(n,1);b.version=o;var _=a.get(e);_&&t.remove(_),a.set(e,b)}return{get:function(e,t){return!0===i[t.id]||(t.addEventListener("dispose",o),i[t.id]=!0,n.memory.geometries++),t},update:function(n){var r=n.attributes;for(var i in r)t.update(r[i],e.ARRAY_BUFFER);var a=n.morphAttributes;for(var o in a)for(var s=a[o],u=0,l=s.length;u<l;u++)t.update(s[u],e.ARRAY_BUFFER)},getWireframeAttribute:function(e){var t=a.get(e);if(t){var n=e.index;null!==n&&t.version<n.version&&s(e)}else s(e);return a.get(e)}}}function Qk(e,t,n,r){var i,a,o,s=r.isWebGL2;this.setMode=function(e){i=e},this.setIndex=function(e){a=e.type,o=e.bytesPerElement},this.render=function(t,r){e.drawElements(i,r,a,t*o),n.update(r,i,1)},this.renderInstances=function(r,u,l){if(0!==l){var c,h;if(s)c=e,h="drawElementsInstanced";else if(h="drawElementsInstancedANGLE",null===(c=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[h](i,u,a,r*o,l),n.update(u,i,l)}}}function $k(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(n,r,i){switch(t.calls++,r){case e.TRIANGLES:t.triangles+=i*(n/3);break;case e.LINES:t.lines+=i*(n/2);break;case e.LINE_STRIP:t.lines+=i*(n-1);break;case e.LINE_LOOP:t.lines+=i*n;break;case e.POINTS:t.points+=i*n;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r)}}}}function eT(e,t){return e[0]-t[0]}function tT(e,t){return Math.abs(t[1])-Math.abs(e[1])}function nT(e,t,n){for(var r={},i=new Float32Array(8),a=new WeakMap,o=new Kw,s=[],u=0;u<8;u++)s[u]=[u,0];return{update:function(u,l,c){var h=u.morphTargetInfluences;if(!0===t.isWebGL2){var f=l.morphAttributes.position||l.morphAttributes.normal||l.morphAttributes.color,d=void 0!==f?f.length:0,p=a.get(l);if(void 0===p||p.count!==d){void 0!==p&&p.texture.dispose();var v=void 0!==l.morphAttributes.position,m=void 0!==l.morphAttributes.normal,g=void 0!==l.morphAttributes.color,y=l.morphAttributes.position||[],b=l.morphAttributes.normal||[],_=l.morphAttributes.color||[],x=0;!0===v&&(x=1),!0===m&&(x=2),!0===g&&(x=3);var w=l.attributes.position.count*x,S=1;w>t.maxTextureSize&&(S=Math.ceil(w/t.maxTextureSize),w=t.maxTextureSize);var M=new Float32Array(w*S*4*d),k=new Qw(M,w,S,d);k.type=bx,k.needsUpdate=!0;for(var T=4*x,E=0;E<d;E++)for(var C=y[E],A=b[E],R=_[E],P=w*S*4*E,L=0;L<C.count;L++){var D=L*T;!0===v&&(o.fromBufferAttribute(C,L),M[P+D+0]=o.x,M[P+D+1]=o.y,M[P+D+2]=o.z,M[P+D+3]=0),!0===m&&(o.fromBufferAttribute(A,L),M[P+D+4]=o.x,M[P+D+5]=o.y,M[P+D+6]=o.z,M[P+D+7]=0),!0===g&&(o.fromBufferAttribute(R,L),M[P+D+8]=o.x,M[P+D+9]=o.y,M[P+D+10]=o.z,M[P+D+11]=4===R.itemSize?o.w:1)}p={count:d,texture:k,size:new Rw(w,S)},a.set(l,p),l.addEventListener("dispose",(function e(){k.dispose(),a.delete(l),l.removeEventListener("dispose",e)}))}for(var N=0,I=0;I<h.length;I++)N+=h[I];var O=l.morphTargetsRelative?1:1-N;c.getUniforms().setValue(e,"morphTargetBaseInfluence",O),c.getUniforms().setValue(e,"morphTargetInfluences",h),c.getUniforms().setValue(e,"morphTargetsTexture",p.texture,n),c.getUniforms().setValue(e,"morphTargetsTextureSize",p.size)}else{var U=void 0===h?0:h.length,F=r[l.id];if(void 0===F||F.length!==U){F=[];for(var z=0;z<U;z++)F[z]=[z,0];r[l.id]=F}for(var B=0;B<U;B++){var V=F[B];V[0]=B,V[1]=h[B]}F.sort(tT);for(var G=0;G<8;G++)G<U&&F[G][1]?(s[G][0]=F[G][0],s[G][1]=F[G][1]):(s[G][0]=Number.MAX_SAFE_INTEGER,s[G][1]=0);s.sort(eT);for(var j=l.morphAttributes.position,H=l.morphAttributes.normal,W=0,Z=0;Z<8;Z++){var q=s[Z],X=q[0],Y=q[1];X!==Number.MAX_SAFE_INTEGER&&Y?(j&&l.getAttribute("morphTarget"+Z)!==j[X]&&l.setAttribute("morphTarget"+Z,j[X]),H&&l.getAttribute("morphNormal"+Z)!==H[X]&&l.setAttribute("morphNormal"+Z,H[X]),i[Z]=Y,W+=Y):(j&&!0===l.hasAttribute("morphTarget"+Z)&&l.deleteAttribute("morphTarget"+Z),H&&!0===l.hasAttribute("morphNormal"+Z)&&l.deleteAttribute("morphNormal"+Z),i[Z]=0)}var K=l.morphTargetsRelative?1:1-W;c.getUniforms().setValue(e,"morphTargetBaseInfluence",K),c.getUniforms().setValue(e,"morphTargetInfluences",i)}}}}function rT(e,t,n,r){var i=new WeakMap;function a(e){var t=e.target;t.removeEventListener("dispose",a),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(o){var s=r.render.frame,u=o.geometry,l=t.get(o,u);return i.get(l)!==s&&(t.update(l),i.set(l,s)),o.isInstancedMesh&&(!1===o.hasEventListener("dispose",a)&&o.addEventListener("dispose",a),n.update(o.instanceMatrix,e.ARRAY_BUFFER),null!==o.instanceColor&&n.update(o.instanceColor,e.ARRAY_BUFFER)),l},dispose:function(){i=new WeakMap}}}var iT=new Yw,aT=new Qw,oT=new $w,sT=new dk,uT=[],lT=[],cT=new Float32Array(16),hT=new Float32Array(9),fT=new Float32Array(4);function dT(e,t,n){var r=e[0];if(r<=0||r>0)return e;var i=t*n,a=uT[i];if(void 0===a&&(a=new Float32Array(i),uT[i]=a),0!==t){r.toArray(a,0);for(var o=1,s=0;o!==t;++o)s+=n,e[o].toArray(a,s)}return a}function pT(e,t){if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function vT(e,t){for(var n=0,r=t.length;n<r;n++)e[n]=t[n]}function mT(e,t){var n=lT[t];void 0===n&&(n=new Int32Array(t),lT[t]=n);for(var r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function gT(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function yT(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(pT(n,t))return;e.uniform2fv(this.addr,t),vT(n,t)}}function bT(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(pT(n,t))return;e.uniform3fv(this.addr,t),vT(n,t)}}function _T(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(pT(n,t))return;e.uniform4fv(this.addr,t),vT(n,t)}}function xT(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(pT(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),vT(n,t)}else{if(pT(n,r))return;fT.set(r),e.uniformMatrix2fv(this.addr,!1,fT),vT(n,r)}}function wT(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(pT(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),vT(n,t)}else{if(pT(n,r))return;hT.set(r),e.uniformMatrix3fv(this.addr,!1,hT),vT(n,r)}}function ST(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(pT(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),vT(n,t)}else{if(pT(n,r))return;cT.set(r),e.uniformMatrix4fv(this.addr,!1,cT),vT(n,r)}}function MT(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function kT(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2i(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(pT(n,t))return;e.uniform2iv(this.addr,t),vT(n,t)}}function TT(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3i(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(pT(n,t))return;e.uniform3iv(this.addr,t),vT(n,t)}}function ET(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(pT(n,t))return;e.uniform4iv(this.addr,t),vT(n,t)}}function CT(e,t){var n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function AT(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2ui(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(pT(n,t))return;e.uniform2uiv(this.addr,t),vT(n,t)}}function RT(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3ui(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(pT(n,t))return;e.uniform3uiv(this.addr,t),vT(n,t)}}function PT(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(pT(n,t))return;e.uniform4uiv(this.addr,t),vT(n,t)}}function LT(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2D(t||iT,i)}function DT(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||oT,i)}function NT(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(t||sT,i)}function IT(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||aT,i)}function OT(e,t){e.uniform1fv(this.addr,t)}function UT(e,t){var n=dT(t,this.size,2);e.uniform2fv(this.addr,n)}function FT(e,t){var n=dT(t,this.size,3);e.uniform3fv(this.addr,n)}function zT(e,t){var n=dT(t,this.size,4);e.uniform4fv(this.addr,n)}function BT(e,t){var n=dT(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function VT(e,t){var n=dT(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function GT(e,t){var n=dT(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function jT(e,t){e.uniform1iv(this.addr,t)}function HT(e,t){e.uniform2iv(this.addr,t)}function WT(e,t){e.uniform3iv(this.addr,t)}function ZT(e,t){e.uniform4iv(this.addr,t)}function qT(e,t){e.uniform1uiv(this.addr,t)}function XT(e,t){e.uniform2uiv(this.addr,t)}function YT(e,t){e.uniform3uiv(this.addr,t)}function KT(e,t){e.uniform4uiv(this.addr,t)}function JT(e,t,n){var r=this.cache,i=t.length,a=mT(n,i);pT(r,a)||(e.uniform1iv(this.addr,a),vT(r,a));for(var o=0;o!==i;++o)n.setTexture2D(t[o]||iT,a[o])}function QT(e,t,n){var r=this.cache,i=t.length,a=mT(n,i);pT(r,a)||(e.uniform1iv(this.addr,a),vT(r,a));for(var o=0;o!==i;++o)n.setTexture3D(t[o]||oT,a[o])}function $T(e,t,n){var r=this.cache,i=t.length,a=mT(n,i);pT(r,a)||(e.uniform1iv(this.addr,a),vT(r,a));for(var o=0;o!==i;++o)n.setTextureCube(t[o]||sT,a[o])}function eE(e,t,n){var r=this.cache,i=t.length,a=mT(n,i);pT(r,a)||(e.uniform1iv(this.addr,a),vT(r,a));for(var o=0;o!==i;++o)n.setTexture2DArray(t[o]||aT,a[o])}var tE=(0,l.Z)((function e(t,n,r){(0,u.Z)(this,e),this.id=t,this.addr=r,this.cache=[],this.setValue=function(e){switch(e){case 5126:return gT;case 35664:return yT;case 35665:return bT;case 35666:return _T;case 35674:return xT;case 35675:return wT;case 35676:return ST;case 5124:case 35670:return MT;case 35667:case 35671:return kT;case 35668:case 35672:return TT;case 35669:case 35673:return ET;case 5125:return CT;case 36294:return AT;case 36295:return RT;case 36296:return PT;case 35678:case 36198:case 36298:case 36306:case 35682:return LT;case 35679:case 36299:case 36307:return DT;case 35680:case 36300:case 36308:case 36293:return NT;case 36289:case 36303:case 36311:case 36292:return IT}}(n.type)})),nE=(0,l.Z)((function e(t,n,r){(0,u.Z)(this,e),this.id=t,this.addr=r,this.cache=[],this.size=n.size,this.setValue=function(e){switch(e){case 5126:return OT;case 35664:return UT;case 35665:return FT;case 35666:return zT;case 35674:return BT;case 35675:return VT;case 35676:return GT;case 5124:case 35670:return jT;case 35667:case 35671:return HT;case 35668:case 35672:return WT;case 35669:case 35673:return ZT;case 5125:return qT;case 36294:return XT;case 36295:return YT;case 36296:return KT;case 35678:case 36198:case 36298:case 36306:case 35682:return JT;case 35679:case 36299:case 36307:return QT;case 35680:case 36300:case 36308:case 36293:return $T;case 36289:case 36303:case 36311:case 36292:return eE}}(n.type)})),rE=function(){function e(t){(0,u.Z)(this,e),this.id=t,this.seq=[],this.map={}}return(0,l.Z)(e,[{key:"setValue",value:function(e,t,n){for(var r=this.seq,i=0,a=r.length;i!==a;++i){var o=r[i];o.setValue(e,t[o.id],n)}}}]),e}(),iE=/(\w+)(\])?(\[|\.)?/g;function aE(e,t){e.seq.push(t),e.map[t.id]=t}function oE(e,t,n){var r=e.name,i=r.length;for(iE.lastIndex=0;;){var a=iE.exec(r),o=iE.lastIndex,s=a[1],u="]"===a[2],l=a[3];if(u&&(s|=0),void 0===l||"["===l&&o+2===i){aE(n,void 0===l?new tE(s,e,t):new nE(s,e,t));break}var c=n.map[s];void 0===c&&aE(n,c=new rE(s)),n=c}}var sE=function(){function e(t,n){(0,u.Z)(this,e),this.seq=[],this.map={};for(var r=t.getProgramParameter(n,t.ACTIVE_UNIFORMS),i=0;i<r;++i){var a=t.getActiveUniform(n,i);oE(a,t.getUniformLocation(n,a.name),this)}}return(0,l.Z)(e,[{key:"setValue",value:function(e,t,n,r){var i=this.map[t];void 0!==i&&i.setValue(e,n,r)}},{key:"setOptional",value:function(e,t,n){var r=t[n];void 0!==r&&this.setValue(e,n,r)}}],[{key:"upload",value:function(e,t,n,r){for(var i=0,a=t.length;i!==a;++i){var o=t[i],s=n[o.id];!1!==s.needsUpdate&&o.setValue(e,s.value,r)}}},{key:"seqWithValue",value:function(e,t){for(var n=[],r=0,i=e.length;r!==i;++r){var a=e[r];a.id in t&&n.push(a)}return n}}]),e}();function uE(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}var lE=0;function cE(e,t,n){var r=e.getShaderParameter(t,e.COMPILE_STATUS),i=e.getShaderInfoLog(t).trim();if(r&&""===i)return"";var a=/ERROR: 0:(\d+)/.exec(i);if(a){var o=parseInt(a[1]);return n.toUpperCase()+"\n\n"+i+"\n\n"+function(e,t){for(var n=e.split("\n"),r=[],i=Math.max(t-6,0),a=Math.min(t+6,n.length),o=i;o<a;o++){var s=o+1;r.push("".concat(s===t?">":" "," ").concat(s,": ").concat(n[o]))}return r.join("\n")}(e.getShaderSource(t),o)}return i}function hE(e,t){var n=function(e){switch(e){case lw:return["Linear","( value )"];case uw:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",e),["Linear","( value )"]}}(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function fE(e,t){var n;switch(t){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="OptimizedCineon";break;case 4:n="ACESFilmic";break;case 5:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function dE(e){return""!==e}function pE(e,t){var n=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function vE(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var mE=/^[ \t]*#include +<([\w\d./]+)>/gm;function gE(e){return e.replace(mE,yE)}function yE(e,t){var n=kk[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return gE(n)}var bE=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function _E(e){return e.replace(bE,xE)}function xE(e,t,n,r){for(var i="",a=parseInt(t);a<parseInt(n);a++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return i}function wE(e){var t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function SE(e,t,n,r){var i,a,o=e.getContext(),s=n.defines,u=n.vertexShader,l=n.fragmentShader,c=function(e){var t="SHADOWMAP_TYPE_BASIC";return 1===e.shadowMapType?t="SHADOWMAP_TYPE_PCF":2===e.shadowMapType?t="SHADOWMAP_TYPE_PCF_SOFT":3===e.shadowMapType&&(t="SHADOWMAP_TYPE_VSM"),t}(n),h=function(e){var t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case rx:case ix:t="ENVMAP_TYPE_CUBE";break;case sx:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),f=function(e){var t="ENVMAP_MODE_REFLECTION";e.envMap&&e.envMapMode===ix&&(t="ENVMAP_MODE_REFRACTION");return t}(n),d=function(e){var t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case 0:t="ENVMAP_BLENDING_MULTIPLY";break;case 1:t="ENVMAP_BLENDING_MIX";break;case 2:t="ENVMAP_BLENDING_ADD"}return t}(n),p=function(e){var t=e.envMapCubeUVHeight;if(null===t)return null;var n=Math.log2(t)-2,r=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:r,maxMip:n}}(n),v=n.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.normalMapTangentSpace||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(dE).join("\n")}(n),m=function(e){var t=[];for(var n in e){var r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(s),g=o.createProgram(),y=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?((i=[m].filter(dE).join("\n")).length>0&&(i+="\n"),(a=[v,m].filter(dE).join("\n")).length>0&&(a+="\n")):(i=[wE(n),"#define SHADER_NAME "+n.shaderName,m,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+f:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(dE).join("\n"),a=[v,wE(n),"#define SHADER_NAME "+n.shaderName,m,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+h:"",n.envMap?"#define "+f:"",n.envMap?"#define "+d:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?kk.tonemapping_pars_fragment:"",0!==n.toneMapping?fE("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",kk.encodings_pars_fragment,hE("linearToOutputTexel",n.outputColorSpace),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(dE).join("\n")),u=vE(u=pE(u=gE(u),n),n),l=vE(l=pE(l=gE(l),n),n),u=_E(u),l=_E(l),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(y="#version 300 es\n",i=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+i,a=["#define varying in",n.glslVersion===dw?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===dw?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+a);var b,_,x=y+i+u,w=y+a+l,S=uE(o,o.VERTEX_SHADER,x),M=uE(o,o.FRAGMENT_SHADER,w);if(o.attachShader(g,S),o.attachShader(g,M),void 0!==n.index0AttributeName?o.bindAttribLocation(g,0,n.index0AttributeName):!0===n.morphTargets&&o.bindAttribLocation(g,0,"position"),o.linkProgram(g),e.debug.checkShaderErrors){var k=o.getProgramInfoLog(g).trim(),T=o.getShaderInfoLog(S).trim(),E=o.getShaderInfoLog(M).trim(),C=!0,A=!0;if(!1===o.getProgramParameter(g,o.LINK_STATUS))if(C=!1,"function"===typeof e.debug.onShaderError)e.debug.onShaderError(o,g,S,M);else{var R=cE(o,S,"vertex"),P=cE(o,M,"fragment");console.error("THREE.WebGLProgram: Shader Error "+o.getError()+" - VALIDATE_STATUS "+o.getProgramParameter(g,o.VALIDATE_STATUS)+"\n\nProgram Info Log: "+k+"\n"+R+"\n"+P)}else""!==k?console.warn("THREE.WebGLProgram: Program Info Log:",k):""!==T&&""!==E||(A=!1);A&&(this.diagnostics={runnable:C,programLog:k,vertexShader:{log:T,prefix:i},fragmentShader:{log:E,prefix:a}})}return o.deleteShader(S),o.deleteShader(M),this.getUniforms=function(){return void 0===b&&(b=new sE(o,g)),b},this.getAttributes=function(){return void 0===_&&(_=function(e,t){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),i=0;i<r;i++){var a=e.getActiveAttrib(t,i),o=a.name,s=1;a.type===e.FLOAT_MAT2&&(s=2),a.type===e.FLOAT_MAT3&&(s=3),a.type===e.FLOAT_MAT4&&(s=4),n[o]={type:a.type,location:e.getAttribLocation(t,o),locationSize:s}}return n}(o,g)),_},this.destroy=function(){r.releaseStatesOfProgram(this),o.deleteProgram(g),this.program=void 0},this.name=n.shaderName,this.id=lE++,this.cacheKey=t,this.usedTimes=1,this.program=g,this.vertexShader=S,this.fragmentShader=M,this}var ME=0,kE=function(){function e(){(0,u.Z)(this,e),this.shaderCache=new Map,this.materialCache=new Map}return(0,l.Z)(e,[{key:"update",value:function(e){var t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),i=this._getShaderStage(n),a=this._getShaderCacheForMaterial(e);return!1===a.has(r)&&(a.add(r),r.usedTimes++),!1===a.has(i)&&(a.add(i),i.usedTimes++),this}},{key:"remove",value:function(e){var t,n=s(this.materialCache.get(e));try{for(n.s();!(t=n.n()).done;){var r=t.value;r.usedTimes--,0===r.usedTimes&&this.shaderCache.delete(r.code)}}catch(i){n.e(i)}finally{n.f()}return this.materialCache.delete(e),this}},{key:"getVertexShaderID",value:function(e){return this._getShaderStage(e.vertexShader).id}},{key:"getFragmentShaderID",value:function(e){return this._getShaderStage(e.fragmentShader).id}},{key:"dispose",value:function(){this.shaderCache.clear(),this.materialCache.clear()}},{key:"_getShaderCacheForMaterial",value:function(e){var t=this.materialCache,n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}},{key:"_getShaderStage",value:function(e){var t=this.shaderCache,n=t.get(e);return void 0===n&&(n=new TE(e),t.set(e,n)),n}}]),e}(),TE=(0,l.Z)((function e(t){(0,u.Z)(this,e),this.id=ME++,this.code=t,this.usedTimes=0}));function EE(e,t,n,r,i,a,o){var s=new GS,u=new kE,l=[],c=i.isWebGL2,h=i.logarithmicDepthBuffer,f=i.vertexTextures,d=i.precision,p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(e){return 1===e?"uv1":2===e?"uv2":3===e?"uv3":"uv"}return{getParameters:function(a,s,l,m,g){var y=m.fog,b=g.geometry,_=a.isMeshStandardMaterial?m.environment:null,x=(a.isMeshStandardMaterial?n:t).get(a.envMap||_),w=x&&x.mapping===sx?x.image.height:null,S=p[a.type];null!==a.precision&&(d=i.getMaxPrecision(a.precision))!==a.precision&&console.warn("THREE.WebGLProgram.getParameters:",a.precision,"not supported, using",d,"instead.");var M,k,T,E,C=b.morphAttributes.position||b.morphAttributes.normal||b.morphAttributes.color,A=void 0!==C?C.length:0,R=0;if(void 0!==b.morphAttributes.position&&(R=1),void 0!==b.morphAttributes.normal&&(R=2),void 0!==b.morphAttributes.color&&(R=3),S){var P=Ek[S];M=P.vertexShader,k=P.fragmentShader}else M=a.vertexShader,k=a.fragmentShader,u.update(a),T=u.getVertexShaderID(a),E=u.getFragmentShaderID(a);var L=e.getRenderTarget(),D=!0===g.isInstancedMesh,N=!!a.map,I=!!a.matcap,O=!!x,U=!!a.aoMap,F=!!a.lightMap,z=!!a.bumpMap,B=!!a.normalMap,V=!!a.displacementMap,G=!!a.emissiveMap,j=!!a.metalnessMap,H=!!a.roughnessMap,W=a.clearcoat>0,Z=a.iridescence>0,q=a.sheen>0,X=a.transmission>0,Y=W&&!!a.clearcoatMap,K=W&&!!a.clearcoatNormalMap,J=W&&!!a.clearcoatRoughnessMap,Q=Z&&!!a.iridescenceMap,$=Z&&!!a.iridescenceThicknessMap,ee=q&&!!a.sheenColorMap,te=q&&!!a.sheenRoughnessMap,ne=!!a.specularMap,re=!!a.specularColorMap,ie=!!a.specularIntensityMap,ae=X&&!!a.transmissionMap,oe=X&&!!a.thicknessMap,se=!!a.gradientMap,ue=!!a.alphaMap,le=a.alphaTest>0,ce=!!a.extensions,he=!!b.attributes.uv1,fe=!!b.attributes.uv2,de=!!b.attributes.uv3;return{isWebGL2:c,shaderID:S,shaderName:a.type,vertexShader:M,fragmentShader:k,defines:a.defines,customVertexShaderID:T,customFragmentShaderID:E,isRawShaderMaterial:!0===a.isRawShaderMaterial,glslVersion:a.glslVersion,precision:d,instancing:D,instancingColor:D&&null!==g.instanceColor,supportsVertexTextures:f,outputColorSpace:null===L?e.outputColorSpace:!0===L.isXRRenderTarget?L.texture.colorSpace:lw,map:N,matcap:I,envMap:O,envMapMode:O&&x.mapping,envMapCubeUVHeight:w,aoMap:U,lightMap:F,bumpMap:z,normalMap:B,displacementMap:f&&V,emissiveMap:G,normalMapObjectSpace:B&&1===a.normalMapType,normalMapTangentSpace:B&&0===a.normalMapType,metalnessMap:j,roughnessMap:H,clearcoat:W,clearcoatMap:Y,clearcoatNormalMap:K,clearcoatRoughnessMap:J,iridescence:Z,iridescenceMap:Q,iridescenceThicknessMap:$,sheen:q,sheenColorMap:ee,sheenRoughnessMap:te,specularMap:ne,specularColorMap:re,specularIntensityMap:ie,transmission:X,transmissionMap:ae,thicknessMap:oe,gradientMap:se,opaque:!1===a.transparent&&1===a.blending,alphaMap:ue,alphaTest:le,combine:a.combine,mapUv:N&&v(a.map.channel),aoMapUv:U&&v(a.aoMap.channel),lightMapUv:F&&v(a.lightMap.channel),bumpMapUv:z&&v(a.bumpMap.channel),normalMapUv:B&&v(a.normalMap.channel),displacementMapUv:V&&v(a.displacementMap.channel),emissiveMapUv:G&&v(a.emissiveMap.channel),metalnessMapUv:j&&v(a.metalnessMap.channel),roughnessMapUv:H&&v(a.roughnessMap.channel),clearcoatMapUv:Y&&v(a.clearcoatMap.channel),clearcoatNormalMapUv:K&&v(a.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:J&&v(a.clearcoatRoughnessMap.channel),iridescenceMapUv:Q&&v(a.iridescenceMap.channel),iridescenceThicknessMapUv:$&&v(a.iridescenceThicknessMap.channel),sheenColorMapUv:ee&&v(a.sheenColorMap.channel),sheenRoughnessMapUv:te&&v(a.sheenRoughnessMap.channel),specularMapUv:ne&&v(a.specularMap.channel),specularColorMapUv:re&&v(a.specularColorMap.channel),specularIntensityMapUv:ie&&v(a.specularIntensityMap.channel),transmissionMapUv:ae&&v(a.transmissionMap.channel),thicknessMapUv:oe&&v(a.thicknessMap.channel),alphaMapUv:ue&&v(a.alphaMap.channel),vertexTangents:B&&!!b.attributes.tangent,vertexColors:a.vertexColors,vertexAlphas:!0===a.vertexColors&&!!b.attributes.color&&4===b.attributes.color.itemSize,vertexUv1s:he,vertexUv2s:fe,vertexUv3s:de,pointsUvs:!0===g.isPoints&&!!b.attributes.uv&&(N||ue),fog:!!y,useFog:!0===a.fog,fogExp2:y&&y.isFogExp2,flatShading:!0===a.flatShading,sizeAttenuation:!0===a.sizeAttenuation,logarithmicDepthBuffer:h,skinning:!0===g.isSkinnedMesh,morphTargets:void 0!==b.morphAttributes.position,morphNormals:void 0!==b.morphAttributes.normal,morphColors:void 0!==b.morphAttributes.color,morphTargetsCount:A,morphTextureStride:R,numDirLights:s.directional.length,numPointLights:s.point.length,numSpotLights:s.spot.length,numSpotLightMaps:s.spotLightMap.length,numRectAreaLights:s.rectArea.length,numHemiLights:s.hemi.length,numDirLightShadows:s.directionalShadowMap.length,numPointLightShadows:s.pointShadowMap.length,numSpotLightShadows:s.spotShadowMap.length,numSpotLightShadowsWithMaps:s.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:a.dithering,shadowMapEnabled:e.shadowMap.enabled&&l.length>0,shadowMapType:e.shadowMap.type,toneMapping:a.toneMapped?e.toneMapping:0,useLegacyLights:e.useLegacyLights,premultipliedAlpha:a.premultipliedAlpha,doubleSided:2===a.side,flipSided:1===a.side,useDepthPacking:a.depthPacking>=0,depthPacking:a.depthPacking||0,index0AttributeName:a.index0AttributeName,extensionDerivatives:ce&&!0===a.extensions.derivatives,extensionFragDepth:ce&&!0===a.extensions.fragDepth,extensionDrawBuffers:ce&&!0===a.extensions.drawBuffers,extensionShaderTextureLOD:ce&&!0===a.extensions.shaderTextureLOD,rendererExtensionFragDepth:c||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:c||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:c||r.has("EXT_shader_texture_lod"),customProgramCacheKey:a.customProgramCacheKey()}},getProgramCacheKey:function(t){var n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.customVertexShaderID),n.push(t.customFragmentShaderID)),void 0!==t.defines)for(var r in t.defines)n.push(r),n.push(t.defines[r]);return!1===t.isRawShaderMaterial&&(!function(e,t){e.push(t.precision),e.push(t.outputColorSpace),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.mapUv),e.push(t.alphaMapUv),e.push(t.lightMapUv),e.push(t.aoMapUv),e.push(t.bumpMapUv),e.push(t.normalMapUv),e.push(t.displacementMapUv),e.push(t.emissiveMapUv),e.push(t.metalnessMapUv),e.push(t.roughnessMapUv),e.push(t.clearcoatMapUv),e.push(t.clearcoatNormalMapUv),e.push(t.clearcoatRoughnessMapUv),e.push(t.iridescenceMapUv),e.push(t.iridescenceThicknessMapUv),e.push(t.sheenColorMapUv),e.push(t.sheenRoughnessMapUv),e.push(t.specularMapUv),e.push(t.specularColorMapUv),e.push(t.specularIntensityMapUv),e.push(t.transmissionMapUv),e.push(t.thicknessMapUv),e.push(t.combine),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(n,t),function(e,t){s.disableAll(),t.isWebGL2&&s.enable(0);t.supportsVertexTextures&&s.enable(1);t.instancing&&s.enable(2);t.instancingColor&&s.enable(3);t.matcap&&s.enable(4);t.envMap&&s.enable(5);t.normalMapObjectSpace&&s.enable(6);t.normalMapTangentSpace&&s.enable(7);t.clearcoat&&s.enable(8);t.iridescence&&s.enable(9);t.alphaTest&&s.enable(10);t.vertexColors&&s.enable(11);t.vertexAlphas&&s.enable(12);t.vertexUv1s&&s.enable(13);t.vertexUv2s&&s.enable(14);t.vertexUv3s&&s.enable(15);t.vertexTangents&&s.enable(16);e.push(s.mask),s.disableAll(),t.fog&&s.enable(0);t.useFog&&s.enable(1);t.flatShading&&s.enable(2);t.logarithmicDepthBuffer&&s.enable(3);t.skinning&&s.enable(4);t.morphTargets&&s.enable(5);t.morphNormals&&s.enable(6);t.morphColors&&s.enable(7);t.premultipliedAlpha&&s.enable(8);t.shadowMapEnabled&&s.enable(9);t.useLegacyLights&&s.enable(10);t.doubleSided&&s.enable(11);t.flipSided&&s.enable(12);t.useDepthPacking&&s.enable(13);t.dithering&&s.enable(14);t.transmission&&s.enable(15);t.sheen&&s.enable(16);t.opaque&&s.enable(17);t.pointsUvs&&s.enable(18);e.push(s.mask)}(n,t),n.push(e.outputColorSpace)),n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){var t,n=p[e.type];if(n){var r=Ek[n];t=sk.clone(r.uniforms)}else t=e.uniforms;return t},acquireProgram:function(t,n){for(var r,i=0,o=l.length;i<o;i++){var s=l[i];if(s.cacheKey===n){++(r=s).usedTimes;break}}return void 0===r&&(r=new SE(e,n,t,a),l.push(r)),r},releaseProgram:function(e){if(0===--e.usedTimes){var t=l.indexOf(e);l[t]=l[l.length-1],l.pop(),e.destroy()}},releaseShaderCache:function(e){u.remove(e)},programs:l,dispose:function(){u.dispose()}}}function CE(){var e=new WeakMap;return{get:function(t){var n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function AE(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function RE(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function PE(){var e=[],t=0,n=[],r=[],i=[];function a(n,r,i,a,o,s){var u=e[t];return void 0===u?(u={id:n.id,object:n,geometry:r,material:i,groupOrder:a,renderOrder:n.renderOrder,z:o,group:s},e[t]=u):(u.id=n.id,u.object=n,u.geometry=r,u.material=i,u.groupOrder=a,u.renderOrder=n.renderOrder,u.z=o,u.group=s),t++,u}return{opaque:n,transmissive:r,transparent:i,init:function(){t=0,n.length=0,r.length=0,i.length=0},push:function(e,t,o,s,u,l){var c=a(e,t,o,s,u,l);o.transmission>0?r.push(c):!0===o.transparent?i.push(c):n.push(c)},unshift:function(e,t,o,s,u,l){var c=a(e,t,o,s,u,l);o.transmission>0?r.unshift(c):!0===o.transparent?i.unshift(c):n.unshift(c)},finish:function(){for(var n=t,r=e.length;n<r;n++){var i=e[n];if(null===i.id)break;i.id=null,i.object=null,i.geometry=null,i.material=null,i.group=null}},sort:function(e,t){n.length>1&&n.sort(e||AE),r.length>1&&r.sort(t||RE),i.length>1&&i.sort(t||RE)}}}function LE(){var e=new WeakMap;return{get:function(t,n){var r,i=e.get(t);return void 0===i?(r=new PE,e.set(t,[r])):n>=i.length?(r=new PE,i.push(r)):r=i[n],r},dispose:function(){e=new WeakMap}}}function DE(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":n={direction:new tS,color:new xM};break;case"SpotLight":n={position:new tS,direction:new tS,color:new xM,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new tS,color:new xM,distance:0,decay:0};break;case"HemisphereLight":n={direction:new tS,skyColor:new xM,groundColor:new xM};break;case"RectAreaLight":n={color:new xM,position:new tS,halfWidth:new tS,halfHeight:new tS}}return e[t.id]=n,n}}}var NE=0;function IE(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function OE(e,t){for(var n=new DE,r=function(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Rw};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Rw,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0},a=0;a<9;a++)i.probe.push(new tS);var o=new tS,s=new PS,u=new PS;return{setup:function(a,o){for(var s=0,u=0,l=0,c=0;c<9;c++)i.probe[c].set(0,0,0);var h=0,f=0,d=0,p=0,v=0,m=0,g=0,y=0,b=0,_=0;a.sort(IE);for(var x=!0===o?Math.PI:1,w=0,S=a.length;w<S;w++){var M=a[w],k=M.color,T=M.intensity,E=M.distance,C=M.shadow&&M.shadow.map?M.shadow.map.texture:null;if(M.isAmbientLight)s+=k.r*T*x,u+=k.g*T*x,l+=k.b*T*x;else if(M.isLightProbe)for(var A=0;A<9;A++)i.probe[A].addScaledVector(M.sh.coefficients[A],T);else if(M.isDirectionalLight){var R=n.get(M);if(R.color.copy(M.color).multiplyScalar(M.intensity*x),M.castShadow){var P=M.shadow,L=r.get(M);L.shadowBias=P.bias,L.shadowNormalBias=P.normalBias,L.shadowRadius=P.radius,L.shadowMapSize=P.mapSize,i.directionalShadow[h]=L,i.directionalShadowMap[h]=C,i.directionalShadowMatrix[h]=M.shadow.matrix,m++}i.directional[h]=R,h++}else if(M.isSpotLight){var D=n.get(M);D.position.setFromMatrixPosition(M.matrixWorld),D.color.copy(k).multiplyScalar(T*x),D.distance=E,D.coneCos=Math.cos(M.angle),D.penumbraCos=Math.cos(M.angle*(1-M.penumbra)),D.decay=M.decay,i.spot[d]=D;var N=M.shadow;if(M.map&&(i.spotLightMap[b]=M.map,b++,N.updateMatrices(M),M.castShadow&&_++),i.spotLightMatrix[d]=N.matrix,M.castShadow){var I=r.get(M);I.shadowBias=N.bias,I.shadowNormalBias=N.normalBias,I.shadowRadius=N.radius,I.shadowMapSize=N.mapSize,i.spotShadow[d]=I,i.spotShadowMap[d]=C,y++}d++}else if(M.isRectAreaLight){var O=n.get(M);O.color.copy(k).multiplyScalar(T),O.halfWidth.set(.5*M.width,0,0),O.halfHeight.set(0,.5*M.height,0),i.rectArea[p]=O,p++}else if(M.isPointLight){var U=n.get(M);if(U.color.copy(M.color).multiplyScalar(M.intensity*x),U.distance=M.distance,U.decay=M.decay,M.castShadow){var F=M.shadow,z=r.get(M);z.shadowBias=F.bias,z.shadowNormalBias=F.normalBias,z.shadowRadius=F.radius,z.shadowMapSize=F.mapSize,z.shadowCameraNear=F.camera.near,z.shadowCameraFar=F.camera.far,i.pointShadow[f]=z,i.pointShadowMap[f]=C,i.pointShadowMatrix[f]=M.shadow.matrix,g++}i.point[f]=U,f++}else if(M.isHemisphereLight){var B=n.get(M);B.skyColor.copy(M.color).multiplyScalar(T*x),B.groundColor.copy(M.groundColor).multiplyScalar(T*x),i.hemi[v]=B,v++}}p>0&&(t.isWebGL2||!0===e.has("OES_texture_float_linear")?(i.rectAreaLTC1=Tk.LTC_FLOAT_1,i.rectAreaLTC2=Tk.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(i.rectAreaLTC1=Tk.LTC_HALF_1,i.rectAreaLTC2=Tk.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=s,i.ambient[1]=u,i.ambient[2]=l;var V=i.hash;V.directionalLength===h&&V.pointLength===f&&V.spotLength===d&&V.rectAreaLength===p&&V.hemiLength===v&&V.numDirectionalShadows===m&&V.numPointShadows===g&&V.numSpotShadows===y&&V.numSpotMaps===b||(i.directional.length=h,i.spot.length=d,i.rectArea.length=p,i.point.length=f,i.hemi.length=v,i.directionalShadow.length=m,i.directionalShadowMap.length=m,i.pointShadow.length=g,i.pointShadowMap.length=g,i.spotShadow.length=y,i.spotShadowMap.length=y,i.directionalShadowMatrix.length=m,i.pointShadowMatrix.length=g,i.spotLightMatrix.length=y+b-_,i.spotLightMap.length=b,i.numSpotLightShadowsWithMaps=_,V.directionalLength=h,V.pointLength=f,V.spotLength=d,V.rectAreaLength=p,V.hemiLength=v,V.numDirectionalShadows=m,V.numPointShadows=g,V.numSpotShadows=y,V.numSpotMaps=b,i.version=NE++)},setupView:function(e,t){for(var n=0,r=0,a=0,l=0,c=0,h=t.matrixWorldInverse,f=0,d=e.length;f<d;f++){var p=e[f];if(p.isDirectionalLight){var v=i.directional[n];v.direction.setFromMatrixPosition(p.matrixWorld),o.setFromMatrixPosition(p.target.matrixWorld),v.direction.sub(o),v.direction.transformDirection(h),n++}else if(p.isSpotLight){var m=i.spot[a];m.position.setFromMatrixPosition(p.matrixWorld),m.position.applyMatrix4(h),m.direction.setFromMatrixPosition(p.matrixWorld),o.setFromMatrixPosition(p.target.matrixWorld),m.direction.sub(o),m.direction.transformDirection(h),a++}else if(p.isRectAreaLight){var g=i.rectArea[l];g.position.setFromMatrixPosition(p.matrixWorld),g.position.applyMatrix4(h),u.identity(),s.copy(p.matrixWorld),s.premultiply(h),u.extractRotation(s),g.halfWidth.set(.5*p.width,0,0),g.halfHeight.set(0,.5*p.height,0),g.halfWidth.applyMatrix4(u),g.halfHeight.applyMatrix4(u),l++}else if(p.isPointLight){var y=i.point[r];y.position.setFromMatrixPosition(p.matrixWorld),y.position.applyMatrix4(h),r++}else if(p.isHemisphereLight){var b=i.hemi[c];b.direction.setFromMatrixPosition(p.matrixWorld),b.direction.transformDirection(h),c++}}},state:i}}function UE(e,t){var n=new OE(e,t),r=[],i=[];return{init:function(){r.length=0,i.length=0},state:{lightsArray:r,shadowsArray:i,lights:n},setupLights:function(e){n.setup(r,e)},setupLightsView:function(e){n.setupView(r,e)},pushLight:function(e){r.push(e)},pushShadow:function(e){i.push(e)}}}function FE(e,t){var n=new WeakMap;return{get:function(r){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=n.get(r);return void 0===o?(i=new UE(e,t),n.set(r,[i])):a>=o.length?(i=new UE(e,t),o.push(i)):i=o[a],i},dispose:function(){n=new WeakMap}}}var zE=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).isMeshDepthMaterial=!0,r.type="MeshDepthMaterial",r.depthPacking=3200,r.map=null,r.alphaMap=null,r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.wireframe=!1,r.wireframeLinewidth=1,r.setValues(e),r}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}]),n}(mM),BE=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).isMeshDistanceMaterial=!0,r.type="MeshDistanceMaterial",r.map=null,r.alphaMap=null,r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.setValues(e),r}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}]),n}(mM);function VE(e,t,n){var r,i=new xk,a=new Rw,o=new Rw,s=new Kw,u=new zE({depthPacking:3201}),l=new BE,c={},h=n.maxTextureSize,f=(gr(r={},0,1),gr(r,1,0),gr(r,2,2),r),d=new uk({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Rw},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=d.clone();p.defines.HORIZONTAL_PASS=1;var v=new UM;v.setAttribute("position",new TM(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var m=new tk(v,d),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1;var y=this.type;function b(n,r){var i=t.update(m);d.defines.VSM_SAMPLES!==n.blurSamples&&(d.defines.VSM_SAMPLES=n.blurSamples,p.defines.VSM_SAMPLES=n.blurSamples,d.needsUpdate=!0,p.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new Jw(a.x,a.y)),d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,i,d,m,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,i,p,m,null)}function _(t,n,r,i){var a=null,o=!0===r.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==o)a=o;else if(a=!0===r.isPointLight?l:u,e.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0){var s=a.uuid,h=n.uuid,d=c[s];void 0===d&&(d={},c[s]=d);var p=d[h];void 0===p&&(p=a.clone(),d[h]=p),a=p}(a.visible=n.visible,a.wireframe=n.wireframe,a.side=3===i?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:f[n.side],a.alphaMap=n.alphaMap,a.alphaTest=n.alphaTest,a.map=n.map,a.clipShadows=n.clipShadows,a.clippingPlanes=n.clippingPlanes,a.clipIntersection=n.clipIntersection,a.displacementMap=n.displacementMap,a.displacementScale=n.displacementScale,a.displacementBias=n.displacementBias,a.wireframeLinewidth=n.wireframeLinewidth,a.linewidth=n.linewidth,!0===r.isPointLight&&!0===a.isMeshDistanceMaterial)&&(e.properties.get(a).light=r);return a}function x(n,r,a,o,s){if(!1!==n.visible){if(n.layers.test(r.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===s)&&(!n.frustumCulled||i.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,n.matrixWorld);var u=t.update(n),l=n.material;if(Array.isArray(l))for(var c=u.groups,h=0,f=c.length;h<f;h++){var d=c[h],p=l[d.materialIndex];if(p&&p.visible){var v=_(n,p,o,s);e.renderBufferDirect(a,null,u,v,n,d)}}else if(l.visible){var m=_(n,l,o,s);e.renderBufferDirect(a,null,u,m,n,null)}}for(var g=n.children,y=0,b=g.length;y<b;y++)x(g[y],r,a,o,s)}}this.render=function(t,n,r){if(!1!==g.enabled&&(!1!==g.autoUpdate||!1!==g.needsUpdate)&&0!==t.length){var u=e.getRenderTarget(),l=e.getActiveCubeFace(),c=e.getActiveMipmapLevel(),f=e.state;f.setBlending(0),f.buffers.color.setClear(1,1,1,1),f.buffers.depth.setTest(!0),f.setScissorTest(!1);for(var d=3!==y&&3===this.type,p=3===y&&3!==this.type,v=0,m=t.length;v<m;v++){var _=t[v],w=_.shadow;if(void 0!==w){if(!1!==w.autoUpdate||!1!==w.needsUpdate){a.copy(w.mapSize);var S=w.getFrameExtents();if(a.multiply(S),o.copy(w.mapSize),(a.x>h||a.y>h)&&(a.x>h&&(o.x=Math.floor(h/S.x),a.x=o.x*S.x,w.mapSize.x=o.x),a.y>h&&(o.y=Math.floor(h/S.y),a.y=o.y*S.y,w.mapSize.y=o.y)),null===w.map||!0===d||!0===p){var M=3!==this.type?{minFilter:hx,magFilter:hx}:{};null!==w.map&&w.map.dispose(),w.map=new Jw(a.x,a.y,M),w.map.texture.name=_.name+".shadowMap",w.camera.updateProjectionMatrix()}e.setRenderTarget(w.map),e.clear();for(var k=w.getViewportCount(),T=0;T<k;T++){var E=w.getViewport(T);s.set(o.x*E.x,o.y*E.y,o.x*E.z,o.y*E.w),f.viewport(s),w.updateMatrices(_,T),i=w.getFrustum(),x(n,r,w.camera,_,this.type)}!0!==w.isPointLightShadow&&3===this.type&&b(w,r),w.needsUpdate=!1}}else console.warn("THREE.WebGLShadowMap:",_,"has no shadow.")}y=this.type,g.needsUpdate=!1,e.setRenderTarget(u,l,c)}}}function GE(e,t,n){var r,i,a=n.isWebGL2;var o=new function(){var t=!1,n=new Kw,r=null,i=new Kw(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,a,o,s){!0===s&&(t*=o,r*=o,a*=o),n.set(t,r,a,o),!1===i.equals(n)&&(e.clearColor(t,r,a,o),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},s=new function(){var t=!1,n=null,r=null,i=null;return{setTest:function(t){t?G(e.DEPTH_TEST):j(e.DEPTH_TEST)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){switch(t){case 0:e.depthFunc(e.NEVER);break;case 1:e.depthFunc(e.ALWAYS);break;case 2:e.depthFunc(e.LESS);break;case 3:default:e.depthFunc(e.LEQUAL);break;case 4:e.depthFunc(e.EQUAL);break;case 5:e.depthFunc(e.GEQUAL);break;case 6:e.depthFunc(e.GREATER);break;case 7:e.depthFunc(e.NOTEQUAL)}r=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,n=null,r=null,i=null}}},u=new function(){var t=!1,n=null,r=null,i=null,a=null,o=null,s=null,u=null,l=null;return{setTest:function(n){t||(n?G(e.STENCIL_TEST):j(e.STENCIL_TEST))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,o){r===t&&i===n&&a===o||(e.stencilFunc(t,n,o),r=t,i=n,a=o)},setOp:function(t,n,r){o===t&&s===n&&u===r||(e.stencilOp(t,n,r),o=t,s=n,u=r)},setLocked:function(e){t=e},setClear:function(t){l!==t&&(e.clearStencil(t),l=t)},reset:function(){t=!1,n=null,r=null,i=null,a=null,o=null,s=null,u=null,l=null}}},l=new WeakMap,c=new WeakMap,h={},f={},d=new WeakMap,p=[],v=null,m=!1,g=null,y=null,b=null,_=null,x=null,w=null,S=null,M=!1,k=null,T=null,E=null,C=null,A=null,R=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),P=!1,L=0,D=e.getParameter(e.VERSION);-1!==D.indexOf("WebGL")?(L=parseFloat(/^WebGL (\d)/.exec(D)[1]),P=L>=1):-1!==D.indexOf("OpenGL ES")&&(L=parseFloat(/^OpenGL ES (\d)/.exec(D)[1]),P=L>=2);var N=null,I={},O=e.getParameter(e.SCISSOR_BOX),U=e.getParameter(e.VIEWPORT),F=(new Kw).fromArray(O),z=(new Kw).fromArray(U);function B(t,n,r,i){var o=new Uint8Array(4),s=e.createTexture();e.bindTexture(t,s),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(var u=0;u<r;u++)!a||t!==e.TEXTURE_3D&&t!==e.TEXTURE_2D_ARRAY?e.texImage2D(n+u,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,o):e.texImage3D(n,0,e.RGBA,1,1,i,0,e.RGBA,e.UNSIGNED_BYTE,o);return s}var V={};function G(t){!0!==h[t]&&(e.enable(t),h[t]=!0)}function j(t){!1!==h[t]&&(e.disable(t),h[t]=!1)}V[e.TEXTURE_2D]=B(e.TEXTURE_2D,e.TEXTURE_2D,1),V[e.TEXTURE_CUBE_MAP]=B(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),a&&(V[e.TEXTURE_2D_ARRAY]=B(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),V[e.TEXTURE_3D]=B(e.TEXTURE_3D,e.TEXTURE_3D,1,1)),o.setClear(0,0,0,1),s.setClear(1),u.setClear(0),G(e.DEPTH_TEST),s.setFunc(3),X(!1),Y(1),G(e.CULL_FACE),q(0);var H=(gr(r={},nx,e.FUNC_ADD),gr(r,101,e.FUNC_SUBTRACT),gr(r,102,e.FUNC_REVERSE_SUBTRACT),r);if(a)H[103]=e.MIN,H[104]=e.MAX;else{var W=t.get("EXT_blend_minmax");null!==W&&(H[103]=W.MIN_EXT,H[104]=W.MAX_EXT)}var Z=(gr(i={},200,e.ZERO),gr(i,201,e.ONE),gr(i,202,e.SRC_COLOR),gr(i,204,e.SRC_ALPHA),gr(i,210,e.SRC_ALPHA_SATURATE),gr(i,208,e.DST_COLOR),gr(i,206,e.DST_ALPHA),gr(i,203,e.ONE_MINUS_SRC_COLOR),gr(i,205,e.ONE_MINUS_SRC_ALPHA),gr(i,209,e.ONE_MINUS_DST_COLOR),gr(i,207,e.ONE_MINUS_DST_ALPHA),i);function q(t,n,r,i,a,o,s,u){if(0!==t){if(!1===m&&(G(e.BLEND),m=!0),5===t)a=a||n,o=o||r,s=s||i,n===y&&a===x||(e.blendEquationSeparate(H[n],H[a]),y=n,x=a),r===b&&i===_&&o===w&&s===S||(e.blendFuncSeparate(Z[r],Z[i],Z[o],Z[s]),b=r,_=i,w=o,S=s),g=t,M=!1;else if(t!==g||u!==M){if(y===nx&&x===nx||(e.blendEquation(e.FUNC_ADD),y=nx,x=nx),u)switch(t){case 1:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFunc(e.ONE,e.ONE);break;case 3:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case 4:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case 1:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case 3:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case 4:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}b=null,_=null,w=null,S=null,g=t,M=u}}else!0===m&&(j(e.BLEND),m=!1)}function X(t){k!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),k=t)}function Y(t){0!==t?(G(e.CULL_FACE),t!==T&&(1===t?e.cullFace(e.BACK):2===t?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):j(e.CULL_FACE),T=t}function K(t,n,r){t?(G(e.POLYGON_OFFSET_FILL),C===n&&A===r||(e.polygonOffset(n,r),C=n,A=r)):j(e.POLYGON_OFFSET_FILL)}return{buffers:{color:o,depth:s,stencil:u},enable:G,disable:j,bindFramebuffer:function(t,n){return f[t]!==n&&(e.bindFramebuffer(t,n),f[t]=n,a&&(t===e.DRAW_FRAMEBUFFER&&(f[e.FRAMEBUFFER]=n),t===e.FRAMEBUFFER&&(f[e.DRAW_FRAMEBUFFER]=n)),!0)},drawBuffers:function(r,i){var a=p,o=!1;if(r)if(void 0===(a=d.get(i))&&(a=[],d.set(i,a)),r.isWebGLMultipleRenderTargets){var s=r.texture;if(a.length!==s.length||a[0]!==e.COLOR_ATTACHMENT0){for(var u=0,l=s.length;u<l;u++)a[u]=e.COLOR_ATTACHMENT0+u;a.length=s.length,o=!0}}else a[0]!==e.COLOR_ATTACHMENT0&&(a[0]=e.COLOR_ATTACHMENT0,o=!0);else a[0]!==e.BACK&&(a[0]=e.BACK,o=!0);o&&(n.isWebGL2?e.drawBuffers(a):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(a))},useProgram:function(t){return v!==t&&(e.useProgram(t),v=t,!0)},setBlending:q,setMaterial:function(t,n){2===t.side?j(e.CULL_FACE):G(e.CULL_FACE);var r=1===t.side;n&&(r=!r),X(r),1===t.blending&&!1===t.transparent?q(0):q(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),s.setFunc(t.depthFunc),s.setTest(t.depthTest),s.setMask(t.depthWrite),o.setMask(t.colorWrite);var i=t.stencilWrite;u.setTest(i),i&&(u.setMask(t.stencilWriteMask),u.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),u.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),K(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?G(e.SAMPLE_ALPHA_TO_COVERAGE):j(e.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:X,setCullFace:Y,setLineWidth:function(t){t!==E&&(P&&e.lineWidth(t),E=t)},setPolygonOffset:K,setScissorTest:function(t){t?G(e.SCISSOR_TEST):j(e.SCISSOR_TEST)},activeTexture:function(t){void 0===t&&(t=e.TEXTURE0+R-1),N!==t&&(e.activeTexture(t),N=t)},bindTexture:function(t,n,r){void 0===r&&(r=null===N?e.TEXTURE0+R-1:N);var i=I[r];void 0===i&&(i={type:void 0,texture:void 0},I[r]=i),i.type===t&&i.texture===n||(N!==r&&(e.activeTexture(r),N=r),e.bindTexture(t,n||V[t]),i.type=t,i.texture=n)},unbindTexture:function(){var t=I[N];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexImage3D:function(){try{e.compressedTexImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},updateUBOMapping:function(t,n){var r=c.get(n);void 0===r&&(r=new WeakMap,c.set(n,r));var i=r.get(t);void 0===i&&(i=e.getUniformBlockIndex(n,t.name),r.set(t,i))},uniformBlockBinding:function(t,n){var r=c.get(n).get(t);l.get(n)!==r&&(e.uniformBlockBinding(n,r,t.__bindingPointIndex),l.set(n,r))},texStorage2D:function(){try{e.texStorage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texStorage3D:function(){try{e.texStorage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage2D:function(){try{e.texSubImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage3D:function(){try{e.texSubImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(t){!1===F.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),F.copy(t))},viewport:function(t){!1===z.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),z.copy(t))},reset:function(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),!0===a&&(e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),h={},N=null,I={},f={},d=new WeakMap,p=[],v=null,m=!1,g=null,y=null,b=null,_=null,x=null,w=null,S=null,M=!1,k=null,T=null,E=null,C=null,A=null,F.set(0,0,e.canvas.width,e.canvas.height),z.set(0,0,e.canvas.width,e.canvas.height),o.reset(),s.reset(),u.reset()}}}function jE(e,t,n,r,i,a,o){var s,u,l,c=i.isWebGL2,h=i.maxTextures,f=i.maxCubemapSize,d=i.maxTextureSize,p=i.maxSamples,v=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,m="undefined"!==typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),g=new WeakMap,y=new WeakMap,b=!1;try{b="undefined"!==typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(H){}function _(e,t){return b?new OffscreenCanvas(e,t):Nw("canvas")}function x(e,t,n,r){var i=1;if((e.width>r||e.height>r)&&(i=r/Math.max(e.width,e.height)),i<1||!0===t){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap){var a=t?Tw:Math.floor,o=a(i*e.width),s=a(i*e.height);void 0===l&&(l=_(o,s));var u=n?_(o,s):l;return u.width=o,u.height=s,u.getContext("2d").drawImage(e,0,0,o,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+o+"x"+s+")."),u}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function w(e){return Mw(e.width)&&Mw(e.height)}function S(e,t){return e.generateMipmaps&&t&&e.minFilter!==hx&&e.minFilter!==px}function M(t){e.generateMipmap(t)}function k(n,r,i,a){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!1===c)return r;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}var s=r;return r===e.RED&&(i===e.FLOAT&&(s=e.R32F),i===e.HALF_FLOAT&&(s=e.R16F),i===e.UNSIGNED_BYTE&&(s=e.R8)),r===e.RG&&(i===e.FLOAT&&(s=e.RG32F),i===e.HALF_FLOAT&&(s=e.RG16F),i===e.UNSIGNED_BYTE&&(s=e.RG8)),r===e.RGBA&&(i===e.FLOAT&&(s=e.RGBA32F),i===e.HALF_FLOAT&&(s=e.RGBA16F),i===e.UNSIGNED_BYTE&&(s=a===uw&&!1===o?e.SRGB8_ALPHA8:e.RGBA8),i===e.UNSIGNED_SHORT_4_4_4_4&&(s=e.RGBA4),i===e.UNSIGNED_SHORT_5_5_5_1&&(s=e.RGB5_A1)),s!==e.R16F&&s!==e.R32F&&s!==e.RG16F&&s!==e.RG32F&&s!==e.RGBA16F&&s!==e.RGBA32F||t.get("EXT_color_buffer_float"),s}function T(e,t,n){return!0===S(e,n)||e.isFramebufferTexture&&e.minFilter!==hx&&e.minFilter!==px?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function E(t){return t===hx||t===fx||t===dx?e.NEAREST:e.LINEAR}function C(e){var t=e.target;t.removeEventListener("dispose",C),function(e){var t=r.get(e);if(void 0===t.__webglInit)return;var n=e.source,i=y.get(n);if(i){var a=i[t.__cacheKey];a.usedTimes--,0===a.usedTimes&&R(e),0===Object.keys(i).length&&y.delete(n)}r.remove(e)}(t),t.isVideoTexture&&g.delete(t)}function A(t){var n=t.target;n.removeEventListener("dispose",A),function(t){var n=t.texture,i=r.get(t),a=r.get(n);void 0!==a.__webglTexture&&(e.deleteTexture(a.__webglTexture),o.memory.textures--);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLCubeRenderTarget)for(var s=0;s<6;s++)e.deleteFramebuffer(i.__webglFramebuffer[s]),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer[s]);else{if(e.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer),i.__webglMultisampledFramebuffer&&e.deleteFramebuffer(i.__webglMultisampledFramebuffer),i.__webglColorRenderbuffer)for(var u=0;u<i.__webglColorRenderbuffer.length;u++)i.__webglColorRenderbuffer[u]&&e.deleteRenderbuffer(i.__webglColorRenderbuffer[u]);i.__webglDepthRenderbuffer&&e.deleteRenderbuffer(i.__webglDepthRenderbuffer)}if(t.isWebGLMultipleRenderTargets)for(var l=0,c=n.length;l<c;l++){var h=r.get(n[l]);h.__webglTexture&&(e.deleteTexture(h.__webglTexture),o.memory.textures--),r.remove(n[l])}r.remove(n),r.remove(t)}(n)}function R(t){var n=r.get(t);e.deleteTexture(n.__webglTexture);var i=t.source;delete y.get(i)[n.__cacheKey],o.memory.textures--}var P=0;function L(t,i){var a=r.get(t);if(t.isVideoTexture&&function(e){var t=o.render.frame;g.get(e)!==t&&(g.set(e,t),e.update())}(t),!1===t.isRenderTargetTexture&&t.version>0&&a.__version!==t.version){var s=t.image;if(null===s)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==s.complete)return void U(a,t,i);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.bindTexture(e.TEXTURE_2D,a.__webglTexture,e.TEXTURE0+i)}var D=(gr(s={},ux,e.REPEAT),gr(s,lx,e.CLAMP_TO_EDGE),gr(s,cx,e.MIRRORED_REPEAT),s),N=(gr(u={},hx,e.NEAREST),gr(u,fx,e.NEAREST_MIPMAP_NEAREST),gr(u,dx,e.NEAREST_MIPMAP_LINEAR),gr(u,px,e.LINEAR),gr(u,1007,e.LINEAR_MIPMAP_NEAREST),gr(u,vx,e.LINEAR_MIPMAP_LINEAR),u);function I(n,a,o){if(o?(e.texParameteri(n,e.TEXTURE_WRAP_S,D[a.wrapS]),e.texParameteri(n,e.TEXTURE_WRAP_T,D[a.wrapT]),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,D[a.wrapR]),e.texParameteri(n,e.TEXTURE_MAG_FILTER,N[a.magFilter]),e.texParameteri(n,e.TEXTURE_MIN_FILTER,N[a.minFilter])):(e.texParameteri(n,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(n,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,e.CLAMP_TO_EDGE),a.wrapS===lx&&a.wrapT===lx||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,e.TEXTURE_MAG_FILTER,E(a.magFilter)),e.texParameteri(n,e.TEXTURE_MIN_FILTER,E(a.minFilter)),a.minFilter!==hx&&a.minFilter!==px&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===t.has("EXT_texture_filter_anisotropic")){var s=t.get("EXT_texture_filter_anisotropic");if(a.magFilter===hx)return;if(a.minFilter!==dx&&a.minFilter!==vx)return;if(a.type===bx&&!1===t.has("OES_texture_float_linear"))return;if(!1===c&&a.type===_x&&!1===t.has("OES_texture_half_float_linear"))return;(a.anisotropy>1||r.get(a).__currentAnisotropy)&&(e.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy)}}function O(t,n){var r=!1;void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",C));var i=n.source,a=y.get(i);void 0===a&&(a={},y.set(i,a));var s=function(e){var t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.colorSpace),t.join()}(n);if(s!==t.__cacheKey){void 0===a[s]&&(a[s]={texture:e.createTexture(),usedTimes:0},o.memory.textures++,r=!0),a[s].usedTimes++;var u=a[t.__cacheKey];void 0!==u&&(a[t.__cacheKey].usedTimes--,0===u.usedTimes&&R(n)),t.__cacheKey=s,t.__webglTexture=a[s].texture}return r}function U(t,i,o){var s=e.TEXTURE_2D;(i.isDataArrayTexture||i.isCompressedArrayTexture)&&(s=e.TEXTURE_2D_ARRAY),i.isData3DTexture&&(s=e.TEXTURE_3D);var u=O(t,i),l=i.source;n.bindTexture(s,t.__webglTexture,e.TEXTURE0+o);var h=r.get(l);if(l.version!==h.__version||!0===u){n.activeTexture(e.TEXTURE0+o),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,i.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,i.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE);var f,p=function(e){return!c&&(e.wrapS!==lx||e.wrapT!==lx||e.minFilter!==hx&&e.minFilter!==px)}(i)&&!1===w(i.image),v=x(i.image,p,!1,d),m=w(v=j(i,v))||c,g=a.convert(i.format,i.colorSpace),y=a.convert(i.type),b=k(i.internalFormat,g,y,i.colorSpace);I(s,i,m);var _=i.mipmaps,E=c&&!0!==i.isVideoTexture,C=void 0===h.__version||!0===u,A=T(i,v,m);if(i.isDepthTexture)b=e.DEPTH_COMPONENT,c?b=i.type===bx?e.DEPTH_COMPONENT32F:i.type===yx?e.DEPTH_COMPONENT24:i.type===xx?e.DEPTH24_STENCIL8:e.DEPTH_COMPONENT16:i.type===bx&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),i.format===Sx&&b===e.DEPTH_COMPONENT&&i.type!==gx&&i.type!==yx&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),i.type=yx,y=a.convert(i.type)),i.format===Mx&&b===e.DEPTH_COMPONENT&&(b=e.DEPTH_STENCIL,i.type!==xx&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),i.type=xx,y=a.convert(i.type))),C&&(E?n.texStorage2D(e.TEXTURE_2D,1,b,v.width,v.height):n.texImage2D(e.TEXTURE_2D,0,b,v.width,v.height,0,g,y,null));else if(i.isDataTexture)if(_.length>0&&m){E&&C&&n.texStorage2D(e.TEXTURE_2D,A,b,_[0].width,_[0].height);for(var R=0,P=_.length;R<P;R++)f=_[R],E?n.texSubImage2D(e.TEXTURE_2D,R,0,0,f.width,f.height,g,y,f.data):n.texImage2D(e.TEXTURE_2D,R,b,f.width,f.height,0,g,y,f.data);i.generateMipmaps=!1}else E?(C&&n.texStorage2D(e.TEXTURE_2D,A,b,v.width,v.height),n.texSubImage2D(e.TEXTURE_2D,0,0,0,v.width,v.height,g,y,v.data)):n.texImage2D(e.TEXTURE_2D,0,b,v.width,v.height,0,g,y,v.data);else if(i.isCompressedTexture)if(i.isCompressedArrayTexture){E&&C&&n.texStorage3D(e.TEXTURE_2D_ARRAY,A,b,_[0].width,_[0].height,v.depth);for(var L=0,D=_.length;L<D;L++)f=_[L],i.format!==wx?null!==g?E?n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,L,0,0,0,f.width,f.height,v.depth,g,f.data,0,0):n.compressedTexImage3D(e.TEXTURE_2D_ARRAY,L,b,f.width,f.height,v.depth,0,f.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):E?n.texSubImage3D(e.TEXTURE_2D_ARRAY,L,0,0,0,f.width,f.height,v.depth,g,y,f.data):n.texImage3D(e.TEXTURE_2D_ARRAY,L,b,f.width,f.height,v.depth,0,g,y,f.data)}else{E&&C&&n.texStorage2D(e.TEXTURE_2D,A,b,_[0].width,_[0].height);for(var N=0,U=_.length;N<U;N++)f=_[N],i.format!==wx?null!==g?E?n.compressedTexSubImage2D(e.TEXTURE_2D,N,0,0,f.width,f.height,g,f.data):n.compressedTexImage2D(e.TEXTURE_2D,N,b,f.width,f.height,0,f.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):E?n.texSubImage2D(e.TEXTURE_2D,N,0,0,f.width,f.height,g,y,f.data):n.texImage2D(e.TEXTURE_2D,N,b,f.width,f.height,0,g,y,f.data)}else if(i.isDataArrayTexture)E?(C&&n.texStorage3D(e.TEXTURE_2D_ARRAY,A,b,v.width,v.height,v.depth),n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,v.width,v.height,v.depth,g,y,v.data)):n.texImage3D(e.TEXTURE_2D_ARRAY,0,b,v.width,v.height,v.depth,0,g,y,v.data);else if(i.isData3DTexture)E?(C&&n.texStorage3D(e.TEXTURE_3D,A,b,v.width,v.height,v.depth),n.texSubImage3D(e.TEXTURE_3D,0,0,0,0,v.width,v.height,v.depth,g,y,v.data)):n.texImage3D(e.TEXTURE_3D,0,b,v.width,v.height,v.depth,0,g,y,v.data);else if(i.isFramebufferTexture){if(C)if(E)n.texStorage2D(e.TEXTURE_2D,A,b,v.width,v.height);else for(var F=v.width,z=v.height,B=0;B<A;B++)n.texImage2D(e.TEXTURE_2D,B,b,F,z,0,g,y,null),F>>=1,z>>=1}else if(_.length>0&&m){E&&C&&n.texStorage2D(e.TEXTURE_2D,A,b,_[0].width,_[0].height);for(var V=0,G=_.length;V<G;V++)f=_[V],E?n.texSubImage2D(e.TEXTURE_2D,V,0,0,g,y,f):n.texImage2D(e.TEXTURE_2D,V,b,g,y,f);i.generateMipmaps=!1}else E?(C&&n.texStorage2D(e.TEXTURE_2D,A,b,v.width,v.height),n.texSubImage2D(e.TEXTURE_2D,0,0,0,g,y,v)):n.texImage2D(e.TEXTURE_2D,0,b,g,y,v);S(i,m)&&M(s),h.__version=l.version,i.onUpdate&&i.onUpdate(i)}t.__version=i.version}function F(t,i,o,s,u){var l=a.convert(o.format,o.colorSpace),c=a.convert(o.type),h=k(o.internalFormat,l,c,o.colorSpace);r.get(i).__hasExternalTextures||(u===e.TEXTURE_3D||u===e.TEXTURE_2D_ARRAY?n.texImage3D(u,0,h,i.width,i.height,i.depth,0,l,c,null):n.texImage2D(u,0,h,i.width,i.height,0,l,c,null)),n.bindFramebuffer(e.FRAMEBUFFER,t),G(i)?v.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,s,u,r.get(o).__webglTexture,0,V(i)):(u===e.TEXTURE_2D||u>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&u<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,s,u,r.get(o).__webglTexture,0),n.bindFramebuffer(e.FRAMEBUFFER,null)}function z(t,n,r){if(e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer&&!n.stencilBuffer){var i=e.DEPTH_COMPONENT16;if(r||G(n)){var o=n.depthTexture;o&&o.isDepthTexture&&(o.type===bx?i=e.DEPTH_COMPONENT32F:o.type===yx&&(i=e.DEPTH_COMPONENT24));var s=V(n);G(n)?v.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,s,i,n.width,n.height):e.renderbufferStorageMultisample(e.RENDERBUFFER,s,i,n.width,n.height)}else e.renderbufferStorage(e.RENDERBUFFER,i,n.width,n.height);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)}else if(n.depthBuffer&&n.stencilBuffer){var u=V(n);r&&!1===G(n)?e.renderbufferStorageMultisample(e.RENDERBUFFER,u,e.DEPTH24_STENCIL8,n.width,n.height):G(n)?v.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,u,e.DEPTH24_STENCIL8,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t)}else for(var l=!0===n.isWebGLMultipleRenderTargets?n.texture:[n.texture],c=0;c<l.length;c++){var h=l[c],f=a.convert(h.format,h.colorSpace),d=a.convert(h.type),p=k(h.internalFormat,f,d,h.colorSpace),m=V(n);r&&!1===G(n)?e.renderbufferStorageMultisample(e.RENDERBUFFER,m,p,n.width,n.height):G(n)?v.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,m,p,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,p,n.width,n.height)}e.bindRenderbuffer(e.RENDERBUFFER,null)}function B(t){var i=r.get(t),a=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture&&!i.__autoAllocateDepthBuffer){if(a)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,i){if(i&&i.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(e.FRAMEBUFFER,t),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),L(i.depthTexture,0);var a=r.get(i.depthTexture).__webglTexture,o=V(i);if(i.depthTexture.format===Sx)G(i)?v.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a,0,o):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a,0);else{if(i.depthTexture.format!==Mx)throw new Error("Unknown depthTexture format");G(i)?v.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,a,0,o):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,a,0)}}(i.__webglFramebuffer,t)}else if(a){i.__webglDepthbuffer=[];for(var o=0;o<6;o++)n.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer[o]),i.__webglDepthbuffer[o]=e.createRenderbuffer(),z(i.__webglDepthbuffer[o],t,!1)}else n.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer),i.__webglDepthbuffer=e.createRenderbuffer(),z(i.__webglDepthbuffer,t,!1);n.bindFramebuffer(e.FRAMEBUFFER,null)}function V(e){return Math.min(p,e.samples)}function G(e){var n=r.get(e);return c&&e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function j(e,n){var r=e.colorSpace,i=e.format,a=e.type;return!0===e.isCompressedTexture||e.format===pw||r!==lw&&r!==sw&&(r===uw?!1===c?!0===t.has("EXT_sRGB")&&i===wx?(e.format=pw,e.minFilter=px,e.generateMipmaps=!1):n=Ww.sRGBToLinear(n):i===wx&&a===mx||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",r)),n}this.allocateTextureUnit=function(){var e=P;return e>=h&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+h),P+=1,e},this.resetTextureUnits=function(){P=0},this.setTexture2D=L,this.setTexture2DArray=function(t,i){var a=r.get(t);t.version>0&&a.__version!==t.version?U(a,t,i):n.bindTexture(e.TEXTURE_2D_ARRAY,a.__webglTexture,e.TEXTURE0+i)},this.setTexture3D=function(t,i){var a=r.get(t);t.version>0&&a.__version!==t.version?U(a,t,i):n.bindTexture(e.TEXTURE_3D,a.__webglTexture,e.TEXTURE0+i)},this.setTextureCube=function(t,i){var o=r.get(t);t.version>0&&o.__version!==t.version?function(t,i,o){if(6!==i.image.length)return;var s=O(t,i),u=i.source;n.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture,e.TEXTURE0+o);var l=r.get(u);if(u.version!==l.__version||!0===s){n.activeTexture(e.TEXTURE0+o),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,i.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,i.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE);for(var h=i.isCompressedTexture||i.image[0].isCompressedTexture,d=i.image[0]&&i.image[0].isDataTexture,p=[],v=0;v<6;v++)p[v]=h||d?d?i.image[v].image:i.image[v]:x(i.image[v],!1,!0,f),p[v]=j(i,p[v]);var m,g=p[0],y=w(g)||c,b=a.convert(i.format,i.colorSpace),_=a.convert(i.type),E=k(i.internalFormat,b,_,i.colorSpace),C=c&&!0!==i.isVideoTexture,A=void 0===l.__version||!0===s,R=T(i,g,y);if(I(e.TEXTURE_CUBE_MAP,i,y),h){C&&A&&n.texStorage2D(e.TEXTURE_CUBE_MAP,R,E,g.width,g.height);for(var P=0;P<6;P++){m=p[P].mipmaps;for(var L=0;L<m.length;L++){var D=m[L];i.format!==wx?null!==b?C?n.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+P,L,0,0,D.width,D.height,b,D.data):n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+P,L,E,D.width,D.height,0,D.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):C?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+P,L,0,0,D.width,D.height,b,_,D.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+P,L,E,D.width,D.height,0,b,_,D.data)}}}else{m=i.mipmaps,C&&A&&(m.length>0&&R++,n.texStorage2D(e.TEXTURE_CUBE_MAP,R,E,p[0].width,p[0].height));for(var N=0;N<6;N++)if(d){C?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+N,0,0,0,p[N].width,p[N].height,b,_,p[N].data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+N,0,E,p[N].width,p[N].height,0,b,_,p[N].data);for(var U=0;U<m.length;U++){var F=m[U].image[N].image;C?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+N,U+1,0,0,F.width,F.height,b,_,F.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+N,U+1,E,F.width,F.height,0,b,_,F.data)}}else{C?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+N,0,0,0,b,_,p[N]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+N,0,E,b,_,p[N]);for(var z=0;z<m.length;z++){var B=m[z];C?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+N,z+1,0,0,b,_,B.image[N]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+N,z+1,E,b,_,B.image[N])}}}S(i,y)&&M(e.TEXTURE_CUBE_MAP),l.__version=u.version,i.onUpdate&&i.onUpdate(i)}t.__version=i.version}(o,t,i):n.bindTexture(e.TEXTURE_CUBE_MAP,o.__webglTexture,e.TEXTURE0+i)},this.rebindTextures=function(t,n,i){var a=r.get(t);void 0!==n&&F(a.__webglFramebuffer,t,t.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D),void 0!==i&&B(t)},this.setupRenderTarget=function(t){var s=t.texture,u=r.get(t),l=r.get(s);t.addEventListener("dispose",A),!0!==t.isWebGLMultipleRenderTargets&&(void 0===l.__webglTexture&&(l.__webglTexture=e.createTexture()),l.__version=s.version,o.memory.textures++);var h=!0===t.isWebGLCubeRenderTarget,f=!0===t.isWebGLMultipleRenderTargets,d=w(t)||c;if(h){u.__webglFramebuffer=[];for(var p=0;p<6;p++)u.__webglFramebuffer[p]=e.createFramebuffer()}else{if(u.__webglFramebuffer=e.createFramebuffer(),f)if(i.drawBuffers)for(var v=t.texture,m=0,g=v.length;m<g;m++){var y=r.get(v[m]);void 0===y.__webglTexture&&(y.__webglTexture=e.createTexture(),o.memory.textures++)}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(c&&t.samples>0&&!1===G(t)){var b=f?s:[s];u.__webglMultisampledFramebuffer=e.createFramebuffer(),u.__webglColorRenderbuffer=[],n.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer);for(var _=0;_<b.length;_++){var x=b[_];u.__webglColorRenderbuffer[_]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,u.__webglColorRenderbuffer[_]);var T=a.convert(x.format,x.colorSpace),E=a.convert(x.type),C=k(x.internalFormat,T,E,x.colorSpace,!0===t.isXRRenderTarget),R=V(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,R,C,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+_,e.RENDERBUFFER,u.__webglColorRenderbuffer[_])}e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(u.__webglDepthRenderbuffer=e.createRenderbuffer(),z(u.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(e.FRAMEBUFFER,null)}}if(h){n.bindTexture(e.TEXTURE_CUBE_MAP,l.__webglTexture),I(e.TEXTURE_CUBE_MAP,s,d);for(var P=0;P<6;P++)F(u.__webglFramebuffer[P],t,s,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+P);S(s,d)&&M(e.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(f){for(var L=t.texture,D=0,N=L.length;D<N;D++){var O=L[D],U=r.get(O);n.bindTexture(e.TEXTURE_2D,U.__webglTexture),I(e.TEXTURE_2D,O,d),F(u.__webglFramebuffer,t,O,e.COLOR_ATTACHMENT0+D,e.TEXTURE_2D),S(O,d)&&M(e.TEXTURE_2D)}n.unbindTexture()}else{var j=e.TEXTURE_2D;(t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(c?j=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(j,l.__webglTexture),I(j,s,d),F(u.__webglFramebuffer,t,s,e.COLOR_ATTACHMENT0,j),S(s,d)&&M(j),n.unbindTexture()}t.depthBuffer&&B(t)},this.updateRenderTargetMipmap=function(t){for(var i=w(t)||c,a=!0===t.isWebGLMultipleRenderTargets?t.texture:[t.texture],o=0,s=a.length;o<s;o++){var u=a[o];if(S(u,i)){var l=t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,h=r.get(u).__webglTexture;n.bindTexture(l,h),M(l),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(c&&t.samples>0&&!1===G(t)){var i=t.isWebGLMultipleRenderTargets?t.texture:[t.texture],a=t.width,o=t.height,s=e.COLOR_BUFFER_BIT,u=[],l=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,h=r.get(t),f=!0===t.isWebGLMultipleRenderTargets;if(f)for(var d=0;d<i.length;d++)n.bindFramebuffer(e.FRAMEBUFFER,h.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+d,e.RENDERBUFFER,null),n.bindFramebuffer(e.FRAMEBUFFER,h.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+d,e.TEXTURE_2D,null,0);n.bindFramebuffer(e.READ_FRAMEBUFFER,h.__webglMultisampledFramebuffer),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,h.__webglFramebuffer);for(var p=0;p<i.length;p++){u.push(e.COLOR_ATTACHMENT0+p),t.depthBuffer&&u.push(l);var v=void 0!==h.__ignoreDepthValues&&h.__ignoreDepthValues;if(!1===v&&(t.depthBuffer&&(s|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&(s|=e.STENCIL_BUFFER_BIT)),f&&e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,h.__webglColorRenderbuffer[p]),!0===v&&(e.invalidateFramebuffer(e.READ_FRAMEBUFFER,[l]),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[l])),f){var g=r.get(i[p]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,g,0)}e.blitFramebuffer(0,0,a,o,0,0,a,o,s,e.NEAREST),m&&e.invalidateFramebuffer(e.READ_FRAMEBUFFER,u)}if(n.bindFramebuffer(e.READ_FRAMEBUFFER,null),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),f)for(var y=0;y<i.length;y++){n.bindFramebuffer(e.FRAMEBUFFER,h.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+y,e.RENDERBUFFER,h.__webglColorRenderbuffer[y]);var b=r.get(i[y]).__webglTexture;n.bindFramebuffer(e.FRAMEBUFFER,h.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+y,e.TEXTURE_2D,b,0)}n.bindFramebuffer(e.DRAW_FRAMEBUFFER,h.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=B,this.setupFrameBufferTexture=F,this.useMultisampledRTT=G}function HE(e,t,n){var r=n.isWebGL2;return{convert:function(n){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:sw;if(n===mx)return e.UNSIGNED_BYTE;if(1017===n)return e.UNSIGNED_SHORT_4_4_4_4;if(1018===n)return e.UNSIGNED_SHORT_5_5_5_1;if(1010===n)return e.BYTE;if(1011===n)return e.SHORT;if(n===gx)return e.UNSIGNED_SHORT;if(1013===n)return e.INT;if(n===yx)return e.UNSIGNED_INT;if(n===bx)return e.FLOAT;if(n===_x)return r?e.HALF_FLOAT:null!==(i=t.get("OES_texture_half_float"))?i.HALF_FLOAT_OES:null;if(1021===n)return e.ALPHA;if(n===wx)return e.RGBA;if(1024===n)return e.LUMINANCE;if(1025===n)return e.LUMINANCE_ALPHA;if(n===Sx)return e.DEPTH_COMPONENT;if(n===Mx)return e.DEPTH_STENCIL;if(n===pw)return null!==(i=t.get("EXT_sRGB"))?i.SRGB_ALPHA_EXT:null;if(1028===n)return e.RED;if(1029===n)return e.RED_INTEGER;if(1030===n)return e.RG;if(1031===n)return e.RG_INTEGER;if(1033===n)return e.RGBA_INTEGER;if(n===kx||n===Tx||n===Ex||n===Cx)if(a===uw){if(null===(i=t.get("WEBGL_compressed_texture_s3tc_srgb")))return null;if(n===kx)return i.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Tx)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===Ex)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Cx)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(null===(i=t.get("WEBGL_compressed_texture_s3tc")))return null;if(n===kx)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Tx)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Ex)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Cx)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===Ax||n===Rx||n===Px||n===Lx){if(null===(i=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(n===Ax)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===Rx)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===Px)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===Lx)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===n)return null!==(i=t.get("WEBGL_compressed_texture_etc1"))?i.COMPRESSED_RGB_ETC1_WEBGL:null;if(n===Dx||n===Nx){if(null===(i=t.get("WEBGL_compressed_texture_etc")))return null;if(n===Dx)return a===uw?i.COMPRESSED_SRGB8_ETC2:i.COMPRESSED_RGB8_ETC2;if(n===Nx)return a===uw?i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC}if(n===Ix||n===Ox||n===Ux||n===Fx||n===zx||n===Bx||n===Vx||n===Gx||n===jx||n===Hx||n===Wx||n===Zx||n===qx||n===Xx){if(null===(i=t.get("WEBGL_compressed_texture_astc")))return null;if(n===Ix)return a===uw?i.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:i.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===Ox)return a===uw?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:i.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===Ux)return a===uw?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:i.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===Fx)return a===uw?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:i.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===zx)return a===uw?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:i.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===Bx)return a===uw?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:i.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===Vx)return a===uw?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:i.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===Gx)return a===uw?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:i.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===jx)return a===uw?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:i.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===Hx)return a===uw?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:i.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===Wx)return a===uw?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:i.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===Zx)return a===uw?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:i.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===qx)return a===uw?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:i.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===Xx)return a===uw?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:i.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===Yx){if(null===(i=t.get("EXT_texture_compression_bptc")))return null;if(n===Yx)return a===uw?i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:i.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(36283===n||n===Kx||n===Jx||n===Qx){if(null===(i=t.get("EXT_texture_compression_rgtc")))return null;if(n===Yx)return i.COMPRESSED_RED_RGTC1_EXT;if(n===Kx)return i.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===Jx)return i.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===Qx)return i.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return n===xx?r?e.UNSIGNED_INT_24_8:null!==(i=t.get("WEBGL_depth_texture"))?i.UNSIGNED_INT_24_8_WEBGL:null:void 0!==e[n]?e[n]:null}}}var WE=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,u.Z)(this,n),(e=t.call(this)).isArrayCamera=!0,e.cameras=r,e}return(0,l.Z)(n)}(ck),ZE=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.call(this)).isGroup=!0,e.type="Group",e}return(0,l.Z)(n)}(nM),qE={type:"move"},XE=function(){function e(){(0,u.Z)(this,e),this._targetRay=null,this._grip=null,this._hand=null}return(0,l.Z)(e,[{key:"getHandSpace",value:function(){return null===this._hand&&(this._hand=new ZE,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}},{key:"getTargetRaySpace",value:function(){return null===this._targetRay&&(this._targetRay=new ZE,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new tS,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new tS),this._targetRay}},{key:"getGripSpace",value:function(){return null===this._grip&&(this._grip=new ZE,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new tS,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new tS),this._grip}},{key:"dispatchEvent",value:function(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}},{key:"connect",value:function(e){if(e&&e.hand){var t=this._hand;if(t){var n,r=s(e.hand.values());try{for(r.s();!(n=r.n()).done;){var i=n.value;this._getHandJoint(t,i)}}catch(a){r.e(a)}finally{r.f()}}}return this.dispatchEvent({type:"connected",data:e}),this}},{key:"disconnect",value:function(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}},{key:"update",value:function(e,t,n){var r=null,i=null,a=null,o=this._targetRay,u=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){a=!0;var c,h=s(e.hand.values());try{for(h.s();!(c=h.n()).done;){var f=c.value,d=t.getJointPose(f,n),p=this._getHandJoint(l,f);null!==d&&(p.matrix.fromArray(d.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale),p.matrixWorldNeedsUpdate=!0,p.jointRadius=d.radius),p.visible=null!==d}}catch(y){h.e(y)}finally{h.f()}var v=l.joints["index-finger-tip"],m=l.joints["thumb-tip"],g=v.position.distanceTo(m.position);l.inputState.pinching&&g>.025?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&g<=.015&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==u&&e.gripSpace&&null!==(i=t.getPose(e.gripSpace,n))&&(u.matrix.fromArray(i.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),u.matrixWorldNeedsUpdate=!0,i.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(i.linearVelocity)):u.hasLinearVelocity=!1,i.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(i.angularVelocity)):u.hasAngularVelocity=!1);null!==o&&(null===(r=t.getPose(e.targetRaySpace,n))&&null!==i&&(r=i),null!==r&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(qE)))}return null!==o&&(o.visible=null!==r),null!==u&&(u.visible=null!==i),null!==l&&(l.visible=null!==a),this}},{key:"_getHandJoint",value:function(e,t){if(void 0===e.joints[t.jointName]){var n=new ZE;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}]),e}(),YE=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i,a,o,s,l,c,h,f){var d;if((0,u.Z)(this,n),(f=void 0!==f?f:Sx)!==Sx&&f!==Mx)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");return void 0===i&&f===Sx&&(i=yx),void 0===i&&f===Mx&&(i=xx),(d=t.call(this,null,a,o,s,l,c,f,i,h)).isDepthTexture=!0,d.image={width:e,height:r},d.magFilter=void 0!==l?l:hx,d.minFilter=void 0!==c?c:hx,d.flipY=!1,d.generateMipmaps=!1,d}return(0,l.Z)(n)}(Yw),KE=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r){var i;(0,u.Z)(this,n),i=t.call(this);var a=(0,c.Z)(i),o=null,l=1,h=null,f="local-floor",d=1,p=null,v=null,m=null,g=null,y=null,b=null,_=r.getContextAttributes(),x=null,w=null,S=[],M=[],k=new Set,T=new Map,E=new ck;E.layers.enable(1),E.viewport=new Kw;var C=new ck;C.layers.enable(2),C.viewport=new Kw;var A=[E,C],R=new WE;R.layers.enable(1),R.layers.enable(2);var P=null,L=null;function D(e){var t=M.indexOf(e.inputSource);if(-1!==t){var n=S[t];void 0!==n&&(n.update(e.inputSource,e.frame,p||h),n.dispatchEvent({type:e.type,data:e.inputSource}))}}function N(){o.removeEventListener("select",D),o.removeEventListener("selectstart",D),o.removeEventListener("selectend",D),o.removeEventListener("squeeze",D),o.removeEventListener("squeezestart",D),o.removeEventListener("squeezeend",D),o.removeEventListener("end",N),o.removeEventListener("inputsourceschange",I);for(var t=0;t<S.length;t++){var n=M[t];null!==n&&(M[t]=null,S[t].disconnect(n))}P=null,L=null,e.setRenderTarget(x),y=null,g=null,m=null,o=null,w=null,B.stop(),a.isPresenting=!1,a.dispatchEvent({type:"sessionend"})}function I(e){for(var t=0;t<e.removed.length;t++){var n=e.removed[t],r=M.indexOf(n);r>=0&&(M[r]=null,S[r].disconnect(n))}for(var i=0;i<e.added.length;i++){var a=e.added[i],o=M.indexOf(a);if(-1===o){for(var s=0;s<S.length;s++){if(s>=M.length){M.push(a),o=s;break}if(null===M[s]){M[s]=a,o=s;break}}if(-1===o)break}var u=S[o];u&&u.connect(a)}}i.cameraAutoUpdate=!0,i.enabled=!1,i.isPresenting=!1,i.getController=function(e){var t=S[e];return void 0===t&&(t=new XE,S[e]=t),t.getTargetRaySpace()},i.getControllerGrip=function(e){var t=S[e];return void 0===t&&(t=new XE,S[e]=t),t.getGripSpace()},i.getHand=function(e){var t=S[e];return void 0===t&&(t=new XE,S[e]=t),t.getHandSpace()},i.setFramebufferScaleFactor=function(e){l=e,!0===a.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},i.setReferenceSpaceType=function(e){f=e,!0===a.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},i.getReferenceSpace=function(){return p||h},i.setReferenceSpace=function(e){p=e},i.getBaseLayer=function(){return null!==g?g:y},i.getBinding=function(){return m},i.getFrame=function(){return b},i.getSession=function(){return o},i.setSession=function(){var t=pr(fr().mark((function t(n){var i,s,u,c,v;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===(o=n)){t.next=25;break}if(x=e.getRenderTarget(),o.addEventListener("select",D),o.addEventListener("selectstart",D),o.addEventListener("selectend",D),o.addEventListener("squeeze",D),o.addEventListener("squeezestart",D),o.addEventListener("squeezeend",D),o.addEventListener("end",N),o.addEventListener("inputsourceschange",I),!0===_.xrCompatible){t.next=14;break}return t.next=14,r.makeXRCompatible();case 14:return void 0===o.renderState.layers||!1===e.capabilities.isWebGL2?(i={antialias:void 0!==o.renderState.layers||_.antialias,alpha:!0,depth:_.depth,stencil:_.stencil,framebufferScaleFactor:l},y=new XRWebGLLayer(o,r,i),o.updateRenderState({baseLayer:y}),w=new Jw(y.framebufferWidth,y.framebufferHeight,{format:wx,type:mx,colorSpace:e.outputColorSpace,stencilBuffer:_.stencil})):(s=null,u=null,c=null,_.depth&&(c=_.stencil?r.DEPTH24_STENCIL8:r.DEPTH_COMPONENT24,s=_.stencil?Mx:Sx,u=_.stencil?xx:yx),v={colorFormat:r.RGBA8,depthFormat:c,scaleFactor:l},m=new XRWebGLBinding(o,r),g=m.createProjectionLayer(v),o.updateRenderState({layers:[g]}),w=new Jw(g.textureWidth,g.textureHeight,{format:wx,type:mx,depthTexture:new YE(g.textureWidth,g.textureHeight,u,void 0,void 0,void 0,void 0,void 0,void 0,s),stencilBuffer:_.stencil,colorSpace:e.outputColorSpace,samples:_.antialias?4:0}),e.properties.get(w).__ignoreDepthValues=g.ignoreDepthValues),w.isXRRenderTarget=!0,this.setFoveation(d),p=null,t.next=20,o.requestReferenceSpace(f);case 20:h=t.sent,B.setContext(o),B.start(),a.isPresenting=!0,a.dispatchEvent({type:"sessionstart"});case 25:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),i.getEnvironmentBlendMode=function(){if(null!==o)return o.environmentBlendMode};var O=new tS,U=new tS;function F(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}i.updateCamera=function(e){if(null!==o){R.near=C.near=E.near=e.near,R.far=C.far=E.far=e.far,P===R.near&&L===R.far||(o.updateRenderState({depthNear:R.near,depthFar:R.far}),P=R.near,L=R.far);var t=e.parent,n=R.cameras;F(R,t);for(var r=0;r<n.length;r++)F(n[r],t);2===n.length?function(e,t,n){O.setFromMatrixPosition(t.matrixWorld),U.setFromMatrixPosition(n.matrixWorld);var r=O.distanceTo(U),i=t.projectionMatrix.elements,a=n.projectionMatrix.elements,o=i[14]/(i[10]-1),s=i[14]/(i[10]+1),u=(i[9]+1)/i[5],l=(i[9]-1)/i[5],c=(i[8]-1)/i[0],h=(a[8]+1)/a[0],f=o*c,d=o*h,p=r/(-c+h),v=p*-c;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(v),e.translateZ(p),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();var m=o+p,g=s+p,y=f-v,b=d+(r-v),_=u*s/g*m,x=l*s/g*m;e.projectionMatrix.makePerspective(y,b,_,x,m,g),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}(R,E,C):R.projectionMatrix.copy(E.projectionMatrix),function(e,t,n){null===n?e.matrix.copy(t.matrixWorld):(e.matrix.copy(n.matrixWorld),e.matrix.invert(),e.matrix.multiply(t.matrixWorld));e.matrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrixWorld(!0);for(var r=e.children,i=0,a=r.length;i<a;i++)r[i].updateMatrixWorld(!0);e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse),e.isPerspectiveCamera&&(e.fov=2*bw*Math.atan(1/e.projectionMatrix.elements[5]),e.zoom=1)}(e,R,t)}},i.getCamera=function(){return R},i.getFoveation=function(){if(null!==g||null!==y)return d},i.setFoveation=function(e){d=e,null!==g&&(g.fixedFoveation=e),null!==y&&void 0!==y.fixedFoveation&&(y.fixedFoveation=e)},i.getPlanes=function(){return k};var z=null;var B=new wk;return B.setAnimationLoop((function(t,n){if(v=n.getViewerPose(p||h),b=n,null!==v){var r=v.views;null!==y&&(e.setRenderTargetFramebuffer(w,y.framebuffer),e.setRenderTarget(w));var i=!1;r.length!==R.cameras.length&&(R.cameras.length=0,i=!0);for(var o=0;o<r.length;o++){var u=r[o],l=null;if(null!==y)l=y.getViewport(u);else{var c=m.getViewSubImage(g,u);l=c.viewport,0===o&&(e.setRenderTargetTextures(w,c.colorTexture,g.ignoreDepthValues?void 0:c.depthStencilTexture),e.setRenderTarget(w))}var f=A[o];void 0===f&&((f=new ck).layers.enable(o),f.viewport=new Kw,A[o]=f),f.matrix.fromArray(u.transform.matrix),f.matrix.decompose(f.position,f.quaternion,f.scale),f.projectionMatrix.fromArray(u.projectionMatrix),f.projectionMatrixInverse.copy(f.projectionMatrix).invert(),f.viewport.set(l.x,l.y,l.width,l.height),0===o&&(R.matrix.copy(f.matrix),R.matrix.decompose(R.position,R.quaternion,R.scale)),!0===i&&R.cameras.push(f)}}for(var d=0;d<S.length;d++){var _=M[d],x=S[d];null!==_&&void 0!==x&&x.update(_,n,p||h)}if(z&&z(t,n),n.detectedPlanes){a.dispatchEvent({type:"planesdetected",data:n.detectedPlanes});var E,C=null,P=s(k);try{for(P.s();!(E=P.n()).done;){var L=E.value;n.detectedPlanes.has(L)||(null===C&&(C=[]),C.push(L))}}catch(V){P.e(V)}finally{P.f()}if(null!==C){var D,N=s(C);try{for(N.s();!(D=N.n()).done;){var I=D.value;k.delete(I),T.delete(I),a.dispatchEvent({type:"planeremoved",data:I})}}catch(V){N.e(V)}finally{N.f()}}var O,U=s(n.detectedPlanes);try{for(U.s();!(O=U.n()).done;){var F=O.value;if(k.has(F)){var B=T.get(F);F.lastChangedTime>B&&(T.set(F,F.lastChangedTime),a.dispatchEvent({type:"planechanged",data:F}))}else k.add(F),T.set(F,n.lastChangedTime),a.dispatchEvent({type:"planeadded",data:F})}}catch(V){U.e(V)}finally{U.f()}}b=null})),i.setAnimationLoop=function(e){z=e},i.dispose=function(){},i}return(0,l.Z)(n)}(vw);function JE(e,t){function n(e,t){!0===e.matrixAutoUpdate&&e.updateMatrix(),t.value.copy(e.matrix)}function r(r,i){r.opacity.value=i.opacity,i.color&&r.diffuse.value.copy(i.color),i.emissive&&r.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),i.map&&(r.map.value=i.map,n(i.map,r.mapTransform)),i.alphaMap&&(r.alphaMap.value=i.alphaMap,n(i.alphaMap,r.alphaMapTransform)),i.bumpMap&&(r.bumpMap.value=i.bumpMap,n(i.bumpMap,r.bumpMapTransform),r.bumpScale.value=i.bumpScale,1===i.side&&(r.bumpScale.value*=-1)),i.normalMap&&(r.normalMap.value=i.normalMap,n(i.normalMap,r.normalMapTransform),r.normalScale.value.copy(i.normalScale),1===i.side&&r.normalScale.value.negate()),i.displacementMap&&(r.displacementMap.value=i.displacementMap,n(i.displacementMap,r.displacementMapTransform),r.displacementScale.value=i.displacementScale,r.displacementBias.value=i.displacementBias),i.emissiveMap&&(r.emissiveMap.value=i.emissiveMap,n(i.emissiveMap,r.emissiveMapTransform)),i.specularMap&&(r.specularMap.value=i.specularMap,n(i.specularMap,r.specularMapTransform)),i.alphaTest>0&&(r.alphaTest.value=i.alphaTest);var a=t.get(i).envMap;if(a&&(r.envMap.value=a,r.flipEnvMap.value=a.isCubeTexture&&!1===a.isRenderTargetTexture?-1:1,r.reflectivity.value=i.reflectivity,r.ior.value=i.ior,r.refractionRatio.value=i.refractionRatio),i.lightMap){r.lightMap.value=i.lightMap;var o=!0===e.useLegacyLights?Math.PI:1;r.lightMapIntensity.value=i.lightMapIntensity*o,n(i.lightMap,r.lightMapTransform)}i.aoMap&&(r.aoMap.value=i.aoMap,r.aoMapIntensity.value=i.aoMapIntensity,n(i.aoMap,r.aoMapTransform))}return{refreshFogUniforms:function(t,n){n.color.getRGB(t.fogColor.value,ok(e)),n.isFog?(t.fogNear.value=n.near,t.fogFar.value=n.far):n.isFogExp2&&(t.fogDensity.value=n.density)},refreshMaterialUniforms:function(e,i,a,o,s){i.isMeshBasicMaterial||i.isMeshLambertMaterial?r(e,i):i.isMeshToonMaterial?(r(e,i),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,i)):i.isMeshPhongMaterial?(r(e,i),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,i)):i.isMeshStandardMaterial?(r(e,i),function(e,r){e.metalness.value=r.metalness,r.metalnessMap&&(e.metalnessMap.value=r.metalnessMap,n(r.metalnessMap,e.metalnessMapTransform));e.roughness.value=r.roughness,r.roughnessMap&&(e.roughnessMap.value=r.roughnessMap,n(r.roughnessMap,e.roughnessMapTransform));t.get(r).envMap&&(e.envMapIntensity.value=r.envMapIntensity)}(e,i),i.isMeshPhysicalMaterial&&function(e,t,r){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap,n(t.sheenColorMap,e.sheenColorMapTransform)),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap,n(t.sheenRoughnessMap,e.sheenRoughnessMapTransform)));t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap,n(t.clearcoatMap,e.clearcoatMapTransform)),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap,n(t.clearcoatRoughnessMap,e.clearcoatRoughnessMapTransform)),t.clearcoatNormalMap&&(e.clearcoatNormalMap.value=t.clearcoatNormalMap,n(t.clearcoatNormalMap,e.clearcoatNormalMapTransform),e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),1===t.side&&e.clearcoatNormalScale.value.negate()));t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap,n(t.iridescenceMap,e.iridescenceMapTransform)),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap,n(t.iridescenceThicknessMap,e.iridescenceThicknessMapTransform)));t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=r.texture,e.transmissionSamplerSize.value.set(r.width,r.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap,n(t.transmissionMap,e.transmissionMapTransform)),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap,n(t.thicknessMap,e.thicknessMapTransform)),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor));e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap,n(t.specularColorMap,e.specularColorMapTransform));t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap,n(t.specularIntensityMap,e.specularIntensityMapTransform))}(e,i,s)):i.isMeshMatcapMaterial?(r(e,i),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,i)):i.isMeshDepthMaterial?r(e,i):i.isMeshDistanceMaterial?(r(e,i),function(e,n){var r=t.get(n).light;e.referencePosition.value.setFromMatrixPosition(r.matrixWorld),e.nearDistance.value=r.shadow.camera.near,e.farDistance.value=r.shadow.camera.far}(e,i)):i.isMeshNormalMaterial?r(e,i):i.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform))}(e,i),i.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,i)):i.isPointsMaterial?function(e,t,r,i){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*r,e.scale.value=.5*i,t.map&&(e.map.value=t.map,n(t.map,e.uvTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap);t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,i,a,o):i.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap);t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,i):i.isShadowMaterial?(e.color.value.copy(i.color),e.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function QE(e,t,n,r){var i={},a={},o=[],s=n.isWebGL2?e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS):0;function u(e,t,n){var r=e.value;if(void 0===n[t]){if("number"===typeof r)n[t]=r;else{for(var i=Array.isArray(r)?r:[r],a=[],o=0;o<i.length;o++)a.push(i[o].clone());n[t]=a}return!0}if("number"===typeof r){if(n[t]!==r)return n[t]=r,!0}else for(var s=Array.isArray(n[t])?n[t]:[n[t]],u=Array.isArray(r)?r:[r],l=0;l<s.length;l++){var c=s[l];if(!1===c.equals(u[l]))return c.copy(u[l]),!0}return!1}function l(e){var t={boundary:0,storage:0};return"number"===typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",e),t}function c(t){var n=t.target;n.removeEventListener("dispose",c);var r=o.indexOf(n.__bindingPointIndex);o.splice(r,1),e.deleteBuffer(i[n.id]),delete i[n.id],delete a[n.id]}return{bind:function(e,t){var n=t.program;r.uniformBlockBinding(e,n)},update:function(n,h){var f=i[n.id];void 0===f&&(!function(e){for(var t=e.uniforms,n=0,r=16,i=0,a=0,o=t.length;a<o;a++){for(var s=t[a],u={boundary:0,storage:0},c=Array.isArray(s.value)?s.value:[s.value],h=0,f=c.length;h<f;h++){var d=l(c[h]);u.boundary+=d.boundary,u.storage+=d.storage}if(s.__data=new Float32Array(u.storage/Float32Array.BYTES_PER_ELEMENT),s.__offset=n,a>0)0!==(i=n%r)&&r-i-u.boundary<0&&(n+=r-i,s.__offset=n);n+=u.storage}(i=n%r)>0&&(n+=r-i);e.__size=n,e.__cache={}}(n),f=function(t){var n=function(){for(var e=0;e<s;e++)if(-1===o.indexOf(e))return o.push(e),e;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=n;var r=e.createBuffer(),i=t.__size,a=t.usage;return e.bindBuffer(e.UNIFORM_BUFFER,r),e.bufferData(e.UNIFORM_BUFFER,i,a),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,n,r),r}(n),i[n.id]=f,n.addEventListener("dispose",c));var d=h.program;r.updateUBOMapping(n,d);var p=t.render.frame;a[n.id]!==p&&(!function(t){var n=i[t.id],r=t.uniforms,a=t.__cache;e.bindBuffer(e.UNIFORM_BUFFER,n);for(var o=0,s=r.length;o<s;o++){var c=r[o];if(!0===u(c,o,a)){for(var h=c.__offset,f=Array.isArray(c.value)?c.value:[c.value],d=0,p=0;p<f.length;p++){var v=f[p],m=l(v);"number"===typeof v?(c.__data[0]=v,e.bufferSubData(e.UNIFORM_BUFFER,h+d,c.__data)):v.isMatrix3?(c.__data[0]=v.elements[0],c.__data[1]=v.elements[1],c.__data[2]=v.elements[2],c.__data[3]=v.elements[0],c.__data[4]=v.elements[3],c.__data[5]=v.elements[4],c.__data[6]=v.elements[5],c.__data[7]=v.elements[0],c.__data[8]=v.elements[6],c.__data[9]=v.elements[7],c.__data[10]=v.elements[8],c.__data[11]=v.elements[0]):(v.toArray(c.__data,d),d+=m.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,h,c.__data)}}e.bindBuffer(e.UNIFORM_BUFFER,null)}(n),a[n.id]=p)},dispose:function(){for(var t in i)e.deleteBuffer(i[t]);o=[],i={},a={}}}}function $E(){var e=Nw("canvas");return e.style.display="block",e}var eC=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,u.Z)(this,e);var n,r=t.canvas,i=void 0===r?$E():r,a=t.context,o=void 0===a?null:a,s=t.depth,l=void 0===s||s,c=t.stencil,h=void 0===c||c,f=t.alpha,d=void 0!==f&&f,p=t.antialias,v=void 0!==p&&p,m=t.premultipliedAlpha,g=void 0===m||m,y=t.preserveDrawingBuffer,b=void 0!==y&&y,_=t.powerPreference,x=void 0===_?"default":_,w=t.failIfMajorPerformanceCaveat,S=void 0!==w&&w;this.isWebGLRenderer=!0,n=null!==o?o.getContextAttributes().alpha:d;var M=null,k=null,T=[],E=[];this.domElement=i,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputColorSpace=uw,this.useLegacyLights=!0,this.toneMapping=0,this.toneMappingExposure=1;var C=this,A=!1,R=0,P=0,L=null,D=-1,N=null,I=new Kw,O=new Kw,U=null,F=i.width,z=i.height,B=1,V=null,G=null,j=new Kw(0,0,F,z),H=new Kw(0,0,F,z),W=!1,Z=new xk,q=!1,X=!1,Y=null,K=new PS,J=new tS,Q={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function $(){return null===L?B:1}var ee,te,ne,re,ie,ae,oe,se,ue,le,ce,he,fe,de,pe,ve,me,ge,ye,be,_e,xe,we,Se,Me=o;function ke(e,t){for(var n=0;n<e.length;n++){var r=e[n],a=i.getContext(r,t);if(null!==a)return a}return null}try{var Te={alpha:!0,depth:l,stencil:h,antialias:v,premultipliedAlpha:g,preserveDrawingBuffer:b,powerPreference:x,failIfMajorPerformanceCaveat:S};if("setAttribute"in i&&i.setAttribute("data-engine","three.js r".concat(tx)),i.addEventListener("webglcontextlost",Re,!1),i.addEventListener("webglcontextrestored",Pe,!1),i.addEventListener("webglcontextcreationerror",Le,!1),null===Me){var Ee=["webgl2","webgl","experimental-webgl"];if(!0===C.isWebGL1Renderer&&Ee.shift(),null===(Me=ke(Ee,Te)))throw ke(Ee)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===Me.getShaderPrecisionFormat&&(Me.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Je){throw console.error("THREE.WebGLRenderer: "+Je.message),Je}function Ce(){ee=new Kk(Me),te=new Lk(Me,ee,t),ee.init(te),xe=new HE(Me,ee,te),ne=new GE(Me,ee,te),re=new $k(Me),ie=new CE,ae=new jE(Me,ee,ne,ie,te,xe,re),oe=new Nk(C),se=new Yk(C),ue=new Sk(Me,te),we=new Rk(Me,ee,ue,te),le=new Jk(Me,ue,re,we),ce=new rT(Me,le,ue,re),ye=new nT(Me,te,ae),ve=new Dk(ie),he=new EE(C,oe,se,ee,te,we,ve),fe=new JE(C,ie),de=new LE,pe=new FE(ee,te),ge=new Ak(C,oe,se,ne,ce,n,g),me=new VE(C,ce,te),Se=new QE(Me,re,te,ne),be=new Pk(Me,ee,re,te),_e=new Qk(Me,ee,re,te),re.programs=he.programs,C.capabilities=te,C.extensions=ee,C.properties=ie,C.renderLists=de,C.shadowMap=me,C.state=ne,C.info=re}Ce();var Ae=new KE(C,Me);function Re(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),A=!0}function Pe(){console.log("THREE.WebGLRenderer: Context Restored."),A=!1;var e=re.autoReset,t=me.enabled,n=me.autoUpdate,r=me.needsUpdate,i=me.type;Ce(),re.autoReset=e,me.enabled=t,me.autoUpdate=n,me.needsUpdate=r,me.type=i}function Le(e){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function De(e){var t=e.target;t.removeEventListener("dispose",De),Ne(t)}function Ne(e){Ie(e),ie.remove(e)}function Ie(e){var t=ie.get(e).programs;void 0!==t&&(t.forEach((function(e){he.releaseProgram(e)})),e.isShaderMaterial&&he.releaseShaderCache(e))}this.xr=Ae,this.getContext=function(){return Me},this.getContextAttributes=function(){return Me.getContextAttributes()},this.forceContextLoss=function(){var e=ee.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=ee.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return B},this.setPixelRatio=function(e){void 0!==e&&(B=e,this.setSize(F,z,!1))},this.getSize=function(e){return e.set(F,z)},this.setSize=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Ae.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(F=e,z=t,i.width=Math.floor(e*B),i.height=Math.floor(t*B),!0===n&&(i.style.width=e+"px",i.style.height=t+"px"),this.setViewport(0,0,e,t))},this.getDrawingBufferSize=function(e){return e.set(F*B,z*B).floor()},this.setDrawingBufferSize=function(e,t,n){F=e,z=t,B=n,i.width=Math.floor(e*n),i.height=Math.floor(t*n),this.setViewport(0,0,e,t)},this.getCurrentViewport=function(e){return e.copy(I)},this.getViewport=function(e){return e.copy(j)},this.setViewport=function(e,t,n,r){e.isVector4?j.set(e.x,e.y,e.z,e.w):j.set(e,t,n,r),ne.viewport(I.copy(j).multiplyScalar(B).floor())},this.getScissor=function(e){return e.copy(H)},this.setScissor=function(e,t,n,r){e.isVector4?H.set(e.x,e.y,e.z,e.w):H.set(e,t,n,r),ne.scissor(O.copy(H).multiplyScalar(B).floor())},this.getScissorTest=function(){return W},this.setScissorTest=function(e){ne.setScissorTest(W=e)},this.setOpaqueSort=function(e){V=e},this.setTransparentSort=function(e){G=e},this.getClearColor=function(e){return e.copy(ge.getClearColor())},this.setClearColor=function(){ge.setClearColor.apply(ge,arguments)},this.getClearAlpha=function(){return ge.getClearAlpha()},this.setClearAlpha=function(){ge.setClearAlpha.apply(ge,arguments)},this.clear=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=0;e&&(r|=Me.COLOR_BUFFER_BIT),t&&(r|=Me.DEPTH_BUFFER_BIT),n&&(r|=Me.STENCIL_BUFFER_BIT),Me.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){i.removeEventListener("webglcontextlost",Re,!1),i.removeEventListener("webglcontextrestored",Pe,!1),i.removeEventListener("webglcontextcreationerror",Le,!1),de.dispose(),pe.dispose(),ie.dispose(),oe.dispose(),se.dispose(),ce.dispose(),we.dispose(),Se.dispose(),he.dispose(),Ae.dispose(),Ae.removeEventListener("sessionstart",Fe),Ae.removeEventListener("sessionend",ze),Y&&(Y.dispose(),Y=null),Be.stop()},this.renderBufferDirect=function(e,t,n,r,i,a){null===t&&(t=Q);var o=i.isMesh&&i.matrixWorld.determinant()<0,s=Xe(e,t,n,r,i);ne.setMaterial(r,o);var u=n.index,l=1;!0===r.wireframe&&(u=le.getWireframeAttribute(n),l=2);var c=n.drawRange,h=n.attributes.position,f=c.start*l,d=(c.start+c.count)*l;null!==a&&(f=Math.max(f,a.start*l),d=Math.min(d,(a.start+a.count)*l)),null!==u?(f=Math.max(f,0),d=Math.min(d,u.count)):void 0!==h&&null!==h&&(f=Math.max(f,0),d=Math.min(d,h.count));var p=d-f;if(!(p<0||p===1/0)){var v;we.setup(i,r,s,n,u);var m=be;if(null!==u&&(v=ue.get(u),(m=_e).setIndex(v)),i.isMesh)!0===r.wireframe?(ne.setLineWidth(r.wireframeLinewidth*$()),m.setMode(Me.LINES)):m.setMode(Me.TRIANGLES);else if(i.isLine){var g=r.linewidth;void 0===g&&(g=1),ne.setLineWidth(g*$()),i.isLineSegments?m.setMode(Me.LINES):i.isLineLoop?m.setMode(Me.LINE_LOOP):m.setMode(Me.LINE_STRIP)}else i.isPoints?m.setMode(Me.POINTS):i.isSprite&&m.setMode(Me.TRIANGLES);if(i.isInstancedMesh)m.renderInstances(f,p,i.count);else if(n.isInstancedBufferGeometry){var y=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,b=Math.min(n.instanceCount,y);m.renderInstances(f,p,b)}else m.render(f,p)}},this.compile=function(e,t){function n(e,t,n){!0===e.transparent&&2===e.side&&!1===e.forceSinglePass?(e.side=1,e.needsUpdate=!0,Ze(e,t,n),e.side=0,e.needsUpdate=!0,Ze(e,t,n),e.side=2):Ze(e,t,n)}(k=pe.get(e)).init(),E.push(k),e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(k.pushLight(e),e.castShadow&&k.pushShadow(e))})),k.setupLights(C.useLegacyLights),e.traverse((function(t){var r=t.material;if(r)if(Array.isArray(r))for(var i=0;i<r.length;i++){n(r[i],e,t)}else n(r,e,t)})),E.pop(),k=null};var Oe=null;function Ue(e){Oe&&Oe(e)}function Fe(){Be.stop()}function ze(){Be.start()}var Be=new wk;function Ve(e,t,n,r){if(!1!==e.visible){if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)k.pushLight(e),e.castShadow&&k.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||Z.intersectsSprite(e)){r&&J.setFromMatrixPosition(e.matrixWorld).applyMatrix4(K);var i=ce.update(e),a=e.material;a.visible&&M.push(e,i,a,n,J.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||Z.intersectsObject(e))){e.isSkinnedMesh&&e.skeleton.frame!==re.render.frame&&(e.skeleton.update(),e.skeleton.frame=re.render.frame);var o=ce.update(e),s=e.material;if(r&&(null===o.boundingSphere&&o.computeBoundingSphere(),J.copy(o.boundingSphere.center).applyMatrix4(e.matrixWorld).applyMatrix4(K)),Array.isArray(s))for(var u=o.groups,l=0,c=u.length;l<c;l++){var h=u[l],f=s[h.materialIndex];f&&f.visible&&M.push(e,o,f,n,J.z,h)}else s.visible&&M.push(e,o,s,n,J.z,null)}for(var d=e.children,p=0,v=d.length;p<v;p++)Ve(d[p],t,n,r)}}function Ge(e,t,n,r){var i=e.opaque,a=e.transmissive,o=e.transparent;k.setupLightsView(n),!0===q&&ve.setGlobalState(C.clippingPlanes,n),a.length>0&&je(i,a,t,n),r&&ne.viewport(I.copy(r)),i.length>0&&He(i,t,n),a.length>0&&He(a,t,n),o.length>0&&He(o,t,n),ne.buffers.depth.setTest(!0),ne.buffers.depth.setMask(!0),ne.buffers.color.setMask(!0),ne.setPolygonOffset(!1)}function je(e,t,n,r){if(null===Y){var i=te.isWebGL2;Y=new Jw(1024,1024,{generateMipmaps:!0,type:ee.has("EXT_color_buffer_half_float")?_x:mx,minFilter:vx,samples:i&&!0===v?4:0})}var a=C.getRenderTarget();C.setRenderTarget(Y),C.clear();var o=C.toneMapping;C.toneMapping=0,He(e,n,r),ae.updateMultisampleRenderTarget(Y),ae.updateRenderTargetMipmap(Y);for(var s=!1,u=0,l=t.length;u<l;u++){var c=t[u],h=c.object,f=c.geometry,d=c.material,p=c.group;if(2===d.side&&h.layers.test(r.layers)){var m=d.side;d.side=1,d.needsUpdate=!0,We(h,n,r,f,d,p),d.side=m,d.needsUpdate=!0,s=!0}}!0===s&&(ae.updateMultisampleRenderTarget(Y),ae.updateRenderTargetMipmap(Y)),C.setRenderTarget(a),C.toneMapping=o}function He(e,t,n){for(var r=!0===t.isScene?t.overrideMaterial:null,i=0,a=e.length;i<a;i++){var o=e[i],s=o.object,u=o.geometry,l=null===r?o.material:r,c=o.group;s.layers.test(n.layers)&&We(s,t,n,u,l,c)}}function We(e,t,n,r,i,a){e.onBeforeRender(C,t,n,r,i,a),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),i.onBeforeRender(C,t,n,r,e,a),!0===i.transparent&&2===i.side&&!1===i.forceSinglePass?(i.side=1,i.needsUpdate=!0,C.renderBufferDirect(n,t,r,i,e,a),i.side=0,i.needsUpdate=!0,C.renderBufferDirect(n,t,r,i,e,a),i.side=2):C.renderBufferDirect(n,t,r,i,e,a),e.onAfterRender(C,t,n,r,i,a)}function Ze(e,t,n){!0!==t.isScene&&(t=Q);var r=ie.get(e),i=k.state.lights,a=k.state.shadowsArray,o=i.state.version,s=he.getParameters(e,i.state,a,t,n),u=he.getProgramCacheKey(s),l=r.programs;r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=(e.isMeshStandardMaterial?se:oe).get(e.envMap||r.environment),void 0===l&&(e.addEventListener("dispose",De),l=new Map,r.programs=l);var c=l.get(u);if(void 0!==c){if(r.currentProgram===c&&r.lightsStateVersion===o)return qe(e,s),c}else s.uniforms=he.getUniforms(e),e.onBuild(n,s,C),e.onBeforeCompile(s,C),c=he.acquireProgram(s,u),l.set(u,c),r.uniforms=s.uniforms;var h=r.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(h.clippingPlanes=ve.uniform),qe(e,s),r.needsLights=Ke(e),r.lightsStateVersion=o,r.needsLights&&(h.ambientLightColor.value=i.state.ambient,h.lightProbe.value=i.state.probe,h.directionalLights.value=i.state.directional,h.directionalLightShadows.value=i.state.directionalShadow,h.spotLights.value=i.state.spot,h.spotLightShadows.value=i.state.spotShadow,h.rectAreaLights.value=i.state.rectArea,h.ltc_1.value=i.state.rectAreaLTC1,h.ltc_2.value=i.state.rectAreaLTC2,h.pointLights.value=i.state.point,h.pointLightShadows.value=i.state.pointShadow,h.hemisphereLights.value=i.state.hemi,h.directionalShadowMap.value=i.state.directionalShadowMap,h.directionalShadowMatrix.value=i.state.directionalShadowMatrix,h.spotShadowMap.value=i.state.spotShadowMap,h.spotLightMatrix.value=i.state.spotLightMatrix,h.spotLightMap.value=i.state.spotLightMap,h.pointShadowMap.value=i.state.pointShadowMap,h.pointShadowMatrix.value=i.state.pointShadowMatrix);var f=c.getUniforms(),d=sE.seqWithValue(f.seq,h);return r.currentProgram=c,r.uniformsList=d,c}function qe(e,t){var n=ie.get(e);n.outputColorSpace=t.outputColorSpace,n.instancing=t.instancing,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphColors=t.morphColors,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents,n.toneMapping=t.toneMapping}function Xe(e,t,n,r,i){!0!==t.isScene&&(t=Q),ae.resetTextureUnits();var a=t.fog,o=r.isMeshStandardMaterial?t.environment:null,s=null===L?C.outputColorSpace:!0===L.isXRRenderTarget?L.texture.colorSpace:lw,u=(r.isMeshStandardMaterial?se:oe).get(r.envMap||o),l=!0===r.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,c=!!r.normalMap&&!!n.attributes.tangent,h=!!n.morphAttributes.position,f=!!n.morphAttributes.normal,d=!!n.morphAttributes.color,p=r.toneMapped?C.toneMapping:0,v=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,m=void 0!==v?v.length:0,g=ie.get(r),y=k.state.lights;if(!0===q&&(!0===X||e!==N)){var b=e===N&&r.id===D;ve.setState(r,e,b)}var _=!1;r.version===g.__version?g.needsLights&&g.lightsStateVersion!==y.state.version||g.outputColorSpace!==s||i.isInstancedMesh&&!1===g.instancing?_=!0:i.isInstancedMesh||!0!==g.instancing?i.isSkinnedMesh&&!1===g.skinning?_=!0:i.isSkinnedMesh||!0!==g.skinning?g.envMap!==u||!0===r.fog&&g.fog!==a?_=!0:void 0===g.numClippingPlanes||g.numClippingPlanes===ve.numPlanes&&g.numIntersection===ve.numIntersection?(g.vertexAlphas!==l||g.vertexTangents!==c||g.morphTargets!==h||g.morphNormals!==f||g.morphColors!==d||g.toneMapping!==p||!0===te.isWebGL2&&g.morphTargetsCount!==m)&&(_=!0):_=!0:_=!0:_=!0:(_=!0,g.__version=r.version);var x=g.currentProgram;!0===_&&(x=Ze(r,t,i));var w=!1,S=!1,M=!1,T=x.getUniforms(),E=g.uniforms;if(ne.useProgram(x.program)&&(w=!0,S=!0,M=!0),r.id!==D&&(D=r.id,S=!0),w||N!==e){if(T.setValue(Me,"projectionMatrix",e.projectionMatrix),te.logarithmicDepthBuffer&&T.setValue(Me,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),N!==e&&(N=e,S=!0,M=!0),r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshStandardMaterial||r.envMap){var A=T.map.cameraPosition;void 0!==A&&A.setValue(Me,J.setFromMatrixPosition(e.matrixWorld))}(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&T.setValue(Me,"isOrthographic",!0===e.isOrthographicCamera),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.isShadowMaterial||i.isSkinnedMesh)&&T.setValue(Me,"viewMatrix",e.matrixWorldInverse)}if(i.isSkinnedMesh){T.setOptional(Me,i,"bindMatrix"),T.setOptional(Me,i,"bindMatrixInverse");var R=i.skeleton;R&&(te.floatVertexTextures?(null===R.boneTexture&&R.computeBoneTexture(),T.setValue(Me,"boneTexture",R.boneTexture,ae),T.setValue(Me,"boneTextureSize",R.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}var P=n.morphAttributes;if((void 0!==P.position||void 0!==P.normal||void 0!==P.color&&!0===te.isWebGL2)&&ye.update(i,n,x),(S||g.receiveShadow!==i.receiveShadow)&&(g.receiveShadow=i.receiveShadow,T.setValue(Me,"receiveShadow",i.receiveShadow)),r.isMeshGouraudMaterial&&null!==r.envMap&&(E.envMap.value=u,E.flipEnvMap.value=u.isCubeTexture&&!1===u.isRenderTargetTexture?-1:1),S&&(T.setValue(Me,"toneMappingExposure",C.toneMappingExposure),g.needsLights&&Ye(E,M),a&&!0===r.fog&&fe.refreshFogUniforms(E,a),fe.refreshMaterialUniforms(E,r,B,z,Y),sE.upload(Me,g.uniformsList,E,ae)),r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(sE.upload(Me,g.uniformsList,E,ae),r.uniformsNeedUpdate=!1),r.isSpriteMaterial&&T.setValue(Me,"center",i.center),T.setValue(Me,"modelViewMatrix",i.modelViewMatrix),T.setValue(Me,"normalMatrix",i.normalMatrix),T.setValue(Me,"modelMatrix",i.matrixWorld),r.isShaderMaterial||r.isRawShaderMaterial)for(var I=r.uniformsGroups,O=0,U=I.length;O<U;O++)if(te.isWebGL2){var F=I[O];Se.update(F,x),Se.bind(F,x)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.");return x}function Ye(e,t){e.ambientLightColor.needsUpdate=t,e.lightProbe.needsUpdate=t,e.directionalLights.needsUpdate=t,e.directionalLightShadows.needsUpdate=t,e.pointLights.needsUpdate=t,e.pointLightShadows.needsUpdate=t,e.spotLights.needsUpdate=t,e.spotLightShadows.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}function Ke(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}Be.setAnimationLoop(Ue),"undefined"!==typeof self&&Be.setContext(self),this.setAnimationLoop=function(e){Oe=e,Ae.setAnimationLoop(e),null===e?Be.stop():Be.start()},Ae.addEventListener("sessionstart",Fe),Ae.addEventListener("sessionend",ze),this.render=function(e,t){if(void 0===t||!0===t.isCamera){if(!0!==A){!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===Ae.enabled&&!0===Ae.isPresenting&&(!0===Ae.cameraAutoUpdate&&Ae.updateCamera(t),t=Ae.getCamera()),!0===e.isScene&&e.onBeforeRender(C,e,t,L),(k=pe.get(e,E.length)).init(),E.push(k),K.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),Z.setFromProjectionMatrix(K),X=this.localClippingEnabled,q=ve.init(this.clippingPlanes,X),(M=de.get(e,T.length)).init(),T.push(M),Ve(e,t,0,C.sortObjects),M.finish(),!0===C.sortObjects&&M.sort(V,G),!0===q&&ve.beginShadows();var n=k.state.shadowsArray;if(me.render(n,e,t),!0===q&&ve.endShadows(),!0===this.info.autoReset&&this.info.reset(),ge.render(M,e),k.setupLights(C.useLegacyLights),t.isArrayCamera)for(var r=t.cameras,i=0,a=r.length;i<a;i++){var o=r[i];Ge(M,e,o,o.viewport)}else Ge(M,e,t);null!==L&&(ae.updateMultisampleRenderTarget(L),ae.updateRenderTargetMipmap(L)),!0===e.isScene&&e.onAfterRender(C,e,t),we.resetDefaultState(),D=-1,N=null,E.pop(),k=E.length>0?E[E.length-1]:null,T.pop(),M=T.length>0?T[T.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return R},this.getActiveMipmapLevel=function(){return P},this.getRenderTarget=function(){return L},this.setRenderTargetTextures=function(e,t,n){ie.get(e.texture).__webglTexture=t,ie.get(e.depthTexture).__webglTexture=n;var r=ie.get(e);r.__hasExternalTextures=!0,r.__hasExternalTextures&&(r.__autoAllocateDepthBuffer=void 0===n,r.__autoAllocateDepthBuffer||!0===ee.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),r.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(e,t){var n=ie.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=void 0===t},this.setRenderTarget=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;L=e,R=t,P=n;var r=!0,i=null,a=!1,o=!1;if(e){var s=ie.get(e);void 0!==s.__useDefaultFramebuffer?(ne.bindFramebuffer(Me.FRAMEBUFFER,null),r=!1):void 0===s.__webglFramebuffer?ae.setupRenderTarget(e):s.__hasExternalTextures&&ae.rebindTextures(e,ie.get(e.texture).__webglTexture,ie.get(e.depthTexture).__webglTexture);var u=e.texture;(u.isData3DTexture||u.isDataArrayTexture||u.isCompressedArrayTexture)&&(o=!0);var l=ie.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(i=l[t],a=!0):i=te.isWebGL2&&e.samples>0&&!1===ae.useMultisampledRTT(e)?ie.get(e).__webglMultisampledFramebuffer:l,I.copy(e.viewport),O.copy(e.scissor),U=e.scissorTest}else I.copy(j).multiplyScalar(B).floor(),O.copy(H).multiplyScalar(B).floor(),U=W;var c=ne.bindFramebuffer(Me.FRAMEBUFFER,i);if(c&&te.drawBuffers&&r&&ne.drawBuffers(e,i),ne.viewport(I),ne.scissor(O),ne.setScissorTest(U),a){var h=ie.get(e.texture);Me.framebufferTexture2D(Me.FRAMEBUFFER,Me.COLOR_ATTACHMENT0,Me.TEXTURE_CUBE_MAP_POSITIVE_X+t,h.__webglTexture,n)}else if(o){var f=ie.get(e.texture),d=t||0;Me.framebufferTextureLayer(Me.FRAMEBUFFER,Me.COLOR_ATTACHMENT0,f.__webglTexture,n||0,d)}D=-1},this.readRenderTargetPixels=function(e,t,n,r,i,a,o){if(e&&e.isWebGLRenderTarget){var s=ie.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(s=s[o]),s){ne.bindFramebuffer(Me.FRAMEBUFFER,s);try{var u=e.texture,l=u.format,c=u.type;if(l!==wx&&xe.convert(l)!==Me.getParameter(Me.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");var h=c===_x&&(ee.has("EXT_color_buffer_half_float")||te.isWebGL2&&ee.has("EXT_color_buffer_float"));if(c!==mx&&xe.convert(c)!==Me.getParameter(Me.IMPLEMENTATION_COLOR_READ_TYPE)&&(c!==bx||!(te.isWebGL2||ee.has("OES_texture_float")||ee.has("WEBGL_color_buffer_float")))&&!h)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&Me.readPixels(t,n,r,i,xe.convert(l),xe.convert(c),a)}finally{var f=null!==L?ie.get(L).__webglFramebuffer:null;ne.bindFramebuffer(Me.FRAMEBUFFER,f)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Math.pow(2,-n),i=Math.floor(t.image.width*r),a=Math.floor(t.image.height*r);ae.setTexture2D(t,0),Me.copyTexSubImage2D(Me.TEXTURE_2D,n,0,0,e.x,e.y,i,a),ne.unbindTexture()},this.copyTextureToTexture=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=t.image.width,a=t.image.height,o=xe.convert(n.format),s=xe.convert(n.type);ae.setTexture2D(n,0),Me.pixelStorei(Me.UNPACK_FLIP_Y_WEBGL,n.flipY),Me.pixelStorei(Me.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),Me.pixelStorei(Me.UNPACK_ALIGNMENT,n.unpackAlignment),t.isDataTexture?Me.texSubImage2D(Me.TEXTURE_2D,r,e.x,e.y,i,a,o,s,t.image.data):t.isCompressedTexture?Me.compressedTexSubImage2D(Me.TEXTURE_2D,r,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,o,t.mipmaps[0].data):Me.texSubImage2D(Me.TEXTURE_2D,r,e.x,e.y,o,s,t.image),0===r&&n.generateMipmaps&&Me.generateMipmap(Me.TEXTURE_2D),ne.unbindTexture()},this.copyTextureToTexture3D=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(C.isWebGL1Renderer)console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");else{var a,o=e.max.x-e.min.x+1,s=e.max.y-e.min.y+1,u=e.max.z-e.min.z+1,l=xe.convert(r.format),c=xe.convert(r.type);if(r.isData3DTexture)ae.setTexture3D(r,0),a=Me.TEXTURE_3D;else{if(!r.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");ae.setTexture2DArray(r,0),a=Me.TEXTURE_2D_ARRAY}Me.pixelStorei(Me.UNPACK_FLIP_Y_WEBGL,r.flipY),Me.pixelStorei(Me.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultiplyAlpha),Me.pixelStorei(Me.UNPACK_ALIGNMENT,r.unpackAlignment);var h=Me.getParameter(Me.UNPACK_ROW_LENGTH),f=Me.getParameter(Me.UNPACK_IMAGE_HEIGHT),d=Me.getParameter(Me.UNPACK_SKIP_PIXELS),p=Me.getParameter(Me.UNPACK_SKIP_ROWS),v=Me.getParameter(Me.UNPACK_SKIP_IMAGES),m=n.isCompressedTexture?n.mipmaps[0]:n.image;Me.pixelStorei(Me.UNPACK_ROW_LENGTH,m.width),Me.pixelStorei(Me.UNPACK_IMAGE_HEIGHT,m.height),Me.pixelStorei(Me.UNPACK_SKIP_PIXELS,e.min.x),Me.pixelStorei(Me.UNPACK_SKIP_ROWS,e.min.y),Me.pixelStorei(Me.UNPACK_SKIP_IMAGES,e.min.z),n.isDataTexture||n.isData3DTexture?Me.texSubImage3D(a,i,t.x,t.y,t.z,o,s,u,l,c,m.data):n.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Me.compressedTexSubImage3D(a,i,t.x,t.y,t.z,o,s,u,l,m.data)):Me.texSubImage3D(a,i,t.x,t.y,t.z,o,s,u,l,c,m),Me.pixelStorei(Me.UNPACK_ROW_LENGTH,h),Me.pixelStorei(Me.UNPACK_IMAGE_HEIGHT,f),Me.pixelStorei(Me.UNPACK_SKIP_PIXELS,d),Me.pixelStorei(Me.UNPACK_SKIP_ROWS,p),Me.pixelStorei(Me.UNPACK_SKIP_IMAGES,v),0===i&&r.generateMipmaps&&Me.generateMipmap(a),ne.unbindTexture()}},this.initTexture=function(e){e.isCubeTexture?ae.setTextureCube(e,0):e.isData3DTexture?ae.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?ae.setTexture2DArray(e,0):ae.setTexture2D(e,0),ne.unbindTexture()},this.resetState=function(){R=0,P=0,L=null,ne.reset(),we.reset()},"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}return(0,l.Z)(e,[{key:"physicallyCorrectLights",get:function(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights},set:function(e){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}},{key:"outputEncoding",get:function(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===uw?ow:3e3},set:function(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===ow?uw:lw}}]),e}(),tC=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n)}(eC);tC.prototype.isWebGL1Renderer=!0;var nC=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.call(this)).isScene=!0,e.type="Scene",e.background=null,e.environment=null,e.fog=null,e.backgroundBlurriness=0,e.backgroundIntensity=1,e.overrideMaterial=null,"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:(0,c.Z)(e)})),e}return(0,l.Z)(n,[{key:"copy",value:function(e,t){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}},{key:"toJSON",value:function(e){var t=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this,e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}},{key:"autoUpdate",get:function(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate},set:function(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}]),n}(nM);var rC=new tS,iC=new Kw,aC=new Kw,oC=new tS,sC=new PS,uC=new tS,lC=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r){var i;return(0,u.Z)(this,n),(i=t.call(this,e,r)).isSkinnedMesh=!0,i.type="SkinnedMesh",i.bindMode="attached",i.bindMatrix=new PS,i.bindMatrixInverse=new PS,i.boundingBox=null,i.boundingSphere=null,i}return(0,l.Z)(n,[{key:"computeBoundingBox",value:function(){var e=this.geometry;null===this.boundingBox&&(this.boundingBox=new iS),this.boundingBox.makeEmpty();for(var t=e.getAttribute("position"),n=0;n<t.count;n++)uC.fromBufferAttribute(t,n),this.applyBoneTransform(n,uC),this.boundingBox.expandByPoint(uC)}},{key:"computeBoundingSphere",value:function(){var e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new wS),this.boundingSphere.makeEmpty();for(var t=e.getAttribute("position"),n=0;n<t.count;n++)uC.fromBufferAttribute(t,n),this.applyBoneTransform(n,uC),this.boundingSphere.expandByPoint(uC)}},{key:"copy",value:function(e,t){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}},{key:"getVertexPosition",value:function(e,t){return wr((0,_r.Z)(n.prototype),"getVertexPosition",this).call(this,e,t),this.applyBoneTransform(e,t),t}},{key:"bind",value:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}},{key:"pose",value:function(){this.skeleton.pose()}},{key:"normalizeSkinWeights",value:function(){for(var e=new Kw,t=this.geometry.attributes.skinWeight,n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);var i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}},{key:"updateMatrixWorld",value:function(e){wr((0,_r.Z)(n.prototype),"updateMatrixWorld",this).call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}},{key:"applyBoneTransform",value:function(e,t){var n=this.skeleton,r=this.geometry;iC.fromBufferAttribute(r.attributes.skinIndex,e),aC.fromBufferAttribute(r.attributes.skinWeight,e),rC.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(var i=0;i<4;i++){var a=aC.getComponent(i);if(0!==a){var o=iC.getComponent(i);sC.multiplyMatrices(n.bones[o].matrixWorld,n.boneInverses[o]),t.addScaledVector(oC.copy(rC).applyMatrix4(sC),a)}}return t.applyMatrix4(this.bindMatrixInverse)}},{key:"boneTransform",value:function(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}]),n}(tk),cC=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.call(this)).isBone=!0,e.type="Bone",e}return(0,l.Z)(n)}(nM),hC=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,l=arguments.length>5?arguments[5]:void 0,c=arguments.length>6?arguments[6]:void 0,h=arguments.length>7?arguments[7]:void 0,f=arguments.length>8&&void 0!==arguments[8]?arguments[8]:hx,d=arguments.length>9&&void 0!==arguments[9]?arguments[9]:hx,p=arguments.length>10?arguments[10]:void 0,v=arguments.length>11?arguments[11]:void 0;return(0,u.Z)(this,n),(e=t.call(this,null,l,c,h,f,d,o,s,p,v)).isDataTexture=!0,e.image={data:r,width:i,height:a},e.generateMipmaps=!1,e.flipY=!1,e.unpackAlignment=1,e}return(0,l.Z)(n)}(Yw),fC=new PS,dC=new PS,pC=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];(0,u.Z)(this,e),this.uuid=_w(),this.bones=t.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}return(0,l.Z)(e,[{key:"init",value:function(){var e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new PS)}}},{key:"calculateInverses",value:function(){this.boneInverses.length=0;for(var e=0,t=this.bones.length;e<t;e++){var n=new PS;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}},{key:"pose",value:function(){for(var e=0,t=this.bones.length;e<t;e++){var n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(var r=0,i=this.bones.length;r<i;r++){var a=this.bones[r];a&&(a.parent&&a.parent.isBone?(a.matrix.copy(a.parent.matrixWorld).invert(),a.matrix.multiply(a.matrixWorld)):a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale))}}},{key:"update",value:function(){for(var e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,a=e.length;i<a;i++){var o=e[i]?e[i].matrixWorld:dC;fC.multiplyMatrices(o,t[i]),fC.toArray(n,16*i)}null!==r&&(r.needsUpdate=!0)}},{key:"clone",value:function(){return new e(this.bones,this.boneInverses)}},{key:"computeBoneTexture",value:function(){var e=Math.sqrt(4*this.bones.length);e=kw(e),e=Math.max(e,4);var t=new Float32Array(e*e*4);t.set(this.boneMatrices);var n=new hC(t,e,e,wx,bx);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}},{key:"getBoneByName",value:function(e){for(var t=0,n=this.bones.length;t<n;t++){var r=this.bones[t];if(r.name===e)return r}}},{key:"dispose",value:function(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}},{key:"fromJSON",value:function(e,t){this.uuid=e.uuid;for(var n=0,r=e.bones.length;n<r;n++){var i=e.bones[n],a=t[i];void 0===a&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),a=new cC),this.bones.push(a),this.boneInverses.push((new PS).fromArray(e.boneInverses[n]))}return this.init(),this}},{key:"toJSON",value:function(){var e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;for(var t=this.bones,n=this.boneInverses,r=0,i=t.length;r<i;r++){var a=t[r];e.bones.push(a.uuid);var o=n[r];e.boneInverses.push(o.toArray())}return e}}]),e}(),vC=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).isLineBasicMaterial=!0,r.type="LineBasicMaterial",r.color=new xM(16777215),r.map=null,r.linewidth=1,r.linecap="round",r.linejoin="round",r.fog=!0,r.setValues(e),r}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}]),n}(mM),mC=new tS,gC=new tS,yC=new PS,bC=new RS,_C=new wS,xC=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new UM,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new vC;return(0,u.Z)(this,n),(e=t.call(this)).isLine=!0,e.type="Line",e.geometry=r,e.material=i,e.updateMorphTargets(),e}return(0,l.Z)(n,[{key:"copy",value:function(e,t){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e,t),this.material=e.material,this.geometry=e.geometry,this}},{key:"computeLineDistances",value:function(){var e=this.geometry;if(null===e.index){for(var t=e.attributes.position,n=[0],r=1,i=t.count;r<i;r++)mC.fromBufferAttribute(t,r-1),gC.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=mC.distanceTo(gC);e.setAttribute("lineDistance",new AM(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},{key:"raycast",value:function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),_C.copy(n.boundingSphere),_C.applyMatrix4(r),_C.radius+=i,!1!==e.ray.intersectsSphere(_C)){yC.copy(r).invert(),bC.copy(e.ray).applyMatrix4(yC);var o=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,u=new tS,l=new tS,c=new tS,h=new tS,f=this.isLineSegments?2:1,d=n.index,p=n.attributes.position;if(null!==d)for(var v=Math.max(0,a.start),m=Math.min(d.count,a.start+a.count)-1;v<m;v+=f){var g=d.getX(v),y=d.getX(v+1);if(u.fromBufferAttribute(p,g),l.fromBufferAttribute(p,y),!(bC.distanceSqToSegment(u,l,h,c)>s)){h.applyMatrix4(this.matrixWorld);var b=e.ray.origin.distanceTo(h);b<e.near||b>e.far||t.push({distance:b,point:c.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}else for(var _=Math.max(0,a.start),x=Math.min(p.count,a.start+a.count)-1;_<x;_+=f){if(u.fromBufferAttribute(p,_),l.fromBufferAttribute(p,_+1),!(bC.distanceSqToSegment(u,l,h,c)>s)){h.applyMatrix4(this.matrixWorld);var w=e.ray.origin.distanceTo(h);w<e.near||w>e.far||t.push({distance:w,point:c.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}}}},{key:"updateMorphTargets",value:function(){var e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){var n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var r=0,i=n.length;r<i;r++){var a=n[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}}]),n}(nM),wC=new tS,SC=new tS,MC=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r){var i;return(0,u.Z)(this,n),(i=t.call(this,e,r)).isLineSegments=!0,i.type="LineSegments",i}return(0,l.Z)(n,[{key:"computeLineDistances",value:function(){var e=this.geometry;if(null===e.index){for(var t=e.attributes.position,n=[],r=0,i=t.count;r<i;r+=2)wC.fromBufferAttribute(t,r),SC.fromBufferAttribute(t,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+wC.distanceTo(SC);e.setAttribute("lineDistance",new AM(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}]),n}(xC);var kC=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,l=arguments.length>5&&void 0!==arguments[5]&&arguments[5],h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,f=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2*Math.PI;(0,u.Z)(this,n),(e=t.call(this)).type="CylinderGeometry",e.parameters={radiusTop:r,radiusBottom:i,height:a,radialSegments:o,heightSegments:s,openEnded:l,thetaStart:h,thetaLength:f};var d=(0,c.Z)(e);o=Math.floor(o),s=Math.floor(s);var p=[],v=[],m=[],g=[],y=0,b=[],_=a/2,x=0;function w(){for(var e=new tS,t=new tS,n=0,u=(i-r)/a,l=0;l<=s;l++){for(var c=[],w=l/s,S=w*(i-r)+r,M=0;M<=o;M++){var k=M/o,T=k*f+h,E=Math.sin(T),C=Math.cos(T);t.x=S*E,t.y=-w*a+_,t.z=S*C,v.push(t.x,t.y,t.z),e.set(E,u,C).normalize(),m.push(e.x,e.y,e.z),g.push(k,1-w),c.push(y++)}b.push(c)}for(var A=0;A<o;A++)for(var R=0;R<s;R++){var P=b[R][A],L=b[R+1][A],D=b[R+1][A+1],N=b[R][A+1];p.push(P,L,N),p.push(L,D,N),n+=6}d.addGroup(x,n,0),x+=n}function S(e){for(var t=y,n=new Rw,a=new tS,s=0,u=!0===e?r:i,l=!0===e?1:-1,c=1;c<=o;c++)v.push(0,_*l,0),m.push(0,l,0),g.push(.5,.5),y++;for(var b=y,w=0;w<=o;w++){var S=w/o*f+h,M=Math.cos(S),k=Math.sin(S);a.x=u*k,a.y=_*l,a.z=u*M,v.push(a.x,a.y,a.z),m.push(0,l,0),n.x=.5*M+.5,n.y=.5*k*l+.5,g.push(n.x,n.y),y++}for(var T=0;T<o;T++){var E=t+T,C=b+T;!0===e?p.push(C,C+1,E):p.push(C+1,C,E),s+=3}d.addGroup(x,s,!0===e?1:2),x+=s}return w(),!1===l&&(r>0&&S(!0),i>0&&S(!1)),e.setIndex(p),e.setAttribute("position",new AM(v,3)),e.setAttribute("normal",new AM(m,3)),e.setAttribute("uv",new AM(g,2)),e}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new n(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}]),n}(UM);var TC=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;(0,u.Z)(this,n),(e=t.call(this)).type="SphereGeometry",e.parameters={radius:r,widthSegments:i,heightSegments:a,phiStart:o,phiLength:s,thetaStart:l,thetaLength:c},i=Math.max(3,Math.floor(i)),a=Math.max(2,Math.floor(a));for(var h=Math.min(l+c,Math.PI),f=0,d=[],p=new tS,v=new tS,m=[],g=[],y=[],b=[],_=0;_<=a;_++){var x=[],w=_/a,S=0;0===_&&0===l?S=.5/i:_===a&&h===Math.PI&&(S=-.5/i);for(var M=0;M<=i;M++){var k=M/i;p.x=-r*Math.cos(o+k*s)*Math.sin(l+w*c),p.y=r*Math.cos(l+w*c),p.z=r*Math.sin(o+k*s)*Math.sin(l+w*c),g.push(p.x,p.y,p.z),v.copy(p).normalize(),y.push(v.x,v.y,v.z),b.push(k+S,1-w),x.push(f++)}d.push(x)}for(var T=0;T<a;T++)for(var E=0;E<i;E++){var C=d[T][E+1],A=d[T][E],R=d[T+1][E],P=d[T+1][E+1];(0!==T||l>0)&&m.push(C,A,P),(T!==a-1||h<Math.PI)&&m.push(A,R,P)}return e.setIndex(m),e.setAttribute("position",new AM(g,3)),e.setAttribute("normal",new AM(y,3)),e.setAttribute("uv",new AM(b,2)),e}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new n(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}]),n}(UM);var EC=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).isMeshPhongMaterial=!0,r.type="MeshPhongMaterial",r.color=new xM(16777215),r.specular=new xM(1118481),r.shininess=30,r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new xM(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=0,r.normalScale=new Rw(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=0,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.flatShading=!1,r.fog=!0,r.setValues(e),r}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}]),n}(mM),CC=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).isMeshLambertMaterial=!0,r.type="MeshLambertMaterial",r.color=new xM(16777215),r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new xM(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=0,r.normalScale=new Rw(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=0,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.flatShading=!1,r.fog=!0,r.setValues(e),r}return(0,l.Z)(n,[{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}]),n}(mM);function AC(e,t,n){return PC(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)}function RC(e,t,n){return!e||!n&&e.constructor===t?e:"number"===typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)}function PC(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function LC(e){for(var t=e.length,n=new Array(t),r=0;r!==t;++r)n[r]=r;return n.sort((function(t,n){return e[t]-e[n]})),n}function DC(e,t,n){for(var r=e.length,i=new e.constructor(r),a=0,o=0;o!==r;++a)for(var s=n[a]*t,u=0;u!==t;++u)i[o++]=e[s+u];return i}function NC(e,t,n,r){for(var i=1,a=e[0];void 0!==a&&void 0===a[r];)a=e[i++];if(void 0!==a){var o=a[r];if(void 0!==o)if(Array.isArray(o))do{void 0!==(o=a[r])&&(t.push(a.time),n.push.apply(n,o)),a=e[i++]}while(void 0!==a);else if(void 0!==o.toArray)do{void 0!==(o=a[r])&&(t.push(a.time),o.toArray(n,n.length)),a=e[i++]}while(void 0!==a);else do{void 0!==(o=a[r])&&(t.push(a.time),n.push(o)),a=e[i++]}while(void 0!==a)}}var IC=function(){function e(t,n,r,i){(0,u.Z)(this,e),this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new n.constructor(r),this.sampleValues=n,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}return(0,l.Z)(e,[{key:"evaluate",value:function(e){var t=this.parameterPositions,n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{var a;n:{r:if(!(e<r)){for(var o=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===o)break;if(i=r,e<(r=t[++n]))break t}a=t.length;break n}if(e>=i)break e;var s=t[1];e<s&&(n=2,i=s);for(var u=n-2;;){if(void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(n===u)break;if(r=i,e>=(i=t[--n-1]))break t}a=n,n=0}for(;n<a;){var l=n+a>>>1;e<t[l]?a=l:n=l+1}if(r=t[n],void 0===(i=t[n-1]))return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)}},{key:"getSettings_",value:function(){return this.settings||this.DefaultSettings_}},{key:"copySampleValue_",value:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r,a=0;a!==r;++a)t[a]=n[i+a];return t}},{key:"interpolate_",value:function(){throw new Error("call to abstract method")}},{key:"intervalChanged_",value:function(){}}]),e}(),OC=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i,a){var o;return(0,u.Z)(this,n),(o=t.call(this,e,r,i,a))._weightPrev=-0,o._offsetPrev=-0,o._weightNext=-0,o._offsetNext=-0,o.DefaultSettings_={endingStart:nw,endingEnd:nw},o}return(0,l.Z)(n,[{key:"intervalChanged_",value:function(e,t,n){var r=this.parameterPositions,i=e-2,a=e+1,o=r[i],s=r[a];if(void 0===o)switch(this.getSettings_().endingStart){case rw:i=e,o=2*t-n;break;case iw:o=t+r[i=r.length-2]-r[i+1];break;default:i=e,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case rw:a=e,s=2*n-t;break;case iw:a=1,s=n+r[1]-r[0];break;default:a=e-1,s=t}var u=.5*(n-t),l=this.valueSize;this._weightPrev=u/(t-o),this._weightNext=u/(s-n),this._offsetPrev=i*l,this._offsetNext=a*l}},{key:"interpolate_",value:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,u=s-o,l=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,f=this._weightNext,d=(n-t)/(r-t),p=d*d,v=p*d,m=-h*v+2*h*p-h*d,g=(1+h)*v+(-1.5-2*h)*p+(-.5+h)*d+1,y=(-1-f)*v+(1.5+f)*p+.5*d,b=f*v-f*p,_=0;_!==o;++_)i[_]=m*a[l+_]+g*a[u+_]+y*a[s+_]+b*a[c+_];return i}}]),n}(IC),UC=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i,a){return(0,u.Z)(this,n),t.call(this,e,r,i,a)}return(0,l.Z)(n,[{key:"interpolate_",value:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,u=s-o,l=(n-t)/(r-t),c=1-l,h=0;h!==o;++h)i[h]=a[u+h]*c+a[s+h]*l;return i}}]),n}(IC),FC=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i,a){return(0,u.Z)(this,n),t.call(this,e,r,i,a)}return(0,l.Z)(n,[{key:"interpolate_",value:function(e){return this.copySampleValue_(e-1)}}]),n}(IC),zC=function(){function e(t,n,r,i){if((0,u.Z)(this,e),void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===n||0===n.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=RC(n,this.TimeBufferType),this.values=RC(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}return(0,l.Z)(e,[{key:"InterpolantFactoryMethodDiscrete",value:function(e){return new FC(this.times,this.values,this.getValueSize(),e)}},{key:"InterpolantFactoryMethodLinear",value:function(e){return new UC(this.times,this.values,this.getValueSize(),e)}},{key:"InterpolantFactoryMethodSmooth",value:function(e){return new OC(this.times,this.values,this.getValueSize(),e)}},{key:"setInterpolation",value:function(e){var t;switch(e){case $x:t=this.InterpolantFactoryMethodDiscrete;break;case ew:t=this.InterpolantFactoryMethodLinear;break;case tw:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}},{key:"getInterpolation",value:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return $x;case this.InterpolantFactoryMethodLinear:return ew;case this.InterpolantFactoryMethodSmooth:return tw}}},{key:"getValueSize",value:function(){return this.values.length/this.times.length}},{key:"shift",value:function(e){if(0!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]+=e;return this}},{key:"scale",value:function(e){if(1!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]*=e;return this}},{key:"trim",value:function(e,t){for(var n=this.times,r=n.length,i=0,a=r-1;i!==r&&n[i]<e;)++i;for(;-1!==a&&n[a]>t;)--a;if(++a,0!==i||a!==r){i>=a&&(i=(a=Math.max(a,1))-1);var o=this.getValueSize();this.times=AC(n,i,a),this.values=AC(this.values,i*o,a*o)}return this}},{key:"validate",value:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var a=null,o=0;o!==i;o++){var s=n[o];if("number"===typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),e=!1;break}if(null!==a&&a>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),e=!1;break}a=s}if(void 0!==r&&PC(r))for(var u=0,l=r.length;u!==l;++u){var c=r[u];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,u,c),e=!1;break}}return e}},{key:"optimize",value:function(){for(var e=AC(this.times),t=AC(this.values),n=this.getValueSize(),r=this.getInterpolation()===tw,i=e.length-1,a=1,o=1;o<i;++o){var s=!1,u=e[o];if(u!==e[o+1]&&(1!==o||u!==e[0]))if(r)s=!0;else for(var l=o*n,c=l-n,h=l+n,f=0;f!==n;++f){var d=t[l+f];if(d!==t[c+f]||d!==t[h+f]){s=!0;break}}if(s){if(o!==a){e[a]=e[o];for(var p=o*n,v=a*n,m=0;m!==n;++m)t[v+m]=t[p+m]}++a}}if(i>0){e[a]=e[i];for(var g=i*n,y=a*n,b=0;b!==n;++b)t[y+b]=t[g+b];++a}return a!==e.length?(this.times=AC(e,0,a),this.values=AC(t,0,a*n)):(this.times=e,this.values=t),this}},{key:"clone",value:function(){var e=AC(this.times,0),t=AC(this.values,0),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}],[{key:"toJSON",value:function(e){var t,n=e.constructor;if(n.toJSON!==this.toJSON)t=n.toJSON(e);else{t={name:e.name,times:RC(e.times,Array),values:RC(e.values,Array)};var r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t}}]),e}();zC.prototype.TimeBufferType=Float32Array,zC.prototype.ValueBufferType=Float32Array,zC.prototype.DefaultInterpolation=ew;var BC=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n)}(zC);BC.prototype.ValueTypeName="bool",BC.prototype.ValueBufferType=Array,BC.prototype.DefaultInterpolation=$x,BC.prototype.InterpolantFactoryMethodLinear=void 0,BC.prototype.InterpolantFactoryMethodSmooth=void 0;var VC=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n)}(zC);VC.prototype.ValueTypeName="color";var GC=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n)}(zC);GC.prototype.ValueTypeName="number";var jC=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r,i,a){return(0,u.Z)(this,n),t.call(this,e,r,i,a)}return(0,l.Z)(n,[{key:"interpolate_",value:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(n-t)/(r-t),u=e*o,l=u+o;u!==l;u+=4)eS.slerpFlat(i,0,a,u-o,a,u,s);return i}}]),n}(IC),HC=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n,[{key:"InterpolantFactoryMethodLinear",value:function(e){return new jC(this.times,this.values,this.getValueSize(),e)}}]),n}(zC);HC.prototype.ValueTypeName="quaternion",HC.prototype.DefaultInterpolation=ew,HC.prototype.InterpolantFactoryMethodSmooth=void 0;var WC=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n)}(zC);WC.prototype.ValueTypeName="string",WC.prototype.ValueBufferType=Array,WC.prototype.DefaultInterpolation=$x,WC.prototype.InterpolantFactoryMethodLinear=void 0,WC.prototype.InterpolantFactoryMethodSmooth=void 0;var ZC=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n)}(zC);ZC.prototype.ValueTypeName="vector";var qC=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:aw;(0,u.Z)(this,e),this.name=t,this.tracks=r,this.duration=n,this.blendMode=i,this.uuid=_w(),this.duration<0&&this.resetDuration()}return(0,l.Z)(e,[{key:"resetDuration",value:function(){for(var e=0,t=0,n=this.tracks.length;t!==n;++t){var r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this}},{key:"trim",value:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}},{key:"validate",value:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}},{key:"optimize",value:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}},{key:"clone",value:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}},{key:"toJSON",value:function(){return this.constructor.toJSON(this)}}],[{key:"parse",value:function(e){for(var t=[],n=e.tracks,r=1/(e.fps||1),i=0,a=n.length;i!==a;++i)t.push(XC(n[i]).scale(r));var o=new this(e.name,e.duration,t,e.blendMode);return o.uuid=e.uuid,o}},{key:"toJSON",value:function(e){for(var t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode},i=0,a=n.length;i!==a;++i)t.push(zC.toJSON(n[i]));return r}},{key:"CreateFromMorphTargetSequence",value:function(e,t,n,r){for(var i=t.length,a=[],o=0;o<i;o++){var s=[],u=[];s.push((o+i-1)%i,o,(o+1)%i),u.push(0,1,0);var l=LC(s);s=DC(s,1,l),u=DC(u,1,l),r||0!==s[0]||(s.push(i),u.push(u[0])),a.push(new GC(".morphTargetInfluences["+t[o].name+"]",s,u).scale(1/n))}return new this(e,-1,a)}},{key:"findByName",value:function(e,t){var n=e;if(!Array.isArray(e)){var r=e;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null}},{key:"CreateClipsFromMorphTargetSequences",value:function(e,t,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,a=0,o=e.length;a<o;a++){var s=e[a],u=s.name.match(i);if(u&&u.length>1){var l=u[1],c=r[l];c||(r[l]=c=[]),c.push(s)}}var h=[];for(var f in r)h.push(this.CreateFromMorphTargetSequence(f,r[f],t,n));return h}},{key:"parseAnimation",value:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(e,t,n,r,i){if(0!==n.length){var a=[],o=[];NC(n,a,o,r),0!==a.length&&i.push(new e(t,a,o))}},r=[],i=e.name||"default",a=e.fps||30,o=e.blendMode,s=e.length||-1,u=e.hierarchy||[],l=0;l<u.length;l++){var c=u[l].keys;if(c&&0!==c.length)if(c[0].morphTargets){var h={},f=void 0;for(f=0;f<c.length;f++)if(c[f].morphTargets)for(var d=0;d<c[f].morphTargets.length;d++)h[c[f].morphTargets[d]]=-1;for(var p in h){for(var v=[],m=[],g=0;g!==c[f].morphTargets.length;++g){var y=c[f];v.push(y.time),m.push(y.morphTarget===p?1:0)}r.push(new GC(".morphTargetInfluence["+p+"]",v,m))}s=h.length*a}else{var b=".bones["+t[l].name+"]";n(ZC,b+".position",c,"pos",r),n(HC,b+".quaternion",c,"rot",r),n(ZC,b+".scale",c,"scl",r)}}return 0===r.length?null:new this(i,s,r,o)}}]),e}();function XC(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return GC;case"vector":case"vector2":case"vector3":case"vector4":return ZC;case"color":return VC;case"quaternion":return HC;case"bool":case"boolean":return BC;case"string":return WC}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){var n=[],r=[];NC(e.keys,n,r,"value"),e.times=n,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}var YC={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},KC=(0,l.Z)((function e(t,n,r){(0,u.Z)(this,e);var i=this,a=!1,o=0,s=0,l=void 0,c=[];this.onStart=void 0,this.onLoad=t,this.onProgress=n,this.onError=r,this.itemStart=function(e){s++,!1===a&&void 0!==i.onStart&&i.onStart(e,o,s),a=!0},this.itemEnd=function(e){o++,void 0!==i.onProgress&&i.onProgress(e,o,s),o===s&&(a=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)},this.resolveURL=function(e){return l?l(e):e},this.setURLModifier=function(e){return l=e,this},this.addHandler=function(e,t){return c.push(e,t),this},this.removeHandler=function(e){var t=c.indexOf(e);return-1!==t&&c.splice(t,2),this},this.getHandler=function(e){for(var t=0,n=c.length;t<n;t+=2){var r=c[t],i=c[t+1];if(r.global&&(r.lastIndex=0),r.test(e))return i}return null}})),JC=new KC,QC=function(){function e(t){(0,u.Z)(this,e),this.manager=void 0!==t?t:JC,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}return(0,l.Z)(e,[{key:"load",value:function(){}},{key:"loadAsync",value:function(e,t){var n=this;return new Promise((function(r,i){n.load(e,r,t,i)}))}},{key:"parse",value:function(){}},{key:"setCrossOrigin",value:function(e){return this.crossOrigin=e,this}},{key:"setWithCredentials",value:function(e){return this.withCredentials=e,this}},{key:"setPath",value:function(e){return this.path=e,this}},{key:"setResourcePath",value:function(e){return this.resourcePath=e,this}},{key:"setRequestHeader",value:function(e){return this.requestHeader=e,this}}]),e}(),$C={},eA=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r){var i;return(0,u.Z)(this,n),(i=t.call(this,e)).response=r,i}return(0,l.Z)(n)}(ex(Error)),tA=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,l.Z)(n,[{key:"load",value:function(e,t,n,r){var i=this;void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var a=YC.get(e);if(void 0!==a)return this.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;if(void 0===$C[e]){$C[e]=[],$C[e].push({onLoad:t,onProgress:n,onError:r});var o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),s=this.mimeType,u=this.responseType;fetch(o).then((function(t){if(200===t.status||0===t.status){if(0===t.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"===typeof ReadableStream||void 0===t.body||void 0===t.body.getReader)return t;var n=$C[e],r=t.body.getReader(),i=t.headers.get("Content-Length")||t.headers.get("X-File-Size"),a=i?parseInt(i):0,o=0!==a,s=0,u=new ReadableStream({start:function(e){!function t(){r.read().then((function(r){var i=r.done,u=r.value;if(i)e.close();else{s+=u.byteLength;for(var l=new ProgressEvent("progress",{lengthComputable:o,loaded:s,total:a}),c=0,h=n.length;c<h;c++){var f=n[c];f.onProgress&&f.onProgress(l)}e.enqueue(u),t()}}))}()}});return new Response(u)}throw new eA('fetch for "'.concat(t.url,'" responded with ').concat(t.status,": ").concat(t.statusText),t)})).then((function(e){switch(u){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then((function(e){return(new DOMParser).parseFromString(e,s)}));case"json":return e.json();default:if(void 0===s)return e.text();var t=/charset="?([^;"\s]*)"?/i.exec(s),n=t&&t[1]?t[1].toLowerCase():void 0,r=new TextDecoder(n);return e.arrayBuffer().then((function(e){return r.decode(e)}))}})).then((function(t){YC.add(e,t);var n=$C[e];delete $C[e];for(var r=0,i=n.length;r<i;r++){var a=n[r];a.onLoad&&a.onLoad(t)}})).catch((function(t){var n=$C[e];if(void 0===n)throw i.manager.itemError(e),t;delete $C[e];for(var r=0,a=n.length;r<a;r++){var o=n[r];o.onError&&o.onError(t)}i.manager.itemError(e)})).finally((function(){i.manager.itemEnd(e)})),this.manager.itemStart(e)}else $C[e].push({onLoad:t,onProgress:n,onError:r})}},{key:"setResponseType",value:function(e){return this.responseType=e,this}},{key:"setMimeType",value:function(e){return this.mimeType=e,this}}]),n}(QC),nA=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,l.Z)(n,[{key:"load",value:function(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=YC.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;var o=Nw("img");function s(){l(),YC.add(e,this),t&&t(this),i.manager.itemEnd(e)}function u(t){l(),r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}function l(){o.removeEventListener("load",s,!1),o.removeEventListener("error",u,!1)}return o.addEventListener("load",s,!1),o.addEventListener("error",u,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),i.manager.itemStart(e),o.src=e,o}}]),n}(QC),rA=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,l.Z)(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new hC,o=new tA(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(i.withCredentials),o.load(e,(function(e){var n=i.parse(e);n&&(void 0!==n.image?a.image=n.image:void 0!==n.data&&(a.image.width=n.width,a.image.height=n.height,a.image.data=n.data),a.wrapS=void 0!==n.wrapS?n.wrapS:lx,a.wrapT=void 0!==n.wrapT?n.wrapT:lx,a.magFilter=void 0!==n.magFilter?n.magFilter:px,a.minFilter=void 0!==n.minFilter?n.minFilter:px,a.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.colorSpace?a.colorSpace=n.colorSpace:void 0!==n.encoding&&(a.encoding=n.encoding),void 0!==n.flipY&&(a.flipY=n.flipY),void 0!==n.format&&(a.format=n.format),void 0!==n.type&&(a.type=n.type),void 0!==n.mipmaps&&(a.mipmaps=n.mipmaps,a.minFilter=vx),1===n.mipmapCount&&(a.minFilter=px),void 0!==n.generateMipmaps&&(a.generateMipmaps=n.generateMipmaps),a.needsUpdate=!0,t&&t(a,n))}),n,r),a}}]),n}(QC),iA=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,l.Z)(n,[{key:"load",value:function(e,t,n,r){var i=new Yw,a=new nA(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,(function(e){i.image=e,i.needsUpdate=!0,void 0!==t&&t(i)}),n,r),i}}]),n}(QC),aA=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,u.Z)(this,n),(r=t.call(this)).isLight=!0,r.type="Light",r.color=new xM(e),r.intensity=i,r}return(0,l.Z)(n,[{key:"dispose",value:function(){}},{key:"copy",value:function(e,t){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e,t),this.color.copy(e.color),this.intensity=e.intensity,this}},{key:"toJSON",value:function(e){var t=wr((0,_r.Z)(n.prototype),"toJSON",this).call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}]),n}(nM),oA=new PS,sA=new tS,uA=new tS,lA=function(){function e(t){(0,u.Z)(this,e),this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Rw(512,512),this.map=null,this.mapPass=null,this.matrix=new PS,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new xk,this._frameExtents=new Rw(1,1),this._viewportCount=1,this._viewports=[new Kw(0,0,1,1)]}return(0,l.Z)(e,[{key:"getViewportCount",value:function(){return this._viewportCount}},{key:"getFrustum",value:function(){return this._frustum}},{key:"updateMatrices",value:function(e){var t=this.camera,n=this.matrix;sA.setFromMatrixPosition(e.matrixWorld),t.position.copy(sA),uA.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(uA),t.updateMatrixWorld(),oA.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(oA),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(oA)}},{key:"getViewport",value:function(e){return this._viewports[e]}},{key:"getFrameExtents",value:function(){return this._frameExtents}},{key:"dispose",value:function(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}},{key:"copy",value:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"toJSON",value:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}]),e}(),cA=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.call(this,new ck(50,1,.5,500))).isSpotLightShadow=!0,e.focus=1,e}return(0,l.Z)(n,[{key:"updateMatrices",value:function(e){var t=this.camera,r=2*bw*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,a=e.distance||t.far;r===t.fov&&i===t.aspect&&a===t.far||(t.fov=r,t.aspect=i,t.far=a,t.updateProjectionMatrix()),wr((0,_r.Z)(n.prototype),"updateMatrices",this).call(this,e)}},{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.focus=e.focus,this}}]),n}(lA),hA=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.PI/3,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2;return(0,u.Z)(this,n),(i=t.call(this,e,r)).isSpotLight=!0,i.type="SpotLight",i.position.copy(nM.DEFAULT_UP),i.updateMatrix(),i.target=new nM,i.distance=a,i.angle=o,i.penumbra=s,i.decay=l,i.map=null,i.shadow=new cA,i}return(0,l.Z)(n,[{key:"power",get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}},{key:"dispose",value:function(){this.shadow.dispose()}},{key:"copy",value:function(e,t){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}]),n}(aA),fA=new PS,dA=new tS,pA=new tS,vA=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.call(this,new ck(90,1,.5,500))).isPointLightShadow=!0,e._frameExtents=new Rw(4,2),e._viewportCount=6,e._viewports=[new Kw(2,1,1,1),new Kw(0,1,1,1),new Kw(3,1,1,1),new Kw(1,1,1,1),new Kw(3,0,1,1),new Kw(1,0,1,1)],e._cubeDirections=[new tS(1,0,0),new tS(-1,0,0),new tS(0,0,1),new tS(0,0,-1),new tS(0,1,0),new tS(0,-1,0)],e._cubeUps=[new tS(0,1,0),new tS(0,1,0),new tS(0,1,0),new tS(0,1,0),new tS(0,0,1),new tS(0,0,-1)],e}return(0,l.Z)(n,[{key:"updateMatrices",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.camera,r=this.matrix,i=e.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),dA.setFromMatrixPosition(e.matrixWorld),n.position.copy(dA),pA.copy(n.position),pA.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(pA),n.updateMatrixWorld(),r.makeTranslation(-dA.x,-dA.y,-dA.z),fA.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(fA)}}]),n}(lA),mA=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;return(0,u.Z)(this,n),(i=t.call(this,e,r)).isPointLight=!0,i.type="PointLight",i.distance=a,i.decay=o,i.shadow=new vA,i}return(0,l.Z)(n,[{key:"power",get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}},{key:"dispose",value:function(){this.shadow.dispose()}},{key:"copy",value:function(e,t){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}]),n}(aA),gA=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.call(this,new Ik(-5,5,5,-5,.5,500))).isDirectionalLightShadow=!0,e}return(0,l.Z)(n)}(lA),yA=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r){var i;return(0,u.Z)(this,n),(i=t.call(this,e,r)).isDirectionalLight=!0,i.type="DirectionalLight",i.position.copy(nM.DEFAULT_UP),i.updateMatrix(),i.target=new nM,i.shadow=new gA,i}return(0,l.Z)(n,[{key:"dispose",value:function(){this.shadow.dispose()}},{key:"copy",value:function(e){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}]),n}(aA),bA=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r){var i;return(0,u.Z)(this,n),(i=t.call(this,e,r)).isAmbientLight=!0,i.type="AmbientLight",i}return(0,l.Z)(n)}(aA),_A=function(){function e(){(0,u.Z)(this,e)}return(0,l.Z)(e,null,[{key:"decodeText",value:function(e){if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(_2){return t}}},{key:"extractUrlBase",value:function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}},{key:"resolveURL",value:function(e,t){return"string"!==typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}]),e}();var xA="\\[\\]\\.:\\/",wA=new RegExp("[\\[\\]\\.:\\/]","g"),SA="[^\\[\\]\\.:\\/]",MA="[^"+xA.replace("\\.","")+"]",kA=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",SA)+/(WCOD+)?/.source.replace("WCOD",MA)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",SA)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",SA)+"$"),TA=["material","materials","bones","map"],EA=function(){function e(t,n,r){(0,u.Z)(this,e);var i=r||CA.parseTrackName(n);this._targetGroup=t,this._bindings=t.subscribe_(n,i)}return(0,l.Z)(e,[{key:"getValue",value:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)}},{key:"setValue",value:function(e,t){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)}},{key:"bind",value:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}},{key:"unbind",value:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}]),e}(),CA=function(){function e(t,n,r){(0,u.Z)(this,e),this.path=n,this.parsedPath=r||e.parseTrackName(n),this.node=e.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}return(0,l.Z)(e,[{key:"_getValue_unavailable",value:function(){}},{key:"_setValue_unavailable",value:function(){}},{key:"_getValue_direct",value:function(e,t){e[t]=this.targetObject[this.propertyName]}},{key:"_getValue_array",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)e[t++]=n[r]}},{key:"_getValue_arrayElement",value:function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}},{key:"_getValue_toArray",value:function(e,t){this.resolvedProperty.toArray(e,t)}},{key:"_setValue_direct",value:function(e,t){this.targetObject[this.propertyName]=e[t]}},{key:"_setValue_direct_setNeedsUpdate",value:function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}},{key:"_setValue_direct_setMatrixWorldNeedsUpdate",value:function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_array",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++]}},{key:"_setValue_array_setNeedsUpdate",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}},{key:"_setValue_array_setMatrixWorldNeedsUpdate",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_arrayElement",value:function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}},{key:"_setValue_arrayElement_setNeedsUpdate",value:function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}},{key:"_setValue_arrayElement_setMatrixWorldNeedsUpdate",value:function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_fromArray",value:function(e,t){this.resolvedProperty.fromArray(e,t)}},{key:"_setValue_fromArray_setNeedsUpdate",value:function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}},{key:"_setValue_fromArray_setMatrixWorldNeedsUpdate",value:function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_getValue_unbound",value:function(e,t){this.bind(),this.getValue(e,t)}},{key:"_setValue_unbound",value:function(e,t){this.bind(),this.setValue(e,t)}},{key:"bind",value:function(){var t=this.node,n=this.parsedPath,r=n.objectName,i=n.propertyName,a=n.propertyIndex;if(t||(t=e.findNode(this.rootNode,n.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(r){var o=n.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var s=0;s<t.length;s++)if(t[s].name===o){o=s;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==o){if(void 0===t[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[o]}}var u=t[i];if(void 0!==u){var l=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);var c=this.BindingType.Direct;if(void 0!==a){if("morphTargetInfluences"===i){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[a]&&(a=t.morphTargetDictionary[a])}c=this.BindingType.ArrayElement,this.resolvedProperty=u,this.propertyIndex=a}else void 0!==u.fromArray&&void 0!==u.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=u):Array.isArray(u)?(c=this.BindingType.EntireArray,this.resolvedProperty=u):this.propertyName=i;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}else{var h=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+i+" but it wasn't found.",t)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")}},{key:"unbind",value:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}],[{key:"create",value:function(t,n,r){return t&&t.isAnimationObjectGroup?new e.Composite(t,n,r):new e(t,n,r)}},{key:"sanitizeNodeName",value:function(e){return e.replace(/\s/g,"_").replace(wA,"")}},{key:"parseTrackName",value:function(e){var t=kA.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==TA.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}},{key:"findNode",value:function(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){var r=function e(n){for(var r=0;r<n.length;r++){var i=n[r];if(i.name===t||i.uuid===t)return i;var a=e(i.children);if(a)return a}return null}(e.children);if(r)return r}return null}}]),e}();CA.Composite=EA,CA.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},CA.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},CA.prototype.GetterByBindingType=[CA.prototype._getValue_direct,CA.prototype._getValue_array,CA.prototype._getValue_arrayElement,CA.prototype._getValue_toArray],CA.prototype.SetterByBindingTypeAndVersioning=[[CA.prototype._setValue_direct,CA.prototype._setValue_direct_setNeedsUpdate,CA.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[CA.prototype._setValue_array,CA.prototype._setValue_array_setNeedsUpdate,CA.prototype._setValue_array_setMatrixWorldNeedsUpdate],[CA.prototype._setValue_arrayElement,CA.prototype._setValue_arrayElement_setNeedsUpdate,CA.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[CA.prototype._setValue_fromArray,CA.prototype._setValue_fromArray_setNeedsUpdate,CA.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];new Float32Array(1);"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:tx}})),"undefined"!==typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=tx);var AA=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,l.Z)(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new tA(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(n){try{t(i.parse(n))}catch(_2){r?r(_2):console.error(_2),i.manager.itemError(e)}}),n,r)}},{key:"parse",value:function(e){function t(e,t,n){for(var r=0,i=e.length;r<i;r++)if(e[r]!==t.getUint8(n+r))return!1;return!0}var n,r=function(e){if("string"===typeof e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=255&e.charCodeAt(n);return t.buffer||t}return e}(e);return function(e){var n=new DataView(e);if(84+50*n.getUint32(80,!0)===n.byteLength)return!0;for(var r=[115,111,108,105,100],i=0;i<5;i++)if(t(r,n,i))return!1;return!0}(r)?function(e){for(var t,n,r,i,a,o,s,u,l=new DataView(e),c=l.getUint32(80,!0),h=!1,f=0;f<70;f++)1129270351==l.getUint32(f,!1)&&82==l.getUint8(f+4)&&61==l.getUint8(f+5)&&(h=!0,i=new Float32Array(3*c*3),a=l.getUint8(f+6)/255,o=l.getUint8(f+7)/255,s=l.getUint8(f+8)/255,u=l.getUint8(f+9)/255);for(var d=new UM,p=new Float32Array(3*c*3),v=new Float32Array(3*c*3),m=0;m<c;m++){var g=84+50*m,y=l.getFloat32(g,!0),b=l.getFloat32(g+4,!0),_=l.getFloat32(g+8,!0);if(h){var x=l.getUint16(g+48,!0);0===(32768&x)?(t=(31&x)/31,n=(x>>5&31)/31,r=(x>>10&31)/31):(t=a,n=o,r=s)}for(var w=1;w<=3;w++){var S=g+12*w,M=3*m*3+3*(w-1);p[M]=l.getFloat32(S,!0),p[M+1]=l.getFloat32(S+4,!0),p[M+2]=l.getFloat32(S+8,!0),v[M]=y,v[M+1]=b,v[M+2]=_,h&&(i[M]=t,i[M+1]=n,i[M+2]=r)}}return d.setAttribute("position",new TM(p,3)),d.setAttribute("normal",new TM(v,3)),h&&(d.setAttribute("color",new TM(i,3)),d.hasColors=!0,d.alpha=u),d}(r):function(e){for(var t,n=new UM,r=/solid([\s\S]*?)endsolid/g,i=/facet([\s\S]*?)endfacet/g,a=0,o=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,s=new RegExp("vertex"+o+o+o,"g"),u=new RegExp("normal"+o+o+o,"g"),l=[],c=[],h=new tS,f=0,d=0,p=0;null!==(t=r.exec(e));){d=p;for(var v=t[0];null!==(t=i.exec(v));){for(var m=0,g=0,y=t[0];null!==(t=u.exec(y));)h.x=parseFloat(t[1]),h.y=parseFloat(t[2]),h.z=parseFloat(t[3]),g++;for(;null!==(t=s.exec(y));)l.push(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])),c.push(h.x,h.y,h.z),m++,p++;1!==g&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+a),3!==m&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+a),a++}var b=d,_=p-d;n.addGroup(b,_,f),f++}return n.setAttribute("position",new AM(l,3)),n.setAttribute("normal",new AM(c,3)),n}("string"!==typeof(n=e)?(new TextDecoder).decode(n):n)}}]),n}(QC),RA=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,l.Z)(n,[{key:"parse",value:function(e){var t=0,n=1,r=2,i=3,a=9,o=10,s=11,u=48,l=4,c=0,h=1,f=2,d=3;e.length<19&&console.error("THREE.TGALoader: Not enough data to contain header.");var p=0,v=new Uint8Array(e),m={id_length:v[p++],colormap_type:v[p++],image_type:v[p++],colormap_index:v[p++]|v[p++]<<8,colormap_length:v[p++]|v[p++]<<8,colormap_size:v[p++],origin:[v[p++]|v[p++]<<8,v[p++]|v[p++]<<8],width:v[p++]|v[p++]<<8,height:v[p++]|v[p++]<<8,pixel_size:v[p++],flags:v[p++]};!function(e){switch(e.image_type){case n:case a:(e.colormap_length>256||24!==e.colormap_size||1!==e.colormap_type)&&console.error("THREE.TGALoader: Invalid type colormap data for indexed type.");break;case r:case i:case o:case s:e.colormap_type&&console.error("THREE.TGALoader: Invalid type colormap data for colormap type.");break;case t:console.error("THREE.TGALoader: No data.");default:console.error('THREE.TGALoader: Invalid type "%s".',e.image_type)}(e.width<=0||e.height<=0)&&console.error("THREE.TGALoader: Invalid image size."),8!==e.pixel_size&&16!==e.pixel_size&&24!==e.pixel_size&&32!==e.pixel_size&&console.error('THREE.TGALoader: Invalid pixel size "%s".',e.pixel_size)}(m),m.id_length+p>e.length&&console.error("THREE.TGALoader: No data."),p+=m.id_length;var g=!1,y=!1,b=!1;switch(m.image_type){case a:g=!0,y=!0;break;case n:y=!0;break;case o:g=!0;break;case r:break;case s:g=!0,b=!0;break;case i:b=!0}var _=new Uint8Array(m.width*m.height*4),x=function(e,t,n,r,i){var a,o,s=n.pixel_size>>3,u=n.width*n.height*s;if(t&&(o=i.subarray(r,r+=n.colormap_length*(n.colormap_size>>3))),e){var l,c,h;a=new Uint8Array(u);for(var f=0,d=new Uint8Array(s);f<u;)if(c=1+(127&(l=i[r++])),128&l){for(h=0;h<s;++h)d[h]=i[r++];for(h=0;h<c;++h)a.set(d,f+h*s);f+=s*c}else{for(c*=s,h=0;h<c;++h)a[f+h]=i[r++];f+=c}}else a=i.subarray(r,r+=t?n.width*n.height:u);return{pixel_data:a,palettes:o}}(g,y,m,p,v);return function(e,t,n,r,i){var a,o,s,p,v,g;switch((m.flags&u)>>l){default:case f:a=0,s=1,v=t,o=0,p=1,g=n;break;case c:a=0,s=1,v=t,o=n-1,p=-1,g=-1;break;case d:a=t-1,s=-1,v=-1,o=0,p=1,g=n;break;case h:a=t-1,s=-1,v=-1,o=n-1,p=-1,g=-1}if(b)switch(m.pixel_size){case 8:!function(e,t,n,r,i,a,o,s){var u,l,c,h=0,f=m.width;for(c=t;c!==r;c+=n)for(l=i;l!==o;l+=a,h++)u=s[h],e[4*(l+f*c)+0]=u,e[4*(l+f*c)+1]=u,e[4*(l+f*c)+2]=u,e[4*(l+f*c)+3]=255}(e,o,p,g,a,s,v,r);break;case 16:!function(e,t,n,r,i,a,o,s){var u,l,c=0,h=m.width;for(l=t;l!==r;l+=n)for(u=i;u!==o;u+=a,c+=2)e[4*(u+h*l)+0]=s[c+0],e[4*(u+h*l)+1]=s[c+0],e[4*(u+h*l)+2]=s[c+0],e[4*(u+h*l)+3]=s[c+1]}(e,o,p,g,a,s,v,r);break;default:console.error("THREE.TGALoader: Format not supported.")}else switch(m.pixel_size){case 8:!function(e,t,n,r,i,a,o,s,u){var l,c,h,f=u,d=0,p=m.width;for(h=t;h!==r;h+=n)for(c=i;c!==o;c+=a,d++)l=s[d],e[4*(c+p*h)+3]=255,e[4*(c+p*h)+2]=f[3*l+0],e[4*(c+p*h)+1]=f[3*l+1],e[4*(c+p*h)+0]=f[3*l+2]}(e,o,p,g,a,s,v,r,i);break;case 16:!function(e,t,n,r,i,a,o,s){var u,l,c,h=0,f=m.width;for(c=t;c!==r;c+=n)for(l=i;l!==o;l+=a,h+=2)u=s[h+0]+(s[h+1]<<8),e[4*(l+f*c)+0]=(31744&u)>>7,e[4*(l+f*c)+1]=(992&u)>>2,e[4*(l+f*c)+2]=(31&u)<<3,e[4*(l+f*c)+3]=32768&u?0:255}(e,o,p,g,a,s,v,r);break;case 24:!function(e,t,n,r,i,a,o,s){var u,l,c=0,h=m.width;for(l=t;l!==r;l+=n)for(u=i;u!==o;u+=a,c+=3)e[4*(u+h*l)+3]=255,e[4*(u+h*l)+2]=s[c+0],e[4*(u+h*l)+1]=s[c+1],e[4*(u+h*l)+0]=s[c+2]}(e,o,p,g,a,s,v,r);break;case 32:!function(e,t,n,r,i,a,o,s){var u,l,c=0,h=m.width;for(l=t;l!==r;l+=n)for(u=i;u!==o;u+=a,c+=4)e[4*(u+h*l)+2]=s[c+0],e[4*(u+h*l)+1]=s[c+1],e[4*(u+h*l)+0]=s[c+2],e[4*(u+h*l)+3]=s[c+3]}(e,o,p,g,a,s,v,r);break;default:console.error("THREE.TGALoader: Format not supported.")}}(_,m.width,m.height,x.pixel_data,x.palettes),{data:_,width:m.width,height:m.height,flipY:!0,generateMipmaps:!0,minFilter:vx}}}]),n}(rA),PA=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,l.Z)(n,[{key:"load",value:function(e,t,n,r){var i=this,a=""===i.path?_A.extractUrlBase(e):i.path,o=new tA(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(e,(function(n){try{t(i.parse(n,a))}catch(_2){r?r(_2):console.error(_2),i.manager.itemError(e)}}),n,r)}},{key:"parse",value:function(e,t){function n(e,t){for(var n=[],r=e.childNodes,i=0,a=r.length;i<a;i++){var o=r[i];o.nodeName===t&&n.push(o)}return n}function r(e){if(0===e.length)return[];for(var t=e.trim().split(/\s+/),n=new Array(t.length),r=0,i=t.length;r<i;r++)n[r]=t[r];return n}function i(e){if(0===e.length)return[];for(var t=e.trim().split(/\s+/),n=new Array(t.length),r=0,i=t.length;r<i;r++)n[r]=parseFloat(t[r]);return n}function a(e){if(0===e.length)return[];for(var t=e.trim().split(/\s+/),n=new Array(t.length),r=0,i=t.length;r<i;r++)n[r]=parseInt(t[r]);return n}function o(e){return e.substring(1)}function s(e){return 0===Object.keys(e).length}function u(e){return void 0!==e&&!0===e.hasAttribute("meter")?parseFloat(e.getAttribute("meter")):1}function l(e){return void 0!==e?e.textContent:"Y_UP"}function c(e,t,r,i){var a=n(e,t)[0];if(void 0!==a)for(var o=n(a,r),s=0;s<o.length;s++)i(o[s])}function h(e,t){for(var n in e){e[n].build=t(e[n])}}function f(e,t){return void 0!==e.build||(e.build=t(e)),e.build}function d(e){for(var t={inputs:{}},n=0,r=e.childNodes.length;n<r;n++){var i=e.childNodes[n];if(1===i.nodeType&&"input"===i.nodeName){var a=o(i.getAttribute("source")),s=i.getAttribute("semantic");t.inputs[s]=a}}return t}function p(e){var t={},n=e.getAttribute("target").split("/"),r=n.shift(),i=n.shift(),a=-1!==i.indexOf("("),s=-1!==i.indexOf(".");if(s)n=i.split("."),i=n.shift(),t.member=n.shift();else if(a){var u=i.split("(");i=u.shift();for(var l=0;l<u.length;l++)u[l]=parseInt(u[l].replace(/\)/,""));t.indices=u}return t.id=r,t.sid=i,t.arraySyntax=a,t.memberSyntax=s,t.sampler=o(e.getAttribute("source")),t}function v(e){var t=[],n=e.channels,r=e.samplers,i=e.sources;for(var a in n)if(n.hasOwnProperty(a)){var o=n[a],s=r[o.sampler],u=s.inputs.INPUT,l=s.inputs.OUTPUT;x(g(o,i[u],i[l]),t)}return t}function m(e){return f(tt.animations[e],v)}function g(e,t,n){var r,i,a,o,s,u,l=tt.nodes[e.id],c=Fe(l.id),h=l.transforms[e.sid],f=l.matrix.clone().transpose(),d={};switch(h){case"matrix":for(a=0,o=t.array.length;a<o;a++)if(r=t.array[a],i=a*n.stride,void 0===d[r]&&(d[r]={}),!0===e.arraySyntax){var p=n.array[i],v=e.indices[0]+4*e.indices[1];d[r][v]=p}else for(s=0,u=n.stride;s<u;s++)d[r][s]=n.array[i+s];break;case"translate":case"rotate":case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',h)}var m=function(e,t){var n=[];for(var r in e)n.push({time:parseFloat(r),value:e[r]});n.sort(a);for(var i=0;i<16;i++)w(n,i,t.elements[i]);return n;function a(e,t){return e.time-t.time}}(d,f);return{name:c.uuid,keyframes:m}}var y=new tS,b=new tS,_=new eS;function x(e,t){for(var n=e.keyframes,r=e.name,i=[],a=[],o=[],s=[],u=0,l=n.length;u<l;u++){var c=n[u],h=c.time,f=c.value;Ee.fromArray(f).transpose(),Ee.decompose(y,_,b),i.push(h),a.push(y.x,y.y,y.z),o.push(_.x,_.y,_.z,_.w),s.push(b.x,b.y,b.z)}return a.length>0&&t.push(new ZC(r+".position",i,a)),o.length>0&&t.push(new HC(r+".quaternion",i,o)),s.length>0&&t.push(new ZC(r+".scale",i,s)),t}function w(e,t,n){var r,i,a,o=!0;for(i=0,a=e.length;i<a;i++)void 0===(r=e[i]).value[t]?r.value[t]=null:o=!1;if(!0===o)for(i=0,a=e.length;i<a;i++)(r=e[i]).value[t]=n;else!function(e,t){for(var n,r,i=0,a=e.length;i<a;i++){var o=e[i];if(null===o.value[t]){if(n=S(e,i,t),r=M(e,i,t),null===n){o.value[t]=r.value[t];continue}if(null===r){o.value[t]=n.value[t];continue}k(o,n,r,t)}}}(e,t)}function S(e,t,n){for(;t>=0;){var r=e[t];if(null!==r.value[n])return r;t--}return null}function M(e,t,n){for(;t<e.length;){var r=e[t];if(null!==r.value[n])return r;t++}return null}function k(e,t,n,r){n.time-t.time!==0?e.value[r]=(e.time-t.time)*(n.value[r]-t.value[r])/(n.time-t.time)+t.value[r]:e.value[r]=t.value[r]}function T(e){for(var t=[],n=e.name,r=e.end-e.start||-1,i=e.animations,a=0,o=i.length;a<o;a++)for(var s=m(i[a]),u=0,l=s.length;u<l;u++)t.push(s[u]);return new qC(n,r,t)}function E(e){return f(tt.clips[e],T)}function C(e){for(var t={sources:{}},n=0,r=e.childNodes.length;n<r;n++){var a=e.childNodes[n];if(1===a.nodeType)switch(a.nodeName){case"bind_shape_matrix":t.bindShapeMatrix=i(a.textContent);break;case"source":var o=a.getAttribute("id");t.sources[o]=se(a);break;case"joints":t.joints=A(a);break;case"vertex_weights":t.vertexWeights=R(a)}}return t}function A(e){for(var t={inputs:{}},n=0,r=e.childNodes.length;n<r;n++){var i=e.childNodes[n];if(1===i.nodeType&&"input"===i.nodeName){var a=i.getAttribute("semantic"),s=o(i.getAttribute("source"));t.inputs[a]=s}}return t}function R(e){for(var t={inputs:{}},n=0,r=e.childNodes.length;n<r;n++){var i=e.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"input":var s=i.getAttribute("semantic"),u=o(i.getAttribute("source")),l=parseInt(i.getAttribute("offset"));t.inputs[s]={id:u,offset:l};break;case"vcount":t.vcount=a(i.textContent);break;case"v":t.v=a(i.textContent)}}return t}function P(e){var t={id:e.id},n=tt.geometries[t.id];return void 0!==e.skin&&(t.skin=function(e){var t,n,r,i=4,a={joints:[],indices:{array:[],stride:i},weights:{array:[],stride:i}},o=e.sources,s=e.vertexWeights,u=s.vcount,l=s.v,c=s.inputs.JOINT.offset,h=s.inputs.WEIGHT.offset,f=e.sources[e.joints.inputs.JOINT],d=e.sources[e.joints.inputs.INV_BIND_MATRIX],p=o[s.inputs.WEIGHT.id].array,v=0;for(t=0,r=u.length;t<r;t++){var m=u[t],g=[];for(n=0;n<m;n++){var y=l[v+c],b=p[l[v+h]];g.push({index:y,weight:b}),v+=2}for(g.sort(S),n=0;n<i;n++){var _=g[n];void 0!==_?(a.indices.array.push(_.index),a.weights.array.push(_.weight)):(a.indices.array.push(0),a.weights.array.push(0))}}e.bindShapeMatrix?a.bindMatrix=(new PS).fromArray(e.bindShapeMatrix).transpose():a.bindMatrix=(new PS).identity();for(t=0,r=f.array.length;t<r;t++){var x=f.array[t],w=(new PS).fromArray(d.array,t*d.stride).transpose();a.joints.push({name:x,boneInverse:w})}return a;function S(e,t){return t.weight-e.weight}}(e.skin),n.sources.skinIndices=t.skin.indices,n.sources.skinWeights=t.skin.weights),t}function L(e){return f(tt.controllers[e],P)}function D(e){return void 0!==e.build?e.build:e.init_from}function N(e){var t=tt.images[e];return void 0!==t?f(t,D):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",e),null)}function I(e){for(var t={surfaces:{},samplers:{}},n=0,r=e.childNodes.length;n<r;n++){var i=e.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"newparam":O(i,t);break;case"technique":t.technique=z(i);break;case"extra":t.extra=W(i)}}return t}function O(e,t){for(var n=e.getAttribute("sid"),r=0,i=e.childNodes.length;r<i;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"surface":t.surfaces[n]=U(a);break;case"sampler2D":t.samplers[n]=F(a)}}}function U(e){for(var t={},n=0,r=e.childNodes.length;n<r;n++){var i=e.childNodes[n];if(1===i.nodeType&&"init_from"===i.nodeName)t.init_from=i.textContent}return t}function F(e){for(var t={},n=0,r=e.childNodes.length;n<r;n++){var i=e.childNodes[n];if(1===i.nodeType&&"source"===i.nodeName)t.source=i.textContent}return t}function z(e){for(var t={},n=0,r=e.childNodes.length;n<r;n++){var i=e.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"constant":case"lambert":case"blinn":case"phong":t.type=i.nodeName,t.parameters=B(i);break;case"extra":t.extra=W(i)}}return t}function B(e){for(var t={},n=0,r=e.childNodes.length;n<r;n++){var i=e.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":t[i.nodeName]=V(i);break;case"transparent":t[i.nodeName]={opaque:i.hasAttribute("opaque")?i.getAttribute("opaque"):"A_ONE",data:V(i)}}}return t}function V(e){for(var t={},n=0,r=e.childNodes.length;n<r;n++){var a=e.childNodes[n];if(1===a.nodeType)switch(a.nodeName){case"color":t[a.nodeName]=i(a.textContent);break;case"float":t[a.nodeName]=parseFloat(a.textContent);break;case"texture":t[a.nodeName]={id:a.getAttribute("texture"),extra:G(a)}}}return t}function G(e){for(var t={technique:{}},n=0,r=e.childNodes.length;n<r;n++){var i=e.childNodes[n];if(1===i.nodeType&&"extra"===i.nodeName)j(i,t)}return t}function j(e,t){for(var n=0,r=e.childNodes.length;n<r;n++){var i=e.childNodes[n];if(1===i.nodeType&&"technique"===i.nodeName)H(i,t)}}function H(e,t){for(var n=0,r=e.childNodes.length;n<r;n++){var i=e.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":t.technique[i.nodeName]=parseFloat(i.textContent);break;case"wrapU":case"wrapV":"TRUE"===i.textContent.toUpperCase()?t.technique[i.nodeName]=1:"FALSE"===i.textContent.toUpperCase()?t.technique[i.nodeName]=0:t.technique[i.nodeName]=parseInt(i.textContent);break;case"bump":t[i.nodeName]=q(i)}}}function W(e){for(var t={},n=0,r=e.childNodes.length;n<r;n++){var i=e.childNodes[n];if(1===i.nodeType&&"technique"===i.nodeName)t.technique=Z(i)}return t}function Z(e){for(var t={},n=0,r=e.childNodes.length;n<r;n++){var i=e.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"double_sided":t[i.nodeName]=parseInt(i.textContent);break;case"bump":t[i.nodeName]=q(i)}}return t}function q(e){for(var t={},n=0,r=e.childNodes.length;n<r;n++){var i=e.childNodes[n];if(1===i.nodeType&&"texture"===i.nodeName)t[i.nodeName]={id:i.getAttribute("texture"),texcoord:i.getAttribute("texcoord"),extra:G(i)}}return t}function X(e){return e}function Y(e){var t,n=e.slice(2+(e.lastIndexOf(".")-1>>>0));if("tga"===(n=n.toLowerCase()))t=Xe;else t=Ke;return t}function K(e){var t,n=function(e){return f(tt.effects[e],X)}(e.url),r=n.profile.technique;switch(r.type){case"phong":case"blinn":t=new EC;break;case"lambert":t=new CC;break;default:t=new SM}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=n.profile.samplers[e.id],i=null;if(void 0!==r){var a=n.profile.surfaces[r.source];i=N(a.init_from)}else console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),i=N(e.id);if(null!==i){var o=Y(i);if(void 0!==o){var u=o.load(i),l=e.extra;if(void 0!==l&&void 0!==l.technique&&!1===s(l.technique)){var c=l.technique;u.wrapS=c.wrapU?ux:lx,u.wrapT=c.wrapV?ux:lx,u.offset.set(c.offsetU||0,c.offsetV||0),u.repeat.set(c.repeatU||1,c.repeatV||1)}else u.wrapS=ux,u.wrapT=ux;return null!==t&&(u.colorSpace=t),u}return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",i),null}return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",e.id),null}t.name=e.name||"";var a=r.parameters;for(var o in a){var u=a[o];switch(o){case"diffuse":u.color&&t.color.fromArray(u.color),u.texture&&(t.map=i(u.texture,uw));break;case"specular":u.color&&t.specular&&t.specular.fromArray(u.color),u.texture&&(t.specularMap=i(u.texture));break;case"bump":u.texture&&(t.normalMap=i(u.texture));break;case"ambient":u.texture&&(t.lightMap=i(u.texture,uw));break;case"shininess":u.float&&t.shininess&&(t.shininess=u.float);break;case"emission":u.color&&t.emissive&&t.emissive.fromArray(u.color),u.texture&&(t.emissiveMap=i(u.texture,uw))}}t.color.convertSRGBToLinear(),t.specular&&t.specular.convertSRGBToLinear(),t.emissive&&t.emissive.convertSRGBToLinear();var l=a.transparent,c=a.transparency;if(void 0===c&&l&&(c={float:1}),void 0===l&&c&&(l={opaque:"A_ONE",data:{color:[1,1,1,1]}}),l&&c)if(l.data.texture)t.transparent=!0;else{var h=l.data.color;switch(l.opaque){case"A_ONE":t.opacity=h[3]*c.float;break;case"RGB_ZERO":t.opacity=1-h[0]*c.float;break;case"A_ZERO":t.opacity=1-h[3]*c.float;break;case"RGB_ONE":t.opacity=h[0]*c.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',l.opaque)}t.opacity<1&&(t.transparent=!0)}if(void 0!==r.extra&&void 0!==r.extra.technique){var d=r.extra.technique;for(var p in d){var v=d[p];switch(p){case"double_sided":t.side=1===v?2:0;break;case"bump":t.normalMap=i(v.texture),t.normalScale=new Rw(1,1)}}}return t}function J(e){return f(tt.materials[e],K)}function Q(e){for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];if("technique_common"===n.nodeName)return $(n)}return{}}function $(e){for(var t={},n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];switch(r.nodeName){case"perspective":case"orthographic":t.technique=r.nodeName,t.parameters=ee(r)}}return t}function ee(e){for(var t={},n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];switch(r.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":t[r.nodeName]=parseFloat(r.textContent)}}return t}function te(e){var t;switch(e.optics.technique){case"perspective":t=new ck(e.optics.parameters.yfov,e.optics.parameters.aspect_ratio,e.optics.parameters.znear,e.optics.parameters.zfar);break;case"orthographic":var n=e.optics.parameters.ymag,r=e.optics.parameters.xmag,i=e.optics.parameters.aspect_ratio;r=void 0===r?n*i:r,n=void 0===n?r/i:n,t=new Ik(-(r*=.5),r,n*=.5,-n,e.optics.parameters.znear,e.optics.parameters.zfar);break;default:t=new ck}return t.name=e.name||"",t}function ne(e){var t=tt.cameras[e];return void 0!==t?f(t,te):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",e),null)}function re(e){for(var t={},n=0,r=e.childNodes.length;n<r;n++){var i=e.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"directional":case"point":case"spot":case"ambient":t.technique=i.nodeName,t.parameters=ie(i)}}return t}function ie(e){for(var t={},n=0,r=e.childNodes.length;n<r;n++){var a=e.childNodes[n];if(1===a.nodeType)switch(a.nodeName){case"color":var o=i(a.textContent);t.color=(new xM).fromArray(o).convertSRGBToLinear();break;case"falloff_angle":t.falloffAngle=parseFloat(a.textContent);break;case"quadratic_attenuation":var s=parseFloat(a.textContent);t.distance=s?Math.sqrt(1/s):0}}return t}function ae(e){var t;switch(e.technique){case"directional":t=new yA;break;case"point":t=new mA;break;case"spot":t=new hA;break;case"ambient":t=new bA}return e.parameters.color&&t.color.copy(e.parameters.color),e.parameters.distance&&(t.distance=e.parameters.distance),t}function oe(e){var t=tt.lights[e];return void 0!==t?f(t,ae):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",e),null)}function se(e){for(var t={array:[],stride:3},a=0;a<e.childNodes.length;a++){var o=e.childNodes[a];if(1===o.nodeType)switch(o.nodeName){case"float_array":t.array=i(o.textContent);break;case"Name_array":t.array=r(o.textContent);break;case"technique_common":var s=n(o,"accessor")[0];void 0!==s&&(t.stride=parseInt(s.getAttribute("stride")))}}return t}function ue(e){for(var t={},n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];1===r.nodeType&&(t[r.getAttribute("semantic")]=o(r.getAttribute("source")))}return t}function le(e){for(var t={type:e.nodeName,material:e.getAttribute("material"),count:parseInt(e.getAttribute("count")),inputs:{},stride:0,hasUV:!1},n=0,r=e.childNodes.length;n<r;n++){var i=e.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"input":var s=o(i.getAttribute("source")),u=i.getAttribute("semantic"),l=parseInt(i.getAttribute("offset")),c=parseInt(i.getAttribute("set")),h=c>0?u+c:u;t.inputs[h]={id:s,offset:l},t.stride=Math.max(t.stride,l+1),"TEXCOORD"===u&&(t.hasUV=!0);break;case"vcount":t.vcount=a(i.textContent);break;case"p":t.p=a(i.textContent)}}return t}function ce(e){for(var t=0,n=0,r=e.length;n<r;n++){!0===e[n].hasUV&&t++}t>0&&t<e.length&&(e.uvsNeedsFix=!0)}function he(e){var t={},n=e.sources,r=e.vertices,i=e.primitives;if(0===i.length)return{};var a=function(e){for(var t={},n=0;n<e.length;n++){var r=e[n];void 0===t[r.type]&&(t[r.type]=[]),t[r.type].push(r)}return t}(i);for(var o in a){var s=a[o];ce(s),t[o]=fe(s,n,r)}return t}function fe(e,t,n){for(var r={},i={array:[],stride:0},a={array:[],stride:0},o={array:[],stride:0},s={array:[],stride:0},u={array:[],stride:0},l=[],c=4,h=[],f=4,d=new UM,p=[],v=0,m=0;m<e.length;m++){var g=e[m],y=g.inputs,b=0;switch(g.type){case"lines":case"linestrips":b=2*g.count;break;case"triangles":b=3*g.count;break;case"polylist":for(var _=0;_<g.count;_++){var x=g.vcount[_];switch(x){case 3:b+=3;break;case 4:b+=6;break;default:b+=3*(x-2)}}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",g.type)}for(var w in d.addGroup(v,b,m),v+=b,g.material&&p.push(g.material),y){var S=y[w];switch(w){case"VERTEX":for(var M in n){var k=n[M];switch(M){case"POSITION":var T=i.array.length;if(de(g,t[k],S.offset,i.array),i.stride=t[k].stride,t.skinWeights&&t.skinIndices&&(de(g,t.skinIndices,S.offset,l),de(g,t.skinWeights,S.offset,h)),!1===g.hasUV&&!0===e.uvsNeedsFix)for(var E=(i.array.length-T)/i.stride,C=0;C<E;C++)o.array.push(0,0);break;case"NORMAL":de(g,t[k],S.offset,a.array),a.stride=t[k].stride;break;case"COLOR":de(g,t[k],S.offset,u.array),u.stride=t[k].stride;break;case"TEXCOORD":de(g,t[k],S.offset,o.array),o.stride=t[k].stride;break;case"TEXCOORD1":de(g,t[k],S.offset,s.array),o.stride=t[k].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',M)}}break;case"NORMAL":de(g,t[S.id],S.offset,a.array),a.stride=t[S.id].stride;break;case"COLOR":de(g,t[S.id],S.offset,u.array,!0),u.stride=t[S.id].stride;break;case"TEXCOORD":de(g,t[S.id],S.offset,o.array),o.stride=t[S.id].stride;break;case"TEXCOORD1":de(g,t[S.id],S.offset,s.array),s.stride=t[S.id].stride}}}return i.array.length>0&&d.setAttribute("position",new AM(i.array,i.stride)),a.array.length>0&&d.setAttribute("normal",new AM(a.array,a.stride)),u.array.length>0&&d.setAttribute("color",new AM(u.array,u.stride)),o.array.length>0&&d.setAttribute("uv",new AM(o.array,o.stride)),s.array.length>0&&d.setAttribute("uv1",new AM(s.array,s.stride)),l.length>0&&d.setAttribute("skinIndex",new AM(l,c)),h.length>0&&d.setAttribute("skinWeight",new AM(h,f)),r.data=d,r.type=e[0].type,r.materialKeys=p,r}function de(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=e.p,o=e.stride,s=e.vcount;function u(e){for(var t=a[e+n]*c,o=t+c;t<o;t++)r.push(l[t]);if(i){var s=r.length-c-1;Je.setRGB(r[s+0],r[s+1],r[s+2]).convertSRGBToLinear(),r[s+0]=Je.r,r[s+1]=Je.g,r[s+2]=Je.b}}var l=t.array,c=t.stride;if(void 0!==e.vcount)for(var h=0,f=0,d=s.length;f<d;f++){var p=s[f];if(4===p){var v=h+0*o,m=h+1*o,g=h+2*o,y=h+3*o;u(v),u(m),u(y),u(m),u(g),u(y)}else if(3===p){var b=h+0*o,_=h+1*o,x=h+2*o;u(b),u(_),u(x)}else if(p>4)for(var w=1,S=p-2;w<=S;w++){var M=h+0*o,k=h+o*w,T=h+o*(w+1);u(M),u(k),u(T)}h+=o*p}else for(var E=0,C=a.length;E<C;E+=o)u(E)}function pe(e){return f(tt.geometries[e],he)}function ve(e){return void 0!==e.build?e.build:e}function me(e,t){for(var n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"joint":t.joints[r.getAttribute("sid")]=ge(r);break;case"link":t.links.push(be(r))}}}function ge(e){for(var t,n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"prismatic":case"revolute":t=ye(r)}}return t}function ye(e){for(var t={sid:e.getAttribute("sid"),name:e.getAttribute("name")||"",axis:new tS,limits:{min:0,max:0},type:e.nodeName,static:!1,zeroPosition:0,middlePosition:0},n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"axis":var a=i(r.textContent);t.axis.fromArray(a);break;case"limits":var o=r.getElementsByTagName("max")[0],s=r.getElementsByTagName("min")[0];t.limits.max=parseFloat(o.textContent),t.limits.min=parseFloat(s.textContent)}}return t.limits.min>=t.limits.max&&(t.static=!0),t.middlePosition=(t.limits.min+t.limits.max)/2,t}function be(e){for(var t={sid:e.getAttribute("sid"),name:e.getAttribute("name")||"",attachments:[],transforms:[]},n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"attachment_full":t.attachments.push(_e(r));break;case"matrix":case"translate":case"rotate":t.transforms.push(xe(r))}}return t}function _e(e){for(var t={joint:e.getAttribute("joint").split("/").pop(),transforms:[],links:[]},n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"link":t.links.push(be(r));break;case"matrix":case"translate":case"rotate":t.transforms.push(xe(r))}}return t}function xe(e){var t={type:e.nodeName},n=i(e.textContent);switch(t.type){case"matrix":t.obj=new PS,t.obj.fromArray(n).transpose();break;case"translate":t.obj=new tS,t.obj.fromArray(n);break;case"rotate":t.obj=new tS,t.obj.fromArray(n),t.angle=Aw.degToRad(n[3])}return t}function we(e,t){for(var n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];if(1===r.nodeType&&"technique_common"===r.nodeName)Se(r,t)}}function Se(e,t){for(var n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"inertia":t.inertia=i(r.textContent);break;case"mass":t.mass=i(r.textContent)[0]}}}function Me(e){for(var t={target:e.getAttribute("target").split("/").pop()},n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];if(1===r.nodeType&&"axis"===r.nodeName){var i=r.getElementsByTagName("param")[0];t.axis=i.textContent;var a=t.axis.split("inst_").pop().split("axis")[0];t.jointIndex=a.substring(0,a.length-1)}}return t}function ke(e){return void 0!==e.build?e.build:e}function Te(e){for(var t=[],n=je.querySelector('[id="'+e.id+'"]'),r=0;r<n.childNodes.length;r++){var a=n.childNodes[r];if(1===a.nodeType){var o=void 0,s=void 0;switch(a.nodeName){case"matrix":o=i(a.textContent);var u=(new PS).fromArray(o).transpose();t.push({sid:a.getAttribute("sid"),type:a.nodeName,obj:u});break;case"translate":case"scale":o=i(a.textContent),s=(new tS).fromArray(o),t.push({sid:a.getAttribute("sid"),type:a.nodeName,obj:s});break;case"rotate":o=i(a.textContent),s=(new tS).fromArray(o);var l=Aw.degToRad(o[3]);t.push({sid:a.getAttribute("sid"),type:a.nodeName,obj:s,angle:l})}}}return t}var Ee=new PS,Ce=new tS;function Ae(e){for(var t={name:e.getAttribute("name")||"",type:e.getAttribute("type"),id:e.getAttribute("id"),sid:e.getAttribute("sid"),matrix:new PS,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}},n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];if(1===r.nodeType){var a=void 0;switch(r.nodeName){case"node":t.nodes.push(r.getAttribute("id")),Ae(r);break;case"instance_camera":t.instanceCameras.push(o(r.getAttribute("url")));break;case"instance_controller":t.instanceControllers.push(Re(r));break;case"instance_light":t.instanceLights.push(o(r.getAttribute("url")));break;case"instance_geometry":t.instanceGeometries.push(Re(r));break;case"instance_node":t.instanceNodes.push(o(r.getAttribute("url")));break;case"matrix":a=i(r.textContent),t.matrix.multiply(Ee.fromArray(a).transpose()),t.transforms[r.getAttribute("sid")]=r.nodeName;break;case"translate":a=i(r.textContent),Ce.fromArray(a),t.matrix.multiply(Ee.makeTranslation(Ce.x,Ce.y,Ce.z)),t.transforms[r.getAttribute("sid")]=r.nodeName;break;case"rotate":a=i(r.textContent);var s=Aw.degToRad(a[3]);t.matrix.multiply(Ee.makeRotationAxis(Ce.fromArray(a),s)),t.transforms[r.getAttribute("sid")]=r.nodeName;break;case"scale":a=i(r.textContent),t.matrix.scale(Ce.fromArray(a)),t.transforms[r.getAttribute("sid")]=r.nodeName;break;case"extra":break;default:console.log(r)}}}return Ue(t.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",t.id):tt.nodes[t.id]=t,t}function Re(e){for(var t={id:o(e.getAttribute("url")),materials:{},skeletons:[]},n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];switch(r.nodeName){case"bind_material":for(var i=r.getElementsByTagName("instance_material"),a=0;a<i.length;a++){var s=i[a],u=s.getAttribute("symbol"),l=s.getAttribute("target");t.materials[u]=o(l)}break;case"skeleton":t.skeletons.push(o(r.textContent))}}return t}function Pe(e,t){var n,r,i,a=[],o=[];for(n=0;n<e.length;n++){var s=e[n];if(Ue(s))Le(Fe(s),t,a);else if(Be(s))for(var u=tt.visualScenes[s].children,l=0;l<u.length;l++){var c=u[l];if("JOINT"===c.type)Le(Fe(c.id),t,a)}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",s)}for(n=0;n<t.length;n++)for(r=0;r<a.length;r++)if((i=a[r]).bone.name===t[n].name){o[n]=i,i.processed=!0;break}for(n=0;n<a.length;n++)!1===(i=a[n]).processed&&(o.push(i),i.processed=!0);var h=[],f=[];for(n=0;n<o.length;n++)i=o[n],h.push(i.bone),f.push(i.boneInverse);return new pC(h,f)}function Le(e,t,n){e.traverse((function(e){if(!0===e.isBone){for(var r,i=0;i<t.length;i++){var a=t[i];if(a.name===e.name){r=a.boneInverse;break}}void 0===r&&(r=new PS),n.push({bone:e,boneInverse:r,processed:!1})}}))}function De(e){for(var t,n=[],r=e.matrix,i=e.nodes,a=e.type,o=e.instanceCameras,s=e.instanceControllers,u=e.instanceLights,l=e.instanceGeometries,c=e.instanceNodes,h=0,f=i.length;h<f;h++)n.push(Fe(i[h]));for(var d=0,p=o.length;d<p;d++){var v=ne(o[d]);null!==v&&n.push(v.clone())}for(var m=0,g=s.length;m<g;m++)for(var y=s[m],b=L(y.id),_=Oe(pe(b.id),y.materials),x=Pe(y.skeletons,b.skin.joints),w=0,S=_.length;w<S;w++){var M=_[w];M.isSkinnedMesh&&(M.bind(x,b.skin.bindMatrix),M.normalizeSkinWeights()),n.push(M)}for(var k=0,T=u.length;k<T;k++){var E=oe(u[k]);null!==E&&n.push(E.clone())}for(var C=0,A=l.length;C<A;C++)for(var R=l[C],P=Oe(pe(R.id),R.materials),D=0,N=P.length;D<N;D++)n.push(P[D]);for(var I=0,O=c.length;I<O;I++)n.push(Fe(c[I]).clone());if(0===i.length&&1===n.length)t=n[0];else{t="JOINT"===a?new cC:new ZE;for(var U=0;U<n.length;U++)t.add(n[U])}return t.name="JOINT"===a?e.sid:e.name,t.matrix.copy(r),t.matrix.decompose(t.position,t.quaternion,t.scale),t}var Ne=new SM({color:16711935});function Ie(e,t){for(var n=[],r=0,i=e.length;r<i;r++){var a=t[e[r]];void 0===a?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",e[r]),n.push(Ne)):n.push(J(a))}return n}function Oe(e,t){var n=[];for(var r in e){var i=e[r],a=Ie(i.materialKeys,t);if(0===a.length&&("lines"===r||"linestrips"===r?a.push(new vC):a.push(new EC)),"lines"===r||"linestrips"===r)for(var o=0,s=a.length;o<s;o++){var u=a[o];if(!0===u.isMeshPhongMaterial||!0===u.isMeshLambertMaterial){var l=new vC;l.color.copy(u.color),l.opacity=u.opacity,l.transparent=u.transparent,a[o]=l}}var c=void 0!==i.data.attributes.skinIndex,h=1===a.length?a[0]:a,f=void 0;switch(r){case"lines":f=new MC(i.data,h);break;case"linestrips":f=new xC(i.data,h);break;case"triangles":case"polylist":f=c?new lC(i.data,h):new tk(i.data,h)}n.push(f)}return n}function Ue(e){return void 0!==tt.nodes[e]}function Fe(e){return f(tt.nodes[e],De)}function ze(e){var t=new ZE;t.name=e.name;for(var n=e.children,r=0;r<n.length;r++){var i=n[r];t.add(Fe(i.id))}return t}function Be(e){return void 0!==tt.visualScenes[e]}function Ve(e){return f(tt.visualScenes[e],ze)}if(0===e.length)return{scene:new nC};var Ge=(new DOMParser).parseFromString(e,"application/xml"),je=n(Ge,"COLLADA")[0],He=Ge.getElementsByTagName("parsererror")[0];if(void 0!==He){var We,Ze=n(He,"div")[0];return We=Ze?Ze.textContent:function(e){for(var t="",n=[e];n.length;){var r=n.shift();r.nodeType===Node.TEXT_NODE?t+=r.textContent:(t+="\n",n.push.apply(n,r.childNodes))}return t.trim()}(He),console.error("THREE.ColladaLoader: Failed to parse collada file.\n",We),null}var qe=je.getAttribute("version");console.debug("THREE.ColladaLoader: File version",qe);var Xe,Ye=function(e){return{unit:u(n(e,"unit")[0]),upAxis:l(n(e,"up_axis")[0])}}(n(je,"asset")[0]),Ke=new iA(this.manager);Ke.setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin),RA&&(Xe=new RA(this.manager)).setPath(this.resourcePath||t);var Je=new xM,Qe=[],$e={},et=0,tt={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};c(je,"library_animations","animation",(function e(t){for(var n={sources:{},samplers:{},channels:{}},r=!1,i=0,a=t.childNodes.length;i<a;i++){var o=t.childNodes[i];if(1===o.nodeType){var s=void 0;switch(o.nodeName){case"source":s=o.getAttribute("id"),n.sources[s]=se(o);break;case"sampler":s=o.getAttribute("id"),n.samplers[s]=d(o);break;case"channel":s=o.getAttribute("target"),n.channels[s]=p(o);break;case"animation":e(o),r=!0;break;default:console.log(o)}}}!1===r&&(tt.animations[t.getAttribute("id")||Aw.generateUUID()]=n)})),c(je,"library_animation_clips","animation_clip",(function(e){for(var t={name:e.getAttribute("id")||"default",start:parseFloat(e.getAttribute("start")||0),end:parseFloat(e.getAttribute("end")||0),animations:[]},n=0,r=e.childNodes.length;n<r;n++){var i=e.childNodes[n];if(1===i.nodeType&&"instance_animation"===i.nodeName)t.animations.push(o(i.getAttribute("url")))}tt.clips[e.getAttribute("id")]=t})),c(je,"library_controllers","controller",(function(e){for(var t={},n=0,r=e.childNodes.length;n<r;n++){var i=e.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"skin":t.id=o(i.getAttribute("source")),t.skin=C(i);break;case"morph":t.id=o(i.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.")}}tt.controllers[e.getAttribute("id")]=t})),c(je,"library_images","image",(function(e){var t={init_from:n(e,"init_from")[0].textContent};tt.images[e.getAttribute("id")]=t})),c(je,"library_effects","effect",(function(e){for(var t={},n=0,r=e.childNodes.length;n<r;n++){var i=e.childNodes[n];if(1===i.nodeType&&"profile_COMMON"===i.nodeName)t.profile=I(i)}tt.effects[e.getAttribute("id")]=t})),c(je,"library_materials","material",(function(e){for(var t={name:e.getAttribute("name")},n=0,r=e.childNodes.length;n<r;n++){var i=e.childNodes[n];if(1===i.nodeType&&"instance_effect"===i.nodeName)t.url=o(i.getAttribute("url"))}tt.materials[e.getAttribute("id")]=t})),c(je,"library_cameras","camera",(function(e){for(var t={name:e.getAttribute("name")},n=0,r=e.childNodes.length;n<r;n++){var i=e.childNodes[n];if(1===i.nodeType&&"optics"===i.nodeName)t.optics=Q(i)}tt.cameras[e.getAttribute("id")]=t})),c(je,"library_lights","light",(function(e){for(var t={},n=0,r=e.childNodes.length;n<r;n++){var i=e.childNodes[n];if(1===i.nodeType&&"technique_common"===i.nodeName)t=re(i)}tt.lights[e.getAttribute("id")]=t})),c(je,"library_geometries","geometry",(function(e){var t={name:e.getAttribute("name"),sources:{},vertices:{},primitives:[]},r=n(e,"mesh")[0];if(void 0!==r){for(var i=0;i<r.childNodes.length;i++){var a=r.childNodes[i];if(1===a.nodeType){var o=a.getAttribute("id");switch(a.nodeName){case"source":t.sources[o]=se(a);break;case"vertices":t.vertices=ue(a);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",a.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":t.primitives.push(le(a));break;default:console.log(a)}}}tt.geometries[e.getAttribute("id")]=t}})),c(je,"library_nodes","node",Ae),c(je,"library_visual_scenes","visual_scene",(function(e){var t={name:e.getAttribute("name"),children:[]};!function(e){for(var t=e.getElementsByTagName("node"),n=0;n<t.length;n++){var r=t[n];!1===r.hasAttribute("id")&&r.setAttribute("id","three_default_"+et++)}}(e);for(var r=n(e,"node"),i=0;i<r.length;i++)t.children.push(Ae(r[i]));tt.visualScenes[e.getAttribute("id")]=t})),c(je,"library_kinematics_models","kinematics_model",(function(e){for(var t={name:e.getAttribute("name")||"",joints:{},links:[]},n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];if(1===r.nodeType&&"technique_common"===r.nodeName)me(r,t)}tt.kinematicsModels[e.getAttribute("id")]=t})),c(je,"library_physics_models","physics_model",(function(e){for(var t={name:e.getAttribute("name")||"",rigidBodies:{}},n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];if(1===r.nodeType&&"rigid_body"===r.nodeName)t.rigidBodies[r.getAttribute("name")]={},we(r,t.rigidBodies[r.getAttribute("name")])}tt.physicsModels[e.getAttribute("id")]=t})),c(je,"scene","instance_kinematics_scene",(function(e){for(var t={bindJointAxis:[]},n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];if(1===r.nodeType&&"bind_joint_axis"===r.nodeName)t.bindJointAxis.push(Me(r))}tt.kinematicsScenes[o(e.getAttribute("url"))]=t})),h(tt.animations,v),h(tt.clips,T),h(tt.controllers,P),h(tt.images,D),h(tt.effects,X),h(tt.materials,K),h(tt.cameras,te),h(tt.lights,ae),h(tt.geometries,he),h(tt.visualScenes,ze),function(){var e=tt.clips;if(!0===s(e)){if(!1===s(tt.animations)){var t=[];for(var n in tt.animations)for(var r=m(n),i=0,a=r.length;i<a;i++)t.push(r[i]);Qe.push(new qC("default",-1,t))}}else for(var o in e)Qe.push(E(o))}(),function(){var e=Object.keys(tt.kinematicsModels)[0],t=Object.keys(tt.kinematicsScenes)[0],n=Object.keys(tt.visualScenes)[0];if(void 0!==e&&void 0!==t){for(var r=function(e){return f(tt.kinematicsModels[e],ve)}(e),i=function(e){return f(tt.kinematicsScenes[e],ke)}(t),a=Ve(n),o=i.bindJointAxis,s={},u=0,l=o.length;u<l;u++){var c=o[u],h=je.querySelector('[sid="'+c.target+'"]');if(h){var d=h.parentElement;v(c.jointIndex,d)}}var p=new PS;$e={joints:r&&r.joints,getJointValue:function(e){var t=s[e];if(t)return t.position;console.warn("THREE.ColladaLoader: Joint "+e+" doesn't exist.")},setJointValue:function(e,t){var n=s[e];if(n){var r=n.joint;if(t>r.limits.max||t<r.limits.min)console.warn("THREE.ColladaLoader: Joint "+e+" value "+t+" outside of limits (min: "+r.limits.min+", max: "+r.limits.max+").");else if(r.static)console.warn("THREE.ColladaLoader: Joint "+e+" is static.");else{var i=n.object,a=r.axis,o=n.transforms;Ee.identity();for(var u=0;u<o.length;u++){var l=o[u];if(l.sid&&-1!==l.sid.indexOf(e))switch(r.type){case"revolute":Ee.multiply(p.makeRotationAxis(a,Aw.degToRad(t)));break;case"prismatic":Ee.multiply(p.makeTranslation(a.x*t,a.y*t,a.z*t));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+r.type)}else switch(l.type){case"matrix":Ee.multiply(l.obj);break;case"translate":Ee.multiply(p.makeTranslation(l.obj.x,l.obj.y,l.obj.z));break;case"scale":Ee.scale(l.obj);break;case"rotate":Ee.multiply(p.makeRotationAxis(l.obj,l.angle))}}i.matrix.copy(Ee),i.matrix.decompose(i.position,i.quaternion,i.scale),s[e].position=t}}else console.log("THREE.ColladaLoader: "+e+" does not exist.")}}}function v(e,t){var n=t.getAttribute("name"),i=r.joints[e];a.traverse((function(r){r.name===n&&(s[e]={object:r,transforms:Te(t),joint:i,position:i.zeroPosition})}))}}();var nt=function(e){return Ve(o(n(e,"instance_visual_scene")[0].getAttribute("url")))}(n(je,"scene")[0]);return nt.animations=Qe,"Z_UP"===Ye.upAxis&&(console.warn("THREE.ColladaLoader: You are loading an asset with a Z-UP coordinate system. The loader just rotates the asset to transform it into Y-UP. The vertex data are not converted, see #24289."),nt.rotation.set(-Math.PI/2,0,0)),nt.scale.multiplyScalar(Ye.unit),{get animations(){return console.warn("THREE.ColladaLoader: Please access animations over scene.animations now."),Qe},kinematics:$e,library:tt,scene:nt}}}]),n}(QC),LA=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;(0,u.Z)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).urdfNode=null,e.urdfName="",e}return(0,l.Z)(n,[{key:"copy",value:function(e,t){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e,t),this.urdfNode=e.urdfNode,this.urdfName=e.urdfName,this}}]),n}(nM),DA=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;(0,u.Z)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).isURDFCollider=!0,e.type="URDFCollider",e}return(0,l.Z)(n)}(LA),NA=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;(0,u.Z)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).isURDFVisual=!0,e.type="URDFVisual",e}return(0,l.Z)(n)}(LA),IA=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;(0,u.Z)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).isURDFLink=!0,e.type="URDFLink",e}return(0,l.Z)(n)}(LA),OA=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;(0,u.Z)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).isURDFJoint=!0,e.type="URDFJoint",e.jointValue=null,e.jointType="fixed",e.axis=new tS(1,0,0),e.limit={lower:0,upper:0},e.ignoreLimits=!1,e.origPosition=null,e.origQuaternion=null,e.mimicJoints=[],e}return(0,l.Z)(n,[{key:"jointType",get:function(){return this._jointType},set:function(e){if(this.jointType!==e)switch(this._jointType=e,this.matrixWorldNeedsUpdate=!0,e){case"fixed":this.jointValue=[];break;case"continuous":case"revolute":case"prismatic":this.jointValue=new Array(1).fill(0);break;case"planar":this.jointValue=new Array(2).fill(0);break;case"floating":this.jointValue=new Array(6).fill(0)}}},{key:"angle",get:function(){return this.jointValue[0]}},{key:"copy",value:function(e,t){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e,t),this.jointType=e.jointType,this.axis=e.axis.clone(),this.limit.lower=e.limit.lower,this.limit.upper=e.limit.upper,this.ignoreLimits=!1,this.jointValue=cr(e.jointValue),this.origPosition=e.origPosition?e.origPosition.clone():null,this.origQuaternion=e.origQuaternion?e.origQuaternion.clone():null,this.mimicJoints=cr(e.mimicJoints),this}},{key:"setJointValue",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t=t.map((function(e){return parseFloat(e)})),this.origPosition&&this.origQuaternion||(this.origPosition=this.position.clone(),this.origQuaternion=this.quaternion.clone());var r=!1;switch(this.mimicJoints.forEach((function(e){r=e.updateFromMimickedJoint.apply(e,cr(t))||r})),this.jointType){case"fixed":return r;case"continuous":case"revolute":var i=t[0];return null==i||i===this.jointValue[0]?r:(this.ignoreLimits||"revolute"!==this.jointType||(i=Math.min(this.limit.upper,i),i=Math.max(this.limit.lower,i)),this.quaternion.setFromAxisAngle(this.axis,i).premultiply(this.origQuaternion),this.jointValue[0]!==i?(this.jointValue[0]=i,this.matrixWorldNeedsUpdate=!0,!0):r);case"prismatic":var a=t[0];return null==a||a===this.jointValue[0]?r:(this.ignoreLimits||(a=Math.min(this.limit.upper,a),a=Math.max(this.limit.lower,a)),this.position.copy(this.origPosition),this.position.addScaledVector(this.axis,a),this.jointValue[0]!==a?(this.jointValue[0]=a,this.matrixWorldNeedsUpdate=!0,!0):r);case"floating":case"planar":console.warn("'".concat(this.jointType,"' joint not yet supported"))}return r}}]),n}(LA),UA=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;(0,u.Z)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).type="URDFMimicJoint",e.mimicJoint=null,e.offset=0,e.multiplier=1,e}return(0,l.Z)(n,[{key:"updateFromMimickedJoint",value:function(){for(var e,t=this,r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];var o=i.map((function(e){return e*t.multiplier+t.offset}));return(e=wr((0,_r.Z)(n.prototype),"setJointValue",this)).call.apply(e,[this].concat(cr(o)))}},{key:"copy",value:function(e,t){return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e,t),this.mimicJoint=e.mimicJoint,this.offset=e.offset,this.multiplier=e.multiplier,this}}]),n}(OA),FA=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;(0,u.Z)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).isURDFRobot=!0,e.urdfNode=null,e.urdfRobotNode=null,e.robotName=null,e.links=null,e.joints=null,e.colliders=null,e.visual=null,e.frames=null,e}return(0,l.Z)(n,[{key:"copy",value:function(e,t){var r=this;return wr((0,_r.Z)(n.prototype),"copy",this).call(this,e,t),this.urdfRobotNode=e.urdfRobotNode,this.robotName=e.robotName,this.links={},this.joints={},this.colliders={},this.visual={},this.traverse((function(t){t.isURDFJoint&&t.urdfName in e.joints&&(r.joints[t.urdfName]=t),t.isURDFLink&&t.urdfName in e.links&&(r.links[t.urdfName]=t),t.isURDFCollider&&t.urdfName in e.colliders&&(r.colliders[t.urdfName]=t),t.isURDFVisual&&t.urdfName in e.visual&&(r.visual[t.urdfName]=t)})),this.frames=Mr(Mr(Mr(Mr({},this.colliders),this.visual),this.links),this.joints),this}},{key:"getFrame",value:function(e){return this.frames[e]}},{key:"setJointValue",value:function(e){var t=this.joints[e];if(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return t.setJointValue.apply(t,r)}return!1}},{key:"setJointValues",value:function(e){var t=!1;for(var n in e){var r=e[n];t=Array.isArray(r)?this.setJointValue.apply(this,[n].concat(cr(r)))||t:this.setJointValue(n,r)||t}return t}}]),n}(IA),zA=new eS,BA=new VS;function VA(e){return e?e.trim().split(/\s+/g).map((function(e){return parseFloat(e)})):[0,0,0]}function GA(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n||e.rotation.set(0,0,0),BA.set(t[0],t[1],t[2],"ZYX"),zA.setFromEuler(BA),zA.multiply(e.quaternion),e.quaternion.copy(zA)}var jA=function(){function e(t){(0,u.Z)(this,e),this.manager=t||JC,this.loadMeshCb=this.defaultMeshLoader.bind(this),this.parseVisual=!0,this.parseCollision=!1,this.packages="",this.workingPath="",this.fetchOptions={}}return(0,l.Z)(e,[{key:"loadAsync",value:function(e){var t=this;return new Promise((function(n,r){t.load(e,n,null,r)}))}},{key:"load",value:function(e,t,n,r){var i=this,a=this.manager,o=_A.extractUrlBase(e),s=this.manager.resolveURL(e);a.itemStart(s),fetch(s,this.fetchOptions).then((function(e){if(e.ok)return n&&n(null),e.text();throw new Error("URDFLoader: Failed to load url '".concat(s,"' with error code ").concat(e.status," : ").concat(e.statusText,"."))})).then((function(e){""===i.workingPath&&(i.workingPath=o);var n=i.parse(e);t(n),a.itemEnd(s)})).catch((function(e){r?r(e):console.error("URDFLoader: Error loading file.",e),a.itemError(s),a.itemEnd(s)}))}},{key:"parse",value:function(e){var t=this.packages,n=this.loadMeshCb,r=this.parseVisual,i=this.parseCollision,a=this.workingPath,o=this.manager,s={},u={},l={};function c(e){if(!/^package:\/\//.test(e))return a?a+e:e;var n=vr(e.replace(/^package:\/\//,"").split(/\/(.+)/),2),r=n[0],i=n[1];return"string"===typeof t?t.endsWith(r)?t+"/"+i:t+"/"+r+"/"+i:t instanceof Function?t(r)+"/"+i:"object"===typeof t?r in t?t[r]+"/"+i:(console.error("URDFLoader : ".concat(r," not found in provided package list.")),null):void 0}function h(e){var t=cr(e.children),n=new EC;return n.name=e.getAttribute("name")||"",t.forEach((function(e){var t=e.nodeName.toLowerCase();if("color"===t){var r=e.getAttribute("rgba").split(/\s/g).map((function(e){return parseFloat(e)}));n.color.setRGB(r[0],r[1],r[2]),n.opacity=r[3],n.transparent=r[3]<1,n.depthWrite=!n.transparent}else if("texture"===t){var i=e.getAttribute("filename");if(i){var a=new iA(o),s=c(i);n.map=a.load(s),n.map.colorSpace=uw}}})),n}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r="collision"===e.nodeName.toLowerCase(),i=cr(e.children),a=null,s=i.filter((function(e){return"material"===e.nodeName.toLowerCase()}))[0];if(s){var u=s.getAttribute("name");a=u&&u in t?t[u]:h(s)}else a=new EC;var l=r?new DA:new NA;return l.urdfNode=e,i.forEach((function(e){var t=e.nodeName.toLowerCase();if("geometry"===t){var r=e.children[0].nodeName.toLowerCase();if("mesh"===r){var i=c(e.children[0].getAttribute("filename"));if(null!==i){var s=e.children[0].getAttribute("scale");if(s){var u=VA(s);l.scale.set(u[0],u[1],u[2])}n(i,o,(function(e,t){t?console.error("URDFLoader: Error loading mesh.",t):e&&(e instanceof tk&&(e.material=a),e.position.set(0,0,0),e.quaternion.identity(),l.add(e))}))}}else if("box"===r){var h=new tk;h.geometry=new rk(1,1,1),h.material=a;var f=VA(e.children[0].getAttribute("size"));h.scale.set(f[0],f[1],f[2]),l.add(h)}else if("sphere"===r){var d=new tk;d.geometry=new TC(1,30,30),d.material=a;var p=parseFloat(e.children[0].getAttribute("radius"))||0;d.scale.set(p,p,p),l.add(d)}else if("cylinder"===r){var v=new tk;v.geometry=new kC(1,1,1,30),v.material=a;var m=parseFloat(e.children[0].getAttribute("radius"))||0,g=parseFloat(e.children[0].getAttribute("length"))||0;v.scale.set(m,g,m),v.rotation.set(Math.PI/2,0,0),l.add(v)}}else if("origin"===t){var y=VA(e.getAttribute("xyz")),b=VA(e.getAttribute("rpy"));l.position.set(y[0],y[1],y[2]),l.rotation.set(0,0,0),GA(l,b)}})),l}return function(e){var t;if(e instanceof Document)t=cr(e.children);else if(e instanceof Element)t=[e];else{t=cr((new DOMParser).parseFromString(e,"text/xml").children)}var n=t.filter((function(e){return"robot"===e.nodeName})).pop();return function(e){var t=cr(e.children),n=t.filter((function(e){return"link"===e.nodeName.toLowerCase()})),a=t.filter((function(e){return"joint"===e.nodeName.toLowerCase()})),o=t.filter((function(e){return"material"===e.nodeName.toLowerCase()})),c=new FA;c.robotName=e.getAttribute("name"),c.urdfRobotNode=e,o.forEach((function(e){var t=e.getAttribute("name");l[t]=h(e)}));var d={},p={};n.forEach((function(t){var n=t.getAttribute("name"),a=null===e.querySelector('child[link="'.concat(n,'"]'));s[n]=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;null===a&&(a=new IA);var o=cr(e.children);if(a.name=e.getAttribute("name"),a.urdfName=a.name,a.urdfNode=e,r){o.filter((function(e){return"visual"===e.nodeName.toLowerCase()})).forEach((function(e){var n=f(e,l);if(a.add(n),e.hasAttribute("name")){var r=e.getAttribute("name");n.name=r,n.urdfName=r,t[r]=n}}))}if(i){o.filter((function(e){return"collision"===e.nodeName.toLowerCase()})).forEach((function(e){var t=f(e);if(a.add(t),e.hasAttribute("name")){var r=e.getAttribute("name");t.name=r,t.urdfName=r,n[r]=t}}))}return a}(t,d,p,a?c:null)})),a.forEach((function(e){var t=e.getAttribute("name");u[t]=function(e){var t,n=cr(e.children),r=e.getAttribute("type"),i=n.find((function(e){return"mimic"===e.nodeName.toLowerCase()}));i?((t=new UA).mimicJoint=i.getAttribute("joint"),t.multiplier=parseFloat(i.getAttribute("multiplier")||1),t.offset=parseFloat(i.getAttribute("offset")||0)):t=new OA;t.urdfNode=e,t.name=e.getAttribute("name"),t.urdfName=t.name,t.jointType=r;var a=null,o=null,u=[0,0,0],l=[0,0,0];n.forEach((function(e){var n=e.nodeName.toLowerCase();"origin"===n?(u=VA(e.getAttribute("xyz")),l=VA(e.getAttribute("rpy"))):"child"===n?o=s[e.getAttribute("link")]:"parent"===n?a=s[e.getAttribute("link")]:"limit"===n&&(t.limit.lower=parseFloat(e.getAttribute("lower")||t.limit.lower),t.limit.upper=parseFloat(e.getAttribute("upper")||t.limit.upper))})),a.add(t),t.add(o),GA(t,l),t.position.set(u[0],u[1],u[2]);var c=n.filter((function(e){return"axis"===e.nodeName.toLowerCase()}))[0];if(c){var h=c.getAttribute("xyz").split(/\s+/g).map((function(e){return parseFloat(e)}));t.axis=new tS(h[0],h[1],h[2]),t.axis.normalize()}return t}(e)})),c.joints=u,c.links=s,c.colliders=p,c.visual=d;var v=Object.values(u);return v.forEach((function(e){e instanceof UA&&u[e.mimicJoint].mimicJoints.push(e)})),v.forEach((function(e){var t=new Set,n=function e(n){if(t.has(n))throw new Error("URDFLoader: Detected an infinite loop of mimic joints.");t.add(n),n.mimicJoints.forEach((function(t){e(t)}))};n(e)})),c.frames=Mr(Mr(Mr(Mr({},p),d),s),u),c}(n)}(e)}},{key:"defaultMeshLoader",value:function(e,t,n){if(/\.stl$/i.test(e))new AA(t).load(e,(function(e){var t=new tk(e,new EC);n(t)}));else if(/\.dae$/i.test(e)){new PA(t).load(e,(function(e){return n(e.scene)}))}else if(/\.stlX$/i.test(e)){new AA(t).load(e.replace(".stlX",""),(function(e){var t=new tk(e,new EC);n(t)}))}else if(/\.daeX$/i.test(e)){new PA(t).load(e.replace(".daeX",""),(function(e){return n(e.scene)}))}else console.warn("URDFLoader: Could not load model at ".concat(e,".\nNo loader available"))}}]),e}(),HA={NODE_ENV:"production",PUBLIC_URL:"/MotionComparator",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_GOOGLE_API_KEY;"string"===typeof HA&&(HA=HA.trim());var WA,ZA,qA,XA,YA,KA=HA,JA="https://docs.google.com/spreadsheets/d/";function QA(e,t,n){return("boolean"===typeof n||n&&n.length>0)&&(e="".concat(e).concat(t).concat(n)),e}function $A(e,t){return eR.apply(this,arguments)}function eR(){return eR=pr(fr().mark((function e(t,n){var r,i,a,o,u,l,c,h,f=arguments;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=f.length>2&&void 0!==f[2]&&f[2],i="https://sheets.googleapis.com/v4/spreadsheets/".concat(t),i=QA(i+="?key=".concat(KA),"&includeGridData=",r),n){a=s(n);try{for(a.s();!(o=a.n()).done;)u=o.value,i=QA(i,"&ranges=",u.toA1())}catch(d){a.e(d)}finally{a.f()}}return e.next=7,fetch(i);case 7:if((l=e.sent).ok){e.next=18;break}return e.t0=fR,e.next=12,l.blob();case 12:return e.t1=e.sent,e.next=15,(0,e.t0)(e.t1);case 15:throw c=e.sent,console.error("There was an error in the Google Sheets batchGet response. Response error as Text: ".concat(c)),new Error("Error fetching GSheet");case 18:return e.next=20,l.json();case 20:return h=e.sent,e.abrupt("return",h);case 22:case"end":return e.stop()}}),e)}))),eR.apply(this,arguments)}function tR(e,t){return nR.apply(this,arguments)}function nR(){return nR=pr(fr().mark((function e(t,n){var r,i,a,o,u,l,c,h,f,d,p,v,m,g,y,b,_,x,w,S,M,k,T,E,C=arguments;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=C.length>2&&void 0!==C[2]?C[2]:WA.ROWS,i=C.length>3&&void 0!==C[3]?C[3]:ZA.FORMATTED_VALUE,a=C.length>4&&void 0!==C[4]?C[4]:qA.FORMATTED_STRING,o=C.length>5?C[5]:void 0,u="https://sheets.googleapis.com/v4/spreadsheets/".concat(t,"/values:batchGet"),u=QA(u+="?key=".concat(KA),"&majorDimension=",r),u=QA(u,"&valueRenderOption=",i),u=QA(u,"&dateTimeRenderOption=",a),void 0!==o){e.next=16;break}return o=[],e.next=13,$A(t);case 13:l=e.sent,c=s(l.sheets);try{for(c.s();!(h=c.n()).done;)f=h.value,d=f.properties.title,o.push(d)}catch(A){c.e(A)}finally{c.f()}case 16:if(void 0===n){n=[],p=s(o);try{for(p.s();!(v=p.n()).done;)m=v.value,n.push(new sR(m))}catch(A){p.e(A)}finally{p.f()}}else{g=[],y=s(n);try{for(y.s();!(b=y.n()).done;)_=b.value,void 0!==(x=_.sheetName())&&-1===o.indexOf(x)||g.push(_)}catch(A){y.e(A)}finally{y.f()}n=g}if(n){w=s(n);try{for(w.s();!(S=w.n()).done;)M=S.value,u=QA(u,"&ranges=",M.toA1())}catch(A){w.e(A)}finally{w.f()}}return e.next=20,fetch(u);case 20:if((k=e.sent).ok){e.next=31;break}return e.t0=fR,e.next=25,k.blob();case 25:return e.t1=e.sent,e.next=28,(0,e.t0)(e.t1);case 28:throw T=e.sent,console.error("There was an error in the Google Sheets batchGet response. Response error as Text: ".concat(T)),new Error("Error fetching GSheet");case 31:return e.next=33,k.json();case 33:return E=e.sent,e.abrupt("return",E);case 35:case"end":return e.stop()}}),e)}))),nR.apply(this,arguments)}function rR(e){return(e=e.trim().replace("\\","/")).startsWith("https://docs.google.com/")}function iR(e){if(!function(e){return(e=e.trim().replace("\\","/")).startsWith(JA)}(e=e.trim().replace("\\","/")))throw new d.AssertionError({message:"URL ".concat(e," is not a url to a google spreadsheet.")});return e.slice(JA.length,e.length).split("/")[0]}void 0===KA&&console.warn("Google API key not found: Google-related functionalities will not be supported."),function(e){e.DIMENSION_UNSPECIFIED="DIMENSION_UNSPECIFIED",e.ROWS="ROWS",e.COLUMNS="COLUMNS"}(WA||(WA={})),function(e){e.FORMATTED_VALUE="FORMATTED_VALUE",e.UNFORMATTED_VALUE="UNFORMATTED_VALUE",e.FORMULA="FORMULA"}(ZA||(ZA={})),function(e){e.SERIAL_NUMBER="SERIAL_NUMBER",e.FORMATTED_STRING="FORMATTED_STRING"}(qA||(qA={})),function(e){e.RECALCULATION_INTERVAL_UNSPECIFIED="RECALCULATION_INTERVAL_UNSPECIFIED",e.ON_CHANGE="ON_CHANGE",e.MINUTE="MINUTE",e.HOUR="HOUR"}(XA||(XA={})),function(e){e.SHEET_TYPE_UNSPECIFIED="SHEET_TYPE_UNSPECIFIED",e.GRID="GRID",e.OBJECT="OBJECT",e.DATA_SOURCE="DATA_SOURCE"}(YA||(YA={}));function aR(e,t){e&&e<0&&(e=0),t&&t<0&&(t=0);var n="";return void 0!==t&&null!==t&&(n+=function(e){e<0&&(e=0);for(var t=[],n=e;n>=0;)t.unshift(String.fromCharCode(n%26+"A".charCodeAt(0))),n=Math.floor(n/26)-1;return t.join("")}(t)),void 0!==e&&null!==e&&(n+=e+1),n}function oR(e){var t,n,r,i,a=e.trim().toUpperCase().match(/([A-Z]+)([0-9]+)/);if(null===a)t="",n=e;else{var o=vr(a,3);t=o[1],n=o[2]}return i=0===t.length?null:function(e){var t,n=0,r=s(e.split(""));try{for(r.s();!(t=r.n()).done;){var i=t.value;n*=26,n+=i.charCodeAt(0)-"A".charCodeAt(0)+1}}catch(a){r.e(a)}finally{r.f()}return n-1}(t),0===n.length?r=null:(r=parseFloat(n),isNaN(r)&&(r=null)),null!==r&&r--,[r,i]}var sR=function(){function e(t,n,r,i,a){(0,u.Z)(this,e),this._rowStart=void 0,this._rowEnd=void 0,this._colStart=void 0,this._colEnd=void 0,this._sheetName=void 0,this.setSheetName(t),this.setRowStart(n),this.setRowEnd(r),this.setColStart(i),this.setColEnd(a)}return(0,l.Z)(e,[{key:"equalTo",value:function(e){return this._sheetName===e._sheetName&&this._rowStart===e._rowStart&&this._rowEnd===e._rowEnd&&this._colStart===e._colStart&&this._colEnd===e._colEnd}},{key:"valid",value:function(e){if(void 0!==e)return e<0&&(e=0),e}},{key:"sheetName",value:function(){return this._sheetName}},{key:"setSheetName",value:function(e){this._sheetName=e}},{key:"rowStart",value:function(){return this._rowStart}},{key:"setRowStart",value:function(e){this._rowStart=this.valid(e)}},{key:"colStart",value:function(){return this._colStart}},{key:"setColStart",value:function(e){this._colStart=this.valid(e)}},{key:"rowEnd",value:function(){return this._rowEnd}},{key:"setRowEnd",value:function(e){this._rowEnd=this.valid(e)}},{key:"colEnd",value:function(){return this._colEnd}},{key:"setColEnd",value:function(e){this._colEnd=this.valid(e)}},{key:"clone",value:function(){return new e(this.sheetName(),this.rowStart(),this.rowEnd(),this.colStart(),this.colEnd())}},{key:"toA1",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=[this._rowStart,this._rowEnd,this._colStart,this._colEnd],n=t[0],r=t[1],i=t[2],a=t[3];if(void 0!==n&&void 0!==r){var o=n,s=r;n=Math.min(o,s),r=Math.max(o,s)}if(void 0!==i&&void 0!==a){var u=i,l=a;i=Math.min(u,l),a=Math.max(u,l)}var c=aR(n,i),h=aR(r,a),f="".concat(c,":").concat(h);return":"===f&&(f=""),e&&void 0!==this._sheetName&&(f=f.length>0?"".concat(this._sheetName,"!").concat(f):"".concat(this._sheetName)),f}}],[{key:"fromA1",value:function(t){var n,r,i,a,o;t=t.trim();var s,u,l,c,h,f=new e;h=f.sheetName();var d=[f.rowStart(),f.rowEnd()];s=d[0],u=d[1];var p=[f.colStart(),f.colEnd()];if(l=p[0],c=p[1],-1!==t.indexOf("!")){var v,m=vr(t.split("!"),2);if(h=m[0],v=m[1],h=h.trim(),-1!==v.indexOf(":")){var g=vr(v.split(":"),2),y=g[0],b=g[1],_=vr(oR(y),2);s=_[0],l=_[1];var x=vr(oR(b),2);u=x[0],c=x[1]}else{var w=vr(oR(v),2);s=w[0],l=w[1]}}else if(-1!==t.indexOf(":")){var S=vr(t.split(":"),2),M=S[0],k=S[1],T=vr(oR(M),2);s=T[0],l=T[1];var E=vr(oR(k),2);u=E[0],c=E[1]}else h=t.trim();return f.setSheetName(null!==(n=h)&&void 0!==n?n:void 0),f.setRowStart(null!==(r=s)&&void 0!==r?r:void 0),f.setColStart(null!==(i=l)&&void 0!==i?i:void 0),f.setRowEnd(null!==(a=u)&&void 0!==a?a:void 0),f.setColEnd(null!==(o=c)&&void 0!==o?o:void 0),f}}]),e}();function uR(e){return lR.apply(this,arguments)}function lR(){return lR=pr(fr().mark((function e(t){var n,r,i,a,o,u,l,c,h,f,p,v,m,g,y,b,_,x,w,S,M;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.spreadsheetId,r=t.ranges,e.next=3,$A(n);case 3:i=e.sent,a=[],o=s(i.sheets);try{for(o.s();!(u=o.n()).done;)l=u.value,a.push(l.properties.title)}catch(k){o.e(k)}finally{o.f()}return e.next=9,tR(n,r,WA.ROWS,ZA.FORMATTED_VALUE,qA.FORMATTED_STRING,a);case 9:if((c=e.sent).spreadsheetId===n){e.next=12;break}throw new d.AssertionError({message:'Spreadsheet data returned from gSheetsBatchGet method (with spreadsheet id:"'.concat(c.spreadsheetId,'") was not from the same spreadsheet as the one requested by loadGoogleSheetsData (spreadsheet id "').concat(n,'")')});case 12:h=c.valueRanges,f=new Map,p=s(h);try{for(p.s();!(v=p.n()).done;)m=v.value,g=sR.fromA1(m.range),y=g.sheetName(),void 0===(b=f.get(y))&&(b={title:y,data:[]},f.set(y,b)),m.values&&b.data.push({range:g,data:m.values})}catch(k){p.e(k)}finally{p.f()}_=[],x=s(f.values());try{for(x.s();!(w=x.n()).done;)S=w.value,_.push(S)}catch(k){x.e(k)}finally{x.f()}return M={id:n,title:i.properties.title,sheets:_},e.abrupt("return",M);case 21:case"end":return e.stop()}}),e)}))),lR.apply(this,arguments)}function cR(e,t){return hR.apply(this,arguments)}function hR(){return hR=pr(fr().mark((function e(t,n){var r,i;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,n);case 2:return r=e.sent,e.next=5,r.blob();case 5:return i=e.sent,e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)}))),hR.apply(this,arguments)}function fR(e){return dR.apply(this,arguments)}function dR(){return(dR=pr(fr().mark((function e(t){return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=new FileReader;r.onload=function(){e(r.result)},r.readAsText(t)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pR(e){return vR.apply(this,arguments)}function vR(){return vR=pr(fr().mark((function e(t){var n,r,i,a,o,u,l,c,h,f,p,v,m,g,y,b,_,x,w,S,M=arguments;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=M.length>1&&void 0!==M[1]&&M[1],rR(t=t.trim().replace("\\","/"))){e.next=4;break}throw new d.AssertionError({message:'URL "'.concat(t,'" does not appear to be from google sheets so it cannot be used to get a CSV.')});case 4:return r=iR(t),e.next=7,uR({spreadsheetId:r});case 7:if(i=e.sent,!n){e.next=15;break}a=[],o=s(i.sheets);try{for(o.s();!(u=o.n()).done;){l=u.value,c=s(Ib(l.data));try{for(c.s();!(h=c.n()).done;)f=vr(h.value,2),p=f[0],(v=f[1]).data&&(m="GoogleSheets_".concat(l.title),l.data.length>1&&(m+="_".concat(p+1)),a.push({name:m,csv:v.data}))}catch(k){c.e(k)}finally{c.f()}}}catch(k){o.e(k)}finally{o.f()}return e.abrupt("return",a);case 15:g=[],y=s(i.sheets);try{for(y.s();!(b=y.n()).done;){_=b.value,x=s(_.data);try{for(x.s();!(w=x.n()).done;)(S=w.value).data&&g.push(S.data)}catch(k){x.e(k)}finally{x.f()}}}catch(k){y.e(k)}finally{y.f()}return e.abrupt("return",g);case 19:case"end":return e.stop()}}),e)}))),vR.apply(this,arguments)}function mR(e){return gR.apply(this,arguments)}function gR(){return gR=pr(fr().mark((function e(t){var n,r,i,a,o,s,u=arguments;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=u.length>1&&void 0!==u[1]&&u[1],!(t=t.trim()).startsWith("https://docs.google.com/spreadsheets/d/")){e.next=10;break}if(!n){e.next=7;break}return e.abrupt("return",pR(t,n));case 7:return e.abrupt("return",pR(t,n));case 8:e.next=24;break;case 10:return e.next=12,cR(t);case 12:return r=e.sent,e.next=15,fR(r);case 15:if(i=e.sent,a=Array.from(xb(i)),!n){e.next=23;break}return o=t.replace("\\","/").trim().split("/"),s=o[o.length-1],e.abrupt("return",[{name:s,csv:a}]);case 23:return e.abrupt("return",[a]);case 24:case"end":return e.stop()}}),e)}))),gR.apply(this,arguments)}function yR(e){return bR.apply(this,arguments)}function bR(){return(bR=pr(fr().mark((function e(t){var n;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:if(!e.sent.ok){e.next=10;break}return n=new Kb,e.next=7,new Promise((function(e,r){n.load(t,(function(t){e(t.scene)}),(function(){}),(function(){r('Could not load GLB from url "'.concat(t,'"'))}))}));case 7:return e.abrupt("return",e.sent);case 10:throw new Error('Bad response from url "'.concat(t,'" when trying to load GLB object'));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _R(e){return xR.apply(this,arguments)}function xR(){return xR=pr(fr().mark((function e(t){var n,r,i,a,o,u,l,c,h,f,d,p,v,m,g,y,b,_,x,w,S,M,k,T,E,C,A,R,P,L,D,N,I;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Map,e.next=3,cR(t);case 3:return r=e.sent,e.next=6,fR(r);case 6:if(i=e.sent,a=new DOMParser,o=a.parseFromString(i,"text/xml"),0!==(u=Array.from(o.getElementsByTagName("mesh"))).length){e.next=14;break}l=CR(i),e.next=56;break;case 14:c=[],h=[],f=s(u);try{for(f.s();!(d=f.n()).done;)p=d.value,v=p.attributes.filename.nodeValue,m=t.substring(0,t.lastIndexOf("/")),g=v.replace("package://",m+"/../../").replaceAll("#","%23"),c.push([v,g]),h.push(cR(g))}catch(O){f.e(O)}finally{f.f()}return e.next=20,Promise.all(h);case 20:y=e.sent,b=s(Ib(y)),e.prev=22,b.s();case 24:if((_=b.n()).done){e.next=47;break}if(x=vr(_.value,2),w=x[0],S=x[1],M=vr(c[w],2),k=M[0],T=M[1],E="",!/\.stl$/i.test(k)){e.next=36;break}E=".stlX",C=URL.createObjectURL(S),A=C.substring(C.lastIndexOf("/")+1).trim()+E,R=k,i=i.replace(R,A),e.next=45;break;case 36:if(!/\.dae$/i.test(k)){e.next=45;break}return E=".daeX",e.next=40,wR(S,n,T);case 40:P=e.sent,L=URL.createObjectURL(P),D=L.substring(L.lastIndexOf("/")+1).trim()+E,N=k,i=i.replace(N,D);case 45:e.next=24;break;case 47:e.next=52;break;case 49:e.prev=49,e.t0=e.catch(22),b.e(e.t0);case 52:return e.prev=52,b.f(),e.finish(52);case 55:l=CR(i);case 56:return I=URL.createObjectURL(l),e.next=59,new Promise((function(e,t){var n,r=new cb.LoadingManager,i=new jA(r);i.parseVisual=!0,i.parseCollision=!1,i.load(I,(function(e){n=e})),r.onLoad=function(){e(n)},r.onError=function(e){var n='Failed to load URDF from URL "'.concat(e,'".');lr.error(n),t(n)}}));case 59:return e.abrupt("return",e.sent);case 60:case"end":return e.stop()}}),e,null,[[22,49,52,55]])}))),xR.apply(this,arguments)}function wR(e,t,n){return SR.apply(this,arguments)}function SR(){return(SR=pr(fr().mark((function e(t,n,r){var i,a,o,u,l,c,h,f,d,p,v,m,g,y,b,_,x,w,S,M,k,T,E;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fR(t);case 2:for(i=e.sent,a=new DOMParser,o=a.parseFromString(i,"text/xml"),u=Array.from(o.getElementsByTagName("image")),l=[],c=0,h=u;c<h.length;c++)f=h[c],d=f.childNodes[1].innerHTML,p=r.substring(0,r.lastIndexOf("/")+1)+d,n.get(p)?n.get(p).newLink?i=i.replace(n.get(p).imageFile,n.get(p).newLink):l.push(p):(n.set(p,{imageFile:d}),l.push(p));if(0!==l.length){e.next=13;break}return v=CR(i),e.abrupt("return",v);case 13:m=[],g=s(l),e.prev=15,g.s();case 17:if((y=g.n()).done){e.next=28;break}return b=y.value,e.t0=m,e.t1=b,e.next=23,cR(b);case 23:e.t2=e.sent,e.t3=[e.t1,e.t2],e.t0.push.call(e.t0,e.t3);case 26:e.next=17;break;case 28:e.next=33;break;case 30:e.prev=30,e.t4=e.catch(15),g.e(e.t4);case 33:return e.prev=33,g.f(),e.finish(33);case 36:for(_=0,x=m;_<x.length;_++)w=vr(x[_],2),S=w[0],M=w[1],k=URL.createObjectURL(M),T=k.substring(k.lastIndexOf("/")+1).trim(),i=i.replace(n.get(S).imageFile,T),n.get(S).newLink=T;return E=CR(i),e.abrupt("return",E);case 39:case"end":return e.stop()}}),e,null,[[15,30,33,36]])})))).apply(this,arguments)}function MR(e){return kR.apply(this,arguments)}function kR(){return(kR=pr(fr().mark((function e(t){var n,r,i;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,cR(t);case 2:return n=e.sent,e.next=5,fR(n);case 5:return r=e.sent,i=JSON.parse(r),e.abrupt("return",i);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function TR(e){return ER.apply(this,arguments)}function ER(){return(ER=pr(fr().mark((function e(t){var n;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fR(t);case 2:return n=e.sent,e.abrupt("return",JSON.parse(n));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function CR(e){return new Blob([e],{type:"text/plain"})}function AR(e){var t,n,r,i,a,o=null!==(t=e.position)&&void 0!==t?t:{x:0,y:0,z:0},s=new cb.Vector3(null!==(n=o.x)&&void 0!==n?n:0,null!==(r=o.y)&&void 0!==r?r:0,null!==(i=o.z)&&void 0!==i?i:0),u=null!==(a=e.rotation)&&void 0!==a?a:{x:0,y:0,z:0,w:0},l=function(e,t){var n,r,i,a,o,s=new cb.Quaternion(null!==(n=e.x)&&void 0!==n?n:0,null!==(r=e.y)&&void 0!==r?r:0,null!==(i=e.z)&&void 0!==i?i:0,null!==(a=e.w)&&void 0!==a?a:0),u=new cb.Vector3,l=s.w*s.w;o=2*Math.acos(s.w),u.x=s.x/Math.max(Math.sqrt(1-l),1e-8),u.y=s.y/Math.max(Math.sqrt(1-l),1e-8),u.z=s.z/Math.max(Math.sqrt(1-l),1e-8);var c=new cb.Vector3;c.z=u.x,c.x=u.y,c.y=u.z;var h=new cb.Quaternion;h.setFromAxisAngle(c,o),s.copy(h);var f,d,p,v=t.clone(),m=v.x,g=v.y,y=v.z;v.y=y,v.z=g,v.x=m?-m:m;var b=new cb.Vector3(null!==(f=v.x)&&void 0!==f?f:0,null!==(d=v.y)&&void 0!==d?d:0,null!==(p=v.z)&&void 0!==p?p:0);return b.applyEuler(new cb.Euler(0,Math.PI/2,0)),v.x=b.x,v.y=b.y,v.z=b.z,[s,v]}(void 0===u.w?(new cb.Quaternion).setFromEuler(new cb.Euler(u.x,u.y,u.z)):new cb.Quaternion(u.x,u.y,u.z,u.w),s),c=vr(l,2),h=c[0],f=c[1];return e.rotation={x:h.x,y:h.y,z:h.z,w:h.w},e.position={x:f.x,y:f.y,z:f.z},e}var RR=new Map,PR={X_POS:["RPOSX","POS_X","X","X_POS"],Y_POS:["RPOSY","POS_Y","Y","Y_POS"],Z_POS:["RPOSZ","POS_Z","Z","Z_POS"],X_ROT:["RROTX","ROT_X","RX","QX","X_ROT"],Y_ROT:["RROTY","ROT_Y","RY","QY","Y_ROT"],Z_ROT:["RROTZ","ROT_Z","RZ","QZ","Z_ROT"],W_ROT:["RROTW","ROT_W","RW","QW","W_ROT"],X_SCL:["RSCLX","SCALE_X","X_SCALE","X_SCL"],Y_SCL:["RSCLY","SCALE_Y","Y_SCALE","Y_SCL"],Z_SCL:["RSCLZ","SCALE_Z","Z_SCALE","Z_SCL"]};for(var LR in PR){var DR,NR=s(PR[LR]);try{for(NR.s();!(DR=NR.n()).done;){var IR=DR.value;RR.set(IR,LR)}}catch(x2){NR.e(x2)}finally{NR.f()}}function OR(e,t,n){return e&&0!==e.length?t<=0?e[0]:t>=e.length-1?e[e.length-1]:e[t]:n}function UR(e){return lr.error("Failed to turn a CSV into an animation table: ".concat(e)),new d.AssertionError({message:"Failed to turn a CSV into an animation table: ".concat(e)})}var FR=function(){function e(t,n,r){(0,u.Z)(this,e),this._url=void 0,this._name=void 0,this._id=void 0,this._angleMap=void 0,this._descMap=void 0,this._timeTable=void 0,this._robotNames=void 0,this.fromGazebo=void 0,this._name=null!==t&&void 0!==t?t:"Unnamed Animation",this._name=this._name.trim(),this._id=new Yb(n),this._url=r,this._angleMap=new Map,this._descMap=new Map,this._timeTable=[],this._robotNames=new Set,this.fromGazebo=!1}return(0,l.Z)(e,[{key:"robotNames",value:function(){return this._robotNames}},{key:"setName",value:function(e){this._name=e,lr.updateUI()}},{key:"name",value:function(){return this._name}},{key:"id",value:function(){return this._id}},{key:"idValue",value:function(){return this._id.value()}},{key:"url",value:function(){return this._url}},{key:"frame",value:function(e,t){var n=this,r=function(e,r,i,a){var o=n._descMap.get("".concat(t).concat(e));if(void 0===o&&(o=n._descMap.get(e)),void 0!==o)return kb(OR(o,r,0),OR(o,i,0),a)},i=function(e){for(var r=[],i=0,a=["X_ROT","Y_ROT","Z_ROT","W_ROT"];i<a.length;i++){var o=a[i],s=void 0;if(void 0!==t&&(s=n._descMap.get("".concat(t).concat(o))),void 0===s&&(s=n._descMap.get(o)),void 0===s)return;r.push(OR(s,e,0))}return new Ds(r[0],r[1],r[2],r[3])},a=function(a,o,u){var l,c=new Map,h=s(n._angleMap.entries());try{for(h.s();!(l=h.n()).done;){var f=vr(l.value,2),d=f[0],p=f[1];c.set(d,kb(OR(p,a,0),OR(p,o,0),u))}}catch(x2){h.e(x2)}finally{h.f()}if(void 0!==t){var v,m=s(c.entries());try{for(m.s();!(v=m.n()).done;){var g=vr(v.value,2),y=g[0],b=g[1];y.startsWith(t)&&c.set(y.slice(t.length,y.length),b)}}catch(x2){m.e(x2)}finally{m.f()}}var _=function(e,t,n){var r=new Ds,a=i(e),o=i(t);return void 0!==a&&void 0!==o&&r.slerpQuaternions(a,o,n),r}(a,o,u),x={position:{x:r("X_POS",a,o,u),y:r("Y_POS",a,o,u),z:r("Z_POS",a,o,u)},scale:{x:r("X_SCL",a,o,u),y:r("Y_SCL",a,o,u),z:r("Z_SCL",a,o,u)},rotation:{x:_.x,y:_.y,z:_.z,w:_.w},angleMap:c,time:e};return n.fromGazebo&&(x=AR(x)),x};if(e<=OR(this._timeTable,0,0))return a(0,0,0);if(e>=OR(this._timeTable,this._timeTable.length-1,0)){for(var o=0,u=0,l=Array.from(this._angleMap.values());u<l.length;u++){var c=l[u];o=Math.max(o,c.length)}for(var h=0,f=Array.from(this._descMap.values());h<f.length;h++){var d=f[h];o=Math.max(o,d.length)}return a(o,o,0)}var p=Fb(this._timeTable,e),v=OR(this._timeTable,p-1,0),m=OR(this._timeTable,p,0);return a(p-1,p,(e-v)/(m-v))}},{key:"startTime",value:function(){return OR(this._timeTable,0,0)}},{key:"endTime",value:function(){return OR(this._timeTable,this._timeTable.length-1,0)}},{key:"toCSV",value:function(){var e=[],t=function(t,n){e.push([t,n])};t("time",this._timeTable);for(var n=0,r=Array.from(this._descMap.entries());n<r.length;n++){var i=vr(r[n],2);t(i[0],i[1])}for(var a=0,o=Array.from(this._angleMap.entries());a<o.length;a++){var u=vr(o[a],2);t(u[0],u[1])}var l=function(e){var t,n=[],r=0,i=s(e);try{for(i.s();!(t=i.n()).done;){var a=vr(t.value,2)[1];r=Math.max(r,a.length+1)}}catch(x2){i.e(x2)}finally{i.f()}var o,u=s(Nb(r));try{for(u.s();!(o=u.n()).done;){var l=o.value,c=[];if(0===l){var h,f=s(e);try{for(f.s();!(h=f.n()).done;){var d=vr(h.value,1)[0];c.push(d)}}catch(x2){f.e(x2)}finally{f.f()}}else{var p,v=s(e);try{for(v.s();!(p=v.n()).done;){var m=vr(p.value,2)[1],g=m[l];void 0===g&&void 0===(g=m[m.length-1])&&(g=0),c.push(g)}}catch(x2){v.e(x2)}finally{v.f()}}n.push(c)}}catch(x2){u.e(x2)}finally{u.f()}return n}(e);return l}},{key:"serialize",value:function(){var e={id:this.idValue(),name:this.name(),csv:this.toCSV()};return this._url&&(e.url=this._url),e}},{key:"copyNumberArray",value:function(e){for(var t=[],n=0;n<e.length;n++)t[n]=e[n];return t}},{key:"clone",value:function(){var t=new e;t._name=this._name,t._id=new Yb,void 0!==this._url&&(t._url=this._url),t._angleMap=new Map;var n,r=s(this._angleMap);try{for(r.s();!(n=r.n()).done;){var i=vr(n.value,2),a=i[0],o=i[1];t._angleMap.set(a,this.copyNumberArray(o))}}catch(x2){r.e(x2)}finally{r.f()}t._descMap=new Map;var u,l=s(this._descMap);try{for(l.s();!(u=l.n()).done;){var c=vr(u.value,2),h=c[0],f=c[1];t._descMap.set(h,this.copyNumberArray(f))}}catch(x2){l.e(x2)}finally{l.f()}var p,v=s(this._robotNames);try{for(v.s();!(p=v.n()).done;){var m=p.value;t._robotNames.add(m)}}catch(x2){v.e(x2)}finally{v.f()}if(t._timeTable=[],t._timeTable=this.copyNumberArray(this._timeTable),t.fromGazebo=this.fromGazebo,t instanceof d.AssertionError)throw t;return t}}],[{key:"loadFromLocalFile",value:function(){var e=pr(fr().mark((function e(t,n){var r,i,a;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadFromURL(URL.createObjectURL(t),n);case 2:r=e.sent,i=s(r);try{for(i.s();!(a=i.n()).done;)a.value.setName(t.name)}catch(x2){i.e(x2)}finally{i.f()}return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadFromURL",value:function(){var t=pr(fr().mark((function t(n,r){var i,a,o,u,l,c,h,f,p,v,m,g,y;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,mR(n,!0);case 3:i=t.sent,a=[],o=s(i),t.prev=6,o.s();case 8:if((u=o.n()).done){t.next=17;break}if(l=u.value,c=l.name,h=l.csv,!((f=e.fromCSV(h))instanceof d.AssertionError)){t.next=13;break}throw f;case 13:f.setName(c),a.push(f);case 15:t.next=8;break;case 17:t.next=22;break;case 19:t.prev=19,t.t0=t.catch(6),o.e(t.t0);case 22:return t.prev=22,o.f(),t.finish(22);case 25:return void 0!==r&&("CSV Loaded Successfully!",(p=document.createElement("p")).innerText="CSV Loaded Successfully!",p.classList.add("LoadCSVMessage"),v=document.querySelector("."+r),console.log(v),null===v||void 0===v||v.appendChild(p)),t.abrupt("return",a);case 29:throw t.prev=29,t.t1=t.catch(0),void 0!==r&&(m="Error loading csv: "+t.t1,(g=document.createElement("p")).innerText=m,g.style.color="red",g.classList.add("LoadCSVMessage"),null===(y=document.querySelector("."+r))||void 0===y||y.appendChild(g)),t.t1;case 33:case"end":return t.stop()}}),t,null,[[0,29],[6,19,22,25]])})));return function(e,n){return t.apply(this,arguments)}}()},{key:"fromCSV",value:function(t,n){try{t=function(e){var t=e.csv,n=e.valTypes,r=void 0===n?lb.NUMBER:n,i=e.nonEmpty,a=void 0===i||i,o=e.extendCols,u=void 0===o||o,l=e.inPlace,c=void 0!==l&&l,h=e.removeDuplicateRows,f=void 0===h||h,p=e.fillBadCellsWith,v=void 0===p?void 0:p,m=[],g=function(e){return"number"===typeof e?e.toString():void 0===e?"":e};if(c){var y,b=s(t);try{for(b.s();!(y=b.n()).done;)for(var _=y.value,x=0;x<_.length;x++)_[x]=g(_[x])}catch(x2){b.e(x2)}finally{b.f()}m=t}else{var w,S=s(t);try{for(S.s();!(w=S.n()).done;){var M=w.value,k=[];m.push(k);var T,E=s(M);try{for(E.s();!(T=E.n()).done;){var C=T.value;k.push(g(C))}}catch(x2){E.e(x2)}finally{E.f()}}}catch(x2){S.e(x2)}finally{S.f()}}for(var A=0;A<m.length;A++)for(var R=m[A];R.length>0&&""===R[R.length-1];)R.pop();for(var P=function(e){return 0===e.length||1===e.length&&""===e[0]},L=0;L<m.length;)P(m[L])?m.splice(L,1):L++;if(a){if(0===m.length)throw new d.AssertionError({message:"The CSV was empty. CSV: ".concat(m)});if(1===m.length)throw new d.AssertionError({message:"The CSV only had 1 row (the header row). CSV: ".concat(m)})}if(m.length<=1)return m;for(var D,N=m[0],I=0;I<m.length;I++)for(;m[I].length>N.length;)m[I].pop();if(u){for(var O=[],U=0;U<N.length;U++){var F=m[1][U];void 0===F&&(F=""),O.push(F)}var z,B=s(m);try{for(B.s();!(z=B.n()).done;)for(var V=z.value,G=0;G<N.length;G++)V.length-1<G?V.push(O[G]):O[G]=V[G]}catch(x2){B.e(x2)}finally{B.f()}}if(r===lb.STRING_AND_NUMBER)D=function(e){if("string"===typeof e){var t=parseFloat(e);if(!isNaN(t))return t}return e};else if(r===lb.NUMBER)D=function(e){if("string"===typeof e){var t=parseFloat(e);if(isNaN(t))if("number"===typeof v)t=v;else{if("string"!==typeof v||isNaN(parseFloat(e)))throw new d.AssertionError({message:'Failed to clean CSV: "'.concat(t,'" could not be turned into a number.')});t=parseFloat(e)}e=t}return e};else{if(r!==lb.STRING)throw new d.AssertionError({message:'Failed to clean CSV: Unexpected valTypes value "'.concat(r,'".')});D=g}for(var j=1;j<m.length;j++)for(var H=0;H<m[j].length;H++)m[j][H]=D(m[j][H]);if(f)for(var W=function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},Z=1;Z<m.length;)W(m[Z-1],m[Z])?m.splice(Z,1):Z++;return m}({csv:t,nonEmpty:!0,extendCols:!0,inPlace:!0,removeDuplicateRows:!0,valTypes:lb.NUMBER,fillBadCellsWith:0});var r,i=new e,a=new Map,o=new Set,u=s(Ib(t[0]));try{for(u.s();!(r=u.n()).done;){var l=vr(r.value,2),c=l[0],h=l[1];if("string"!==typeof h)return UR("One of the headers was a(n) ".concat(typeof h,' (value: "').concat(h,'") rather than a string! Check to make sure that all the values of the first row of the CSV are strings naming their column of the CSV.'));for(var f=[],p=1;p<t.length;p++){var v=OR(t[p],c,0);if(""!==v){if("number"!==typeof v)return UR("On row ".concat(p,' of the CSV, a value was "').concat(v,'" rather than a number!'));f.push(v)}}var m=h.trim().replace(" ","_"),g=vr(m.split("-"),2),y=g[0];g[1];o.add(y),a.set(m.replace("-",""),f)}}catch(x2){u.e(x2)}finally{u.f()}var b=void 0;if(a.has("time")&&a.has("timestamp"))return UR('The CSV cannot have both a "time" column and a "timestamp" column. Please remove one of them.');if(a.has("time"))b=a.get("time");else{if(!a.has("timestamp"))return UR('There is no "time" or "timestamp" column in the CSV.');b=a.get("timestamp")}if(void 0===b)return UR('There is no "time" column in the CSV.');for(var _=0,x=1;x<b.length;x++){var w=b[x-1],S=b[x],M=!1;if(w>S?(lr.warn('The "time" column of every CSV must contain only ascending values, but descending values were found. Removing descending value.'),(_+=1)>5&&UR("".concat(_,' values of the "time" column of a CSV were found to be in descending order so the rest are assumed to be as well.')),M=!0):w===S?M=!0:_=0,M){var k,T=s(a.values());try{for(T.s();!(k=T.n()).done;){k.value.splice(x,1)}}catch(x2){T.e(x2)}finally{T.f()}x-=1}}var E=b[b.length-1],C=b[0],A=E-C;if("second"===n)for(var R=0;R<b.length;R++)b[R]-=C;else if("millisecond"===n)for(var P=0;P<b.length;P++)b[P]=(b[P]-C)/1e3;else if("microsecond"===n)for(var L=0;L<b.length;L++)b[L]=(b[L]-C)/1e6;else if("nanosecond"===n)for(var D=0;D<b.length;D++)b[D]=(b[D]-C)/1e9;else for(var N=A>1e3,I=A>1e6,O=A>1e9,U=0;U<b.length;U++)b[U]-=C,N&&(b[U]/=1e3),I&&(b[U]/=1e3),O&&(b[U]/=1e3);i._timeTable=b,a.delete("time");var F,z=s(a.entries());try{for(z.s();!(F=z.n()).done;){var B,V=vr(F.value,2),G=V[0],j=V[1],H=G.toUpperCase(),W=s(RR.entries());try{for(W.s();!(B=W.n()).done;){var Z=vr(B.value,2),q=Z[0],X=Z[1];H.endsWith(q)&&(i._descMap.set(G.slice(0,G.length-q.length)+X,j),a.delete(G))}}catch(x2){W.e(x2)}finally{W.f()}}}catch(x2){z.e(x2)}finally{z.f()}return i._angleMap=a,o.delete("time"),i._robotNames=o,i}catch(_2){if(_2 instanceof d.AssertionError)return _2;throw _2}}},{key:"deserialize",value:function(){var e=pr(fr().mark((function e(t,n){var r,i;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((i=this.fromCSV(t.csv))instanceof d.AssertionError)){e.next=3;break}throw i;case 3:if(!(n=null!==(r=n)&&void 0!==r?r:i)){e.next=14;break}return n._timeTable=i._timeTable,n._angleMap=i._angleMap,n._descMap=i._descMap,t.name&&(n._name=t.name),t.id&&n._id.set(t.id),t.url&&(n._url=t.url),e.abrupt("return",n);case 14:throw new d.AssertionError({message:"Could not deserialize AnimationTable."});case 15:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();function zR(e){return{x:e.x,y:e.y,z:e.z}}function BR(e,t){return t?(t.x&&(e.x=t.x),t.y&&(e.y=t.y),t.z&&(e.z=t.z),e):e}function VR(e){return{x:e.x,y:e.y,z:e.z,w:e.w}}function GR(e,t){return t?(t.x&&(e.x=t.x),t.y&&(e.y=t.y),t.z&&(e.z=t.z),t.w&&(e.w=t.w),e):e}var jR,HR=function(){function e(){(0,u.Z)(this,e),this._activeAnimations=void 0,this._storedAnimations=void 0,this._lastTime=void 0,this._activeAnimations=[],this._storedAnimations=[],this._lastTime=0}return(0,l.Z)(e,[{key:"addToAnimationManager",value:function(e){var t,n=s(this._activeAnimations);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.addActiveAnimation(r)}}catch(x2){n.e(x2)}finally{n.f()}var i,a=s(this._storedAnimations);try{for(a.s();!(i=a.n()).done;){var o=i.value;e.addStoredAnimation(o)}}catch(x2){a.e(x2)}finally{a.f()}}},{key:"removeFromAnimationManager",value:function(e){var t,n=s(this._activeAnimations);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.removeActiveAnimation(r)}}catch(x2){n.e(x2)}finally{n.f()}var i,a=s(this._storedAnimations);try{for(a.s();!(i=a.n()).done;){var o=i.value;e.removeStoredAnimation(o)}}catch(x2){a.e(x2)}finally{a.f()}}},{key:"storeAllGroups",value:function(){this._storedAnimations=[].concat(cr(this._storedAnimations),cr(this._activeAnimations)),this._activeAnimations=[],lr.updateUI()}},{key:"activateAllgroups",value:function(){this._activeAnimations=[].concat(cr(this._storedAnimations),cr(this._activeAnimations)),this._storedAnimations=[],lr.updateUI()}},{key:"clear",value:function(){this._activeAnimations=[],this._storedAnimations=[]}},{key:"animationGroups",value:function(){var e,t=[],n=s(this._activeAnimations);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push(r)}}catch(x2){n.e(x2)}finally{n.f()}var i,a=s(this._storedAnimations);try{for(a.s();!(i=a.n()).done;){var o=i.value;t.push(o)}}catch(x2){a.e(x2)}finally{a.f()}return t}},{key:"removeAnimationGroup",value:function(e){this.removeActiveAnimation(e),this.removeStoredAnimation(e)}},{key:"time",value:function(){return this._lastTime}},{key:"setTime",value:function(e){this._lastTime=e,this.updateAnimations()}},{key:"activeAnimations",value:function(){return this._activeAnimations}},{key:"addActiveAnimation",value:function(e){this.removeActiveAnimation(e),this.removeStoredAnimation(e),this._activeAnimations.push(e),lr.updateUI()}},{key:"removeActiveAnimation",value:function(e){var t=this._activeAnimations.indexOf(e);t>-1&&(this._activeAnimations.splice(t,1),lr.updateUI())}},{key:"storedAnimations",value:function(){return this._storedAnimations}},{key:"addStoredAnimation",value:function(e){this.removeStoredAnimation(e),this.removeActiveAnimation(e),this._storedAnimations.push(e),lr.updateUI()}},{key:"removeStoredAnimation",value:function(e){var t=this._storedAnimations.indexOf(e);t>-1&&(this._storedAnimations.splice(t,1),lr.updateUI())}},{key:"startTime",value:function(){var e,t=1/0,n=s(this._activeAnimations);try{for(n.s();!(e=n.n()).done;){var r=e.value;t=Math.min(t,r.startTime())}}catch(x2){n.e(x2)}finally{n.f()}return t===1/0&&(t=0),t}},{key:"endTime",value:function(){var e,t=-1/0,n=s(this._activeAnimations);try{for(n.s();!(e=n.n()).done;){var r=e.value;t=Math.max(t,r.endTime())}}catch(x2){n.e(x2)}finally{n.f()}return t===-1/0&&(t=1),t}},{key:"updateAnimations",value:function(){var e=this.endTime();this._lastTime>e&&(this._lastTime=e);var t=this.startTime();this._lastTime<t&&(this._lastTime=t);var n,r=s(this._activeAnimations);try{for(r.s();!(n=r.n()).done;){n.value.update(this._lastTime)}}catch(x2){r.e(x2)}finally{r.f()}lr.updateUI(),lr.render()}},{key:"copy",value:function(e,t){var n,r=new Map,i=s(e._activeAnimations);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=r.get(a);o||(o=a.clone(t),r.set(a,o)),this.addActiveAnimation(o)}}catch(x2){i.e(x2)}finally{i.f()}var u,l=s(e._storedAnimations);try{for(l.s();!(u=l.n()).done;){var c=u.value,h=r.get(c);h||(h=c.clone(t),r.set(c,h)),this.addStoredAnimation(h)}}catch(x2){l.e(x2)}finally{l.f()}return this}},{key:"clone",value:function(t){return(new e).copy(this,t)}},{key:"serialize",value:function(){var e,t=[],n=s(this._activeAnimations);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push(r.serialize())}}catch(x2){n.e(x2)}finally{n.f()}var i,a=[],o=s(this._storedAnimations);try{for(o.s();!(i=o.n()).done;){var u=i.value;a.push(u.serialize())}}catch(x2){o.e(x2)}finally{o.f()}return{activeAnimations:t,storedAnimations:a,lastTime:this._lastTime}}}],[{key:"deserialize",value:function(){var t=pr(fr().mark((function t(n,r,i,a){var o,u,l,c,h,f,d,p,v,m,g,y,b,_,x,w,S;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=a||new e,u=[],n.activeAnimations){l=s(n.activeAnimations);try{for(l.s();!(c=l.n()).done;)h=c.value,u.push(Hb.deserialize(h,r,i))}catch(x2){l.e(x2)}finally{l.f()}}if(f=[],n.storedAnimations){d=s(n.storedAnimations);try{for(d.s();!(p=d.n()).done;)v=p.value,f.push(Hb.deserialize(v,r,i))}catch(x2){d.e(x2)}finally{d.f()}}return t.next=7,Promise.all(u);case 7:return m=t.sent,t.next=10,Promise.all(f);case 10:g=t.sent,y=s(m);try{for(y.s();!(b=y.n()).done;)_=b.value,o.addActiveAnimation(_)}catch(x2){y.e(x2)}finally{y.f()}x=s(g);try{for(x.s();!(w=x.n()).done;)S=w.value,o.addStoredAnimation(S)}catch(x2){x.e(x2)}finally{x.f()}return n.lastTime&&(o._lastTime=n.lastTime),t.abrupt("return",o);case 17:case"end":return t.stop()}}),t)})));return function(e,n,r,i){return t.apply(this,arguments)}}()}]),e}();jR=Symbol.iterator;var WR=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if((0,u.Z)(this,e),this._refs=void 0,this._refs=[],t){var n,r=s(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.push(i)}}catch(x2){r.e(x2)}finally{r.f()}}}return(0,l.Z)(e,[{key:"clean",value:function(){for(var e=0;e<this._refs.length;){void 0!==this._refs[e].deref()?e+=1:this._refs.splice(e,1)}}},{key:"push",value:function(e){this._refs.push(new WeakRef(e))}},{key:"remove",value:function(e){for(var t=0;t<this._refs.length;){var n=this._refs[t].deref();if(void 0!==n){if(n===e){this._refs.splice(t,1);break}t+=1}else this._refs.splice(t,1)}}},{key:"length",get:function(){return Array.from(this).length}},{key:"reverse",value:fr().mark((function e(){var t,n,r,i;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Array.from(this),n=s(t.reverse()),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return i=r.value,e.next=8,i;case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])}))},{key:jR,value:function(){var e=fr().mark(n),t=this;function n(){var n,r;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<t._refs.length)){e.next=12;break}if(void 0===(r=t._refs[n].deref())){e.next=9;break}return e.next=6,r;case 6:n+=1,e.next=10;break;case 9:t._refs.splice(n,1);case 10:e.next=1;break;case 12:case"end":return e.stop()}}),e)}return n()}}]),e}(),ZR=new cb.WebGLRenderer({alpha:!1,antialias:!0,preserveDrawingBuffer:!0});ZR.outputEncoding=cb.sRGBEncoding,ZR.shadowMap.enabled=!0,ZR.shadowMap.type=cb.PCFSoftShadowMap;var qR=new Set,XR=0,YR=function(){function e(t){var n=this;if((0,u.Z)(this,e),this._name=void 0,this._render=void 0,this._funcRollsRun=void 0,this._renderer=void 0,this._scene=void 0,this._views=void 0,this._animationManager=void 0,this._copyCloneObjects=void 0,void 0!==t);else{var r="Scene";for(t=r+ ++XR;qR.has(t);)t=r+ ++XR}qR.add(t),this._name=t,this._render=new qb(or,[function(){var e,t=s(n._views);try{for(t.s();!(e=t.n()).done;){var r=e.value;n.drawTo(r)}}catch(x2){t.e(x2)}finally{t.f()}}]),this._funcRollsRun=new Set,this._renderer=ZR,this._scene=new cb.Scene,this._views=new WR,this._animationManager=new HR,this._copyCloneObjects=[]}return(0,l.Z)(e,[{key:"addCopyCloneObject",value:function(e){this._copyCloneObjects.push(e),this._scene.add(e)}},{key:"setAnimationManager",value:function(e){this._animationManager=e,lr.updateUI(),this.render()}},{key:"name",value:function(){return this._name}},{key:"setName",value:function(e){this._name=e,lr.updateUI()}},{key:"animationManager",value:function(){return this._animationManager}},{key:"runOnce",value:function(e,t){this._funcRollsRun.has(e)||(this._funcRollsRun.add(e),t(),this.render(),lr.updateUI())}},{key:"scene",value:function(){return this._scene}},{key:"renderer",value:function(){return this._renderer}},{key:"setRenderer",value:function(e){this._renderer=e,this.render()}},{key:"views",value:function(){var e,t=[],n=s(this._views);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push(r)}}catch(x2){n.e(x2)}finally{n.f()}return t}},{key:"removeView",value:function(e){this._views.remove(e)}},{key:"addView",value:function(e){this._views.push(e)}},{key:"render",value:function(){this._render.call()}},{key:"drawTo",value:function(e){var t=e.canvas(),n=e.camera(),r=t.getContext("2d");r?(e.preprocess(),this._renderer.setSize(t.width,t.height),n instanceof cb.PerspectiveCamera&&(n.aspect=t.width/t.height,n.updateProjectionMatrix()),this._renderer.render(this._scene,n),this._renderer.domElement.width>0&&this._renderer.domElement.height>0&&r.drawImage(this._renderer.domElement,0,0),e.postprocess()):console.error("A canvas could not be rendered to because its 2d context was null!")}},{key:"copy",value:function(e){var t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>4?arguments[4]:void 0;t&&(this._name=e._name);var r,i=s(e._copyCloneObjects);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.addCopyCloneObject(a.clone(!0))}}catch(x2){i.e(x2)}finally{i.f()}return this._animationManager.copy(e._animationManager,n),e}},{key:"clone",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3?arguments[3]:void 0;return(new e).copy(this,t,n,r,i)}}]),e}();function KR(e){return e instanceof cb.Mesh||e&&"isMesh"in e}for(var JR=[],QR=0;QR<256;QR++)JR[QR]=(QR<16?"0":"")+QR.toString(16);Math.PI,Math.PI;var $R=function(){function e(t,n,r){(0,u.Z)(this,e),this._id=void 0,this._robot=void 0,this._joint=void 0,this._render=void 0,this._includeAngleInTimeWarpConsideration=void 0,this._includePosInTimeWarpConsideration=void 0,this._sceneCounter=void 0,this._graphCounter=void 0,this._id=new Yb,this._robot=t,this._joint=n,this._render=r,this._includeAngleInTimeWarpConsideration=!1,this._includePosInTimeWarpConsideration=!1,this._sceneCounter=0,this._graphCounter=0}return(0,l.Z)(e,[{key:"isInScene",value:function(){return 0!==this._sceneCounter}},{key:"isInGraph",value:function(){return 0!==this._graphCounter}},{key:"addToScene",value:function(){this._sceneCounter++}},{key:"removeFromScene",value:function(){this._sceneCounter>0&&this._sceneCounter--}},{key:"addToGraph",value:function(){this._graphCounter++}},{key:"removeFromGraph",value:function(){this._graphCounter>0&&this._graphCounter--}},{key:"includeAngleInTimeWarpConsideration",value:function(){return this._includeAngleInTimeWarpConsideration}},{key:"setAngleIncludeInTimeWarpConsideration",value:function(e){this._includeAngleInTimeWarpConsideration=e,lr.updateUI(),lr.render()}},{key:"includePosInTimeWarpConsideration",value:function(){return this._includePosInTimeWarpConsideration}},{key:"setPosIncludeInTimeWarpConsideration",value:function(e){this._includePosInTimeWarpConsideration=e,lr.updateUI(),lr.render()}},{key:"id",value:function(){return this._id}},{key:"idValue",value:function(){return this._id.value()}},{key:"name",value:function(){return this._joint.name}},{key:"type",value:function(){return this._joint.type}},{key:"jointType",value:function(){return this._joint.jointType}},{key:"minAngle",value:function(){return"continuous"===this.jointType()?-10*Math.PI:this._joint.limit.lower.valueOf()}},{key:"maxAngle",value:function(){return"continuous"===this.jointType()?10*Math.PI:this._joint.limit.upper.valueOf()}},{key:"setAngle",value:function(e){e=function(e,t,n){return Math.max(t,Math.min(n,e))}(e,this.minAngle(),this.maxAngle()),this._joint.setJointValue(e),this._render()}},{key:"angle",value:function(){return this._joint.angle.valueOf()}},{key:"getWorldQuaternion",value:function(){return this._joint.getWorldQuaternion(new Ds)}},{key:"getWorldPosition",value:function(){return this._joint.getWorldPosition(new Ns)}},{key:"getJointName",value:function(){return this._joint.name}}]),e}(),eP=function(){function e(t,n,r){(0,u.Z)(this,e),this._id=void 0,this._robot=void 0,this._link=void 0,this._render=void 0,this._includePosInTimeWarpConsideration=void 0,this._sceneCounter=void 0,this._graphCounter=void 0,this._id=new Yb,this._robot=t,this._link=n,this._render=r,this._includePosInTimeWarpConsideration=!1,this._sceneCounter=0,this._graphCounter=0}return(0,l.Z)(e,[{key:"isInScene",value:function(){return 0!==this._sceneCounter}},{key:"isInGraph",value:function(){return 0!==this._graphCounter}},{key:"addToScene",value:function(){this._sceneCounter++}},{key:"removeFromScene",value:function(){this._sceneCounter>0&&this._sceneCounter--}},{key:"addToGraph",value:function(){this._graphCounter++}},{key:"removeFromGraph",value:function(){this._graphCounter>0&&this._graphCounter--}},{key:"includePosInTimeWarpConsideration",value:function(){return this._includePosInTimeWarpConsideration}},{key:"setPosIncludeInTimeWarpConsideration",value:function(e){this._includePosInTimeWarpConsideration=e,lr.updateUI(),lr.render()}},{key:"id",value:function(){return this._id}},{key:"idValue",value:function(){return this._id.value()}},{key:"name",value:function(){return this._link.name}},{key:"getWorldQuaternion",value:function(){return this._link.getWorldQuaternion(new Ds)}},{key:"getWorldPosition",value:function(){return this._link.getWorldPosition(new Ns)}},{key:"getLinkName",value:function(){return this._link.name}}]),e}(),tP=function(){function e(){(0,u.Z)(this,e),this._subscribers=void 0;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._subscribers=n}return(0,l.Z)(e,[{key:"subscribe",value:function(e){var t=this;return this._subscribers.push(e.bind(void 0)),function(){var n=t._subscribers.indexOf(e);n>0&&t._subscribers.splice(n,1)}}},{key:"call",value:function(e){for(var t=0;t<this._subscribers.length;t++){!1===(0,this._subscribers[t])(e)&&(this._subscribers.splice(t,1),t--)}}}]),e}(),nP=function(){function e(t){(0,u.Z)(this,e),this._beforeSet=void 0,this._value=void 0,this._afterSet=void 0,this._beforeSet=new tP,this._value=t,this._afterSet=new tP}return(0,l.Z)(e,[{key:"value",value:function(){return this._value}},{key:"setValue",value:function(e,t,n){this._beforeSet.call([this._value,t]),e&&e(this._value,t),this._value=t,n&&n(this._value,t),this._afterSet.call([this._value,t])}},{key:"beforeSet",value:function(){return this._beforeSet}},{key:"afterSet",value:function(){return this._afterSet}}]),e}(),rP=function(){function e(t,n,r,i){var a=this,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"urdf",s=arguments.length>5?arguments[5]:void 0;(0,u.Z)(this,e),this._id=void 0,this._robot=void 0,this._robotName=void 0,this._url=void 0,this._objectType=void 0,this._highlighted=void 0,this._highlightColor=void 0,this._desaturated=void 0,this._endEffectorPosition=void 0,this._endEffectorRotation=void 0,this._endEffectorMesh=void 0,this._rootGroup=void 0,this._opacity=void 0,this._visible=void 0,this._shadows=void 0,this._eulerRotation=void 0,this._parentScene=void 0,this._meshes=void 0,this._joints=void 0,this._articulatedJoints=void 0,this._jointMap=void 0,this._articulatedJointMap=void 0,this._links=void 0,this._linkMap=void 0,this._master=void 0,this._controlledClones=void 0,this._includePositionOffsetInTimeWarpConsideration=void 0,this._includePosInTimeWarpConsideration=void 0,this._positionOffset=void 0,this._sceneCounter=void 0,this._graphCounter=void 0,this._robot=t,this._objectType=o,this._id=new Yb(i),this._master=s,this._parentScene=new nP(void 0),this._controlledClones=[],this._eulerRotation=(new cb.Euler).setFromQuaternion(this.getWorldQuaternion()),this._robotName=(null!==r&&void 0!==r?r:"unknown_robot").trim(),this._url=n,void 0!==this._robot.quaternion&&this._robot.quaternion.set(0,0,0,1),void 0!==this._robot.position&&this._robot.position.set(0,0,0),void 0!==this._robot.scale&&this._robot.scale.set(1,1,1),this._sceneCounter=0,this._graphCounter=0,this.render=this.render.bind(this),this._rootGroup=new cb.Group,this._rootGroup.add(this._robot),this._positionOffset=new nP(this._rootGroup.position.clone()),this._endEffectorPosition=new cb.Vector3,this._endEffectorRotation=new cb.Quaternion;var l=new cb.ConeGeometry(.01,.03,20),c=new cb.MeshStandardMaterial({color:"orange"});if(this._endEffectorMesh=new cb.Mesh(l,c),this._endEffectorMesh.visible=!0,this._visible=!1,this.setVisible(!0),this._shadows=!1,this.setShadows(!0),this._opacity=0,this.setOpacity(1),this._desaturated=!1,this._highlighted=!1,this._highlightColor=new cb.Color(.2,.2,.4),this.traverseMaterials((function(e){"color"in e&&(e.baseColor=e.color.clone(),e.highlightColor=e.color.clone().add(a._highlightColor),e.desaturatedColor=wb(e.color,new cb.Color(.2,.2,.2))),e.side=cb.DoubleSide,e.transparent=!0,e.opacity=a._opacity})),this.updateColors(),this._robot.traverse((function(e){if("PointLight"===e.type){var t=e;t.intensity=0,t.castShadow=!1,t.distance=0,t.visible=!1}})),this.setPositionOffset(new cb.Vector3(0,0,0)),this._meshes=[],this.traverseMeshes((function(e){a._meshes.push(e)})),this._jointMap=new Map,this._joints=[],this._articulatedJointMap=new Map,this._articulatedJoints=[],this._robot.joints)for(var h=0,f=Object.entries(this._robot.joints);h<f.length;h++){var d=f[h],p=new $R(this,d[1],this.render);this._jointMap.set(d[0],p),this._joints.push(p),"fixed"!==p.jointType()&&"URDFMimicJoint"!==p.type()&&(this._articulatedJointMap.set(d[0],p),this._articulatedJoints.push(p))}if(this._linkMap=new Map,this._links=[],this._robot.links)for(var v=0,m=Object.entries(this._robot.links);v<m.length;v++){var g=m[v],y=new eP(this,g[1],this.render);this._links.push(y),this._linkMap.set(g[0],y)}this._includePositionOffsetInTimeWarpConsideration=!1,this._includePosInTimeWarpConsideration=!1}return(0,l.Z)(e,[{key:"eulerRotation",value:function(){return this._eulerRotation}},{key:"includePositionOffsetInTimeWarpConsideration",value:function(){return this._includePositionOffsetInTimeWarpConsideration}},{key:"setPositionOffsetIncludeInTimeWarpConsideration",value:function(e){this._includePositionOffsetInTimeWarpConsideration=e,lr.updateUI(),lr.render()}},{key:"includePosInTimeWarpConsideration",value:function(){return this._includePosInTimeWarpConsideration}},{key:"setPositionIncludeInTimeWarpConsideration",value:function(e){this._includePosInTimeWarpConsideration=e,lr.updateUI(),lr.render()}},{key:"setParentRobotScene",value:function(e){var t=this;e!==this._parentScene.value()&&(this._parentScene.setValue((function(e,n){if(e){e.scene().remove(t.rootGroup());var r,i=s(t._controlledClones);try{for(i.s();!(r=i.n()).done;){var a;vr(r.value,0);null===(a=e.robotSceneManager())||void 0===a||a.removeControlledRobotScene(e)}}catch(x2){i.e(x2)}finally{i.f()}}if(void 0!==n){n.scene().add(t.rootGroup());var o,u=s(t._controlledClones);try{for(u.s();!(o=u.n()).done;){var l;vr(o.value,0);null===(l=n.robotSceneManager())||void 0===l||l.addControlledRobotScene(n)}}catch(x2){u.e(x2)}finally{u.f()}}}),e,null),lr.updateUI(),lr.render())}},{key:"controlledCloneInScene",value:function(e){var t,n=s(this._controlledClones);try{for(n.s();!(t=n.n()).done;){if(e===vr(t.value,1)[0])return!0}}catch(x2){n.e(x2)}finally{n.f()}return!1}},{key:"addControlledClone",value:function(e){var t,n=s(this._controlledClones);try{for(n.s();!(t=n.n()).done;){var r=vr(t.value,2),i=r[0],a=r[1];if(e===i)return a}}catch(x2){n.e(x2)}finally{n.f()}var o=this.clone();o.setParentRobotScene(e),this._controlledClones.push([e,o]);var u,l=this._parentScene.value();l&&(null===(u=l.robotSceneManager())||void 0===u||u.addControlledRobotScene(l));return e.render(),e.addGhostRobot(this),lr.updateUI(),o}},{key:"removeControlledClone",value:function(e){var t,n=s(Ib(this._controlledClones));try{for(n.s();!(t=n.n()).done;){var r=vr(t.value,2),i=r[0],a=r[1];if(e===a[0]){a[1].setParentRobotScene(void 0),this._controlledClones.splice(i,1);var o,u=this._parentScene.value();if(u)null===u||void 0===u||null===(o=u.robotSceneManager())||void 0===o||o.removeControlledRobotScene(u);e.render(),lr.updateUI();break}}}catch(x2){n.e(x2)}finally{n.f()}}},{key:"master",value:function(){return this._master}},{key:"setMaster",value:function(e){this._master=e}},{key:"objectType",value:function(){return this._objectType}},{key:"id",value:function(){return this._id}},{key:"idValue",value:function(){return this.id().value()}},{key:"url",value:function(){return this._url}},{key:"rootGroup",value:function(){return this._rootGroup}},{key:"setName",value:function(e){this._robotName=e,lr.updateUI()}},{key:"name",value:function(){return this._robotName}},{key:"isInScene",value:function(){return 0!==this._sceneCounter}},{key:"isInGraph",value:function(){return 0!==this._graphCounter}},{key:"addToScene",value:function(){this._sceneCounter++}},{key:"removeFromScene",value:function(){this._sceneCounter>0&&this._sceneCounter--}},{key:"addToGraph",value:function(){this._graphCounter++}},{key:"removeFromGraph",value:function(){this._graphCounter>0&&this._graphCounter--}},{key:"getRootGroup",value:function(){return this._rootGroup}},{key:"setJointAngle",value:function(e,t){var n=this._articulatedJointMap.get(e);if(n){var r,i=s(this._controlledClones);try{for(i.s();!(r=i.n()).done;){vr(r.value,2)[1].setJointAngle(e,t)}}catch(x2){i.e(x2)}finally{i.f()}n.setAngle(t),this.render()}}},{key:"jointAngle",value:function(e){var t=this._articulatedJointMap.get(e);if(t)return t.angle()}},{key:"getScaleOffset",value:function(){return this._rootGroup.scale.clone()}},{key:"setScaleOffset",value:function(e){if(!e.equals(this.getScaleOffset())){var t,n=s(this._controlledClones);try{for(n.s();!(t=n.n()).done;){vr(t.value,2)[1].setScaleOffset(e)}}catch(x2){n.e(x2)}finally{n.f()}this._rootGroup.scale.set(e.x,e.y,e.z),this.render()}}},{key:"getPositionOffset",value:function(){return this._positionOffset.value().clone()}},{key:"setPositionOffset",value:function(e){var t=this;e.equals(this.getPositionOffset())||(this._positionOffset.setValue(null,e.clone(),(function(e,n){t._rootGroup.position.set(n.x,n.y,n.z);var r,i=s(t._controlledClones);try{for(i.s();!(r=i.n()).done;){vr(r.value,2)[1].setPositionOffset(n)}}catch(x2){i.e(x2)}finally{i.f()}})),this.render())}},{key:"beforepositionOffsetSet",value:function(){return this._positionOffset.beforeSet()}},{key:"afterpositionOffsetSet",value:function(){return this._positionOffset.afterSet()}},{key:"getQuaternionOffset",value:function(){return this._rootGroup.quaternion.clone()}},{key:"setQuaternionOffset",value:function(e){if(!e.equals(this.getQuaternionOffset())){var t,n=s(this._controlledClones);try{for(n.s();!(t=n.n()).done;){vr(t.value,2)[1].setQuaternionOffset(e)}}catch(x2){n.e(x2)}finally{n.f()}this._rootGroup.quaternion.copy(e),this.render()}}},{key:"getScale",value:function(){return this._robot.scale.clone()}},{key:"setScale",value:function(e){if(!e.equals(this.getScale())){var t,n=s(this._controlledClones);try{for(n.s();!(t=n.n()).done;){vr(t.value,2)[1].setScale(e)}}catch(x2){n.e(x2)}finally{n.f()}this._robot.scale.set(e.x,e.y,e.z),this.render()}}},{key:"getPosition",value:function(){return this._robot.position.clone()}},{key:"setPosition",value:function(e){if(!e.equals(this.getPosition())){var t,n=s(this._controlledClones);try{for(n.s();!(t=n.n()).done;){vr(t.value,2)[1].setPosition(e)}}catch(x2){n.e(x2)}finally{n.f()}this._robot.position.set(e.x,e.y,e.z),this.render()}}},{key:"getWorldPosition",value:function(){return this._robot.getWorldPosition(new cb.Vector3)}},{key:"setWorldPosition",value:function(e){this.setPosition(this._robot.worldToLocal(e))}},{key:"getWorldQuaternion",value:function(){return this._robot.getWorldQuaternion(new cb.Quaternion)}},{key:"getQuaternion",value:function(){return this._robot.quaternion.clone()}},{key:"setQuaternion",value:function(e){if(!e.equals(this.getQuaternion())){var t,n=s(this._controlledClones);try{for(n.s();!(t=n.n()).done;){vr(t.value,2)[1].setQuaternion(e)}}catch(x2){n.e(x2)}finally{n.f()}this._robot.quaternion.copy(e),this.render()}}},{key:"joints",value:function(){return this._joints}},{key:"articuatedJoints",value:function(){return this._articulatedJoints}},{key:"jointMap",value:function(){return this._jointMap}},{key:"getArticuatedJointMap",value:function(){return this._articulatedJointMap}},{key:"getFixedJointMap",value:function(){var e,t=new Map,n=s(this._jointMap);try{for(n.s();!(e=n.n()).done;){var r=vr(e.value,2),i=r[0],a=r[1];this._articulatedJointMap.has(i)||t.set(i,a)}}catch(x2){n.e(x2)}finally{n.f()}return t}},{key:"links",value:function(){return this._links}},{key:"linkMap",value:function(){return this._linkMap}},{key:"setOpacity",value:function(e){var t=this;this._opacity=Lb(e,0,1),this.traverseMaterials((function(e){e.opacity=t._opacity})),this.render()}},{key:"opacity",value:function(){return this._opacity}},{key:"setHighlightColor",value:function(e){this.traverseMaterials((function(t){"color"in t&&(t.highlightColor=t.baseColor.clone().add(e))})),this.updateColors()}},{key:"highlightColor",value:function(){return this._highlightColor}},{key:"traverseMeshes",value:function(e){this.rootGroup().traverse((function(t){KR(t)&&e(t)}))}},{key:"traverseMaterials",value:function(e){this.rootGroup().traverse((function(t){_b(t.material,e)}))}},{key:"meshes",value:function(){return this._meshes}},{key:"visible",value:function(){return this._visible}},{key:"setVisible",value:function(e){this.traverseMeshes((function(t){t.visible=e})),this._visible=e,this.render()}},{key:"shadows",value:function(){return this._shadows}},{key:"setShadows",value:function(e){this.traverseMeshes((function(t){t.castShadow=e,t.receiveShadow=e})),this._shadows=e,this.render()}},{key:"highlighted",value:function(){return this._highlighted}},{key:"setHighlighted",value:function(e){this._highlighted=e,this.updateColors()}},{key:"desaturated",value:function(){return this._desaturated}},{key:"setDesaturated",value:function(e){this._desaturated=e,this.updateColors()}},{key:"applyFrame",value:function(e){var t=e.scale;if(t){var n=this.getScale();void 0!==t.x&&(n.x=t.x),void 0!==t.y&&(n.y=t.y),void 0!==t.z&&(n.z=t.z),this.setScale(n)}var r=e.position;if(r){var i=this.getPosition();void 0!==r.x&&(i.x=r.x),void 0!==r.y&&(i.y=r.y),void 0!==r.z&&(i.z=r.z),this.setPosition(i)}var a=e.rotation;if(a){var o=this.getQuaternion();if(void 0!==a.w)void 0!==a.x&&(o.x=a.x),void 0!==a.y&&(o.y=a.y),void 0!==a.z&&(o.z=a.z),void 0!==a.w&&(o.w=a.w);else{var u=new cb.Euler;void 0!==a.x&&(u.x=a.x),void 0!==a.y&&(u.y=a.y),void 0!==a.z&&(u.z=a.z),o.setFromEuler(u)}this.setQuaternion(o)}var l,c=s(e.angleMap.entries());try{for(c.s();!(l=c.n()).done;){var h=vr(l.value,2),f=h[0],d=h[1];this.setJointAngle(f,d)}}catch(x2){c.e(x2)}finally{c.f()}}},{key:"beforeParentSceneSet",value:function(){return this._parentScene.beforeSet()}},{key:"afterParentSceneSet",value:function(){return this._parentScene.afterSet()}},{key:"parentScene",value:function(){return this._parentScene.value()}},{key:"render",value:function(){var e;null===(e=this._parentScene.value())||void 0===e||e.render()}},{key:"updateColors",value:function(){var e=this;this.traverseMaterials((function(t){"color"in t&&(e._highlighted?t.color=t.highlightColor:e._desaturated?t.color=t.desaturatedColor:t.color=t.baseColor)})),this.render()}},{key:"clone",value:function(){var t=this.desaturated(),n=this.highlighted();this.setDesaturated(!1),this.setHighlighted(!1);var r=this._robot.clone(!0);r.traverse((function(e){var t=e.material;if(t)if(Array.isArray(t)){var n,r=[],i=s(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;r.push(a.clone())}}catch(x2){i.e(x2)}finally{i.f()}e.material=r}else e.material=t.clone()}));var i=new e(r,this.url(),this.name(),void 0,this._objectType,void 0===this._master?this:this._master);return i.setDesaturated(t),i.setHighlighted(n),i.setOpacity(this.opacity()),i.setVisible(this.visible()),i.setHighlightColor(this.highlightColor()),i.setPosition(this.getPosition()),i.setQuaternion(this.getQuaternion()),i.setScale(this.getScale()),i.setPositionOffset(this.getPositionOffset()),i.setQuaternionOffset(this.getQuaternionOffset()),i.setScaleOffset(this.getScaleOffset()),this.setDesaturated(t),this.setHighlighted(n),i}},{key:"serialize",value:function(){var e;if(!this._url)throw new Error("Robot named ".concat(this._robotName," could not be properly serialized because it does not come from a URL."));e=this._url;var t=this.getPositionOffset(),n=this.getScaleOffset(),r=this.getQuaternionOffset(),i=this.getPosition(),a=this.getScale(),o=this.getQuaternion();return{name:this._robotName,id:this._id.value(),url:e,positionOffset:zR(t),scaleOffset:zR(n),rotationOffset:VR(r),position:zR(i),scale:zR(a),rotation:VR(o),objectType:this._objectType}}}],[{key:"deserialize",value:function(){var t=pr(fr().mark((function t(n){var r,i;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"===typeof n&&(n=JSON.parse(n)),!n.url){t.next=17;break}return r=n.url,t.next=5,e.loadRobot(r);case 5:return i=t.sent,n.name&&(i._robotName=n.name),n.id&&i._id.set(n.id),i.setScaleOffset(BR(i.getScaleOffset(),n.scaleOffset)),i.setPositionOffset(BR(i.getPositionOffset(),n.positionOffset)),i.setQuaternionOffset(GR(i.getQuaternionOffset(),n.rotationOffset)),i.setScale(BR(i.getScale(),n.scale)),i.setPosition(BR(i.getPosition(),n.position)),i.setQuaternion(GR(i.getQuaternion(),n.rotation)),t.abrupt("return",i);case 17:throw lr.error("Failed to deserialize a Robot: its serial did not contain a url to the Robot."),new d.AssertionError({message:"Failed to deserialize a Robot: its serial did not contain a url to the Robot."});case 19:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"loadRobot",value:function(){var t=pr(fr().mark((function t(n,r){var i,a,o=arguments;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=o.length>2&&void 0!==o[2]?o[2]:"",void 0===r&&(r=n.trim().toLowerCase().endsWith(".glb")?"glb":"urdf"),"urdf"!==r){t.next=9;break}return t.next=5,_R(n);case 5:a=t.sent,""===i&&(i=a.robotName),t.next=18;break;case 9:if("glb"!==r){t.next=16;break}return t.next=12,yR(n);case 12:a=t.sent,""===i&&(i="Object"),t.next=18;break;case 16:a=new cb.AxesHelper(.1),""===i&&(i="EE Target");case 18:return t.abrupt("return",new e(a,n,i,void 0,"urdf"===r?void 0:"object3D"));case 19:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"createAxesHelper",value:function(t,n){return new e(new cb.AxesHelper(t),"AxesHelper",n,void 0,"object3D")}}]),e}(),iP=function(){function e(){(0,u.Z)(this,e),this.pluginCallbacks=[],this.register((function(e){return new DP(e)})),this.register((function(e){return new NP(e)})),this.register((function(e){return new IP(e)})),this.register((function(e){return new UP(e)})),this.register((function(e){return new FP(e)})),this.register((function(e){return new OP(e)}))}return(0,l.Z)(e,[{key:"register",value:function(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}},{key:"unregister",value:function(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}},{key:"parse",value:function(e,t,n,r){"object"===typeof n&&(console.warn("THREE.GLTFExporter: parse() expects options as the fourth argument now."),r=n);for(var i=new LP,a=[],o=0,s=this.pluginCallbacks.length;o<s;o++)a.push(this.pluginCallbacks[o](i));i.setPlugins(a),i.write(e,t,r).catch(n)}},{key:"parseAsync",value:function(e,t){var n=this;return new Promise((function(r,i){n.parse(e,r,i,t)}))}}]),e}(),aP=0,oP=1,sP=2,uP=3,lP=4,cP=5121,hP=5123,fP=5126,dP=5125,pP=34962,vP=34963,mP=9728,gP=9729,yP=9984,bP=9985,_P=9986,xP=9987,wP=33071,SP=33648,MP=10497,kP={};kP[Oi]=mP,kP[Ui]=yP,kP[zi]=_P,kP[Vi]=gP,kP[Gi]=bP,kP[Hi]=xP,kP[Ni]=wP,kP[Di]=MP,kP[Ii]=SP;var TP={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"};function EP(e,t){return e.length===t.length&&e.every((function(e,n){return e===t[n]}))}function CP(e){if(void 0!==window.TextEncoder)return(new TextEncoder).encode(e).buffer;for(var t=new Uint8Array(new ArrayBuffer(e.length)),n=0,r=e.length;n<r;n++){var i=e.charCodeAt(n);t[n]=i>255?32:i}return t.buffer}function AP(e){return 4*Math.ceil(e/4)}function RP(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=AP(e.byteLength);if(n!==e.byteLength){var r=new Uint8Array(n);if(r.set(new Uint8Array(e)),0!==t)for(var i=e.byteLength;i<n;i++)r[i]=t;return r.buffer}return e}var PP=null,LP=function(){function e(){(0,u.Z)(this,e),this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter"}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map}}return(0,l.Z)(e,[{key:"setPlugins",value:function(e){this.plugins=e}},{key:"write",value:function(){var e=pr(fr().mark((function e(t,n,r){var i,a,o,s,u,l,c,h;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.options=Object.assign({},{binary:!1,trs:!1,onlyVisible:!0,truncateDrawRange:!0,embedImages:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},r),this.options.animations.length>0&&(this.options.trs=!0),this.processInput(t),e.next=5,Promise.all(this.pending);case 5:a=(i=this).buffers,o=i.json,r=i.options,s=i.extensionsUsed,u=new Blob(a,{type:"application/octet-stream"}),(l=Object.keys(s)).length>0&&(o.extensionsUsed=l),o.buffers&&o.buffers.length>0&&(o.buffers[0].byteLength=u.size),!0===r.binary?((c=new window.FileReader).readAsArrayBuffer(u),c.onloadend=function(){var e=RP(c.result),t=new DataView(new ArrayBuffer(8));t.setUint32(0,e.byteLength,!0),t.setUint32(4,5130562,!0);var r=RP(CP(JSON.stringify(o)),32),i=new DataView(new ArrayBuffer(8));i.setUint32(0,r.byteLength,!0),i.setUint32(4,1313821514,!0);var a=new ArrayBuffer(12),s=new DataView(a);s.setUint32(0,1179937895,!0),s.setUint32(4,2,!0);var u=12+i.byteLength+r.byteLength+t.byteLength+e.byteLength;s.setUint32(8,u,!0);var l=new Blob([a,i,r,t,e],{type:"application/octet-stream"}),h=new window.FileReader;h.readAsArrayBuffer(l),h.onloadend=function(){n(h.result)}}):o.buffers&&o.buffers.length>0?((h=new window.FileReader).readAsDataURL(u),h.onloadend=function(){var e=h.result;o.buffers[0].uri=e,n(o)}):n(o);case 15:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"serializeUserData",value:function(e,t){if(0!==Object.keys(e.userData).length){var n=this.options,r=this.extensionsUsed;try{var i=JSON.parse(JSON.stringify(e.userData));if(n.includeCustomExtensions&&i.gltfExtensions){for(var a in void 0===t.extensions&&(t.extensions={}),i.gltfExtensions)t.extensions[a]=i.gltfExtensions[a],r[a]=!0;delete i.gltfExtensions}Object.keys(i).length>0&&(t.extras=i)}catch(o){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+o.message)}}}},{key:"getUID",value:function(e){return this.uids.has(e)||this.uids.set(e,this.uid++),this.uids.get(e)}},{key:"isNormalizedNormalAttribute",value:function(e){if(this.cache.attributesNormalized.has(e))return!1;for(var t=new Ns,n=0,r=e.count;n<r;n++)if(Math.abs(t.fromBufferAttribute(e,n).length()-1)>5e-4)return!1;return!0}},{key:"createNormalizedNormalAttribute",value:function(e){var t=this.cache;if(t.attributesNormalized.has(e))return t.attributesNormalized.get(e);for(var n=e.clone(),r=new Ns,i=0,a=n.count;i<a;i++)r.fromBufferAttribute(n,i),0===r.x&&0===r.y&&0===r.z?r.setX(1):r.normalize(),n.setXYZ(i,r.x,r.y,r.z);return t.attributesNormalized.set(e,n),n}},{key:"applyTextureTransform",value:function(e,t){var n=!1,r={};0===t.offset.x&&0===t.offset.y||(r.offset=t.offset.toArray(),n=!0),0!==t.rotation&&(r.rotation=t.rotation,n=!0),1===t.repeat.x&&1===t.repeat.y||(r.scale=t.repeat.toArray(),n=!0),n&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=r,this.extensionsUsed.KHR_texture_transform=!0)}},{key:"processBuffer",value:function(e){var t=this.json,n=this.buffers;return t.buffers||(t.buffers=[{byteLength:0}]),n.push(e),0}},{key:"processBufferView",value:function(e,t,n,r,i){var a,o=this.json;o.bufferViews||(o.bufferViews=[]),a=t===cP?1:t===hP?2:4;for(var s=AP(r*e.itemSize*a),u=new DataView(new ArrayBuffer(s)),l=0,c=n;c<n+r;c++)for(var h=0;h<e.itemSize;h++){var f=void 0;e.itemSize>4?f=e.array[c*e.itemSize+h]:0===h?f=e.getX(c):1===h?f=e.getY(c):2===h?f=e.getZ(c):3===h&&(f=e.getW(c)),t===fP?u.setFloat32(l,f,!0):t===dP?u.setUint32(l,f,!0):t===hP?u.setUint16(l,f,!0):t===cP&&u.setUint8(l,f),l+=a}var d={buffer:this.processBuffer(u.buffer),byteOffset:this.byteOffset,byteLength:s};return void 0!==i&&(d.target=i),i===pP&&(d.byteStride=e.itemSize*a),this.byteOffset+=s,o.bufferViews.push(d),{id:o.bufferViews.length-1,byteLength:0}}},{key:"processBufferViewImage",value:function(e){var t=this,n=t.json;return n.bufferViews||(n.bufferViews=[]),new Promise((function(r){var i=new window.FileReader;i.readAsArrayBuffer(e),i.onloadend=function(){var e=RP(i.result),a={buffer:t.processBuffer(e),byteOffset:t.byteOffset,byteLength:e.byteLength};t.byteOffset+=e.byteLength,r(n.bufferViews.push(a)-1)}}))}},{key:"processAccessor",value:function(e,t,n,r){var i,a=this.options,o=this.json;if(e.array.constructor===Float32Array)i=fP;else if(e.array.constructor===Uint32Array)i=dP;else if(e.array.constructor===Uint16Array)i=hP;else{if(e.array.constructor!==Uint8Array)throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type.");i=cP}if(void 0===n&&(n=0),void 0===r&&(r=e.count),a.truncateDrawRange&&void 0!==t&&null===t.index){var s=n+r,u=t.drawRange.count===1/0?e.count:t.drawRange.start+t.drawRange.count;n=Math.max(n,t.drawRange.start),(r=Math.min(s,u)-n)<0&&(r=0)}if(0===r)return null;var l,c=function(e,t,n){for(var r={min:new Array(e.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(e.itemSize).fill(Number.NEGATIVE_INFINITY)},i=t;i<t+n;i++)for(var a=0;a<e.itemSize;a++){var o=void 0;e.itemSize>4?o=e.array[i*e.itemSize+a]:0===a?o=e.getX(i):1===a?o=e.getY(i):2===a?o=e.getZ(i):3===a&&(o=e.getW(i)),r.min[a]=Math.min(r.min[a],o),r.max[a]=Math.max(r.max[a],o)}return r}(e,n,r);void 0!==t&&(l=e===t.index?vP:pP);var h=this.processBufferView(e,i,n,r,l),f={bufferView:h.id,byteOffset:h.byteOffset,componentType:i,count:r,max:c.max,min:c.min,type:{1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",16:"MAT4"}[e.itemSize]};return!0===e.normalized&&(f.normalized=!0),o.accessors||(o.accessors=[]),o.accessors.push(f)-1}},{key:"processImage",value:function(e,t,n){var r=this,i=r.cache,a=r.json,o=r.options,s=r.pending;i.images.has(e)||i.images.set(e,{});var u=i.images.get(e),l=t===oa?"image/png":"image/jpeg",c=l+":flipY/"+n.toString();if(void 0!==u[c])return u[c];a.images||(a.images=[]);var h={mimeType:l};if(o.embedImages){var f=PP=PP||document.createElement("canvas");f.width=Math.min(e.width,o.maxTextureSize),f.height=Math.min(e.height,o.maxTextureSize);var d=f.getContext("2d");if(!0===n&&(d.translate(0,f.height),d.scale(1,-1)),"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap)d.drawImage(e,0,0,f.width,f.height);else{t!==oa&&t!==aa&&console.error("GLTFExporter: Only RGB and RGBA formats are supported."),(e.width>o.maxTextureSize||e.height>o.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",e);var p=new Uint8ClampedArray(e.height*e.width*4);if(t===oa)for(var v=0;v<p.length;v+=4)p[v+0]=e.data[v+0],p[v+1]=e.data[v+1],p[v+2]=e.data[v+2],p[v+3]=e.data[v+3];else for(var m=0,g=0;m<p.length;m+=4,g+=3)p[m+0]=e.data[g+0],p[m+1]=e.data[g+1],p[m+2]=e.data[g+2],p[m+3]=255;d.putImageData(new ImageData(p,e.width,e.height),0,0)}!0===o.binary?s.push(new Promise((function(e){f.toBlob((function(t){r.processBufferViewImage(t).then((function(t){h.bufferView=t,e()}))}),l)}))):h.uri=f.toDataURL(l)}else h.uri=e.src;var y=a.images.push(h)-1;return u[c]=y,y}},{key:"processSampler",value:function(e){var t=this.json;t.samplers||(t.samplers=[]);var n={magFilter:kP[e.magFilter],minFilter:kP[e.minFilter],wrapS:kP[e.wrapS],wrapT:kP[e.wrapT]};return t.samplers.push(n)-1}},{key:"processTexture",value:function(e){var t=this.cache,n=this.json;if(t.textures.has(e))return t.textures.get(e);n.textures||(n.textures=[]);var r={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY)};e.name&&(r.name=e.name),this._invokeAll((function(t){t.writeTexture&&t.writeTexture(e,r)}));var i=n.textures.push(r)-1;return t.textures.set(e,i),i}},{key:"processMaterial",value:function(e){var t=this.cache,n=this.json;if(t.materials.has(e))return t.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;n.materials||(n.materials=[]);var r={pbrMetallicRoughness:{}};!0!==e.isMeshStandardMaterial&&!0!==e.isMeshBasicMaterial&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");var i=e.color.toArray().concat([e.opacity]);if(EP(i,[1,1,1,1])||(r.pbrMetallicRoughness.baseColorFactor=i),e.isMeshStandardMaterial?(r.pbrMetallicRoughness.metallicFactor=e.metalness,r.pbrMetallicRoughness.roughnessFactor=e.roughness):(r.pbrMetallicRoughness.metallicFactor=.5,r.pbrMetallicRoughness.roughnessFactor=.5),e.metalnessMap||e.roughnessMap)if(e.metalnessMap===e.roughnessMap){var a={index:this.processTexture(e.metalnessMap)};this.applyTextureTransform(a,e.metalnessMap),r.pbrMetallicRoughness.metallicRoughnessTexture=a}else console.warn("THREE.GLTFExporter: Ignoring metalnessMap and roughnessMap because they are not the same Texture.");if(e.map){var o={index:this.processTexture(e.map)};this.applyTextureTransform(o,e.map),r.pbrMetallicRoughness.baseColorTexture=o}if(e.emissive){var s=e.emissive.clone().multiplyScalar(e.emissiveIntensity),u=Math.max(s.r,s.g,s.b);if(u>1&&(s.multiplyScalar(1/u),console.warn("THREE.GLTFExporter: Some emissive components exceed 1; emissive has been limited")),u>0&&(r.emissiveFactor=s.toArray()),e.emissiveMap){var l={index:this.processTexture(e.emissiveMap)};this.applyTextureTransform(l,e.emissiveMap),r.emissiveTexture=l}}if(e.normalMap){var c={index:this.processTexture(e.normalMap)};e.normalScale&&1!==e.normalScale.x&&(c.scale=e.normalScale.x),this.applyTextureTransform(c,e.normalMap),r.normalTexture=c}if(e.aoMap){var h={index:this.processTexture(e.aoMap),texCoord:1};1!==e.aoMapIntensity&&(h.strength=e.aoMapIntensity),this.applyTextureTransform(h,e.aoMap),r.occlusionTexture=h}e.transparent?r.alphaMode="BLEND":e.alphaTest>0&&(r.alphaMode="MASK",r.alphaCutoff=e.alphaTest),e.side===Fr&&(r.doubleSided=!0),""!==e.name&&(r.name=e.name),this.serializeUserData(e,r),this._invokeAll((function(t){t.writeMaterial&&t.writeMaterial(e,r)}));var f=n.materials.push(r)-1;return t.materials.set(e,f),f}},{key:"processMesh",value:function(e){var t=this.cache,n=this.json,r=[e.geometry.uuid];if(Array.isArray(e.material))for(var i=0,a=e.material.length;i<a;i++)r.push(e.material[i].uuid);else r.push(e.material.uuid);var o=r.join(":");if(t.meshes.has(o))return t.meshes.get(o);var s,u=e.geometry;if(s=e.isLineSegments?oP:e.isLineLoop?sP:e.isLine?uP:e.isPoints?aP:e.material.wireframe?oP:lP,!0!==u.isBufferGeometry)throw new Error("THREE.GLTFExporter: Geometry is not of type THREE.BufferGeometry.");var l={},c={},h=[],f=[],d={uv:"TEXCOORD_0",uv2:"TEXCOORD_1",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},p=u.getAttribute("normal");void 0===p||this.isNormalizedNormalAttribute(p)||(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),u.setAttribute("normal",this.createNormalizedNormalAttribute(p)));var v=null;for(var m in u.attributes)if("morph"!==m.substr(0,5)){var g=u.attributes[m];m=d[m]||m.toUpperCase();if(/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(m)||(m="_"+m),t.attributes.has(this.getUID(g)))c[m]=t.attributes.get(this.getUID(g));else{v=null;var y=g.array;"JOINTS_0"!==m||y instanceof Uint16Array||y instanceof Uint8Array||(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),v=new ol(new Uint16Array(y),g.itemSize,g.normalized));var b=this.processAccessor(v||g,u);null!==b&&(c[m]=b,t.attributes.set(this.getUID(g),b))}}if(void 0!==p&&u.setAttribute("normal",p),0===Object.keys(c).length)return null;if(void 0!==e.morphTargetInfluences&&e.morphTargetInfluences.length>0){var _=[],x=[],w={};if(void 0!==e.morphTargetDictionary)for(var S in e.morphTargetDictionary)w[e.morphTargetDictionary[S]]=S;for(var M=0;M<e.morphTargetInfluences.length;++M){var k={},T=!1;for(var E in u.morphAttributes)if("position"===E||"normal"===E){var C=u.morphAttributes[E][M],A=E.toUpperCase(),R=u.attributes[E];if(t.attributes.has(this.getUID(C)))k[A]=t.attributes.get(this.getUID(C));else{var P=C.clone();if(!u.morphTargetsRelative)for(var L=0,D=C.count;L<D;L++)P.setXYZ(L,C.getX(L)-R.getX(L),C.getY(L)-R.getY(L),C.getZ(L)-R.getZ(L));k[A]=this.processAccessor(P,u),t.attributes.set(this.getUID(R),k[A])}}else T||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),T=!0);f.push(k),_.push(e.morphTargetInfluences[M]),void 0!==e.morphTargetDictionary&&x.push(w[M])}l.weights=_,x.length>0&&(l.extras={},l.extras.targetNames=x)}var N=Array.isArray(e.material);if(N&&0===u.groups.length)return null;for(var I=N?e.material:[e.material],O=N?u.groups:[{materialIndex:0,start:void 0,count:void 0}],U=0,F=O.length;U<F;U++){var z={mode:s,attributes:c};if(this.serializeUserData(u,z),f.length>0&&(z.targets=f),null!==u.index){var B=this.getUID(u.index);void 0===O[U].start&&void 0===O[U].count||(B+=":"+O[U].start+":"+O[U].count),t.attributes.has(B)?z.indices=t.attributes.get(B):(z.indices=this.processAccessor(u.index,u,O[U].start,O[U].count),t.attributes.set(B,z.indices)),null===z.indices&&delete z.indices}var V=this.processMaterial(I[O[U].materialIndex]);null!==V&&(z.material=V),h.push(z)}l.primitives=h,n.meshes||(n.meshes=[]),this._invokeAll((function(t){t.writeMesh&&t.writeMesh(e,l)}));var G=n.meshes.push(l)-1;return t.meshes.set(o,G),G}},{key:"processCamera",value:function(e){var t=this.json;t.cameras||(t.cameras=[]);var n=e.isOrthographicCamera,r={type:n?"orthographic":"perspective"};return n?r.orthographic={xmag:2*e.right,ymag:2*e.top,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:r.perspective={aspectRatio:e.aspect,yfov:ms.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},""!==e.name&&(r.name=e.type),t.cameras.push(r)-1}},{key:"processAnimation",value:function(e,t){var n=this.json,r=this.nodeMap;n.animations||(n.animations=[]);for(var i=(e=iP.Utils.mergeMorphTargetTracks(e.clone(),t)).tracks,a=[],o=[],s=0;s<i.length;++s){var u=i[s],l=kg.parseTrackName(u.name),c=kg.findNode(t,l.nodeName),h=TP[l.propertyName];if("bones"===l.objectName&&(c=!0===c.isSkinnedMesh?c.skeleton.getBoneByName(l.objectIndex):void 0),!c||!h)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',u.name),null;var f=u.values.length/u.times.length;h===TP.morphTargetInfluences&&(f/=c.morphTargetInfluences.length);var d=void 0;!0===u.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(d="CUBICSPLINE",f/=3):d=u.getInterpolation()===so?"STEP":"LINEAR",o.push({input:this.processAccessor(new ol(u.times,1)),output:this.processAccessor(new ol(u.values,f)),interpolation:d}),a.push({sampler:o.length-1,target:{node:r.get(c),path:h}})}return n.animations.push({name:e.name||"clip_"+n.animations.length,samplers:o,channels:a}),n.animations.length-1}},{key:"processSkin",value:function(e){var t=this.json,n=this.nodeMap,r=t.nodes[n.get(e)],i=e.skeleton;if(void 0===i)return null;var a=e.skeleton.bones[0];if(void 0===a)return null;for(var o=[],s=new Float32Array(16*i.bones.length),u=new hu,l=0;l<i.bones.length;++l)o.push(n.get(i.bones[l])),u.copy(i.boneInverses[l]),u.multiply(e.bindMatrix).toArray(s,16*l);return void 0===t.skins&&(t.skins=[]),t.skins.push({inverseBindMatrices:this.processAccessor(new ol(s,16)),joints:o,skeleton:n.get(a)}),r.skin=t.skins.length-1}},{key:"processNode",value:function(e){var t=this.json,n=this.options,r=this.nodeMap;t.nodes||(t.nodes=[]);var i={};if(n.trs){var a=e.quaternion.toArray(),o=e.position.toArray(),s=e.scale.toArray();EP(a,[0,0,0,1])||(i.rotation=a),EP(o,[0,0,0])||(i.translation=o),EP(s,[1,1,1])||(i.scale=s)}else e.matrixAutoUpdate&&e.updateMatrix(),!1===EP(e.matrix.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])&&(i.matrix=e.matrix.elements);if(""!==e.name&&(i.name=String(e.name)),this.serializeUserData(e,i),e.isMesh||e.isLine||e.isPoints){var u=this.processMesh(e);null!==u&&(i.mesh=u)}else e.isCamera&&(i.camera=this.processCamera(e));if(e.isSkinnedMesh&&this.skins.push(e),e.children.length>0){for(var l=[],c=0,h=e.children.length;c<h;c++){var f=e.children[c];if(f.visible||!1===n.onlyVisible){var d=this.processNode(f);null!==d&&l.push(d)}}l.length>0&&(i.children=l)}this._invokeAll((function(t){t.writeNode&&t.writeNode(e,i)}));var p=t.nodes.push(i)-1;return r.set(e,p),p}},{key:"processScene",value:function(e){var t=this.json,n=this.options;t.scenes||(t.scenes=[],t.scene=0);var r={};""!==e.name&&(r.name=e.name),t.scenes.push(r);for(var i=[],a=0,o=e.children.length;a<o;a++){var s=e.children[a];if(s.visible||!1===n.onlyVisible){var u=this.processNode(s);null!==u&&i.push(u)}}i.length>0&&(r.nodes=i),this.serializeUserData(e,r)}},{key:"processObjects",value:function(e){var t=new rd;t.name="AuxScene";for(var n=0;n<e.length;n++)t.children.push(e[n]);this.processScene(t)}},{key:"processInput",value:function(e){var t=this.options;e=e instanceof Array?e:[e],this._invokeAll((function(t){t.beforeParse&&t.beforeParse(e)}));for(var n=[],r=0;r<e.length;r++)e[r]instanceof rd?this.processScene(e[r]):n.push(e[r]);n.length>0&&this.processObjects(n);for(var i=0;i<this.skins.length;++i)this.processSkin(this.skins[i]);for(var a=0;a<t.animations.length;++a)this.processAnimation(t.animations[a],e[0]);this._invokeAll((function(t){t.afterParse&&t.afterParse(e)}))}},{key:"_invokeAll",value:function(e){for(var t=0,n=this.plugins.length;t<n;t++)e(this.plugins[t])}}]),e}(),DP=function(){function e(t){(0,u.Z)(this,e),this.writer=t,this.name="KHR_lights_punctual"}return(0,l.Z)(e,[{key:"writeNode",value:function(e,t){if(e.isLight)if(e.isDirectionalLight||e.isPointLight||e.isSpotLight){var n=this.writer,r=n.json,i=n.extensionsUsed,a={};e.name&&(a.name=e.name),a.color=e.color.toArray(),a.intensity=e.intensity,e.isDirectionalLight?a.type="directional":e.isPointLight?(a.type="point",e.distance>0&&(a.range=e.distance)):e.isSpotLight&&(a.type="spot",e.distance>0&&(a.range=e.distance),a.spot={},a.spot.innerConeAngle=(e.penumbra-1)*e.angle*-1,a.spot.outerConeAngle=e.angle),void 0!==e.decay&&2!==e.decay&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),!e.target||e.target.parent===e&&0===e.target.position.x&&0===e.target.position.y&&-1===e.target.position.z||console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),i[this.name]||(r.extensions=r.extensions||{},r.extensions[this.name]={lights:[]},i[this.name]=!0);var o=r.extensions[this.name].lights;o.push(a),t.extensions=t.extensions||{},t.extensions[this.name]={light:o.length-1}}else console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e)}}]),e}(),NP=function(){function e(t){(0,u.Z)(this,e),this.writer=t,this.name="KHR_materials_unlit"}return(0,l.Z)(e,[{key:"writeMaterial",value:function(e,t){if(e.isMeshBasicMaterial){var n=this.writer.extensionsUsed;t.extensions=t.extensions||{},t.extensions[this.name]={},n[this.name]=!0,t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9}}}]),e}(),IP=function(){function e(t){(0,u.Z)(this,e),this.writer=t,this.name="KHR_materials_pbrSpecularGlossiness"}return(0,l.Z)(e,[{key:"writeMaterial",value:function(e,t){if(e.isGLTFSpecularGlossinessMaterial){var n=this.writer,r=n.extensionsUsed,i={};t.pbrMetallicRoughness.baseColorFactor&&(i.diffuseFactor=t.pbrMetallicRoughness.baseColorFactor);var a=[1,1,1];if(e.specular.toArray(a,0),i.specularFactor=a,i.glossinessFactor=e.glossiness,t.pbrMetallicRoughness.baseColorTexture&&(i.diffuseTexture=t.pbrMetallicRoughness.baseColorTexture),e.specularMap){var o={index:n.processTexture(e.specularMap)};n.applyTextureTransform(o,e.specularMap),i.specularGlossinessTexture=o}t.extensions=t.extensions||{},t.extensions[this.name]=i,r[this.name]=!0}}}]),e}(),OP=function(){function e(t){(0,u.Z)(this,e),this.writer=t,this.name="KHR_materials_clearcoat"}return(0,l.Z)(e,[{key:"writeMaterial",value:function(e,t){if(e.isMeshPhysicalMaterial){var n=this.writer,r=n.extensionsUsed,i={};if(i.clearcoatFactor=e.clearcoat,e.clearcoatMap){var a={index:n.processTexture(e.clearcoatMap)};n.applyTextureTransform(a,e.clearcoatMap),i.clearcoatTexture=a}if(i.clearcoatRoughnessFactor=e.clearcoatRoughness,e.clearcoatRoughnessMap){var o={index:n.processTexture(e.clearcoatRoughnessMap)};n.applyTextureTransform(o,e.clearcoatRoughnessMap),i.clearcoatRoughnessTexture=o}if(e.clearcoatNormalMap){var s={index:n.processTexture(e.clearcoatNormalMap)};n.applyTextureTransform(s,e.clearcoatNormalMap),i.clearcoatNormalTexture=s}t.extensions=t.extensions||{},t.extensions[this.name]=i,r[this.name]=!0}}}]),e}(),UP=function(){function e(t){(0,u.Z)(this,e),this.writer=t,this.name="KHR_materials_transmission"}return(0,l.Z)(e,[{key:"writeMaterial",value:function(e,t){if(e.isMeshPhysicalMaterial&&0!==e.transmission){var n=this.writer,r=n.extensionsUsed,i={};if(i.transmissionFactor=e.transmission,e.transmissionMap){var a={index:n.processTexture(e.transmissionMap)};n.applyTextureTransform(a,e.transmissionMap),i.transmissionTexture=a}t.extensions=t.extensions||{},t.extensions[this.name]=i,r[this.name]=!0}}}]),e}(),FP=function(){function e(t){(0,u.Z)(this,e),this.writer=t,this.name="KHR_materials_volume"}return(0,l.Z)(e,[{key:"writeMaterial",value:function(e,t){if(e.isMeshPhysicalMaterial&&0!==e.transmission){var n=this.writer,r=n.extensionsUsed,i={};if(i.thicknessFactor=e.thickness,e.thicknessMap){var a={index:n.processTexture(e.thicknessMap)};n.applyTextureTransform(a,e.thicknessMap),i.thicknessTexture=a}i.attenuationDistance=e.attenuationDistance,i.attenuationColor=e.attenuationColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=i,r[this.name]=!0}}}]),e}();function zP(e,t,n){console.log(e),t.endsWith(".json")||(t+=".json"),e instanceof Object&&(e=JSON.stringify(e,void 0,n));var r="data:application/json;charset=utf-8,"+encodeURIComponent(e),i=document.createElement("A");i.setAttribute("href",r),i.setAttribute("download",t),document.body.appendChild(i),i.click(),document.body.removeChild(i)}iP.Utils={insertKeyframe:function(e,t){var n,r=.001,i=e.getValueSize(),a=new e.TimeBufferType(e.times.length+1),o=new e.ValueBufferType(e.values.length+i),s=e.createInterpolant(new e.ValueBufferType(i));if(0===e.times.length){a[0]=t;for(var u=0;u<i;u++)o[u]=0;n=0}else if(t<e.times[0]){if(Math.abs(e.times[0]-t)<r)return 0;a[0]=t,a.set(e.times,1),o.set(s.evaluate(t),0),o.set(e.values,i),n=0}else if(t>e.times[e.times.length-1]){if(Math.abs(e.times[e.times.length-1]-t)<r)return e.times.length-1;a[a.length-1]=t,a.set(e.times,0),o.set(e.values,0),o.set(s.evaluate(t),e.values.length),n=a.length-1}else for(var l=0;l<e.times.length;l++){if(Math.abs(e.times[l]-t)<r)return l;if(e.times[l]<t&&e.times[l+1]>t){a.set(e.times.slice(0,l+1),0),a[l+1]=t,a.set(e.times.slice(l+1),l+2),o.set(e.values.slice(0,(l+1)*i),0),o.set(s.evaluate(t),(l+1)*i),o.set(e.values.slice((l+1)*i),(l+2)*i),n=l+1;break}}return e.times=a,e.values=o,n},mergeMorphTargetTracks:function(e,t){for(var n=[],r={},i=e.tracks,a=0;a<i.length;++a){var o=i[a],s=kg.parseTrackName(o.name),u=kg.findNode(t,s.nodeName);if("morphTargetInfluences"===s.propertyName&&void 0!==s.propertyIndex){if(o.createInterpolant!==o.InterpolantFactoryMethodDiscrete&&o.createInterpolant!==o.InterpolantFactoryMethodLinear){if(o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),(o=o.clone()).setInterpolation(uo)}var l=u.morphTargetInfluences.length,c=u.morphTargetDictionary[s.propertyIndex];if(void 0===c)throw new Error("THREE.GLTFExporter: Morph target name not found: "+s.propertyIndex);var h=void 0;if(void 0!==r[u.uuid]){var f=o.createInterpolant(new o.ValueBufferType(1));h=r[u.uuid];for(var d=0;d<h.times.length;d++)h.values[d*l+c]=f.evaluate(h.times[d]);for(var p=0;p<o.times.length;p++){var v=this.insertKeyframe(h,o.times[p]);h.values[v*l+c]=o.values[p]}}else{for(var m=new((h=o.clone()).ValueBufferType)(l*h.times.length),g=0;g<h.times.length;g++)m[g*l+c]=h.values[g];h.name=(s.nodeName||"")+".morphTargetInfluences",h.values=m,r[u.uuid]=h,n.push(h)}}else n.push(o)}return e.tracks=n,e}};var BP,VP="line",GP="tube",jP="cone",HP=jP,WP=function(){function e(t,n,r,i,a,o,s,l,c,h){var f=arguments.length>10&&void 0!==arguments[10]?arguments[10]:HP;(0,u.Z)(this,e),this._id=void 0,this._parentScene=void 0,this._points=void 0,this._currPosGeom=void 0,this._currPosGeomArray=void 0,this._color=void 0,this._is_visible=void 0,this._opacity=void 0,this._rootGroup=void 0,this._trace_type=void 0,this._parentRobot=void 0,this._robotPart=void 0,this._times=void 0,this._currRotGeom=void 0,this._currRotGeomArray=void 0,this._rotations=void 0,this._density=void 0,this._axisSize=void 0,this._traceSize=void 0,this._timespan=void 0,this._timespanIndex=void 0,this._color=void 0===c?Pb():c,this._trace_type=HP,this._id=(new Yb).value(),this._timespan=l,this._timespanIndex=[],this._currPosGeomArray=[],this._currRotGeomArray=[],this._rootGroup=new cb.Group,this._currPosGeom=this.newPosGeom(),this._rootGroup.add(this._currPosGeom),this._currRotGeom=this.newRotGeom(),this._rootGroup.add(this._currRotGeom),this._is_visible=!0,this._points=[],this._parentRobot=n,this._robotPart=r,this._times=i,this._opacity=1,this._rotations=[],this._density=a,this._axisSize=o,this._traceSize=s,console.log(s),this._parentScene=new nP(void 0),this.update(t,n,r,i,f,h);var d=new WeakRef(this);n.afterParentSceneSet().subscribe((function(e){var t=vr(e,2)[1],n=d.deref();return void 0!==n&&(void 0===t?(n.setParentScene(void 0),!1):(n.updatePoints(),!0))})),n.afterpositionOffsetSet().subscribe((function(){var e=d.deref();return void 0!==e&&(e.updatePoints(),!0)}))}return(0,l.Z)(e,[{key:"id",value:function(){return this._id}},{key:"density",value:function(){return this._density}},{key:"setDensity",value:function(e){this._density=e,this.updateRot(this._rotations)}},{key:"axisSize",value:function(){return this._axisSize}},{key:"setAxisSize",value:function(e){this._axisSize=e,this.updateRot(this._rotations)}},{key:"rotations",value:function(){return this._rotations}},{key:"timespanIndex",value:function(){return this._timespanIndex}},{key:"updateTimespan",value:function(e){var t,n;if(2===e.length&&void 0!==this._times){this._timespan=e;var r=0,i=this._times.length-1;if(null!==(t=this._parentRobot.parentScene())&&void 0!==t&&t.isTimeWarping()){var a,o,s,u,l=null===(a=this._parentRobot.parentScene())||void 0===a||null===(o=a.timeWarping())||void 0===o?void 0:o.timeWarpMap(),c=null===(s=this._parentRobot.parentScene())||void 0===s||null===(u=s.timeWarping())||void 0===u?void 0:u.indexMap();if(void 0===l||void 0===c)return;for(var h=0;h<l[1].length;h++)if(l[0][h]>=e[0]){r=c[1][h];break}for(var f=l[1].length-1;f>=0;f--)if(l[0][f]<=e[1]){i=c[1][f];break}}else{for(var d=0;d<this._times.length;d++)if(this._times[d]>=e[0]){r=d;break}for(var p=this._times.length-1;p>=0;p--)if(this._times[p]<=e[1]){i=p;break}}this._timespanIndex=[r,i];for(var v=0;v<this._currPosGeomArray.length;v++)void 0!==this._currPosGeomArray[v]&&(this._currPosGeomArray[v].visible=!(v<r||v>i));for(var m=Math.round(1/this._density),g=0;g<this._currRotGeomArray.length;g+=m)void 0!==this._currRotGeomArray[g]&&(this._currRotGeomArray[g].visible=!(g<r||g>i));null===(n=this.parentScene())||void 0===n||n.render()}}},{key:"setTraceSize",value:function(e){for(var t,n=0;n<this._currPosGeomArray.length;n++)void 0!==this._currPosGeomArray[n]&&this._currPosGeomArray[n].scale.set(e,e,e);this._traceSize=e,null===(t=this.parentScene())||void 0===t||t.render()}},{key:"updatePoints",value:function(){var e=this.robot(),t=e.parentScene();if(!t)return!1;var n,r=this.robotPart();if(r instanceof $R)n=t.frameDataFor(e,this.times(),r,!0).jointPositions;else{if(!(r instanceof eP))throw new Error("Invalid robotPart type");n=t.frameDataFor(e,this.times(),r,!0).linkPositions}return this.setPoints(n),!0}},{key:"beforeParentSceneSet",value:function(){return this._parentScene.beforeSet()}},{key:"afterParentSceneSet",value:function(){return this._parentScene.afterSet()}},{key:"robot",value:function(){return this._parentRobot}},{key:"robotPart",value:function(){return this._robotPart}},{key:"times",value:function(){return this._times}},{key:"color",value:function(){return this._color}},{key:"traverseMeshes",value:function(e){this._rootGroup.traverse((function(t){KR(t)&&e(t)}))}},{key:"traverseMaterials",value:function(e){this._rootGroup.traverse((function(t){_b(t.material,e)}))}},{key:"visible",value:function(){return this._is_visible}},{key:"setVisible",value:function(e){e!==this._is_visible&&(this.traverseMeshes((function(t){t.visible=e})),this._is_visible=e,lr.updateUI(),lr.render())}},{key:"opacity",value:function(){return this._opacity}},{key:"setOpacity",value:function(e){var t=this;this._opacity=Lb(e,0,1),this.traverseMaterials((function(e){e.opacity=t._opacity})),lr.updateUI(),lr.render()}},{key:"parentScene",value:function(){return this._parentScene.value()}},{key:"setTraceType",value:function(e){this.update(this._points,this._parentRobot,this._robotPart,this.times(),e)}},{key:"traceType",value:function(){return this._trace_type}},{key:"newPosGeom",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:HP;void 0===e&&(e=[]),0===e.length?e.push(new cb.Vector3,new cb.Vector3):1===e.length&&e.push(e[0].clone());var n=new cb.CatmullRomCurve3(e,!1);if(t===VP){var r=(new cb.BufferGeometry).setFromPoints(n.getPoints(e.length)),i=new cb.LineBasicMaterial({color:new cb.Color(this._color).convertSRGBToLinear()});return new cb.Line(r,i)}if(t===GP){var a=new cb.TubeGeometry(n,2*e.length,.005,8,!0),o=new cb.MeshBasicMaterial({color:new cb.Color(this._color).convertSRGBToLinear()});return new cb.Mesh(a,o)}if(t===jP){var s=new cb.Group,u=new cb.Matrix4,l=new cb.MeshBasicMaterial({color:new cb.Color(this._color).convertSRGBToLinear()});this._currPosGeomArray=[];for(var c=0;c<e.length-1;c++){var h=e[c],f=e[c+1],d=h.distanceTo(f);if(0!==d){var p=.005,v=d,m=new cb.Mesh(new cb.ConeGeometry(p,v),l);m.rotateX(Math.PI/2);var g=new cb.Group;g.add(m),g.position.copy(h),u.lookAt(f,h,g.up),g.quaternion.setFromRotationMatrix(u);var y=new cb.Vector3;y.subVectors(f,h).normalize(),g.position.addScaledVector(y,d/2),s.add(g),this._currPosGeomArray[c]=g,this._currPosGeomArray[c].scale.set(this._traceSize,this._traceSize,this._traceSize)}}return this.updateTimespan(this._timespan),s}throw new Error('Unknown LineTraceType "'.concat(t,'"'))}},{key:"newRotGeom",value:function(e){void 0===e&&(e=this._rotations);var t=this._points;void 0===t&&(t=[]),0===t.length?t.push(new cb.Vector3,new cb.Vector3):1===t.length&&t.push(t[0].clone());var n=new cb.Group,r=Math.round(1/this._density);this._currRotGeomArray=[];for(var i=0;i<t.length-1;i+=r){var a=t[i],o=new cb.AxesHelper(this._axisSize);void 0!==e&&o.setRotationFromQuaternion(e[i]),o.position.copy(a),n.add(o),this._currRotGeomArray[i]=o}return this.updateTimespan(this._timespan),n}},{key:"setParentScene",value:function(e){var t=this;e!==this._parentScene.value()&&(this._parentScene.setValue((function(e,n){e&&(e.scene().remove(t._rootGroup),e.render())}),e,(function(e,n){void 0!==n&&(n.scene().add(t._rootGroup),n.render())})),lr.updateUI())}},{key:"points",value:function(){return this._points}},{key:"clonedPoints",value:function(){return this._points.map((function(e){return e.clone()}))}},{key:"setPoints",value:function(e){this.update(e,this._parentRobot,this._robotPart,this.times(),this._trace_type)}},{key:"update",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:HP,a=arguments.length>5?arguments[5]:void 0;this._points=e,this._parentRobot=t,this._robotPart=n,this._times=r,void 0!==a&&(this._rotations=a),this.updateRot(a);var o=this.newPosGeom(e,i);this._rootGroup.remove(this._currPosGeom),this._currPosGeom=o,this._rootGroup.add(this._currPosGeom),this._trace_type=i}},{key:"updateRot",value:function(e){var t=this.newRotGeom(e);this._rootGroup.remove(this._currRotGeom),this._currRotGeom=t,this._rootGroup.add(this._currRotGeom)}},{key:"clone",value:function(){var t,n=[],r=s(this._points);try{for(r.s();!(t=r.n()).done;){var i=t.value;n.push(i.clone())}}catch(x2){r.e(x2)}finally{r.f()}var a=new e(n,this._parentRobot,this._robotPart,this.times(),this._density,this._axisSize,this._traceSize,this._timespan,this._color,this._rotations,this._trace_type);return a.setVisible(this._is_visible),a._color=this._color,a}}]),e}(),ZP=function(){function e(t){(0,u.Z)(this,e),this._beforeDestroyed=void 0,this._value=void 0,this._afterDestroyed=void 0,this._value=t,this._beforeDestroyed=new tP,this._afterDestroyed=new tP}return(0,l.Z)(e,[{key:"beforeDestroyed",value:function(){return this._beforeDestroyed}},{key:"afterDestroyed",value:function(){return this._afterDestroyed}},{key:"isAlive",value:function(){return!this.isDestroyed()}},{key:"isDestroyed",value:function(){return void 0===this._value}},{key:"deref",value:function(){return this._value}},{key:"ifElseAlive",value:function(e,t){var n=this._value;return void 0!==n?e(n):t()}},{key:"ifAlive",value:function(e){var t=this._value;t&&e(t)}},{key:"destroy",value:function(){var e=this._value;void 0!==e&&(this._beforeDestroyed.call(e),this._value=void 0,this._afterDestroyed.call(e))}}]),e}();BP=Symbol.iterator;var qP=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if((0,u.Z)(this,e),this._objs=void 0,this._objs=[],t){var n,r=s(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.push(i)}}catch(x2){r.e(x2)}finally{r.f()}}}return(0,l.Z)(e,[{key:"destroyContents",value:function(){var e,t=s(this._objs);try{for(t.s();!(e=t.n()).done;){vr(e.value,2)[1].destroy()}}catch(x2){t.e(x2)}finally{t.f()}this.clean()}},{key:"clean",value:function(){for(var e=0;e<this._objs.length;){void 0!==this._objs[e][1].deref()?e+=1:this._objs.splice(e,1)}}},{key:"contains",value:function(e){var t,n=s(this);try{for(n.s();!(t=n.n()).done;){if(t.value===e)return!0}}catch(x2){n.e(x2)}finally{n.f()}return!1}},{key:"push",value:function(e){var t=this,n=new WeakRef(e),r=e.beforeDestroyed().subscribe((function(){var e,r=null===(e=n.deref())||void 0===e?void 0:e.deref();return void 0!==r&&(t.remove(r),!0)}));this._objs.push([r,e])}},{key:"remove",value:function(e){for(var t=0;t<this._objs.length;t++){var n=vr(this._objs[t],2),r=n[0],i=n[1].deref();if(void 0!==i){if(i===e)return this._objs.splice(t,1),r(),!0}else this._objs.splice(t,1),t--}return!1}},{key:"length",get:function(){var e,t=0,n=s(this);try{for(n.s();!(e=n.n()).done;){e.value;t+=1}}catch(x2){n.e(x2)}finally{n.f()}return t}},{key:"aliveContents",value:function(){var e=fr().mark(n),t=this;function n(){var n,r,i,a,o;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<t._objs.length)){e.next=15;break}if(r=vr(t._objs[n],2),i=r[0],a=r[1],void 0===(o=a.deref())){e.next=9;break}return e.next=7,[o,a];case 7:e.next=12;break;case 9:t._objs.splice(n,1),i(),n--;case 12:n++,e.next=1;break;case 15:case"end":return e.stop()}}),e)}return n()}},{key:BP,value:function(){var e=fr().mark(n),t=this;function n(){var n,r,i,a,o;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<t._objs.length)){e.next=16;break}if(r=vr(t._objs[n],2),i=r[0],a=r[1],void 0===(o=a.deref())){e.next=10;break}return e.next=7,o;case 7:n+=1,e.next=13;break;case 10:t._objs.splice(n,1),i(),n--;case 13:n++,e.next=1;break;case 16:case"end":return e.stop()}}),e)}return n()}}]),e}(),XP=(0,l.Z)((function e(t,n,r){var i=this;(0,u.Z)(this,e),this._ts1=void 0,this._ts2=void 0,this._distFunction=void 0,this._indexMap=void 0,this._valueMap=void 0,this.ts1=function(){return i._ts1},this.ts2=function(){return i._ts2},this.distFunction=function(){return i._distFunction},this.indexMap=function(){return i._indexMap},this.valueMap=function(){return i._valueMap},this.doTimeWarp=function(e,t,n,r){var i;return e<t[0]?e=t[0]:e>=t[t.length-1]&&(e=t[t.length-1]),null!==(i=n[Math.min(Fb(t,e),t.length-1)])&&void 0!==i?i:e},this.timeWarpMap=function(){return i._valueMap},this.timeWarp=function(e,t){var n=vr(i.timeWarpMap(),2),r=n[0],a=n[1];return i.doTimeWarp(e,r,a,t)},this.untimeWarp=function(e,t){var n=vr(i.timeWarpMap(),2),r=n[0],a=n[1];return i.doTimeWarp(e,a,r,t)},this._ts1=t,this._ts2=n,this._distFunction=r,this._indexMap=function(e,t,n){for(var r=[],i=0;i<e.length;i++){r[i]=[];for(var a=0;a<t.length;a++){var o=1/0;i>0?(o=Math.min(o,r[i-1][a]),a>0&&(o=Math.min(o,r[i-1][a-1]),o=Math.min(o,r[i][a-1]))):o=a>0?Math.min(o,r[i][a-1]):0,r[i][a]=o+n(e[i],t[a],i,a)}}return function(e){var t=e.length-1,n=void 0!==e[0]?e[0].length-1:0,r=[],i=[];for(;t>0||n>0;)t>0?n>0?e[t-1][n]<e[t-1][n-1]?e[t-1][n]<e[t][n-1]?(r.push(t-1),i.push(n),t--):(r.push(t),i.push(n-1),n--):e[t-1][n-1]<e[t][n-1]?(r.push(t-1),i.push(n-1),t--,n--):(r.push(t),i.push(n-1),n--):(r.push(t-1),i.push(n),t--):(r.push(t),i.push(n-1),n--);return r.reverse(),i.reverse(),[r,i]}(r)}(t,n,r);var a,o=[],l=[],c=vr(this._indexMap,2),h=s(Ob(c[0],c[1]));try{for(h.s();!(a=h.n()).done;){var f=vr(a.value,2),d=f[0],v=f[1];o.push(t[d]),l.push(n[v])}}catch(x2){h.e(x2)}finally{h.f()}this._valueMap=[o,l];var m=vr(this._valueMap,2),g=m[0],y=m[1];p()(g[0]<=g[g.length-1]),p()(y[0]<=y[y.length-1])}));function YP(e,t){var n,r;if(void 0===t){var i,a=s(e);try{for(a.s();!(i=a.n()).done;){var o=i.value;null!=o&&(void 0===n?o>=o&&(n=r=o):(n>o&&(n=o),r<o&&(r=o)))}}catch(x2){a.e(x2)}finally{a.f()}}else{var u,l=-1,c=s(e);try{for(c.s();!(u=c.n()).done;){var h=u.value;null!=(h=t(h,++l,e))&&(void 0===n?h>=h&&(n=r=h):(n>h&&(n=h),r<h&&(r=h)))}}catch(x2){c.e(x2)}finally{c.f()}}return[n,r]}function KP(e,t){var n;if(void 0===t){var r,i=s(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;null!=a&&(n<a||void 0===n&&a>=a)&&(n=a)}}catch(x2){i.e(x2)}finally{i.f()}}else{var o,u=-1,l=s(e);try{for(l.s();!(o=l.n()).done;){var c=o.value;null!=(c=t(c,++u,e))&&(n<c||void 0===n&&c>=c)&&(n=c)}}catch(x2){l.e(x2)}finally{l.f()}}return n}function JP(e,t){var n;if(void 0===t){var r,i=s(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;null!=a&&(n>a||void 0===n&&a>=a)&&(n=a)}}catch(x2){i.e(x2)}finally{i.f()}}else{var o,u=-1,l=s(e);try{for(l.s();!(o=l.n()).done;){var c=o.value;null!=(c=t(c,++u,e))&&(n>c||void 0===n&&c>=c)&&(n=c)}}catch(x2){l.e(x2)}finally{l.f()}}return n}function QP(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((t-e)/n)),a=new Array(i);++r<i;)a[r]=e+r*n;return a}function $P(e){return e}var eL=1e-6;function tL(e){return"translate("+e+",0)"}function nL(e){return"translate(0,"+e+")"}function rL(e){return function(t){return+e(t)}}function iL(e,t){return t=Math.max(0,e.bandwidth()-2*t)/2,e.round()&&(t=Math.round(t)),function(n){return+e(n)+t}}function aL(){return!this.__axis}function oL(e,t){var n=[],r=null,i=null,a=6,o=6,s=3,u="undefined"!==typeof window&&window.devicePixelRatio>1?0:.5,l=1===e||4===e?-1:1,c=4===e||2===e?"x":"y",h=1===e||3===e?tL:nL;function f(f){var d=null==r?t.ticks?t.ticks.apply(t,n):t.domain():r,p=null==i?t.tickFormat?t.tickFormat.apply(t,n):$P:i,v=Math.max(a,0)+s,m=t.range(),g=+m[0]+u,y=+m[m.length-1]+u,b=(t.bandwidth?iL:rL)(t.copy(),u),_=f.selection?f.selection():f,x=_.selectAll(".domain").data([null]),w=_.selectAll(".tick").data(d,t).order(),S=w.exit(),M=w.enter().append("g").attr("class","tick"),k=w.select("line"),T=w.select("text");x=x.merge(x.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),w=w.merge(M),k=k.merge(M.append("line").attr("stroke","currentColor").attr(c+"2",l*a)),T=T.merge(M.append("text").attr("fill","currentColor").attr(c,l*v).attr("dy",1===e?"0em":3===e?"0.71em":"0.32em")),f!==_&&(x=x.transition(f),w=w.transition(f),k=k.transition(f),T=T.transition(f),S=S.transition(f).attr("opacity",eL).attr("transform",(function(e){return isFinite(e=b(e))?h(e+u):this.getAttribute("transform")})),M.attr("opacity",eL).attr("transform",(function(e){var t=this.parentNode.__axis;return h((t&&isFinite(t=t(e))?t:b(e))+u)}))),S.remove(),x.attr("d",4===e||2===e?o?"M"+l*o+","+g+"H"+u+"V"+y+"H"+l*o:"M"+u+","+g+"V"+y:o?"M"+g+","+l*o+"V"+u+"H"+y+"V"+l*o:"M"+g+","+u+"H"+y),w.attr("opacity",1).attr("transform",(function(e){return h(b(e)+u)})),k.attr(c+"2",l*a),T.attr(c,l*v).text(p),_.filter(aL).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===e?"start":4===e?"end":"middle"),_.each((function(){this.__axis=b}))}return f.scale=function(e){return arguments.length?(t=e,f):t},f.ticks=function(){return n=Array.from(arguments),f},f.tickArguments=function(e){return arguments.length?(n=null==e?[]:Array.from(e),f):n.slice()},f.tickValues=function(e){return arguments.length?(r=null==e?null:Array.from(e),f):r&&r.slice()},f.tickFormat=function(e){return arguments.length?(i=e,f):i},f.tickSize=function(e){return arguments.length?(a=o=+e,f):a},f.tickSizeInner=function(e){return arguments.length?(a=+e,f):a},f.tickSizeOuter=function(e){return arguments.length?(o=+e,f):o},f.tickPadding=function(e){return arguments.length?(s=+e,f):s},f.offset=function(e){return arguments.length?(u=+e,f):u},f}function sL(e){return oL(3,e)}function uL(e){return oL(4,e)}function lL(){}function cL(e){return null==e?lL:function(){return this.querySelector(e)}}function hL(e){return null==e?[]:Array.isArray(e)?e:Array.from(e)}function fL(){return[]}function dL(e){return null==e?fL:function(){return this.querySelectorAll(e)}}function pL(e){return function(){return this.matches(e)}}function vL(e){return function(t){return t.matches(e)}}var mL=Array.prototype.find;function gL(){return this.firstElementChild}var yL=Array.prototype.filter;function bL(){return Array.from(this.children)}function _L(e){return new Array(e.length)}function xL(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function wL(e){return function(){return e}}function SL(e,t,n,r,i,a){for(var o,s=0,u=t.length,l=a.length;s<l;++s)(o=t[s])?(o.__data__=a[s],r[s]=o):n[s]=new xL(e,a[s]);for(;s<u;++s)(o=t[s])&&(i[s]=o)}function ML(e,t,n,r,i,a,o){var s,u,l,c=new Map,h=t.length,f=a.length,d=new Array(h);for(s=0;s<h;++s)(u=t[s])&&(d[s]=l=o.call(u,u.__data__,s,t)+"",c.has(l)?i[s]=u:c.set(l,u));for(s=0;s<f;++s)l=o.call(e,a[s],s,a)+"",(u=c.get(l))?(r[s]=u,u.__data__=a[s],c.delete(l)):n[s]=new xL(e,a[s]);for(s=0;s<h;++s)(u=t[s])&&c.get(d[s])===u&&(i[s]=u)}function kL(e){return e.__data__}function TL(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}function EL(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}xL.prototype={constructor:xL,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var CL="http://www.w3.org/1999/xhtml",AL={svg:"http://www.w3.org/2000/svg",xhtml:CL,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function RL(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),AL.hasOwnProperty(t)?{space:AL[t],local:e}:e}function PL(e){return function(){this.removeAttribute(e)}}function LL(e){return function(){this.removeAttributeNS(e.space,e.local)}}function DL(e,t){return function(){this.setAttribute(e,t)}}function NL(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function IL(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function OL(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function UL(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function FL(e){return function(){this.style.removeProperty(e)}}function zL(e,t,n){return function(){this.style.setProperty(e,t,n)}}function BL(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function VL(e,t){return e.style.getPropertyValue(t)||UL(e).getComputedStyle(e,null).getPropertyValue(t)}function GL(e){return function(){delete this[e]}}function jL(e,t){return function(){this[e]=t}}function HL(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function WL(e){return e.trim().split(/^|\s+/)}function ZL(e){return e.classList||new qL(e)}function qL(e){this._node=e,this._names=WL(e.getAttribute("class")||"")}function XL(e,t){for(var n=ZL(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function YL(e,t){for(var n=ZL(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function KL(e){return function(){XL(this,e)}}function JL(e){return function(){YL(this,e)}}function QL(e,t){return function(){(t.apply(this,arguments)?XL:YL)(this,e)}}function $L(){this.textContent=""}function eD(e){return function(){this.textContent=e}}function tD(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function nD(){this.innerHTML=""}function rD(e){return function(){this.innerHTML=e}}function iD(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function aD(){this.nextSibling&&this.parentNode.appendChild(this)}function oD(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function sD(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===CL&&t.documentElement.namespaceURI===CL?t.createElement(e):t.createElementNS(n,e)}}function uD(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function lD(e){var t=RL(e);return(t.local?uD:sD)(t)}function cD(){return null}function hD(){var e=this.parentNode;e&&e.removeChild(this)}function fD(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function dD(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function pD(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}function vD(e){return function(){var t=this.__on;if(t){for(var n,r=0,i=-1,a=t.length;r<a;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?t.length=i:delete this.__on}}}function mD(e,t,n){return function(){var r,i=this.__on,a=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(i)for(var o=0,s=i.length;o<s;++o)if((r=i[o]).type===e.type&&r.name===e.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=a,r.options=n),void(r.value=t);this.addEventListener(e.type,a,n),r={type:e.type,name:e.name,value:t,listener:a,options:n},i?i.push(r):this.__on=[r]}}function gD(e,t,n){var r=UL(e),i=r.CustomEvent;"function"===typeof i?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function yD(e,t){return function(){return gD(this,e,t)}}function bD(e,t){return function(){return gD(this,e,t.apply(this,arguments))}}qL.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var _D=fr().mark(xD);function xD(){var e,t,n,r,i,a,o;return fr().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:e=this._groups,t=0,n=e.length;case 1:if(!(t<n)){s.next=13;break}r=e[t],i=0,a=r.length;case 3:if(!(i<a)){s.next=10;break}if(!(o=r[i])){s.next=7;break}return s.next=7,o;case 7:++i,s.next=3;break;case 10:++t,s.next=1;break;case 13:case"end":return s.stop()}}),_D,this)}var wD=[null];function SD(e,t){this._groups=e,this._parents=t}function MD(){return new SD([[document.documentElement]],wD)}SD.prototype=MD.prototype=gr({constructor:SD,select:function(e){"function"!==typeof e&&(e=cL(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a,o,s=t[i],u=s.length,l=r[i]=new Array(u),c=0;c<u;++c)(a=s[c])&&(o=e.call(a,a.__data__,c,s))&&("__data__"in a&&(o.__data__=a.__data__),l[c]=o);return new SD(r,this._parents)},selectAll:function(e){e="function"===typeof e?function(e){return function(){return hL(e.apply(this,arguments))}}(e):dL(e);for(var t=this._groups,n=t.length,r=[],i=[],a=0;a<n;++a)for(var o,s=t[a],u=s.length,l=0;l<u;++l)(o=s[l])&&(r.push(e.call(o,o.__data__,l,s)),i.push(o));return new SD(r,i)},selectChild:function(e){return this.select(null==e?gL:function(e){return function(){return mL.call(this.children,e)}}("function"===typeof e?e:vL(e)))},selectChildren:function(e){return this.selectAll(null==e?bL:function(e){return function(){return yL.call(this.children,e)}}("function"===typeof e?e:vL(e)))},filter:function(e){"function"!==typeof e&&(e=pL(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a,o=t[i],s=o.length,u=r[i]=[],l=0;l<s;++l)(a=o[l])&&e.call(a,a.__data__,l,o)&&u.push(a);return new SD(r,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,kL);var n=t?ML:SL,r=this._parents,i=this._groups;"function"!==typeof e&&(e=wL(e));for(var a=i.length,o=new Array(a),s=new Array(a),u=new Array(a),l=0;l<a;++l){var c=r[l],h=i[l],f=h.length,d=TL(e.call(c,c&&c.__data__,l,r)),p=d.length,v=s[l]=new Array(p),m=o[l]=new Array(p),g=u[l]=new Array(f);n(c,h,v,m,g,d,t);for(var y,b,_=0,x=0;_<p;++_)if(y=v[_]){for(_>=x&&(x=_+1);!(b=m[x])&&++x<p;);y._next=b||null}}return(o=new SD(o,r))._enter=s,o._exit=u,o},enter:function(){return new SD(this._enter||this._groups.map(_L),this._parents)},exit:function(){return new SD(this._exit||this._groups.map(_L),this._parents)},join:function(e,t,n){var r=this.enter(),i=this,a=this.exit();return"function"===typeof e?(r=e(r))&&(r=r.selection()):r=r.append(e+""),null!=t&&(i=t(i))&&(i=i.selection()),null==n?a.remove():n(a),r&&i?r.merge(i).order():i},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,a=r.length,o=Math.min(i,a),s=new Array(i),u=0;u<o;++u)for(var l,c=n[u],h=r[u],f=c.length,d=s[u]=new Array(f),p=0;p<f;++p)(l=c[p]||h[p])&&(d[p]=l);for(;u<i;++u)s[u]=n[u];return new SD(s,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,i=e[t],a=i.length-1,o=i[a];--a>=0;)(r=i[a])&&(o&&4^r.compareDocumentPosition(o)&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=EL);for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o,s=n[a],u=s.length,l=i[a]=new Array(u),c=0;c<u;++c)(o=s[c])&&(l[c]=o);l.sort(t)}return new SD(i,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null},size:function(){var e,t=0,n=s(this);try{for(n.s();!(e=n.n()).done;){e.value;++t}}catch(x2){n.e(x2)}finally{n.f()}return t},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i,a=t[n],o=0,s=a.length;o<s;++o)(i=a[o])&&e.call(i,i.__data__,o,a);return this},attr:function(e,t){var n=RL(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?LL:PL:"function"===typeof t?n.local?OL:IL:n.local?NL:DL)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?FL:"function"===typeof t?BL:zL)(e,t,null==n?"":n)):VL(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?GL:"function"===typeof t?HL:jL)(e,t)):this.node()[e]},classed:function(e,t){var n=WL(e+"");if(arguments.length<2){for(var r=ZL(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"===typeof t?QL:t?KL:JL)(n,t))},text:function(e){return arguments.length?this.each(null==e?$L:("function"===typeof e?tD:eD)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?nD:("function"===typeof e?iD:rD)(e)):this.node().innerHTML},raise:function(){return this.each(aD)},lower:function(){return this.each(oD)},append:function(e){var t="function"===typeof e?e:lD(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"===typeof e?e:lD(e),r=null==t?cD:"function"===typeof t?t:cL(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(hD)},clone:function(e){return this.select(e?dD:fD)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,i,a=pD(e+""),o=a.length;if(!(arguments.length<2)){for(s=t?mD:vD,r=0;r<o;++r)this.each(s(a[r],t,n));return this}var s=this.node().__on;if(s)for(var u,l=0,c=s.length;l<c;++l)for(r=0,u=s[l];r<o;++r)if((i=a[r]).type===u.type&&i.name===u.name)return u.value},dispatch:function(e,t){return this.each(("function"===typeof t?bD:yD)(e,t))}},Symbol.iterator,xD);var kD=MD,TD={value:function(){}};function ED(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new CD(r)}function CD(e){this._=e}function AD(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",r=e.indexOf(".");if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}function RD(e,t){for(var n,r=0,i=e.length;r<i;++r)if((n=e[r]).name===t)return n.value}function PD(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=TD,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}CD.prototype=ED.prototype={constructor:CD,on:function(e,t){var n,r=this._,i=AD(e+"",r),a=-1,o=i.length;if(!(arguments.length<2)){if(null!=t&&"function"!==typeof t)throw new Error("invalid callback: "+t);for(;++a<o;)if(n=(e=i[a]).type)r[n]=PD(r[n],e.name,t);else if(null==t)for(n in r)r[n]=PD(r[n],e.name,null);return this}for(;++a<o;)if((n=(e=i[a]).type)&&(n=RD(r[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new CD(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),a=0;a<n;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=0,n=(r=this._[e]).length;a<n;++a)r[a].value.apply(t,i)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,a=r.length;i<a;++i)r[i].value.apply(t,n)}};var LD,DD,ND=ED,ID=0,OD=0,UD=0,FD=0,zD=0,BD=0,VD="object"===typeof performance&&performance.now?performance:Date,GD="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function jD(){return zD||(GD(HD),zD=VD.now()+BD)}function HD(){zD=0}function WD(){this._call=this._time=this._next=null}function ZD(e,t,n){var r=new WD;return r.restart(e,t,n),r}function qD(){zD=(FD=VD.now())+BD,ID=OD=0;try{!function(){jD(),++ID;for(var e,t=LD;t;)(e=zD-t._time)>=0&&t._call.call(void 0,e),t=t._next;--ID}()}finally{ID=0,function(){var e,t,n=LD,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:LD=t);DD=e,YD(r)}(),zD=0}}function XD(){var e=VD.now(),t=e-FD;t>1e3&&(BD-=t,FD=e)}function YD(e){ID||(OD&&(OD=clearTimeout(OD)),e-zD>24?(e<1/0&&(OD=setTimeout(qD,e-VD.now()-BD)),UD&&(UD=clearInterval(UD))):(UD||(FD=VD.now(),UD=setInterval(XD,1e3)),ID=1,GD(qD)))}function KD(e,t,n){var r=new WD;return t=null==t?0:+t,r.restart((function(n){r.stop(),e(n+t)}),t,n),r}WD.prototype=ZD.prototype={constructor:WD,restart:function(e,t,n){if("function"!==typeof e)throw new TypeError("callback is not a function");n=(null==n?jD():+n)+(null==t?0:+t),this._next||DD===this||(DD?DD._next=this:LD=this,DD=this),this._call=e,this._time=n,YD()},stop:function(){this._call&&(this._call=null,this._time=1/0,YD())}};var JD=ND("start","end","cancel","interrupt"),QD=[];function $D(e,t,n,r,i,a){var o=e.__transition;if(o){if(n in o)return}else e.__transition={};!function(e,t,n){var r,i=e.__transition;function a(e){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=e&&o(e-n.delay)}function o(a){var l,c,h,f;if(1!==n.state)return u();for(l in i)if((f=i[l]).name===n.name){if(3===f.state)return KD(o);4===f.state?(f.state=6,f.timer.stop(),f.on.call("interrupt",e,e.__data__,f.index,f.group),delete i[l]):+l<t&&(f.state=6,f.timer.stop(),f.on.call("cancel",e,e.__data__,f.index,f.group),delete i[l])}if(KD((function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(a))})),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(h=n.tween.length),l=0,c=-1;l<h;++l)(f=n.tween[l].value.call(e,e.__data__,n.index,n.group))&&(r[++c]=f);r.length=c+1}}function s(t){for(var i=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(u),n.state=5,1),a=-1,o=r.length;++a<o;)r[a].call(e,i);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),u())}function u(){for(var r in n.state=6,n.timer.stop(),delete i[t],i)return;delete e.__transition}i[t]=n,n.timer=ZD(a,0,n.time)}(e,n,{name:t,index:r,group:i,on:JD,tween:QD,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:0})}function eN(e,t){var n=nN(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function tN(e,t){var n=nN(e,t);if(n.state>3)throw new Error("too late; already running");return n}function nN(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function rN(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var iN,aN=180/Math.PI,oN={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function sN(e,t,n,r,i,a){var o,s,u;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),e*r<t*n&&(e=-e,t=-t,u=-u,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(t,e)*aN,skewX:Math.atan(u)*aN,scaleX:o,scaleY:s}}function uN(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}return function(a,o){var s=[],u=[];return a=e(a),o=e(o),function(e,r,i,a,o,s){if(e!==i||r!==a){var u=o.push("translate(",null,t,null,n);s.push({i:u-4,x:rN(e,i)},{i:u-2,x:rN(r,a)})}else(i||a)&&o.push("translate("+i+t+a+n)}(a.translateX,a.translateY,o.translateX,o.translateY,s,u),function(e,t,n,a){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:rN(e,t)})):t&&n.push(i(n)+"rotate("+t+r)}(a.rotate,o.rotate,s,u),function(e,t,n,a){e!==t?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:rN(e,t)}):t&&n.push(i(n)+"skewX("+t+r)}(a.skewX,o.skewX,s,u),function(e,t,n,r,a,o){if(e!==n||t!==r){var s=a.push(i(a)+"scale(",null,",",null,")");o.push({i:s-4,x:rN(e,n)},{i:s-2,x:rN(t,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,s,u),a=o=null,function(e){for(var t,n=-1,r=u.length;++n<r;)s[(t=u[n]).i]=t.x(e);return s.join("")}}}var lN=uN((function(e){var t=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?oN:sN(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),cN=uN((function(e){return null==e?oN:(iN||(iN=document.createElementNS("http://www.w3.org/2000/svg","g")),iN.setAttribute("transform",e),(e=iN.transform.baseVal.consolidate())?sN((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):oN)}),", ",")",")");function hN(e,t){var n,r;return function(){var i=tN(this,e),a=i.tween;if(a!==n)for(var o=0,s=(r=n=a).length;o<s;++o)if(r[o].name===t){(r=r.slice()).splice(o,1);break}i.tween=r}}function fN(e,t,n){var r,i;if("function"!==typeof n)throw new Error;return function(){var a=tN(this,e),o=a.tween;if(o!==r){i=(r=o).slice();for(var s={name:t,value:n},u=0,l=i.length;u<l;++u)if(i[u].name===t){i[u]=s;break}u===l&&i.push(s)}a.tween=i}}function dN(e,t,n){var r=e._id;return e.each((function(){var e=tN(this,r);(e.value||(e.value={}))[t]=n.apply(this,arguments)})),function(e){return nN(e,r).value[t]}}function pN(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function vN(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function mN(){}var gN=.7,yN=1/gN,bN="\\s*([+-]?\\d+)\\s*",_N="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",xN="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",wN=/^#([0-9a-f]{3,8})$/,SN=new RegExp("^rgb\\("+[bN,bN,bN]+"\\)$"),MN=new RegExp("^rgb\\("+[xN,xN,xN]+"\\)$"),kN=new RegExp("^rgba\\("+[bN,bN,bN,_N]+"\\)$"),TN=new RegExp("^rgba\\("+[xN,xN,xN,_N]+"\\)$"),EN=new RegExp("^hsl\\("+[_N,xN,xN]+"\\)$"),CN=new RegExp("^hsla\\("+[_N,xN,xN,_N]+"\\)$"),AN={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function RN(){return this.rgb().formatHex()}function PN(){return this.rgb().formatRgb()}function LN(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=wN.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?DN(t):3===n?new UN(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?NN(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?NN(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=SN.exec(e))?new UN(t[1],t[2],t[3],1):(t=MN.exec(e))?new UN(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=kN.exec(e))?NN(t[1],t[2],t[3],t[4]):(t=TN.exec(e))?NN(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=EN.exec(e))?VN(t[1],t[2]/100,t[3]/100,1):(t=CN.exec(e))?VN(t[1],t[2]/100,t[3]/100,t[4]):AN.hasOwnProperty(e)?DN(AN[e]):"transparent"===e?new UN(NaN,NaN,NaN,0):null}function DN(e){return new UN(e>>16&255,e>>8&255,255&e,1)}function NN(e,t,n,r){return r<=0&&(e=t=n=NaN),new UN(e,t,n,r)}function IN(e){return e instanceof mN||(e=LN(e)),e?new UN((e=e.rgb()).r,e.g,e.b,e.opacity):new UN}function ON(e,t,n,r){return 1===arguments.length?IN(e):new UN(e,t,n,null==r?1:r)}function UN(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function FN(){return"#"+BN(this.r)+BN(this.g)+BN(this.b)}function zN(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function BN(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function VN(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new jN(e,t,n,r)}function GN(e){if(e instanceof jN)return new jN(e.h,e.s,e.l,e.opacity);if(e instanceof mN||(e=LN(e)),!e)return new jN;if(e instanceof jN)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,u=(a+i)/2;return s?(o=t===a?(n-r)/s+6*(n<r):n===a?(r-t)/s+2:(t-n)/s+4,s/=u<.5?a+i:2-a-i,o*=60):s=u>0&&u<1?0:o,new jN(o,s,u,e.opacity)}function jN(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function HN(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function WN(e,t,n,r,i){var a=e*e,o=a*e;return((1-3*e+3*a-o)*t+(4-6*a+3*o)*n+(1+3*e+3*a-3*o)*r+o*i)/6}pN(mN,LN,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:RN,formatHex:RN,formatHsl:function(){return GN(this).formatHsl()},formatRgb:PN,toString:PN}),pN(UN,ON,vN(mN,{brighter:function(e){return e=null==e?yN:Math.pow(yN,e),new UN(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?gN:Math.pow(gN,e),new UN(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:FN,formatHex:FN,formatRgb:zN,toString:zN})),pN(jN,(function(e,t,n,r){return 1===arguments.length?GN(e):new jN(e,t,n,null==r?1:r)}),vN(mN,{brighter:function(e){return e=null==e?yN:Math.pow(yN,e),new jN(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?gN:Math.pow(gN,e),new jN(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new UN(HN(e>=240?e-240:e+120,i,r),HN(e,i,r),HN(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));var ZN=function(e){return function(){return e}};function qN(e,t){return function(n){return e+n*t}}function XN(e){return 1===(e=+e)?YN:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):ZN(isNaN(t)?n:t)}}function YN(e,t){var n=t-e;return n?qN(e,n):ZN(isNaN(e)?t:e)}var KN=function e(t){var n=XN(t);function r(e,t){var r=n((e=ON(e)).r,(t=ON(t)).r),i=n(e.g,t.g),a=n(e.b,t.b),o=YN(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=a(t),e.opacity=o(t),e+""}}return r.gamma=e,r}(1);function JN(e){return function(t){var n,r,i=t.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=ON(t[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=e(a),o=e(o),s=e(s),r.opacity=1,function(e){return r.r=a(e),r.g=o(e),r.b=s(e),r+""}}}JN((function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],a=e[r+1],o=r>0?e[r-1]:2*i-a,s=r<t-1?e[r+2]:2*a-i;return WN((n-r/t)*t,o,i,a,s)}})),JN((function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],a=e[r%t],o=e[(r+1)%t],s=e[(r+2)%t];return WN((n-r/t)*t,i,a,o,s)}}));var QN=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,$N=new RegExp(QN.source,"g");function eI(e,t){var n,r,i,a=QN.lastIndex=$N.lastIndex=0,o=-1,s=[],u=[];for(e+="",t+="";(n=QN.exec(e))&&(r=$N.exec(t));)(i=r.index)>a&&(i=t.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,u.push({i:o,x:rN(n,r)})),a=$N.lastIndex;return a<t.length&&(i=t.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?u[0]?function(e){return function(t){return e(t)+""}}(u[0].x):function(e){return function(){return e}}(t):(t=u.length,function(e){for(var n,r=0;r<t;++r)s[(n=u[r]).i]=n.x(e);return s.join("")})}function tI(e,t){var n;return("number"===typeof t?rN:t instanceof LN?KN:(n=LN(t))?(t=n,KN):eI)(e,t)}function nI(e){return function(){this.removeAttribute(e)}}function rI(e){return function(){this.removeAttributeNS(e.space,e.local)}}function iI(e,t,n){var r,i,a=n+"";return function(){var o=this.getAttribute(e);return o===a?null:o===r?i:i=t(r=o,n)}}function aI(e,t,n){var r,i,a=n+"";return function(){var o=this.getAttributeNS(e.space,e.local);return o===a?null:o===r?i:i=t(r=o,n)}}function oI(e,t,n){var r,i,a;return function(){var o,s,u=n(this);if(null!=u)return(o=this.getAttribute(e))===(s=u+"")?null:o===r&&s===i?a:(i=s,a=t(r=o,u));this.removeAttribute(e)}}function sI(e,t,n){var r,i,a;return function(){var o,s,u=n(this);if(null!=u)return(o=this.getAttributeNS(e.space,e.local))===(s=u+"")?null:o===r&&s===i?a:(i=s,a=t(r=o,u));this.removeAttributeNS(e.space,e.local)}}function uI(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function lI(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function cI(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&lI(e,i)),n}return i._value=t,i}function hI(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&uI(e,i)),n}return i._value=t,i}function fI(e,t){return function(){eN(this,e).delay=+t.apply(this,arguments)}}function dI(e,t){return t=+t,function(){eN(this,e).delay=t}}function pI(e,t){return function(){tN(this,e).duration=+t.apply(this,arguments)}}function vI(e,t){return t=+t,function(){tN(this,e).duration=t}}function mI(e,t){if("function"!==typeof t)throw new Error;return function(){tN(this,e).ease=t}}function gI(e,t,n){var r,i,a=function(e){return(e+"").trim().split(/^|\s+/).every((function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e}))}(t)?eN:tN;return function(){var o=a(this,e),s=o.on;s!==r&&(i=(r=s).copy()).on(t,n),o.on=i}}var yI=kD.prototype.constructor;function bI(e){return function(){this.style.removeProperty(e)}}function _I(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function xI(e,t,n){var r,i;function a(){var a=t.apply(this,arguments);return a!==i&&(r=(i=a)&&_I(e,a,n)),r}return a._value=t,a}function wI(e){return function(t){this.textContent=e.call(this,t)}}function SI(e){var t,n;function r(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&wI(r)),t}return r._value=e,r}var MI=0;function kI(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function TI(){return++MI}var EI=kD.prototype;kI.prototype=function(e){return kD().transition(e)}.prototype=gr({constructor:kI,select:function(e){var t=this._name,n=this._id;"function"!==typeof e&&(e=cL(e));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var s,u,l=r[o],c=l.length,h=a[o]=new Array(c),f=0;f<c;++f)(s=l[f])&&(u=e.call(s,s.__data__,f,l))&&("__data__"in s&&(u.__data__=s.__data__),h[f]=u,$D(h[f],t,n,f,h,nN(s,n)));return new kI(a,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!==typeof e&&(e=dL(e));for(var r=this._groups,i=r.length,a=[],o=[],s=0;s<i;++s)for(var u,l=r[s],c=l.length,h=0;h<c;++h)if(u=l[h]){for(var f,d=e.call(u,u.__data__,h,l),p=nN(u,n),v=0,m=d.length;v<m;++v)(f=d[v])&&$D(f,t,n,v,d,p);a.push(d),o.push(u)}return new kI(a,o,t,n)},selectChild:EI.selectChild,selectChildren:EI.selectChildren,filter:function(e){"function"!==typeof e&&(e=pL(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a,o=t[i],s=o.length,u=r[i]=[],l=0;l<s;++l)(a=o[l])&&e.call(a,a.__data__,l,o)&&u.push(a);return new kI(r,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var u,l=t[s],c=n[s],h=l.length,f=o[s]=new Array(h),d=0;d<h;++d)(u=l[d]||c[d])&&(f[d]=u);for(;s<r;++s)o[s]=t[s];return new kI(o,this._parents,this._name,this._id)},selection:function(){return new yI(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=TI(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],u=s.length,l=0;l<u;++l)if(o=s[l]){var c=nN(o,t);$D(o,e,n,l,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new kI(r,this._parents,e,n)},call:EI.call,nodes:EI.nodes,node:EI.node,size:EI.size,empty:EI.empty,each:EI.each,on:function(e,t){var n=this._id;return arguments.length<2?nN(this.node(),n).on.on(e):this.each(gI(n,e,t))},attr:function(e,t){var n=RL(e),r="transform"===n?cN:tI;return this.attrTween(e,"function"===typeof t?(n.local?sI:oI)(n,r,dN(this,"attr."+e,t)):null==t?(n.local?rI:nI)(n):(n.local?aI:iI)(n,r,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!==typeof t)throw new Error;var r=RL(e);return this.tween(n,(r.local?cI:hI)(r,t))},style:function(e,t,n){var r="transform"===(e+="")?lN:tI;return null==t?this.styleTween(e,function(e,t){var n,r,i;return function(){var a=VL(this,e),o=(this.style.removeProperty(e),VL(this,e));return a===o?null:a===n&&o===r?i:i=t(n=a,r=o)}}(e,r)).on("end.style."+e,bI(e)):"function"===typeof t?this.styleTween(e,function(e,t,n){var r,i,a;return function(){var o=VL(this,e),s=n(this),u=s+"";return null==s&&(this.style.removeProperty(e),u=s=VL(this,e)),o===u?null:o===r&&u===i?a:(i=u,a=t(r=o,s))}}(e,r,dN(this,"style."+e,t))).each(function(e,t){var n,r,i,a,o="style."+t,s="end."+o;return function(){var u=tN(this,e),l=u.on,c=null==u.value[o]?a||(a=bI(t)):void 0;l===n&&i===c||(r=(n=l).copy()).on(s,i=c),u.on=r}}(this._id,e)):this.styleTween(e,function(e,t,n){var r,i,a=n+"";return function(){var o=VL(this,e);return o===a?null:o===r?i:i=t(r=o,n)}}(e,r,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!==typeof t)throw new Error;return this.tween(r,xI(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"===typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(dN(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!==typeof e)throw new Error;return this.tween(t,SI(e))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r,i=nN(this.node(),n).tween,a=0,o=i.length;a<o;++a)if((r=i[a]).name===e)return r.value;return null}return this.each((null==t?hN:fN)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"===typeof e?fI:dI)(t,e)):nN(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"===typeof e?pI:vI)(t,e)):nN(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(mI(t,e)):nN(this.node(),t).ease},easeVarying:function(e){if("function"!==typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!==typeof n)throw new Error;tN(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,r=n._id,i=n.size();return new Promise((function(a,o){var s={value:o},u={value:function(){0===--i&&a()}};n.each((function(){var n=tN(this,r),i=n.on;i!==e&&((t=(e=i).copy())._.cancel.push(s),t._.interrupt.push(s),t._.end.push(u)),n.on=t})),0===i&&a()}))}},Symbol.iterator,EI[Symbol.iterator]);var CI={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function AI(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error("transition ".concat(t," not found"));return n}kD.prototype.interrupt=function(e){return this.each((function(){!function(e,t){var n,r,i,a=e.__transition,o=!0;if(a){for(i in t=null==t?null:t+"",a)(n=a[i]).name===t?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete a[i]):o=!1;o&&delete e.__transition}}(this,e)}))},kD.prototype.transition=function(e){var t,n;e instanceof kI?(t=e._id,e=e._name):(t=TI(),(n=CI).time=jD(),e=null==e?null:e+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],u=s.length,l=0;l<u;++l)(o=s[l])&&$D(o,e,t,l,s,n||AI(o,t));return new kI(r,this._parents,e,t)};Math.abs,Math.max,Math.min;function RI(e){return[+e[0],+e[1]]}function PI(e){return[RI(e[0]),RI(e[1])]}["w","e"].map(LI),["n","s"].map(LI),["n","w","e","s","nw","ne","sw","se"].map(LI);function LI(e){return{type:e}}function DI(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function NI(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function II(){}var OI=.7,UI=1/OI,FI="\\s*([+-]?\\d+)\\s*",zI="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",BI="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",VI=/^#([0-9a-f]{3,8})$/,GI=new RegExp("^rgb\\(".concat(FI,",").concat(FI,",").concat(FI,"\\)$")),jI=new RegExp("^rgb\\(".concat(BI,",").concat(BI,",").concat(BI,"\\)$")),HI=new RegExp("^rgba\\(".concat(FI,",").concat(FI,",").concat(FI,",").concat(zI,"\\)$")),WI=new RegExp("^rgba\\(".concat(BI,",").concat(BI,",").concat(BI,",").concat(zI,"\\)$")),ZI=new RegExp("^hsl\\(".concat(zI,",").concat(BI,",").concat(BI,"\\)$")),qI=new RegExp("^hsla\\(".concat(zI,",").concat(BI,",").concat(BI,",").concat(zI,"\\)$")),XI={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function YI(){return this.rgb().formatHex()}function KI(){return this.rgb().formatRgb()}function JI(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=VI.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?QI(t):3===n?new nO(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?$I(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?$I(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=GI.exec(e))?new nO(t[1],t[2],t[3],1):(t=jI.exec(e))?new nO(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=HI.exec(e))?$I(t[1],t[2],t[3],t[4]):(t=WI.exec(e))?$I(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=ZI.exec(e))?uO(t[1],t[2]/100,t[3]/100,1):(t=qI.exec(e))?uO(t[1],t[2]/100,t[3]/100,t[4]):XI.hasOwnProperty(e)?QI(XI[e]):"transparent"===e?new nO(NaN,NaN,NaN,0):null}function QI(e){return new nO(e>>16&255,e>>8&255,255&e,1)}function $I(e,t,n,r){return r<=0&&(e=t=n=NaN),new nO(e,t,n,r)}function eO(e){return e instanceof II||(e=JI(e)),e?new nO((e=e.rgb()).r,e.g,e.b,e.opacity):new nO}function tO(e,t,n,r){return 1===arguments.length?eO(e):new nO(e,t,n,null==r?1:r)}function nO(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function rO(){return"#".concat(sO(this.r)).concat(sO(this.g)).concat(sO(this.b))}function iO(){var e=aO(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(oO(this.r),", ").concat(oO(this.g),", ").concat(oO(this.b)).concat(1===e?")":", ".concat(e,")"))}function aO(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function oO(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function sO(e){return((e=oO(e))<16?"0":"")+e.toString(16)}function uO(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new cO(e,t,n,r)}function lO(e){if(e instanceof cO)return new cO(e.h,e.s,e.l,e.opacity);if(e instanceof II||(e=JI(e)),!e)return new cO;if(e instanceof cO)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,u=(a+i)/2;return s?(o=t===a?(n-r)/s+6*(n<r):n===a?(r-t)/s+2:(t-n)/s+4,s/=u<.5?a+i:2-a-i,o*=60):s=u>0&&u<1?0:o,new cO(o,s,u,e.opacity)}function cO(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function hO(e){return(e=(e||0)%360)<0?e+360:e}function fO(e){return Math.max(0,Math.min(1,e||0))}function dO(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function pO(e){return"string"===typeof e?new SD([[document.querySelector(e)]],[document.documentElement]):new SD([[e]],wD)}function vO(e,t){if(e=function(e){for(var t;t=e.sourceEvent;)e=t;return e}(e),void 0===t&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}DI(II,JI,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:YI,formatHex:YI,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return lO(this).formatHsl()},formatRgb:KI,toString:KI}),DI(nO,tO,NI(II,{brighter:function(e){return e=null==e?UI:Math.pow(UI,e),new nO(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?OI:Math.pow(OI,e),new nO(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},clamp:function(){return new nO(oO(this.r),oO(this.g),oO(this.b),aO(this.opacity))},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rO,formatHex:rO,formatHex8:function(){return"#".concat(sO(this.r)).concat(sO(this.g)).concat(sO(this.b)).concat(sO(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:iO,toString:iO})),DI(cO,(function(e,t,n,r){return 1===arguments.length?lO(e):new cO(e,t,n,null==r?1:r)}),NI(II,{brighter:function(e){return e=null==e?UI:Math.pow(UI,e),new cO(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?OI:Math.pow(OI,e),new cO(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new nO(dO(e>=240?e-240:e+120,i,r),dO(e,i,r),dO(e<120?e+240:e-120,i,r),this.opacity)},clamp:function(){return new cO(hO(this.h),fO(this.s),fO(this.l),aO(this.opacity))},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=aO(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(hO(this.h),", ").concat(100*fO(this.s),"%, ").concat(100*fO(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}));var mO={passive:!1},gO={capture:!0,passive:!1};function yO(e){e.stopImmediatePropagation()}function bO(e){e.preventDefault(),e.stopImmediatePropagation()}var _O=function(e){return function(){return e}};function xO(e,t){var n=t.sourceEvent,r=t.subject,i=t.target,a=t.identifier,o=t.active,s=t.x,u=t.y,l=t.dx,c=t.dy,h=t.dispatch;Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:u,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:h}})}function wO(e){return!e.ctrlKey&&!e.button}function SO(){return this.parentNode}function MO(e,t){return null==t?{x:e.x,y:e.y}:t}function kO(){return navigator.maxTouchPoints||"ontouchstart"in this}function TO(){var e,t,n,r,i=wO,a=SO,o=MO,s=kO,u={},l=ND("start","drag","end"),c=0,h=0;function f(e){e.on("mousedown.drag",d).filter(s).on("touchstart.drag",m).on("touchmove.drag",g,mO).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(o,s){if(!r&&i.call(this,o,s)){var u=b(this,a.call(this,o,s),o,s,"mouse");u&&(pO(o.view).on("mousemove.drag",p,gO).on("mouseup.drag",v,gO),function(e){var t=e.document.documentElement,n=pO(e).on("dragstart.drag",bO,gO);"onselectstart"in t?n.on("selectstart.drag",bO,gO):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}(o.view),yO(o),n=!1,e=o.clientX,t=o.clientY,u("start",o))}}function p(r){if(bO(r),!n){var i=r.clientX-e,a=r.clientY-t;n=i*i+a*a>h}u.mouse("drag",r)}function v(e){pO(e.view).on("mousemove.drag mouseup.drag",null),function(e,t){var n=e.document.documentElement,r=pO(e).on("dragstart.drag",null);t&&(r.on("click.drag",bO,gO),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}(e.view,n),bO(e),u.mouse("end",e)}function m(e,t){if(i.call(this,e,t)){var n,r,o=e.changedTouches,s=a.call(this,e,t),u=o.length;for(n=0;n<u;++n)(r=b(this,s,e,t,o[n].identifier,o[n]))&&(yO(e),r("start",e,o[n]))}}function g(e){var t,n,r=e.changedTouches,i=r.length;for(t=0;t<i;++t)(n=u[r[t].identifier])&&(bO(e),n("drag",e,r[t]))}function y(e){var t,n,i=e.changedTouches,a=i.length;for(r&&clearTimeout(r),r=setTimeout((function(){r=null}),500),t=0;t<a;++t)(n=u[i[t].identifier])&&(yO(e),n("end",e,i[t]))}function b(e,t,n,r,i,a){var s,h,d,p=l.copy(),v=vO(a||n,t);if(null!=(d=o.call(e,new xO("beforestart",{sourceEvent:n,target:f,identifier:i,active:c,x:v[0],y:v[1],dx:0,dy:0,dispatch:p}),r)))return s=d.x-v[0]||0,h=d.y-v[1]||0,function n(a,o,l){var m,g=v;switch(a){case"start":u[i]=n,m=c++;break;case"end":delete u[i],--c;case"drag":v=vO(l||o,t),m=c}p.call(a,e,new xO(a,{sourceEvent:o,subject:d,target:f,identifier:i,active:m,x:v[0]+s,y:v[1]+h,dx:v[0]-g[0],dy:v[1]-g[1],dispatch:p}),r)}}return f.filter=function(e){return arguments.length?(i="function"===typeof e?e:_O(!!e),f):i},f.container=function(e){return arguments.length?(a="function"===typeof e?e:_O(e),f):a},f.subject=function(e){return arguments.length?(o="function"===typeof e?e:_O(e),f):o},f.touchable=function(e){return arguments.length?(s="function"===typeof e?e:_O(!!e),f):s},f.on=function(){var e=l.on.apply(l,arguments);return e===l?f:e},f.clickDistance=function(e){return arguments.length?(h=(e=+e)*e,f):Math.sqrt(h)},f}xO.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};var EO=Math.sqrt(50),CO=Math.sqrt(10),AO=Math.sqrt(2);function RO(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=EO?10:a>=CO?5:a>=AO?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=EO?10:a>=CO?5:a>=AO?2:1)}function PO(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function LO(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function DO(e){var t,n,r;function i(e,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(i<a){if(0!==t(r,r))return a;do{var o=i+a>>>1;n(e[o],r)<0?i=o+1:a=o}while(i<a)}return i}return 2!==e.length?(t=PO,n=function(t,n){return PO(e(t),n)},r=function(t,n){return e(t)-n}):(t=e===PO||e===LO?e:NO,n=e,r=e),{left:i,center:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length,o=i(e,t,n,a-1);return o>n&&r(e[o-1],t)>-r(e[o],t)?o-1:o},right:function(e,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(i<a){if(0!==t(r,r))return a;do{var o=i+a>>>1;n(e[o],r)<=0?i=o+1:a=o}while(i<a)}return i}}}function NO(){return 0}var IO=DO(PO),OO=IO.right,UO=(IO.left,DO((function(e){return null===e?NaN:+e})).center,OO);function FO(e,t,n,r,i){var a=e*e,o=a*e;return((1-3*e+3*a-o)*t+(4-6*a+3*o)*n+(1+3*e+3*a-3*o)*r+o*i)/6}var zO=function(e){return function(){return e}};function BO(e,t){return function(n){return e+n*t}}function VO(e){return 1===(e=+e)?GO:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):zO(isNaN(t)?n:t)}}function GO(e,t){var n=t-e;return n?BO(e,n):zO(isNaN(e)?t:e)}var jO=function e(t){var n=VO(t);function r(e,t){var r=n((e=tO(e)).r,(t=tO(t)).r),i=n(e.g,t.g),a=n(e.b,t.b),o=GO(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=a(t),e.opacity=o(t),e+""}}return r.gamma=e,r}(1);function HO(e){return function(t){var n,r,i=t.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=tO(t[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=e(a),o=e(o),s=e(s),r.opacity=1,function(e){return r.r=a(e),r.g=o(e),r.b=s(e),r+""}}}HO((function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],a=e[r+1],o=r>0?e[r-1]:2*i-a,s=r<t-1?e[r+2]:2*a-i;return FO((n-r/t)*t,o,i,a,s)}})),HO((function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],a=e[r%t],o=e[(r+1)%t],s=e[(r+2)%t];return FO((n-r/t)*t,i,a,o,s)}}));function WO(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=$O(e[n],t[n]);for(;n<r;++n)o[n]=t[n];return function(e){for(n=0;n<i;++n)o[n]=a[n](e);return o}}function ZO(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function qO(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function XO(e,t){var n,r={},i={};for(n in null!==e&&"object"===typeof e||(e={}),null!==t&&"object"===typeof t||(t={}),t)n in e?r[n]=$O(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}}var YO=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,KO=new RegExp(YO.source,"g");function JO(e,t){var n,r,i,a=YO.lastIndex=KO.lastIndex=0,o=-1,s=[],u=[];for(e+="",t+="";(n=YO.exec(e))&&(r=KO.exec(t));)(i=r.index)>a&&(i=t.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,u.push({i:o,x:qO(n,r)})),a=KO.lastIndex;return a<t.length&&(i=t.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?u[0]?function(e){return function(t){return e(t)+""}}(u[0].x):function(e){return function(){return e}}(t):(t=u.length,function(e){for(var n,r=0;r<t;++r)s[(n=u[r]).i]=n.x(e);return s.join("")})}function QO(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(a){for(n=0;n<r;++n)i[n]=e[n]*(1-a)+t[n]*a;return i}}function $O(e,t){var n,r=typeof t;return null==t||"boolean"===r?zO(t):("number"===r?qO:"string"===r?(n=JI(t))?(t=n,jO):JO:t instanceof JI?jO:t instanceof Date?ZO:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(t)?QO:Array.isArray(t)?WO:"function"!==typeof t.valueOf&&"function"!==typeof t.toString||isNaN(t)?XO:qO)(e,t)}function eU(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function tU(e){return+e}var nU=[0,1];function rU(e){return e}function iU(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function(e){return function(){return e}}(isNaN(t)?NaN:.5)}function aU(e,t,n){var r=e[0],i=e[1],a=t[0],o=t[1];return i<r?(r=iU(i,r),a=n(o,a)):(r=iU(r,i),a=n(a,o)),function(e){return a(r(e))}}function oU(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),a=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)i[o]=iU(e[o],e[o+1]),a[o]=n(t[o],t[o+1]);return function(t){var n=UO(e,t,1,r)-1;return a[n](i[n](t))}}function sU(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function uU(){var e,t,n,r,i,a,o=nU,s=nU,u=$O,l=rU;function c(){var e=Math.min(o.length,s.length);return l!==rU&&(l=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(o[0],o[e-1])),r=e>2?oU:aU,i=a=null,h}function h(t){return null==t||isNaN(t=+t)?n:(i||(i=r(o.map(e),s,u)))(e(l(t)))}return h.invert=function(n){return l(t((a||(a=r(s,o.map(e),qO)))(n)))},h.domain=function(e){return arguments.length?(o=Array.from(e,tU),c()):o.slice()},h.range=function(e){return arguments.length?(s=Array.from(e),c()):s.slice()},h.rangeRound=function(e){return s=Array.from(e),u=eU,c()},h.clamp=function(e){return arguments.length?(l=!!e||rU,c()):l!==rU},h.interpolate=function(e){return arguments.length?(u=e,c()):u},h.unknown=function(e){return arguments.length?(n=e,h):n},function(n,r){return e=n,t=r,c()}}function lU(){return uU()(rU,rU)}function cU(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}var hU,fU=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function dU(e){if(!(t=fU.exec(e)))throw new Error("invalid format: "+e);var t;return new pU({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function pU(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function vU(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function mU(e){return(e=vU(Math.abs(e)))?e[1]:NaN}function gU(e,t){var n=vU(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}dU.prototype=pU.prototype,pU.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var yU={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return gU(100*e,t)},r:gU,s:function(e,t){var n=vU(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(hU=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+vU(e,Math.max(0,t+a-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function bU(e){return e}var _U,xU,wU,SU=Array.prototype.map,MU=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function kU(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?bU:(t=SU.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,a=[],o=0,s=t[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),a.push(e.substring(i-=s,i+s)),!((u+=s+1)>r));)s=t[o=(o+1)%t.length];return a.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",a=void 0===e.currency?"":e.currency[1]+"",o=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?bU:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(SU.call(e.numerals,String)),u=void 0===e.percent?"%":e.percent+"",l=void 0===e.minus?"\u2212":e.minus+"",c=void 0===e.nan?"NaN":e.nan+"";function h(e){var t=(e=dU(e)).fill,n=e.align,h=e.sign,f=e.symbol,d=e.zero,p=e.width,v=e.comma,m=e.precision,g=e.trim,y=e.type;"n"===y?(v=!0,y="g"):yU[y]||(void 0===m&&(m=12),g=!0,y="g"),(d||"0"===t&&"="===n)&&(d=!0,t="0",n="=");var b="$"===f?i:"#"===f&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",_="$"===f?a:/[%p]/.test(y)?u:"",x=yU[y],w=/[defgprs%]/.test(y);function S(e){var i,a,u,f=b,S=_;if("c"===y)S=x(e)+S,e="";else{var M=(e=+e)<0||1/e<0;if(e=isNaN(e)?c:x(Math.abs(e),m),g&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),M&&0===+e&&"+"!==h&&(M=!1),f=(M?"("===h?h:l:"-"===h||"("===h?"":h)+f,S=("s"===y?MU[8+hU/3]:"")+S+(M&&"("===h?")":""),w)for(i=-1,a=e.length;++i<a;)if(48>(u=e.charCodeAt(i))||u>57){S=(46===u?o+e.slice(i+1):e.slice(i))+S,e=e.slice(0,i);break}}v&&!d&&(e=r(e,1/0));var k=f.length+e.length+S.length,T=k<p?new Array(p-k+1).join(t):"";switch(v&&d&&(e=r(T+e,T.length?p-S.length:1/0),T=""),n){case"<":e=f+e+S+T;break;case"=":e=f+T+e+S;break;case"^":e=T.slice(0,k=T.length>>1)+f+e+S+T.slice(k);break;default:e=T+f+e+S}return s(e)}return m=void 0===m?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),S.toString=function(){return e+""},S}return{format:h,formatPrefix:function(e,t){var n=h(((e=dU(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(mU(t)/3))),i=Math.pow(10,-r),a=MU[8+r/3];return function(e){return n(i*e)+a}}}}function TU(e,t,n,r){var i,a=function(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=EO?i*=10:a>=CO?i*=5:a>=AO&&(i*=2),t<e?-i:i}(e,t,n);switch((r=dU(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(i=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(mU(t)/3)))-mU(Math.abs(e)))}(a,o))||(r.precision=i),wU(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,mU(t)-mU(e))+1}(a,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(e){return Math.max(0,-mU(Math.abs(e)))}(a))||(r.precision=i-2*("%"===r.type))}return xU(r)}function EU(e){var t=e.domain;return e.ticks=function(e){var n=t();return function(e,t,n){var r,i,a,o,s=-1;if(n=+n,(e=+e)===(t=+t)&&n>0)return[e];if((r=t<e)&&(i=e,e=t,t=i),0===(o=RO(e,t,n))||!isFinite(o))return[];if(o>0){var u=Math.round(e/o),l=Math.round(t/o);for(u*o<e&&++u,l*o>t&&--l,a=new Array(i=l-u+1);++s<i;)a[s]=(u+s)*o}else{o=-o;var c=Math.round(e*o),h=Math.round(t*o);for(c/o<e&&++c,h/o>t&&--h,a=new Array(i=h-c+1);++s<i;)a[s]=(c+s)/o}return r&&a.reverse(),a}(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return TU(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,i,a=t(),o=0,s=a.length-1,u=a[o],l=a[s],c=10;for(l<u&&(i=u,u=l,l=i,i=o,o=s,s=i);c-- >0;){if((i=RO(u,l,n))===r)return a[o]=u,a[s]=l,t(a);if(i>0)u=Math.floor(u/i)*i,l=Math.ceil(l/i)*i;else{if(!(i<0))break;u=Math.ceil(u*i)/i,l=Math.floor(l*i)/i}r=i}return e},e}function CU(){var e=lU();return e.copy=function(){return sU(e,CU())},cU.apply(e,arguments),EU(e)}function AU(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(6*r,6*++r);return n}_U=kU({thousands:",",grouping:[3],currency:["$",""]}),xU=_U.format,wU=_U.formatPrefix;var RU=AU("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999");function PU(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}var LU=PU(AU("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),DU=(PU(AU("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),PU(AU("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),PU(AU("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),Math.PI),NU=2*DU,IU=1e-6,OU=NU-IU;function UU(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function FU(){return new UU}UU.prototype=FU.prototype={constructor:UU,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,i,a){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,s=n-e,u=r-t,l=a-e,c=o-t,h=l*l+c*c;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(h>IU)if(Math.abs(c*s-u*l)>IU&&i){var f=n-a,d=r-o,p=s*s+u*u,v=f*f+d*d,m=Math.sqrt(p),g=Math.sqrt(h),y=i*Math.tan((DU-Math.acos((p+h-v)/(2*m*g)))/2),b=y/g,_=y/m;Math.abs(b-1)>IU&&(this._+="L"+(e+b*l)+","+(t+b*c)),this._+="A"+i+","+i+",0,0,"+ +(c*f>l*d)+","+(this._x1=e+_*s)+","+(this._y1=t+_*u)}else this._+="L"+(this._x1=e)+","+(this._y1=t);else;},arc:function(e,t,n,r,i,a){e=+e,t=+t,a=!!a;var o=(n=+n)*Math.cos(r),s=n*Math.sin(r),u=e+o,l=t+s,c=1^a,h=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+u+","+l:(Math.abs(this._x1-u)>IU||Math.abs(this._y1-l)>IU)&&(this._+="L"+u+","+l),n&&(h<0&&(h=h%NU+NU),h>OU?this._+="A"+n+","+n+",0,1,"+c+","+(e-o)+","+(t-s)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):h>IU&&(this._+="A"+n+","+n+",0,"+ +(h>=DU)+","+c+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var zU=FU;Array.prototype.slice;function BU(e){return function(){return e}}function VU(e){this._context=e}function GU(e){return new VU(e)}function jU(e){return e[0]}function HU(e){return e[1]}function WU(e,t){var n=BU(!0),r=null,i=GU,a=null;function o(o){var s,u,l,c=(o=function(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}(o)).length,h=!1;for(null==r&&(a=i(l=zU())),s=0;s<=c;++s)!(s<c&&n(u=o[s],s,o))===h&&((h=!h)?a.lineStart():a.lineEnd()),h&&a.point(+e(u,s,o),+t(u,s,o));if(l)return a=null,l+""||null}return e="function"===typeof e?e:void 0===e?jU:BU(e),t="function"===typeof t?t:void 0===t?HU:BU(t),o.x=function(t){return arguments.length?(e="function"===typeof t?t:BU(+t),o):e},o.y=function(e){return arguments.length?(t="function"===typeof e?e:BU(+e),o):t},o.defined=function(e){return arguments.length?(n="function"===typeof e?e:BU(!!e),o):n},o.curve=function(e){return arguments.length?(i=e,null!=r&&(a=i(r)),o):i},o.context=function(e){return arguments.length?(null==e?r=a=null:a=i(r=e),o):r},o}function ZU(e,t,n){this.k=e,this.x=t,this.y=n}VU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}},ZU.prototype={constructor:ZU,scale:function(e){return 1===e?this:new ZU(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new ZU(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};new ZU(1,0,0);ZU.prototype;var qU=function(){function e(t,n,r,i){(0,u.Z)(this,e),this._parentScene=void 0,this._currGeom=void 0,this._currGeomArray=void 0,this._color=void 0,this._is_visible=void 0,this._opacity=void 0,this._rootGroup=void 0,this._id=void 0,this._traceFrom=void 0,this._traceTo=void 0,this._baseSceneTimeIndex=void 0,this._id=new Yb,this._color=Pb(),void 0!==i&&(this._color=i),this._rootGroup=new cb.Group,this._currGeom=this.newGeom(),this._currGeomArray=[],this._baseSceneTimeIndex=[],this._rootGroup.add(this._currGeom),this._is_visible=!0,this._traceFrom=t,this._traceTo=n,this._opacity=.5,this._parentScene=void 0,this.update(t,n);new WeakRef(this);this.setParentScene(r)}return(0,l.Z)(e,[{key:"traceFrom",value:function(){return this._traceFrom}},{key:"traceTo",value:function(){return this._traceTo}},{key:"color",value:function(){return this._color}},{key:"id",value:function(){return this._id.value()}},{key:"updateTimespan",value:function(){var e,t,n,r=this._traceFrom,i=this._traceTo,a=[];if(2===(a=(null===(e=r.robot().parentScene())||void 0===e?void 0:e.baseSceneId())===(null===(t=i.robot().parentScene())||void 0===t?void 0:t.id().value())?i.timespanIndex():r.timespanIndex()).length){for(var o=[],s=0;s<this._baseSceneTimeIndex.length;s++)if(this._baseSceneTimeIndex[s]>=a[0]){o[0]=s;break}for(var u=this._baseSceneTimeIndex.length-1;u>=0;u--)if(this._baseSceneTimeIndex[u]<=a[1]){o[1]=u;break}for(var l=0;l<this._currGeomArray.length;l++)void 0!==this._currGeomArray[l]&&(l<o[0]||l>o[1]?this._currGeomArray[l].visible=!1:this._currGeomArray[l].visible=!0);null===(n=this.parentScene())||void 0===n||n.render()}}},{key:"newGeom",value:function(e,t){if(this._currGeomArray=[],void 0===e||void 0===t)return new cb.Group;var n=e.points(),r=t.points();if(console.log("points length "+n.length),n.length===r.length){var i,a,o,s,u=[],l=new cb.Group,c=[[],[]];if((null===(i=e.robot().parentScene())||void 0===i?void 0:i.baseSceneId())===(null===(a=t.robot().parentScene())||void 0===a?void 0:a.id().value())){var h,f,d=null===(h=e.robot().parentScene())||void 0===h||null===(f=h.timeWarping())||void 0===f?void 0:f.indexMap();if(void 0===d)return l;c[0]=cr(d[1]),c[1]=cr(d[0]),this._baseSceneTimeIndex=c[1]}else if((null===(o=t.robot().parentScene())||void 0===o?void 0:o.baseSceneId())===(null===(s=e.robot().parentScene())||void 0===s?void 0:s.id().value())){var p,v,m=null===(p=t.robot().parentScene())||void 0===p||null===(v=p.timeWarping())||void 0===v?void 0:v.indexMap();if(void 0===m)return l;c[0]=cr(m[0]),c[1]=cr(m[1]),this._baseSceneTimeIndex=c[0]}else{for(var g=0;g<n.length;g++)c[0][g]=g,c[1][g]=g;this._baseSceneTimeIndex=c[0]}console.log(c);for(var y=0;y<c[0].length;y++)u.push(n[c[0][y]].distanceTo(r[c[1][y]]));var b=Math.max.apply(Math,u),_=Math.min.apply(Math,u);console.log("max "+b+" min "+_);for(var x=0;x<c[0].length-1;x++){var w=new Float32Array([n[c[0][x]].x,n[c[0][x]].y,n[c[0][x]].z,r[c[1][x]].x,r[c[1][x]].y,r[c[1][x]].z,r[c[1][x+1]].x,r[c[1][x+1]].y,r[c[1][x+1]].z,n[c[0][x]].x,n[c[0][x]].y,n[c[0][x]].z,r[c[1][x+1]].x,r[c[1][x+1]].y,r[c[1][x+1]].z,n[c[0][x+1]].x,n[c[0][x+1]].y,n[c[0][x+1]].z]),S=new cb.BufferGeometry;S.setAttribute("position",new cb.BufferAttribute(w,3)),S.computeVertexNormals();var M=n[c[0][x]].distanceTo(r[c[1][x]]),k=(n[c[0][x+1]].distanceTo(r[c[1][x+1]])-_)/(b-_),T=tO(LU((M-_)/(b-_))),E=tO(LU(k)),C=T.r/255,A=T.g/255,R=T.b/255,P=E.r/255,L=E.g/255,D=E.b/255,N=new Float32Array([C,A,R,C,A,R,P,L,D,C,A,R,P,L,D,P,L,D]);S.setAttribute("color",new cb.BufferAttribute(N,3));var I=new cb.MeshPhongMaterial({vertexColors:!0,side:cb.DoubleSide}),O=new cb.Mesh(S,I);l.add(O),this._currGeomArray[x]=O}return this.updateTimespan(),l}return console.log("the number of points do not match!!!"),new cb.Group}},{key:"robotFrom",value:function(){return this._traceFrom.robot()}},{key:"robotPartFrom",value:function(){return this._traceFrom.robotPart()}},{key:"timesFrom",value:function(){return this._traceFrom.times()}},{key:"robotTo",value:function(){return this._traceTo.robot()}},{key:"robotPartTo",value:function(){return this._traceTo.robotPart()}},{key:"timesTo",value:function(){return this._traceTo.times()}},{key:"traverseMeshes",value:function(e){this._rootGroup.traverse((function(t){KR(t)&&e(t)}))}},{key:"traverseMaterials",value:function(e){this._rootGroup.traverse((function(t){_b(t.material,e)}))}},{key:"visible",value:function(){return this._is_visible}},{key:"setVisible",value:function(e){e!==this._is_visible&&(this.traverseMeshes((function(t){t.visible=e})),this._is_visible=e,lr.updateUI(),lr.render())}},{key:"opacity",value:function(){return this._opacity}},{key:"setOpacity",value:function(e){var t=this;this._opacity=Lb(e,0,1),this.traverseMaterials((function(e){e.opacity=t._opacity})),lr.updateUI(),lr.render()}},{key:"parentScene",value:function(){return this._parentScene}},{key:"setParentScene",value:function(e){console.log("set parent scene!!!"),e!==this._parentScene&&(void 0!==this._parentScene&&(this._parentScene.scene().remove(this._rootGroup),this._parentScene.render()),this._parentScene=e,void 0!==e&&(e.scene().add(this._rootGroup),e.render()),lr.updateUI())}},{key:"pointsFrom",value:function(){return this._traceFrom.points()}},{key:"pointsTo",value:function(){return this._traceTo.points()}},{key:"update",value:function(e,t){var n=this.newGeom(e,t);this._rootGroup.remove(this._currGeom),this._currGeom=n,this._rootGroup.add(this._currGeom)}}]),e}(),XU=["rgb(255, 255, 0)","brown","red","#204BD8","purple","green"],YU=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r){var i;return(0,u.Z)(this,n),(i=t.call(this))._id=void 0,i._robots=void 0,i._ghostRobots=void 0,i._selectedRobot=void 0,i._hoveredRobot=void 0,i._traces=void 0,i._sentGhostTraces=void 0,i._receivedGhostTraces=void 0,i._traceMap=void 0,i._robotSceneManager=void 0,i._color=void 0,i._colorPalettes=void 0,i._arrows=void 0,i._traceFrom=void 0,i._density=void 0,i._axisSize=void 0,i._traceSize=void 0,i._update=void 0,i._timeWarpObj=void 0,i._baseSceneId=void 0,i._keyObjects=void 0,i._currTimeWarpBase=void 0,i._num_ee_targets=void 0,i._backgroundColor=void 0,i._directionalLightIntensity=void 0,i._directionalLight=void 0,i._ambientLightIntensity=void 0,i._ambientLight=void 0,i._groundPlane=void 0,i._cameraType=void 0,i._toggleCamera=void 0,i._worldFrame=void 0,i._toggleWorldFrame=void 0,i._worldFrameObject=void 0,i.currTimeWarpBase=function(){return i._currTimeWarpBase},i._id=new Yb(r),i._color=Pb(),i._robotSceneManager=new nP(e),i._colorPalettes=[].concat(XU),i._arrows=new Map,i._density=.5,i._axisSize=0,i._traceSize=1,i._update=!1,i._traceMap=new Map,i._robots=[],i._ghostRobots=new Map,i._traces=[],i._sentGhostTraces=new qP,i._receivedGhostTraces=new qP,i._baseSceneId="",i._keyObjects=[],i._worldFrameObject=new cb.Object3D,i.addWorldFrame(),i._num_ee_targets=0,i._backgroundColor="#263238",i._directionalLightIntensity=1,i._ambientLightIntensity=.2,i._directionalLight=new cb.DirectionalLight,i._ambientLight=new cb.AmbientLight,i._groundPlane=new cb.Object3D,i._cameraType="Perspective",i._toggleCamera=!1,i._worldFrame="ROS",i._toggleWorldFrame=!1,i}return(0,l.Z)(n,[{key:"ghostRobots",value:function(){var e,t=[],n=s(this._ghostRobots);try{for(n.s();!(e=n.n()).done;){var r=vr(e.value,2)[1];t.push(r)}}catch(x2){n.e(x2)}finally{n.f()}return t}},{key:"getGhostRobot",value:function(e){return this._ghostRobots.get(e)}},{key:"hasGhostRobt",value:function(e){return this._ghostRobots.has(e)}},{key:"addGhostRobot",value:function(e){this._ghostRobots.set(e.idValue(),e)}},{key:"removeGhostRobot",value:function(e){var t=this._ghostRobots.get(e);null===t||void 0===t||t.removeControlledClone(this),this._ghostRobots.delete(e),lr.updateUI()}},{key:"backgroundColor",value:function(){return this._backgroundColor}},{key:"setBackgroundColor",value:function(e){this._backgroundColor=e,this.scene().background=new cb.Color(e),this.render()}},{key:"setCameraType",value:function(e){this._cameraType=e,this._toggleCamera=!0}},{key:"toggleCameraType",value:function(){"Perspective"===this._cameraType?this._cameraType="Orthographic":this._cameraType="Perspective",this._toggleCamera=!0}},{key:"cameraType",value:function(){return this._cameraType}},{key:"finishToggleCamera",value:function(){this._toggleCamera=!1}},{key:"isToggleCamera",value:function(){return this._toggleCamera}},{key:"setWorldFrame",value:function(e){this._worldFrame=e,this._toggleWorldFrame=!0}},{key:"toggleWorldFrame",value:function(){"ROS"===this._worldFrame?this._worldFrame="THREE.js":this._worldFrame="ROS",this._toggleWorldFrame=!0}},{key:"worldFrame",value:function(){return this._worldFrame}},{key:"finishToggleWorldFrame",value:function(){this._toggleWorldFrame=!1}},{key:"isToggleWorldFrame",value:function(){return this._toggleWorldFrame}},{key:"isGroundPlaneVisible",value:function(){return this._groundPlane.visible}},{key:"setGroundPlaneVisibility",value:function(e){this._groundPlane.visible=e,this.render()}},{key:"setGroundPlane",value:function(e){this._groundPlane=e}},{key:"isWorldFrameObjectVisible",value:function(){return this._worldFrameObject.visible}},{key:"setWorldFrameObjectVisibility",value:function(e){this._worldFrameObject.visible=e,this.render()}},{key:"directionalLightIntensity",value:function(){return this._directionalLightIntensity}},{key:"setDirectionalLightIntensity",value:function(e){this._directionalLight.intensity=e,this._directionalLightIntensity=e,this.render()}},{key:"directionalLight",value:function(){return this._directionalLight}},{key:"setDirectionalLight",value:function(e){this._directionalLight=e}},{key:"ambientLightIntensity",value:function(){return this._ambientLightIntensity}},{key:"setAmbientLightIntensity",value:function(e){this._ambientLight.intensity=e,this._ambientLightIntensity=e,this.render()}},{key:"ambientLight",value:function(){return this._ambientLight}},{key:"setAmbientLight",value:function(e){this._ambientLight=e}},{key:"setTraceFrom",value:function(e){this._traceFrom=e}},{key:"setTraceTo",value:function(e){if(void 0!==this._traceFrom){var t=new qU(this._traceFrom,e,this,this.getNextColor());this._arrows.set(t.id(),t),this._traceFrom=void 0,this._update=!0}}},{key:"addArrow",value:function(e,t){var n=this._traceMap.get(e),r=this._traceMap.get(t);if(void 0!==n&&void 0!==r){var i=new qU(n,r,this,this.getNextColor());this._arrows.set(i.id(),i)}}},{key:"removeArrow",value:function(e){var t=this._arrows.get(e);void 0!==t&&(this._arrows.delete(e),t.setParentScene(void 0),this._update=!0,this.addColorBack(t.color()))}},{key:"getAllArrows",value:function(){var e,t=[],n=s(this._arrows);try{for(n.s();!(e=n.n()).done;){var r=vr(e.value,2)[1];t.push(r)}}catch(x2){n.e(x2)}finally{n.f()}return t}},{key:"density",value:function(){return this._density}},{key:"setDensity",value:function(e){this._density=e;var t,n=s(this.getAllTraces());try{for(n.s();!(t=n.n()).done;){t.value.setDensity(e)}}catch(x2){n.e(x2)}finally{n.f()}this.render()}},{key:"axisSize",value:function(){return this._axisSize}},{key:"setAxisSize",value:function(e){this._axisSize=e;var t,n=s(this.getAllTraces());try{for(n.s();!(t=n.n()).done;){t.value.setAxisSize(e)}}catch(x2){n.e(x2)}finally{n.f()}this.render()}},{key:"traceSize",value:function(){return this._traceSize}},{key:"setTraceSize",value:function(e){this._traceSize=e;var t,n=s(this.getAllTraces());try{for(n.s();!(t=n.n()).done;){t.value.setTraceSize(e)}}catch(x2){n.e(x2)}finally{n.f()}this.render()}},{key:"setParentRobotSceneManager",value:function(e){var t=this;e!==this._robotSceneManager.value()&&(this._robotSceneManager.setValue(null,e,(function(){if(void 0===e){var n,r=s(t._robots);try{for(r.s();!(n=r.n()).done;){var i=n.value;t.removeChildRobot(i)}}catch(x2){r.e(x2)}finally{r.f()}t._sentGhostTraces.destroyContents()}})),lr.updateUI())}},{key:"robotSceneManager",value:function(){return this._robotSceneManager.value()}},{key:"beforeParentRobotSceneManagerSet",value:function(){return this._robotSceneManager.beforeSet()}},{key:"afterParentRobotSceneManagerSet",value:function(){return this._robotSceneManager.afterSet()}},{key:"getRobotByName",value:function(e){var t=this.robots().filter((function(t){return t.name()===e}));if(1===t.length)return t[0]}},{key:"getJointByName",value:function(e,t){var n=this.getRobotByName(e);if(void 0!==n){var r=n.joints().filter((function(e){return e.name()===t}));if(1===r.length)return r[0]}}},{key:"getLinkByName",value:function(e,t){var n=this.getRobotByName(e);if(void 0!==n){var r=n.links().filter((function(e){return e.name()===t}));if(1===r.length)return r[0]}}},{key:"getAllTraces",value:function(){for(var e=cr(this._traces),t=Array.from(this._receivedGhostTraces.aliveContents()),n=0;n<t.length;n++)e.push(t[n][0]);return e}},{key:"hasReceivedGhostTrace",value:function(e,t){var n,r=s(this._receivedGhostTraces);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.robot()===e&&i.robotPart()===t)return!0}}catch(x2){r.e(x2)}finally{r.f()}return!1}},{key:"getReceivedGhostTraces",value:function(e,t){return void 0===t?Array.from(this._receivedGhostTraces.aliveContents()).filter((function(t){return vr(t,1)[0].robot()===e})):Array.from(this._receivedGhostTraces.aliveContents()).filter((function(n){var r=vr(n,1)[0];return r.robot()===e&&r.robotPart()===t}))}},{key:"sendGhostTracesTo",value:function(e,t,r,i){var a=this;this.removeGhostTracesFrom(e,r,i);var o,u=[],l=s(n.newTraces(e,t,r,i.getNextColor(),i._axisSize,i._density,i._traceSize));try{var c=function(){var e=o.value;e.setOpacity(.1);var t=new ZP(e);t.afterDestroyed().subscribe((function(){return e.setParentScene(void 0),!1})),a._sentGhostTraces.push(t),i.receiveGhostTrace(t),u.push(e.id())};for(l.s();!(o=l.n()).done;)c()}catch(x2){l.e(x2)}finally{l.f()}return void 0!==r?r.addToScene():e.addToScene(),lr.render(),lr.updateUI(),u}},{key:"receiveGhostTrace",value:function(e){var t=e.deref();t&&(this._update=!0,this._receivedGhostTraces.push(e),t.setParentScene(this),this._traceMap.set(t.id(),t))}},{key:"removeGhostTracesFrom",value:function(e,t,n){var r,i=!1,a=s(n.getReceivedGhostTraces(e,t));try{for(a.s();!(r=a.n()).done;){var o=vr(r.value,2)[1],u=o.deref();u&&(n._traceMap.delete(u.id()),n.addColorBack(u.color()),n._update=!0),o.destroy(),i=!0}}catch(x2){a.e(x2)}finally{a.f()}return console.log("remove ghost trace"),void 0!==t?t.removeFromScene():e.removeFromScene(),lr.render(),lr.updateUI(),i}},{key:"robotById",value:function(e){var t,n=s(this._robots);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.idValue()===e)return r}}catch(x2){n.e(x2)}finally{n.f()}}},{key:"timeWarping",value:function(){return this._timeWarpObj}},{key:"isTimeWarping",value:function(){return void 0!==this._timeWarpObj}},{key:"setTimeWarping",value:function(e){this._timeWarpObj=e}},{key:"setTimeWarpBase",value:function(e){var t=this;if(this._currTimeWarpBase!==e){var r=function(){t.setTimeWarping(void 0),t._currTimeWarpBase=void 0},i=function(){r(),lr.updateUI(),lr.render()};if(void 0!==e){var a=this._robotSceneManager.value();if(void 0!==a){p()(a.hasManagedRobotScene(e),"You can not set the RobotSceneManager to use a scene that it does not own "+"as its timewarp base. Scene: ".concat(e));var o=a.startTime(),u=a.endTime(),l=30*Math.abs(u-o),c=n.frameRange(o,u,30,l),h=new Map,f=new Set(zb(e.robots(),(function(e){return e.name()}))),v=e.frameData(c,(function(e){return f.has(e)}),(function(e,t){return 1===Bb(e.links(),t,(function(e){return e.name()}))}),(function(e,t){return 1===Bb(e.joints(),t,(function(e){return e.name()}))}),(function(e,t){return 1===Bb(e.articuatedJoints(),t,(function(e){return e.name()}))}));if(!0!==v.keys().next().done){var m,g=s(v.entries());try{for(g.s();!(m=g.n()).done;){var y,b=vr(m.value,2),_=b[0],x=b[1],w=new Map,S=new Map,M=s(x.positions);try{for(M.s();!(y=M.n()).done;){var k=vr(y.value,2),T=k[0],E=k[1];if(void 0===T)w.set(T,[T,E]);else if(T instanceof $R)w.set(T.name(),[T,E]);else{if(!(T instanceof eP))throw new d.AssertionError({message:"robotPart was not a boolean, RobotJoint, or RobotLink!"});w.set(T.name(),[T,E])}}}catch(x2){M.e(x2)}finally{M.f()}var C,A=s(x.jointAngles);try{for(A.s();!(C=A.n()).done;){var R=vr(C.value,2),P=R[0],L=R[1];S.set(P.name(),[P,L])}}catch(x2){A.e(x2)}finally{A.f()}h.set(_.name(),[_,{times:x.times,positions:w,jointAngles:S}])}}catch(x2){g.e(x2)}finally{g.f()}if(r(),this!==e){var D,N=new Set(zb(this.robots(),(function(e){return e.name()})));if(D=this.frameData(c,(function(e){return e.includePosInTimeWarpConsideration()&&h.has(e.name())&&N.has(e)}),(function(e,t){return t.includePosInTimeWarpConsideration()&&h.has(e.name())&&N.has(e)&&1===Bb(e.links(),t,(function(e){return e.name()}))}),(function(e,t){return t.includePosInTimeWarpConsideration()&&h.has(e.name())&&N.has(e)&&1===Bb(e.joints(),t,(function(e){return e.name()}))}),(function(e,t){return t.includeAngleInTimeWarpConsideration()&&h.has(e.name())&&N.has(e)&&1===Bb(e.articuatedJoints(),t,(function(e){return e.name()}))})),!0!==D.keys().next().done){var I,O=[],U=s(D);try{for(U.s();!(I=U.n()).done;){var F=vr(I.value,2),z=F[0],B=F[1],V=h.get(z.name());if(void 0!==V){var G,j=s(B.positions);try{for(j.s();!(G=j.n()).done;){var H=vr(G.value,2),W=H[0],Z=H[1],q=V[1].positions.get(void 0===W?void 0:W.name());if(void 0!==q){var X=q[1];O.push([X,Z])}}}catch(x2){j.e(x2)}finally{j.f()}var Y,K=s(B.jointAngles);try{for(K.s();!(Y=K.n()).done;){var J=vr(Y.value,2),Q=J[0],$=J[1],ee=V[1].jointAngles.get(Q.name());if(void 0!==ee){var te=ee[1];O.push([te,$])}}}catch(x2){K.e(x2)}finally{K.f()}}}}catch(x2){U.e(x2)}finally{U.f()}var ne=new XP(c,c,(function(e,t,n,r){for(var i=0,a=0,o=O;a<o.length;a++){var s=vr(o[a],2),u=s[0],l=s[1],c=u[n],h=l[r];i+="number"===typeof c&&"number"===typeof h?Math.abs(c-h):c.distanceTo(h)}return i}));this.setTimeWarping(ne),this._currTimeWarpBase=e,lr.updateUI(),lr.render()}}}else i()}else i()}else i()}}},{key:"baseSceneId",value:function(){var e;return void 0===this._currTimeWarpBase?" ":null===(e=this._currTimeWarpBase)||void 0===e?void 0:e.id().value()}},{key:"setKeyObjects",value:function(e){this._keyObjects=cr(e)}},{key:"keyObjects",value:function(){return this._keyObjects}},{key:"frameData",value:function(e,t,n,r,i,a,o,u){var l,c=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],h=this._animationManager.time(),f=null!==t&&void 0!==t?t:function(){return!0},d=null!==n&&void 0!==n?n:function(){return!0},p=null!==i&&void 0!==i?i:function(){return!0},v=null!==r&&void 0!==r?r:function(){return!0},m=null!==a&&void 0!==a?a:function(){return!1},g=null!==o&&void 0!==o?o:function(){return!1},y=null!==u&&void 0!==u?u:function(){return!1},b=[],_=[],x=[],w=[],S=[],M=[],k=[],T=s(this.robots());try{for(T.s();!(l=T.n()).done;){var E=l.value;f(E)&&b.push([[],E]);var C,A=s(E.joints());try{for(A.s();!(C=A.n()).done;){var R=C.value;v(E,R)&&x.push([[],E,R])}}catch(x2){A.e(x2)}finally{A.f()}var P,L=s(E.articuatedJoints());try{for(L.s();!(P=L.n()).done;){var D=P.value;p(E,D)&&w.push([[],E,D])}}catch(x2){L.e(x2)}finally{L.f()}var N,I=s(E.links());try{for(I.s();!(N=I.n()).done;){var O=N.value;d(E,O)&&_.push([[],E,O])}}catch(x2){I.e(x2)}finally{I.f()}m(E)&&S.push([[],E]);var U,F=s(E.links());try{for(F.s();!(U=F.n()).done;){var z=U.value;g(E,z)&&M.push([[],E,z])}}catch(x2){F.e(x2)}finally{F.f()}var B,V=s(E.joints());try{for(V.s();!(B=V.n()).done;){var G=B.value;y(E,G)&&k.push([[],E,G])}}catch(x2){V.e(x2)}finally{V.f()}}}catch(x2){T.e(x2)}finally{T.f()}if(0===b.length&&0===_.length&&0===x.length&&0===w.length&&0===S.length&&0===M.length&&0===k.length)return new Map;if(!c)throw new Error("Not implemented yet");var j,H=s(e);try{for(H.s();!(j=H.n()).done;){var W=j.value;this._animationManager.setTime(W);var Z,q=s(b);try{for(q.s();!(Z=q.n()).done;){var X=vr(Z.value,2),Y=X[0],K=X[1];Y.push(K.getWorldPosition())}}catch(x2){q.e(x2)}finally{q.f()}var J,Q=s(_);try{for(Q.s();!(J=Q.n()).done;){var $=vr(J.value,3),ee=$[0],te=$[2];ee.push(te.getWorldPosition())}}catch(x2){Q.e(x2)}finally{Q.f()}var ne,re=s(x);try{for(re.s();!(ne=re.n()).done;){var ie=vr(ne.value,3),ae=ie[0],oe=ie[2];ae.push(oe.getWorldPosition())}}catch(x2){re.e(x2)}finally{re.f()}var se,ue=s(w);try{for(ue.s();!(se=ue.n()).done;){var le=vr(se.value,3),ce=le[0],he=le[2];ce.push(he.angle())}}catch(x2){ue.e(x2)}finally{ue.f()}var fe,de=s(S);try{for(de.s();!(fe=de.n()).done;){var pe=vr(fe.value,2),ve=pe[0],me=pe[1];ve.push(me.getWorldQuaternion())}}catch(x2){de.e(x2)}finally{de.f()}var ge,ye=s(M);try{for(ye.s();!(ge=ye.n()).done;){var be=vr(ge.value,3),_e=be[0],xe=be[2];_e.push(xe.getWorldQuaternion())}}catch(x2){ye.e(x2)}finally{ye.f()}var we,Se=s(k);try{for(Se.s();!(we=Se.n()).done;){var Me=vr(we.value,3),ke=Me[0],Te=Me[2];ke.push(Te.getWorldQuaternion())}}catch(x2){Se.e(x2)}finally{Se.f()}}}catch(x2){H.e(x2)}finally{H.f()}this._animationManager.setTime(h);for(var Ee=new Map,Ce=function(t){var n=Ee.get(t);if(void 0===n){var r={times:e,positions:new Map,jointAngles:new Map,rotations:new Map};return Ee.set(t,r),r}return n},Ae=0,Re=b;Ae<Re.length;Ae++){var Pe=vr(Re[Ae],2),Le=Pe[0],De=Pe[1];Ce(De).positions.set(void 0,Le)}for(var Ne=0,Ie=_;Ne<Ie.length;Ne++){var Oe=vr(Ie[Ne],3),Ue=Oe[0],Fe=Oe[1],ze=Oe[2];Ce(Fe).positions.set(ze,Ue)}for(var Be=0,Ve=x;Be<Ve.length;Be++){var Ge=vr(Ve[Be],3),je=Ge[0],He=Ge[1],We=Ge[2];Ce(He).positions.set(We,je)}for(var Ze=0,qe=w;Ze<qe.length;Ze++){var Xe=vr(qe[Ze],3),Ye=Xe[0],Ke=Xe[1],Je=Xe[2];Ce(Ke).jointAngles.set(Je,Ye)}for(var Qe=0,$e=S;Qe<$e.length;Qe++){var et=vr($e[Qe],2),tt=et[0],nt=et[1];Ce(nt).rotations.set(void 0,tt)}for(var rt=0,it=M;rt<it.length;rt++){var at=vr(it[rt],3),ot=at[0],st=at[1],ut=at[2];Ce(st).rotations.set(ut,ot)}for(var lt=0,ct=k;lt<ct.length;lt++){var ht=vr(ct[lt],3),ft=ht[0],dt=ht[1],pt=ht[2];Ce(dt).rotations.set(pt,ft)}return Ee}},{key:"frameDataFor",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=this.frameData(t,(function(t){return void 0===n&&t===e}),(function(t,r){return void 0!==n&&t===e&&r===n}),(function(t,r){return void 0!==n&&t===e&&r===n}),(function(t,r){return void 0!==n&&t===e&&r===n}),(function(t){return void 0===n&&t===e}),(function(t,r){return void 0!==n&&t===e&&r===n}),(function(t,r){return void 0!==n&&t===e&&r===n}),r),a=i.get(e);if(void 0===a)throw new d.AssertionError({message:"robotdata was undefined!"});if(void 0===n){var o=a.positions.get(void 0);if(void 0===o)throw new d.AssertionError({message:"pos was undefined!"});var s=a.rotations.get(void 0);if(void 0===s)throw new d.AssertionError({message:"pos was undefined!"});return{times:a.times,robotPositions:o,robotRotations:s}}if(n instanceof eP){var u=a.positions.get(n);if(void 0===u)throw new d.AssertionError({message:"linkPos was undefined!"});var l=a.rotations.get(n);if(void 0===l)throw new d.AssertionError({message:"linkPos was undefined!"});return{times:a.times,linkPositions:u,linkRotations:l}}var c=a.positions.get(n);if(void 0===c)throw new d.AssertionError({message:"jointPos was undefined!"});var h=a.rotations.get(n);if(void 0===h)throw new d.AssertionError({message:"jointPos was undefined!"});var f=a.jointAngles.get(n);return void 0===f&&(f=[]),{times:a.times,jointPositions:c,jointAngles:f,jointRotations:h}}},{key:"copy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.setParentRobotSceneManager(e.robotSceneManager());var a,o=new Map,u=s(e.robots());try{for(u.s();!(a=u.n()).done;){var l=a.value;if("World Frame"!==l.name()){var c=l.clone();this.addChildRobot(c),o.set(l,c)}}}catch(x2){u.e(x2)}finally{u.f()}if(wr((0,_r.Z)(n.prototype),"copy",this).call(this,e,t,r,i,o),i){var h,f=s(e._traces);try{for(f.s();!(h=f.n()).done;){var p=h.value,v=[p.robot(),p.robotPart(),p.times()],m=v[0],g=v[1],y=v[2],b=o.get(m);if(void 0!==b)if(void 0===g)this.addChildTrace(b,y,g);else if(g instanceof eP){var _=b.linkMap().get(g.name());if(void 0===_)continue;this.addChildTrace(b,y,_)}else{if(!(g instanceof $R))throw new d.AssertionError({message:"robotPart was not undefined, RobotLink, or RobotJoint"});var x=b.jointMap().get(g.name());if(void 0===x)continue;this.addChildTrace(b,y,x)}}}catch(x2){f.e(x2)}finally{f.f()}}return this}},{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=(new n).copy(this,e,t,r);return i}},{key:"hasChildTrace",value:function(e,t){return void 0!==this.getChildTrace(e,t)}},{key:"innerNewTraces",value:function(e,t,n,r,i,a,o){var u;lr.assert(this.hasChildRobot(e),"A RobotScene can only generate Traces for Robots that it contains.");var l=new Map;if(void 0===n)(u=new Map).set(void 0,this.frameDataFor(e,t,void 0,!0).robotPositions),l.set(n,this.frameDataFor(e,t,n,!0).robotRotations);else if(n instanceof $R)(u=new Map).set(n,this.frameDataFor(e,t,n,!0).jointPositions),l.set(n,this.frameDataFor(e,t,n,!0).jointRotations);else{if(!(n instanceof eP))throw new d.AssertionError({message:"robotPart was not a boolean, RobotJoint, or RobotLink!"});(u=new Map).set(n,this.frameDataFor(e,t,n,!0).linkPositions),l.set(n,this.frameDataFor(e,t,n,!0).linkRotations)}var c,h=[],f=s(u);try{for(f.s();!(c=f.n()).done;){var p=vr(c.value,2),v=p[0],m=p[1],g=l.get(v),y=this.robotSceneManager();if(void 0!==y){var b=[y.currStartTime(),y.currEndTime()];h.push(new WP(m,e,v,t,void 0===a?this._density:a,void 0===i?this._axisSize:i,void 0===o?this._traceSize:o,b,void 0===r?this.getNextColor():r,g))}}}catch(x2){f.e(x2)}finally{f.f()}return h}},{key:"getChildTrace",value:function(e,t){var n,r=s(this._traces);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.robot()===e&&i.robotPart()===t)return i}}catch(x2){r.e(x2)}finally{r.f()}}},{key:"getTrace",value:function(e,t){var n,r=s(this.getAllTraces());try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.robot()===e&&i.robotPart()===t)return i}}catch(x2){r.e(x2)}finally{r.f()}}},{key:"addChildTrace",value:function(e,t,r){var i,a=[],o=s(n.newTraces(e,t,r));try{for(o.s();!(i=o.n()).done;){var u=i.value,l=this.getChildTrace(e,u.robotPart());void 0===l?(u.setParentScene(this),this._traces.push(u),a.push(u.id()),this._traceMap.set(u.id(),u)):l.update(u.points().map((function(e){return e.clone()})),e,u.robotPart(),t,u.traceType(),u.rotations().map((function(e){return e.clone()})))}}catch(x2){o.e(x2)}finally{o.f()}return void 0!==r?r.addToScene():e.addToScene(),this._update=!0,a}},{key:"updateTraces",value:function(){var e=this.robotSceneManager();if(void 0!==e){var t,n=[e.currStartTime(),e.currEndTime()],r=s(this.getAllTraces());try{for(r.s();!(t=r.n()).done;){t.value.updateTimespan(n)}}catch(x2){r.e(x2)}finally{r.f()}var i,a=s(this._arrows);try{for(a.s();!(i=a.n()).done;){vr(i.value,2)[1].updateTimespan()}}catch(x2){a.e(x2)}finally{a.f()}}}},{key:"getNextColor",value:function(){return this._colorPalettes.pop()}},{key:"addColorBack",value:function(e){-1!==XU.indexOf(e)&&this._colorPalettes.push(e)}},{key:"removeChildTrace",value:function(e,t){var n=!1;if(void 0===t){var r,i=s(this._traces);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.robot()===e){var o=this._traces.indexOf(a);o>-1&&(this._traces.splice(o,1),a.setParentScene(void 0),this._traceMap.delete(a.id())),n=!0,this.addColorBack(a.color())}}}catch(x2){i.e(x2)}finally{i.f()}e.removeFromScene()}else{var u,l=s(this._traces);try{for(l.s();!(u=l.n()).done;){var c=u.value;if(c.robot()===e&&c.robotPart()===t){var h=this._traces.indexOf(c);h>-1&&(this._traces.splice(h,1),c.setParentScene(void 0),this._traceMap.delete(c.id())),n=!0,this.addColorBack(c.color())}}}catch(x2){l.e(x2)}finally{l.f()}t.removeFromScene()}return!!n&&(this._update=!0,lr.updateUI(),this.render(),!0)}},{key:"id",value:function(){return this._id}},{key:"update",value:function(){return this._update}},{key:"setUpdate",value:function(e){this._update=e}},{key:"color",value:function(){return this._color}},{key:"setColor",value:function(e){this._color=e,this.render()}},{key:"robots",value:function(){return this._robots}},{key:"scene",value:function(){return this._scene}},{key:"setHoveredRobot",value:function(e){var t;e!==this._hoveredRobot&&(null===(t=this._hoveredRobot)||void 0===t||t.setDesaturated(!1),null===e||void 0===e||e.setDesaturated(!0),this._hoveredRobot=e,lr.updateUI())}},{key:"hoveredRobot",value:function(){return this._hoveredRobot}},{key:"setSelectedRobot",value:function(e){var t;e!==this._selectedRobot&&(null===(t=this._selectedRobot)||void 0===t||t.setHighlighted(!1),null===e||void 0===e||e.setHighlighted(!0),this._selectedRobot=e,lr.updateUI())}},{key:"selectedRobot",value:function(){return this._selectedRobot}},{key:"addChildRobot",value:function(e){e.setParentRobotScene(this),this._robots.push(e),lr.updateUI()}},{key:"removeChildRobot",value:function(e){var t=this._robots.indexOf(e);t>-1&&(this.removeChildTrace(e),this._robots.splice(t,1),e.setParentRobotScene(void 0),lr.updateUI())}},{key:"hasChildRobot",value:function(e){return this._robots.indexOf(e)>-1}},{key:"loadJsonFromLocalFile",value:function(){var e=pr(fr().mark((function e(t){var n;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,TR(t);case 2:n=e.sent,this.loadJson(n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadJsonFromURL",value:function(){var e=pr(fr().mark((function e(t){var n;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,MR(t);case 2:n=e.sent,this.loadJson(n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadJson",value:function(){var e=pr(fr().mark((function e(t){return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.deserialize(this._robotSceneManager.value(),t,this);case 2:this.render(),lr.updateUI();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"saveAsJsonTo",value:function(e){zP(this.serialize(),e,4)}},{key:"loadRobotFromURL",value:function(){var e=pr(fr().mark((function e(t){var n,r,i,a,o,s,u,l,c,h,f=arguments;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=f.length>1&&void 0!==f[1]?f[1]:"",e.prev=1,e.next=4,rP.loadRobot(t,void 0,n);case 4:return r=e.sent,this.addChildRobot(r),this.render(),i="Robot ".concat(r.name()," Uploaded Successfully!"),(a=document.createElement("p")).innerText=i,a.classList.add("LoadRobotMessage"),o=document.querySelector(".LoadAndSavePanel"),null===(s=null===o||void 0===o?void 0:o.querySelector(".LoadRobot"))||void 0===s||s.appendChild(a),e.abrupt("return",r);case 17:throw e.prev=17,e.t0=e.catch(1),u="Error loading robot: "+e.t0,(l=document.createElement("p")).innerText=u,l.style.color="red",l.classList.add("LoadRobotMessage"),c=document.querySelector(".LoadAndSavePanel"),null===(h=null===c||void 0===c?void 0:c.querySelector(".LoadRobot"))||void 0===h||h.appendChild(l),e.t0;case 28:case"end":return e.stop()}}),e,this,[[1,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"addEETarget",value:function(){var e=pr(fr().mark((function e(){var t;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=rP.createAxesHelper(.1,"EE Target "+this._num_ee_targets),this._num_ee_targets+=1,this.addChildRobot(t),this.render(),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addWorldFrame",value:function(){var e=new cb.AxesHelper(1);return this._worldFrameObject=e,this.scene().add(e),this.render(),e}},{key:"serialize",value:function(){var e,t=[],n=s(this._robots);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push(r.serialize())}}catch(x2){n.e(x2)}finally{n.f()}return{id:this.id().value(),robots:t,animationManager:this._animationManager.serialize(),animationTables:[]}}}],[{key:"frameRange",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600,i=arguments.length>4?arguments[4]:void 0;void 0===i&&(i=function(e){return e}),n=Math.abs(n),r=Math.abs(r);var a,o=Math.abs(t-e),u=Math.min(Math.floor(n*o),r),l=Math.abs(o/u),c=[],h=i,f=s((isNaN(l)||o/l<2?fr().mark((function t(){var n,r,i;return fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=0,r=[e-.001,e,e+.001];case 1:if(!(n<r.length)){t.next=8;break}return i=r[n],t.next=5,i;case 5:n++,t.next=1;break;case 8:case"end":return t.stop()}}),t)})):fr().mark((function n(){var r;return fr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=e;case 1:if(!(r<=t)){n.next=7;break}return n.next=4,r;case 4:r+=l,n.next=1;break;case 7:case"end":return n.stop()}}),n)})))());try{for(f.s();!(a=f.n()).done;){var d=a.value;c.push(h(d))}}catch(x2){f.e(x2)}finally{f.f()}return c}},{key:"possibleTraces",value:function(e){var t=[];t.push(void 0);var n,r=s(e.joints());try{for(r.s();!(n=r.n()).done;){var i=n.value;t.push(i)}}catch(x2){r.e(x2)}finally{r.f()}var a,o=s(e.links());try{for(o.s();!(a=o.n()).done;){var u=a.value;t.push(u)}}catch(x2){o.e(x2)}finally{o.f()}return t}},{key:"newTraces",value:function(e,t,n,r,i,a,o){var s=e.parentScene();if(void 0===s)throw lr.assert(void 0!==s,'In "newTraces", the given Robot was not currently in a RobotScene and therefore could not be traced.'),new d.AssertionError;return s.innerNewTraces(e,t,n,r,i,a,o)}},{key:"deserialize",value:function(){var e=pr(fr().mark((function e(t,r,i){var a,o,u,l,c,h,f,d,p,v,m,g,y,b,_,x,w,S,M,k,T,E,C,A,R,P,L,D;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null!==i&&void 0!==i?i:new n(t),void 0===r.robotFiles){e.next=5;break}return e.next=4,this.oldDeserialize(t,r,a);case 4:return e.abrupt("return",e.sent);case 5:u=[],l=s((o=r).robots);try{for(l.s();!(c=l.n()).done;)h=c.value,u.push(rP.deserialize(h))}catch(x2){l.e(x2)}finally{l.f()}return e.next=11,Promise.all(u);case 11:f=e.sent,d=[],p=s(o.animationTables);try{for(p.s();!(v=p.n()).done;)m=v.value,d.push(FR.deserialize(m))}catch(x2){p.e(x2)}finally{p.f()}return e.next=17,Promise.all(d);case 17:g=e.sent,y=new Map,b=s(g);try{for(b.s();!(_=b.n()).done;)x=_.value,y.set(x.idValue(),x)}catch(x2){b.e(x2)}finally{b.f()}w=new Map,S=s(f);try{for(S.s();!(M=S.n()).done;)k=M.value,w.set(k.id().value(),k)}catch(x2){S.e(x2)}finally{S.f()}if(!o.animationManager){e.next=27;break}return e.next=27,HR.deserialize(o.animationManager,w,y,a.animationManager());case 27:T=s(g);try{for(T.s();!(E=T.n()).done;)E.value.id().regen()}catch(x2){T.e(x2)}finally{T.f()}C=s(f);try{for(C.s();!(A=C.n()).done;)(R=A.value).id().regen(),a.addChildRobot(R)}catch(x2){C.e(x2)}finally{C.f()}a.animationManager().setTime(0),P=s(g);try{for(P.s();!(L=P.n()).done;)D=L.value,lr.addAnimationTable(D)}catch(x2){P.e(x2)}finally{P.f()}return e.abrupt("return",a);case 35:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"oldDeserialize",value:function(){var e=pr(fr().mark((function e(t,r,i){var a,o,u,l,c,h,f,d,p,v,m,g,y,b,_,x,w,S,M,k,T,E,C,A,R,P,L,D,N,I,O,U,F,z,B,V,G,j,H,W,Z=arguments;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=!(Z.length>3&&void 0!==Z[3])||Z[3],o=null!==i&&void 0!==i?i:new n(t),u=[],l=s(r.robotFiles);try{for(l.s();!(c=l.n()).done;)h=c.value,u.push(o.loadRobotFromURL(h))}catch(x2){l.e(x2)}finally{l.f()}return e.next=7,Promise.all(u);case 7:f=e.sent,d=0,p=new Map,v=s(Ib(f)),e.prev=11,v.s();case 13:if((m=v.n()).done){e.next=71;break}g=vr(m.value,2),y=g[0],b=g[1],p.set(b.id().value(),b),_=b.getScaleOffset(),x=b.getPositionOffset(),w=(new cb.Euler).setFromQuaternion(b.getQuaternionOffset()),S=b.getScale(),M=b.getPosition(),k=(new cb.Euler).setFromQuaternion(b.getQuaternion()),T=r.configsMap[y],E=0;case 24:if(!(E<T)){e.next=61;break}C=d+E,A=r.configs[C],e.t0=E,e.next=0===e.t0?30:1===e.t0?32:2===e.t0?34:3===e.t0?36:4===e.t0?38:5===e.t0?40:6===e.t0?42:7===e.t0?44:8===e.t0?46:9===e.t0?48:10===e.t0?50:11===e.t0?52:12===e.t0?54:56;break;case 30:return _.set(A,A,A),e.abrupt("break",58);case 32:return x.x=A,e.abrupt("break",58);case 34:return x.y=A,e.abrupt("break",58);case 36:return x.z=A,e.abrupt("break",58);case 38:return w.x=A,e.abrupt("break",58);case 40:return w.y=A,e.abrupt("break",58);case 42:return w.z=A,e.abrupt("break",58);case 44:return M.x=A,e.abrupt("break",58);case 46:return M.y=A,e.abrupt("break",58);case 48:return M.z=A,e.abrupt("break",58);case 50:return k.x=A,e.abrupt("break",58);case 52:return k.y=A,e.abrupt("break",58);case 54:return k.z=A,e.abrupt("break",58);case 56:(R=b.joints()[E-12])&&R.setAngle(A);case 58:E++,e.next=24;break;case 61:d+=T,a&&(b._robot.rotation.x=-Math.PI/2),b.setScaleOffset(_),b.setPositionOffset(x),b.setQuaternionOffset((new cb.Quaternion).setFromEuler(w)),b.setScale(S),b.setPosition(M),b.setQuaternion((new cb.Quaternion).setFromEuler(k));case 69:e.next=13;break;case 71:e.next=76;break;case 73:e.prev=73,e.t1=e.catch(11),v.e(e.t1);case 76:return e.prev=76,v.f(),e.finish(76);case 79:P=[],L=s(r.animationURLs),e.prev=81,N=fr().mark((function e(){var t;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=D.value,P.push(pr(fr().mark((function e(){var n,r,i;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FR.loadFromURL(t);case 2:n=e.sent,r=s(n);try{for(r.s();!(i=r.n()).done;)i.value.fromGazebo=a}catch(x2){r.e(x2)}finally{r.f()}return e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})))());case 2:case"end":return e.stop()}}),e)})),L.s();case 84:if((D=L.n()).done){e.next=88;break}return e.delegateYield(N(),"t2",86);case 86:e.next=84;break;case 88:e.next=93;break;case 90:e.prev=90,e.t3=e.catch(81),L.e(e.t3);case 93:return e.prev=93,L.f(),e.finish(93);case 96:return e.next=98,Promise.all(P);case 98:I=e.sent,O=0,U=r.animationMap,F=new Hb,z=s(Ib(f));try{for(z.s();!(B=z.n()).done;)for(V=vr(B.value,2),G=V[0],j=V[1],H=0;H<U[G];H++)(W=I[O++])&&W.length>0&&F.addAnimation(new jb(j,W[0]))}catch(x2){z.e(x2)}finally{z.f()}return F.animations().length>0&&(o.animationManager().addActiveAnimation(F),o.animationManager().setTime(0)),e.abrupt("return",o);case 106:case"end":return e.stop()}}),e,null,[[11,73,76,79],[81,90,93,96]])})));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(YR),KU=n(1501),JU=n.n(KU),QU="line",$U="tube",eF="cone",tF=eF,nF=function(){function e(t,n,r,i,a,o,s){var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:tF;(0,u.Z)(this,e),this._parentScene=void 0,this._quaternions=void 0,this._currGeom=void 0,this._currGeomArray=void 0,this._currQuaternionGeom=void 0,this._vectors=void 0,this._currGeom2=void 0,this._currGeomArray2=void 0,this._currQuaternionGeom2=void 0,this._vectors2=void 0,this._positive=void 0,this._color=void 0,this._is_visible=void 0,this._opacity=void 0,this._rootGroup=void 0,this._trace_type=void 0,this._parentRobot=void 0,this._robotPart=void 0,this._times=void 0,this._timespan=void 0,this._timespanIndex=void 0,this._currTime=void 0,this._color=void 0===s?Pb():s,this._trace_type=tF,this._timespan=a,this._timespanIndex=[],this._currTime=o,this._positive=!0,this._currGeomArray=[],this._rootGroup=new cb.Group,this._currGeom=this.newGeom(void 0,!0),this._rootGroup.add(this._currGeom),this._currQuaternionGeom=this.newSymbolGeom(),this._rootGroup.add(this._currQuaternionGeom),this._currGeomArray2=[],this._currGeom2=this.newGeom(void 0,!1),this._rootGroup.add(this._currGeom2),this._currQuaternionGeom2=this.newSymbolGeom(),this._rootGroup.add(this._currQuaternionGeom2),this._is_visible=!0,this._quaternions=[],this._parentRobot=n,this._robotPart=r,this._times=i,this._opacity=1,this._vectors=[],this._vectors2=[],this._parentScene=new nP(void 0),this.update(t,n,r,i,l,o);var c=new WeakRef(this);n.afterParentSceneSet().subscribe((function(e){var t=vr(e,2)[1],n=c.deref();return void 0!==n&&(void 0===t?(n.setParentScene(void 0),!1):(n.updateQuaternions(),!0))})),n.afterpositionOffsetSet().subscribe((function(){var e=c.deref();return void 0!==e&&(e.updateQuaternions(),!0)}))}return(0,l.Z)(e,[{key:"timespanIndex",value:function(){return this._timespanIndex}},{key:"updateTimespan",value:function(e){var t,n;if(2===e.length&&void 0!==this._times){this._timespan=e;var r=0,i=this._times.length-1;if(null!==(t=this._parentRobot.parentScene())&&void 0!==t&&t.isTimeWarping()){var a,o,s,u,l=null===(a=this._parentRobot.parentScene())||void 0===a||null===(o=a.timeWarping())||void 0===o?void 0:o.timeWarpMap(),c=null===(s=this._parentRobot.parentScene())||void 0===s||null===(u=s.timeWarping())||void 0===u?void 0:u.indexMap();if(void 0===l||void 0===c)return;for(var h=0;h<l[1].length;h++)if(l[0][h]>=e[0]){r=c[1][h];break}for(var f=l[1].length-1;f>=0;f--)if(l[0][f]<=e[1]){i=c[1][f];break}}else{for(var d=0;d<this._times.length;d++)if(this._times[d]>=e[0]){r=d;break}for(var p=this._times.length-1;p>=0;p--)if(this._times[p]<=e[1]){i=p;break}}this._timespanIndex=[r,i];for(var v=0;v<this._currGeomArray.length;v++)void 0!==this._currGeomArray[v]&&(this._currGeomArray[v].visible=!(v<r||v>i));for(var m=0;m<this._currGeomArray2.length;m++)void 0!==this._currGeomArray2[m]&&(this._currGeomArray2[m].visible=!(m<r||m>i));null===(n=this.parentScene())||void 0===n||n.render()}}},{key:"updateQuaternions",value:function(){var e=this.robot(),t=e.parentScene();if(!t)return!1;var n,r=this.robotPart();if(r instanceof $R)n=t.frameDataFor(e,this.times(),r,!0).jointRotations;else{if(!(r instanceof eP))throw new Error("Invalid robotPart type");n=t.frameDataFor(e,this.times(),r,!0).linkRotations}return this.setQuaternions(n),this.updateSymbolGeom(this._currTime),!0}},{key:"beforeParentSceneSet",value:function(){return this._parentScene.beforeSet()}},{key:"afterParentSceneSet",value:function(){return this._parentScene.afterSet()}},{key:"robot",value:function(){return this._parentRobot}},{key:"robotPart",value:function(){return this._robotPart}},{key:"times",value:function(){return this._times}},{key:"color",value:function(){return this._color}},{key:"traverseMeshes",value:function(e){this._rootGroup.traverse((function(t){KR(t)&&e(t)}))}},{key:"traverseMaterials",value:function(e){this._rootGroup.traverse((function(t){_b(t.material,e)}))}},{key:"visible",value:function(){return this._is_visible}},{key:"setVisible",value:function(e){e!==this._is_visible&&(this.traverseMeshes((function(t){t.visible=e})),this._is_visible=e,lr.updateUI(),lr.render())}},{key:"opacity",value:function(){return this._opacity}},{key:"setOpacity",value:function(e){var t=this;this._opacity=Lb(e,0,1),this.traverseMaterials((function(e){e.opacity=t._opacity})),lr.updateUI(),lr.render()}},{key:"parentScene",value:function(){return this._parentScene.value()}},{key:"setTraceType",value:function(e){this.update(this._quaternions,this._parentRobot,this._robotPart,this.times(),e)}},{key:"traceType",value:function(){return this._trace_type}},{key:"calCurrQuaternion",value:function(e){var t=this.robot(),n=t.parentScene();if(n){var r=this.robotPart(),i=aF.extraceDataFromframeData(n,t,[e],r).get(r);if(void 0===i)return;return i[0]}}},{key:"newSymbolGeom",value:function(){var e=new cb.SphereGeometry(.01),t=new cb.MeshBasicMaterial({color:"red"});return new cb.Mesh(e,t)}},{key:"updateSymbolGeom",value:function(e){var t,n,r,i=vb(this._times,e),a=this._quaternions[0];if(-1===i)n=gb(a,void 0,!0),r=gb(a,void 0,!1);else{var o=this._quaternions[i],s=this._quaternions[i],u=this._times[i],l=this._times[i];i+1<this._quaternions.length&&(s=this._quaternions[i+1],l=this._times[i+1]),n=gb(a=o.slerp(s,(e-u)/(l-u)),this._vectors[i],!0),r=gb(a,this._vectors2[i],!1)}this._currQuaternionGeom.position.copy(n),this._currQuaternionGeom2.position.copy(r),null===(t=this.parentScene())||void 0===t||t.render(),this._currTime=e}},{key:"newGeom",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:tF;void 0===e&&(e=[]),0===e.length?e.push(new cb.Quaternion,new cb.Quaternion):1===e.length&&e.push(e[0].clone());var r,i=[],a=void 0,o=s(e);try{for(o.s();!(r=o.n()).done;){var u=r.value,l=gb(u,a,t);i.push(l),a=l}}catch(x2){o.e(x2)}finally{o.f()}t?this._vectors=i:this._vectors2=i;var c=new cb.CatmullRomCurve3(i,!1);if(n===QU){var h=(new cb.BufferGeometry).setFromPoints(c.getPoints(i.length)),f=new cb.LineBasicMaterial({color:new cb.Color(this._color).convertSRGBToLinear()});return new cb.Line(h,f)}if(n===$U){var d=new cb.TubeGeometry(c,2*i.length,.005,8,!0),p=new cb.MeshBasicMaterial({color:new cb.Color(this._color).convertSRGBToLinear()});return new cb.Mesh(d,p)}if(n===eF){for(var v=new cb.Group,m=new cb.Matrix4,g=new cb.MeshBasicMaterial({color:new cb.Color(this._color).convertSRGBToLinear()}),y=[],b=0;b<i.length-1;b++){var _=i[b],x=i[b+1],w=_.distanceTo(x);if(!(0===w||w>=1)){var S=.005,M=w,k=new cb.Mesh(new cb.ConeGeometry(S,M),g);k.rotateX(Math.PI/2);var T=new cb.Group;T.add(k),T.position.copy(_),m.lookAt(x,_,T.up),T.quaternion.setFromRotationMatrix(m);var E=new cb.Vector3;E.subVectors(x,_).normalize(),T.position.addScaledVector(E,w/2),v.add(T),y[b]=T}}return t?this._currGeomArray=y:this._currGeomArray2=y,this.updateTimespan(this._timespan),v}throw new Error('Unknown LineTraceType "'.concat(n,'"'))}},{key:"setParentScene",value:function(e){var t=this;e!==this._parentScene.value()&&(this._parentScene.setValue((function(e,n){e&&(e.scene().remove(t._rootGroup),e.render())}),e,(function(e,n){void 0!==n&&(n.scene().add(t._rootGroup),n.render())})),lr.updateUI())}},{key:"quaternions",value:function(){return this._quaternions}},{key:"clonedQuaternions",value:function(){return this._quaternions.map((function(e){return e.clone()}))}},{key:"setQuaternions",value:function(e){this.update(e,this._parentRobot,this._robotPart,this.times(),this._trace_type)}},{key:"flipTrace",value:function(){var e;this._positive?(this._currGeom.visible=!1,this._currQuaternionGeom.visible=!1,this._currGeom2.visible=!0,this._currQuaternionGeom2.visible=!0):(this._currGeom.visible=!0,this._currQuaternionGeom.visible=!0,this._currGeom2.visible=!1,this._currQuaternionGeom2.visible=!1),this._positive=!this._positive,null===(e=this.parentScene())||void 0===e||e.render()}},{key:"update",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:tF,a=arguments.length>5?arguments[5]:void 0;this._quaternions=e,this._parentRobot=t,this._robotPart=n,this._times=r;var o=this.newGeom(e,!0,i),s=this.newGeom(e,!1,i);void 0!==a&&this.updateSymbolGeom(a),this._rootGroup.remove(this._currGeom),this._rootGroup.remove(this._currGeom2),this._currGeom=o,this._currGeom2=s,this._positive?(this._currGeom.visible=!0,this._currQuaternionGeom.visible=!0,this._currGeom2.visible=!1,this._currQuaternionGeom2.visible=!1):(this._currGeom.visible=!1,this._currQuaternionGeom.visible=!1,this._currGeom2.visible=!0,this._currQuaternionGeom2.visible=!0),this._rootGroup.add(this._currGeom),this._rootGroup.add(this._currGeom2),this._trace_type=i}},{key:"clone",value:function(){var t,n=[],r=s(this._quaternions);try{for(r.s();!(t=r.n()).done;){var i=t.value;n.push(i.clone())}}catch(x2){r.e(x2)}finally{r.f()}var a=new e(n,this._parentRobot,this._robotPart,this.times(),this._timespan,this._currTime,this._color,this._trace_type);return a.setVisible(this._is_visible),a._color=this._color,a}}]),e}(),rF=["rgb(255, 255, 0)","brown","red","#204BD8","purple","green"],iF=0,aF=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r){var i;return(0,u.Z)(this,n),(i=t.call(this))._id=void 0,i._name=void 0,i._traces=void 0,i._color=void 0,i._colorPalettes=void 0,i._robotSceneManager=void 0,i._update=void 0,i._lineGroup=void 0,i._lineGroupOpacity=void 0,i._lineGroupColor=void 0,i._backgroundColor=void 0,i._worldFrameObject=void 0,i._id=new Yb(r),i._color=Pb(),i._name="Quat Space "+ ++iF,i._colorPalettes=[].concat(rF),i._update=!1,i._traces=[],i._worldFrameObject=new cb.Object3D,i._lineGroup=new cb.Group,i._lineGroupOpacity=.1,i._lineGroupColor="#00ff00",i.createInitialSphere(),i.addWorldFrame(),i._backgroundColor="#263238",i._robotSceneManager=e,void 0!==e&&e.addQuaternionSpaceScene((0,c.Z)(i)),i}return(0,l.Z)(n,[{key:"isWorldFrameObjectVisible",value:function(){return this._worldFrameObject.visible}},{key:"setWorldFrameObjectVisibility",value:function(e){this._worldFrameObject.visible=e,this.render()}},{key:"backgroundColor",value:function(){return this._backgroundColor}},{key:"setBackgroundColor",value:function(e){this._backgroundColor=e,this.scene().background=new cb.Color(e),this.render()}},{key:"addWorldFrame",value:function(){var e=new cb.AxesHelper(1);return this._worldFrameObject=e,this.scene().add(e),this.render(),e}},{key:"getAllTraces",value:function(){return cr(this._traces)}},{key:"removeAllTraces",value:function(){var e,t=s(cr(this._traces));try{for(t.s();!(e=t.n()).done;){var n=e.value;this.removeChildTrace(n.robot(),n.robotPart())}}catch(x2){t.e(x2)}finally{t.f()}}},{key:"robotSceneManager",value:function(){return this._robotSceneManager}},{key:"hasChildTrace",value:function(e,t){return void 0!==this.getChildTrace(e,t)}},{key:"innerNewTraces",value:function(e,t,r,i,a){var o=this.robotSceneManager();if(void 0===o)return[];var u,l=n.extraceDataFromframeData(e,t,r,i),c=[],h=s(l);try{for(h.s();!(u=h.n()).done;){var f=vr(u.value,2),d=f[0],p=(f[1],l.get(d));if(void 0!==p){var v=[o.currStartTime(),o.currEndTime()];c.push(new nF(p,t,d,r,v,o.currTime(),void 0===a?this.getNextColor():a))}}}catch(x2){h.e(x2)}finally{h.f()}return c}},{key:"getChildTrace",value:function(e,t){var n,r=s(this._traces);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.robot()===e&&i.robotPart()===t)return i}}catch(x2){r.e(x2)}finally{r.f()}}},{key:"addChildTrace",value:function(e,t,n,r){var i,a=s(this.innerNewTraces(e,t,n,r));try{for(a.s();!(i=a.n()).done;){var o=i.value,u=this.getChildTrace(t,o.robotPart());void 0===u?(o.setParentScene(this),this._traces.push(o)):u.update(o.quaternions().map((function(e){return e.clone()})),t,o.robotPart(),n,o.traceType())}}catch(x2){a.e(x2)}finally{a.f()}void 0!==r?r.addToScene():t.addToScene(),this._update=!0}},{key:"updateTraces",value:function(){var e=this.robotSceneManager();if(void 0!==e){var t,n=[e.currStartTime(),e.currEndTime()],r=s(this.getAllTraces());try{for(r.s();!(t=r.n()).done;){t.value.updateTimespan(n)}}catch(x2){r.e(x2)}finally{r.f()}}}},{key:"updateTraceSymbols",value:function(){var e=this.robotSceneManager();if(void 0!==e){var t,n=s(this.getAllTraces());try{for(n.s();!(t=n.n()).done;){t.value.updateSymbolGeom(e.currTime())}}catch(x2){n.e(x2)}finally{n.f()}}}},{key:"createInitialSphere",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1,n=16,r=20,i=new cb.SphereGeometry(e,r,n),a=new cb.MeshStandardMaterial({transparent:!0,opacity:t}),o=new cb.Mesh(i,a);o.rotation.x=Math.PI/2,this.scene().add(o);for(var s=new cb.LineBasicMaterial({color:65280,transparent:!0,opacity:this._lineGroupOpacity,side:cb.DoubleSide}),u=new cb.Group,l=1;l<n;l++){for(var c=Math.PI/n*l-Math.PI/2,h=[],f=0;f<=r;f++){var d=2*Math.PI/r*f-Math.PI,p=new cb.Vector3(Math.cos(c)*Math.cos(d),Math.cos(c)*Math.sin(d),Math.sin(c)).multiplyScalar(e);h.push(p)}var v=(new cb.BufferGeometry).setFromPoints(h),m=new cb.Line(v,s);u.add(m)}for(var g=0;g<=r;g++){for(var y=2*Math.PI/r*g-Math.PI,b=[],_=0;_<=n;_++){var x=Math.PI/n*_-Math.PI/2,w=new cb.Vector3(Math.cos(x)*Math.cos(y),Math.cos(x)*Math.sin(y),Math.sin(x)).multiplyScalar(e);b.push(w)}var S=(new cb.BufferGeometry).setFromPoints(b),M=new cb.Line(S,s);u.add(M)}this._lineGroup=u,this.scene().add(u)}},{key:"setLineGroupOpacity",value:function(e){this._lineGroupOpacity=e,this._lineGroup.traverse((function(t){t instanceof cb.Line&&t.material&&(t.material.opacity=e,t.material.transparent=!0)})),this.render()}},{key:"lineGroupOpacity",value:function(){return this._lineGroupOpacity}},{key:"setLineGroupColor",value:function(e){this._lineGroupColor=e,this._lineGroup.traverse((function(t){t instanceof cb.Line&&t.material&&(t.material.color=new cb.Color(e))})),this.render()}},{key:"lineGroupColor",value:function(){return this._lineGroupColor}},{key:"getNextColor",value:function(){return this._colorPalettes.pop()}},{key:"addColorBack",value:function(e){-1!==rF.indexOf(e)&&this._colorPalettes.push(e)}},{key:"removeChildTrace",value:function(e,t){var n=!1;if(void 0===t){var r,i=s(this._traces);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.robot()===e){var o=this._traces.indexOf(a);o>-1&&(this._traces.splice(o,1),a.setParentScene(void 0)),n=!0,this.addColorBack(a.color())}}}catch(x2){i.e(x2)}finally{i.f()}e.removeFromScene()}else{var u,l=s(this._traces);try{for(l.s();!(u=l.n()).done;){var c=u.value;if(c.robot()===e&&c.robotPart()===t){var h=this._traces.indexOf(c);h>-1&&(this._traces.splice(h,1),c.setParentScene(void 0)),n=!0,this.addColorBack(c.color())}}}catch(x2){l.e(x2)}finally{l.f()}t.removeFromScene()}return!!n&&(this._update=!0,lr.updateUI(),this.render(),!0)}},{key:"id",value:function(){return this._id}},{key:"update",value:function(){return this._update}},{key:"setUpdate",value:function(e){this._update=e}},{key:"color",value:function(){return this._color}},{key:"setColor",value:function(e){this._color=e,this.render()}},{key:"scene",value:function(){return this._scene}}],[{key:"possibleTraces",value:function(e){var t=[];t.push(void 0);var n,r=s(e.joints());try{for(r.s();!(n=r.n()).done;){var i=n.value;t.push(i)}}catch(x2){r.e(x2)}finally{r.f()}var a,o=s(e.links());try{for(o.s();!(a=o.n()).done;){var u=a.value;t.push(u)}}catch(x2){o.e(x2)}finally{o.f()}return t}},{key:"extraceDataFromframeData",value:function(e,t,n,r){var i=new Map;if(void 0===r)i.set(r,e.frameDataFor(t,n,r,!0).robotRotations);else if(r instanceof $R)i.set(r,e.frameDataFor(t,n,r,!0).jointRotations);else{if(!(r instanceof eP))throw new d.AssertionError({message:"robotPart was not a boolean, RobotJoint, or RobotLink!"});i.set(r,e.frameDataFor(t,n,r,!0).linkRotations)}return i}}]),n}(YR),oF=["white","yellow","red","#204BD8","green","brown","purple"],sF=function(){function e(t,n,r,i,a,o,s,l,c,h,f){(0,u.Z)(this,e),this._id=void 0,this._name=void 0,this._line_names=void 0,this._line_ids=void 0,this._line_colors=void 0,this._delete_line=void 0,this._isDiff=void 0,this._isTimeWarp=void 0,this._currProperty=void 0,this._colorPalettes=void 0,this._lineWidth=void 0,this._backgroundColor=void 0,this._axisColor=void 0,this._filter=void 0,this._id=t,this._line_colors=[],this._line_names=[],this._line_ids=[],this._currProperty="&placeholder&joint position",this._lineWidth=1,this._backgroundColor="#171819",this._axisColor="#B7B7BD",this._filter=0,void 0!==c&&(this._lineWidth=c),void 0!==o&&(this._line_colors=o),void 0!=i&&(this._line_names=i),void 0!=a&&(this._line_ids=a),void 0!==l&&(this._currProperty=l),void 0!==h&&(this._backgroundColor=h),void 0!==f&&(this._axisColor=f),this._delete_line=s,this._isDiff=n,this._isTimeWarp=r,this._name="Graph"+e.counter,n?this._name="Difference "+this._name:r&&(this._name="Time Warped "+this._name),this._colorPalettes=[].concat(oF),e.counter++}return(0,l.Z)(e,[{key:"filter",value:function(){return this._filter}},{key:"setFilter",value:function(e){this._filter=e}},{key:"backgroundColor",value:function(){return this._backgroundColor}},{key:"setBackgroundColor",value:function(e){this._backgroundColor=e}},{key:"axisColor",value:function(){return this._axisColor}},{key:"setAxisColor",value:function(e){this._axisColor=e}},{key:"getColor",value:function(){var t=this._colorPalettes.pop();return void 0===t?e.genRandColor():t}},{key:"addColorBack",value:function(e){-1!==oF.indexOf(e)&&this._colorPalettes.push(e)}},{key:"resetColor",value:function(){this._colorPalettes=[].concat(oF)}},{key:"name",value:function(){return this._name}},{key:"setName",value:function(e){this._name=e}},{key:"id",value:function(){return this._id}},{key:"setLineNames",value:function(e){this._line_names=e}},{key:"lineNames",value:function(){return this._line_names}},{key:"setLineIds",value:function(e){this._line_ids=e}},{key:"lineIds",value:function(){return this._line_ids}},{key:"setLineColors",value:function(e){this._line_colors=e}},{key:"lineColors",value:function(){return this._line_colors}},{key:"setDeleteLine",value:function(e,t){this._delete_line=e,void 0!==t&&this.addColorBack(t)}},{key:"deleteLine",value:function(){return this._delete_line}},{key:"isDiff",value:function(){return this._isDiff}},{key:"isTimeWarp",value:function(){return this._isTimeWarp}},{key:"currProperty",value:function(){return this._currProperty}},{key:"setCurrProperty",value:function(e){this._currProperty=e}},{key:"setLineWidth",value:function(e){this._lineWidth=e}},{key:"lineWidth",value:function(){return this._lineWidth}}],[{key:"genRandColor",value:function(){return"hsl("+(310*Math.random()+30)+", "+(40*Math.random()+60)+"%, "+(50*Math.random()+50)+"%)"}}]),e}();sF.counter=0;var uF=["white","yellow","red","#204BD8","green","brown","purple"],lF=function(){function e(t,n,r,i,a,o,s,l){(0,u.Z)(this,e),this._id=void 0,this._name=void 0,this._line_names=void 0,this._line_ids=void 0,this._line_colors=void 0,this._colorPalettes=void 0,this._delete_line=void 0,this._lineWidth=void 0,this._backgroundColor=void 0,this._axisColor=void 0,this._id=t,this._line_colors=[],this._line_names=[],this._line_ids=[],void 0!==i&&(this._line_colors=i),void 0!=n&&(this._line_names=n),void 0!=r&&(this._line_ids=r),this._name="Umap Graph"+e.counter,this._delete_line=a,this._lineWidth=1,this._backgroundColor="#171819",this._axisColor="#B7B7BD",void 0!==s&&(this._backgroundColor=s),void 0!==l&&(this._axisColor=l),void 0!==o&&(this._lineWidth=o),this._colorPalettes=[].concat(uF),e.counter++}return(0,l.Z)(e,[{key:"backgroundColor",value:function(){return this._backgroundColor}},{key:"setBackgroundColor",value:function(e){this._backgroundColor=e}},{key:"axisColor",value:function(){return this._axisColor}},{key:"setAxisColor",value:function(e){this._axisColor=e}},{key:"setLineWidth",value:function(e){this._lineWidth=e}},{key:"lineWidth",value:function(){return this._lineWidth}},{key:"setDeleteLine",value:function(e,t){this._delete_line=e,void 0!==t&&this.addColorBack(t)}},{key:"deleteLine",value:function(){return this._delete_line}},{key:"getColor",value:function(){var e=this._colorPalettes.pop();return void 0===e?sF.genRandColor():e}},{key:"addColorBack",value:function(e){-1!==uF.indexOf(e)&&this._colorPalettes.push(e)}},{key:"resetColor",value:function(){this._colorPalettes=[].concat(uF)}},{key:"name",value:function(){return this._name}},{key:"setName",value:function(e){this._name=e}},{key:"id",value:function(){return this._id}},{key:"setLineNames",value:function(e){this._line_names=e}},{key:"lineNames",value:function(){return this._line_names}},{key:"setLineIds",value:function(e){this._line_ids=e}},{key:"lineIds",value:function(){return this._line_ids}},{key:"setLineColors",value:function(e){this._line_colors=e}},{key:"lineColors",value:function(){return this._line_colors}}]),e}();function cF(e,t){var n,r=s(Ob(e,t));try{for(r.s();!(n=r.n()).done;){var i=vr(n.value,2);if(i[0]!==i[1])return!1}}catch(x2){r.e(x2)}finally{r.f()}return!0}lF.counter=0;var hF=JU().scale([JU()(255,0,255),JU()(255,0,0),JU()(255,255,0),JU()(0,255,0),JU()(0,255,255),JU()(0,0,255)]).mode("rgb"),fF=function(){function e(){var t=this;(0,u.Z)(this,e),this._masterRobots=void 0,this._activeScenes=void 0,this._currScene=void 0,this._availableScenes=void 0,this._isSorted=void 0,this._animationTables=void 0,this._allowSelections=void 0,this._animationLoop=void 0,this._controlledScenes=void 0,this._syncViews=void 0,this._syncViewCallbacks=void 0,this._currSyncView=void 0,this._currTimeWarpBase=void 0,this._quaternionSpaceScenes=void 0,this._currQuaternionSpaceScene=void 0,this._umapGraphs=void 0,this._currUmapGraph=void 0,this._graphs=void 0,this._currSelectedGraph=void 0,this._restoreCallBack=void 0,this.currTimeWarpBase=function(){return t._currTimeWarpBase},this._masterRobots=[],this._animationTables=[],this._availableScenes=[],this._activeScenes=[],this._isSorted=!1,this._allowSelections=!0,this._quaternionSpaceScenes=new Map,this._umapGraphs=new Map,this._graphs=new Map,this._controlledScenes=[],this._animationLoop=new Xb(or,0,1,(function(e){var n,r=new Set,i=s(t._activeScenes);try{for(i.s();!(n=i.n()).done;){var a=n.value;r.add(a)}}catch(x2){i.e(x2)}finally{i.f()}var o,u=s(t._controlledScenes);try{for(u.s();!(o=u.n()).done;){var l=o.value;r.add(l)}}catch(x2){u.e(x2)}finally{u.f()}var c,h=s(r);try{for(h.s();!(c=h.n()).done;){var f=c.value,d=f.timeWarping();void 0!==d&&(e=d.timeWarp(e)),f.animationManager().setTime(e)}}catch(x2){h.e(x2)}finally{h.f()}t.updateAllTraceSymbols(),lr.updateUI(),lr.render()})),this._syncViews=!1;var n=new cb.Camera;n.position.set(3,3,3),n.lookAt(0,0,0),this._currSyncView=[n.position.clone(),(new cb.Quaternion).setFromEuler(n.rotation)],this._syncViewCallbacks=[]}return(0,l.Z)(e,[{key:"setRestoreCallBack",value:function(e){this._restoreCallBack=e}},{key:"hasGraph",value:function(e){return this._graphs.has(e)}},{key:"addGraph",value:function(e){this._graphs.set(e.id(),e)}},{key:"removeGraph",value:function(e){this._graphs.delete(e)}},{key:"getGraphById",value:function(e){return this._graphs.get(e)}},{key:"getAllGraphs",value:function(){var e,t=[],n=s(this._graphs);try{for(n.s();!(e=n.n()).done;){var r=vr(e.value,2)[1];t.push(r)}}catch(x2){n.e(x2)}finally{n.f()}return t}},{key:"getCurrGraph",value:function(){return this._currSelectedGraph}},{key:"setCurrGraph",value:function(e){void 0!==e?this.hasGraph(e)&&(this._currSelectedGraph=this._graphs.get(e)):this._currSelectedGraph=void 0}},{key:"hasUmapGraph",value:function(e){return this._umapGraphs.has(e)}},{key:"addUmapGraph",value:function(e){this._umapGraphs.set(e.id(),e)}},{key:"removeUmapGraph",value:function(e){this._umapGraphs.delete(e)}},{key:"getUmapGraphById",value:function(e){return this._umapGraphs.get(e)}},{key:"getAllUmapGraphs",value:function(){var e,t=[],n=s(this._umapGraphs);try{for(n.s();!(e=n.n()).done;){var r=vr(e.value,2)[1];t.push(r)}}catch(x2){n.e(x2)}finally{n.f()}return t}},{key:"getCurrUmapGraph",value:function(){return this._currUmapGraph}},{key:"setCurrUmapGraph",value:function(e){void 0!==e?this.hasUmapGraph(e)&&(this._currUmapGraph=this._umapGraphs.get(e)):this._currUmapGraph=void 0}},{key:"hasQuaternionSpaceScene",value:function(e){return this._quaternionSpaceScenes.has(e)}},{key:"addQuaternionSpaceScene",value:function(e){this._quaternionSpaceScenes.set(e.id().value(),e)}},{key:"removeQuaternionSpaceScene",value:function(e){var t=this.getQuaternionSpaceSceneById(e);void 0!==t&&(this._quaternionSpaceScenes.delete(t.id().value()),t.removeAllTraces())}},{key:"allQuaternionSpaceScenes",value:function(){var e,t=[],n=s(this._quaternionSpaceScenes);try{for(n.s();!(e=n.n()).done;){var r=vr(e.value,2)[1];t.push(r)}}catch(x2){n.e(x2)}finally{n.f()}return t}},{key:"setCurrQuaternionSpaceScene",value:function(e){void 0!==e?this.hasQuaternionSpaceScene(e)&&(this._currQuaternionSpaceScene=this._quaternionSpaceScenes.get(e)):this._currQuaternionSpaceScene=void 0}},{key:"getCurrQuaternionSpaceScene",value:function(){return this._currQuaternionSpaceScene}},{key:"getQuaternionSpaceSceneById",value:function(e){return this._quaternionSpaceScenes.get(e)}},{key:"setShouldSyncViews",value:function(e){this._syncViews=e,e&&this.updateCamViewpoint(this._currSyncView),lr.updateUI()}},{key:"shouldSyncViews",value:function(){return this._syncViews}},{key:"addSyncViewCallback",value:function(e){this._syncViewCallbacks.push(e)}},{key:"removeSyncViewCallback",value:function(e){var t=this._syncViewCallbacks.indexOf(e);return t>-1&&(this._syncViewCallbacks.splice(t,1),!0)}},{key:"currSyncViewpoint",value:function(){return this._currSyncView}},{key:"setCurrSyncViewpoint",value:function(e){var t=vr(e,2),n=t[0],r=t[1],i=vr(this._currSyncView,2),a=i[0],o=i[1];!0===n.equals(a)&&!0===r.equals(o)||(!0===this._syncViews&&this.updateCamViewpoint(e),this._currSyncView=e)}},{key:"updateCamViewpoint",value:function(e){var t,n=s(this._syncViewCallbacks);try{for(n.s();!(t=n.n()).done;){(0,t.value)(e)}}catch(x2){n.e(x2)}finally{n.f()}}},{key:"setTimeWarpBase",value:function(e){var t=this;if(this._currTimeWarpBase!==e){var n=function(){var e,n=s(t.allManagedRobotScenes());try{for(n.s();!(e=n.n()).done;){e.value.setTimeWarping(void 0)}}catch(x2){n.e(x2)}finally{n.f()}t._currTimeWarpBase=void 0},r=function(){n(),lr.updateUI(),lr.render()};if(void 0!==e){p()(this.hasManagedRobotScene(e),"You can not set the RobotSceneManager to use a scene that it does not own "+"as its timewarp base. Scene: ".concat(e));var i=this.startTime(),a=this.endTime(),o=30*Math.abs(a-i),u=YU.frameRange(i,a,30,o),l=new Map,c=new Set(zb(e.robots(),(function(e){return e.name()}))),h=e.frameData(u,(function(e){return c.has(e)}),(function(e,t){return 1===Bb(e.links(),t,(function(e){return e.name()}))}),(function(e,t){return 1===Bb(e.joints(),t,(function(e){return e.name()}))}),(function(e,t){return 1===Bb(e.articuatedJoints(),t,(function(e){return e.name()}))}));if(!0!==h.keys().next().done){var f,v=s(h.entries());try{for(v.s();!(f=v.n()).done;){var m,g=vr(f.value,2),y=g[0],b=g[1],_=new Map,x=new Map,w=s(b.positions);try{for(w.s();!(m=w.n()).done;){var S=vr(m.value,2),M=S[0],k=S[1];if(void 0===M)_.set(M,[M,k]);else if(M instanceof $R)_.set(M.name(),[M,k]);else{if(!(M instanceof eP))throw new d.AssertionError({message:"robotPart was not a boolean, RobotJoint, or RobotLink!"});_.set(M.name(),[M,k])}}}catch(x2){w.e(x2)}finally{w.f()}var T,E=s(b.jointAngles);try{for(E.s();!(T=E.n()).done;){var C=vr(T.value,2),A=C[0],R=C[1];x.set(A.name(),[A,R])}}catch(x2){E.e(x2)}finally{E.f()}l.set(y.name(),[y,{times:b.times,positions:_,jointAngles:x}])}}catch(x2){v.e(x2)}finally{v.f()}n();var P,L=s(this.allManagedRobotScenes());try{var D=function(){var t,n=P.value;if(n===e)return 0;var r=new Set(zb(n.robots(),(function(e){return e.name()})));if(t=n.frameData(u,(function(e){return e.includePosInTimeWarpConsideration()&&l.has(e.name())&&r.has(e)}),(function(e,t){return t.includePosInTimeWarpConsideration()&&l.has(e.name())&&r.has(e)&&1===Bb(e.links(),t,(function(e){return e.name()}))}),(function(e,t){return t.includePosInTimeWarpConsideration()&&l.has(e.name())&&r.has(e)&&1===Bb(e.joints(),t,(function(e){return e.name()}))}),(function(e,t){return t.includeAngleInTimeWarpConsideration()&&l.has(e.name())&&r.has(e)&&1===Bb(e.articuatedJoints(),t,(function(e){return e.name()}))})),!0===t.keys().next().done)return 0;var i,a=[],o=s(t);try{for(o.s();!(i=o.n()).done;){var c=vr(i.value,2),h=c[0],f=c[1],d=l.get(h.name());if(void 0!==d){var p,v=s(f.positions);try{for(v.s();!(p=v.n()).done;){var m=vr(p.value,2),g=m[0],y=m[1],b=d[1].positions.get(void 0===g?void 0:g.name());if(void 0!==b){var _=b[1];a.push([_,y])}}}catch(x2){v.e(x2)}finally{v.f()}var x,w=s(f.jointAngles);try{for(w.s();!(x=w.n()).done;){var S=vr(x.value,2),M=S[0],k=S[1],T=d[1].jointAngles.get(M.name());if(void 0!==T){var E=T[1];a.push([E,k])}}}catch(x2){w.e(x2)}finally{w.f()}}}}catch(x2){o.e(x2)}finally{o.f()}var C=new XP(u,u,(function(e,t,n,r){for(var i=0,o=0,s=a;o<s.length;o++){var u=vr(s[o],2),l=u[0],c=u[1],h=l[n],f=c[r];i+="number"===typeof h&&"number"===typeof f?Math.abs(h-f):h.distanceTo(f)}return i}));n.setTimeWarping(C)};for(L.s();!(P=L.n()).done;)D()}catch(x2){L.e(x2)}finally{L.f()}this._currTimeWarpBase=e,lr.updateUI(),lr.render()}else r()}else r()}}},{key:"addControlledRobotScene",value:function(e){this._controlledScenes.push(e),e.animationManager().setTime(this.currTime()),lr.updateUI()}},{key:"removeControlledRobotScene",value:function(e){var t=this._controlledScenes.indexOf(e);t>-1&&this._controlledScenes.splice(t,1)}},{key:"setAllowRobotSelection",value:function(e){this._allowSelections=e}},{key:"allowRobotSelection",value:function(){return this._allowSelections}},{key:"startAnimations",value:function(){this._animationLoop.start()}},{key:"pauseAnimations",value:function(){this._animationLoop.stop()}},{key:"restartAnimations",value:function(){this._animationLoop.restart()}},{key:"currTimeRange",value:function(){return[this.currStartTime(),this.currTime(),this.currEndTime()]}},{key:"absoluteTimeRange",value:function(){return[this.startTime(),this.currTime(),this.endTime()]}},{key:"timeRange",value:function(){return[this.startTime(),this.currStartTime(),this.currTime(),this.currEndTime(),this.endTime()]}},{key:"startTime",value:function(){var e=1/0,t=function(t){var n,r=s(t);try{for(r.s();!(n=r.n()).done;){var i=n.value.animationManager();e=Math.min(i.startTime(),e)}}catch(x2){r.e(x2)}finally{r.f()}};return t(this._activeScenes),t(this._controlledScenes),e===1/0?0:e}},{key:"currStartTime",value:function(){return this._animationLoop.startTime()}},{key:"setCurrStartTime",value:function(e){e=Lb(e,this.startTime(),this.endTime()),this._animationLoop.setStartTime(e),this.updateAllTraces()}},{key:"setCurrTime",value:function(e){e=Lb(e,this.startTime(),this.endTime()),this._animationLoop.setTime(e)}},{key:"currTime",value:function(){return this._animationLoop.time()}},{key:"currEndTime",value:function(){return this._animationLoop.endTime()}},{key:"setCurrEndTime",value:function(e){e=Lb(e,this.startTime(),this.endTime()),this._animationLoop.setEndTime(e),this.updateAllTraces()}},{key:"endTime",value:function(){var e=-1/0,t=function(t){var n,r=s(t);try{for(r.s();!(n=r.n()).done;){var i=n.value.animationManager();e=Math.max(i.endTime(),e)}}catch(x2){r.e(x2)}finally{r.f()}};return t(this._activeScenes),t(this._controlledScenes),e===-1/0?1:e}},{key:"updateAllTraces",value:function(){var e,t=s(this.allManagedRobotScenes());try{for(t.s();!(e=t.n()).done;){e.value.updateTraces()}}catch(x2){t.e(x2)}finally{t.f()}var n,r=s(this.allQuaternionSpaceScenes());try{for(r.s();!(n=r.n()).done;){n.value.updateTraces()}}catch(x2){r.e(x2)}finally{r.f()}}},{key:"updateAllTraceSymbols",value:function(){var e,t=s(this.allQuaternionSpaceScenes());try{for(t.s();!(e=t.n()).done;){e.value.updateTraceSymbols()}}catch(x2){t.e(x2)}finally{t.f()}}},{key:"robotSceneById",value:function(e){var t,n=s(this._availableScenes);try{for(n.s();!(t=n.n()).done;){var r=vr(t.value,2)[1];if(r.id().value()===e)return r}}catch(x2){n.e(x2)}finally{n.f()}}},{key:"currRobotScene",value:function(e){if(!0===e||void 0===e)return this._currScene;if(this._currScene)return this._currScene;var t=this.addDefaultManagedRobotScene();return this.setCurrRobotScene(t),t}},{key:"setCurrRobotScene",value:function(e){this._currScene=e,lr.updateUI()}},{key:"masterRobots",value:function(){return this._masterRobots}},{key:"addMasterRobot",value:function(e){-1===this._masterRobots.indexOf(e)&&(this._masterRobots.push(e),lr.updateUI())}},{key:"removeMasterRobot",value:function(e){var t=this._masterRobots.indexOf(e);t>-1&&(this._masterRobots.splice(t,1),lr.updateUI())}},{key:"sortScenes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e||!this._isSorted){this._availableScenes.sort((function(e,t){return e[0].join("").localeCompare(t[0].join(""))}));var t,n=hF.colors(this._availableScenes.length),r=s(Ib(this._availableScenes));try{for(r.s();!(t=r.n()).done;){var i=vr(t.value,2),a=i[0],o=vr(i[1],2),u=o[1];u.setColor(n[a])}}catch(x2){r.e(x2)}finally{r.f()}this._isSorted=!0}}},{key:"animationTables",value:function(){return this._animationTables}},{key:"addAnimationTable",value:function(e){-1===this._animationTables.indexOf(e)&&(this._animationTables.push(e),lr.updateUI())}},{key:"removeAnimationTable",value:function(e){var t=this._animationTables.indexOf(e);t>-1&&(this._animationTables.splice(t,1),lr.updateUI())}},{key:"removeRobotScene",value:function(e){for(var t=-1,n=0;n<this._availableScenes.length;){if(vr(this._availableScenes[n],2)[1]===e){t=n;break}n+=1}if(!(t<=-1)){var r=vr(this._availableScenes.splice(t,1)[0],2)[1];if(r&&this.isActiveRobotScene(r)){for(var i=!0;i;)i=void 0!==this.deactivateRobotScene(r);return r.setParentRobotSceneManager(void 0),r}this._availableScenes.length>0&&(t-1>=0?this.setCurrRobotScene(this._availableScenes[t-1][1]):this.setCurrRobotScene(this._availableScenes[t][1])),e===this._currTimeWarpBase&&this.setTimeWarpBase(void 0),lr.updateUI()}}},{key:"addManagedRobotScenes",value:function(e){var t,n=s(e);try{for(n.s();!(t=n.n()).done;){var r,i=t.value;this._availableScenes.push([i.path,i.robotScene,null!==(r=i.metrics)&&void 0!==r?r:new Map]),this._isSorted=!1,i.robotScene.animationManager().setTime(this.currTime()),lr.updateUI()}}catch(x2){n.e(x2)}finally{n.f()}lr.recalculateTimeWarping()}},{key:"getManagedRobotSceneData",value:function(e){var t=this._availableScenes.filter((function(t){return vr(t,2)[1]===e}))[0];if(t){var n=vr(t,3);return{path:n[0],robotScene:n[1],metrics:n[2]}}}},{key:"addDefaultManagedRobotScene",value:function(){var e=new YU(this);return this.addManagedRobotScenes([{path:[],robotScene:e}]),e}},{key:"allManagedRobotScenes",value:function(){return this._availableScenes.map((function(e){return vr(e,2)[1]}))}},{key:"hasManagedRobotScene",value:function(e){var t,n=-1,r=s(Ib(this._availableScenes));try{for(r.s();!(t=r.n()).done;){var i=vr(t.value,2),a=i[0];if(vr(i[1],2)[1]===e){n=a;break}}}catch(x2){r.e(x2)}finally{r.f()}return n>-1}},{key:"isActiveRobotScene",value:function(e){return this._activeScenes.indexOf(e)>-1}},{key:"activeRobotScenes",value:function(){return this._activeScenes}},{key:"activateRobotScene",value:function(e){if(Array.isArray(e)){var t,n=s(this._availableScenes);try{for(n.s();!(t=n.n()).done;){var r=vr(t.value,2),i=r[0],a=r[1];if(cF(i,e))return this._activeScenes.push(a),this.setCurrEndTime(this.endTime()),void lr.updateUI()}}catch(x2){n.e(x2)}finally{n.f()}throw Error("RobotScene under path ".concat(e," could not be found and switched to by the RobotSceneManager."))}var o,u=s(this._availableScenes);try{for(u.s();!(o=u.n()).done;){var l=vr(o.value,2)[1];if(l===e)return this._activeScenes.push(l),this.setCurrEndTime(this.endTime()),void lr.updateUI()}}catch(x2){u.e(x2)}finally{u.f()}throw Error("RobotScene could not be found and switched to by the RobotSceneManager.")}},{key:"deactivateRobotScene",value:function(e){if(Array.isArray(e)){var t,n=s(Ib(this._availableScenes));try{for(n.s();!(t=n.n()).done;){var r=vr(t.value,2),i=r[0];if(cF(vr(r[1],2)[0],e)){var a=this._availableScenes.splice(i,1)[0][1];return lr.updateUI(),a}}}catch(x2){n.e(x2)}finally{n.f()}}else{var o=this._activeScenes.indexOf(e);if(o>-1){var u=this._activeScenes.splice(o,1)[0];return lr.updateUI(),u}}}},{key:"loadSessionFromURL",value:function(){var e=pr(fr().mark((function e(t,n){var r;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return lr.setPopupHelpPage({page:Xn.LoadingStarted,location:t}),e.prev=1,e.next=4,fetch(t,{method:"GET"});case 4:return r=e.sent,e.t0=this,e.next=8,r.json();case 8:return e.t1=e.sent,e.t2=n,e.next=12,e.t0.loadSession.call(e.t0,e.t1,e.t2);case 12:lr.setPopupHelpPage({page:Xn.LoadingSuccess,location:t}),e.next=19;break;case 15:throw e.prev=15,e.t3=e.catch(1),lr.setPopupHelpPage({page:Xn.LoadingFailed,location:t}),e.t3;case 19:case"end":return e.stop()}}),e,this,[[1,15]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"content",value:fr().mark((function e(){var t,n,r;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.sortScenes(),t=s(this._availableScenes),e.prev=2,t.s();case 4:if((n=t.n()).done){e.next=10;break}return r=n.value,e.next=8,cr(r);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])}))},{key:"saveSession",value:function(){var e,t=new Map,n=new Map,r=[],i=new Map,a=new Map,o=[],u=[],l=new Map,c=s(this.content());try{for(c.s();!(e=c.n()).done;){var h,f=vr(e.value,3),d=f[0],p=f[1],v=f[2],m=p.robots(),g=[],y=[],b=[],_=s(m);try{for(_.s();!(h=_.n()).done;){var x=h.value,w=x.idValue(),S=x.url(),M=x.name();if("World Frame"!==M){var k=[];if(l.set(w,k),void 0!==S){var T=t.get(S);if(void 0===T&&(T=n.get(w)),void 0===T){void 0!==S&&t.set(S,x),n.set(w,x);var E=void 0;E="urdf"===x.objectType()?"urdf":"AxesHelper"!==x.url()?"gltf":"AxesHelper",r.push({type:E,id:w,url:S,name:M})}else{w=T.idValue();var C=T.url();void 0!==C&&(S=C)}var A,R=[],P=s(x.getArticuatedJointMap().entries());try{for(P.s();!(A=P.n()).done;){var L=vr(A.value,2),D=L[0],N=L[1];R.push({name:D,angle:N.angle()})}}catch(x2){P.e(x2)}finally{P.f()}g.push({objectID:w,robotID:x.id().value(),isviewpoint:!1,animationID:k,name:x.name(),position:zR(x.getPosition()),rotation:VR(x.getQuaternion()),scale:zR(x.getScale()),joints:R,positionOffset:zR(x.getPositionOffset()),rotationOffset:VR(x.getQuaternionOffset()),scaleOffset:zR(x.getScaleOffset())})}else lr.error('Cannot save robot with name "'.concat(x.name(),'" because it does not come from a URL'))}}}catch(x2){_.e(x2)}finally{_.f()}var I,O=s(p.animationManager().animationGroups());try{for(O.s();!(I=O.n()).done;){var U,F=s(I.value.animations());try{for(F.s();!(U=F.n()).done;){var z=U.value,B=z.animationTable(),V=B.idValue(),G=B.url(),j=a.get(V);if(void 0===j&&void 0!==G&&(j=i.get(G)),void 0===j){a.set(B.idValue(),B);var H=B.url();void 0!==H&&(i.set(H,B),G=H),o.push({name:B.name(),id:V,timeUnit:"second",url:G,content:B.toCSV()})}else V=j.idValue();var W=l.get(z.objectAnimating().idValue());void 0!==W?W.push(V):lr.error("Could not save an AnimationTable because the object it animates could not be saved previously.")}}catch(x2){F.e(x2)}finally{F.f()}}}catch(x2){O.e(x2)}finally{O.f()}var Z,q=s(p.getAllTraces());try{for(q.s();!(Z=q.n()).done;){var X,Y,K=Z.value,J=null===(X=K.robotPart())||void 0===X?void 0:X.name(),Q=null===(Y=K.robot().parentScene())||void 0===Y?void 0:Y.id().value(),$=p.id().value();void 0!==Q&&void 0!==$&&(void 0===J&&(J=""),null===y||void 0===y||y.push({robotId:K.robot().idValue(),robotPartName:J,parentSceneId:Q,currSceneId:$,originalId:K.id()}))}}catch(x2){q.e(x2)}finally{q.f()}var ee,te=s(p.getAllArrows());try{for(te.s();!(ee=te.n()).done;){var ne=ee.value;null===b||void 0===b||b.push({traceFromId:ne.traceFrom().id(),traceToId:ne.traceTo().id(),parentSceneId:p.id().value()})}}catch(x2){te.e(x2)}finally{te.f()}var re,ie={},ae=s(v.entries());try{for(ae.s();!(re=ae.n()).done;){var oe=vr(re.value,2),se=oe[0],ue=oe[1];ie[se]=ue}}catch(x2){ae.e(x2)}finally{ae.f()}u.push({name:p.name(),originalId:p.id().value(),path:d,metrics:ie,threeObjects:g,traces:y,backgroundColor:p.backgroundColor(),directionalLightIntensity:p.directionalLightIntensity(),ambientLightIntensity:p.ambientLightIntensity(),showGroundPlane:p.isGroundPlaneVisible(),cameraType:p.cameraType(),worldFrame:p.worldFrame(),showWorldFrameObject:p.isWorldFrameObjectVisible(),axisDensity:p.density(),axisSize:p.axisSize(),traceSize:p.traceSize(),isTimeWarped:p.isTimeWarping(),timeWarpBaseSceneId:p.baseSceneId(),keyObjects:p.keyObjects(),arrows:b})}}catch(x2){c.e(x2)}finally{c.f()}var le,ce=[],he=s(this.allQuaternionSpaceScenes());try{for(he.s();!(le=he.n()).done;){var fe,de=le.value,pe=[],ve=s(de.getAllTraces());try{for(ve.s();!(fe=ve.n()).done;){var me,ge,ye=fe.value,be=null===(me=ye.robotPart())||void 0===me?void 0:me.name(),_e=null===(ge=ye.robot().parentScene())||void 0===ge?void 0:ge.id().value();void 0!==_e&&(void 0===be&&(be=""),null===pe||void 0===pe||pe.push({robotId:ye.robot().idValue(),robotPartName:be,parentSceneId:_e}))}}catch(x2){ve.e(x2)}finally{ve.f()}ce.push({name:de.name(),originalId:de.id().value(),backgroundColor:de.backgroundColor(),lineGroupOpacity:de.lineGroupOpacity(),lineGroupColor:de.lineGroupColor(),traces:pe,showWorldFrameObject:de.isWorldFrameObjectVisible()})}}catch(x2){he.e(x2)}finally{he.f()}var xe,we=[],Se=s(this.getAllGraphs());try{for(Se.s();!(xe=Se.n()).done;){var Me,ke=xe.value,Te=[],Ee=s(ke.lineIds());try{for(Ee.s();!(Me=Ee.n()).done;){var Ce=Me.value;Te.push(Ce)}}catch(x2){Ee.e(x2)}finally{Ee.f()}we.push({name:ke.name(),originalId:ke.id(),isDiff:ke.isDiff(),isTimeWarp:ke.isTimeWarp(),line_ids:Te,currProperty:ke.currProperty(),lineWidth:ke.lineWidth(),axisColor:ke.axisColor(),backgroundColor:ke.backgroundColor(),filter:ke.filter()})}}catch(x2){Se.e(x2)}finally{Se.f()}var Ae,Re=[],Pe=s(this.getAllUmapGraphs());try{for(Pe.s();!(Ae=Pe.n()).done;){var Le,De=Ae.value,Ne=[],Ie=s(De.lineIds());try{for(Ie.s();!(Le=Ie.n()).done;){var Oe=Le.value;Ne.push(Oe)}}catch(x2){Ie.e(x2)}finally{Ie.f()}Re.push({name:De.name(),originalId:De.id(),line_ids:Ne,lineWidth:De.lineWidth(),axisColor:De.axisColor(),backgroundColor:De.backgroundColor()})}}catch(x2){Pe.e(x2)}finally{Pe.f()}return{saveFormatVersion:"1.0",times:{currentTime:this.currTime(),currentEndTime:this.currEndTime(),currentStartTime:this.currStartTime()},quaternionScenes:ce,objects:r,animations:o,scenes:u,graphs:we,umapGraphs:Re}}},{key:"loadSessionFromLocalFile",value:function(){var e=pr(fr().mark((function e(t,n){var r;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return lr.setPopupHelpPage({page:Xn.LoadingStarted,location:t.name}),e.prev=1,e.next=4,TR(t);case 4:r=e.sent,this.loadSession(r,n),lr.setPopupHelpPage({page:Xn.LoadingSuccess,location:t.name}),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(1),lr.setPopupHelpPage({page:Xn.LoadingFailed,location:t.name}),e.t0;case 13:case"end":return e.stop()}}),e,this,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadSession",value:function(){var e=pr(fr().mark((function e(t,n){var r,i,a,o,s;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(r=t.saveFormatVersion)&&"1.0"!==r){e.next=6;break}return e.next=4,this.loadV1Session(t,n);case 4:e.next=8;break;case 6:return lr.error('Could not load in workspace with unknown version number "'.concat(r,'"')),e.abrupt("return");case 8:i=0;case 9:if(!(i<this._availableScenes.length)){e.next=17;break}if(a=vr(this._availableScenes[i],2),o=a[0],s=a[1],0!==o.length||0!==s.robots().length){e.next=14;break}return this.removeRobotScene(this._availableScenes[i][1]),e.abrupt("continue",9);case 14:i+=1,e.next=9;break;case 17:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadV1Session",value:function(){var e=pr(fr().mark((function e(t,n){var r,i,a,o,u,l,c,h,f,p,v,m,g,y,b,_,x,w,S,M,k,T,E,C,A,R,P,L,D,N,I,O,U,F,z,B,V,G,j,H,W,Z,q,X,Y,K,J,Q,$,ee,te,ne,re,ie,ae,oe,se,ue,le,ce,he,fe,de,pe,ve,me,ge,ye,be,_e,xe,we,Se,Me,ke,Te,Ee,Ce,Ae,Re,Pe,Le,De,Ne,Ie,Oe,Ue,Fe,ze,Be,Ve,Ge,je,He,We,Ze,qe,Xe,Ye,Ke,Je,Qe,$e,et,tt,nt,rt,it,at,ot,st,ut,lt,ct,ht,ft,dt,pt,vt,mt,gt,yt,bt,_t,xt,wt,St,Mt,kt,Tt,Et,Ct,At,Rt,Pt,Lt,Dt,Nt,It;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:v=function(){return v=pr(fr().mark((function e(t){var n,r,i,a,o,u;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],r=s(t),e.prev=2,r.s();case 4:if((i=r.n()).done){e.next=15;break}return a=vr(i.value,2),o=a[0],u=a[1],e.t0=n,e.t1=o,e.next=10,u;case 10:e.t2=e.sent,e.t3=[e.t1,e.t2],e.t0.push.call(e.t0,e.t3);case 13:e.next=4;break;case 15:e.next=20;break;case 17:e.prev=17,e.t4=e.catch(2),r.e(e.t4);case 20:return e.prev=20,r.f(),e.finish(20);case 23:return e.abrupt("return",n);case 24:case"end":return e.stop()}}),e,null,[[2,17,20,23]])}))),v.apply(this,arguments)},p=function(e){return v.apply(this,arguments)},r=[],i=s(t.objects);try{for(i.s();!(a=i.n()).done;)"URDF"===(o=a.value).type.toUpperCase()?r.push([o.id,rP.loadRobot(o.url,"urdf",o.name)]):"GLTF"===o.type.toUpperCase()?r.push([o.id,rP.loadRobot(o.url,"glb",o.name)]):r.push([o.id,rP.loadRobot(o.url,"axesHelper",o.name)])}catch(x2){i.e(x2)}finally{i.f()}u=[],l=[],c=s(t.animations),e.prev=8,f=fr().mark((function e(){var t,n,r,i,a,o,s,u,c,f;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=h.value,r=n.content,i=n.id,a=n.url,o=null!==(t=n.name)&&void 0!==t?t:"Unnamed Animation",u=n.timeUnit,!r){e.next=11;break}c=r,s=new Promise((function(e,t){var n=FR.fromCSV(c,u);n instanceof d.AssertionError?t(n):(n.id().set(i),n.setName(o),e(n))})),e.next=17;break;case 11:if(!a){e.next=16;break}f=a,s=pr(fr().mark((function e(){var t,n;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mR(f);case 2:if(0!==(t=e.sent).length){e.next=10;break}if((n=FR.fromCSV(t[0],u))instanceof d.AssertionError){e.next=9;break}return n.id().set(i),n.setName(o),e.abrupt("return",n);case 9:throw new Error("CSV from url ".concat(f," was il-formatted and could not be used."));case 10:throw Error("Expected exactly 1 CSV from url ".concat(f,", got ").concat(t.length,"."));case 11:case"end":return e.stop()}}),e)})))(),e.next=17;break;case 16:throw Error("Expected url and/or some content for an animation, but got neither.");case 17:l.push([i,s]);case 18:case"end":return e.stop()}}),e)})),c.s();case 11:if((h=c.n()).done){e.next=15;break}return e.delegateYield(f(),"t0",13);case 13:e.next=11;break;case 15:e.next=20;break;case 17:e.prev=17,e.t1=e.catch(8),c.e(e.t1);case 20:return e.prev=20,c.f(),e.finish(20);case 23:return m=new Map,g=new Map,e.t2=s,e.next=28,p(r);case 28:e.t3=e.sent,y=(0,e.t2)(e.t3);try{for(y.s();!(b=y.n()).done;)_=vr(b.value,2),x=_[0],w=_[1],m.set(x,w),w.id().regen()}catch(x2){y.e(x2)}finally{y.f()}return e.t4=s,e.next=34,p(l);case 34:e.t5=e.sent,S=(0,e.t4)(e.t5);try{for(S.s();!(M=S.n()).done;)k=vr(M.value,2),T=k[0],E=k[1],g.set(T,E),E.id().regen(),u.push(E)}catch(x2){S.e(x2)}finally{S.f()}C=[],A=new Map,R=new Map,P=s(t.scenes),e.prev=41,P.s();case 43:if((L=P.n()).done){e.next=102;break}for(D=L.value,N=new YU(this),I=new Map,void 0!==D.originalId&&(A.set(D.originalId,N.id().value()),R.set(N.id().value(),I)),void 0!==D.name&&N.setName(D.name),void 0!==D.backgroundColor&&N.setBackgroundColor(D.backgroundColor),void 0!==D.directionalLightIntensity&&N.setDirectionalLightIntensity(D.directionalLightIntensity),void 0!==D.ambientLightIntensity&&N.setAmbientLightIntensity(D.ambientLightIntensity),void 0!==D.showGroundPlane&&N.setGroundPlaneVisibility(D.showGroundPlane),void 0!==D.cameraType&&N.setCameraType(D.cameraType),void 0!==D.worldFrame&&N.setWorldFrame(D.worldFrame),void 0!==D.showWorldFrameObject&&N.setWorldFrameObjectVisibility(D.showWorldFrameObject),void 0!==D.axisDensity&&N.setDensity(D.axisDensity),void 0!==D.axisSize&&N.setAxisSize(D.axisSize),void 0!==D.traceSize&&N.setTraceSize(D.traceSize),O=new Hb("Animation Group"),U=D.path,F=new Map,z=0,B=Object.entries(D.metrics);z<B.length;z++)V=vr(B[z],2),G=V[0],j=V[1],F.set(G,j);H=s(D.threeObjects),e.prev=64,H.s();case 66:if((W=H.n()).done){e.next=90;break}if(Z=W.value,q=Z.objectID,void 0!==(X=m.get(q))){e.next=72;break}throw new Error('Unable to load in sessions: There was no object with ID "'.concat(q,'"'));case 72:if((Y=X.clone()).setName(Z.name),Y.id().regen(),void 0!==Z.robotID&&I.set(Z.robotID,Y.idValue()),Y.setScale(BR(Y.getScaleOffset().clone(),Z.scale)),Y.setPosition(BR(Y.getPositionOffset().clone(),Z.position)),void 0!==(K=Z.rotation)&&(void 0!==K.w?Y.setQuaternion(GR(Y.getQuaternionOffset().clone(),Z.rotation)):Y.setQuaternion(BR(Y.getQuaternionOffset().clone(),Z.rotation))),Y.setScaleOffset(BR(Y.getScaleOffset().clone(),Z.scaleOffset)),Y.setPositionOffset(BR(Y.getPositionOffset().clone(),Z.positionOffset)),void 0!==(K=Z.rotationOffset)&&(void 0!==K.w?Y.setQuaternionOffset(GR(Y.getQuaternionOffset().clone(),Z.rotationOffset)):Y.setQuaternionOffset(BR(Y.getQuaternionOffset().clone(),Z.rotationOffset))),Z.joints){J=s(Z.joints);try{for(J.s();!(Q=J.n()).done;)$=Q.value,Y.setJointAngle($.name,$.angle)}catch(x2){J.e(x2)}finally{J.f()}}N.addChildRobot(Y),ee=s(Z.animationID);try{for(ee.s();!(te=ee.n()).done;)ne=te.value,(re=g.get(ne))&&O.addAnimation(new jb(Y,re))}catch(x2){ee.e(x2)}finally{ee.f()}case 88:e.next=66;break;case 90:e.next=95;break;case 92:e.prev=92,e.t6=e.catch(64),H.e(e.t6);case 95:return e.prev=95,H.f(),e.finish(95);case 98:N.animationManager().addActiveAnimation(O),C.push({path:U,robotScene:N,metrics:F});case 100:e.next=43;break;case 102:e.next=107;break;case 104:e.prev=104,e.t7=e.catch(41),P.e(e.t7);case 107:return e.prev=107,P.f(),e.finish(107);case 110:for(ie=C.at(C.length-1),ae=void 0,void 0!==ie&&(ae=ie.robotScene),this.addManagedRobotScenes(C),oe=0,se=u;oe<se.length;oe++)ue=se[oe],this.addAnimationTable(ue);le=s(m.values());try{for(le.s();!(ce=le.n()).done;)he=ce.value,this._masterRobots.push(he)}catch(x2){le.e(x2)}finally{le.f()}ae&&this.setCurrRobotScene(ae),fe=s(this.allManagedRobotScenes());try{for(fe.s();!(de=fe.n()).done;)pe=de.value,this.isActiveRobotScene(pe)||this.activateRobotScene(pe)}catch(x2){fe.e(x2)}finally{fe.f()}void 0!==t.times&&(this.setCurrStartTime(t.times.currentStartTime),this.setCurrEndTime(t.times.currentEndTime),this.setCurrTime(t.times.currentTime)),ve=s(t.scenes),e.prev=122,ve.s();case 124:if((me=ve.n()).done){e.next=140;break}if(void 0===(ge=me.value).isTimeWarped||void 0===ge.timeWarpBaseSceneId||void 0===ge.keyObjects||!0!==ge.isTimeWarped||void 0===ge.originalId){e.next=138;break}if(ye=this.findNewSceneId(ge.timeWarpBaseSceneId,A),be=this.findNewSceneId(ge.originalId,A),void 0!==ye&&void 0!==be){e.next=131;break}return e.abrupt("continue",138);case 131:if(_e=this.robotSceneById(ye),xe=this.robotSceneById(be),void 0!==_e&&void 0!==xe){e.next=135;break}return e.abrupt("continue",138);case 135:we=s(ge.keyObjects);try{for(we.s();!(Se=we.n()).done;)Me=Se.value,ke=Me.split("\n"),Te=vr(ke,2),Ee=Te[0],Ce=Te[1],Ae=Ce.split(" "),Re=vr(Ae,2),Pe=Re[0],Le=Re[1],0===Pe.length?null===(De=xe.getRobotByName(Ee))||void 0===De||De.setPositionIncludeInTimeWarpConsideration(!0):void 0===(Ne=xe.getJointByName(Ee,Pe))?(Ne=xe.getLinkByName(Ee,Pe),null===(Ie=Ne)||void 0===Ie||Ie.setPosIncludeInTimeWarpConsideration(!0)):"angle"==Le?Ne.setAngleIncludeInTimeWarpConsideration(!0):Ne.setPosIncludeInTimeWarpConsideration(!0),xe.setTimeWarpBase(void 0),xe.setTimeWarpBase(_e)}catch(x2){we.e(x2)}finally{we.f()}xe.setKeyObjects(ge.keyObjects);case 138:e.next=124;break;case 140:e.next=145;break;case 142:e.prev=142,e.t8=e.catch(122),ve.e(e.t8);case 145:return e.prev=145,ve.f(),e.finish(145);case 148:Oe=new Map,Ue=s(t.scenes),e.prev=150,Ue.s();case 152:if((Fe=Ue.n()).done){e.next=184;break}if(void 0!==(ze=Fe.value).traces){e.next=156;break}return e.abrupt("continue",182);case 156:Be=s(ze.traces),e.prev=157,Be.s();case 159:if((Ve=Be.n()).done){e.next=174;break}if(Ge=Ve.value,je=Ge.robotPartName,void 0!==(He=this.findNewSceneId(Ge.parentSceneId,A))){e.next=165;break}return e.abrupt("continue",172);case 165:if(void 0!==(We=this.findNewSceneId(Ge.currSceneId,A))){e.next=168;break}return e.abrupt("continue",172);case 168:if(void 0!==(Ze=this.findNewRobotId(Ge.robotId,R,He))){e.next=171;break}return e.abrupt("continue",172);case 171:this.addTracesToRobotScene(We,He,Ze,je,Oe,Ge.originalId);case 172:e.next=159;break;case 174:e.next=179;break;case 176:e.prev=176,e.t9=e.catch(157),Be.e(e.t9);case 179:return e.prev=179,Be.f(),e.finish(179);case 182:e.next=152;break;case 184:e.next=189;break;case 186:e.prev=186,e.t10=e.catch(150),Ue.e(e.t10);case 189:return e.prev=189,Ue.f(),e.finish(189);case 192:qe=s(t.scenes),e.prev=193,qe.s();case 195:if((Xe=qe.n()).done){e.next=226;break}if(void 0!==(Ye=Xe.value).arrows){e.next=199;break}return e.abrupt("continue",224);case 199:Ke=s(Ye.arrows),e.prev=200,Ke.s();case 202:if((Je=Ke.n()).done){e.next=216;break}if(Qe=Je.value,console.log(Qe),void 0!==($e=this.findNewSceneId(Qe.parentSceneId,A))){e.next=208;break}return e.abrupt("continue",214);case 208:if(void 0!==(et=this.robotSceneById($e))){e.next=211;break}return e.abrupt("continue",214);case 211:tt=this.findNewTraceId(Qe.traceFromId,Oe),nt=this.findNewTraceId(Qe.traceToId,Oe),void 0!==tt&&void 0!==nt&&et.addArrow(tt,nt);case 214:e.next=202;break;case 216:e.next=221;break;case 218:e.prev=218,e.t11=e.catch(200),Ke.e(e.t11);case 221:return e.prev=221,Ke.f(),e.finish(221);case 224:e.next=195;break;case 226:e.next=231;break;case 228:e.prev=228,e.t12=e.catch(193),qe.e(e.t12);case 231:return e.prev=231,qe.f(),e.finish(231);case 234:if(rt=new Map,void 0===t.quaternionScenes){e.next=281;break}it=s(t.quaternionScenes),e.prev=237,it.s();case 239:if((at=it.n()).done){e.next=273;break}ot=at.value,(st=new aF(this)).setName(ot.name),st.setBackgroundColor(ot.backgroundColor),st.setLineGroupOpacity(ot.lineGroupOpacity),st.setLineGroupColor(ot.lineGroupColor),st.setWorldFrameObjectVisibility(ot.showWorldFrameObject),rt.set(ot.originalId,st.id().value()),ut=s(ot.traces),e.prev=249,ut.s();case 251:if((lt=ut.n()).done){e.next=263;break}if(ct=lt.value,ht=ct.robotPartName,void 0!==(ft=this.findNewSceneId(ct.parentSceneId,A))){e.next=257;break}return e.abrupt("continue",261);case 257:if(void 0!==(dt=this.findNewRobotId(ct.robotId,R,ft))){e.next=260;break}return e.abrupt("continue",261);case 260:this.addTracesToQuaternionScene(st,ft,dt,ht);case 261:e.next=251;break;case 263:e.next=268;break;case 265:e.prev=265,e.t13=e.catch(249),ut.e(e.t13);case 268:return e.prev=268,ut.f(),e.finish(268);case 271:e.next=239;break;case 273:e.next=278;break;case 275:e.prev=275,e.t14=e.catch(237),it.e(e.t14);case 278:return e.prev=278,it.f(),e.finish(278);case 281:if(pt=new Map,void 0!==t.graphs){vt=s(t.graphs);try{for(vt.s();!(mt=vt.n()).done;){for(gt=mt.value,yt=new sF((new Yb).value(),gt.isDiff,gt.isTimeWarp),this.addGraph(yt),yt.setName(gt.name),pt.set(gt.originalId,yt.id()),bt=0;bt<gt.line_ids.length;bt++)_t=this.decomposeLineId(gt.line_ids[bt]),xt=vr(_t,2),wt=xt[0],St=xt[1],Mt=this.findNewSceneId(wt,A),gt.line_ids[bt]=Mt+"#"+St;yt.setCurrProperty(gt.currProperty),yt.setLineIds(gt.line_ids),yt.setAxisColor(gt.axisColor),yt.setBackgroundColor(gt.backgroundColor),yt.setLineWidth(gt.lineWidth),void 0!==gt.filter&&yt.setFilter(gt.filter)}}catch(x2){vt.e(x2)}finally{vt.f()}}if(kt=new Map,void 0!==t.umapGraphs){Tt=s(t.umapGraphs);try{for(Tt.s();!(Et=Tt.n()).done;){for(Ct=Et.value,At=new lF((new Yb).value()),this.addUmapGraph(At),At.setName(Ct.name),kt.set(Ct.originalId,At.id()),Rt=0;Rt<Ct.line_ids.length;Rt++)Pt=this.decomposeLineId(Ct.line_ids[Rt]),Lt=vr(Pt,2),Dt=Lt[0],Nt=Lt[1],It=this.findNewSceneId(Dt,A),Ct.line_ids[Rt]=It+"#"+Nt;At.setLineIds(Ct.line_ids),At.setAxisColor(Ct.axisColor),At.setBackgroundColor(Ct.backgroundColor),At.setLineWidth(Ct.lineWidth)}}catch(x2){Tt.e(x2)}finally{Tt.f()}}this.restoreWindows(t.layout,A,rt,pt,kt),void 0!==n&&n(t.layout);case 287:case"end":return e.stop()}}),e,this,[[8,17,20,23],[41,104,107,110],[64,92,95,98],[122,142,145,148],[150,186,189,192],[157,176,179,182],[193,228,231,234],[200,218,221,224],[237,275,278,281],[249,265,268,271]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"decomposeLineId",value:function(e){var t=vr(e.split("#"),2);return[t[0],t[1]]}},{key:"findNewSceneId",value:function(e,t){return t.get(e)}},{key:"findNewRobotId",value:function(e,t,n){var r;return null===(r=t.get(n))||void 0===r?void 0:r.get(e)}},{key:"findNewTraceId",value:function(e,t){return t.get(e)}},{key:"restoreWindows",value:function(e,t,n,r,i){var a,o,s;if(void 0!==e){var u=function(e){var t,n=e.indexOf("&"),r=e.slice(0,n),i=e.slice(n+1,e.length),a=void 0;if(-1!==(n=i.indexOf("&"))?(a=i.slice(0,n),t=i.slice(n+1,i.length)):t=i,void 0===a)throw new Error("RobotScene with undefined ID in DockLayout");return[r,a,t]},l=function e(a){for(var o=0;o<a.length;o++){var s=a[o],l=s.activeId,c=new Map;if(void 0!==l)if(l.startsWith("RobotScene")){var h=vr(u(l),3),f=(h[1],h[2]),d=t.get(f);void 0!==d&&(s.activeId="RobotScene&".concat(Cb(4),"&").concat(d),c.set(l,s.activeId))}else if(l.startsWith("QuaternionSpaceScene")){var p=vr(l.split("&"),3),v=p[1],m=(p[2],n.get(v));void 0!==m&&(s.activeId="QuaternionSpaceScene&".concat(m,"&").concat(Cb(4)),c.set(l,s.activeId))}else if(l.startsWith("Graph")||l.startsWith("DifferenceGraph")){var g=vr(l.split("&"),3),y=g[0],b=g[1],_=(g[2],r.get(b));void 0!==_&&(s.activeId="".concat(y,"&").concat(_,"&").concat(Cb(4)),c.set(l,s.activeId))}else if(l.startsWith("UmapGraph")){var x=vr(l.split("&"),3),w=x[0],S=x[1],M=(x[2],i.get(S));void 0!==M&&(s.activeId="".concat(w,"&").concat(M,"&").concat(Cb(4)),c.set(l,s.activeId))}else if(l.startsWith("SceneLegend")||l.startsWith("LineGraphLegend")||l.startsWith("QuaternionSpaceLegend")||l.startsWith("UmapLegend")){var k=vr(l.split("&"),3),T=k[0],E=(k[1],k[2]),C=(l.startsWith("SceneLegend")?t:l.startsWith("LineGraphLegend")?r:l.startsWith("QuaternionSpaceLegend")?n:i).get(E);void 0!==C&&(s.activeId="".concat(T,"&").concat(Cb(4),"&").concat(C),c.set(l,s.activeId))}else if(l.startsWith("TimeWarpTimeBar")){var A=l.substring("TimeWarpTimeBar".length),R=t.get(A);void 0!==R&&(s.activeId="TimeWarpTimeBar"+R,c.set(l,s.activeId))}else if(l.startsWith("TimeWarpedGraph")){var P=vr(l.split("&"),4),L=P[0],D=P[1],N=P[2],I=(P[3],t.get(N)),O=r.get(D);void 0!==I&&void 0!==O&&(s.activeId="".concat(L,"&").concat(O,"&").concat(I,"&").concat(Cb(4)),c.set(l,s.activeId))}if(void 0!==s.tabs)for(var U=s.tabs,F=0;F<U.length;F++){var z,B,V,G,j,H=U[F];if(void 0!==H.id)if(c.has(H.id))H.id=c.get(H.id);else if(null!==(z=H.id)&&void 0!==z&&z.startsWith("RobotScene")){var W=vr(u(H.id),3),Z=(W[1],W[2]),q=t.get(Z);void 0!==q&&(H.id="RobotScene&".concat(Cb(4),"&").concat(q))}else if(null!==(B=H.id)&&void 0!==B&&B.startsWith("QuaternionSpaceScene")){var X=vr(H.id.split("&"),3),Y=X[1],K=(X[2],n.get(Y));void 0!==K&&(H.id="QuaternionSpaceScene&".concat(K,"&").concat(Cb(4)))}else if(null!==(V=H.id)&&void 0!==V&&V.startsWith("Graph")||null!==(G=H.id)&&void 0!==G&&G.startsWith("DifferenceGraph")){var J=vr(H.id.split("&"),3),Q=J[0],$=J[1],ee=(J[2],r.get($));void 0!==ee&&(H.id="".concat(Q,"&").concat(ee,"&").concat(Cb(4)))}else if(null!==(j=H.id)&&void 0!==j&&j.startsWith("UmapGraph")){var te=vr(H.id.split("&"),3),ne=te[0],re=te[1],ie=(te[2],i.get(re));void 0!==ie&&(H.id="".concat(ne,"&").concat(ie,"&").concat(Cb(4)))}else if(H.id.startsWith("SceneLegend")||H.id.startsWith("LineGraphLegend")||H.id.startsWith("QuaternionSpaceLegend")||H.id.startsWith("UmapLegend")){var ae=vr(H.id.split("&"),3),oe=ae[0],se=(ae[1],ae[2]),ue=(H.id.startsWith("SceneLegend")?t:H.id.startsWith("LineGraphLegend")?r:H.id.startsWith("QuaternionSpaceLegend")?n:i).get(se);void 0!==ue&&(s.activeId="".concat(oe,"&").concat(Cb(4),"&").concat(ue),c.set(H.id,s.activeId))}else if(H.id.startsWith("TimeWarpTimeBar")){var le=H.id.substring("TimeWarpTimeBar".length),ce=t.get(le);void 0!==ce&&(H.id="TimeWarpTimeBar"+ce)}else if(H.id.startsWith("TimeWarpedGraph")){var he=vr(H.id.split("&"),4),fe=he[0],de=he[1],pe=he[2],ve=(he[3],t.get(pe)),me=r.get(de);void 0!==ve&&void 0!==me&&(H.id="".concat(fe,"&").concat(me,"&").concat(ve,"&").concat(Cb(4)))}}var ge=a[o];void 0!==ge.children&&ge.children.length>0&&e(ge.children)}};l(e.dockbox.children),void 0!==(null===(a=e.floatbox)||void 0===a?void 0:a.children)&&l(e.floatbox.children),void 0!==(null===(o=e.maxbox)||void 0===o?void 0:o.children)&&l(e.maxbox.children),void 0!==(null===(s=e.windowbox)||void 0===s?void 0:s.children)&&l(e.windowbox.children)}}},{key:"addTracesToQuaternionScene",value:function(e,t,n,r){var i=this.robotSceneById(t);if(void 0!==i){var a=i.robotById(n);if(void 0!==a){var o=a.jointMap().get(r);void 0===o&&(o=a.linkMap().get(r)),e.addChildTrace(i,a,YU.frameRange(this.startTime(),this.endTime()),o)}}}},{key:"addTracesToRobotScene",value:function(e,t,n,r,i,a){var o=this.robotSceneById(t);if(void 0!==o){var s=this.robotSceneById(e);if(void 0!==s){var u=o.robotById(n);if(void 0!==u){var l=u.jointMap().get(r);if(void 0===l&&(l=u.linkMap().get(r)),s===o)if(s.hasChildTrace(u,l));else{var c=s.addChildTrace(u,YU.frameRange(this.startTime(),this.endTime()),l);i.set(a,c[0])}else if(s.hasReceivedGhostTrace(u,l));else{var h=o.sendGhostTracesTo(u,YU.frameRange(this.startTime(),this.endTime()),l,s);i.set(a,h[0])}}}}}}]),e}(),dF={floatable:!0,maximizable:!0},pF="place-holder",vF="-maximized-placeholder-",mF={floatable:!1},gF=t.createContext(null),yF=gF.Provider;gF.Consumer;function bF(){return bF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},bF.apply(this,arguments)}function _F(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}function xF(e,t){if(null==e)return{};var n,r,i=_F(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var wF=n(1694),SF=n.n(wF),MF=n(3873);function kF(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[];return t.Children.forEach(e,(function(e){(void 0!==e&&null!==e||n.keepEmpty)&&(Array.isArray(e)?r=r.concat(kF(e)):(0,MF.isFragment)(e)&&e.props?r=r.concat(kF(e.props.children,n)):r.push(e))})),r}var TF=function(){if("undefined"===typeof navigator||"undefined"===typeof window)return!1;var e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(null===e||void 0===e?void 0:e.substr(0,4))};function EF(e){var n=t.useRef();n.current=e;var r=t.useCallback((function(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return null===(e=n.current)||void 0===e?void 0:e.call.apply(e,[n].concat(r))}),[]);return r}function CF(){return!("undefined"===typeof window||!window.document||!window.document.createElement)}var AF,RF=CF()?t.useLayoutEffect:t.useEffect,PF=RF;function LF(e){var n=t.useRef(!1),r=vr(t.useState(e),2),i=r[0],a=r[1];return t.useEffect((function(){return n.current=!1,function(){n.current=!0}}),[]),[i,function(e,t){t&&n.current||a(e)}]}function DF(e){return void 0!==e}function NF(e,n){var r=n||{},i=r.defaultValue,a=r.value,o=r.onChange,s=r.postState,u=vr(LF((function(){var t,n=void 0;return DF(a)?(n=a,t=AF.PROP):DF(i)?(n="function"===typeof i?i():i,t=AF.PROP):(n="function"===typeof e?e():e,t=AF.INNER),[n,t,n]})),2),l=u[0],c=u[1],h=DF(a)?a:l[0],f=s?s(h):h;!function(e,n){var r=t.useRef(!0);RF((function(){if(!r.current)return e()}),n),RF((function(){return r.current=!1,function(){r.current=!0}}),[])}((function(){c((function(e){var t=vr(e,1)[0];return[a,AF.PROP,t]}))}),[a]);var d=t.useRef(),p=EF((function(e,t){c((function(t){var n=vr(t,3),r=n[0],i=n[1],a=n[2],o="function"===typeof e?e(r):e;if(o===r)return t;var s=i===AF.INNER&&d.current!==a?a:r;return[o,AF.INNER,s]}),t)})),v=EF(o);return PF((function(){var e=vr(l,3),t=e[0],n=e[1],r=e[2];t!==r&&n===AF.INNER&&(v(t,r),d.current=r)}),[l]),[f,p]}!function(e){e[e.INNER=0]="INNER",e[e.PROP=1]="PROP"}(AF||(AF={}));var IF=function(e){return+setTimeout(e,16)},OF=function(e){return clearTimeout(e)};"undefined"!==typeof window&&"requestAnimationFrame"in window&&(IF=function(e){return window.requestAnimationFrame(e)},OF=function(e){return window.cancelAnimationFrame(e)});var UF=0,FF=new Map;function zF(e){FF.delete(e)}function BF(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=UF+=1;function r(t){if(0===t)zF(n),e();else{var i=IF((function(){r(t-1)}));FF.set(n,i)}}return r(t),n}BF.cancel=function(e){var t=FF.get(e);return zF(t),OF(t)};var VF={};function GF(e,t){0}function jF(e,t,n){t||VF[n]||(e(!1,n),VF[n]=!0)}var HF=function(e,t){jF(GF,e,t)};function WF(e,t){"function"===typeof e?e(t):"object"===(0,hr.Z)(e)&&e&&"current"in e&&(e.current=t)}function ZF(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.filter((function(e){return e}));return r.length<=1?r[0]:function(e){t.forEach((function(t){WF(t,e)}))}}function qF(e){var t,n,r=(0,MF.isMemo)(e)?e.type.type:e.type;return!("function"===typeof r&&!(null===(t=r.prototype)||void 0===t?void 0:t.render))&&!("function"===typeof e&&!(null===(n=e.prototype)||void 0===n?void 0:n.render))}var XF=n(4164);function YF(e){return e instanceof HTMLElement?e:XF.findDOMNode(e)}var KF=function(){if("undefined"!==typeof Map)return Map;function e(e,t){var n=-1;return e.some((function(e,r){return e[0]===t&&(n=r,!0)})),n}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var n=e(this.__entries__,t),r=this.__entries__[n];return r&&r[1]},t.prototype.set=function(t,n){var r=e(this.__entries__,t);~r?this.__entries__[r][1]=n:this.__entries__.push([t,n])},t.prototype.delete=function(t){var n=this.__entries__,r=e(n,t);~r&&n.splice(r,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var n=0,r=this.__entries__;n<r.length;n++){var i=r[n];e.call(t,i[1],i[0])}},t}()}(),JF="undefined"!==typeof window&&"undefined"!==typeof document&&window.document===document,QF="undefined"!==typeof n.g&&n.g.Math===Math?n.g:"undefined"!==typeof self&&self.Math===Math?self:"undefined"!==typeof window&&window.Math===Math?window:Function("return this")(),$F="function"===typeof requestAnimationFrame?requestAnimationFrame.bind(QF):function(e){return setTimeout((function(){return e(Date.now())}),1e3/60)};var ez=["top","right","bottom","left","width","height","size","weight"],tz="undefined"!==typeof MutationObserver,nz=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var n=!1,r=!1,i=0;function a(){n&&(n=!1,e()),r&&s()}function o(){$F(a)}function s(){var e=Date.now();if(n){if(e-i<2)return;r=!0}else n=!0,r=!1,setTimeout(o,t);i=e}return s}(this.refresh.bind(this),20)}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,n=t.indexOf(e);~n&&t.splice(n,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter((function(e){return e.gatherActive(),e.hasActive()}));return e.forEach((function(e){return e.broadcastActive()})),e.length>0},e.prototype.connect_=function(){JF&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),tz?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){JF&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,n=void 0===t?"":t;ez.some((function(e){return!!~n.indexOf(e)}))&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),rz=function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];Object.defineProperty(e,i,{value:t[i],enumerable:!1,writable:!1,configurable:!0})}return e},iz=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||QF},az=hz(0,0,0,0);function oz(e){return parseFloat(e)||0}function sz(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce((function(t,n){return t+oz(e["border-"+n+"-width"])}),0)}function uz(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return az;var r=iz(e).getComputedStyle(e),i=function(e){for(var t={},n=0,r=["top","right","bottom","left"];n<r.length;n++){var i=r[n],a=e["padding-"+i];t[i]=oz(a)}return t}(r),a=i.left+i.right,o=i.top+i.bottom,s=oz(r.width),u=oz(r.height);if("border-box"===r.boxSizing&&(Math.round(s+a)!==t&&(s-=sz(r,"left","right")+a),Math.round(u+o)!==n&&(u-=sz(r,"top","bottom")+o)),!function(e){return e===iz(e).document.documentElement}(e)){var l=Math.round(s+a)-t,c=Math.round(u+o)-n;1!==Math.abs(l)&&(s-=l),1!==Math.abs(c)&&(u-=c)}return hz(i.left,i.top,s,u)}var lz="undefined"!==typeof SVGGraphicsElement?function(e){return e instanceof iz(e).SVGGraphicsElement}:function(e){return e instanceof iz(e).SVGElement&&"function"===typeof e.getBBox};function cz(e){return JF?lz(e)?function(e){var t=e.getBBox();return hz(0,0,t.width,t.height)}(e):uz(e):az}function hz(e,t,n,r){return{x:e,y:t,width:n,height:r}}var fz=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=hz(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=cz(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),dz=function(e,t){var n=function(e){var t=e.x,n=e.y,r=e.width,i=e.height,a="undefined"!==typeof DOMRectReadOnly?DOMRectReadOnly:Object,o=Object.create(a.prototype);return rz(o,{x:t,y:n,width:r,height:i,top:n,right:t+r,bottom:i+n,left:t}),o}(t);rz(this,{target:e,contentRect:n})},pz=function(){function e(e,t,n){if(this.activeObservations_=[],this.observations_=new KF,"function"!==typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=n}return e.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!==typeof Element&&Element instanceof Object){if(!(e instanceof iz(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new fz(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!==typeof Element&&Element instanceof Object){if(!(e instanceof iz(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach((function(t){t.isActive()&&e.activeObservations_.push(t)}))},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map((function(e){return new dz(e.target,e.broadcastRect())}));this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),vz="undefined"!==typeof WeakMap?new WeakMap:new KF,mz=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=nz.getInstance(),r=new pz(t,n,this);vz.set(this,r)};["observe","unobserve","disconnect"].forEach((function(e){mz.prototype[e]=function(){var t;return(t=vz.get(this))[e].apply(t,arguments)}}));var gz="undefined"!==typeof QF.ResizeObserver?QF.ResizeObserver:mz,yz=new Map;var bz=new gz((function(e){e.forEach((function(e){var t,n=e.target;null===(t=yz.get(n))||void 0===t||t.forEach((function(e){return e(n)}))}))}));var _z=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n,[{key:"render",value:function(){return this.props.children}}]),n}(t.Component),xz=t.createContext(null);function wz(e){var n=e.children,r=e.disabled,i=t.useRef(null),a=t.useRef(null),o=t.useContext(xz),s="function"===typeof n,u=s?n(i):n,l=t.useRef({width:-1,height:-1,offsetWidth:-1,offsetHeight:-1}),c=!s&&t.isValidElement(u)&&qF(u),h=c?u.ref:null,f=t.useMemo((function(){return ZF(h,i)}),[h,i]),d=t.useRef(e);d.current=e;var p=t.useCallback((function(e){var t=d.current,n=t.onResize,r=t.data,i=e.getBoundingClientRect(),a=i.width,s=i.height,u=e.offsetWidth,c=e.offsetHeight,h=Math.floor(a),f=Math.floor(s);if(l.current.width!==h||l.current.height!==f||l.current.offsetWidth!==u||l.current.offsetHeight!==c){var p={width:h,height:f,offsetWidth:u,offsetHeight:c};l.current=p;var v=u===Math.round(a)?a:u,m=c===Math.round(s)?s:c,g=Mr(Mr({},p),{},{offsetWidth:v,offsetHeight:m});null===o||void 0===o||o(g,e,r),n&&Promise.resolve().then((function(){n(g,e)}))}}),[]);return t.useEffect((function(){var e,t,n=YF(i.current)||YF(a.current);return n&&!r&&(e=n,t=p,yz.has(e)||(yz.set(e,new Set),bz.observe(e)),yz.get(e).add(t)),function(){return function(e,t){yz.has(e)&&(yz.get(e).delete(t),yz.get(e).size||(bz.unobserve(e),yz.delete(e)))}(n,p)}}),[i.current,r]),t.createElement(_z,{ref:a},c?t.cloneElement(u,{ref:f}):u)}function Sz(e){var n=e.children;return("function"===typeof n?[n]:kF(n)).map((function(n,r){var i=(null===n||void 0===n?void 0:n.key)||"".concat("rc-observer-key","-").concat(r);return t.createElement(wz,bF({},e,{key:i}),n)}))}Sz.Collection=function(e){var n=e.children,r=e.onBatchResize,i=t.useRef(0),a=t.useRef([]),o=t.useContext(xz),s=t.useCallback((function(e,t,n){i.current+=1;var s=i.current;a.current.push({size:e,element:t,data:n}),Promise.resolve().then((function(){s===i.current&&(null===r||void 0===r||r(a.current),a.current=[])})),null===o||void 0===o||o(e,t,n)}),[r,o]);return t.createElement(xz.Provider,{value:s},n)};var Mz=Sz;function kz(e){var n=(0,t.useRef)(),r=(0,t.useRef)(!1);return(0,t.useEffect)((function(){return r.current=!1,function(){r.current=!0,BF.cancel(n.current)}}),[]),function(){for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];r.current||(BF.cancel(n.current),n.current=BF((function(){e.apply(void 0,i)})))}}var Tz={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(e){var t=e.keyCode;if(e.altKey&&!e.ctrlKey||e.metaKey||t>=Tz.F1&&t<=Tz.F12)return!1;switch(t){case Tz.ALT:case Tz.CAPS_LOCK:case Tz.CONTEXT_MENU:case Tz.CTRL:case Tz.DOWN:case Tz.END:case Tz.ESC:case Tz.HOME:case Tz.INSERT:case Tz.LEFT:case Tz.MAC_FF_META:case Tz.META:case Tz.NUMLOCK:case Tz.NUM_CENTER:case Tz.PAGE_DOWN:case Tz.PAGE_UP:case Tz.PAUSE:case Tz.PRINT_SCREEN:case Tz.RIGHT:case Tz.SHIFT:case Tz.UP:case Tz.WIN_KEY:case Tz.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(e){if(e>=Tz.ZERO&&e<=Tz.NINE)return!0;if(e>=Tz.NUM_ZERO&&e<=Tz.NUM_MULTIPLY)return!0;if(e>=Tz.A&&e<=Tz.Z)return!0;if(-1!==window.navigator.userAgent.indexOf("WebKit")&&0===e)return!0;switch(e){case Tz.SPACE:case Tz.QUESTION_MARK:case Tz.NUM_PLUS:case Tz.NUM_MINUS:case Tz.NUM_PERIOD:case Tz.NUM_DIVISION:case Tz.SEMICOLON:case Tz.DASH:case Tz.EQUALS:case Tz.COMMA:case Tz.PERIOD:case Tz.SLASH:case Tz.APOSTROPHE:case Tz.SINGLE_QUOTE:case Tz.OPEN_SQUARE_BRACKET:case Tz.BACKSLASH:case Tz.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},Ez=Tz;function Cz(e,n){var r,i=e.prefixCls,a=e.id,o=e.active,s=e.tab,u=s.key,l=s.tab,c=s.disabled,h=s.closeIcon,f=e.closable,d=e.renderWrapper,p=e.removeAriaLabel,v=e.editable,m=e.onClick,g=e.onRemove,y=e.onFocus,b=e.style,_="".concat(i,"-tab");t.useEffect((function(){return g}),[]);var x=v&&!1!==f&&!c;function w(e){c||m(e)}var S=t.createElement("div",{key:u,ref:n,className:SF()(_,(r={},gr(r,"".concat(_,"-with-remove"),x),gr(r,"".concat(_,"-active"),o),gr(r,"".concat(_,"-disabled"),c),r)),style:b,onClick:w},t.createElement("div",{role:"tab","aria-selected":o,id:a&&"".concat(a,"-tab-").concat(u),className:"".concat(_,"-btn"),"aria-controls":a&&"".concat(a,"-panel-").concat(u),"aria-disabled":c,tabIndex:c?null:0,onClick:function(e){e.stopPropagation(),w(e)},onKeyDown:function(e){[Ez.SPACE,Ez.ENTER].includes(e.which)&&(e.preventDefault(),w(e))},onFocus:y},l),x&&t.createElement("button",{type:"button","aria-label":p||"remove",tabIndex:0,className:"".concat(_,"-remove"),onClick:function(e){var t;e.stopPropagation(),(t=e).preventDefault(),t.stopPropagation(),v.onEdit("remove",{key:u,event:t})}},h||v.removeIcon||"\xd7"));return d?d(S):S}var Az=t.forwardRef(Cz),Rz={width:0,height:0,left:0,top:0};var Pz={width:0,height:0,left:0,top:0,right:0};var Lz=n(9613),Dz=n.n(Lz),Nz=["prefixCls","invalidate","item","renderItem","responsive","responsiveDisabled","registerSize","itemKey","className","style","children","display","order","component"],Iz=void 0;function Oz(e,n){var r=e.prefixCls,i=e.invalidate,a=e.item,o=e.renderItem,s=e.responsive,u=e.responsiveDisabled,l=e.registerSize,c=e.itemKey,h=e.className,f=e.style,d=e.children,p=e.display,v=e.order,m=e.component,g=void 0===m?"div":m,y=xF(e,Nz),b=s&&!p;function _(e){l(c,e)}t.useEffect((function(){return function(){_(null)}}),[]);var x,w=o&&a!==Iz?o(a):d;i||(x={opacity:b?0:1,height:b?0:Iz,overflowY:b?"hidden":Iz,order:s?v:Iz,pointerEvents:b?"none":Iz,position:b?"absolute":Iz});var S={};b&&(S["aria-hidden"]=!0);var M=t.createElement(g,bF({className:SF()(!i&&r,h),style:Mr(Mr({},x),f)},S,y,{ref:n}),w);return s&&(M=t.createElement(Mz,{onResize:function(e){_(e.offsetWidth)},disabled:u},M)),M}var Uz=t.forwardRef(Oz);Uz.displayName="Item";var Fz=Uz;var zz=["component"],Bz=["className"],Vz=["className"],Gz=function(e,n){var r=t.useContext(Zz);if(!r){var i=e.component,a=void 0===i?"div":i,o=xF(e,zz);return t.createElement(a,bF({},o,{ref:n}))}var s=r.className,u=xF(r,Bz),l=e.className,c=xF(e,Vz);return t.createElement(Zz.Provider,{value:null},t.createElement(Fz,bF({ref:n,className:SF()(s,l)},u,c)))},jz=t.forwardRef(Gz);jz.displayName="RawItem";var Hz=jz,Wz=["prefixCls","data","renderItem","renderRawItem","itemKey","itemWidth","ssr","style","className","maxCount","renderRest","renderRawRest","suffix","component","itemComponent","onVisibleChange"],Zz=t.createContext(null),qz="responsive",Xz="invalidate";function Yz(e){return"+ ".concat(e.length," ...")}function Kz(e,n){var r=e.prefixCls,i=void 0===r?"rc-overflow":r,a=e.data,o=void 0===a?[]:a,s=e.renderItem,u=e.renderRawItem,l=e.itemKey,c=e.itemWidth,h=void 0===c?10:c,f=e.ssr,d=e.style,p=e.className,v=e.maxCount,m=e.renderRest,g=e.renderRawRest,y=e.suffix,b=e.component,_=void 0===b?"div":b,x=e.itemComponent,w=e.onVisibleChange,S=xF(e,Wz),M=function(){var e=vr(LF({}),2)[1],n=(0,t.useRef)([]),r=0,i=0;return function(t){var a=r;return r+=1,n.current.length<a+1&&(n.current[a]=t),[n.current[a],function(t){n.current[a]="function"===typeof t?t(n.current[a]):t,BF.cancel(i),i=BF((function(){e({},!0)}))}]}}(),k="full"===f,T=vr(M(null),2),E=T[0],C=T[1],A=E||0,R=vr(M(new Map),2),P=R[0],L=R[1],D=vr(M(0),2),N=D[0],I=D[1],O=vr(M(0),2),U=O[0],F=O[1],z=vr(M(0),2),B=z[0],V=z[1],G=vr((0,t.useState)(null),2),j=G[0],H=G[1],W=vr((0,t.useState)(null),2),Z=W[0],q=W[1],X=t.useMemo((function(){return null===Z&&k?Number.MAX_SAFE_INTEGER:Z||0}),[Z,E]),Y=vr((0,t.useState)(!1),2),K=Y[0],J=Y[1],Q="".concat(i,"-item"),$=Math.max(N,U),ee=v===qz,te=o.length&&ee,ne=v===Xz,re=te||"number"===typeof v&&o.length>v,ie=(0,t.useMemo)((function(){var e=o;return te?e=null===E&&k?o:o.slice(0,Math.min(o.length,A/h)):"number"===typeof v&&(e=o.slice(0,v)),e}),[o,h,E,v,te]),ae=(0,t.useMemo)((function(){return te?o.slice(X+1):o.slice(ie.length)}),[o,ie,te,X]),oe=(0,t.useCallback)((function(e,t){var n;return"function"===typeof l?l(e):null!==(n=l&&(null===e||void 0===e?void 0:e[l]))&&void 0!==n?n:t}),[l]),se=(0,t.useCallback)(s||function(e){return e},[s]);function ue(e,t,n){(Z!==e||void 0!==t&&t!==j)&&(q(e),n||(J(e<o.length-1),null===w||void 0===w||w(e)),void 0!==t&&H(t))}function le(e,t){L((function(n){var r=new Map(n);return null===t?r.delete(e):r.set(e,t),r}))}function ce(e){return P.get(oe(ie[e],e))}PF((function(){if(A&&$&&ie){var e=B,t=ie.length,n=t-1;if(!t)return void ue(0,null);for(var r=0;r<t;r+=1){var i=ce(r);if(k&&(i=i||0),void 0===i){ue(r-1,void 0,!0);break}if(e+=i,0===n&&e<=A||r===n-1&&e+ce(n)<=A){ue(n,null);break}if(e+$>A){ue(r-1,e-i-B+U);break}}y&&ce(0)+B>A&&H(null)}}),[A,P,U,B,oe,ie]);var he=K&&!!ae.length,fe={};null!==j&&te&&(fe={position:"absolute",left:j,top:0});var de,pe={prefixCls:Q,responsive:te,component:x,invalidate:ne},ve=u?function(e,n){var r=oe(e,n);return t.createElement(Zz.Provider,{key:r,value:Mr(Mr({},pe),{},{order:n,item:e,itemKey:r,registerSize:le,display:n<=X})},u(e,n))}:function(e,n){var r=oe(e,n);return t.createElement(Fz,bF({},pe,{order:n,key:r,item:e,renderItem:se,itemKey:r,registerSize:le,display:n<=X}))},me={order:he?X:Number.MAX_SAFE_INTEGER,className:"".concat(Q,"-rest"),registerSize:function(e,t){F(t),I(U)},display:he};if(g)g&&(de=t.createElement(Zz.Provider,{value:Mr(Mr({},pe),me)},g(ae)));else{var ge=m||Yz;de=t.createElement(Fz,bF({},pe,me),"function"===typeof ge?ge(ae):ge)}var ye=t.createElement(_,bF({className:SF()(!ne&&i,p),style:d,ref:n},S),ie.map(ve),re?de:null,y&&t.createElement(Fz,bF({},pe,{responsive:ee,responsiveDisabled:!te,order:X,className:"".concat(Q,"-suffix"),registerSize:function(e,t){V(t)},display:!0,style:fe}),y));return ee&&(ye=t.createElement(Mz,{onResize:function(e,t){C(t.clientWidth)},disabled:!te},ye)),ye}var Jz=t.forwardRef(Kz);Jz.displayName="Overflow",Jz.Item=Hz,Jz.RESPONSIVE=qz,Jz.INVALIDATE=Xz;var Qz=Jz;function $z(e,t){var n=Mr({},e);return Array.isArray(t)&&t.forEach((function(e){delete n[e]})),n}var eB=["children","locked"],tB=t.createContext(null);function nB(e){var n=e.children,r=e.locked,i=xF(e,eB),a=t.useContext(tB),o=function(e,n,r){var i=t.useRef({});return"value"in i.current&&!r(i.current.condition,n)||(i.current.value=e(),i.current.condition=n),i.current.value}((function(){return function(e,t){var n=Mr({},e);return Object.keys(t).forEach((function(e){var r=t[e];void 0!==r&&(n[e]=r)})),n}(a,i)}),[a,i],(function(e,t){return!r&&(e[0]!==t[0]||!Dz()(e[1],t[1]))}));return t.createElement(tB.Provider,{value:o},n)}function rB(e,n,r,i){var a=t.useContext(tB),o=a.activeKey,s=a.onActive,u=a.onInactive,l={active:o===e};return n||(l.onMouseEnter=function(t){null===r||void 0===r||r({key:e,domEvent:t}),s(e)},l.onMouseLeave=function(t){null===i||void 0===i||i({key:e,domEvent:t}),u(e)}),l}var iB=["item"];function aB(e){var t=e.item,n=xF(e,iB);return Object.defineProperty(n,"item",{get:function(){return HF(!1,"`info.item` is deprecated since we will move to function component that not provides React Node instance in future."),t}}),n}function oB(e){var n=e.icon,r=e.props,i=e.children;return("function"===typeof n?t.createElement(n,Mr({},r)):n)||i||null}function sB(e){var n=t.useContext(tB),r=n.mode,i=n.rtl,a=n.inlineIndent;if("inline"!==r)return null;return i?{paddingRight:e*a}:{paddingLeft:e*a}}var uB=[],lB=t.createContext(null);function cB(){return t.useContext(lB)}var hB=t.createContext(uB);function fB(e){var n=t.useContext(hB);return t.useMemo((function(){return void 0!==e?[].concat(cr(n),[e]):n}),[n,e])}var dB=t.createContext(null),pB=t.createContext(null);function vB(e,t){return void 0===e?null:"".concat(e,"-").concat(t)}function mB(e){return vB(t.useContext(pB),e)}var gB=t.createContext({}),yB=["title","attribute","elementRef"],bB=["style","className","eventKey","warnKey","disabled","itemIcon","children","role","onMouseEnter","onMouseLeave","onClick","onKeyDown","onFocus"],_B=["active"],xB=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(){return(0,u.Z)(this,r),n.apply(this,arguments)}return(0,l.Z)(r,[{key:"render",value:function(){var e=this.props,n=e.title,r=e.attribute,i=e.elementRef,a=$z(xF(e,yB),["eventKey"]);return HF(!r,"`attribute` of Menu.Item is deprecated. Please pass attribute directly."),t.createElement(Qz.Item,bF({},r,{title:"string"===typeof n?n:void 0},a,{ref:i}))}}]),r}(t.Component),wB=function(e){var n,r=e.style,i=e.className,a=e.eventKey,o=(e.warnKey,e.disabled),s=e.itemIcon,u=e.children,l=e.role,c=e.onMouseEnter,h=e.onMouseLeave,f=e.onClick,d=e.onKeyDown,p=e.onFocus,v=xF(e,bB),m=mB(a),g=t.useContext(tB),y=g.prefixCls,b=g.onItemClick,_=g.disabled,x=g.overflowDisabled,w=g.itemIcon,S=g.selectedKeys,M=g.onActive,k=t.useContext(gB)._internalRenderMenuItem,T="".concat(y,"-item"),E=t.useRef(),C=t.useRef(),A=_||o,R=fB(a);var P=function(e){return{key:a,keyPath:cr(R).reverse(),item:E.current,domEvent:e}},L=s||w,D=rB(a,A,c,h),N=D.active,I=xF(D,_B),O=S.includes(a),U=sB(R.length),F={};"option"===e.role&&(F["aria-selected"]=O);var z=t.createElement(xB,bF({ref:E,elementRef:C,role:null===l?"none":l||"menuitem",tabIndex:o?null:-1,"data-menu-id":x&&m?null:m},v,I,F,{component:"li","aria-disabled":o,style:Mr(Mr({},U),r),className:SF()(T,(n={},gr(n,"".concat(T,"-active"),N),gr(n,"".concat(T,"-selected"),O),gr(n,"".concat(T,"-disabled"),A),n),i),onClick:function(e){if(!A){var t=P(e);null===f||void 0===f||f(aB(t)),b(t)}},onKeyDown:function(e){if(null===d||void 0===d||d(e),e.which===Ez.ENTER){var t=P(e);null===f||void 0===f||f(aB(t)),b(t)}},onFocus:function(e){M(a),null===p||void 0===p||p(e)}}),u,t.createElement(oB,{props:Mr(Mr({},e),{},{isSelected:O}),icon:L}));return k&&(z=k(z,e,{selected:O})),z};var SB=function(e){var n=e.eventKey,r=cB(),i=fB(n);return t.useEffect((function(){if(r)return r.registerPath(n,i),function(){r.unregisterPath(n,i)}}),[i]),r?null:t.createElement(wB,e)},MB=["label","children","key","type"];function kB(e,n){return kF(e).map((function(e,r){if(t.isValidElement(e)){var i,a,o=e.key,s=null!==(i=null===(a=e.props)||void 0===a?void 0:a.eventKey)&&void 0!==i?i:o;(null===s||void 0===s)&&(s="tmp_key-".concat([].concat(cr(n),[r]).join("-")));var u={key:s,eventKey:s};return t.cloneElement(e,u)}return e}))}function TB(e){return(e||[]).map((function(e,n){if(e&&"object"===(0,hr.Z)(e)){var r=e.label,i=e.children,a=e.key,o=e.type,s=xF(e,MB),u=null!==a&&void 0!==a?a:"tmp-".concat(n);return i||"group"===o?"group"===o?t.createElement(Lj,bF({key:u},s,{title:r}),TB(i)):t.createElement(aj,bF({key:u},s,{title:r}),TB(i)):"divider"===o?t.createElement(Dj,bF({key:u},s)):t.createElement(SB,bF({key:u},s),r)}return null})).filter((function(e){return e}))}function EB(e,t,n){var r=e;return t&&(r=TB(t)),kB(r,n)}function CB(e){var n=t.useRef(e);n.current=e;var r=t.useCallback((function(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return null===(e=n.current)||void 0===e?void 0:e.call.apply(e,[n].concat(r))}),[]);return e?r:void 0}var AB=["className","children"],RB=function(e,n){var r=e.className,i=e.children,a=xF(e,AB),o=t.useContext(tB),s=o.prefixCls,u=o.mode,l=o.rtl;return t.createElement("ul",bF({className:SF()(s,l&&"".concat(s,"-rtl"),"".concat(s,"-sub"),"".concat(s,"-").concat("inline"===u?"inline":"vertical"),r)},a,{"data-menu-list":!0,ref:n}),i)},PB=t.forwardRef(RB);PB.displayName="SubMenuList";var LB=PB;function DB(e,t){if(!e)return!1;if(e.contains)return e.contains(t);for(var n=t;n;){if(n===e)return!0;n=n.parentNode}return!1}function NB(e,t,n,r){var i=XF.unstable_batchedUpdates?function(e){XF.unstable_batchedUpdates(n,e)}:n;return e.addEventListener&&e.addEventListener(t,i,r),{remove:function(){e.removeEventListener&&e.removeEventListener(t,i,r)}}}var IB=(0,t.forwardRef)((function(e,n){var r=e.didUpdate,i=e.getContainer,a=e.children,o=(0,t.useRef)(),s=(0,t.useRef)();(0,t.useImperativeHandle)(n,(function(){return{}}));var u=(0,t.useRef)(!1);return!u.current&&CF()&&(s.current=i(),o.current=s.current.parentNode,u.current=!0),(0,t.useEffect)((function(){null===r||void 0===r||r(e)})),(0,t.useEffect)((function(){return null===s.current.parentNode&&null!==o.current&&o.current.appendChild(s.current),function(){var e,t;null===(e=s.current)||void 0===e||null===(t=e.parentNode)||void 0===t||t.removeChild(s.current)}}),[]),s.current?XF.createPortal(a,s.current):null})),OB=IB;function UB(e,t,n){return n?e[0]===t[0]:e[0]===t[0]&&e[1]===t[1]}function FB(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit".concat(e)]="webkit".concat(t),n["Moz".concat(e)]="moz".concat(t),n["ms".concat(e)]="MS".concat(t),n["O".concat(e)]="o".concat(t.toLowerCase()),n}var zB=function(e,t){var n={animationend:FB("Animation","AnimationEnd"),transitionend:FB("Transition","TransitionEnd")};return e&&("AnimationEvent"in t||delete n.animationend.animation,"TransitionEvent"in t||delete n.transitionend.transition),n}(CF(),"undefined"!==typeof window?window:{}),BB={};if(CF()){var VB=document.createElement("div");BB=VB.style}var GB={};function jB(e){if(GB[e])return GB[e];var t=zB[e];if(t)for(var n=Object.keys(t),r=n.length,i=0;i<r;i+=1){var a=n[i];if(Object.prototype.hasOwnProperty.call(t,a)&&a in BB)return GB[e]=t[a],GB[e]}return""}var HB=jB("animationend"),WB=jB("transitionend"),ZB=!(!HB||!WB),qB=HB||"animationend",XB=WB||"transitionend";function YB(e,t){return e?"object"===(0,hr.Z)(e)?e[t.replace(/-\w/g,(function(e){return e[1].toUpperCase()}))]:"".concat(e,"-").concat(t):null}var KB="none",JB="appear",QB="enter",$B="leave",eV="none",tV="prepare",nV="start",rV="active",iV="end",aV=CF()?t.useLayoutEffect:t.useEffect,oV=[tV,nV,rV,iV];function sV(e){return e===rV||e===iV}var uV=function(e,n){var r=vr(LF(eV),2),i=r[0],a=r[1],o=function(){var e=t.useRef(null);function n(){BF.cancel(e.current)}return t.useEffect((function(){return function(){n()}}),[]),[function t(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;n();var a=BF((function(){i<=1?r({isCanceled:function(){return a!==e.current}}):t(r,i-1)}));e.current=a},n]}(),s=vr(o,2),u=s[0],l=s[1];return aV((function(){if(i!==eV&&i!==iV){var e=oV.indexOf(i),t=oV[e+1],r=n(i);false===r?a(t,!0):u((function(e){function n(){e.isCanceled()||a(t,!0)}!0===r?n():Promise.resolve(r).then(n)}))}}),[e,i]),t.useEffect((function(){return function(){l()}}),[]),[function(){a(tV,!0)},i]};function lV(e,n,r,i){var a=i.motionEnter,o=void 0===a||a,s=i.motionAppear,u=void 0===s||s,l=i.motionLeave,c=void 0===l||l,h=i.motionDeadline,f=i.motionLeaveImmediately,d=i.onAppearPrepare,p=i.onEnterPrepare,v=i.onLeavePrepare,m=i.onAppearStart,g=i.onEnterStart,y=i.onLeaveStart,b=i.onAppearActive,_=i.onEnterActive,x=i.onLeaveActive,w=i.onAppearEnd,S=i.onEnterEnd,M=i.onLeaveEnd,k=i.onVisibleChanged,T=vr(LF(),2),E=T[0],C=T[1],A=vr(LF(KB),2),R=A[0],P=A[1],L=vr(LF(null),2),D=L[0],N=L[1],I=(0,t.useRef)(!1),O=(0,t.useRef)(null);function U(){return r()}var F=(0,t.useRef)(!1);function z(e){var t=U();if(!e||e.deadline||e.target===t){var n,r=F.current;R===JB&&r?n=null===w||void 0===w?void 0:w(t,e):R===QB&&r?n=null===S||void 0===S?void 0:S(t,e):R===$B&&r&&(n=null===M||void 0===M?void 0:M(t,e)),R!==KB&&r&&!1!==n&&(P(KB,!0),N(null,!0))}}var B=function(e){var n=(0,t.useRef)(),r=(0,t.useRef)(e);r.current=e;var i=t.useCallback((function(e){r.current(e)}),[]);function a(e){e&&(e.removeEventListener(XB,i),e.removeEventListener(qB,i))}return t.useEffect((function(){return function(){a(n.current)}}),[]),[function(e){n.current&&n.current!==e&&a(n.current),e&&e!==n.current&&(e.addEventListener(XB,i),e.addEventListener(qB,i),n.current=e)},a]}(z),V=vr(B,1)[0],G=t.useMemo((function(){var e,t,n;switch(R){case JB:return gr(e={},tV,d),gr(e,nV,m),gr(e,rV,b),e;case QB:return gr(t={},tV,p),gr(t,nV,g),gr(t,rV,_),t;case $B:return gr(n={},tV,v),gr(n,nV,y),gr(n,rV,x),n;default:return{}}}),[R]),j=vr(uV(R,(function(e){if(e===tV){var t=G.prepare;return!!t&&t(U())}var n;W in G&&N((null===(n=G[W])||void 0===n?void 0:n.call(G,U(),null))||null);return W===rV&&(V(U()),h>0&&(clearTimeout(O.current),O.current=setTimeout((function(){z({deadline:!0})}),h))),true})),2),H=j[0],W=j[1],Z=sV(W);F.current=Z,aV((function(){C(n);var t,r=I.current;(I.current=!0,e)&&(!r&&n&&u&&(t=JB),r&&n&&o&&(t=QB),(r&&!n&&c||!r&&f&&!n&&c)&&(t=$B),t&&(P(t),H()))}),[n]),(0,t.useEffect)((function(){(R===JB&&!u||R===QB&&!o||R===$B&&!c)&&P(KB)}),[u,o,c]),(0,t.useEffect)((function(){return function(){I.current=!1,clearTimeout(O.current)}}),[]);var q=t.useRef(!1);(0,t.useEffect)((function(){E&&(q.current=!0),void 0!==E&&R===KB&&((q.current||E)&&(null===k||void 0===k||k(E)),q.current=!0)}),[E,R]);var X=D;return G.prepare&&W===nV&&(X=Mr({transition:"none"},X)),[R,W,X,null!==E&&void 0!==E?E:n]}var cV=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n,[{key:"render",value:function(){return this.props.children}}]),n}(t.Component),hV=cV;var fV=function(e){var n=e;function r(e){return!(!e.motionName||!n)}"object"===(0,hr.Z)(e)&&(n=e.transitionSupport);var i=t.forwardRef((function(e,n){var i=e.visible,a=void 0===i||i,o=e.removeOnLeave,s=void 0===o||o,u=e.forceRender,l=e.children,c=e.motionName,h=e.leavedClassName,f=e.eventProps,d=r(e),p=(0,t.useRef)(),v=(0,t.useRef)();var m=vr(lV(d,a,(function(){try{return p.current instanceof HTMLElement?p.current:YF(v.current)}catch(_2){return null}}),e),4),g=m[0],y=m[1],b=m[2],_=m[3],x=t.useRef(_);_&&(x.current=!0);var w,S=t.useCallback((function(e){p.current=e,WF(n,e)}),[n]),M=Mr(Mr({},f),{},{visible:a});if(l)if(g!==KB&&r(e)){var k,T;y===tV?T="prepare":sV(y)?T="active":y===nV&&(T="start"),w=l(Mr(Mr({},M),{},{className:SF()(YB(c,g),(k={},gr(k,YB(c,"".concat(g,"-").concat(T)),T),gr(k,c,"string"===typeof c),k)),style:b}),S)}else w=_?l(Mr({},M),S):!s&&x.current?l(Mr(Mr({},M),{},{className:h}),S):u?l(Mr(Mr({},M),{},{style:{display:"none"}}),S):null;else w=null;t.isValidElement(w)&&qF(w)&&(w.ref||(w=t.cloneElement(w,{ref:S})));return t.createElement(hV,{ref:v},w)}));return i.displayName="CSSMotion",i}(ZB),dV="add",pV="keep",vV="remove",mV="removed";function gV(e){var t;return Mr(Mr({},t=e&&"object"===(0,hr.Z)(e)&&"key"in e?e:{key:e}),{},{key:String(t.key)})}function yV(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map(gV)}function bV(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[],r=0,i=t.length,a=yV(e),o=yV(t);a.forEach((function(e){for(var t=!1,a=r;a<i;a+=1){var s=o[a];if(s.key===e.key){r<a&&(n=n.concat(o.slice(r,a).map((function(e){return Mr(Mr({},e),{},{status:dV})}))),r=a),n.push(Mr(Mr({},s),{},{status:pV})),r+=1,t=!0;break}}t||n.push(Mr(Mr({},e),{},{status:vV}))})),r<i&&(n=n.concat(o.slice(r).map((function(e){return Mr(Mr({},e),{},{status:dV})}))));var s={};n.forEach((function(e){var t=e.key;s[t]=(s[t]||0)+1}));var u=Object.keys(s).filter((function(e){return s[e]>1}));return u.forEach((function(e){n=n.filter((function(t){var n=t.key,r=t.status;return n!==e||r!==vV})),n.forEach((function(t){t.key===e&&(t.status=pV)}))})),n}var _V=["component","children","onVisibleChanged","onAllRemoved"],xV=["status"],wV=["eventProps","visible","children","motionName","motionAppear","motionEnter","motionLeave","motionLeaveImmediately","motionDeadline","removeOnLeave","leavedClassName","onAppearStart","onAppearActive","onAppearEnd","onEnterStart","onEnterActive","onEnterEnd","onLeaveStart","onLeaveActive","onLeaveEnd"];!function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fV,r=function(e){(0,h.Z)(i,e);var r=(0,f.Z)(i);function i(){var e;(0,u.Z)(this,i);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=r.call.apply(r,[this].concat(n))).state={keyEntities:[]},e.removeKey=function(t){var n=e.state.keyEntities.map((function(e){return e.key!==t?e:Mr(Mr({},e),{},{status:mV})}));return e.setState({keyEntities:n}),n.filter((function(e){return e.status!==mV})).length},e}return(0,l.Z)(i,[{key:"render",value:function(){var e=this,r=this.state.keyEntities,i=this.props,a=i.component,o=i.children,s=i.onVisibleChanged,u=i.onAllRemoved,l=xF(i,_V),c=a||t.Fragment,h={};return wV.forEach((function(e){h[e]=l[e],delete l[e]})),delete l.keys,t.createElement(c,l,r.map((function(r){var i=r.status,a=xF(r,xV),l=i===dV||i===pV;return t.createElement(n,bF({},h,{key:a.key,visible:l,eventProps:a,onVisibleChanged:function(t){(null===s||void 0===s||s(t,{key:a.key}),t)||0===e.removeKey(a.key)&&u&&u()}}),o)})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.keys,r=t.keyEntities,i=yV(n);return{keyEntities:bV(r,i).filter((function(e){var t=r.find((function(t){var n=t.key;return e.key===n}));return!t||t.status!==mV||e.status!==vV}))}}}]),i}(t.Component);r.defaultProps={component:"div"}}(ZB);var SV=fV;function MV(e){var t=e.prefixCls,n=e.motion,r=e.animation,i=e.transitionName;return n||(r?{motionName:"".concat(t,"-").concat(r)}:i?{motionName:i}:null)}function kV(e){var n=e.prefixCls,r=e.visible,i=e.zIndex,a=e.mask,o=e.maskMotion,s=e.maskAnimation,u=e.maskTransitionName;if(!a)return null;var l={};return(o||u||s)&&(l=Mr({motionAppear:!0},MV({motion:o,prefixCls:n,transitionName:u,animation:s}))),t.createElement(SV,bF({},l,{visible:r,removeOnLeave:!0}),(function(e){var r=e.className;return t.createElement("div",{style:{zIndex:i},className:SF()("".concat(n,"-mask"),r)})}))}var TV,EV=function(e){if(!e)return!1;if(e instanceof HTMLElement&&e.offsetParent)return!0;if(e instanceof SVGGraphicsElement&&e.getBBox){var t=e.getBBox(),n=t.width,r=t.height;if(n||r)return!0}if(e instanceof HTMLElement&&e.getBoundingClientRect){var i=e.getBoundingClientRect(),a=i.width,o=i.height;if(a||o)return!0}return!1};function CV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function AV(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?CV(Object(n),!0).forEach((function(t){PV(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):CV(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function RV(e){return RV="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},RV(e)}function PV(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var LV={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-",O:"-o-"};function DV(){if(void 0!==TV)return TV;TV="";var e=document.createElement("p").style;for(var t in LV)t+"Transform"in e&&(TV=t);return TV}function NV(){return DV()?"".concat(DV(),"TransitionProperty"):"transitionProperty"}function IV(){return DV()?"".concat(DV(),"Transform"):"transform"}function OV(e,t){var n=NV();n&&(e.style[n]=t,"transitionProperty"!==n&&(e.style.transitionProperty=t))}function UV(e,t){var n=IV();n&&(e.style[n]=t,"transform"!==n&&(e.style.transform=t))}var FV,zV=/matrix\((.*)\)/,BV=/matrix3d\((.*)\)/;function VV(e){var t=e.style.display;e.style.display="none",e.offsetHeight,e.style.display=t}function GV(e,t,n){var r=n;if("object"!==RV(t))return"undefined"!==typeof r?("number"===typeof r&&(r="".concat(r,"px")),void(e.style[t]=r)):FV(e,t);for(var i in t)t.hasOwnProperty(i)&&GV(e,i,t[i])}function jV(e,t){var n=e["page".concat(t?"Y":"X","Offset")],r="scroll".concat(t?"Top":"Left");if("number"!==typeof n){var i=e.document;"number"!==typeof(n=i.documentElement[r])&&(n=i.body[r])}return n}function HV(e){return jV(e)}function WV(e){return jV(e,!0)}function ZV(e){var t=function(e){var t,n,r,i=e.ownerDocument,a=i.body,o=i&&i.documentElement;return t=e.getBoundingClientRect(),n=Math.floor(t.left),r=Math.floor(t.top),{left:n-=o.clientLeft||a.clientLeft||0,top:r-=o.clientTop||a.clientTop||0}}(e),n=e.ownerDocument,r=n.defaultView||n.parentWindow;return t.left+=HV(r),t.top+=WV(r),t}function qV(e){return null!==e&&void 0!==e&&e==e.window}function XV(e){return qV(e)?e.document:9===e.nodeType?e:e.ownerDocument}var YV=new RegExp("^(".concat(/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,")(?!px)[a-z%]+$"),"i"),KV=/^(top|right|bottom|left)$/;function JV(e,t){return"left"===e?t.useCssRight?"right":e:t.useCssBottom?"bottom":e}function QV(e){return"left"===e?"right":"right"===e?"left":"top"===e?"bottom":"bottom"===e?"top":void 0}function $V(e,t,n){"static"===GV(e,"position")&&(e.style.position="relative");var r=-999,i=-999,a=JV("left",n),o=JV("top",n),s=QV(a),u=QV(o);"left"!==a&&(r=999),"top"!==o&&(i=999);var l="",c=ZV(e);("left"in t||"top"in t)&&(l=function(e){return e.style.transitionProperty||e.style[NV()]}(e)||"",OV(e,"none")),"left"in t&&(e.style[s]="",e.style[a]="".concat(r,"px")),"top"in t&&(e.style[u]="",e.style[o]="".concat(i,"px")),VV(e);var h=ZV(e),f={};for(var d in t)if(t.hasOwnProperty(d)){var p=JV(d,n),v="left"===d?r:i,m=c[d]-h[d];f[p]=p===d?v+m:v-m}GV(e,f),VV(e),("left"in t||"top"in t)&&OV(e,l);var g={};for(var y in t)if(t.hasOwnProperty(y)){var b=JV(y,n),_=t[y]-c[y];g[b]=y===b?f[b]+_:f[b]-_}GV(e,g)}function eG(e,t){var n=ZV(e),r=function(e){var t=window.getComputedStyle(e,null),n=t.getPropertyValue("transform")||t.getPropertyValue(IV());if(n&&"none"!==n){var r=n.replace(/[^0-9\-.,]/g,"").split(",");return{x:parseFloat(r[12]||r[4],0),y:parseFloat(r[13]||r[5],0)}}return{x:0,y:0}}(e),i={x:r.x,y:r.y};"left"in t&&(i.x=r.x+t.left-n.left),"top"in t&&(i.y=r.y+t.top-n.top),function(e,t){var n=window.getComputedStyle(e,null),r=n.getPropertyValue("transform")||n.getPropertyValue(IV());if(r&&"none"!==r){var i,a=r.match(zV);a?((i=(a=a[1]).split(",").map((function(e){return parseFloat(e,10)})))[4]=t.x,i[5]=t.y,UV(e,"matrix(".concat(i.join(","),")"))):((i=r.match(BV)[1].split(",").map((function(e){return parseFloat(e,10)})))[12]=t.x,i[13]=t.y,UV(e,"matrix3d(".concat(i.join(","),")")))}else UV(e,"translateX(".concat(t.x,"px) translateY(").concat(t.y,"px) translateZ(0)"))}(e,i)}function tG(e,t){for(var n=0;n<e.length;n++)t(e[n])}function nG(e){return"border-box"===FV(e,"boxSizing")}"undefined"!==typeof window&&(FV=window.getComputedStyle?function(e,t,n){var r=n,i="",a=XV(e);return(r=r||a.defaultView.getComputedStyle(e,null))&&(i=r.getPropertyValue(t)||r[t]),i}:function(e,t){var n=e.currentStyle&&e.currentStyle[t];if(YV.test(n)&&!KV.test(t)){var r=e.style,i=r.left,a=e.runtimeStyle.left;e.runtimeStyle.left=e.currentStyle.left,r.left="fontSize"===t?"1em":n||0,n=r.pixelLeft+"px",r.left=i,e.runtimeStyle.left=a}return""===n?"auto":n});var rG=["margin","border","padding"];function iG(e,t,n){var r,i={},a=e.style;for(r in t)t.hasOwnProperty(r)&&(i[r]=a[r],a[r]=t[r]);for(r in n.call(e),t)t.hasOwnProperty(r)&&(a[r]=i[r])}function aG(e,t,n){var r,i,a,o=0;for(i=0;i<t.length;i++)if(r=t[i])for(a=0;a<n.length;a++){var s=void 0;s="border"===r?"".concat(r).concat(n[a],"Width"):r+n[a],o+=parseFloat(FV(e,s))||0}return o}var oG={getParent:function(e){var t=e;do{t=11===t.nodeType&&t.host?t.host:t.parentNode}while(t&&1!==t.nodeType&&9!==t.nodeType);return t}};function sG(e,t,n){var r=n;if(qV(e))return"width"===t?oG.viewportWidth(e):oG.viewportHeight(e);if(9===e.nodeType)return"width"===t?oG.docWidth(e):oG.docHeight(e);var i="width"===t?["Left","Right"]:["Top","Bottom"],a="width"===t?Math.floor(e.getBoundingClientRect().width):Math.floor(e.getBoundingClientRect().height),o=nG(e),s=0;(null===a||void 0===a||a<=0)&&(a=void 0,(null===(s=FV(e,t))||void 0===s||Number(s)<0)&&(s=e.style[t]||0),s=parseFloat(s)||0),void 0===r&&(r=o?1:-1);var u=void 0!==a||o,l=a||s;return-1===r?u?l-aG(e,["border","padding"],i):s:u?1===r?l:l+(2===r?-aG(e,["border"],i):aG(e,["margin"],i)):s+aG(e,rG.slice(r),i)}tG(["Width","Height"],(function(e){oG["doc".concat(e)]=function(t){var n=t.document;return Math.max(n.documentElement["scroll".concat(e)],n.body["scroll".concat(e)],oG["viewport".concat(e)](n))},oG["viewport".concat(e)]=function(t){var n="client".concat(e),r=t.document,i=r.body,a=r.documentElement[n];return"CSS1Compat"===r.compatMode&&a||i&&i[n]||a}}));var uG={position:"absolute",visibility:"hidden",display:"block"};function lG(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,i=t[0];return 0!==i.offsetWidth?r=sG.apply(void 0,t):iG(i,uG,(function(){r=sG.apply(void 0,t)})),r}function cG(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}tG(["width","height"],(function(e){var t=e.charAt(0).toUpperCase()+e.slice(1);oG["outer".concat(t)]=function(t,n){return t&&lG(t,e,n?0:1)};var n="width"===e?["Left","Right"]:["Top","Bottom"];oG[e]=function(t,r){var i=r;return void 0!==i?t?(nG(t)&&(i+=aG(t,["padding","border"],n)),GV(t,e,i)):void 0:t&&lG(t,e,-1)}}));var hG={getWindow:function(e){if(e&&e.document&&e.setTimeout)return e;var t=e.ownerDocument||e;return t.defaultView||t.parentWindow},getDocument:XV,offset:function(e,t,n){if("undefined"===typeof t)return ZV(e);!function(e,t,n){if(n.ignoreShake){var r=ZV(e),i=r.left.toFixed(0),a=r.top.toFixed(0),o=t.left.toFixed(0),s=t.top.toFixed(0);if(i===o&&a===s)return}n.useCssRight||n.useCssBottom?$V(e,t,n):n.useCssTransform&&IV()in document.body.style?eG(e,t):$V(e,t,n)}(e,t,n||{})},isWindow:qV,each:tG,css:GV,clone:function(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);if(e.overflow)for(t in e)e.hasOwnProperty(t)&&(n.overflow[t]=e.overflow[t]);return n},mix:cG,getWindowScrollLeft:function(e){return HV(e)},getWindowScrollTop:function(e){return WV(e)},merge:function(){for(var e={},t=0;t<arguments.length;t++)hG.mix(e,t<0||arguments.length<=t?void 0:arguments[t]);return e},viewportWidth:0,viewportHeight:0};cG(hG,oG);var fG=hG.getParent;function dG(e){if(hG.isWindow(e)||9===e.nodeType)return null;var t,n=hG.getDocument(e).body,r=hG.css(e,"position");if(!("fixed"===r||"absolute"===r))return"html"===e.nodeName.toLowerCase()?null:fG(e);for(t=fG(e);t&&t!==n&&9!==t.nodeType;t=fG(t))if("static"!==(r=hG.css(t,"position")))return t;return null}var pG=hG.getParent;function vG(e,t){for(var n={left:0,right:1/0,top:0,bottom:1/0},r=dG(e),i=hG.getDocument(e),a=i.defaultView||i.parentWindow,o=i.body,s=i.documentElement;r;){if(-1!==navigator.userAgent.indexOf("MSIE")&&0===r.clientWidth||r===o||r===s||"visible"===hG.css(r,"overflow")){if(r===o||r===s)break}else{var u=hG.offset(r);u.left+=r.clientLeft,u.top+=r.clientTop,n.top=Math.max(n.top,u.top),n.right=Math.min(n.right,u.left+r.clientWidth),n.bottom=Math.min(n.bottom,u.top+r.clientHeight),n.left=Math.max(n.left,u.left)}r=dG(r)}var l=null;hG.isWindow(e)||9===e.nodeType||(l=e.style.position,"absolute"===hG.css(e,"position")&&(e.style.position="fixed"));var c=hG.getWindowScrollLeft(a),h=hG.getWindowScrollTop(a),f=hG.viewportWidth(a),d=hG.viewportHeight(a),p=s.scrollWidth,v=s.scrollHeight,m=window.getComputedStyle(o);if("hidden"===m.overflowX&&(p=a.innerWidth),"hidden"===m.overflowY&&(v=a.innerHeight),e.style&&(e.style.position=l),t||function(e){if(hG.isWindow(e)||9===e.nodeType)return!1;var t=hG.getDocument(e),n=t.body,r=null;for(r=pG(e);r&&r!==n&&r!==t;r=pG(r))if("fixed"===hG.css(r,"position"))return!0;return!1}(e))n.left=Math.max(n.left,c),n.top=Math.max(n.top,h),n.right=Math.min(n.right,c+f),n.bottom=Math.min(n.bottom,h+d);else{var g=Math.max(p,c+f);n.right=Math.min(n.right,g);var y=Math.max(v,h+d);n.bottom=Math.min(n.bottom,y)}return n.top>=0&&n.left>=0&&n.bottom>n.top&&n.right>n.left?n:null}function mG(e){var t,n,r;if(hG.isWindow(e)||9===e.nodeType){var i=hG.getWindow(e);t={left:hG.getWindowScrollLeft(i),top:hG.getWindowScrollTop(i)},n=hG.viewportWidth(i),r=hG.viewportHeight(i)}else t=hG.offset(e),n=hG.outerWidth(e),r=hG.outerHeight(e);return t.width=n,t.height=r,t}function gG(e,t){var n=t.charAt(0),r=t.charAt(1),i=e.width,a=e.height,o=e.left,s=e.top;return"c"===n?s+=a/2:"b"===n&&(s+=a),"c"===r?o+=i/2:"r"===r&&(o+=i),{left:o,top:s}}function yG(e,t,n,r,i){var a=gG(t,n[1]),o=gG(e,n[0]),s=[o.left-a.left,o.top-a.top];return{left:Math.round(e.left-s[0]+r[0]-i[0]),top:Math.round(e.top-s[1]+r[1]-i[1])}}function bG(e,t,n){return e.left<n.left||e.left+t.width>n.right}function _G(e,t,n){return e.top<n.top||e.top+t.height>n.bottom}function xG(e,t,n){var r=[];return hG.each(e,(function(e){r.push(e.replace(t,(function(e){return n[e]})))})),r}function wG(e,t){return e[t]=-e[t],e}function SG(e,t){return(/%$/.test(e)?parseInt(e.substring(0,e.length-1),10)/100*t:parseInt(e,10))||0}function MG(e,t){e[0]=SG(e[0],t.width),e[1]=SG(e[1],t.height)}function kG(e,t,n,r){var i=n.points,a=n.offset||[0,0],o=n.targetOffset||[0,0],s=n.overflow,u=n.source||e;a=[].concat(a),o=[].concat(o);var l={},c=0,h=vG(u,!(!(s=s||{})||!s.alwaysByViewport)),f=mG(u);MG(a,f),MG(o,t);var d=yG(f,t,i,a,o),p=hG.merge(f,d);if(h&&(s.adjustX||s.adjustY)&&r){if(s.adjustX&&bG(d,f,h)){var v=xG(i,/[lr]/gi,{l:"r",r:"l"}),m=wG(a,0),g=wG(o,0);(function(e,t,n){return e.left>n.right||e.left+t.width<n.left})(yG(f,t,v,m,g),f,h)||(c=1,i=v,a=m,o=g)}if(s.adjustY&&_G(d,f,h)){var y=xG(i,/[tb]/gi,{t:"b",b:"t"}),b=wG(a,1),_=wG(o,1);(function(e,t,n){return e.top>n.bottom||e.top+t.height<n.top})(yG(f,t,y,b,_),f,h)||(c=1,i=y,a=b,o=_)}c&&(d=yG(f,t,i,a,o),hG.mix(p,d));var x=bG(d,f,h),w=_G(d,f,h);if(x||w){var S=i;x&&(S=xG(i,/[lr]/gi,{l:"r",r:"l"})),w&&(S=xG(i,/[tb]/gi,{t:"b",b:"t"})),i=S,a=n.offset||[0,0],o=n.targetOffset||[0,0]}l.adjustX=s.adjustX&&x,l.adjustY=s.adjustY&&w,(l.adjustX||l.adjustY)&&(p=function(e,t,n,r){var i=hG.clone(e),a={width:t.width,height:t.height};return r.adjustX&&i.left<n.left&&(i.left=n.left),r.resizeWidth&&i.left>=n.left&&i.left+a.width>n.right&&(a.width-=i.left+a.width-n.right),r.adjustX&&i.left+a.width>n.right&&(i.left=Math.max(n.right-a.width,n.left)),r.adjustY&&i.top<n.top&&(i.top=n.top),r.resizeHeight&&i.top>=n.top&&i.top+a.height>n.bottom&&(a.height-=i.top+a.height-n.bottom),r.adjustY&&i.top+a.height>n.bottom&&(i.top=Math.max(n.bottom-a.height,n.top)),hG.mix(i,a)}(d,f,h,l))}return p.width!==f.width&&hG.css(u,"width",hG.width(u)+p.width-f.width),p.height!==f.height&&hG.css(u,"height",hG.height(u)+p.height-f.height),hG.offset(u,{left:p.left,top:p.top},{useCssRight:n.useCssRight,useCssBottom:n.useCssBottom,useCssTransform:n.useCssTransform,ignoreShake:n.ignoreShake}),{points:i,offset:a,targetOffset:o,overflow:l}}function TG(e,t,n){var r=n.target||t,i=mG(r),a=!function(e,t){var n=vG(e,t),r=mG(e);return!n||r.left+r.width<=n.left||r.top+r.height<=n.top||r.left>=n.right||r.top>=n.bottom}(r,n.overflow&&n.overflow.alwaysByViewport);return kG(e,i,n,a)}TG.__getOffsetParent=dG,TG.__getVisibleRectForElement=vG;var EG=n(8111),CG=n.n(EG);function AG(e,t){var n=null,r=null;var i=new gz((function(e){var i=vr(e,1)[0].target;if(document.documentElement.contains(i)){var a=i.getBoundingClientRect(),o=a.width,s=a.height,u=Math.floor(o),l=Math.floor(s);n===u&&r===l||Promise.resolve().then((function(){t({width:u,height:l})})),n=u,r=l}}));return e&&i.observe(e),function(){i.disconnect()}}function RG(e){return"function"!==typeof e?null:e()}function PG(e){return"object"===(0,hr.Z)(e)&&e?e:null}var LG=function(e,n){var r=e.children,i=e.disabled,a=e.target,o=e.align,s=e.onAlign,u=e.monitorWindowResize,l=e.monitorBufferTime,c=void 0===l?0:l,h=t.useRef({}),f=t.useRef(),d=t.Children.only(r),p=t.useRef({});p.current.disabled=i,p.current.target=a,p.current.align=o,p.current.onAlign=s;var v=function(e,n){var r=t.useRef(!1),i=t.useRef(null);function a(){window.clearTimeout(i.current)}return[function t(o){if(a(),r.current&&!0!==o)i.current=window.setTimeout((function(){r.current=!1,t()}),n);else{if(!1===e())return;r.current=!0,i.current=window.setTimeout((function(){r.current=!1}),n)}},function(){r.current=!1,a()}]}((function(){var e=p.current,t=e.disabled,n=e.target,r=e.align,i=e.onAlign;if(!t&&n){var a,o=f.current,s=RG(n),u=PG(n);h.current.element=s,h.current.point=u,h.current.align=r;var l=document.activeElement;return s&&EV(s)?a=TG(o,s,r):u&&(a=function(e,t,n){var r,i,a=hG.getDocument(e),o=a.defaultView||a.parentWindow,s=hG.getWindowScrollLeft(o),u=hG.getWindowScrollTop(o),l=hG.viewportWidth(o),c=hG.viewportHeight(o),h={left:r="pageX"in t?t.pageX:s+t.clientX,top:i="pageY"in t?t.pageY:u+t.clientY,width:0,height:0},f=r>=0&&r<=s+l&&i>=0&&i<=u+c,d=[n.points[0],"cc"];return kG(e,h,AV(AV({},n),{},{points:d}),f)}(o,u,r)),function(e,t){e!==document.activeElement&&DB(t,e)&&"function"===typeof e.focus&&e.focus()}(l,o),i&&a&&i(o,a),!0}return!1}),c),m=vr(v,2),g=m[0],y=m[1],b=t.useRef({cancel:function(){}}),_=t.useRef({cancel:function(){}});t.useEffect((function(){var e=RG(a),t=PG(a);f.current!==_.current.element&&(_.current.cancel(),_.current.element=f.current,_.current.cancel=AG(f.current,g)),h.current.element===e&&function(e,t){return e===t||!(!e||!t)&&("pageX"in t&&"pageY"in t?e.pageX===t.pageX&&e.pageY===t.pageY:"clientX"in t&&"clientY"in t&&e.clientX===t.clientX&&e.clientY===t.clientY)}(h.current.point,t)&&CG()(h.current.align,o)||(g(),b.current.element!==e&&(b.current.cancel(),b.current.element=e,b.current.cancel=AG(e,g)))})),t.useEffect((function(){i?y():g()}),[i]);var x=t.useRef(null);return t.useEffect((function(){u?x.current||(x.current=NB(window,"resize",g)):x.current&&(x.current.remove(),x.current=null)}),[u]),t.useEffect((function(){return function(){b.current.cancel(),_.current.cancel(),x.current&&x.current.remove(),y()}}),[]),t.useImperativeHandle(n,(function(){return{forceAlign:function(){return g(!0)}}})),t.isValidElement(d)&&(d=t.cloneElement(d,{ref:ZF(d.ref,f)})),d},DG=t.forwardRef(LG);DG.displayName="Align";var NG=DG,IG=["measure","alignPre","align",null,"motion"],OG=t.forwardRef((function(e,n){var r=e.visible,i=e.prefixCls,a=e.className,o=e.style,s=e.children,u=e.zIndex,l=e.stretch,c=e.destroyPopupOnHide,h=e.forceRender,f=e.align,d=e.point,p=e.getRootDomNode,v=e.getClassNameFromAlign,m=e.onAlign,g=e.onMouseEnter,y=e.onMouseLeave,b=e.onMouseDown,_=e.onTouchStart,x=e.onClick,w=(0,t.useRef)(),S=(0,t.useRef)(),M=vr((0,t.useState)(),2),k=M[0],T=M[1],E=function(e){var n=vr(t.useState({width:0,height:0}),2),r=n[0],i=n[1],a=t.useMemo((function(){var t={};if(e){var n=r.width,i=r.height;-1!==e.indexOf("height")&&i?t.height=i:-1!==e.indexOf("minHeight")&&i&&(t.minHeight=i),-1!==e.indexOf("width")&&n?t.width=n:-1!==e.indexOf("minWidth")&&n&&(t.minWidth=n)}return t}),[e,r]);return[a,function(e){i({width:e.offsetWidth,height:e.offsetHeight})}]}(l),C=vr(E,2),A=C[0],R=C[1];var P=function(e,n){var r=vr(LF(null),2),i=r[0],a=r[1],o=(0,t.useRef)();function s(e){a(e,!0)}function u(){BF.cancel(o.current)}return(0,t.useEffect)((function(){s("measure")}),[e]),(0,t.useEffect)((function(){"measure"===i&&n(),i&&(o.current=BF(pr(fr().mark((function e(){var t,n;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=IG.indexOf(i),(n=IG[t+1])&&-1!==t&&s(n);case 3:case"end":return e.stop()}}),e)})))))}),[i]),(0,t.useEffect)((function(){return function(){u()}}),[]),[i,function(e){u(),o.current=BF((function(){s((function(e){switch(i){case"align":return"motion";case"motion":return"stable"}return e})),null===e||void 0===e||e()}))}]}(r,(function(){l&&R(p())})),L=vr(P,2),D=L[0],N=L[1],I=vr((0,t.useState)(0),2),O=I[0],U=I[1],F=(0,t.useRef)();function z(){var e;null===(e=w.current)||void 0===e||e.forceAlign()}function B(e,t){var n=v(t);k!==n&&T(n),U((function(e){return e+1})),"align"===D&&(null===m||void 0===m||m(e,t))}PF((function(){"alignPre"===D&&U(0)}),[D]),PF((function(){"align"===D&&(O<2?z():N((function(){var e;null===(e=F.current)||void 0===e||e.call(F)})))}),[O]);var V=Mr({},MV(e));function G(){return new Promise((function(e){F.current=e}))}["onAppearEnd","onEnterEnd","onLeaveEnd"].forEach((function(e){var t=V[e];V[e]=function(e,n){return N(),null===t||void 0===t?void 0:t(e,n)}})),t.useEffect((function(){V.motionName||"motion"!==D||N()}),[V.motionName,D]),t.useImperativeHandle(n,(function(){return{forceAlign:z,getElement:function(){return S.current}}}));var j=Mr(Mr({},A),{},{zIndex:u,opacity:"motion"!==D&&"stable"!==D&&r?0:void 0,pointerEvents:r||"stable"===D?void 0:"none"},o),H=!0;!(null===f||void 0===f?void 0:f.points)||"align"!==D&&"stable"!==D||(H=!1);var W=s;return t.Children.count(s)>1&&(W=t.createElement("div",{className:"".concat(i,"-content")},s)),t.createElement(SV,bF({visible:r,ref:S,leavedClassName:"".concat(i,"-hidden")},V,{onAppearPrepare:G,onEnterPrepare:G,removeOnLeave:c,forceRender:h}),(function(e,n){var r=e.className,o=e.style,s=SF()(i,a,k,r);return t.createElement(NG,{target:d||p,key:"popup",ref:w,monitorWindowResize:!0,disabled:H,align:f,onAlign:B},t.createElement("div",{ref:n,className:s,onMouseEnter:g,onMouseLeave:y,onMouseDownCapture:b,onTouchStartCapture:_,onClick:x,style:Mr(Mr({},o),j)},W))}))}));OG.displayName="PopupInner";var UG=OG,FG=t.forwardRef((function(e,n){var r=e.prefixCls,i=e.visible,a=e.zIndex,o=e.children,s=e.mobile,u=(s=void 0===s?{}:s).popupClassName,l=s.popupStyle,c=s.popupMotion,h=void 0===c?{}:c,f=s.popupRender,d=e.onClick,p=t.useRef();t.useImperativeHandle(n,(function(){return{forceAlign:function(){},getElement:function(){return p.current}}}));var v=Mr({zIndex:a},l),m=o;return t.Children.count(o)>1&&(m=t.createElement("div",{className:"".concat(r,"-content")},o)),f&&(m=f(m)),t.createElement(SV,bF({visible:i,ref:p,removeOnLeave:!0},h),(function(e,n){var i=e.className,a=e.style,o=SF()(r,u,i);return t.createElement("div",{ref:n,className:o,onClick:d,style:Mr(Mr({},a),v)},m)}))}));FG.displayName="MobilePopupInner";var zG=FG,BG=["visible","mobile"],VG=t.forwardRef((function(e,n){var r=e.visible,i=e.mobile,a=xF(e,BG),o=vr((0,t.useState)(r),2),s=o[0],u=o[1],l=vr((0,t.useState)(!1),2),c=l[0],h=l[1],f=Mr(Mr({},a),{},{visible:s});(0,t.useEffect)((function(){u(r),r&&i&&h(TF())}),[r,i]);var d=c?t.createElement(zG,bF({},f,{mobile:i,ref:n})):t.createElement(UG,bF({},f,{ref:n}));return t.createElement("div",null,t.createElement(kV,f),d)}));VG.displayName="Popup";var GG=VG,jG=t.createContext(null);function HG(){}function WG(){return""}function ZG(e){return e?e.ownerDocument:window.document}var qG=["onClick","onMouseDown","onTouchStart","onMouseEnter","onMouseLeave","onFocus","onBlur","onContextMenu"];var XG=function(e){var n=function(n){(0,h.Z)(i,n);var r=(0,f.Z)(i);function i(e){var n,a;return(0,u.Z)(this,i),(n=r.call(this,e)).popupRef=t.createRef(),n.triggerRef=t.createRef(),n.portalContainer=void 0,n.attachId=void 0,n.clickOutsideHandler=void 0,n.touchOutsideHandler=void 0,n.contextMenuOutsideHandler1=void 0,n.contextMenuOutsideHandler2=void 0,n.mouseDownTimeout=void 0,n.focusTime=void 0,n.preClickTime=void 0,n.preTouchTime=void 0,n.delayTimer=void 0,n.hasPopupMouseDown=void 0,n.onMouseEnter=function(e){var t=n.props.mouseEnterDelay;n.fireEvents("onMouseEnter",e),n.delaySetPopupVisible(!0,t,t?null:e)},n.onMouseMove=function(e){n.fireEvents("onMouseMove",e),n.setPoint(e)},n.onMouseLeave=function(e){n.fireEvents("onMouseLeave",e),n.delaySetPopupVisible(!1,n.props.mouseLeaveDelay)},n.onPopupMouseEnter=function(){n.clearDelayTimer()},n.onPopupMouseLeave=function(e){var t;e.relatedTarget&&!e.relatedTarget.setTimeout&&DB(null===(t=n.popupRef.current)||void 0===t?void 0:t.getElement(),e.relatedTarget)||n.delaySetPopupVisible(!1,n.props.mouseLeaveDelay)},n.onFocus=function(e){n.fireEvents("onFocus",e),n.clearDelayTimer(),n.isFocusToShow()&&(n.focusTime=Date.now(),n.delaySetPopupVisible(!0,n.props.focusDelay))},n.onMouseDown=function(e){n.fireEvents("onMouseDown",e),n.preClickTime=Date.now()},n.onTouchStart=function(e){n.fireEvents("onTouchStart",e),n.preTouchTime=Date.now()},n.onBlur=function(e){n.fireEvents("onBlur",e),n.clearDelayTimer(),n.isBlurToHide()&&n.delaySetPopupVisible(!1,n.props.blurDelay)},n.onContextMenu=function(e){e.preventDefault(),n.fireEvents("onContextMenu",e),n.setPopupVisible(!0,e)},n.onContextMenuClose=function(){n.isContextMenuToShow()&&n.close()},n.onClick=function(e){if(n.fireEvents("onClick",e),n.focusTime){var t;if(n.preClickTime&&n.preTouchTime?t=Math.min(n.preClickTime,n.preTouchTime):n.preClickTime?t=n.preClickTime:n.preTouchTime&&(t=n.preTouchTime),Math.abs(t-n.focusTime)<20)return;n.focusTime=0}n.preClickTime=0,n.preTouchTime=0,n.isClickToShow()&&(n.isClickToHide()||n.isBlurToHide())&&e&&e.preventDefault&&e.preventDefault();var r=!n.state.popupVisible;(n.isClickToHide()&&!r||r&&n.isClickToShow())&&n.setPopupVisible(!n.state.popupVisible,e)},n.onPopupMouseDown=function(){var e;(n.hasPopupMouseDown=!0,clearTimeout(n.mouseDownTimeout),n.mouseDownTimeout=window.setTimeout((function(){n.hasPopupMouseDown=!1}),0),n.context)&&(e=n.context).onPopupMouseDown.apply(e,arguments)},n.onDocumentClick=function(e){if(!n.props.mask||n.props.maskClosable){var t=e.target,r=n.getRootDomNode(),i=n.getPopupDomNode();DB(r,t)&&!n.isContextMenuOnly()||DB(i,t)||n.hasPopupMouseDown||n.close()}},n.getRootDomNode=function(){var e=n.props.getTriggerDOMNode;if(e)return e(n.triggerRef.current);try{var t=YF(n.triggerRef.current);if(t)return t}catch(x2){}return XF.findDOMNode((0,c.Z)(n))},n.getPopupClassNameFromAlign=function(e){var t=[],r=n.props,i=r.popupPlacement,a=r.builtinPlacements,o=r.prefixCls,s=r.alignPoint,u=r.getPopupClassNameFromAlign;return i&&a&&t.push(function(e,t,n,r){for(var i=n.points,a=Object.keys(e),o=0;o<a.length;o+=1){var s=a[o];if(UB(e[s].points,i,r))return"".concat(t,"-placement-").concat(s)}return""}(a,o,e,s)),u&&t.push(u(e)),t.join(" ")},n.getComponent=function(){var e=n.props,r=e.prefixCls,i=e.destroyPopupOnHide,a=e.popupClassName,o=e.onPopupAlign,s=e.popupMotion,u=e.popupAnimation,l=e.popupTransitionName,c=e.popupStyle,h=e.mask,f=e.maskAnimation,d=e.maskTransitionName,p=e.maskMotion,v=e.zIndex,m=e.popup,g=e.stretch,y=e.alignPoint,b=e.mobile,_=e.forceRender,x=e.onPopupClick,w=n.state,S=w.popupVisible,M=w.point,k=n.getPopupAlign(),T={};return n.isMouseEnterToShow()&&(T.onMouseEnter=n.onPopupMouseEnter),n.isMouseLeaveToHide()&&(T.onMouseLeave=n.onPopupMouseLeave),T.onMouseDown=n.onPopupMouseDown,T.onTouchStart=n.onPopupMouseDown,t.createElement(GG,bF({prefixCls:r,destroyPopupOnHide:i,visible:S,point:y&&M,className:a,align:k,onAlign:o,animation:u,getClassNameFromAlign:n.getPopupClassNameFromAlign},T,{stretch:g,getRootDomNode:n.getRootDomNode,style:c,mask:h,zIndex:v,transitionName:l,maskAnimation:f,maskTransitionName:d,maskMotion:p,ref:n.popupRef,motion:s,mobile:b,forceRender:_,onClick:x}),"function"===typeof m?m():m)},n.attachParent=function(e){BF.cancel(n.attachId);var t,r=n.props,i=r.getPopupContainer,a=r.getDocument,o=n.getRootDomNode();i?(o||0===i.length)&&(t=i(o)):t=a(n.getRootDomNode()).body,t?t.appendChild(e):n.attachId=BF((function(){n.attachParent(e)}))},n.getContainer=function(){if(!n.portalContainer){var e=(0,n.props.getDocument)(n.getRootDomNode()).createElement("div");e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",n.portalContainer=e}return n.attachParent(n.portalContainer),n.portalContainer},n.setPoint=function(e){n.props.alignPoint&&e&&n.setState({point:{pageX:e.pageX,pageY:e.pageY}})},n.handlePortalUpdate=function(){n.state.prevPopupVisible!==n.state.popupVisible&&n.props.afterPopupVisibleChange(n.state.popupVisible)},n.triggerContextValue={onPopupMouseDown:n.onPopupMouseDown},a="popupVisible"in e?!!e.popupVisible:!!e.defaultPopupVisible,n.state={prevPopupVisible:a,popupVisible:a},qG.forEach((function(e){n["fire".concat(e)]=function(t){n.fireEvents(e,t)}})),n}return(0,l.Z)(i,[{key:"componentDidMount",value:function(){this.componentDidUpdate()}},{key:"componentDidUpdate",value:function(){var e,t=this.props;if(this.state.popupVisible)return this.clickOutsideHandler||!this.isClickToHide()&&!this.isContextMenuToShow()||(e=t.getDocument(this.getRootDomNode()),this.clickOutsideHandler=NB(e,"mousedown",this.onDocumentClick)),this.touchOutsideHandler||(e=e||t.getDocument(this.getRootDomNode()),this.touchOutsideHandler=NB(e,"touchstart",this.onDocumentClick)),!this.contextMenuOutsideHandler1&&this.isContextMenuToShow()&&(e=e||t.getDocument(this.getRootDomNode()),this.contextMenuOutsideHandler1=NB(e,"scroll",this.onContextMenuClose)),void(!this.contextMenuOutsideHandler2&&this.isContextMenuToShow()&&(this.contextMenuOutsideHandler2=NB(window,"blur",this.onContextMenuClose)));this.clearOutsideHandler()}},{key:"componentWillUnmount",value:function(){this.clearDelayTimer(),this.clearOutsideHandler(),clearTimeout(this.mouseDownTimeout),BF.cancel(this.attachId)}},{key:"getPopupDomNode",value:function(){var e;return(null===(e=this.popupRef.current)||void 0===e?void 0:e.getElement())||null}},{key:"getPopupAlign",value:function(){var e=this.props,t=e.popupPlacement,n=e.popupAlign,r=e.builtinPlacements;return t&&r?function(e,t,n){return Mr(Mr({},e[t]||{}),n)}(r,t,n):n}},{key:"setPopupVisible",value:function(e,t){var n=this.props.alignPoint,r=this.state.popupVisible;this.clearDelayTimer(),r!==e&&("popupVisible"in this.props||this.setState({popupVisible:e,prevPopupVisible:r}),this.props.onPopupVisibleChange(e)),n&&t&&e&&this.setPoint(t)}},{key:"delaySetPopupVisible",value:function(e,t,n){var r=this,i=1e3*t;if(this.clearDelayTimer(),i){var a=n?{pageX:n.pageX,pageY:n.pageY}:null;this.delayTimer=window.setTimeout((function(){r.setPopupVisible(e,a),r.clearDelayTimer()}),i)}else this.setPopupVisible(e,n)}},{key:"clearDelayTimer",value:function(){this.delayTimer&&(clearTimeout(this.delayTimer),this.delayTimer=null)}},{key:"clearOutsideHandler",value:function(){this.clickOutsideHandler&&(this.clickOutsideHandler.remove(),this.clickOutsideHandler=null),this.contextMenuOutsideHandler1&&(this.contextMenuOutsideHandler1.remove(),this.contextMenuOutsideHandler1=null),this.contextMenuOutsideHandler2&&(this.contextMenuOutsideHandler2.remove(),this.contextMenuOutsideHandler2=null),this.touchOutsideHandler&&(this.touchOutsideHandler.remove(),this.touchOutsideHandler=null)}},{key:"createTwoChains",value:function(e){var t=this.props.children.props,n=this.props;return t[e]&&n[e]?this["fire".concat(e)]:t[e]||n[e]}},{key:"isClickToShow",value:function(){var e=this.props,t=e.action,n=e.showAction;return-1!==t.indexOf("click")||-1!==n.indexOf("click")}},{key:"isContextMenuOnly",value:function(){var e=this.props.action;return"contextMenu"===e||1===e.length&&"contextMenu"===e[0]}},{key:"isContextMenuToShow",value:function(){var e=this.props,t=e.action,n=e.showAction;return-1!==t.indexOf("contextMenu")||-1!==n.indexOf("contextMenu")}},{key:"isClickToHide",value:function(){var e=this.props,t=e.action,n=e.hideAction;return-1!==t.indexOf("click")||-1!==n.indexOf("click")}},{key:"isMouseEnterToShow",value:function(){var e=this.props,t=e.action,n=e.showAction;return-1!==t.indexOf("hover")||-1!==n.indexOf("mouseEnter")}},{key:"isMouseLeaveToHide",value:function(){var e=this.props,t=e.action,n=e.hideAction;return-1!==t.indexOf("hover")||-1!==n.indexOf("mouseLeave")}},{key:"isFocusToShow",value:function(){var e=this.props,t=e.action,n=e.showAction;return-1!==t.indexOf("focus")||-1!==n.indexOf("focus")}},{key:"isBlurToHide",value:function(){var e=this.props,t=e.action,n=e.hideAction;return-1!==t.indexOf("focus")||-1!==n.indexOf("blur")}},{key:"forcePopupAlign",value:function(){var e;this.state.popupVisible&&(null===(e=this.popupRef.current)||void 0===e||e.forceAlign())}},{key:"fireEvents",value:function(e,t){var n=this.props.children.props[e];n&&n(t);var r=this.props[e];r&&r(t)}},{key:"close",value:function(){this.setPopupVisible(!1)}},{key:"render",value:function(){var n=this.state.popupVisible,r=this.props,i=r.children,a=r.forceRender,o=r.alignPoint,s=r.className,u=r.autoDestroy,l=t.Children.only(i),c={key:"trigger"};this.isContextMenuToShow()?c.onContextMenu=this.onContextMenu:c.onContextMenu=this.createTwoChains("onContextMenu"),this.isClickToHide()||this.isClickToShow()?(c.onClick=this.onClick,c.onMouseDown=this.onMouseDown,c.onTouchStart=this.onTouchStart):(c.onClick=this.createTwoChains("onClick"),c.onMouseDown=this.createTwoChains("onMouseDown"),c.onTouchStart=this.createTwoChains("onTouchStart")),this.isMouseEnterToShow()?(c.onMouseEnter=this.onMouseEnter,o&&(c.onMouseMove=this.onMouseMove)):c.onMouseEnter=this.createTwoChains("onMouseEnter"),this.isMouseLeaveToHide()?c.onMouseLeave=this.onMouseLeave:c.onMouseLeave=this.createTwoChains("onMouseLeave"),this.isFocusToShow()||this.isBlurToHide()?(c.onFocus=this.onFocus,c.onBlur=this.onBlur):(c.onFocus=this.createTwoChains("onFocus"),c.onBlur=this.createTwoChains("onBlur"));var h=SF()(l&&l.props&&l.props.className,s);h&&(c.className=h);var f=Mr({},c);qF(l)&&(f.ref=ZF(this.triggerRef,l.ref));var d,p=t.cloneElement(l,f);return(n||this.popupRef.current||a)&&(d=t.createElement(e,{key:"portal",getContainer:this.getContainer,didUpdate:this.handlePortalUpdate},this.getComponent())),!n&&u&&(d=null),t.createElement(jG.Provider,{value:this.triggerContextValue},p,d)}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.popupVisible,r={};return void 0!==n&&t.popupVisible!==n&&(r.popupVisible=n,r.prevPopupVisible=t.popupVisible),r}}]),i}(t.Component);return n.contextType=jG,n.defaultProps={prefixCls:"rc-trigger-popup",getPopupClassNameFromAlign:WG,getDocument:ZG,onPopupVisibleChange:HG,afterPopupVisibleChange:HG,onPopupAlign:HG,popupClassName:"",mouseEnterDelay:0,mouseLeaveDelay:.1,focusDelay:0,blurDelay:.15,popupStyle:{},destroyPopupOnHide:!1,popupAlign:{},defaultPopupVisible:!1,mask:!1,maskClosable:!0,action:[],showAction:[],hideAction:[],autoDestroy:!1},n}(OB),YG={adjustX:1,adjustY:1},KG={topLeft:{points:["bl","tl"],overflow:YG,offset:[0,-7]},bottomLeft:{points:["tl","bl"],overflow:YG,offset:[0,7]},leftTop:{points:["tr","tl"],overflow:YG,offset:[-4,0]},rightTop:{points:["tl","tr"],overflow:YG,offset:[4,0]}},JG={topLeft:{points:["bl","tl"],overflow:YG,offset:[0,-7]},bottomLeft:{points:["tl","bl"],overflow:YG,offset:[0,7]},rightTop:{points:["tr","tl"],overflow:YG,offset:[-4,0]},leftTop:{points:["tl","tr"],overflow:YG,offset:[4,0]}};function QG(e,t,n){return t||(n?n[e]||n.other:void 0)}var $G={horizontal:"bottomLeft",vertical:"rightTop","vertical-left":"rightTop","vertical-right":"leftTop"};function ej(e){var n=e.prefixCls,r=e.visible,i=e.children,a=e.popup,o=e.popupClassName,s=e.popupOffset,u=e.disabled,l=e.mode,c=e.onVisibleChange,h=t.useContext(tB),f=h.getPopupContainer,d=h.rtl,p=h.subMenuOpenDelay,v=h.subMenuCloseDelay,m=h.builtinPlacements,g=h.triggerSubMenuAction,y=h.forceSubMenuRender,b=h.rootClassName,_=h.motion,x=h.defaultMotions,w=vr(t.useState(!1),2),S=w[0],M=w[1],k=Mr(Mr({},d?JG:KG),m),T=$G[l],E=Mr(Mr({},QG(l,_,x)),{},{leavedClassName:"".concat(n,"-hidden"),removeOnLeave:!1,motionAppear:!0}),C=t.useRef();return t.useEffect((function(){return C.current=BF((function(){M(r)})),function(){BF.cancel(C.current)}}),[r]),t.createElement(XG,{prefixCls:n,popupClassName:SF()("".concat(n,"-popup"),gr({},"".concat(n,"-rtl"),d),o,b),stretch:"horizontal"===l?"minWidth":null,getPopupContainer:f,builtinPlacements:k,popupPlacement:T,popupVisible:S,popup:a,popupAlign:s&&{offset:s},action:u?[]:[g],mouseEnterDelay:p,mouseLeaveDelay:v,onPopupVisibleChange:c,forceRender:y,popupMotion:E},i)}function tj(e){var n=e.id,r=e.open,i=e.keyPath,a=e.children,o="inline",s=t.useContext(tB),u=s.prefixCls,l=s.forceSubMenuRender,c=s.motion,h=s.defaultMotions,f=s.mode,d=t.useRef(!1);d.current=f===o;var p=vr(t.useState(!d.current),2),v=p[0],m=p[1],g=!!d.current&&r;t.useEffect((function(){d.current&&m(!1)}),[f]);var y=Mr({},QG(o,c,h));i.length>1&&(y.motionAppear=!1);var b=y.onVisibleChanged;return y.onVisibleChanged=function(e){return d.current||e||m(!0),null===b||void 0===b?void 0:b(e)},v?null:t.createElement(nB,{mode:o,locked:!d.current},t.createElement(SV,bF({visible:g},y,{forceRender:l,removeOnLeave:!1,leavedClassName:"".concat(u,"-hidden")}),(function(e){var r=e.className,i=e.style;return t.createElement(LB,{id:n,className:r,style:i},a)})))}var nj=["style","className","title","eventKey","warnKey","disabled","internalPopupClose","children","itemIcon","expandIcon","popupClassName","popupOffset","onClick","onMouseEnter","onMouseLeave","onTitleClick","onTitleMouseEnter","onTitleMouseLeave"],rj=["active"],ij=function(e){var n,r=e.style,i=e.className,a=e.title,o=e.eventKey,s=(e.warnKey,e.disabled),u=e.internalPopupClose,l=e.children,c=e.itemIcon,h=e.expandIcon,f=e.popupClassName,d=e.popupOffset,p=e.onClick,v=e.onMouseEnter,m=e.onMouseLeave,g=e.onTitleClick,y=e.onTitleMouseEnter,b=e.onTitleMouseLeave,_=xF(e,nj),x=mB(o),w=t.useContext(tB),S=w.prefixCls,M=w.mode,k=w.openKeys,T=w.disabled,E=w.overflowDisabled,C=w.activeKey,A=w.selectedKeys,R=w.itemIcon,P=w.expandIcon,L=w.onItemClick,D=w.onOpenChange,N=w.onActive,I=t.useContext(gB)._internalRenderSubMenuItem,O=t.useContext(dB).isSubPathKey,U=fB(),F="".concat(S,"-submenu"),z=T||s,B=t.useRef(),V=t.useRef();var G=c||R,j=h||P,H=k.includes(o),W=!E&&H,Z=O(A,o),q=rB(o,z,y,b),X=q.active,Y=xF(q,rj),K=vr(t.useState(!1),2),J=K[0],Q=K[1],$=function(e){z||Q(e)},ee=t.useMemo((function(){return X||"inline"!==M&&(J||O([C],o))}),[M,X,C,J,o,O]),te=sB(U.length),ne=CB((function(e){null===p||void 0===p||p(aB(e)),L(e)})),re=x&&"".concat(x,"-popup"),ie=t.createElement("div",bF({role:"menuitem",style:te,className:"".concat(F,"-title"),tabIndex:z?null:-1,ref:B,title:"string"===typeof a?a:null,"data-menu-id":E&&x?null:x,"aria-expanded":W,"aria-haspopup":!0,"aria-controls":re,"aria-disabled":z,onClick:function(e){z||(null===g||void 0===g||g({key:o,domEvent:e}),"inline"===M&&D(o,!H))},onFocus:function(){N(o)}},Y),a,t.createElement(oB,{icon:"horizontal"!==M?j:null,props:Mr(Mr({},e),{},{isOpen:W,isSubMenu:!0})},t.createElement("i",{className:"".concat(F,"-arrow")}))),ae=t.useRef(M);if("inline"!==M&&(ae.current=U.length>1?"vertical":M),!E){var oe=ae.current;ie=t.createElement(ej,{mode:oe,prefixCls:F,visible:!u&&W&&"inline"!==M,popupClassName:f,popupOffset:d,popup:t.createElement(nB,{mode:"horizontal"===oe?"vertical":oe},t.createElement(LB,{id:re,ref:V},l)),disabled:z,onVisibleChange:function(e){"inline"!==M&&D(o,e)}},ie)}var se=t.createElement(Qz.Item,bF({role:"none"},_,{component:"li",style:r,className:SF()(F,"".concat(F,"-").concat(M),i,(n={},gr(n,"".concat(F,"-open"),W),gr(n,"".concat(F,"-active"),ee),gr(n,"".concat(F,"-selected"),Z),gr(n,"".concat(F,"-disabled"),z),n)),onMouseEnter:function(e){$(!0),null===v||void 0===v||v({key:o,domEvent:e})},onMouseLeave:function(e){$(!1),null===m||void 0===m||m({key:o,domEvent:e})}}),ie,!E&&t.createElement(tj,{id:re,open:W,keyPath:U},l));return I&&(se=I(se,e,{selected:Z,active:ee,open:W,disabled:z})),t.createElement(nB,{onItemClick:ne,mode:"horizontal"===M?"vertical":M,itemIcon:G,expandIcon:j},se)};function aj(e){var n,r=e.eventKey,i=e.children,a=fB(r),o=kB(i,a),s=cB();return t.useEffect((function(){if(s)return s.registerPath(r,a),function(){s.unregisterPath(r,a)}}),[a]),n=s?o:t.createElement(ij,e,o),t.createElement(hB.Provider,{value:a},n)}function oj(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(EV(e)){var n=e.nodeName.toLowerCase(),r=["input","select","textarea","button"].includes(n)||e.isContentEditable||"a"===n&&!!e.getAttribute("href"),i=e.getAttribute("tabindex"),a=Number(i),o=null;return i&&!Number.isNaN(a)?o=a:r&&null===o&&(o=0),r&&e.disabled&&(o=null),null!==o&&(o>=0||t&&o<0)}return!1}function sj(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=cr(e.querySelectorAll("*")).filter((function(e){return oj(e,t)}));return oj(e,t)&&n.unshift(e),n}var uj=Ez.LEFT,lj=Ez.RIGHT,cj=Ez.UP,hj=Ez.DOWN,fj=Ez.ENTER,dj=Ez.ESC,pj=Ez.HOME,vj=Ez.END,mj=[cj,hj,uj,lj];function gj(e,t){return sj(e,!0).filter((function(e){return t.has(e)}))}function yj(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(!e)return null;var i=gj(e,t),a=i.length,o=i.findIndex((function(e){return n===e}));return r<0?-1===o?o=a-1:o-=1:r>0&&(o+=1),i[o=(o+a)%a]}function bj(e,n,r,i,a,o,s,u,l,c){var h=t.useRef(),f=t.useRef();f.current=n;var d=function(){BF.cancel(h.current)};return t.useEffect((function(){return function(){d()}}),[]),function(t){var p=t.which;if([].concat(mj,[fj,dj,pj,vj]).includes(p)){var v,m,g,y=function(){return v=new Set,m=new Map,g=new Map,o().forEach((function(e){var t=document.querySelector("[data-menu-id='".concat(vB(i,e),"']"));t&&(v.add(t),g.set(t,e),m.set(e,t))})),v};y();var b=function(e,t){for(var n=e||document.activeElement;n;){if(t.has(n))return n;n=n.parentElement}return null}(m.get(n),v),_=g.get(b),x=function(e,t,n,r){var i,a,o,s,u="prev",l="next",c="children",h="parent";if("inline"===e&&r===fj)return{inlineTrigger:!0};var f=(gr(i={},cj,u),gr(i,hj,l),i),d=(gr(a={},uj,n?l:u),gr(a,lj,n?u:l),gr(a,hj,c),gr(a,fj,c),a),p=(gr(o={},cj,u),gr(o,hj,l),gr(o,fj,c),gr(o,dj,h),gr(o,uj,n?c:h),gr(o,lj,n?h:c),o);switch(null===(s={inline:f,horizontal:d,vertical:p,inlineSub:f,horizontalSub:p,verticalSub:p}["".concat(e).concat(t?"":"Sub")])||void 0===s?void 0:s[r]){case u:return{offset:-1,sibling:!0};case l:return{offset:1,sibling:!0};case h:return{offset:-1,sibling:!1};case c:return{offset:1,sibling:!1};default:return null}}(e,1===s(_,!0).length,r,p);if(!x&&p!==pj&&p!==vj)return;(mj.includes(p)||[pj,vj].includes(p))&&t.preventDefault();var w=function(e){if(e){var t=e,n=e.querySelector("a");(null===n||void 0===n?void 0:n.getAttribute("href"))&&(t=n);var r=g.get(e);u(r),d(),h.current=BF((function(){f.current===r&&t.focus()}))}};if([pj,vj].includes(p)||x.sibling||!b){var S,M,k=gj(S=b&&"inline"!==e?function(e){for(var t=e;t;){if(t.getAttribute("data-menu-list"))return t;t=t.parentElement}return null}(b):a.current,v);M=p===pj?k[0]:p===vj?k[k.length-1]:yj(S,v,b,x.offset),w(M)}else if(x.inlineTrigger)l(_);else if(x.offset>0)l(_,!0),d(),h.current=BF((function(){y();var e=b.getAttribute("aria-controls"),t=yj(document.getElementById(e),v);w(t)}),5);else if(x.offset<0){var T=s(_,!0),E=T[T.length-2],C=m.get(E);l(E,!1),w(C)}}null===c||void 0===c||c(t)}}var _j=Math.random().toFixed(5).toString().slice(2),xj=0;var wj="__RC_UTIL_PATH_SPLIT__",Sj=function(e){return e.join(wj)},Mj="rc-menu-more";function kj(){var e=vr(t.useState({}),2)[1],n=(0,t.useRef)(new Map),r=(0,t.useRef)(new Map),i=vr(t.useState([]),2),a=i[0],o=i[1],s=(0,t.useRef)(0),u=(0,t.useRef)(!1),l=(0,t.useCallback)((function(t,i){var a=Sj(i);r.current.set(a,t),n.current.set(t,a),s.current+=1;var o,l=s.current;o=function(){l===s.current&&(u.current||e({}))},Promise.resolve().then(o)}),[]),c=(0,t.useCallback)((function(e,t){var i=Sj(t);r.current.delete(i),n.current.delete(e)}),[]),h=(0,t.useCallback)((function(e){o(e)}),[]),f=(0,t.useCallback)((function(e,t){var r=n.current.get(e)||"",i=r.split(wj);return t&&a.includes(i[0])&&i.unshift(Mj),i}),[a]),d=(0,t.useCallback)((function(e,t){return e.some((function(e){return f(e,!0).includes(t)}))}),[f]),p=(0,t.useCallback)((function(e){var t="".concat(n.current.get(e)).concat(wj),i=new Set;return cr(r.current.keys()).forEach((function(e){e.startsWith(t)&&i.add(r.current.get(e))})),i}),[]);return t.useEffect((function(){return function(){u.current=!0}}),[]),{registerPath:l,unregisterPath:c,refreshOverflowKeys:h,isSubPathKey:d,getKeyPath:f,getKeys:function(){var e=cr(n.current.keys());return a.length&&e.push(Mj),e},getSubPathKeys:p}}var Tj=["prefixCls","rootClassName","style","className","tabIndex","items","children","direction","id","mode","inlineCollapsed","disabled","disabledOverflow","subMenuOpenDelay","subMenuCloseDelay","forceSubMenuRender","defaultOpenKeys","openKeys","activeKey","defaultActiveFirst","selectable","multiple","defaultSelectedKeys","selectedKeys","onSelect","onDeselect","inlineIndent","motion","defaultMotions","triggerSubMenuAction","builtinPlacements","itemIcon","expandIcon","overflowedIndicator","overflowedIndicatorPopupClassName","getPopupContainer","onClick","onOpenChange","onKeyDown","openAnimation","openTransitionName","_internalRenderMenuItem","_internalRenderSubMenuItem"],Ej=[],Cj=t.forwardRef((function(e,n){var r,i,a=e.prefixCls,o=void 0===a?"rc-menu":a,s=e.rootClassName,u=e.style,l=e.className,c=e.tabIndex,h=void 0===c?0:c,f=e.items,d=e.children,p=e.direction,v=e.id,m=e.mode,g=void 0===m?"vertical":m,y=e.inlineCollapsed,b=e.disabled,_=e.disabledOverflow,x=e.subMenuOpenDelay,w=void 0===x?.1:x,S=e.subMenuCloseDelay,M=void 0===S?.1:S,k=e.forceSubMenuRender,T=e.defaultOpenKeys,E=e.openKeys,C=e.activeKey,A=e.defaultActiveFirst,R=e.selectable,P=void 0===R||R,L=e.multiple,D=void 0!==L&&L,N=e.defaultSelectedKeys,I=e.selectedKeys,O=e.onSelect,U=e.onDeselect,F=e.inlineIndent,z=void 0===F?24:F,B=e.motion,V=e.defaultMotions,G=e.triggerSubMenuAction,j=void 0===G?"hover":G,H=e.builtinPlacements,W=e.itemIcon,Z=e.expandIcon,q=e.overflowedIndicator,X=void 0===q?"...":q,Y=e.overflowedIndicatorPopupClassName,K=e.getPopupContainer,J=e.onClick,Q=e.onOpenChange,$=e.onKeyDown,ee=(e.openAnimation,e.openTransitionName,e._internalRenderMenuItem),te=e._internalRenderSubMenuItem,ne=xF(e,Tj),re=t.useMemo((function(){return EB(d,f,Ej)}),[d,f]),ie=vr(t.useState(!1),2),ae=ie[0],oe=ie[1],se=t.useRef(),ue=function(e){var n=vr(NF(e,{value:e}),2),r=n[0],i=n[1];return t.useEffect((function(){xj+=1;var e="".concat(_j,"-").concat(xj);i("rc-menu-uuid-".concat(e))}),[]),r}(v),le="rtl"===p;var ce=vr(t.useMemo((function(){return"inline"!==g&&"vertical"!==g||!y?[g,!1]:["vertical",y]}),[g,y]),2),he=ce[0],fe=ce[1],de=vr(t.useState(0),2),pe=de[0],ve=de[1],me=pe>=re.length-1||"horizontal"!==he||_,ge=vr(NF(T,{value:E,postState:function(e){return e||Ej}}),2),ye=ge[0],be=ge[1],_e=function(e){be(e),null===Q||void 0===Q||Q(e)},xe=vr(t.useState(ye),2),we=xe[0],Se=xe[1],Me="inline"===he,ke=t.useRef(!1);t.useEffect((function(){Me&&Se(ye)}),[ye]),t.useEffect((function(){ke.current&&(Me?be(we):_e(Ej))}),[Me]),t.useEffect((function(){return ke.current=!0,function(){ke.current=!1}}),[]);var Te=kj(),Ee=Te.registerPath,Ce=Te.unregisterPath,Ae=Te.refreshOverflowKeys,Re=Te.isSubPathKey,Pe=Te.getKeyPath,Le=Te.getKeys,De=Te.getSubPathKeys,Ne=t.useMemo((function(){return{registerPath:Ee,unregisterPath:Ce}}),[Ee,Ce]),Ie=t.useMemo((function(){return{isSubPathKey:Re}}),[Re]);t.useEffect((function(){Ae(me?Ej:re.slice(pe+1).map((function(e){return e.key})))}),[pe,me]);var Oe=vr(NF(C||A&&(null===(r=re[0])||void 0===r?void 0:r.key),{value:C}),2),Ue=Oe[0],Fe=Oe[1],ze=CB((function(e){Fe(e)})),Be=CB((function(){Fe(void 0)}));(0,t.useImperativeHandle)(n,(function(){return{list:se.current,focus:function(e){var t,n,r,i,a=null!==Ue&&void 0!==Ue?Ue:null===(t=re.find((function(e){return!e.props.disabled})))||void 0===t?void 0:t.key;a&&(null===(n=se.current)||void 0===n||null===(r=n.querySelector("li[data-menu-id='".concat(vB(ue,a),"']")))||void 0===r||null===(i=r.focus)||void 0===i||i.call(r,e))}}}));var Ve=vr(NF(N||[],{value:I,postState:function(e){return Array.isArray(e)?e:null===e||void 0===e?Ej:[e]}}),2),Ge=Ve[0],je=Ve[1],He=CB((function(e){null===J||void 0===J||J(aB(e)),function(e){if(P){var t,n=e.key,r=Ge.includes(n);t=D?r?Ge.filter((function(e){return e!==n})):[].concat(cr(Ge),[n]):[n],je(t);var i=Mr(Mr({},e),{},{selectedKeys:t});r?null===U||void 0===U||U(i):null===O||void 0===O||O(i)}!D&&ye.length&&"inline"!==he&&_e(Ej)}(e)})),We=CB((function(e,t){var n=ye.filter((function(t){return t!==e}));if(t)n.push(e);else if("inline"!==he){var r=De(e);n=n.filter((function(e){return!r.has(e)}))}Dz()(ye,n)||_e(n)})),Ze=CB(K),qe=bj(he,Ue,le,ue,se,Le,Pe,Fe,(function(e,t){var n=null!==t&&void 0!==t?t:!ye.includes(e);We(e,n)}),$);t.useEffect((function(){oe(!0)}),[]);var Xe=t.useMemo((function(){return{_internalRenderMenuItem:ee,_internalRenderSubMenuItem:te}}),[ee,te]),Ye="horizontal"!==he||_?re:re.map((function(e,n){return t.createElement(nB,{key:e.key,overflowDisabled:n>pe},e)})),Ke=t.createElement(Qz,bF({id:v,ref:se,prefixCls:"".concat(o,"-overflow"),component:"ul",itemComponent:SB,className:SF()(o,"".concat(o,"-root"),"".concat(o,"-").concat(he),l,(i={},gr(i,"".concat(o,"-inline-collapsed"),fe),gr(i,"".concat(o,"-rtl"),le),i),s),dir:p,style:u,role:"menu",tabIndex:h,data:Ye,renderRawItem:function(e){return e},renderRawRest:function(e){var n=e.length,r=n?re.slice(-n):null;return t.createElement(aj,{eventKey:Mj,title:X,disabled:me,internalPopupClose:0===n,popupClassName:Y},r)},maxCount:"horizontal"!==he||_?Qz.INVALIDATE:Qz.RESPONSIVE,ssr:"full","data-menu-list":!0,onVisibleChange:function(e){ve(e)},onKeyDown:qe},ne));return t.createElement(gB.Provider,{value:Xe},t.createElement(pB.Provider,{value:ue},t.createElement(nB,{prefixCls:o,rootClassName:s,mode:he,openKeys:ye,rtl:le,disabled:b,motion:ae?B:null,defaultMotions:ae?V:null,activeKey:Ue,onActive:ze,onInactive:Be,selectedKeys:Ge,inlineIndent:z,subMenuOpenDelay:w,subMenuCloseDelay:M,forceSubMenuRender:k,builtinPlacements:H,triggerSubMenuAction:j,getPopupContainer:Ze,itemIcon:W,expandIcon:Z,onItemClick:He,onOpenChange:We},t.createElement(dB.Provider,{value:Ie},Ke),t.createElement("div",{style:{display:"none"},"aria-hidden":!0},t.createElement(lB.Provider,{value:Ne},re)))))})),Aj=["className","title","eventKey","children"],Rj=["children"],Pj=function(e){var n=e.className,r=e.title,i=(e.eventKey,e.children),a=xF(e,Aj),o=t.useContext(tB).prefixCls,s="".concat(o,"-item-group");return t.createElement("li",bF({},a,{onClick:function(e){return e.stopPropagation()},className:SF()(s,n)}),t.createElement("div",{className:"".concat(s,"-title"),title:"string"===typeof r?r:void 0},r),t.createElement("ul",{className:"".concat(s,"-list")},i))};function Lj(e){var n=e.children,r=xF(e,Rj),i=kB(n,fB(r.eventKey));return cB()?i:t.createElement(Pj,$z(r,["warnKey"]),i)}function Dj(e){var n=e.className,r=e.style,i=t.useContext(tB).prefixCls;return cB()?null:t.createElement("li",{className:SF()("".concat(i,"-item-divider"),n),style:r})}var Nj=Cj;Nj.Item=SB,Nj.SubMenu=aj,Nj.ItemGroup=Lj,Nj.Divider=Dj;var Ij=Nj,Oj={adjustX:1,adjustY:1},Uj=[0,0],Fj={topLeft:{points:["bl","tl"],overflow:Oj,offset:[0,-4],targetOffset:Uj},topCenter:{points:["bc","tc"],overflow:Oj,offset:[0,-4],targetOffset:Uj},topRight:{points:["br","tr"],overflow:Oj,offset:[0,-4],targetOffset:Uj},bottomLeft:{points:["tl","bl"],overflow:Oj,offset:[0,4],targetOffset:Uj},bottomCenter:{points:["tc","bc"],overflow:Oj,offset:[0,4],targetOffset:Uj},bottomRight:{points:["tr","br"],overflow:Oj,offset:[0,4],targetOffset:Uj}},zj=Ez.ESC,Bj=Ez.TAB;var Vj=["arrow","prefixCls","transitionName","animation","align","placement","placements","getPopupContainer","showAction","hideAction","overlayClassName","overlayStyle","visible","trigger","autoFocus"];function Gj(e,n){var r=e.arrow,i=void 0!==r&&r,a=e.prefixCls,o=void 0===a?"rc-dropdown":a,s=e.transitionName,u=e.animation,l=e.align,c=e.placement,h=void 0===c?"bottomLeft":c,f=e.placements,d=void 0===f?Fj:f,p=e.getPopupContainer,v=e.showAction,m=e.hideAction,g=e.overlayClassName,y=e.overlayStyle,b=e.visible,_=e.trigger,x=void 0===_?["hover"]:_,w=e.autoFocus,S=xF(e,Vj),M=vr(t.useState(),2),k=M[0],T=M[1],E="visible"in e?b:k,C=t.useRef(null);t.useImperativeHandle(n,(function(){return C.current})),function(e){var n=e.visible,r=e.setTriggerVisible,i=e.triggerRef,a=e.onVisibleChange,o=e.autoFocus,s=t.useRef(!1),u=function(){var e,t,o,s;n&&i.current&&(null===(e=i.current)||void 0===e||null===(t=e.triggerRef)||void 0===t||null===(o=t.current)||void 0===o||null===(s=o.focus)||void 0===s||s.call(o),r(!1),"function"===typeof a&&a(!1))},l=function(){var e,t,n,r,a=sj(null===(e=i.current)||void 0===e||null===(t=e.popupRef)||void 0===t||null===(n=t.current)||void 0===n||null===(r=n.getElement)||void 0===r?void 0:r.call(n))[0];return!!(null===a||void 0===a?void 0:a.focus)&&(a.focus(),s.current=!0,!0)},c=function(e){switch(e.keyCode){case zj:u();break;case Bj:var t=!1;s.current||(t=l()),t?e.preventDefault():u()}};t.useEffect((function(){return n?(window.addEventListener("keydown",c),o&&BF(l,3),function(){window.removeEventListener("keydown",c),s.current=!1}):function(){s.current=!1}}),[n])}({visible:E,setTriggerVisible:T,triggerRef:C,onVisibleChange:e.onVisibleChange,autoFocus:w});var A=function(){var n=function(){var t=e.overlay;return"function"===typeof t?t():t}();return t.createElement(t.Fragment,null,i&&t.createElement("div",{className:"".concat(o,"-arrow")}),n)},R=m;return R||-1===x.indexOf("contextMenu")||(R=["click"]),t.createElement(XG,Mr(Mr({builtinPlacements:d},S),{},{prefixCls:o,ref:C,popupClassName:SF()(g,gr({},"".concat(o,"-show-arrow"),i)),popupStyle:y,action:x,showAction:v,hideAction:R||[],popupPlacement:h,popupAlign:l,popupTransitionName:s,popupAnimation:u,popupVisible:E,stretch:function(){var t=e.minOverlayWidthMatchTrigger,n=e.alignPoint;return"minOverlayWidthMatchTrigger"in e?t:!n}()?"minWidth":"",popup:"function"===typeof e.overlay?A:A(),onPopupVisibleChange:function(t){var n=e.onVisibleChange;T(t),"function"===typeof n&&n(t)},onPopupClick:function(t){var n=e.onOverlayClick;T(!1),n&&n(t)},getPopupContainer:p}),function(){var n=e.children,r=n.props?n.props:{},i=SF()(r.className,function(){var t=e.openClassName;return void 0!==t?t:"".concat(o,"-open")}());return E&&n?t.cloneElement(n,{className:i}):n}())}var jj=t.forwardRef(Gj);function Hj(e,n){var r=e.prefixCls,i=e.editable,a=e.locale,o=e.style;return i&&!1!==i.showAdd?t.createElement("button",{ref:n,type:"button",className:"".concat(r,"-nav-add"),style:o,"aria-label":(null===a||void 0===a?void 0:a.addAriaLabel)||"Add tab",onClick:function(e){i.onEdit("add",{event:e})}},i.addIcon||"+"):null}var Wj=t.forwardRef(Hj);function Zj(e,n){var r=e.prefixCls,i=e.id,a=e.tabs,o=e.locale,s=e.mobile,u=e.moreIcon,l=void 0===u?"More":u,c=e.moreTransitionName,h=e.style,f=e.className,d=e.editable,p=e.tabBarGutter,v=e.rtl,m=e.removeAriaLabel,g=e.onTabClick,y=e.getPopupContainer,b=e.popupClassName,_=vr((0,t.useState)(!1),2),x=_[0],w=_[1],S=vr((0,t.useState)(null),2),M=S[0],k=S[1],T="".concat(i,"-more-popup"),E="".concat(r,"-dropdown"),C=null!==M?"".concat(T,"-").concat(M):null,A=null===o||void 0===o?void 0:o.dropdownAriaLabel;var R=t.createElement(Ij,{onClick:function(e){var t=e.key,n=e.domEvent;g(t,n),w(!1)},prefixCls:"".concat(E,"-menu"),id:T,tabIndex:-1,role:"listbox","aria-activedescendant":C,selectedKeys:[M],"aria-label":void 0!==A?A:"expanded dropdown"},a.map((function(e){var n=d&&!1!==e.closable&&!e.disabled;return t.createElement(SB,{key:e.key,id:"".concat(T,"-").concat(e.key),role:"option","aria-controls":i&&"".concat(i,"-panel-").concat(e.key),disabled:e.disabled},t.createElement("span",null,e.tab),n&&t.createElement("button",{type:"button","aria-label":m||"remove",tabIndex:0,className:"".concat(E,"-menu-item-remove"),onClick:function(t){var n,r;t.stopPropagation(),n=t,r=e.key,n.preventDefault(),n.stopPropagation(),d.onEdit("remove",{key:r,event:n})}},e.closeIcon||d.removeIcon||"\xd7"))})));function P(e){for(var t=a.filter((function(e){return!e.disabled})),n=t.findIndex((function(e){return e.key===M}))||0,r=t.length,i=0;i<r;i+=1){var o=t[n=(n+e+r)%r];if(!o.disabled)return void k(o.key)}}(0,t.useEffect)((function(){var e=document.getElementById(C);e&&e.scrollIntoView&&e.scrollIntoView(!1)}),[M]),(0,t.useEffect)((function(){x||k(null)}),[x]);var L=gr({},v?"marginRight":"marginLeft",p);a.length||(L.visibility="hidden",L.order=1);var D=SF()(gr({},"".concat(E,"-rtl"),v)),N=s?null:t.createElement(jj,{prefixCls:E,overlay:R,trigger:["hover"],visible:!!a.length&&x,transitionName:c,onVisibleChange:w,overlayClassName:SF()(D,b),mouseEnterDelay:.1,mouseLeaveDelay:.1,getPopupContainer:y},t.createElement("button",{type:"button",className:"".concat(r,"-nav-more"),style:L,tabIndex:-1,"aria-hidden":"true","aria-haspopup":"listbox","aria-controls":T,id:"".concat(i,"-more"),"aria-expanded":x,onKeyDown:function(e){var t=e.which;if(x)switch(t){case Ez.UP:P(-1),e.preventDefault();break;case Ez.DOWN:P(1),e.preventDefault();break;case Ez.ESC:w(!1);break;case Ez.SPACE:case Ez.ENTER:null!==M&&g(M,e)}else[Ez.DOWN,Ez.SPACE,Ez.ENTER].includes(t)&&(w(!0),e.preventDefault())}},l));return t.createElement("div",{className:SF()("".concat(r,"-nav-operations"),f),style:h,ref:n},N,t.createElement(Wj,{prefixCls:r,locale:o,editable:d}))}var qj=t.memo(t.forwardRef(Zj),(function(e,t){return t.tabMoving})),Xj=(0,t.createContext)(null),Yj=Math.pow(.995,20);function Kj(e,n){var r=t.useRef(e),i=vr(t.useState({}),2)[1];return[r.current,function(e){var t="function"===typeof e?e(r.current):e;t!==r.current&&n(t,r.current),r.current=t,i({})}]}var Jj=function(e){var n,r=e.position,i=e.prefixCls,a=e.extra;if(!a)return null;var o={};return a&&"object"===(0,hr.Z)(a)&&!t.isValidElement(a)?o=a:o.right=a,"right"===r&&(n=o.right),"left"===r&&(n=o.left),n?t.createElement("div",{className:"".concat(i,"-extra-content")},n):null};function Qj(e,n){var r,i=t.useContext(Xj),a=i.prefixCls,o=i.tabs,s=e.className,u=e.style,l=e.id,c=e.animated,h=e.activeKey,f=e.rtl,d=e.extra,p=e.editable,v=e.locale,m=e.tabPosition,g=e.tabBarGutter,y=e.children,b=e.onTabClick,_=e.onTabScroll,x=(0,t.useRef)(),w=(0,t.useRef)(),S=(0,t.useRef)(),M=(0,t.useRef)(),k=vr(function(){var e=(0,t.useRef)(new Map);return[function(n){return e.current.has(n)||e.current.set(n,t.createRef()),e.current.get(n)},function(t){e.current.delete(t)}]}(),2),T=k[0],E=k[1],C="top"===m||"bottom"===m,A=Kj(0,(function(e,t){C&&_&&_({direction:e>t?"left":"right"})})),R=vr(A,2),P=R[0],L=R[1],D=Kj(0,(function(e,t){!C&&_&&_({direction:e>t?"top":"bottom"})})),N=vr(D,2),I=N[0],O=N[1],U=vr((0,t.useState)(0),2),F=U[0],z=U[1],B=vr((0,t.useState)(0),2),V=B[0],G=B[1],j=vr((0,t.useState)(null),2),H=j[0],W=j[1],Z=vr((0,t.useState)(null),2),q=Z[0],X=Z[1],Y=vr((0,t.useState)(0),2),K=Y[0],J=Y[1],Q=vr((0,t.useState)(0),2),$=Q[0],ee=Q[1],te=function(e){var n=(0,t.useRef)([]),r=vr((0,t.useState)({}),2)[1],i=(0,t.useRef)("function"===typeof e?e():e),a=kz((function(){var e=i.current;n.current.forEach((function(t){e=t(e)})),n.current=[],i.current=e,r({})}));return[i.current,function(e){n.current.push(e),a()}]}(new Map),ne=vr(te,2),re=ne[0],ie=ne[1],ae=function(e,n,r){return(0,t.useMemo)((function(){for(var t,r=new Map,i=n.get(null===(t=e[0])||void 0===t?void 0:t.key)||Rz,a=i.left+i.width,o=0;o<e.length;o+=1){var s,u=e[o].key,l=n.get(u);l||(l=n.get(null===(s=e[o-1])||void 0===s?void 0:s.key)||Rz);var c=r.get(u)||Mr({},l);c.right=a-c.left-c.width,r.set(u,c)}return r}),[e.map((function(e){return e.key})).join("_"),n,r])}(o,re,F),oe="".concat(a,"-nav-operations-hidden"),se=0,ue=0;function le(e){return e<se?se:e>ue?ue:e}C?f?(se=0,ue=Math.max(0,F-H)):(se=Math.min(0,H-F),ue=0):(se=Math.min(0,q-V),ue=0);var ce=(0,t.useRef)(),he=vr((0,t.useState)(),2),fe=he[0],de=he[1];function pe(){de(Date.now())}function ve(){window.clearTimeout(ce.current)}function me(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=ae.get(e)||{width:0,height:0,left:0,right:0,top:0};if(C){var n=P;f?t.right<P?n=t.right:t.right+t.width>P+H&&(n=t.right+t.width-H):t.left<-P?n=-t.left:t.left+t.width>-P+H&&(n=-(t.left+t.width-H)),O(0),L(le(n))}else{var r=I;t.top<-I?r=-t.top:t.top+t.height>-I+q&&(r=-(t.top+t.height-q)),L(0),O(le(r))}}!function(e,n){var r=vr((0,t.useState)(),2),i=r[0],a=r[1],o=vr((0,t.useState)(0),2),s=o[0],u=o[1],l=vr((0,t.useState)(0),2),c=l[0],h=l[1],f=vr((0,t.useState)(),2),d=f[0],p=f[1],v=(0,t.useRef)(),m=(0,t.useRef)(),g=(0,t.useRef)(null);g.current={onTouchStart:function(e){var t=e.touches[0],n=t.screenX,r=t.screenY;a({x:n,y:r}),window.clearInterval(v.current)},onTouchMove:function(e){if(i){e.preventDefault();var t=e.touches[0],r=t.screenX,o=t.screenY;a({x:r,y:o});var l=r-i.x,c=o-i.y;n(l,c);var f=Date.now();u(f),h(f-s),p({x:l,y:c})}},onTouchEnd:function(){if(i&&(a(null),p(null),d)){var e=d.x/c,t=d.y/c,r=Math.abs(e),o=Math.abs(t);if(Math.max(r,o)<.1)return;var s=e,u=t;v.current=window.setInterval((function(){Math.abs(s)<.01&&Math.abs(u)<.01?window.clearInterval(v.current):n(20*(s*=Yj),20*(u*=Yj))}),20)}},onWheel:function(e){var t=e.deltaX,r=e.deltaY,i=0,a=Math.abs(t),o=Math.abs(r);a===o?i="x"===m.current?t:r:a>o?(i=t,m.current="x"):(i=r,m.current="y"),n(-i,-i)&&e.preventDefault()}},t.useEffect((function(){function t(e){g.current.onTouchMove(e)}function n(e){g.current.onTouchEnd(e)}return document.addEventListener("touchmove",t,{passive:!1}),document.addEventListener("touchend",n,{passive:!1}),e.current.addEventListener("touchstart",(function(e){g.current.onTouchStart(e)}),{passive:!1}),e.current.addEventListener("wheel",(function(e){g.current.onWheel(e)})),function(){document.removeEventListener("touchmove",t),document.removeEventListener("touchend",n)}}),[])}(x,(function(e,t){function n(e,t){e((function(e){return le(e+t)}))}if(C){if(H>=F)return!1;n(L,e)}else{if(q>=V)return!1;n(O,t)}return ve(),pe(),!0})),(0,t.useEffect)((function(){return ve(),fe&&(ce.current=window.setTimeout((function(){de(0)}),100)),ve}),[fe]);var ge=function(e,n,r,i,a){var o,s,u,l=a.tabs,c=a.tabPosition,h=a.rtl;["top","bottom"].includes(c)?(o="width",s=h?"right":"left",u=Math.abs(n.left)):(o="height",s="top",u=-n.top);var f=n[o],d=r[o],p=i[o],v=f;return d+p>f&&d<f&&(v=f-p),(0,t.useMemo)((function(){if(!l.length)return[0,0];for(var t=l.length,n=t,r=0;r<t;r+=1){var i=e.get(l[r].key)||Pz;if(i[s]+i[o]>u+v){n=r-1;break}}for(var a=0,c=t-1;c>=0;c-=1)if((e.get(l[c].key)||Pz)[s]<u){a=c+1;break}return[a,n]}),[e,u,v,c,l.map((function(e){return e.key})).join("_"),h])}(ae,{width:H,height:q,left:P,top:I},{width:F,height:V},{width:K,height:$},Mr(Mr({},e),{},{tabs:o})),ye=vr(ge,2),be=ye[0],_e=ye[1],xe={};"top"===m||"bottom"===m?xe[f?"marginRight":"marginLeft"]=g:xe.marginTop=g;var we=o.map((function(e,n){var r=e.key;return t.createElement(Az,{id:l,prefixCls:a,key:r,tab:e,style:0===n?void 0:xe,closable:e.closable,editable:p,active:r===h,renderWrapper:y,removeAriaLabel:null===v||void 0===v?void 0:v.removeAriaLabel,ref:T(r),onClick:function(e){b(r,e)},onRemove:function(){E(r)},onFocus:function(){me(r),pe(),x.current&&(f||(x.current.scrollLeft=0),x.current.scrollTop=0)}})})),Se=kz((function(){var e,t,n,r,i,a,s=(null===(e=x.current)||void 0===e?void 0:e.offsetWidth)||0,u=(null===(t=x.current)||void 0===t?void 0:t.offsetHeight)||0,l=(null===(n=M.current)||void 0===n?void 0:n.offsetWidth)||0,c=(null===(r=M.current)||void 0===r?void 0:r.offsetHeight)||0;W(s),X(u),J(l),ee(c);var h=((null===(i=w.current)||void 0===i?void 0:i.offsetWidth)||0)-l,f=((null===(a=w.current)||void 0===a?void 0:a.offsetHeight)||0)-c;z(h),G(f),ie((function(){var e=new Map;return o.forEach((function(t){var n=t.key,r=T(n).current;r&&e.set(n,{width:r.offsetWidth,height:r.offsetHeight,left:r.offsetLeft,top:r.offsetTop})})),e}))})),Me=o.slice(0,be),ke=o.slice(_e+1),Te=[].concat(cr(Me),cr(ke)),Ee=vr((0,t.useState)(),2),Ce=Ee[0],Ae=Ee[1],Re=ae.get(h),Pe=(0,t.useRef)();function Le(){BF.cancel(Pe.current)}(0,t.useEffect)((function(){var e={};return Re&&(C?(f?e.right=Re.right:e.left=Re.left,e.width=Re.width):(e.top=Re.top,e.height=Re.height)),Le(),Pe.current=BF((function(){Ae(e)})),Le}),[Re,C,f]),(0,t.useEffect)((function(){me()}),[h,Re,ae,C]),(0,t.useEffect)((function(){Se()}),[f,g,h,o.map((function(e){return e.key})).join("_")]);var De,Ne,Ie,Oe,Ue=!!Te.length,Fe="".concat(a,"-nav-wrap");return C?f?(Ne=P>0,De=P+H<F):(De=P<0,Ne=-P+H<F):(Ie=I<0,Oe=-I+q<V),t.createElement("div",{ref:n,role:"tablist",className:SF()("".concat(a,"-nav"),s),style:u,onKeyDown:function(){pe()}},t.createElement(Jj,{position:"left",extra:d,prefixCls:a}),t.createElement(Mz,{onResize:Se},t.createElement("div",{className:SF()(Fe,(r={},gr(r,"".concat(Fe,"-ping-left"),De),gr(r,"".concat(Fe,"-ping-right"),Ne),gr(r,"".concat(Fe,"-ping-top"),Ie),gr(r,"".concat(Fe,"-ping-bottom"),Oe),r)),ref:x},t.createElement(Mz,{onResize:Se},t.createElement("div",{ref:w,className:"".concat(a,"-nav-list"),style:{transform:"translate(".concat(P,"px, ").concat(I,"px)"),transition:fe?"none":void 0}},we,t.createElement(Wj,{ref:M,prefixCls:a,locale:v,editable:p,style:Mr(Mr({},0===we.length?void 0:xe),{},{visibility:Ue?"hidden":null})}),t.createElement("div",{className:SF()("".concat(a,"-ink-bar"),gr({},"".concat(a,"-ink-bar-animated"),c.inkBar)),style:Ce}))))),t.createElement(qj,bF({},e,{removeAriaLabel:null===v||void 0===v?void 0:v.removeAriaLabel,ref:S,prefixCls:a,tabs:Te,className:!Ue&&oe,tabMoving:!!fe})),t.createElement(Jj,{position:"right",extra:d,prefixCls:a}))}var $j=t.forwardRef(Qj);function eH(e){var n=e.id,r=e.activeKey,i=e.animated,a=e.tabPosition,o=e.rtl,s=e.destroyInactiveTabPane,u=t.useContext(Xj),l=u.prefixCls,c=u.tabs,h=i.tabPane,f=c.findIndex((function(e){return e.key===r}));return t.createElement("div",{className:SF()("".concat(l,"-content-holder"))},t.createElement("div",{className:SF()("".concat(l,"-content"),"".concat(l,"-content-").concat(a),gr({},"".concat(l,"-content-animated"),h)),style:f&&h?gr({},o?"marginRight":"marginLeft","-".concat(f,"00%")):null},c.map((function(e){return t.cloneElement(e.node,{key:e.key,prefixCls:l,tabKey:e.key,id:n,animated:h,active:e.key===r,destroyInactiveTabPane:s})}))))}var tH=["id","prefixCls","className","children","direction","activeKey","defaultActiveKey","editable","animated","tabPosition","tabBarGutter","tabBarStyle","tabBarExtraContent","locale","moreIcon","moreTransitionName","destroyInactiveTabPane","renderTabBar","onChange","onTabClick","onTabScroll","getPopupContainer","popupClassName"],nH=0;function rH(e,n){var r,i,a=e.id,o=e.prefixCls,s=void 0===o?"rc-tabs":o,u=e.className,l=e.children,c=e.direction,h=e.activeKey,f=e.defaultActiveKey,d=e.editable,p=e.animated,v=void 0===p?{inkBar:!0,tabPane:!1}:p,m=e.tabPosition,g=void 0===m?"top":m,y=e.tabBarGutter,b=e.tabBarStyle,_=e.tabBarExtraContent,x=e.locale,w=e.moreIcon,S=e.moreTransitionName,M=e.destroyInactiveTabPane,k=e.renderTabBar,T=e.onChange,E=e.onTabClick,C=e.onTabScroll,A=e.getPopupContainer,R=e.popupClassName,P=xF(e,tH),L=function(e){return kF(e).map((function(e){return t.isValidElement(e)?Mr(Mr({key:void 0!==e.key?String(e.key):void 0},e.props),{},{node:e}):null})).filter((function(e){return e}))}(l),D="rtl"===c;i=!1===v?{inkBar:!1,tabPane:!1}:!0===v?{inkBar:!0,tabPane:!0}:Mr({inkBar:!0,tabPane:!1},"object"===(0,hr.Z)(v)?v:{});var N=vr((0,t.useState)(!1),2),I=N[0],O=N[1];(0,t.useEffect)((function(){O(TF())}),[]);var U=vr(NF((function(){var e;return null===(e=L[0])||void 0===e?void 0:e.key}),{value:h,defaultValue:f}),2),F=U[0],z=U[1],B=vr((0,t.useState)((function(){return L.findIndex((function(e){return e.key===F}))})),2),V=B[0],G=B[1];(0,t.useEffect)((function(){var e,t=L.findIndex((function(e){return e.key===F}));-1===t&&(t=Math.max(0,Math.min(V,L.length-1)),z(null===(e=L[t])||void 0===e?void 0:e.key));G(t)}),[L.map((function(e){return e.key})).join("_"),F,V]);var j=vr(NF(null,{value:a}),2),H=j[0],W=j[1],Z=g;I&&!["left","right"].includes(g)&&(Z="top"),(0,t.useEffect)((function(){a||(W("rc-tabs-".concat(nH)),nH+=1)}),[]);var q,X={id:H,activeKey:F,animated:i,tabPosition:Z,rtl:D,mobile:I},Y=Mr(Mr({},X),{},{editable:d,locale:x,moreIcon:w,moreTransitionName:S,tabBarGutter:y,onTabClick:function(e,t){null===E||void 0===E||E(e,t);var n=e!==F;z(e),n&&(null===T||void 0===T||T(e))},onTabScroll:C,extra:_,style:b,panes:l,getPopupContainer:A,popupClassName:R});return q=k?k(Y,$j):t.createElement($j,Y),t.createElement(Xj.Provider,{value:{tabs:L,prefixCls:s}},t.createElement("div",bF({ref:n,id:a,className:SF()(s,"".concat(s,"-").concat(Z),(r={},gr(r,"".concat(s,"-mobile"),I),gr(r,"".concat(s,"-editable"),d),gr(r,"".concat(s,"-rtl"),D),r),u)},P),q,t.createElement(eH,bF({destroyInactiveTabPane:M},X,{animated:i}))))}var iH=t.forwardRef(rH);iH.TabPane=function(e){var n=e.prefixCls,r=e.forceRender,i=e.className,a=e.style,o=e.id,s=e.active,u=e.animated,l=e.destroyInactiveTabPane,c=e.tabKey,h=e.children,f=vr(t.useState(r),2),d=f[0],p=f[1];t.useEffect((function(){s?p(!0):l&&p(!1)}),[s,l]);var v={};return s||(u?(v.visibility="hidden",v.height=0,v.overflowY="hidden"):v.display="none"),t.createElement("div",{id:o&&"".concat(o,"-panel-").concat(c),role:"tabpanel",tabIndex:s?0:-1,"aria-labelledby":o&&"".concat(o,"-tab-").concat(c),"aria-hidden":!s,style:Mr(Mr({},v),a),className:SF()("".concat(n,"-tabpane"),s&&"".concat(n,"-tabpane-active"),i)},(s||d||r)&&h)};var aH=iH,oH={adjustX:1,adjustY:1},sH=[0,0],uH={topLeft:{points:["bl","tl"],overflow:oH,offset:[0,-4],targetOffset:sH},topCenter:{points:["bc","tc"],overflow:oH,offset:[0,-4],targetOffset:sH},topRight:{points:["br","tr"],overflow:oH,offset:[0,-4],targetOffset:sH},bottomLeft:{points:["tl","bl"],overflow:oH,offset:[0,4],targetOffset:sH},bottomCenter:{points:["tc","bc"],overflow:oH,offset:[0,4],targetOffset:sH},bottomRight:{points:["tr","br"],overflow:oH,offset:[0,4],targetOffset:sH}},lH=Ez.ESC,cH=Ez.TAB;var hH=["arrow","prefixCls","transitionName","animation","align","placement","placements","getPopupContainer","showAction","hideAction","overlayClassName","overlayStyle","visible","trigger","autoFocus"];function fH(e,n){var r=e.arrow,i=void 0!==r&&r,a=e.prefixCls,o=void 0===a?"rc-dropdown":a,s=e.transitionName,u=e.animation,l=e.align,c=e.placement,h=void 0===c?"bottomLeft":c,f=e.placements,d=void 0===f?uH:f,p=e.getPopupContainer,v=e.showAction,m=e.hideAction,g=e.overlayClassName,y=e.overlayStyle,b=e.visible,_=e.trigger,x=void 0===_?["hover"]:_,w=e.autoFocus,S=xF(e,hH),M=vr(t.useState(),2),k=M[0],T=M[1],E="visible"in e?b:k,C=t.useRef(null);t.useImperativeHandle(n,(function(){return C.current}));var A=t.useRef(null),R="".concat(o,"-menu");!function(e){var n=e.visible,r=e.setTriggerVisible,i=e.triggerRef,a=e.menuRef,o=e.onVisibleChange,s=e.autoFocus,u=t.useRef(!1),l=function(){var e,t,a,s;n&&i.current&&(null===(e=i.current)||void 0===e||null===(t=e.triggerRef)||void 0===t||null===(a=t.current)||void 0===a||null===(s=a.focus)||void 0===s||s.call(a),r(!1),"function"===typeof o&&o(!1))},c=function(){var e,t;null===(e=a.current)||void 0===e||null===(t=e.focus)||void 0===t||t.call(e),u.current=!0},h=function(e){var t;switch(e.keyCode){case lH:l();break;case cH:!u.current&&(null===(t=a.current)||void 0===t?void 0:t.focus)?(e.preventDefault(),c()):l()}};t.useEffect((function(){return n?(window.addEventListener("keydown",h),s&&BF(c,3),function(){window.removeEventListener("keydown",h),u.current=!1}):function(){u.current=!1}}),[n])}({visible:E,setTriggerVisible:T,triggerRef:C,menuRef:A,onVisibleChange:e.onVisibleChange,autoFocus:w});var P=function(){var t=e.overlay;return"function"===typeof t?t():t},L=function(t){var n=e.onOverlayClick,r=P().props;T(!1),n&&n(t),r.onClick&&r.onClick(t)},D=function(){var e,n=P(),r=ZF(A,n.ref),a=(gr(e={prefixCls:R},"data-dropdown-inject",!0),gr(e,"onClick",L),gr(e,"ref",qF(n)?r:void 0),e);return"string"===typeof n.type&&(delete a.prefixCls,delete a["data-dropdown-inject"]),t.createElement(t.Fragment,null,i&&t.createElement("div",{className:"".concat(o,"-arrow")}),t.cloneElement(n,a))},N=m;return N||-1===x.indexOf("contextMenu")||(N=["click"]),t.createElement(XG,Mr(Mr({builtinPlacements:d},S),{},{prefixCls:o,ref:C,popupClassName:SF()(g,gr({},"".concat(o,"-show-arrow"),i)),popupStyle:y,action:x,showAction:v,hideAction:N||[],popupPlacement:h,popupAlign:l,popupTransitionName:s,popupAnimation:u,popupVisible:E,stretch:function(){var t=e.minOverlayWidthMatchTrigger,n=e.alignPoint;return"minOverlayWidthMatchTrigger"in e?t:!n}()?"minWidth":"",popup:"function"===typeof e.overlay?D:D(),onPopupVisibleChange:function(t){var n=e.onVisibleChange;T(t),"function"===typeof n&&n(t)},getPopupContainer:p}),function(){var n=e.children,r=n.props?n.props:{},i=SF()(r.className,function(){var t=e.openClassName;return void 0!==t?t:"".concat(o,"-open")}());return E&&n?t.cloneElement(n,{className:i}):n}())}var dH,pH,vH,mH,gH,yH=t.forwardRef(fH),bH=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.split(" ").filter((function(e){return""!==e})).map((function(e){return"dock-style-".concat(e)}))},_H=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((0,u.Z)(this,e),this.pageX=0,this.pageY=0,this.clientX=0,this.clientY=0,this.dx=0,this.dy=0,this.dropped=!1,this.event=t,this.component=n,this._init=r,t){var i;if(t.type.startsWith("touch"))i="touchend"===t.type?t.changedTouches[0]:t.touches[0],this.pageX=i.pageX,this.pageY=i.pageY,this.clientX=i.clientX,this.clientY=i.clientY;else"pageX"in t&&(this.pageX=t.pageX,this.pageY=t.pageY,this.clientX=t.clientX,this.clientY=t.clientY);this.dx=(this.pageX-n.baseX)*n.scaleX,this.dy=(this.pageY-n.baseY)*n.scaleY}}return(0,l.Z)(e,[{key:"moved",value:function(){return Math.abs(this.dx)>=1||Math.abs(this.dy)>=1}},{key:"startDrag",value:function(e,t){if(!this._init)throw new Error("startDrag can only be used in onDragStart callback");void 0===e&&(e=this.component.element),function(e,t,n){vH=e,t&&(t.classList.add("dragging"),mH=t);(function(e){SH=e.createElement("div"),MH=e.createElement("div");var t=pH&&"tabGroup"in pH?pH.tabGroup:void 0;SH.className=SF()(bH(t),"dragging-layer"),SH.appendChild(document.createElement("div")),SH.appendChild(MH)})(e.component.ownerDocument),e.component.ownerDocument.body.appendChild(SH);var r=0,i=0;void 0===n&&(n=e.component.element);n&&"outerHTML"in n&&(r=n.offsetWidth,i=n.offsetHeight,n=n.outerHTML);n&&(SH.firstElementChild.outerHTML=n,"rgba(0, 0, 0, 0)"===window.getComputedStyle(SH.firstElementChild).backgroundColor&&(SH.firstElementChild.style.backgroundColor=window.getComputedStyle(SH).getPropertyValue("--default-background-color")),r&&(r>400&&(r=400),SH.firstElementChild.style.width="".concat(r,"px")),i&&(i>300&&(i=300),SH.firstElementChild.style.height="".concat(i,"px")));var a,o=s(RH);try{for(o.s();!(a=o.n()).done;){var u=a.value;u(dH||!0)}}catch(x2){o.e(x2)}finally{o.f()}}(this,e,t),this.component.ownerDocument.body.classList.add("dock-dragging")}},{key:"setData",value:function(e,t){if(!this._init)throw new Error("setData can only be used in onDragStart callback");dH=t,pH=e}},{key:"dragType",get:function(){return this.component.dragType}},{key:"accept",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.acceptMessage=e,this.rejected=!1}},{key:"reject",value:function(){this.rejected=!0}},{key:"_onMove",value:function(){if(pH){for(var e,t=this.component.ownerDocument,n=t.elementFromPoint(this.clientX,this.clientY);n&&n!==t.body;){if(kH.has(n)){var r=kH.get(n);if(r.onDragOverT&&(r.onDragOverT(this),null!=this.acceptMessage)){e=r;break}}n=n.parentElement}wH(e,this)}var i;i=this,SH.style.left="".concat(i.pageX,"px"),SH.style.top="".concat(i.pageY,"px"),i.rejected?MH.className="drag-accept-reject":i.acceptMessage?MH.className=i.acceptMessage:MH.className=""}},{key:"_onDragEnd",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];gH&&gH.onDropT&&!t&&(this.dropped=gH.onDropT(this),"right"===this.component.dragType&&(this.component.ownerDocument.addEventListener("contextmenu",xH,!0),setTimeout((function(){e.component.ownerDocument.removeEventListener("contextmenu",xH,!0)}),0))),AH(this),this.component.ownerDocument.body.classList.remove("dock-dragging")}}],[{key:"getData",value:function(e,t){return t===dH&&pH?pH[e]:null}}]),e}();function xH(e){e.preventDefault(),e.stopPropagation()}function wH(e,t){gH!==e&&(gH&&gH.onDragLeaveT&&gH.onDragLeaveT(t),gH=e)}var SH,MH,kH=new WeakMap;function TH(){return null!=vH}function EH(e,t){kH.set(e,t)}function CH(e){kH.get(e)===gH&&(gH=null),kH.delete(e)}function AH(e){mH&&(mH.classList.remove("dragging"),mH=null),SH&&(SH.remove(),SH=null),vH=null,wH(null,e),dH=null,pH=null;var t,n=s(RH);try{for(n.s();!(t=n.n()).done;){(0,t.value)(null)}}catch(x2){n.e(x2)}finally{n.f()}}var RH=new Set;"undefined"!==typeof window&&window.navigator&&window.navigator.platform&&/iP(ad|hone|od)/.test(window.navigator.platform)&&document.addEventListener("touchmove",(function(e){1===e.touches.length&&document.body.classList.contains("dock-dragging")&&e.preventDefault()}),{passive:!1});var PH=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((0,u.Z)(this,e),this.dx1=0,this.dy1=0,this.dx2=0,this.dy2=0,this.scale=1,this.rotate=0,this.dx=0,this.dy=0,this.event=t,this.component=n,this._init=r,t&&2===t.touches.length){var i=t.touches[0],a=t.touches[1];this.dx1=(i.pageX-n.baseX)*n.scaleX,this.dy1=(i.pageY-n.baseY)*n.scaleY,this.dx2=(a.pageX-n.baseX2)*n.scaleX,this.dy2=(a.pageY-n.baseY2)*n.scaleY,this.dx1*this.dx2>=0&&(this.dx=(this.dx1+this.dx2)/2),this.dy1*this.dy2>=0&&(this.dy=(this.dy1+this.dy2)/2),this.scale=Math.sqrt(Math.pow(a.pageX-i.pageX,2)+Math.pow(a.pageY-i.pageY,2))/n.baseDis,this.rotate=Math.atan2(a.pageY-i.pageY,a.pageX-i.pageX)-n.baseAng,this.rotate>Math.PI?this.rotate-=2*Math.PI:this.rotate<-Math.PI&&(this.rotate+=2*Math.PI)}}return(0,l.Z)(e,[{key:"moved",value:function(){return Math.max(Math.abs(this.dx1),Math.abs(this.dx2),Math.abs(this.dy1),Math.abs(this.dy2))}},{key:"pageCenter",value:function(){var e=this.event.touches[0],t=this.event.touches[1];return[(e.pageX+t.pageX)/2,(e.pageY+t.pageY)/2]}},{key:"clientCenter",value:function(){var e=this.event.touches[0],t=this.event.touches[1];return[(e.clientX+t.clientX)/2,(e.clientY+t.clientY)/2]}}]),e}(),LH=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},DH=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=n.apply(this,arguments))._getRef=function(t){if(t!==e.element){var n=e.props,r=n.getRef,i=n.onDragOverT;e.element&&i&&CH(e.element),e.element=t,t&&(e.ownerDocument=t.ownerDocument),r&&r(t),t&&i&&EH(t,e.props)}},e.dragType=null,e.waitingMove=!1,e.listening=!1,e.gesturing=!1,e.onPointerDown=function(t){var n=t.nativeEvent.target;if(!(n instanceof HTMLInputElement||n instanceof HTMLTextAreaElement||n.classList.contains("drag-ignore"))){var r=e.props,i=r.onDragStartT,a=r.onGestureStartT,o=r.onGestureMoveT,s=r.useRightButtonDragT,u=t.nativeEvent;if(e.cancel(),"touchstart"===u.type)1===u.touches.length?i&&e.onDragStart(u):2===u.touches.length&&a&&o&&e.onGestureStart(u);else if(i){if(2===u.button&&!s)return;e.onDragStart(u)}}},e.onMouseMove=function(t){var n=e.props.onDragMoveT;if(e.waitingMove){if(TH())return void e.onDragEnd();if(!e.checkFirstMove(t))return}else{var r=new _H(t,(0,c.Z)(e));r._onMove(),n&&n(r)}t.preventDefault()},e.onTouchMove=function(t){var n=e.props.onDragMoveT;if(e.waitingMove){if(TH())return void e.onDragEnd();if(!e.checkFirstMove(t))return}else if(1!==t.touches.length)e.onDragEnd();else{var r=new _H(t,(0,c.Z)(e));r._onMove(),n&&n(r)}t.preventDefault()},e.onDragEnd=function(t){var n=e.props.onDragEndT,r=new _H(t,(0,c.Z)(e));e.removeListeners(),e.waitingMove||(r._onDragEnd(null==t),n&&n(r)),e.cleanupDrag(r)},e.onGestureMove=function(t){var n=e.props,r=n.onGestureMoveT,i=n.gestureSensitivity,a=new PH(t,(0,c.Z)(e));if(e.waitingMove){if(i>0||(i=10),!(a.moved()>i))return;e.waitingMove=!1}r&&r(a)},e.onGestureEnd=function(t){var n=e.props.onGestureEndT;e.removeListeners(),n&&n()},e.onKeyDown=function(t){"Escape"===t.key&&e.cancel()},e}return(0,l.Z)(r,[{key:"onDragStart",value:function(e){if(!TH()){var t=new _H(e,this,!0);this.baseX=t.pageX,this.baseY=t.pageY;var n=this.element.parentElement,r=n.getBoundingClientRect();this.scaleX=n.offsetWidth/Math.round(r.width),this.scaleY=n.offsetHeight/Math.round(r.height),this.addDragListeners(e),this.props.directDragT&&this.executeFirstMove(t)}}},{key:"addDragListeners",value:function(e){"touchstart"===e.type?(this.ownerDocument.addEventListener("touchmove",this.onTouchMove),this.ownerDocument.addEventListener("touchend",this.onDragEnd),this.dragType="touch"):(this.ownerDocument.addEventListener("mousemove",this.onMouseMove),this.ownerDocument.addEventListener("mouseup",this.onDragEnd),2===e.button?this.dragType="right":this.dragType="left"),this.waitingMove=!0,this.listening=!0}},{key:"checkFirstMove",value:function(e){var t=new _H(e,this,!0);return!!t.moved()&&this.executeFirstMove(t)}},{key:"executeFirstMove",value:function(e){var t=this.props.onDragStartT;return this.waitingMove=!1,t(e),TH()?(e._onMove(),this.ownerDocument.addEventListener("keydown",this.onKeyDown),!0):(this.onDragEnd(),!1)}},{key:"addGestureListeners",value:function(e){this.ownerDocument.addEventListener("touchmove",this.onGestureMove),this.ownerDocument.addEventListener("touchend",this.onGestureEnd),this.ownerDocument.addEventListener("keydown",this.onKeyDown),this.gesturing=!0,this.waitingMove=!0}},{key:"onGestureStart",value:function(e){if(TH()){var t=this.props.onGestureStartT;this.baseX=e.touches[0].pageX,this.baseY=e.touches[0].pageY,this.baseX2=e.touches[1].pageX,this.baseY2=e.touches[1].pageY;var n=this.element.parentElement,r=n.getBoundingClientRect();this.scaleX=n.offsetWidth/Math.round(r.width),this.scaleY=n.offsetHeight/Math.round(r.height),this.baseDis=Math.sqrt(Math.pow(this.baseX-this.baseX2,2)+Math.pow(this.baseY-this.baseY2,2)),this.baseAng=Math.atan2(this.baseY2-this.baseY,this.baseX2-this.baseX),t(new PH(e,this,!0))&&(this.addGestureListeners(e),e.preventDefault())}}},{key:"cancel",value:function(){this.listening&&this.onDragEnd(),this.gesturing&&this.onGestureEnd()}},{key:"removeListeners",value:function(){this.gesturing?(this.ownerDocument.removeEventListener("touchmove",this.onGestureMove),this.ownerDocument.removeEventListener("touchend",this.onGestureEnd)):this.listening&&("touch"===this.dragType?(this.ownerDocument.removeEventListener("touchmove",this.onTouchMove),this.ownerDocument.removeEventListener("touchend",this.onDragEnd)):(this.ownerDocument.removeEventListener("mousemove",this.onMouseMove),this.ownerDocument.removeEventListener("mouseup",this.onDragEnd))),this.ownerDocument.removeEventListener("keydown",this.onKeyDown),this.listening=!1,this.gesturing=!1}},{key:"cleanupDrag",value:function(e){this.dragType=null,this.waitingMove=!1}},{key:"render",value:function(){var e=this.props,n=(e.getRef,e.children),r=e.className,i=(e.directDragT,e.onDragStartT),a=(e.onDragMoveT,e.onDragEndT,e.onDragOverT,e.onDragLeaveT,e.onDropT,e.onGestureStartT),o=(e.onGestureMoveT,e.onGestureEndT,e.useRightButtonDragT,LH(e,["getRef","children","className","directDragT","onDragStartT","onDragMoveT","onDragEndT","onDragOverT","onDragLeaveT","onDropT","onGestureStartT","onGestureMoveT","onGestureEndT","useRightButtonDragT"])),s=this.onPointerDown,u=this.onPointerDown;return i||(u=null,a||(s=null)),(i||a)&&(r=r?"".concat(r," drag-initiator"):"drag-initiator"),t.createElement("div",Object.assign({ref:this._getRef,className:r},o,{onMouseDown:u,onTouchStart:s}),n)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.onDragOverT,r=t.onDragEndT,i=t.onDragLeaveT;!this.element||e.onDragOverT===n&&e.onDragLeaveT===i&&e.onDragEndT===r||(n?EH(this.element,this.props):CH(this.element))}},{key:"componentWillUnmount",value:function(){var e=this.props.onDragOverT;this.element&&e&&CH(this.element),this.cancel()}}]),r}(t.PureComponent),NH=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function IH(e){var n=e.onDragStart,r=e.onDragMove,i=e.onDragEnd,a=e.TabNavList,o=e.isMaximized,s=NH(e,["onDragStart","onDragMove","onDragEnd","TabNavList","isMaximized"]),u=t.useContext(gF),l=t.useRef();return t.createElement(DH,{onDragStartT:n,onDragMoveT:r,onDragEndT:i,role:"tablist",className:"dock-bar",onKeyDown:function(e){e.key.startsWith("Arrow")&&(function(e,t){if("ArrowLeft"===e||"ArrowRight"===e){var n=Array.from(t.querySelectorAll(".dock-tab-btn")),r=t.querySelector(".dock-tab-active>.dock-tab-btn"),i=n.indexOf(r);if(i>=0)if("ArrowLeft"===e){if(i>0)return n[i-1].click(),n[i-1].focus(),!0}else if(i<n.length-1)return n[i+1].click(),n[i+1].focus(),!0}return!1}(e.key,l.current)||o||u.navigateToPanel(l.current,e.key),e.stopPropagation(),e.preventDefault())},getRef:function(e){l.current=e},tabIndex:-1},t.createElement(a,Object.assign({},s)))}var OH=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=n.apply(this,arguments)).getRef=function(t){e._ref=t},e}return(0,l.Z)(r,[{key:"updateCache",value:function(){var e=this.props,t=e.cached,n=e.children,r=e.cacheId;this._cache&&(t&&r===this._cache.id||(this.context.removeTabCache(this._cache.id,this),this._cache=null)),t&&this._ref&&(this._cache=this.context.getTabCache(r,this),this._ref.contains(this._cache.div)||this._ref.appendChild(this._cache.div),this.context.updateTabCache(this._cache.id,n))}},{key:"render",value:function(){var e=this.props,n=e.cacheId,r=e.cached,i=e.prefixCls,a=e.forceRender,o=e.className,s=e.style,u=e.id,l=e.active,c=e.animated,h=e.destroyInactiveTabPane,f=e.tabKey,d=e.children;l?this.visited=!0:h&&(this.visited=!1);var p={};l||(c?(p.visibility="hidden",p.height=0,p.overflowY="hidden"):p.display="none");var v=!1===r?l:this.visited,m=null;r?m=null:(v||a)&&(m=d);var g=r?this.getRef:null;return t.createElement("div",{ref:g,id:n,role:"tabpanel","aria-labelledby":u&&"".concat(u,"-tab-").concat(f),"aria-hidden":!l,style:Object.assign(Object.assign({},p),s),className:SF()("".concat(i,"-tabpane"),l&&"".concat(i,"-tabpane-active"),o)},(l||this.visited||a)&&m)}},{key:"componentDidMount",value:function(){this.updateCache()}},{key:"componentDidUpdate",value:function(e,t,n){this.updateCache()}},{key:"componentWillUnmount",value:function(){this._cache&&this.context.removeTabCache(this._cache.id,this)}}]),r}(t.PureComponent);OH.contextType=gF;var UH=new WeakMap;function FH(e){var t=UH.get(e);return t?FH(t):e}function zH(e,t){var n=Object.assign(Object.assign({},e),t);return Array.isArray(n.tabs)&&(n.tabs=n.tabs.concat()),Array.isArray(n.children)&&(n.children=n.children.concat()),UH.set(e,n),n}function BH(e,t){return null==e?t:Math.max(e,t)}function VH(e,t){return null==e||e===t?t:e>=1?t<=1?1:Math.min(e,t):t>=1?1:Math.max(e,t)}var GH=0;var jH,HH=0;function WH(e){return e===HH?e:++HH}function ZH(e,t,n){if(e.id===t&&n&jH.Panel)return e;if(n&jH.Tab){var r,i=s(e.tabs);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.id===t)return a}}catch(x2){i.e(x2)}finally{i.f()}}}function qH(e,t,n){var r;if(n|jH.Box&&(null===e||void 0===e?void 0:e.id)===t)return e;if(null===e||void 0===e?void 0:e.children){var i,a=s(e.children);try{for(a.s();!(i=a.n()).done;){var o=i.value;if("children"in o){if(r=qH(o,t,n))break}else if("tabs"in o&&(r=ZH(o,t,n)))break}}catch(x2){a.e(x2)}finally{a.f()}return r}}function XH(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:jH.AnyTabPanel;return r&jH.Docked&&(n=qH(e.dockbox,t,r)),n||(r&jH.Floated&&(n=qH(e.floatbox,t,r)),n||(r&jH.Windowed&&(n=qH(e.windowbox,t,r)),n||(r&jH.Max&&(n=qH(e.maxbox,t,r)),n)))}function YH(e,t,n){var r,i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;if(-1===a&&(a=n.tabs.length),"tabs"in t?(r=t.tabs,i=t.activeId):r=[t],r.length){var o,u=zH(n);(o=u.tabs).splice.apply(o,[a,0].concat(cr(r))),u.activeId=r.at(-1).id;var l,c=s(r);try{for(c.s();!(l=c.n()).done;){var h=l.value;h.parent=u}}catch(x2){c.e(x2)}finally{c.f()}i&&(u.activeId=i),e=iW(e,n,u)}return e}function KH(e){if("tabs"in e)return e;var t={tabs:[e],group:e.group,activeId:e.id};return e.parent=t,t}function JH(e,t,n,r){var i=n.parent,a="left"===r||"right"===r?"horizontal":"vertical",o="bottom"===r||"right"===r;if(i){var s=i.children.indexOf(n);if(s>=0){var u=zH(i);if(a===i.mode)o&&++s,t.size=.3*n.size,n.size*=.7,u.children.splice(s,0,t);else{var l={mode:a,children:[]};l.size=n.size,l.children=o?[n,t]:[t,n],n.parent=l,n.size=280,t.parent=l,t.size=120,u.children[s]=l}return aW(e,i,u)}}else{if(n===e.dockbox){var c=zH(n);if(a===n.mode){var h=0;return o&&(h=c.children.length),t.size=.3*n.size,n.size*=.7,c.children.splice(h,0,t),aW(e,n,c)}var f={mode:a,children:[]};return f.size=n.size,f.children=o?[c,t]:[t,c],c.size=280,t.size=120,aW(e,n,f)}if(n===e.maxbox){var d=zH(n);return d.children.push(t),aW(e,n,d)}}return e}function QH(e,t,n){var r=zH(e.floatbox);return n&&(t.x=n.left,t.y=n.top,t.w=n.width,t.h=n.height),r.children.push(t),aW(e,e.floatbox,r)}function $H(e,t){var n;if(t&&("tabs"in t?e=eW(e,n=t):(n=t.parent,e=function(e,t){var n=t.parent;if(n){var r=n.tabs.indexOf(t);if(r>=0){var i=zH(n);return i.tabs.splice(r,1),i.activeId===t.id&&(i.tabs.length>r?i.activeId=i.tabs[r].id:i.tabs.length&&(i.activeId=i.tabs[0].id)),iW(e,n,i)}}return e}(e,t)),n&&n.parent&&"maximize"===n.parent.mode)){var r=e.maxbox.children[0];if(!r||0===r.tabs.length&&!r.panelLock){var i=XH(e,vF);if(i)return eW(e,i)}}return e}function eW(e,t){var n=t.parent;if(n){var r=n.children.indexOf(t);if(r>=0){var i=zH(n);return i.children.splice(r,1),aW(e,n,i)}}return e}function tW(e,t){return t?"tabs"in t?"maximize"===t.parent.mode?function(e,t){var n=XH(e=eW(e,t),vF);if(n){var r=n.x,i=n.y,a=n.z,o=n.w,s=n.h;return iW(e,n,t=Object.assign(Object.assign({},t),{x:r,y:i,z:a,w:o,h:s}))}return JH(e,t,e.dockbox,"right")}(e,t):function(e,t){if(e.maxbox.children.length)return e;var n=Object.assign(Object.assign({},t),{id:vF,tabs:[],panelLock:{}});return e=JH(e=iW(e,t,n),t,e.maxbox,"middle")}(e,t):function(e,t){return e}(e):e}function nW(e,t,n){var r=!1;if(e&&e.floatbox&&t>200&&n>200){for(var i=e.floatbox.children.concat(),a=0;a<i.length;++a){var o=i[a],s={};o.w>0?o.w>t&&(s.w=t):s.w=Math.round(t/3),o.h>0?o.h>n&&(s.h=n):s.h=Math.round(n/3),"number"!==typeof o.y?s.y=n-(s.h||o.h)>>1:o.y>n-16?s.y=Math.max(n-16-(o.h>>1),0):o.y>=0||(s.y=0),"number"!==typeof o.x?s.x=t-(s.w||o.w)>>1:o.x+o.w<16?s.x=16-(o.w>>1):o.x>t-16&&(s.x=t-16-(o.w>>1)),Object.keys(s).length&&(i[a]=zH(o,s),r=!0)}if(r){var u=zH(e.floatbox);return u.children=i,aW(e,e.floatbox,u)}}return e}function rW(e,t,n){function r(e){if(null==e.id)e.id=(++GH,"+".concat(GH));else if(e.id.startsWith("+")){var t=Number(e.id);t>GH&&(GH=t)}e.size>=0||(e.size=200),e.minWidth=0,e.minHeight=0,e.widthFlex=null,e.heightFlex=null}function i(e){r(e);var i=!1;if(n)for(var a=0;a<e.tabs.length;++a)e.tabs[a]=n(e.tabs[a]);null==e.group&&e.tabs.length&&(e.group=e.tabs[0].group);var o=null===t||void 0===t?void 0:t[e.group];o&&(null!=o.widthFlex&&(e.widthFlex=o.widthFlex),null!=o.heightFlex&&(e.heightFlex=o.heightFlex));var u,l=s(e.tabs);try{for(l.s();!(u=l.n()).done;){var c=u.value;c.parent=e,c.id===e.activeId&&(i=!0),c.minWidth>e.minWidth&&(e.minWidth=c.minWidth),c.minHeight>e.minHeight&&(e.minHeight=c.minHeight)}}catch(x2){l.e(x2)}finally{l.f()}!i&&e.tabs.length&&(e.activeId=e.tabs[0].id),e.minWidth<=0&&(e.minWidth=1),e.minHeight<=0&&(e.minHeight=1);var h=e.panelLock;return h&&(e.minWidth<h.minWidth&&(e.minWidth=h.minWidth),e.minHeight<h.minHeight&&(e.minHeight=h.minHeight),null!=e.panelLock.widthFlex&&(e.widthFlex=h.widthFlex),null!=e.panelLock.heightFlex&&(e.heightFlex=h.heightFlex)),e.z>HH&&(HH=e.z),e}function a(e){r(e);for(var t=0;t<e.children.length;++t){var n=e.children[t];if(n.parent=e,"children"in n){if(a(n),0===n.children.length)e.children.splice(t,1),--t;else if(1===n.children.length){var o=n.children[0];if(o.mode===e.mode){var u,l,c=0,h=s(o.children);try{for(h.s();!(l=h.n()).done;){c+=l.value.size}}catch(x2){h.e(x2)}finally{h.f()}var f,d=n.size/c,p=s(o.children);try{for(p.s();!(f=p.n()).done;){f.value.size*=d}}catch(x2){p.e(x2)}finally{p.f()}(u=e.children).splice.apply(u,[t,1].concat(cr(o.children)))}else o.size=n.size,e.children[t]=o;--t}}else"tabs"in n&&(i(n),0===n.tabs.length&&(n.panelLock?n.group===pF&&(e.children.length>1||e.parent)&&(e.children.splice(t,1),--t):(e.children.splice(t,1),--t)));switch(e.mode){case"horizontal":n.minWidth>0&&(e.minWidth+=n.minWidth),n.minHeight>e.minHeight&&(e.minHeight=n.minHeight),null!=n.widthFlex&&(e.widthFlex=BH(e.widthFlex,n.widthFlex)),null!=n.heightFlex&&(e.heightFlex=VH(e.heightFlex,n.heightFlex));break;case"vertical":n.minWidth>e.minWidth&&(e.minWidth=n.minWidth),n.minHeight>0&&(e.minHeight+=n.minHeight),null!=n.heightFlex&&(e.heightFlex=BH(e.heightFlex,n.heightFlex)),null!=n.widthFlex&&(e.widthFlex=VH(e.widthFlex,n.widthFlex))}}if(e.children.length>1)switch(e.mode){case"horizontal":e.minWidth+=4*(e.children.length-1);break;case"vertical":e.minHeight+=4*(e.children.length-1)}return e}if(e.floatbox?e.floatbox.mode="float":e.floatbox={mode:"float",children:[],size:1},e.windowbox?e.windowbox.mode="window":e.windowbox={mode:"window",children:[],size:1},e.maxbox?e.maxbox.mode="maximize":e.maxbox={mode:"maximize",children:[],size:1},a(e.dockbox),a(e.floatbox),a(e.windowbox),a(e.maxbox),0===e.dockbox.children.length){var o={id:"+0",group:pF,panelLock:{},size:200,tabs:[]};o.parent=e.dockbox,e.dockbox.children.push(o)}else for(;1===e.dockbox.children.length&&"children"in e.dockbox.children[0];){var u=zH(e.dockbox.children[0]);e.dockbox=u;var l,c=s(u.children);try{for(c.s();!(l=c.n()).done;){l.value.parent=u}}catch(x2){c.e(x2)}finally{c.f()}}return e.dockbox.parent=null,e.floatbox.parent=null,e.windowbox.parent=null,e.maxbox.parent=null,UH=new WeakMap,e}function iW(e,t,n){var r,i=s(n.tabs);try{for(i.s();!(r=i.n()).done;){r.value.parent=n}}catch(x2){i.e(x2)}finally{i.f()}var a=t.parent;if(a){var o=a.children.indexOf(t);if(o>=0){var u=zH(a);return u.children[o]=n,aW(e,a,u)}}return e}function aW(e,t,n){var r,i=s(n.children);try{for(i.s();!(r=i.n()).done;){r.value.parent=n}}catch(x2){i.e(x2)}finally{i.f()}var a=t.parent;if(a){var o=a.children.indexOf(t);if(o>=0){var u=zH(a);return u.children[o]=n,aW(e,a,u)}}else{if(t.id===e.dockbox.id||t===e.dockbox)return Object.assign(Object.assign({},e),{dockbox:n});if(t.id===e.floatbox.id||t===e.floatbox)return Object.assign(Object.assign({},e),{floatbox:n});if(t.id===e.windowbox.id||t===e.windowbox)return Object.assign(Object.assign({},e),{windowbox:n});if(t.id===e.maxbox.id||t===e.maxbox)return Object.assign(Object.assign({},e),{maxbox:n})}return e}function oW(e,t){if(!e)return[300,300];var n=e.offsetWidth,r=e.offsetHeight,i=vr(t.preferredFloatWidth||[100,600],2),a=i[0],o=i[1],s=vr(t.preferredFloatHeight||[50,500],2),u=s[0],l=s[1];return n>=a?n<=o||(n=o):n=a,r>=u?r<=l||(r=l):r=u,[n,r]}function sW(e,t,n){var r=-1,i=-1,a=0;switch(n){case"ArrowUp":r=e.top-t.bottom+e.height,i=Math.min(e.right,t.right)-Math.max(e.left,t.left);break;case"ArrowDown":r=t.top-e.bottom+e.height,i=Math.min(e.right,t.right)-Math.max(e.left,t.left);break;case"ArrowLeft":r=e.left-t.right+e.width,i=Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top),a=Math.abs(e.top-t.top);break;case"ArrowRight":r=t.left-e.right+e.width,i=Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top),a=Math.abs(e.top-t.top)}return r<0||i<=0?-1:r*(a+1)-.001*i}!function(e){e[e.Tab=1]="Tab",e[e.Panel=2]="Panel",e[e.Box=4]="Box",e[e.Docked=8]="Docked",e[e.Floated=16]="Floated",e[e.Windowed=32]="Windowed",e[e.Max=64]="Max",e[e.EveryWhere=120]="EveryWhere",e[e.AnyTab=121]="AnyTab",e[e.AnyPanel=122]="AnyPanel",e[e.AnyTabPanel=123]="AnyTabPanel",e[e.All=127]="All"}(jH||(jH={}));var uW=n(8573),lW=n.n(uW),cW=n(5524),hW="object"===typeof window?n.n(cW)().getParser(window.navigator.userAgent):null;var fW="safari"===(null===hW||void 0===hW?void 0:hW.getBrowserName(!0)),dW="desktop"===(null===hW||void 0===hW?void 0:hW.getPlatformType()),pW=function(){switch(null===hW||void 0===hW?void 0:hW.getOSName(!0)){case"windows":var e;switch(hW.getBrowserName(!0)){case"firefox":e=[68,8,8];break;case"microsoft edge":e=[62,8,8];break;default:e=[60,8,8]}return window.devicePixelRatio>1&&(e[0]-=2,e[1]-=1,e[2]-=1),e;case"macos":switch(hW.getBrowserName(!0)){case"safari":return[22,0,0];case"firefox":return[59,0,0];default:return[51,0,0]}}return[60,8,8]}(),vW=lW()((function(){var e=document.createElement("div");document.body.append(e),e.remove()}),200),mW=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).released=!1,r.container=document.createElement("div"),r.state={mounted:!1},r.onMainWindowUnload=function(){r.window&&r.window.close()},r.release=function(e){if(!r.released&&(r.released=!0,r.windowCheckerInterval&&(clearInterval(r.windowCheckerInterval),r.windowCheckerInterval=null),window.removeEventListener("beforeunload",r.onMainWindowUnload),r.window.removeEventListener("beforeunload",r.release),e)){var t=r.props.onClose;"function"===typeof t&&t()}},r}return(0,l.Z)(n,[{key:"render",value:function(){return this.state.mounted?XF.createPortal(this.props.children,this.container):null}},{key:"componentDidMount",value:function(){this.openChild(),this.setState({mounted:!0})}},{key:"openChild",value:function(){var e,t=this,n=this.props,r=n.url,i=n.title,a=n.name,o=n.width,s=n.height,u=n.initPopupInnerRect,l=n.initPopupOuterRect,c=n.onBlock,h=n.onOpen,f=n.onClose,d={width:o,height:s};if(l){d=l();var p=vr(pW,3),v=p[0],m=p[1],g=p[2];fW||(d.width-=2*m,d.height-=v+g)}else if(u){d=u();var y=vr(pW,2),b=y[0],_=y[1];d.left-=_,d.top-=b,fW&&(d.height+=b)}else d.left=window.top.outerWidth/2+window.top.screenX-o/2,d.top=window.top.outerHeight/2+window.top.screenY-s/2;this.window=window.open(r,a,(e=d,Object.keys(e).reduce((function(t,n){var r=e[n];return"boolean"===typeof r?t.push("".concat(n,"=").concat(r?"yes":"no")):t.push("".concat(n,"=").concat(r)),t}),[]).join(","))),this.window?(window.addEventListener("beforeunload",this.onMainWindowUnload),this.window.addEventListener("resize",vW),this.window.document.title=i||document.title,this.window.document.body.appendChild(this.container),this.props.copyStyles&&setTimeout((function(){return e=document,n=t.window.document,void Array.from(e.styleSheets).forEach((function(t){var r;if(t.href){var i=e.createElement("link");i.rel="stylesheet",i.href=t.href,n.head.appendChild(i)}else{try{r=t.cssRules}catch(x2){}if(r){var a=e.createElement("style");Array.from(t.cssRules).forEach((function(t){var n=t.cssText,r=t.type,i=n;[3,5].includes(r)&&(i=n.split("url(").map((function(e){return"/"===e[1]?"".concat(e.slice(0,1)).concat(window.location.origin).concat(e.slice(1)):e})).join("url(")),a.appendChild(e.createTextNode(i))})),n.head.appendChild(a)}}}));var e,n}),0),"function"===typeof h&&h(this.window),r&&f&&(this.windowCheckerInterval=setInterval((function(){t.window&&!t.window.closed||t.release(!0)}),50)),this.window.addEventListener("beforeunload",this.release)):"function"===typeof c?c():console.warn("A new window could not be opened. Maybe it was blocked.")}},{key:"componentWillUnmount",value:function(){this.window&&(this.release(),this.window.close())}}]),n}(t.PureComponent);mW.supported=dW,mW.defaultProps={url:"",name:"",width:640,height:480,copyStyles:!0};var gW=mW,yW=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=n.apply(this,arguments)).state={dropping:!1},e.onDragOver=function(t){var n=e.props,r=n.panelElement,i=n.direction,a=n.depth,o=n.panelData;e.setState({dropping:!0});for(var s=0;s<a;++s)r=r.parentElement;if(o.group===pF&&"float"!==i)e.context.setDropRect(r,"middle",(0,c.Z)(e),t);else{var u=e.context.getDockId(),l=_H.getData("panelSize",u);e.context.setDropRect(r,i,(0,c.Z)(e),t,l)}t.accept("")},e.onDragLeave=function(t){e.setState({dropping:!1}),e.context.setDropRect(null,"remove",(0,c.Z)(e))},e.onDrop=function(t){var n=e.context.getDockId(),r=_H.getData("tab",n);if(r||(r=_H.getData("panel",n)),r){for(var i=e.props,a=i.panelData,o=i.direction,s=i.depth,u=a,l=0;l<s;++l)u=u.parent;e.context.dockMove(r,u,o)}},e}return(0,l.Z)(r,[{key:"render",value:function(){var e=this.props,n=e.direction,r=e.depth,i=this.state.dropping,a=["dock-drop-square"];return a.push("dock-drop-".concat(n)),r&&a.push("dock-drop-deep"),i&&a.push("dock-drop-square-dropping"),t.createElement(DH,{className:a.join(" "),onDragOverT:this.onDragOver,onDragLeaveT:this.onDragLeave,onDropT:this.onDrop},t.createElement("div",{className:"dock-drop-square-box"}))}},{key:"componentWillUnmount",value:function(){this.context.setDropRect(null,"remove",this)}}]),r}(t.PureComponent);yW.contextType=gF;var bW=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(){return(0,u.Z)(this,r),n.apply(this,arguments)}return(0,l.Z)(r,[{key:"render",value:function(){var e,n=this.props,i=n.panelData,a=n.panelElement,o=n.dropFromPanel,s=this.context.getDockId(),u=[],l=_H.getData("panel",s),c=this.context.getGroup(o.group);if(!1===c.floatable||l&&(l.panelLock||"float"===(null===(e=l.parent)||void 0===e?void 0:e.mode)||"singleTab"===c.floatable&&l.tabs.length>1)||u.push(t.createElement(yW,{key:"float",direction:"float",panelData:i,panelElement:a})),l!==i&&!c.disableDock){r.addDepthSquare(u,"horizontal",i,a,0),r.addDepthSquare(u,"vertical",i,a,0),(null===l||void 0===l?void 0:l.panelLock)||i.group!==o.group||i===o||u.push(t.createElement(yW,{key:"middle",direction:"middle",panelData:i,panelElement:a}));var h=i.parent;h&&h.children.length>1&&(r.addDepthSquare(u,h.mode,i,a,1),h.parent&&r.addDepthSquare(u,h.parent.mode,i,a,2))}return t.createElement("div",{className:"dock-drop-layer"},u)}}],[{key:"addDepthSquare",value:function(e,n,r,i,a){"horizontal"===n?(e.push(t.createElement(yW,{key:"top".concat(a),direction:"top",depth:a,panelData:r,panelElement:i})),e.push(t.createElement(yW,{key:"bottom".concat(a),direction:"bottom",depth:a,panelData:r,panelElement:i}))):(e.push(t.createElement(yW,{key:"left".concat(a),direction:"left",depth:a,panelData:r,panelElement:i})),e.push(t.createElement(yW,{key:"right".concat(a),direction:"right",depth:a,panelData:r,panelElement:i})))}}]),r}(t.PureComponent);bW.contextType=gF;var _W=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=n.apply(this,arguments)).getRef=function(t){e._ref=t},e.onDragOver=function(t){var n,r,i,a=e.props,o=a.panelData,s=a.panelElement,u=a.dropFromPanel,l=e.context.getDockId(),h=_H.getData("panel",l),f=e.context.getGroup(u.group);if(!h||"float"!==(null===(n=h.parent)||void 0===n?void 0:n.mode)){var d=e.getDirection(t,f,h===o,null!==(i=null===(r=null===h||void 0===h?void 0:h.tabs)||void 0===r?void 0:r.length)&&void 0!==i?i:1),p=d.direction,v=d.mode,m=d.depth;if(m=e.getActualDepth(m,v,p),!p||"float"===p&&u.panelLock)e.context.setDropRect(null,"remove",(0,c.Z)(e));else{for(var g=s,y=0;y<m;++y)g=g.parentElement;var b=_H.getData("panelSize",l);e.context.setDropRect(g,p,(0,c.Z)(e),t,b),t.accept("")}}},e.onDragLeave=function(t){e.context.setDropRect(null,"remove",(0,c.Z)(e))},e.onDrop=function(t){var n,r,i=e.props,a=i.panelData,o=i.dropFromPanel,s=e.context.getDockId(),u=e.context.getGroup(o.group),l=_H.getData("tab",s),c=_H.getData("panel",s);if(l||(l=c),l){var h=e.getDirection(t,u,c===a,null!==(r=null===(n=null===c||void 0===c?void 0:c.tabs)||void 0===n?void 0:n.length)&&void 0!==r?r:1),f=h.direction,d=h.mode,p=h.depth;if(p=e.getActualDepth(p,d,f),!f)return;for(var v=a,m=0;m<p;++m)v=v.parent;e.context.dockMove(l,v,f)}},e}return(0,l.Z)(r,[{key:"getDirection",value:function(e,t,n,r){var i=this._ref.getBoundingClientRect(),a=Math.min(i.width,500),o=Math.min(i.height,500),s=(e.clientX-i.left)/a,u=(i.right-e.clientX)/a,l=(e.clientY-i.top)/o,c=(i.bottom-e.clientY)/o,h=Math.min(s,u,l,c),f=0;if((t.disableDock||n)&&(h=1),h<0)return{direction:null,depth:0};if(h<.075)f=3;else if(h<.15)f=1;else if(h<.3);else if(t.floatable){if("singleTab"!==t.floatable)return{direction:"float",mode:"float",depth:0};if(1===r)return{direction:"float",mode:"float",depth:0}}switch(h){case s:return{direction:"left",mode:"horizontal",depth:f};case u:return{direction:"right",mode:"horizontal",depth:f};case l:return{direction:"top",mode:"vertical",depth:f};case c:return{direction:"bottom",mode:"vertical",depth:f}}return{direction:null,depth:0}}},{key:"getActualDepth",value:function(e,t,n){var r="bottom"===n||"right"===n;if(!e)return e;var i=this.props.panelData,a=i,o=i.parent,s=0;for(i.parent.mode===t&&++e;o&&s<e;){if(o.mode===t)if(r){if(o.children.at(-1)!==a)break}else if(o.children[0]!==a)break;a=o,o=o.parent,++s}for(;e>s;)e-=2;return e}},{key:"render",value:function(){return t.createElement(DH,{getRef:this.getRef,className:"dock-drop-edge",onDragOverT:this.onDragOver,onDragLeaveT:this.onDragLeave,onDropT:this.onDrop})}},{key:"componentWillUnmount",value:function(){this.context.setDropRect(null,"remove",this)}}]),r}(t.PureComponent);_W.contextType=gF;var xW=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=n.apply(this,arguments)).getRef=function(t){if(e._ref=t,t){var n=e.props.panelData.parent;"float"===(null===n||void 0===n?void 0:n.mode)&&t.addEventListener("pointerdown",e.onFloatPointerDown,{capture:!0,passive:!0})}},e.state={dropFromPanel:null,draggingHeader:!1},e.onDragOver=function(t){if(r._droppingPanel!==(0,c.Z)(e)){var n=e.context.getDockId(),i=_H.getData("tab",n),a=_H.getData("panel",n);(i||a)&&(r.droppingPanel=(0,c.Z)(e)),i?i.parent?e.setState({dropFromPanel:i.parent}):e.setState({dropFromPanel:{activeId:"",tabs:[],group:i.group}}):a&&e.setState({dropFromPanel:a})}},e.onPanelHeaderDragStart=function(t){var n=e.props.panelData,r=n.parent,i=n.x,a=n.y,o=(n.z,e.context.getDockId());if("float"===(null===r||void 0===r?void 0:r.mode))e._movingX=i,e._movingY=a,t.setData({panel:n,tabGroup:n.group},o),t.startDrag(null,null),e.onFloatPointerDown();else{var s=e.context.getGroup(n.group),u=vr(oW(e._ref,s),2),l=u[0],c=u[1];t.setData({panel:n,panelSize:[l,c],tabGroup:n.group},o),t.startDrag(null)}e.setState({draggingHeader:!0})},e.onPanelHeaderDragMove=function(t){var n,r=e.props.panelData;if("float"===(null===(n=r.parent)||void 0===n?void 0:n.mode)){var i=e.context.getLayoutSize(),a=i.width,o=i.height;r.x=e._movingX+t.dx,r.y=e._movingY+t.dy,a>200&&o>200&&(r.y<0?r.y=0:r.y>o-16&&(r.y=o-16),r.x+r.w<16?r.x=16-r.w:r.x>a-16&&(r.x=a-16)),e.forceUpdate()}},e.onPanelHeaderDragEnd=function(t){var n;(e.setState({draggingHeader:!1}),!1===t.dropped)&&("float"===(null===(n=e.props.panelData.parent)||void 0===n?void 0:n.mode)&&e.context.onSilentChange(e.props.panelData.activeId,"move"))},e.onPanelCornerDragT=function(t){e.onPanelCornerDrag(t,"t")},e.onPanelCornerDragB=function(t){e.onPanelCornerDrag(t,"b")},e.onPanelCornerDragL=function(t){e.onPanelCornerDrag(t,"l")},e.onPanelCornerDragR=function(t){e.onPanelCornerDrag(t,"r")},e.onPanelCornerDragTL=function(t){e.onPanelCornerDrag(t,"tl")},e.onPanelCornerDragTR=function(t){e.onPanelCornerDrag(t,"tr")},e.onPanelCornerDragBL=function(t){e.onPanelCornerDrag(t,"bl")},e.onPanelCornerDragBR=function(t){e.onPanelCornerDrag(t,"br")},e.onPanelCornerDragMove=function(t){var n=e.props.panelData,r=t.dx,i=t.dy;if(e._movingCorner.startsWith("t")){var a=e.context.getLayoutSize(),o=(a.width,a.height);e._movingY+i<0?i=-e._movingY:e._movingY+i>o-16&&(i=o-16-e._movingY)}switch(e._movingCorner){case"t":n.y=e._movingY+i,n.h=e._movingH-i;break;case"b":n.h=e._movingH+i;break;case"l":n.x=e._movingX+r,n.w=e._movingW-r;break;case"r":n.w=e._movingW+r;break;case"tl":n.x=e._movingX+r,n.w=e._movingW-r,n.y=e._movingY+i,n.h=e._movingH-i;break;case"tr":n.w=e._movingW+r,n.y=e._movingY+i,n.h=e._movingH-i;break;case"bl":n.x=e._movingX+r,n.w=e._movingW-r,n.h=e._movingH+i;break;case"br":n.w=e._movingW+r,n.h=e._movingH+i}n.w=Math.max(n.w||0,n.minWidth||0),n.h=Math.max(n.h||0,n.minHeight||0),e.forceUpdate()},e.onPanelCornerDragEnd=function(t){e.context.onSilentChange(e.props.panelData.activeId,"move")},e.onFloatPointerDown=function(){var t=e.props.panelData,n=t.z,r=WH(n);r!==n&&(t.z=r,e.forceUpdate())},e.onPanelClicked=function(t){var n=t.nativeEvent.target;!e._ref.contains(e._ref.ownerDocument.activeElement)&&n instanceof Node&&e._ref.contains(n)&&e._ref.querySelector(".dock-bar").focus()},e._unmounted=!1,e}return(0,l.Z)(r,[{key:"onDragOverOtherPanel",value:function(){this.setState({dropFromPanel:null})}},{key:"onPanelCornerDrag",value:function(e,t){var n=this.props.panelData,r=n.parent,i=n.x,a=n.y,o=n.w,s=n.h;"float"===(null===r||void 0===r?void 0:r.mode)&&(this._movingCorner=t,this._movingX=i,this._movingY=a,this._movingW=o,this._movingH=s,e.startDrag(null,null))}},{key:"render",value:function(){var e=this.state,n=e.dropFromPanel,r=e.draggingHeader,i=this.props,a=i.panelData,o=i.size,s=a.minWidth,u=a.minHeight,l=a.group,c=a.id,h=a.parent,f=a.panelLock,d=l,p=this.context.getGroup(l),v=p.widthFlex,m=p.heightFlex;if(f){var g=f.panelStyle,y=f.widthFlex,b=f.heightFlex;g&&(d=g),"number"===typeof y&&(v=y),"number"===typeof b&&(m=b)}var _=SF()(bH(d)),x="maximize"===(null===h||void 0===h?void 0:h.mode),w="float"===(null===h||void 0===h?void 0:h.mode),S="horizontal"===(null===h||void 0===h?void 0:h.mode),M="vertical"===(null===h||void 0===h?void 0:h.mode),k=this.onPanelHeaderDragStart;x&&(n=null,k=null);var T="dock-panel ".concat(_||"").concat(n?" dock-panel-dropping":"").concat(r?" dragging":""),E=1;S&&null!=v?E=v:M&&null!=m&&(E=m);var C=1e6*E;C<1&&(C=1);var A,R={minWidth:s,minHeight:u,flex:"".concat(E*o," ").concat(C," ").concat(o,"px")};if(w&&(R.left=a.x,R.top=a.y,R.width=a.w,R.height=a.h,R.zIndex=a.z),n){var P=this.context.getGroup(n.group),L=this.context.getDockId();if(!P.tabLocked||null==_H.getData("tab",L)){var D=this.context.useEdgeDrop()?_W:bW;A=t.createElement(D,{panelData:a,panelElement:this._ref,dropFromPanel:n})}}return t.createElement(DH,{getRef:this.getRef,className:T,style:R,"data-dockid":c,onDragOverT:w?null:this.onDragOver,onClick:this.onPanelClicked},t.createElement(EW,{panelData:a,onPanelDragStart:k,onPanelDragMove:this.onPanelHeaderDragMove,onPanelDragEnd:this.onPanelHeaderDragEnd}),w?[t.createElement(DH,{key:"drag-size-t",className:"dock-panel-drag-size dock-panel-drag-size-t",onDragStartT:this.onPanelCornerDragT,onDragMoveT:this.onPanelCornerDragMove,onDragEndT:this.onPanelCornerDragEnd}),t.createElement(DH,{key:"drag-size-b",className:"dock-panel-drag-size dock-panel-drag-size-b",onDragStartT:this.onPanelCornerDragB,onDragMoveT:this.onPanelCornerDragMove,onDragEndT:this.onPanelCornerDragEnd}),t.createElement(DH,{key:"drag-size-l",className:"dock-panel-drag-size dock-panel-drag-size-l",onDragStartT:this.onPanelCornerDragL,onDragMoveT:this.onPanelCornerDragMove,onDragEndT:this.onPanelCornerDragEnd}),t.createElement(DH,{key:"drag-size-r",className:"dock-panel-drag-size dock-panel-drag-size-r",onDragStartT:this.onPanelCornerDragR,onDragMoveT:this.onPanelCornerDragMove,onDragEndT:this.onPanelCornerDragEnd}),t.createElement(DH,{key:"drag-size-t-l",className:"dock-panel-drag-size dock-panel-drag-size-t-l",onDragStartT:this.onPanelCornerDragTL,onDragMoveT:this.onPanelCornerDragMove,onDragEndT:this.onPanelCornerDragEnd}),t.createElement(DH,{key:"drag-size-t-r",className:"dock-panel-drag-size dock-panel-drag-size-t-r",onDragStartT:this.onPanelCornerDragTR,onDragMoveT:this.onPanelCornerDragMove,onDragEndT:this.onPanelCornerDragEnd}),t.createElement(DH,{key:"drag-size-b-l",className:"dock-panel-drag-size dock-panel-drag-size-b-l",onDragStartT:this.onPanelCornerDragBL,onDragMoveT:this.onPanelCornerDragMove,onDragEndT:this.onPanelCornerDragEnd}),t.createElement(DH,{key:"drag-size-b-r",className:"dock-panel-drag-size dock-panel-drag-size-b-r",onDragStartT:this.onPanelCornerDragBR,onDragMoveT:this.onPanelCornerDragMove,onDragEndT:this.onPanelCornerDragEnd})]:null,A)}},{key:"componentWillUnmount",value:function(){r._droppingPanel===this&&(r.droppingPanel=null),this._ref&&this._ref.removeEventListener("pointerdown",this.onFloatPointerDown,{capture:!0}),this._unmounted=!0}}],[{key:"droppingPanel",set:function(e){r._droppingPanel!==e&&(r._droppingPanel&&r._droppingPanel.onDragOverOtherPanel(),r._droppingPanel=e)}}]),r}(t.PureComponent);xW.contextType=gF;var wW=n(2270),SW=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=n.apply(this,arguments)).onOpen=function(t){!e._window&&t&&(e._window=t)},e.onUnload=function(){var t=e.props.panelData,n=e.context.getRootElement(),r=(0,wW.fA)(n,e._window);r.width>0&&r.height>0&&(t.x=r.left,t.y=r.top,t.w=r.width,t.h=r.height),e.context.dockMove(t,null,"float")},e.initPopupInnerRect=function(){var t=e.props.panelData;return(0,wW.xj)(e.context.getRootElement(),{left:t.x,top:t.y,width:t.w,height:t.h})},e}return(0,l.Z)(r,[{key:"render",value:function(){var e=this.props.panelData,n=(e.x,e.y,e.w),r=e.h;return t.createElement(gW,{copyStyles:!0,onOpen:this.onOpen,onClose:this.onUnload,onBlock:this.onUnload,initPopupInnerRect:this.initPopupInnerRect,width:n,height:r},t.createElement("div",{className:"dock-wbox"},t.createElement(xW,{size:e.size,panelData:e,key:e.id})))}}]),r}(t.PureComponent);SW.contextType=gF;var MW=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(){return(0,u.Z)(this,r),n.apply(this,arguments)}return(0,l.Z)(r,[{key:"render",value:function(){var e,n=[],r=s(this.props.boxData.children);try{for(r.s();!(e=r.n()).done;){var i=e.value;"tabs"in i&&n.push(t.createElement(SW,{key:i.id,panelData:i}))}}catch(x2){r.e(x2)}finally{r.f()}return t.createElement(t.Fragment,null,n)}}]),r}(t.PureComponent);function kW(e){var t,n,r;return null==e||"LI"===(null===(t=e.parentElement)||void 0===t?void 0:t.tagName)||"LI"===(null===(r=null===(n=e.parentElement)||void 0===n?void 0:n.parentElement)||void 0===r?void 0:r.tagName)}MW.enabled="object"===typeof window&&("Win32"===(null===window||void 0===window?void 0:window.navigator.platform)||"MacIntel"===(null===window||void 0===window?void 0:window.navigator.platform));var TW=function(){function e(t){var n=this;(0,u.Z)(this,e),this.getRef=function(e){kW(e)||(n._ref=e)},this.getHitAreaRef=function(e){kW(e)||(n._hitAreaRef=e)},this.onCloseClick=function(e){n.context.dockMove(n.data,null,"remove"),e.stopPropagation()},this.onDragStart=function(e){var t=n.data.parent;if("float"!==t.parent.mode||1!==t.tabs.length){var r=function(e){for(var t=0;t<10;++t){if(!e)return null;if(e.classList.contains("dock-panel"))return e;e=e.parentElement}return null}(n._ref),i=vr(oW(r,n.context.getGroup(n.data.group)),2),a=i[0],o=i[1];e.setData({tab:n.data,panelSize:[a,o],tabGroup:n.data.group},n.context.getDockId()),e.startDrag(n._ref.parentElement,n._ref.parentElement)}},this.onDragOver=function(e){var t,r,i,a=n.context.getDockId(),o=_H.getData("tab",a),s=_H.getData("panel",a);if(o)s=o.parent,i=o.group;else{if(!s)return;if(null===s||void 0===s?void 0:s.panelLock)return void e.reject();i=s.group}var u=n.context.getGroup(i);if(i!==n.data.group)e.reject();else if("singleTab"===(null===u||void 0===u?void 0:u.floatable)&&"float"===(null===(r=null===(t=n.data.parent)||void 0===t?void 0:t.parent)||void 0===r?void 0:r.mode))e.reject();else if(o&&o!==n.data){var l=n.getDropDirection(e);n.context.setDropRect(n._hitAreaRef,l,n),e.accept("")}else if(s&&s!==n.data.parent){var c=n.getDropDirection(e);n.context.setDropRect(n._hitAreaRef,c,n),e.accept("")}},this.onDragLeave=function(e){n.context.setDropRect(null,"remove",n)},this.onDrop=function(e){var t,r=n.context.getDockId(),i=_H.getData("tab",r);if(t=i?i.parent:_H.getData("panel",r),i&&i!==n.data){var a=n.getDropDirection(e);n.context.dockMove(i,n.data,a)}else if(t&&t!==n.data.parent){var o=n.getDropDirection(e);n.context.dockMove(t,n.data,o)}},this.context=t}return(0,l.Z)(e,[{key:"setData",value:function(e){return e!==this.data&&(this.data=e,this.content=this.render(),!0)}},{key:"getDropDirection",value:function(e){var t=this._hitAreaRef.getBoundingClientRect(),n=t.left+.5*t.width;return e.clientX>n?"after-tab":"before-tab"}},{key:"render",value:function(){var e=this.data,n=e.id,r=e.title,i=e.content,a=e.closable,o=e.cached,s=e.parent,u=this.onDragStart,l=this.onDragOver,c=this.onDrop,h=this.onDragLeave;"window"===s.parent.mode&&(u=null,l=null,c=null,h=null),"function"===typeof i&&(i=i(this.data));var f=t.createElement(DH,{getRef:this.getRef,onDragStartT:u,role:"tab","aria-selected":s.activeId===n,onDragOverT:l,onDropT:c,onDragLeaveT:h},r,a?t.createElement("div",{className:"dock-tab-close-btn",onClick:this.onCloseClick}):null,t.createElement("div",{className:"dock-tab-hit-area",ref:this.getHitAreaRef}));return t.createElement(OH,{key:n,cacheId:n,cached:o,tab:f},i)}},{key:"destroy",value:function(){}}]),e}(),EW=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=n.apply(this,arguments))._cache=new Map,e.onMaximizeClick=function(t){var n=e.props.panelData;e.context.dockMove(n,null,"maximize"),t.stopPropagation()},e.onNewWindowClick=function(){var t=e.props.panelData;e.context.dockMove(t,null,"new-window")},e.renderTabBar=function(n,r){var i=e.props,a=i.panelData,o=i.onPanelDragStart,s=i.onPanelDragMove,u=i.onPanelDragEnd,l=a.group,c=a.panelLock,h=e.context.getGroup(l),f=h.panelExtra,d=h.maximizable;"window"===a.parent.mode&&(o=null,d=!1),c&&c.panelExtra&&(f=c.panelExtra);var p,v=h.newWindow&&MW.enabled&&"float"===a.parent.mode;return f?p=f(a,e.context):(d||v)&&(p=t.createElement("div",{className:"maximize"===a.parent.mode?"dock-panel-min-btn":"dock-panel-max-btn",onClick:d?e.onMaximizeClick:null}),v&&(p=e.addNewWindowMenu(p,!d))),t.createElement(IH,Object.assign({onDragStart:o,onDragMove:s,onDragEnd:u,TabNavList:r,isMaximized:"maximize"===a.parent.mode},n,{extra:p}))},e.onTabChange=function(t){e.props.panelData.activeId=t,e.context.onSilentChange(t,"active"),e.forceUpdate()},e}return(0,l.Z)(r,[{key:"updateTabs",value:function(e){if(e!==this.cachedTabs){this.cachedTabs=e;var t,n=new Map,r=0,i=s(e);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=a.id;if(this._cache.has(o)){var u=this._cache.get(o);n.set(o,u),u.setData(a),++r}else{var l=new TW(this.context);n.set(o,l),l.setData(a)}}}catch(x2){i.e(x2)}finally{i.f()}if(r!==this._cache.size){var c,h=s(this._cache);try{for(h.s();!(c=h.n()).done;){var f=vr(c.value,2),d=f[0],p=f[1];n.has(d)||p.destroy()}}catch(x2){h.e(x2)}finally{h.f()}}this._cache=n}}},{key:"addNewWindowMenu",value:function(e,n){var r=t.createElement(Ij,{onClick:this.onNewWindowClick},t.createElement(SB,null,"New Window")),i=n?["contextMenu","click"]:["contextMenu"];return t.createElement(yH,{prefixCls:"dock-dropdown",overlay:r,trigger:i,mouseEnterDelay:.1,mouseLeaveDelay:.1},e)}},{key:"render",value:function(){var e=this.props.panelData,n=e.group,r=e.tabs,i=e.activeId,a=this.context.getGroup(n),o=a.animated,u=a.moreIcon;null==o&&(o=!0),u||(u="..."),this.updateTabs(r);var l,c=[],h=s(this._cache);try{for(h.s();!(l=h.n()).done;){var f=vr(l.value,2),d=(f[0],f[1]);c.push(d.content)}}catch(x2){h.e(x2)}finally{h.f()}return t.createElement(aH,{prefixCls:"dock",moreIcon:u,animated:o,renderTabBar:this.renderTabBar,activeKey:i,onChange:this.onTabChange,popupClassName:SF()(bH(n))},c)}}]),r}(t.PureComponent);EW.contextType=gF,EW.propKeys=["group","tabs","activeId","onTabChange"];var CW=(0,l.Z)((function e(t){(0,u.Z)(this,e),this.beforeSize=0,this.beforeMinSize=0,this.afterSize=0,this.afterMinSize=0,this.element=t.element,this.beforeDivider=t.beforeDivider,this.afterDivider=t.afterDivider;var n,r=s(this.beforeDivider);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.beforeSize+=i.size,i.minSize>0&&(this.beforeMinSize+=i.minSize)}}catch(x2){r.e(x2)}finally{r.f()}var a,o=s(this.afterDivider);try{for(o.s();!(a=o.n()).done;){var l=a.value;this.afterSize+=l.size,l.minSize>0&&(this.afterMinSize+=l.minSize)}}catch(x2){o.e(x2)}finally{o.f()}}));function AW(e,t,n){for(var r=-1,i=[],a=0;a!==r;){r=a,a=0;var o=(e-r)/(t-r);if(!(o>=0))break;for(var s=0;s<n.length;++s){var u=n[s].size*o;u<n[s].minSize&&(a+=u=n[s].minSize),i[s]=u}}return i}var RW=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=n.apply(this,arguments)).startDrag=function(t){e.boxData=new CW(e.props.getDividerData(e.props.idx)),t.startDrag(e.boxData.element,null)},e.dragMove=function(t){t.event.shiftKey||t.event.ctrlKey||t.event.altKey?e.dragMoveAll(t,t.dx,t.dy):e.dragMove2(t,t.dx,t.dy)},e.dragEnd=function(t){var n=e.props.onDragEnd;e.boxData=null,n&&n()},e}return(0,l.Z)(r,[{key:"dragMove2",value:function(e,t,n){var r=this.props,i=r.isVertical,a=r.changeSizes,o=this.boxData,s=o.beforeDivider,u=o.afterDivider;if(s.length&&u.length){var l=i?n:t,c=s.at(-1),h=u[0],f=c.size+l,d=h.size-l;l>0?d<h.minSize&&(d=h.minSize,f=c.size+h.size-d):f<c.minSize&&(f=c.minSize,d=c.size+h.size-f);var p=s.concat(u).map((function(e){return e.size}));p[s.length-1]=f,p[s.length]=d,a(p)}}},{key:"dragMoveAll",value:function(e,t,n){var r=this.props,i=r.isVertical,a=r.changeSizes,o=this.boxData,s=o.beforeSize,u=o.beforeMinSize,l=o.afterSize,c=o.afterMinSize,h=o.beforeDivider,f=o.afterDivider,d=i?n:t,p=s+d,v=l-d;d>0?v<c&&(v=c,p=s+l-c):p<u&&(p=u,v=s+l-u),a(AW(p,s,h).concat(AW(v,l,f)))}},{key:"render",value:function(){var e=this.props.className;return e||(e="dock-divider"),t.createElement(DH,{className:e,onDragStartT:this.startDrag,onDragMoveT:this.dragMove,onDragEndT:this.dragEnd})}}]),r}(t.PureComponent),PW=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=n.apply(this,arguments)).getRef=function(t){e._ref=t},e.getDividerData=function(t){if(!e._ref)return null;var n=e.props.boxData,r=n.children,i=n.mode,a=e._ref.childNodes;if(a.length===2*r.length-1){for(var o=[],s=0;s<r.length;++s)"vertical"===i?o.push({size:a[2*s].offsetHeight,minSize:r[s].minHeight}):o.push({size:a[2*s].offsetWidth,minSize:r[s].minWidth});return{element:e._ref,beforeDivider:o.slice(0,t),afterDivider:o.slice(t)}}},e.changeSizes=function(t){var n=e.props.boxData.children;if(n.length===t.length){for(var r=0;r<n.length;++r)n[r].size=t[r];e.forceUpdate()}},e.onDragEnd=function(){e.context.onSilentChange(null,"move")},e}return(0,l.Z)(r,[{key:"render",value:function(){for(var e,n=this.props.boxData,i=n.minWidth,a=n.minHeight,o=n.size,s=n.children,u=n.mode,l=n.id,c=n.widthFlex,h=n.heightFlex,f="vertical"===u,d=[],p=0;p<s.length;++p){p>0&&d.push(t.createElement(RW,{idx:p,key:p,isVertical:f,onDragEnd:this.onDragEnd,getDividerData:this.getDividerData,changeSizes:this.changeSizes}));var v=s[p];"tabs"in v?d.push(t.createElement(xW,{size:v.size,panelData:v,key:v.id})):"children"in v&&d.push(t.createElement(r,{size:v.size,boxData:v,key:v.id}))}var m=1;"vertical"===u?(e="dock-box dock-vbox",null!=c&&(m=c)):(e="dock-box dock-hbox",null!=h&&(m=h));var g=m*o,y=1e6*m;return y<1&&(y=1),t.createElement("div",{ref:this.getRef,className:e,"data-dockid":l,style:{minWidth:i,minHeight:a,flex:"".concat(g," ").concat(y," ").concat(o,"px")}},d)}}]),r}(t.PureComponent);PW.contextType=gF;var LW=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(){return(0,u.Z)(this,r),n.apply(this,arguments)}return(0,l.Z)(r,[{key:"render",value:function(){var e,n=[],r=s(this.props.boxData.children);try{for(r.s();!(e=r.n()).done;){var i=e.value;"tabs"in i&&n.push(t.createElement(xW,{size:i.size,panelData:i,key:i.id}))}}catch(x2){r.e(x2)}finally{r.f()}return t.createElement("div",{className:"dock-box dock-fbox"},n)}}]),r}(t.PureComponent);function DW(e,t){t.panels.set(e.id,e);var n,r=s(e.tabs);try{for(r.s();!(n=r.n()).done;){var i=n.value;t.tabs.set(i.id,i)}}catch(x2){r.e(x2)}finally{r.f()}}function NW(e,t){var n,r=s(e.children);try{for(r.s();!(n=r.n()).done;){var i=n.value;"tabs"in i?DW(i,t):"children"in i&&NW(i,t)}}catch(x2){r.e(x2)}finally{r.f()}}function IW(e,t,n){function r(e){var r,i,a=[],o=s(e.tabs);try{for(o.s();!(r=o.n()).done;){var u=r.value,l=(i=u,t?t(i):{id:i.id});l&&a.push(l)}}catch(x2){o.e(x2)}finally{o.f()}var c,h=e.id,f=e.size,d=e.activeId,p=e.group;"float"===e.parent.mode||"window"===e.parent.mode?c={id:h,size:f,tabs:a,group:p,activeId:d,x:e.x,y:e.y,z:e.z,w:e.w,h:e.h}:c={id:h,size:f,tabs:a,group:p,activeId:d};return n&&n(c,e),c}function i(e){var t,n=[],a=s(e.children);try{for(a.s();!(t=a.n()).done;){var o=t.value;"tabs"in o?n.push(r(o)):"children"in o&&n.push(i(o))}}catch(x2){a.e(x2)}finally{a.f()}return{id:e.id,size:e.size,mode:e.mode,children:n}}return{dockbox:i(e.dockbox),floatbox:i(e.floatbox),windowbox:i(e.windowbox),maxbox:i(e.maxbox)}}function OW(e,t,n,r){var i,a,o,u=function(e){var t={panels:new Map,tabs:new Map};return e&&("children"in e?NW(e,t):("dockbox"in e&&NW(e.dockbox,t),"floatbox"in e&&NW(e.floatbox,t))),t}(t);function l(e){if(n)return n(e);var t=e.id;return u.tabs.has(t)?u.tabs.get(t):null}function c(e){var t,n,i=e.id,a=e.size,o=e.activeId,c=e.x,h=e.y,f=e.z,d=e.w,p=e.h,v=e.group,m=[],g=s(e.tabs);try{for(g.s();!(t=g.n()).done;){var y=l(t.value);y&&m.push(y)}}catch(x2){g.e(x2)}finally{g.f()}return n=d||p||c||h||f?{id:i,size:a,activeId:o,group:v,x:c,y:h,z:f,w:d,h:p,tabs:m}:{id:i,size:a,activeId:o,group:v,tabs:m},e.id===vF?n.panelLock={}:r?r(e,n):u.panels.has(i)&&(n=Object.assign(Object.assign({},u.panels.get(i)),n)),n}function h(e){if(!e)return null;var t,n=[],r=s(e.children);try{for(r.s();!(t=r.n()).done;){var i=t.value;"tabs"in i?n.push(c(i)):"children"in i&&n.push(h(i))}}catch(x2){r.e(x2)}finally{r.f()}return{id:e.id,size:e.size,mode:e.mode,children:n}}return{dockbox:h(e.dockbox),floatbox:h(null!==(i=e.floatbox)&&void 0!==i?i:{mode:"float",children:[],size:0}),windowbox:h(null!==(a=e.windowbox)&&void 0!==a?a:{mode:"window",children:[],size:0}),maxbox:h(null!==(o=e.maxbox)&&void 0!==o?o:{mode:"maximize",children:[],size:1})}}var UW=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(){return(0,u.Z)(this,r),n.apply(this,arguments)}return(0,l.Z)(r,[{key:"render",value:function(){var e=this.props.boxData.children[0];if(e)return this.hidePanelData=Object.assign(Object.assign({},e),{id:"",tabs:[]}),t.createElement("div",{className:"dock-box dock-mbox dock-mbox-show"},t.createElement(xW,{size:100,panelData:e}));if(this.hidePanelData){var n=this.hidePanelData;return this.hidePanelData=null,t.createElement("div",{className:"dock-box dock-mbox dock-mbox-hide"},t.createElement(xW,{size:100,panelData:n}))}return t.createElement("div",{className:"dock-box dock-mbox dock-mbox-hide"})}}]),r}(t.PureComponent),FW=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},zW=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.apply(this,arguments))._caches=new Map,e._isMounted=!1,e.destroyRemovedPane=function(){e._pendingDestroy=null;var t,n=!1,r=s(e._caches);try{for(r.s();!(t=r.n()).done;){var i=vr(t.value,2),a=i[0];null==i[1].owner&&(e._caches.delete(a),n=!0)}}catch(x2){r.e(x2)}finally{r.f()}n&&e._isMounted&&e.forceUpdate()},e}return(0,l.Z)(n,[{key:"getTabCache",value:function(e,t){var n=this._caches.get(e);if(n)n.owner=t;else{var r=document.createElement("div");r.className="dock-pane-cache",n={div:r,id:e,owner:t},this._caches.set(e,n)}return n}},{key:"removeTabCache",value:function(e,t){var n=this._caches.get(e);n&&n.owner===t&&(n.owner=null,this._pendingDestroy||(this._pendingDestroy=setTimeout(this.destroyRemovedPane,1)))}},{key:"updateTabCache",value:function(e,t){var n=this._caches.get(e);n&&(n.portal=XF.createPortal(t,n.div,n.id),this.forceUpdate())}}]),n}(t.PureComponent),BW=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var t,i;(0,u.Z)(this,r),(t=n.call(this,e)).getRef=function(e){t._ref=e},t.onDragStateChange=function(e){null==e&&(xW.droppingPanel=null,t.state.dropRect&&t.setState({dropRect:null}))},t._onWindowResize=lW()((function(){var e=t.getLayout();if(t._ref){var n=nW(e,t._ref.offsetWidth,t._ref.offsetHeight);e!==n&&(n=rW(n,t.props.groups),t.changeLayout(n,null,"move"))}}),200);var a,o,s=e.layout,l=e.defaultLayout,c=e.loadTab;if(l)a=t.prepareInitData(e.defaultLayout);else if(!c)throw new Error("DockLayout.loadTab and DockLayout.defaultLayout should not both be undefined.");return t.state=s?{layout:r.loadLayoutData(s,e),dropRect:null}:{layout:a,dropRect:null},o=t.onDragStateChange,RH.add(o),null===(i=globalThis.addEventListener)||void 0===i||i.call(globalThis,"resize",t._onWindowResize),t}return(0,l.Z)(r,[{key:"getRootElement",value:function(){return this._ref}},{key:"prepareInitData",value:function(e){var t=Object.assign({},e);return rW(t,this.props.groups,this.props.loadTab),t}},{key:"getDockId",value:function(){return this.props.dockId||this}},{key:"getGroup",value:function(e){if(e){var t=this.props.groups;if(t&&e in t)return t[e];if(e===pF)return mF}return dF}},{key:"dockMove",value:function(e,t,n,r){var i=this.getLayout();if("maximize"===n?(i=tW(i,e),this.panelToFocus=e.id):i="front"===n?function(e,t){if(t){var n,r=!1,i={};if("tabs"in t?n=t:(n=t.parent).activeId!==t.id&&(i.activeId=t.id,r=!0),n&&n.parent&&"float"===n.parent.mode){var a=WH(n.z);a!==n.z&&(i.z=a,r=!0)}r&&(e=iW(e,n,zH(n,i)))}return e}(i,e):$H(i,e),t="string"===typeof t?this.find(t,jH.All):FH(t),"float"===n){var a=KH(e);a.z=WH(null),this.state.dropRect||r?i=QH(i,a,this.state.dropRect||r):(i=QH(i,a),this._ref&&(i=nW(i,this._ref.offsetWidth,this._ref.offsetHeight)))}else if("new-window"===n){i=function(e,t){var n=zH(e.windowbox);return n.children.push(t),aW(e,e.windowbox,n)}(i,KH(e))}else if(t){if("tabs"in t)if("middle"===n)i=YH(i,e,t);else i=function(e,t,n,r){var i=n.parent,a="left"===r||"right"===r?"horizontal":"vertical",o="bottom"===r||"right"===r,s=i.children.indexOf(n);if(s>=0){var u=zH(i);if(a===i.mode)o&&++s,t.size=n.size,u.children.splice(s,0,t);else{var l={mode:a,children:[]};l.size=n.size,l.children=o?[n,t]:[t,n],n.parent=l,n.size=200,t.parent=l,t.size=200,u.children[s]=l,l.parent=u}return aW(e,i,u)}return e}(i,KH(e),t,n);else if("children"in t){i=JH(i,KH(e),t,n)}else i=function(e,t,n,r){var i=n.parent.tabs.indexOf(n);return i>=0?("after-tab"===r&&++i,YH(e,t,n.parent,i)):e}(i,e,t,n)}if(i!==this.getLayout()){i=rW(i,this.props.groups);var o=e.hasOwnProperty("tabs")?e.activeId:e.id;this.changeLayout(i,o,n)}this.onDragStateChange(!1)}},{key:"find",value:function(e,t){return XH(this.getLayout(),e,t)}},{key:"getLayoutSize",value:function(){return this._ref?{width:this._ref.offsetWidth,height:this._ref.offsetHeight}:{width:0,height:0}}},{key:"updateTab",value:function(e,t){var n,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this.find(e,jH.AnyTab);if(!i)return!1;var a=i.parent,o=a.tabs.indexOf(i);if(o>=0){var s=this.props.loadTab,u=this.getLayout();if(t){var l=a.activeId;!s||"content"in t&&"title"in t||(t=s(t)),u=YH(u=$H(u,i),t,a=FH(a),o),a=FH(a),r||(a.activeId=l,this.panelToFocus=a.id)}else r&&a.activeId!==e&&(u=iW(u,a,Object.assign(Object.assign({},a),{activeId:e})));return u=rW(u,this.props.groups),this.changeLayout(u,null!==(n=null===t||void 0===t?void 0:t.id)&&void 0!==n?n:e,"update"),!0}}},{key:"navigateToPanel",value:function(e,t){if(!t)return e||(e=this._ref.querySelector(".dock-tab-active>.dock-tab-btn")),void e.focus();for(var n,r="ArrowUp"===t||"ArrowDown"===t?".dock>.dock-bar":".dock-box>.dock-panel",i=Array.from(this._ref.querySelectorAll(r)),a=i.find((function(t){return t.contains(e)})),o=a.getBoundingClientRect(),s=[],u=0,l=i;u<l.length;u++){var c=l[u];if(c!==a){var h=c.getBoundingClientRect(),f=sW(o,h,t);f>=0&&s.push({panel:c,rect:h,distance:f})}}s.sort((function(e,t){return e.distance-t.distance}));for(var d=0,p=s;d<p.length;d++){if(n=p[d].panel.querySelector(".dock-tab-active>.dock-tab-btn"))break}n&&n.focus()}},{key:"useEdgeDrop",value:function(){return"edge"===this.props.dropMode}},{key:"setDropRect",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[300,300],a=this.state.dropRect;if(a){if("remove"===t)return void(a.source===n&&this.setState({dropRect:null}));if(a.element===e&&a.direction===t&&"float"!==t)return}if(e){var o=this._ref.getBoundingClientRect(),s=this._ref.offsetWidth/o.width,u=this._ref.offsetHeight/o.height,l=e.getBoundingClientRect(),c=(l.left-o.left)*s,h=(l.top-o.top)*u,f=l.width*s,d=l.height*u,p=.5;switch(e.classList.contains("dock-box")&&(p=.3),t){case"float":var v=(r.clientX-o.left)*s,m=(r.clientY-o.top)*u;h=m-15,f=i[0],d=i[1],c=v-(f>>1);break;case"right":c+=f*(1-p);case"left":f*=p;break;case"bottom":h+=d*(1-p);case"top":d*=p;break;case"after-tab":c+=f-15,f=30;break;case"before-tab":c-=15,f=30}this.setState({dropRect:{left:c,top:h,width:f,height:d,element:e,source:n,direction:t}})}else this.setState({dropRect:null})}},{key:"render",value:function(){this.tempLayout=null;var e,n,r=this.props,i=r.style,a=r.maximizeTo,o=this.state,u=o.layout,l=o.dropRect;if(l){l.element;var c=l.direction,h=FW(l,["element","direction"]);e=Object.assign(Object.assign({},h),{display:"block"}),"float"===c&&(e.transition="none")}a?("string"===typeof a&&(a=document.getElementById(a)),n=XF.createPortal(t.createElement(UW,{boxData:u.maxbox}),a)):n=t.createElement(UW,{boxData:u.maxbox});var f,d=[],p=s(this._caches);try{for(p.s();!(f=p.n()).done;){var v=vr(f.value,2),m=(v[0],v[1]);m.portal&&d.push(m.portal)}}catch(x2){p.e(x2)}finally{p.f()}return t.createElement("div",{ref:this.getRef,className:"dock-layout",style:i},t.createElement(yF,{value:this},t.createElement(PW,{size:1,boxData:u.dockbox}),t.createElement(LW,{boxData:u.floatbox}),t.createElement(MW,{boxData:u.windowbox}),n,d),t.createElement("div",{className:"dock-drop-indicator",style:e}))}},{key:"componentDidMount",value:function(){this._isMounted=!0}},{key:"componentDidUpdate",value:function(e,t,n){var r;if(this.panelToFocus){var i=this._ref.querySelector('.dock-panel[data-dockid="'.concat(this.panelToFocus,'"]'));i&&!i.contains(this._ref.ownerDocument.activeElement)&&(null===(r=i.querySelector(".dock-bar"))||void 0===r||r.focus()),this.panelToFocus=null}}},{key:"componentWillUnmount",value:function(){var e,t;null===(e=globalThis.removeEventListener)||void 0===e||e.call(globalThis,"resize",this._onWindowResize),t=this.onDragStateChange,RH.delete(t),this._onWindowResize.cancel(),this._isMounted=!1}},{key:"setLayout",value:function(e){this.tempLayout=e,this.setState({layout:e})}},{key:"getLayout",value:function(){return this.tempLayout||this.state.layout}},{key:"changeLayout",value:function(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=this.props,o=a.layout,s=a.onLayoutChange;s&&(r=IW(e,this.props.saveTab,this.props.afterPanelSaved),e.loadedFrom=r,s(r,t,n),o&&this.forceUpdate()),o||i||this.setLayout(e)}},{key:"onSilentChange",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=this.props.onLayoutChange;if(n){var r=this.getLayout();this.changeLayout(r,e,t,!0)}}},{key:"saveLayout",value:function(){return IW(this.getLayout(),this.props.saveTab,this.props.afterPanelSaved)}},{key:"loadLayout",value:function(e){this.setLayout(r.loadLayoutData(e,this.props,this._ref.offsetWidth,this._ref.offsetHeight))}}],[{key:"loadLayoutData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=t.defaultLayout,a=t.loadTab,o=t.afterPanelLoaded,s=t.groups,u=OW(e,i,a,o);return(u=rW(u=nW(u,n,r),s)).loadedFrom=e,u}},{key:"getDerivedStateFromProps",value:function(e,t){var n=e.layout,i=t.layout;return n&&n!==i.loadedFrom?{layout:r.loadLayoutData(n,e)}:null}}]),r}(zW),VW=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},GW=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=n.apply(this,arguments)).getRef=function(t){e._ref=t},e.getDividerData=function(t){if(!e._ref)return null;var n=e.props,r=n.children,i=n.mode,a=e._ref.childNodes,o=1;if(Array.isArray(r)&&(o=r.length),a.length===2*o-1){for(var s=[],u=0;u<o;++u)"vertical"===i?s.push({size:a[2*u].offsetHeight}):s.push({size:a[2*u].offsetWidth});return{element:e._ref,beforeDivider:s.slice(0,t),afterDivider:s.slice(t)}}},e.changeSizes=function(t){var n=e.props.mode,r=e._ref.childNodes;if(r.length===2*t.length-1){for(var i=0;i<t.length;++i)"vertical"===n?r[2*i].style.height="".concat(t[i],"px"):r[2*i].style.width="".concat(t[i],"px");e.forceUpdate()}},e}return(0,l.Z)(r,[{key:"render",value:function(){var e,n=this.props,r=n.children,i=n.mode,a=n.className,o=VW(n,["children","mode","className"]),s="vertical"===i,u=[];if(Array.isArray(r))for(var l=0;l<r.length;++l)l>0&&u.push(t.createElement(RW,{idx:l,key:l,isVertical:s,getDividerData:this.getDividerData,changeSizes:this.changeSizes})),u.push(r[l]);else u=r;return e="vertical"===i?"divider-box dock-vbox":"divider-box dock-hbox",a&&(e="".concat(e," ").concat(a)),t.createElement("div",Object.assign({ref:this.getRef,className:e},o),u)}}]),r}(t.PureComponent);GW.contextType=gF;var jW=BW;function HW(e){if(!e)return!1;var t=e.parentElement;return!!t&&t.querySelector(":hover")===e}function WW(e){if(!e)return!1;var t=e.parentElement;return!!t&&t.querySelector(":focus")===e}var ZW="0123456789",qW=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var i;return(0,u.Z)(this,r),(i=n.call(this,e))._textInput=void 0,i._textInputStart=void 0,i._textInputEnd=void 0,i._time_bar_resize_observer=void 0,i._timeBarDiv=void 0,i.state={timeBarWidth:400,textValue:i.value().toFixed(i.getStep()),textStartValue:i.min().toFixed(i.getStep()),textEndValue:i.max().toFixed(i.getStep()),currValue:i.value(),currStart:i.min(),currEnd:i.max(),prevPropValue:i.value().toString(),dragStart:!1,dragValue:!1,dragEnd:!1,mouseXCoord:0},i.drag=i.drag.bind((0,c.Z)(i)),i.handleDragEnd=i.handleDragEnd.bind((0,c.Z)(i)),i._textInput=(0,t.createRef)(),i._textInputStart=(0,t.createRef)(),i._textInputEnd=(0,t.createRef)(),i._timeBarDiv=(0,t.createRef)(),i.onTextInputChange=i.onTextInputChange.bind((0,c.Z)(i)),i.onTextInputKeyDown=i.onTextInputKeyDown.bind((0,c.Z)(i)),i.onTextInputStartChange=i.onTextInputStartChange.bind((0,c.Z)(i)),i.onTextInputStartKeyDown=i.onTextInputStartKeyDown.bind((0,c.Z)(i)),i.onTextInputEndChange=i.onTextInputEndChange.bind((0,c.Z)(i)),i.onTextInputEndKeyDown=i.onTextInputEndKeyDown.bind((0,c.Z)(i)),i}return(0,l.Z)(r,[{key:"renderBackground",value:function(){return(0,rr.jsx)("rect",{stroke:r.defaultProps.stroke,fill:r.defaultProps.fill,x:r.defaultProps.x+"px",y:r.defaultProps.y+"px",width:this.width()+"px",height:r.defaultProps.height+"px"})}},{key:"onClickSelectedInterval",value:function(e){var t=this.state,n=t.currStart,i=t.currEnd,a=this.max()-this.min(),o=n/a*this.width(),s=n+(e.nativeEvent.offsetX-(r.defaultProps.x+o))/Lb((i-n)/a*this.width(),0,this.width())*(i-n);this.props.onChange(s),this.setState({currValue:s,textValue:s.toFixed(this.getStep())})}},{key:"renderSelectedInterval",value:function(){var e=this.state,t=e.currStart,n=e.currEnd,i=this.max()-this.min(),a=Lb((n-t)/i*this.width(),0,this.width()),o=t/i*this.width();return(0,rr.jsx)("rect",{stroke:r.defaultProps.stroke,fill:r.defaultProps.intFill,fillOpacity:"50%",x:r.defaultProps.x+o+"px",y:r.defaultProps.y+"px",width:a+"px",height:r.defaultProps.height+"px",onClick:this.onClickSelectedInterval.bind(this)})}},{key:"renderValueInterval",value:function(){var e=this.state,t=e.currStart,n=e.currValue,i=e.currEnd,a=this.max()-this.min(),o=Lb(n-t,0,i-t)/a*this.width(),s=t/a*this.width();return(0,rr.jsx)("rect",{stroke:r.defaultProps.stroke,fill:r.defaultProps.valFill,fillOpacity:"50%",x:r.defaultProps.x+s+"px",y:r.defaultProps.y+"px",width:o+"px",height:r.defaultProps.height+"px",onClick:this.onClickSelectedInterval.bind(this)})}},{key:"onTextInputChange",value:function(e){for(var t=e.currentTarget.value,n="",r=0,i=0;i<t.length;i++){var a=t[i];ZW.includes(a)?n+=a:0===r&&"."===a?(n+=a,r++):0===n.length&&"-"===a&&(n+=a)}this.setState({textValue:n})}},{key:"onTextInputKeyDown",value:function(e){if("enter"===e.key.toLowerCase()||"enter"===e.code.toLowerCase()){var t=e.target;if(t){var n=Lb(Number(t.value),this.state.currStart,this.state.currEnd),r=this.props.onChange;this.setState({textValue:n.toString(),currValue:n},(function(){r&&r(Number(n))}))}}else"escape"!==e.key.toLowerCase()&&"escape"!==e.code.toLowerCase()||this.setState({textValue:this.state.currValue.toFixed(this.getStep())})}},{key:"onTextInputStartChange",value:function(e){for(var t=e.currentTarget.value,n="",r=0,i=0;i<t.length;i++){var a=t[i];ZW.includes(a)?n+=a:0===r&&"."===a?(n+=a,r++):0===n.length&&"-"===a&&(n+=a)}this.setState({textStartValue:n})}},{key:"onTextInputStartKeyDown",value:function(e){if("enter"===e.key.toLowerCase()||"enter"===e.code.toLowerCase()){var t=e.target;if(t){var n=Lb(Number(t.value),this.min(),this.state.currEnd),r=Lb(this.state.currValue,n,this.state.currValue),i=this.props.onChange,a=this.props.onStartChange;n!==this.state.currStart?r!==this.state.currValue?this.setState({textStartValue:n.toString(),currStart:n,textValue:r.toString(),currValue:r},(function(){i&&i(Number(r)),a&&a(Number(n))})):this.setState({textStartValue:n.toString(),currStart:n},(function(){a&&a(Number(n))})):this.setState({textStartValue:n.toString()})}}else"escape"!==e.key.toLowerCase()&&"escape"!==e.code.toLowerCase()||this.setState({textStartValue:this.state.currStart.toFixed(this.getStep())})}},{key:"onTextInputEndChange",value:function(e){for(var t=e.currentTarget.value,n="",r=0,i=0;i<t.length;i++){var a=t[i];ZW.includes(a)?n+=a:0===r&&"."===a?(n+=a,r++):0===n.length&&"-"===a&&(n+=a)}this.setState({textEndValue:n})}},{key:"onTextInputEndKeyDown",value:function(e){if("enter"===e.key.toLowerCase()||"enter"===e.code.toLowerCase()){var t=e.target;if(t){var n=Lb(Number(t.value),this.state.currStart,this.max()),r=Lb(this.state.currValue,this.state.currValue,n),i=this.props.onChange,a=this.props.onEndChange;n!==this.state.currEnd?r!==this.state.currValue?this.setState({textEndValue:n.toString(),currEnd:n,textValue:r.toString(),currValue:r},(function(){i&&i(Number(r)),a&&a(Number(n))})):this.setState({textEndValue:n.toString(),currEnd:n},(function(){a&&a(Number(n))})):this.setState({textEndValue:n.toString()})}}else"escape"!==e.key.toLowerCase()&&"escape"!==e.code.toLowerCase()||this.setState({textEndValue:this.state.currEnd.toFixed(this.getStep())})}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0)}},{key:"handleDragEnd",value:function(){this.setState({dragStart:!1,dragEnd:!1,dragValue:!1}),this.detachDragEndListener()}},{key:"drag",value:function(e){var t=this.state,n=t.currStart,r=t.currValue,i=t.currEnd,a=t.mouseXCoord,o=this.max()-this.min(),s=(e.pageX-a)/this.width()*o;if(this.state.dragStart){var u=Lb(s+n,this.min(),i),l=Lb(r,u,r);u!==n&&(l!==r?(this.setState({currStart:u,textStartValue:u.toFixed(this.getStep()),mouseXCoord:e.pageX,currValue:l,textValue:l.toFixed(this.getStep())}),this.props.onChange(l),this.props.onStartChange(u)):(this.setState({currStart:u,textStartValue:u.toFixed(this.getStep()),mouseXCoord:e.pageX}),this.props.onStartChange(u)))}else if(this.state.dragValue){var c=Lb(s+r,n,i);c!==r&&(this.setState({currValue:c,textValue:c.toFixed(this.getStep()),mouseXCoord:e.pageX}),this.props.onChange(c))}else if(this.state.dragEnd){var h=Lb(s+i,n,this.max()),f=Lb(r,r,h);h!==i&&(f!==r?(this.setState({currEnd:h,textEndValue:h.toFixed(this.getStep()),mouseXCoord:e.pageX,currValue:f,textValue:f.toFixed(this.getStep())}),this.props.onChange(f),this.props.onEndChange(h)):(this.setState({currEnd:h,textEndValue:h.toFixed(this.getStep()),mouseXCoord:e.pageX}),this.props.onEndChange(h)))}}},{key:"dragfromotherplace",value:function(e){var t=this.state,n=t.currStart,r=t.currValue,i=t.currEnd,a=t.mouseXCoord,o=this.max()-this.min(),s=(e-a)/this.width()*o;if(this.state.dragStart){var u=Lb(s+n,this.min(),i),l=Lb(r,u,r);u!==n&&(l!==r?(this.setState({currStart:u,textStartValue:u.toFixed(this.getStep()),mouseXCoord:e,currValue:l,textValue:l.toFixed(this.getStep())}),this.props.onChange(l),this.props.onStartChange(u)):(this.setState({currStart:u,textStartValue:u.toFixed(this.getStep()),mouseXCoord:e}),this.props.onStartChange(u)))}else if(this.state.dragValue){var c=Lb(s+r,n,i);c!==r&&(this.setState({currValue:c,textValue:c.toFixed(this.getStep()),mouseXCoord:e}),this.props.onChange(c))}else if(this.state.dragEnd){var h=Lb(s+i,n,this.max()),f=Lb(r,r,h);h!==i&&(f!==r?(this.setState({currEnd:h,textEndValue:h.toFixed(this.getStep()),mouseXCoord:e,currValue:f,textValue:f.toFixed(this.getStep())}),this.props.onChange(f),this.props.onEndChange(h)):(this.setState({currEnd:h,textEndValue:h.toFixed(this.getStep()),mouseXCoord:e}),this.props.onEndChange(h)))}}},{key:"componentDidMount",value:function(){var e=this;this._time_bar_resize_observer=new ResizeObserver((function(t){e.setState({timeBarWidth:t[0].contentRect.width})})),this._timeBarDiv&&this._timeBarDiv.current&&this._time_bar_resize_observer.observe(this._timeBarDiv.current)}},{key:"componentWillUnmount",value:function(){this._time_bar_resize_observer&&this._time_bar_resize_observer.disconnect()}},{key:"componentDidUpdate",value:function(e,t){if(!HW(this._textInput.current)&&!WW(this._textInput.current)&&!HW(this._textInputStart.current)&&!WW(this._textInputStart.current)&&!HW(this._textInputEnd.current)&&!WW(this._textInputEnd.current)&&!HW(this._timeBarDiv.current)&&!WW(this._timeBarDiv.current))if(this.value().toString()!==this.state.prevPropValue){var n=this.value();this.setState({textValue:n.toFixed(this.getStep()),currValue:n,prevPropValue:n.toString()})}else this.props.currEndTime&&this.state.currEnd!==this.props.currEndTime?this.setState({textEndValue:this.props.currEndTime.toFixed(this.getStep()),currEnd:this.props.currEndTime}):this.props.currStartTime&&this.state.currStart!==this.props.currStartTime&&this.setState({textStartValue:this.props.currStartTime.toFixed(this.getStep()),currStart:this.props.currStartTime});var r=this.props.event_x;e.event_x!==r&&void 0!==r&&this.dragfromotherplace(r)}},{key:"render",value:function(){var e=this,t=this.getCurrLoc();return(0,rr.jsxs)("div",{className:"TimeBar",children:[(0,rr.jsxs)("div",{className:"inputDiv",children:[(0,rr.jsx)("input",{type:"text",value:this.state.textStartValue,onKeyDown:this.onTextInputStartKeyDown,onChange:this.onTextInputStartChange,ref:this._textInputStart}),(0,rr.jsx)("input",{type:"text",value:this.state.textValue,onKeyDown:this.onTextInputKeyDown,onChange:this.onTextInputChange,ref:this._textInput})]}),(0,rr.jsx)("div",{ref:this._timeBarDiv,className:"timeBarDiv",style:{height:"".concat(30,"px")},children:(0,rr.jsxs)("svg",{width:"".concat(this.state.timeBarWidth,"px"),height:"".concat(this.props.height,"px"),children:[this.renderBackground(),this.renderSelectedInterval(),this.renderValueInterval(),(0,rr.jsx)("rect",{fill:"#999",x:t.start+4.5+"px",y:r.defaultProps.drag_bar_y+"px",width:"6px",height:r.defaultProps.drag_bar_height+"px",onMouseDown:function(t){e.setState({dragStart:!0,mouseXCoord:t.pageX}),e.attachDragEndListener()}}),(0,rr.jsx)("rect",{fill:"#999",x:t.end+r.defaultProps.x+"px",y:r.defaultProps.drag_bar_y+"px",width:"6px",height:r.defaultProps.drag_bar_height+"px",onMouseDown:function(t){e.setState({dragEnd:!0,mouseXCoord:t.pageX}),e.attachDragEndListener()}}),(0,rr.jsx)("rect",{fill:"#555",x:t.val+r.defaultProps.x+"px",y:r.defaultProps.drag_bar_y+"px",width:"4px",height:r.defaultProps.drag_bar_height+"px",onMouseDown:function(t){e.setState({dragValue:!0,mouseXCoord:t.pageX}),e.attachDragEndListener()}})]})}),(0,rr.jsx)("div",{className:"inputDiv",children:(0,rr.jsx)("input",{type:"text",value:this.state.textEndValue,onKeyDown:this.onTextInputEndKeyDown,onChange:this.onTextInputEndChange,ref:this._textInputEnd})})]})}},{key:"min",value:function(){var e;return null!==(e=this.props.absStartTime)&&void 0!==e?e:0}},{key:"max",value:function(){var e;return Math.max(this.min(),null!==(e=this.props.absEndTime)&&void 0!==e?e:1)}},{key:"width",value:function(){var e;return(null!==(e=this.state.timeBarWidth)&&void 0!==e?e:r.defaultProps.width)-20}},{key:"value",value:function(){var e=this.props.currTime;return this.state&&this.state.currStart&&this.state.currEnd?Lb(void 0===e?this.state.currStart:e,this.state.currStart,this.state.currEnd):Lb(void 0===e?this.min():e,this.min(),this.max())}},{key:"step",value:function(){return this.props.step}},{key:"getCurrLoc",value:function(){var e=this.state,t=e.currStart,n=e.currEnd,r=e.currValue,i=this.max()-this.min(),a=n/i*this.width();return{start:t/i*this.width(),end:a,val:r/i*this.width()}}},{key:"getStep",value:function(){for(var e,t=(null!==(e=this.props.step)&&void 0!==e?e:r.defaultProps.step).toString(),n=0,i=!1,a=0;a<t.length;a++){"."===t[a]?i=!0:i&&n++}return n}}]),r}(t.Component);qW.defaultProps={drag_bar_height:20,drag_bar_y:5,height:5,width:700,x:10,y:12,fill:"#fff",stroke:"#666",intFill:"#808080",valFill:"#f88",step:.001};var XW="0123456789",YW=RU,KW=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var i;return(0,u.Z)(this,r),(i=n.call(this,e))._textInput=void 0,i._textInputStart=void 0,i._textInputEnd=void 0,i._time_bar_resize_observer=void 0,i._timeBarDiv=void 0,i.state={timeBarWidth:400,textValue:i.value().toFixed(i.getStep()),textStartValue:i.min().toFixed(i.getStep()),textEndValue:i.max().toFixed(i.getStep()),currValue:i.value(),currStart:i.min(),currEnd:i.max(),prevPropValue:i.value().toString(),dragStart:!1,dragValue:!1,dragEnd:!1,mouseXCoord:0},i.drag=i.drag.bind((0,c.Z)(i)),i.handleDragEnd=i.handleDragEnd.bind((0,c.Z)(i)),i._textInput=(0,t.createRef)(),i._textInputStart=(0,t.createRef)(),i._textInputEnd=(0,t.createRef)(),i._timeBarDiv=(0,t.createRef)(),i.onTextInputChange=i.onTextInputChange.bind((0,c.Z)(i)),i.onTextInputKeyDown=i.onTextInputKeyDown.bind((0,c.Z)(i)),i.onTextInputStartChange=i.onTextInputStartChange.bind((0,c.Z)(i)),i.onTextInputStartKeyDown=i.onTextInputStartKeyDown.bind((0,c.Z)(i)),i.onTextInputEndChange=i.onTextInputEndChange.bind((0,c.Z)(i)),i.onTextInputEndKeyDown=i.onTextInputEndKeyDown.bind((0,c.Z)(i)),i}return(0,l.Z)(r,[{key:"renderBackground",value:function(){var e=this.props.color_level;if(!e||e.length<=1)return(0,rr.jsx)("rect",{stroke:r.defaultProps.stroke,fill:r.defaultProps.fill,x:r.defaultProps.x+"px",y:r.defaultProps.y+"px",width:this.width()+"px",height:r.defaultProps.height+"px"});var t,n=this.width()/(this.max()-this.min()),i=e[1][0],a=e[1][0],o=s(e[1]);try{for(o.s();!(t=o.n()).done;){var u=t.value;u>i&&(i=u),u<a&&(a=u)}}catch(x2){o.e(x2)}finally{o.f()}var l=[];if(e[0][0]>this.min()){var c=n*(e[0][0]-this.min()),h=r.defaultProps.x;l.push((0,rr.jsx)("rect",{stroke:"#fff",fill:"#fff",x:h+"px",y:r.defaultProps.y+"px",width:c+"px",height:r.defaultProps.height+"px"}))}for(var f="#fff",d=0;d<e[0].length;d++){var p=e[1][d]>=0?this.interpolateColor(i,e[1][d],r.defaultProps.colorSpectrum[2]):this.interpolateColor(-a,-e[1][d],r.defaultProps.colorSpectrum[0]),v=d<e[0].length-1?n*(e[0][d+1]-e[0][d]):n*(this.max()-e[0][d]),m=n*(e[0][d]-this.min())+r.defaultProps.x;l.push((0,rr.jsxs)("svg",{children:[(0,rr.jsxs)("linearGradient",{id:"gradient".concat(d),x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[(0,rr.jsx)("stop",{offset:"0%",stopColor:f}),(0,rr.jsx)("stop",{offset:"100%",stopColor:p})]}),(0,rr.jsx)("rect",{stroke:"url(#gradient".concat(d,")"),fill:"url(#gradient".concat(d,")"),x:m+"px",y:r.defaultProps.y+.5+"px",width:v+"px",height:r.defaultProps.height-1+"px"},"coloredTimeBar"+d)]})),f=p}return l}},{key:"scaleColorEntry",value:function(e,t){if(0===t)return r.defaultProps.colorSpectrum[1];var n=(230-Math.round(t/e*230)).toString(16);n=1===n.length?"0"+n:n;var i=r.defaultProps.colorSpectrum[t<0?0:1];return t>0?i.substring(0,3)+n+n:i.substring(0,1)+n+n+i.substring(5)}},{key:"interpolateColor",value:function(e,t,n){return CU().domain([0,e]).range(["white",n])(t)}},{key:"renderSelectedInterval",value:function(){var e=this.state,t=e.currStart,n=e.currEnd,i=this.max()-this.min(),a=Lb((n-t)/i*this.width(),0,this.width()),o=t/i*this.width();return(0,rr.jsx)("rect",{stroke:r.defaultProps.stroke,fill:r.defaultProps.intFill,fillOpacity:"30%",x:r.defaultProps.x+o+"px",y:r.defaultProps.y+"px",width:a+"px",height:r.defaultProps.height+"px"})}},{key:"renderValueInterval",value:function(){var e=this.state,t=e.currStart,n=e.currValue,i=e.currEnd,a=this.max()-this.min(),o=Lb(n-t,0,i-t)/a*this.width(),s=t/a*this.width();return(0,rr.jsx)("rect",{stroke:r.defaultProps.stroke,fill:r.defaultProps.valFill,fillOpacity:"20%",x:r.defaultProps.x+s+"px",y:r.defaultProps.y+"px",width:o+"px",height:r.defaultProps.height+"px"})}},{key:"onTextInputChange",value:function(e){for(var t=e.currentTarget.value,n="",r=0,i=0;i<t.length;i++){var a=t[i];XW.includes(a)?n+=a:0===r&&"."===a?(n+=a,r++):0===n.length&&"-"===a&&(n+=a)}this.setState({textValue:n})}},{key:"onTextInputKeyDown",value:function(e){if("enter"===e.key.toLowerCase()||"enter"===e.code.toLowerCase()){var t=e.target;if(t){var n=Lb(Number(t.value),this.state.currStart,this.state.currEnd),r=this.props.onChange;this.setState({textValue:n.toString(),currValue:n},(function(){r&&r(Number(n))}))}}else"escape"!==e.key.toLowerCase()&&"escape"!==e.code.toLowerCase()||this.setState({textValue:this.state.currValue.toFixed(this.getStep())})}},{key:"onTextInputStartChange",value:function(e){for(var t=e.currentTarget.value,n="",r=0,i=0;i<t.length;i++){var a=t[i];XW.includes(a)?n+=a:0===r&&"."===a?(n+=a,r++):0===n.length&&"-"===a&&(n+=a)}this.setState({textStartValue:n})}},{key:"onTextInputStartKeyDown",value:function(e){if("enter"===e.key.toLowerCase()||"enter"===e.code.toLowerCase()){var t=e.target;if(t){var n=Lb(Number(t.value),this.min(),this.state.currEnd),r=Lb(this.state.currValue,n,this.state.currValue),i=this.props.onChange,a=this.props.onStartChange;n!==this.state.currStart?r!==this.state.currValue?this.setState({textStartValue:n.toString(),currStart:n,textValue:r.toString(),currValue:r},(function(){i&&i(Number(r)),a&&a(Number(n))})):this.setState({textStartValue:n.toString(),currStart:n},(function(){a&&a(Number(n))})):this.setState({textStartValue:n.toString()})}}else"escape"!==e.key.toLowerCase()&&"escape"!==e.code.toLowerCase()||this.setState({textStartValue:this.state.currStart.toFixed(this.getStep())})}},{key:"onTextInputEndChange",value:function(e){for(var t=e.currentTarget.value,n="",r=0,i=0;i<t.length;i++){var a=t[i];XW.includes(a)?n+=a:0===r&&"."===a?(n+=a,r++):0===n.length&&"-"===a&&(n+=a)}this.setState({textEndValue:n})}},{key:"onTextInputEndKeyDown",value:function(e){if("enter"===e.key.toLowerCase()||"enter"===e.code.toLowerCase()){var t=e.target;if(t){var n=Lb(Number(t.value),this.state.currStart,this.max()),r=Lb(this.state.currValue,this.state.currValue,n),i=this.props.onChange,a=this.props.onEndChange;n!==this.state.currEnd?r!==this.state.currValue?this.setState({textEndValue:n.toString(),currEnd:n,textValue:r.toString(),currValue:r},(function(){i&&i(Number(r)),a&&a(Number(n))})):this.setState({textEndValue:n.toString(),currEnd:n},(function(){a&&a(Number(n))})):this.setState({textEndValue:n.toString()})}}else"escape"!==e.key.toLowerCase()&&"escape"!==e.code.toLowerCase()||this.setState({textEndValue:this.state.currEnd.toFixed(this.getStep())})}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0)}},{key:"handleDragEnd",value:function(){this.setState({dragStart:!1,dragEnd:!1,dragValue:!1}),this.detachDragEndListener()}},{key:"drag",value:function(e){var t=this.state,n=t.currStart,r=t.currValue,i=t.currEnd,a=t.mouseXCoord,o=this.max()-this.min(),s=(e.pageX-a)/this.width()*o;if(this.state.dragStart){var u=Lb(s+n,this.min(),i),l=Lb(r,u,r);u!==n&&(l!==r?(this.setState({currStart:u,textStartValue:u.toFixed(this.getStep()),mouseXCoord:e.pageX,currValue:l,textValue:l.toFixed(this.getStep())}),this.props.onChange(l),this.props.onStartChange(u)):(this.setState({currStart:u,textStartValue:u.toFixed(this.getStep()),mouseXCoord:e.pageX}),this.props.onStartChange(u)))}else if(this.state.dragValue){var c=Lb(s+r,n,i);c!==r&&(this.setState({currValue:c,textValue:c.toFixed(this.getStep()),mouseXCoord:e.pageX}),this.props.onChange(c))}else if(this.state.dragEnd){var h=Lb(s+i,n,this.max()),f=Lb(r,r,h);h!==i&&(f!==r?(this.setState({currEnd:h,textEndValue:h.toFixed(this.getStep()),mouseXCoord:e.pageX,currValue:f,textValue:f.toFixed(this.getStep())}),this.props.onChange(f),this.props.onEndChange(h)):(this.setState({currEnd:h,textEndValue:h.toFixed(this.getStep()),mouseXCoord:e.pageX}),this.props.onEndChange(h)))}}},{key:"componentDidMount",value:function(){var e=this;this._time_bar_resize_observer=new ResizeObserver((function(t){e.setState({timeBarWidth:t[0].contentRect.width})})),this._timeBarDiv&&this._timeBarDiv.current&&this._time_bar_resize_observer.observe(this._timeBarDiv.current)}},{key:"componentWillUnmount",value:function(){this._time_bar_resize_observer&&this._time_bar_resize_observer.disconnect()}},{key:"componentDidUpdate",value:function(e,t){if(function(e){if(!e)return!1;var t=e.parentElement;return!!t&&t.querySelector(":hover")===e}(this._textInput.current)||function(e){if(!e)return!1;var t=e.parentElement;return!!t&&t.querySelector(":focus")===e}(this._textInput.current)||this.value().toString()===this.state.prevPropValue)this.props.end&&this.state.currEnd!==this.props.end?this.setState({textEndValue:this.props.end.toFixed(this.getStep()),currEnd:this.props.end}):this.props.start&&this.state.currStart!==this.props.start&&this.setState({textEndValue:this.props.start.toFixed(this.getStep()),currStart:this.props.start});else{var n=this.value();this.setState({textValue:n.toFixed(this.getStep()),currValue:n,prevPropValue:n.toString()})}}},{key:"render",value:function(){var e=this,t=this.getCurrLoc();return(0,rr.jsxs)("div",{className:"ColoredTimeBar",children:[(0,rr.jsxs)("div",{className:"inputDiv",children:[(0,rr.jsx)("input",{type:"text",value:this.state.textStartValue,onKeyDown:this.onTextInputStartKeyDown,onChange:this.onTextInputStartChange,ref:this._textInputStart}),(0,rr.jsx)("input",{type:"text",value:this.state.textValue,onKeyDown:this.onTextInputKeyDown,onChange:this.onTextInputChange,ref:this._textInput})]}),(0,rr.jsx)("div",{ref:this._timeBarDiv,className:"timeBarDiv",children:(0,rr.jsxs)("svg",{width:this.state.timeBarWidth,onMouseMove:this.drag,children:[this.renderBackground(),this.renderSelectedInterval(),this.renderValueInterval(),(0,rr.jsx)("rect",{fill:"#999",x:t.start+4.5+"px",y:r.defaultProps.drag_bar_y+"px",width:"6px",height:r.defaultProps.drag_bar_height+"px",onMouseDown:function(t){e.setState({dragStart:!0,mouseXCoord:t.pageX}),e.attachDragEndListener()}}),(0,rr.jsx)("rect",{fill:"#999",x:t.end+r.defaultProps.x+"px",y:r.defaultProps.drag_bar_y+"px",width:"6px",height:r.defaultProps.drag_bar_height+"px",onMouseDown:function(t){e.setState({dragEnd:!0,mouseXCoord:t.pageX}),e.attachDragEndListener()}}),(0,rr.jsx)("rect",{fill:"#555",x:t.val+r.defaultProps.x+"px",y:r.defaultProps.drag_bar_y+"px",width:"4px",height:r.defaultProps.drag_bar_height+"px",onMouseDown:function(t){e.setState({dragValue:!0,mouseXCoord:t.pageX}),e.attachDragEndListener()}})]})}),(0,rr.jsx)("div",{className:"inputDiv",children:(0,rr.jsx)("input",{type:"text",value:this.state.textEndValue,onKeyDown:this.onTextInputEndKeyDown,onChange:this.onTextInputEndChange,ref:this._textInputEnd})})]})}},{key:"min",value:function(){var e;return null!==(e=this.props.absStart)&&void 0!==e?e:0}},{key:"max",value:function(){var e;return Math.max(this.min(),null!==(e=this.props.absEnd)&&void 0!==e?e:1)}},{key:"width",value:function(){var e;return null!==(e=.97*this.state.timeBarWidth)&&void 0!==e?e:r.defaultProps.width}},{key:"value",value:function(){var e=this.props.value;return this.state&&this.state.currStart&&this.state.currEnd?Lb(void 0===e?this.state.currStart:e,this.state.currStart,this.state.currEnd):Lb(void 0===e?this.min():e,this.min(),this.max())}},{key:"step",value:function(){return this.props.step}},{key:"getCurrLoc",value:function(){var e=this.state,t=e.currStart,n=e.currEnd,r=e.currValue,i=this.max()-this.min(),a=n/i*this.width();return{start:t/i*this.width(),end:a,val:r/i*this.width()}}},{key:"getStep",value:function(){for(var e,t=(null!==(e=this.props.step)&&void 0!==e?e:r.defaultProps.step).toString(),n=0,i=!1,a=0;a<t.length;a++){"."===t[a]?i=!0:i&&n++}return n}}]),r}(t.Component);KW.defaultProps={drag_bar_height:20,drag_bar_y:5,height:5,width:700,x:10,y:12,gap:1,fill:"#ffffff",stroke:"#444444",intFill:"#808080",valFill:"#555555",leaveTimeOut:1e3,label:"",min:0,step:.001,max:1,value:0,colorSpectrum:[YW[1],"#ffffff",YW[0]]};var JW=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var i;return(0,u.Z)(this,r),(i=n.call(this,e))._timeBarDiv=void 0,i._time_bar_resize_observer=void 0,i._timeBarDiv=t.createRef(),i.state={timeBarWidth:400},i}return(0,l.Z)(r,[{key:"componentDidMount",value:function(){var e=this;this._time_bar_resize_observer=new ResizeObserver((function(t){e.setState({timeBarWidth:t[0].contentRect.width})})),this._timeBarDiv&&this._timeBarDiv.current&&this._time_bar_resize_observer.observe(this._timeBarDiv.current)}},{key:"componentWillUnmount",value:function(){this._time_bar_resize_observer&&this._time_bar_resize_observer.disconnect()}},{key:"render",value:function(){var e,t,n,r,i,a,o,u,l,c,h,f,d=null!==(e=this.props.step)&&void 0!==e?e:.001,v=this.state.timeBarWidth,m=30,g=this.props.timeWarp,y=this.props.timeWarpMap,b=this.props.untimeWarp;if("onBaseCurrStartTimeChange"in this.props.info){var _=this.props.info;t=_.absStartTime,n=_.currStartTime,r=_.currTime,i=_.currEndTime,a=_.absEndTime,o=_.onBaseCurrStartTimeChange,u=_.onBaseCurrTimeChange,l=_.onBaseCurrEndTimeChange,c=_.onTargetCurrStartTimeChange,h=_.onTargetCurrTimeChange,f=_.onTargetCurrEndTimeChange}else{var x=this.props.info,w=vr(x.timeRange(),5);t=w[0],n=w[1],r=w[2],i=w[3],a=w[4],o=function(e){x.setCurrStartTime(e)},u=function(e){x.setCurrTime(e)},l=function(e){x.setCurrEndTime(e)},c=function(e){x.setCurrStartTime(b(e))},h=function(e){x.setCurrTime(b(e))},f=function(e){x.setCurrEndTime(b(e))}}var S=[],M=Math.abs(a-t),k=vr(y,2),T=k[0],E=k[1];p()(T.length===E.length);for(var C=T.length,A=Math.max(Math.floor(C/(v/16)),1),R=!1,P=function(e){var t=Lb(T[e],0,M),n=Lb(E[e],0,M),r=kb(0,v,t/M),i=kb(0,v,n/M);S.push((0,rr.jsx)("line",{stroke:"#B18FCF",x1:"".concat(r,"px"),y1:"".concat(0,"px"),x2:"".concat(i,"px"),y2:"".concat(30,"px")},"".concat(r," ").concat(0," ").concat(i," ").concat(30)))},L=0;L<C;L+=A)P(L),L===C-1&&(R=!0);!R&&C>0&&P(C-1);var D,N="",I=s(this.props.timeWarpTargetName.split(" "));try{for(I.s();!(D=I.n()).done;){var O=D.value;if("Time"===O)break;N+=O+" "}}catch(x2){I.e(x2)}finally{I.f()}return(0,rr.jsxs)("div",{className:"DoubleTimeBar",children:[(0,rr.jsxs)("div",{className:"topTimeBar",children:[(0,rr.jsxs)("div",{children:["Base:"," ".concat(this.props.timeWarpBaseName)]}),(0,rr.jsx)(qW,{absStartTime:t,currStartTime:n,currTime:r,currEndTime:i,absEndTime:a,step:d,width:v,onStartChange:o,onChange:u,onEndChange:l,event_x:this.props.event_x})]}),(0,rr.jsxs)("div",{className:"middleSVG",style:{height:"".concat(m,"px")},children:[(0,rr.jsxs)("div",{className:"inputDiv",style:{height:"".concat(m,"px")},children:[(0,rr.jsx)("input",{type:"text",style:{visibility:"hidden"}}),(0,rr.jsx)("input",{type:"text",style:{visibility:"hidden"}})]}),(0,rr.jsx)("div",{className:"svgDiv",ref:this._timeBarDiv,style:{height:"".concat(m,"px"),paddingLeft:"10px",paddingRight:"10px"},children:(0,rr.jsxs)("svg",{width:v,height:"".concat(m,"px"),style:{height:"".concat(m,"px"),width:"".concat(this.state.timeBarWidth,"px")},children:[(0,rr.jsx)("rect",{fill:"rgb(23, 24, 25)",x:0,y:0,width:"".concat(v,"px"),height:"".concat(m,"px")}),S]})}),(0,rr.jsx)("div",{className:"inputDiv",style:{height:"".concat(m,"px")},children:(0,rr.jsx)("input",{type:"text",style:{visibility:"hidden"}})})]}),(0,rr.jsxs)("div",{className:"bottomTimeBar",children:[(0,rr.jsx)(qW,{absStartTime:t,currStartTime:g(n),currTime:g(r),currEndTime:g(i),absEndTime:a,step:d,width:v,onStartChange:c,onChange:h,onEndChange:f,event_x:this.props.event_x}),(0,rr.jsxs)("div",{children:["Target:"," ".concat(N)]})]})]})}}]),r}(t.Component),QW=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).onStart=function(){r.props.robotSceneManager.startAnimations(),r.setState({start:!r.state.start})},r.onPause=function(){r.props.robotSceneManager.pauseAnimations(),r.setState({start:!r.state.start})},r.onRestart=function(){r.props.robotSceneManager.restartAnimations()},r.onCurrTimeChange=function(e){r.props.robotSceneManager.setCurrTime(e)},r.onStartTimeChange=function(e){r.props.robotSceneManager.setCurrStartTime(e)},r.onEndTimeChange=function(e){r.props.robotSceneManager.setCurrEndTime(e)},r.defaultTimeBar=function(e,t){var n=vr(e.timeRange(),5),i=n[0],a=n[1],o=n[2],s=n[3],u=n[4];return(0,rr.jsx)(qW,{absStartTime:i,currStartTime:a,currTime:o,currEndTime:s,absEndTime:u,step:.001,width:400,onChange:r.onCurrTimeChange,onStartChange:r.onStartTimeChange,onEndChange:r.onEndTimeChange,event_x:r.state.event_x},t)},r.coloredTimeBar=function(e,t,n){var i=vr(e.timeRange(),5),a=i[0],o=i[1],s=i[2],u=i[3],l=i[4],c=r.getColorLevel(t);return(0,rr.jsx)(KW,{value:s,absStart:a,absEnd:l,start:o,end:u,step:.001,width:400,color_level:c,onChange:r.onCurrTimeChange,onStartChange:r.onStartTimeChange,onEndChange:r.onEndTimeChange})},r.state={currTimeBar:void 0===r.props.currTimeBar_prop?"default":r.props.currTimeBar_prop,event_x:0,start:!1},r}return(0,l.Z)(n,[{key:"getColorLevel",value:function(e){if(!e)return[];var t,n=0,r=[];for(r[0]=[],r[1]=[];n<e[0].length;){t=n+1;for(var i=0;t<e[0].length&&e[0][n]===e[0][t];)i=e[1][t]-e[1][n],t+=1;if((i/=t<e[1].length?e[1][t]-e[1][n]:1)>0)for(;n<t;)r[0].push(e[0][n]),r[1].push(i),n++;else{for(;t<e[1].length&&e[1][n]===e[1][t];)i=e[0][t]-e[0][n],t+=1;if((i/=t<e[0].length?e[0][t]-e[0][n]:1)>0)for(;n<t;)r[0].push(e[0][n]),r[1].push(-1*i),n++;else r[0].push(e[0][n]),r[1].push(0),n++}}for(var a=[],o=0;o<r[1].length;o++){var s=r[1][o],u=1;o+1<a.length&&(s+=r[1][o+1],u++),o+2<a.length&&(s+=r[1][o+2],u++),o-1>=0&&(s+=r[1][o-1],u++),o-2>=0&&(s+=r[1][o-2],u++),a.push(s/u)}return r[1]=a,console.log(a),r}},{key:"componentDidUpdate",value:function(e,t){var n=this.props.event_x;e.event_x!==n&&void 0!==n&&this.setState({event_x:n})}},{key:"displayPlayButton",value:function(){this.props.robotSceneManager;return this.state.start?(0,rr.jsx)("button",{className:"Button",value:"Stop",onClick:this.onPause,children:(0,rr.jsx)(qn,{className:"Icon",icon:Qn})}):(0,rr.jsx)("button",{className:"Button",value:"Start",onClick:this.onStart,children:(0,rr.jsx)(qn,{className:"Icon",icon:tr})})}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.robotSceneManager,i=n.targetSceneId;r.currEndTime()==r.currTime()&&!0===this.state.start&&this.setState({start:!1});var a,o=void 0===i?void 0:r.robotSceneById(i),u=[];if(void 0===(e=null===o||void 0===o?void 0:o.currTimeWarpBase()))u.push(this.defaultTimeBar(r,"DefaultTimeBar"));else{var l=[];l.push((0,rr.jsx)("option",{value:"default",children:"Default"},"default"));var c=this.props.robotSceneManager.allManagedRobotScenes().filter((function(e){return e.id().value()==i})).map((function(e){return[e,e.timeWarping()]})).filter((function(t){var n=vr(t,2),r=n[0],i=n[1];return r!==e&&void 0!==i})).map((function(e){var t=vr(e,2),n=t[0],r=t[1];return[n,r,r.timeWarp.bind(r),r.untimeWarp.bind(r),r.timeWarpMap()]})).filter((function(e){return void 0!==vr(e,5)[4]}));if(c.length>0&&(l.push((0,rr.jsx)("option",{value:"colored",children:"Colored"},"colored")),l.push((0,rr.jsx)("option",{value:"double",children:"Double"},"double"))),l.length>1&&(a=(0,rr.jsx)("select",{name:"TimeBarSelector",value:this.state.currTimeBar,onChange:function(e){var n=e.target.selectedOptions[0],r="default";void 0!==n&&(r=n.value),t.setState({currTimeBar:r})},children:l})),"colored"===this.state.currTimeBar){var h,f=s(c);try{for(f.s();!(h=f.n()).done;){var d=vr(h.value,5),p=d[0],v=d[4];u.push(this.coloredTimeBar(r,v,"ColoredTimeBar"+p.id().value()))}}catch(x2){f.e(x2)}finally{f.f()}}else if("double"===this.state.currTimeBar&&c.length>0){var m,g=s(c);try{for(g.s();!(m=g.n()).done;){var y=vr(m.value,5),b=y[0],_=y[2],x=y[3],w=y[4];u.push((0,rr.jsx)(JW,{timeWarpBaseName:e.name(),timeWarpTargetName:b.name(),timeWarp:_,untimeWarp:x,timeWarpMap:w,info:r,event_x:this.props.event_x},b.id().value()))}}catch(x2){g.e(x2)}finally{g.f()}}else u.push(this.defaultTimeBar(r,"DefaultTimeBar"))}return(0,rr.jsxs)("div",{className:"AnimationPanel",children:[!this.props.global&&a,this.displayPlayButton(),(0,rr.jsx)("button",{className:"Button",value:"Restart",onClick:this.onRestart,children:(0,rr.jsx)(qn,{className:"Icon",icon:er})}),u]})}}]),n}(t.Component),$W=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n,[{key:"render",value:function(){var e;return e="string"===typeof this.props.accept?this.props.accept:Array.isArray(this.props.accept)?this.props.accept.join(", "):"*",(0,rr.jsxs)("div",{className:"FileUploader",children:[this.props.label?(0,rr.jsx)("label",{children:this.props.label}):void 0,this.props.label&&this.props.vertical?(0,rr.jsx)("br",{}):void 0,(0,rr.jsxs)("label",{className:"fileInputHolder",children:[(0,rr.jsx)("input",Mr({type:"file",accept:e,onChange:this.props.onChange},this.props.includeDirs?{webkitdirectory:""}:{})),"Browse Files"]})]})}}]),n}(t.Component),eZ=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];var tZ=function(){function e(e){var t=this;this._insertTag=function(e){var n;n=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,n),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{n.insertRule(e,n.cssRules.length)}catch(_2){0}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){return e.parentNode&&e.parentNode.removeChild(e)})),this.tags=[],this.ctr=0},e}(),nZ=Math.abs,rZ=String.fromCharCode,iZ=Object.assign;function aZ(e){return e.trim()}function oZ(e,t,n){return e.replace(t,n)}function sZ(e,t){return e.indexOf(t)}function uZ(e,t){return 0|e.charCodeAt(t)}function lZ(e,t,n){return e.slice(t,n)}function cZ(e){return e.length}function hZ(e){return e.length}function fZ(e,t){return t.push(e),e}var dZ=1,pZ=1,vZ=0,mZ=0,gZ=0,yZ="";function bZ(e,t,n,r,i,a,o){return{value:e,root:t,parent:n,type:r,props:i,children:a,line:dZ,column:pZ,length:o,return:""}}function _Z(e,t){return iZ(bZ("",null,null,"",null,null,0),e,{length:-e.length},t)}function xZ(){return gZ=mZ>0?uZ(yZ,--mZ):0,pZ--,10===gZ&&(pZ=1,dZ--),gZ}function wZ(){return gZ=mZ<vZ?uZ(yZ,mZ++):0,pZ++,10===gZ&&(pZ=1,dZ++),gZ}function SZ(){return uZ(yZ,mZ)}function MZ(){return mZ}function kZ(e,t){return lZ(yZ,e,t)}function TZ(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function EZ(e){return dZ=pZ=1,vZ=cZ(yZ=e),mZ=0,[]}function CZ(e){return yZ="",e}function AZ(e){return aZ(kZ(mZ-1,LZ(91===e?e+2:40===e?e+1:e)))}function RZ(e){for(;(gZ=SZ())&&gZ<33;)wZ();return TZ(e)>2||TZ(gZ)>3?"":" "}function PZ(e,t){for(;--t&&wZ()&&!(gZ<48||gZ>102||gZ>57&&gZ<65||gZ>70&&gZ<97););return kZ(e,MZ()+(t<6&&32==SZ()&&32==wZ()))}function LZ(e){for(;wZ();)switch(gZ){case e:return mZ;case 34:case 39:34!==e&&39!==e&&LZ(gZ);break;case 40:41===e&&LZ(e);break;case 92:wZ()}return mZ}function DZ(e,t){for(;wZ()&&e+gZ!==57&&(e+gZ!==84||47!==SZ()););return"/*"+kZ(t,mZ-1)+"*"+rZ(47===e?e:wZ())}function NZ(e){for(;!TZ(SZ());)wZ();return kZ(e,mZ)}var IZ="-ms-",OZ="-moz-",UZ="-webkit-",FZ="comm",zZ="rule",BZ="decl",VZ="@keyframes";function GZ(e,t){for(var n="",r=hZ(e),i=0;i<r;i++)n+=t(e[i],i,e,t)||"";return n}function jZ(e,t,n,r){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case BZ:return e.return=e.return||e.value;case FZ:return"";case VZ:return e.return=e.value+"{"+GZ(e.children,r)+"}";case zZ:e.value=e.props.join(",")}return cZ(n=GZ(e.children,r))?e.return=e.value+"{"+n+"}":""}function HZ(e){return CZ(WZ("",null,null,null,[""],e=EZ(e),0,[0],e))}function WZ(e,t,n,r,i,a,o,s,u){for(var l=0,c=0,h=o,f=0,d=0,p=0,v=1,m=1,g=1,y=0,b="",_=i,x=a,w=r,S=b;m;)switch(p=y,y=wZ()){case 40:if(108!=p&&58==uZ(S,h-1)){-1!=sZ(S+=oZ(AZ(y),"&","&\f"),"&\f")&&(g=-1);break}case 34:case 39:case 91:S+=AZ(y);break;case 9:case 10:case 13:case 32:S+=RZ(p);break;case 92:S+=PZ(MZ()-1,7);continue;case 47:switch(SZ()){case 42:case 47:fZ(qZ(DZ(wZ(),MZ()),t,n),u);break;default:S+="/"}break;case 123*v:s[l++]=cZ(S)*g;case 125*v:case 59:case 0:switch(y){case 0:case 125:m=0;case 59+c:-1==g&&(S=oZ(S,/\f/g,"")),d>0&&cZ(S)-h&&fZ(d>32?XZ(S+";",r,n,h-1):XZ(oZ(S," ","")+";",r,n,h-2),u);break;case 59:S+=";";default:if(fZ(w=ZZ(S,t,n,l,c,i,s,b,_=[],x=[],h),a),123===y)if(0===c)WZ(S,t,w,w,_,a,h,s,x);else switch(99===f&&110===uZ(S,3)?100:f){case 100:case 108:case 109:case 115:WZ(e,w,w,r&&fZ(ZZ(e,w,w,0,0,i,s,b,i,_=[],h),x),i,x,h,s,r?_:x);break;default:WZ(S,w,w,w,[""],x,0,s,x)}}l=c=d=0,v=g=1,b=S="",h=o;break;case 58:h=1+cZ(S),d=p;default:if(v<1)if(123==y)--v;else if(125==y&&0==v++&&125==xZ())continue;switch(S+=rZ(y),y*v){case 38:g=c>0?1:(S+="\f",-1);break;case 44:s[l++]=(cZ(S)-1)*g,g=1;break;case 64:45===SZ()&&(S+=AZ(wZ())),f=SZ(),c=h=cZ(b=S+=NZ(MZ())),y++;break;case 45:45===p&&2==cZ(S)&&(v=0)}}return a}function ZZ(e,t,n,r,i,a,o,s,u,l,c){for(var h=i-1,f=0===i?a:[""],d=hZ(f),p=0,v=0,m=0;p<r;++p)for(var g=0,y=lZ(e,h+1,h=nZ(v=o[p])),b=e;g<d;++g)(b=aZ(v>0?f[g]+" "+y:oZ(y,/&\f/g,f[g])))&&(u[m++]=b);return bZ(e,t,n,0===i?zZ:s,u,l,c)}function qZ(e,t,n){return bZ(e,t,n,FZ,rZ(gZ),lZ(e,2,-2),0)}function XZ(e,t,n,r){return bZ(e,t,n,BZ,lZ(e,0,r),lZ(e,r+1,-1),r)}var YZ=function(e,t,n){for(var r=0,i=0;r=i,i=SZ(),38===r&&12===i&&(t[n]=1),!TZ(i);)wZ();return kZ(e,mZ)},KZ=function(e,t){return CZ(function(e,t){var n=-1,r=44;do{switch(TZ(r)){case 0:38===r&&12===SZ()&&(t[n]=1),e[n]+=YZ(mZ-1,t,n);break;case 2:e[n]+=AZ(r);break;case 4:if(44===r){e[++n]=58===SZ()?"&\f":"",t[n]=e[n].length;break}default:e[n]+=rZ(r)}}while(r=wZ());return e}(EZ(e),t))},JZ=new WeakMap,QZ=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,n=e.parent,r=e.column===n.column&&e.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||JZ.get(n))&&!r){JZ.set(e,!0);for(var i=[],a=KZ(t,i),o=n.props,s=0,u=0;s<a.length;s++)for(var l=0;l<o.length;l++,u++)e.props[u]=i[s]?a[s].replace(/&\f/g,o[l]):o[l]+" "+a[s]}}},$Z=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function eq(e,t){switch(function(e,t){return 45^uZ(e,0)?(((t<<2^uZ(e,0))<<2^uZ(e,1))<<2^uZ(e,2))<<2^uZ(e,3):0}(e,t)){case 5103:return"-webkit-print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return UZ+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return UZ+e+OZ+e+IZ+e+e;case 6828:case 4268:return UZ+e+IZ+e+e;case 6165:return UZ+e+IZ+"flex-"+e+e;case 5187:return UZ+e+oZ(e,/(\w+).+(:[^]+)/,"-webkit-box-$1$2-ms-flex-$1$2")+e;case 5443:return UZ+e+IZ+"flex-item-"+oZ(e,/flex-|-self/,"")+e;case 4675:return UZ+e+IZ+"flex-line-pack"+oZ(e,/align-content|flex-|-self/,"")+e;case 5548:return UZ+e+IZ+oZ(e,"shrink","negative")+e;case 5292:return UZ+e+IZ+oZ(e,"basis","preferred-size")+e;case 6060:return"-webkit-box-"+oZ(e,"-grow","")+UZ+e+IZ+oZ(e,"grow","positive")+e;case 4554:return UZ+oZ(e,/([^-])(transform)/g,"$1-webkit-$2")+e;case 6187:return oZ(oZ(oZ(e,/(zoom-|grab)/,"-webkit-$1"),/(image-set)/,"-webkit-$1"),e,"")+e;case 5495:case 3959:return oZ(e,/(image-set\([^]*)/,"-webkit-$1$`$1");case 4968:return oZ(oZ(e,/(.+:)(flex-)?(.*)/,"-webkit-box-pack:$3-ms-flex-pack:$3"),/s.+-b[^;]+/,"justify")+UZ+e+e;case 4095:case 3583:case 4068:case 2532:return oZ(e,/(.+)-inline(.+)/,"-webkit-$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(cZ(e)-1-t>6)switch(uZ(e,t+1)){case 109:if(45!==uZ(e,t+4))break;case 102:return oZ(e,/(.+:)(.+)-([^]+)/,"$1-webkit-$2-$3$1-moz-"+(108==uZ(e,t+3)?"$3":"$2-$3"))+e;case 115:return~sZ(e,"stretch")?eq(oZ(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==uZ(e,t+1))break;case 6444:switch(uZ(e,cZ(e)-3-(~sZ(e,"!important")&&10))){case 107:return oZ(e,":",":-webkit-")+e;case 101:return oZ(e,/(.+:)([^;!]+)(;|!.+)?/,"$1-webkit-"+(45===uZ(e,14)?"inline-":"")+"box$3$1"+"-webkit-$2$3$1"+"-ms-$2box$3")+e}break;case 5936:switch(uZ(e,t+11)){case 114:return UZ+e+IZ+oZ(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return UZ+e+IZ+oZ(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return UZ+e+IZ+oZ(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return UZ+e+IZ+e+e}return e}var tq=[function(e,t,n,r){if(e.length>-1&&!e.return)switch(e.type){case BZ:e.return=eq(e.value,e.length);break;case VZ:return GZ([_Z(e,{value:oZ(e.value,"@","@-webkit-")})],r);case zZ:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,(function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return GZ([_Z(e,{props:[oZ(t,/:(read-\w+)/,":-moz-$1")]})],r);case"::placeholder":return GZ([_Z(e,{props:[oZ(t,/:(plac\w+)/,":-webkit-input-$1")]}),_Z(e,{props:[oZ(t,/:(plac\w+)/,":-moz-$1")]}),_Z(e,{props:[oZ(t,/:(plac\w+)/,"-ms-input-$1")]})],r)}return""}))}}],nq=function(e){var t=e.key;if("css"===t){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var r=e.stylisPlugins||tq;var i,a,o={},s=[];i=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),n=1;n<t.length;n++)o[t[n]]=!0;s.push(e)}));var u,l,c=[jZ,(l=function(e){u.insert(e)},function(e){e.root||(e=e.return)&&l(e)})],h=function(e){var t=hZ(e);return function(n,r,i,a){for(var o="",s=0;s<t;s++)o+=e[s](n,r,i,a)||"";return o}}([QZ,$Z].concat(r,c));a=function(e,t,n,r){u=n,function(e){GZ(HZ(e),h)}(e?e+"{"+t.styles+"}":t.styles),r&&(f.inserted[t.name]=!0)};var f={key:t,sheet:new tZ({key:t,container:i,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:o,registered:{},insert:a};return f.sheet.hydrate(s),f};function rq(e,t,n){var r="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):r+=n+" "})),r}var iq=function(e,t,n){var r=e.key+"-"+t.name;!1===n&&void 0===e.registered[r]&&(e.registered[r]=t.styles)},aq=function(e,t,n){iq(e,t,n);var r=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var i=t;do{e.insert(t===i?"."+r:"",i,e.sheet,!0),i=i.next}while(void 0!==i)}};var oq={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function sq(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}var uq=/[A-Z]|^ms/g,lq=/_EMO_([^_]+?)_([^]*?)_EMO_/g,cq=function(e){return 45===e.charCodeAt(1)},hq=function(e){return null!=e&&"boolean"!==typeof e},fq=sq((function(e){return cq(e)?e:e.replace(uq,"-$&").toLowerCase()})),dq=function(e,t){switch(e){case"animation":case"animationName":if("string"===typeof t)return t.replace(lq,(function(e,t,n){return vq={name:t,styles:n,next:vq},t}))}return 1===oq[e]||cq(e)||"number"!==typeof t||0===t?t:t+"px"};function pq(e,t,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return vq={name:n.name,styles:n.styles,next:vq},n.name;if(void 0!==n.styles){var r=n.next;if(void 0!==r)for(;void 0!==r;)vq={name:r.name,styles:r.styles,next:vq},r=r.next;return n.styles+";"}return function(e,t,n){var r="";if(Array.isArray(n))for(var i=0;i<n.length;i++)r+=pq(e,t,n[i])+";";else for(var a in n){var o=n[a];if("object"!==typeof o)null!=t&&void 0!==t[o]?r+=a+"{"+t[o]+"}":hq(o)&&(r+=fq(a)+":"+dq(a,o)+";");else if(!Array.isArray(o)||"string"!==typeof o[0]||null!=t&&void 0!==t[o[0]]){var s=pq(e,t,o);switch(a){case"animation":case"animationName":r+=fq(a)+":"+s+";";break;default:r+=a+"{"+s+"}"}}else for(var u=0;u<o.length;u++)hq(o[u])&&(r+=fq(a)+":"+dq(a,o[u])+";")}return r}(e,t,n);case"function":if(void 0!==e){var i=vq,a=n(e);return vq=i,pq(e,t,a)}}if(null==t)return n;var o=t[n];return void 0!==o?o:n}var vq,mq=/label:\s*([^\s;\n{]+)\s*(;|$)/g;var gq=function(e,t,n){if(1===e.length&&"object"===typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var r=!0,i="";vq=void 0;var a=e[0];null==a||void 0===a.raw?(r=!1,i+=pq(n,t,a)):i+=a[0];for(var o=1;o<e.length;o++)i+=pq(n,t,e[o]),r&&(i+=a[o]);mq.lastIndex=0;for(var s,u="";null!==(s=mq.exec(i));)u+="-"+s[1];var l=function(e){for(var t,n=0,r=0,i=e.length;i>=4;++r,i-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(i){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}(i)+u;return{name:l,styles:i,next:vq}},yq=!!r.useInsertionEffect&&r.useInsertionEffect,bq=yq||function(e){return e()},_q=(yq||t.useLayoutEffect,{}.hasOwnProperty),xq=t.createContext("undefined"!==typeof HTMLElement?nq({key:"css"}):null);xq.Provider;var wq=function(e){return(0,t.forwardRef)((function(n,r){var i=(0,t.useContext)(xq);return e(n,i,r)}))};var Sq=t.createContext({});var Mq="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",kq=function(e,t){var n={};for(var r in t)_q.call(t,r)&&(n[r]=t[r]);return n[Mq]=e,n},Tq=function(e){var t=e.cache,n=e.serialized,r=e.isStringTag;return iq(t,n,r),bq((function(){return aq(t,n,r)})),null};var Eq=wq((function(e,n,r){var i=e.css;"string"===typeof i&&void 0!==n.registered[i]&&(i=n.registered[i]);var a=e[Mq],o=[i],s="";"string"===typeof e.className?s=rq(n.registered,o,e.className):null!=e.className&&(s=e.className+" ");var u=gq(o,void 0,t.useContext(Sq));s+=n.key+"-"+u.name;var l={};for(var c in e)_q.call(e,c)&&"css"!==c&&c!==Mq&&(l[c]=e[c]);return l.ref=r,l.className=s,t.createElement(t.Fragment,null,t.createElement(Tq,{cache:n,serialized:u,isStringTag:"string"===typeof a}),t.createElement(a,l))})),Cq=(n(2110),function(e,n){var r=arguments;if(null==n||!_q.call(n,"css"))return t.createElement.apply(void 0,r);var i=r.length,a=new Array(i);a[0]=Eq,a[1]=kq(e,n);for(var o=2;o<i;o++)a[o]=r[o];return t.createElement.apply(null,a)});function Aq(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return gq(t)}var Rq=function(){var e=Aq.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}};function Pq(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Lq=Math.min,Dq=Math.max,Nq=Math.round,Iq=Math.floor,Oq=function(e){return{x:e,y:e}};function Uq(e){return Mr(Mr({},e),{},{top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height})}function Fq(e){return Vq(e)?(e.nodeName||"").toLowerCase():"#document"}function zq(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function Bq(e){var t;return null==(t=(Vq(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function Vq(e){return e instanceof Node||e instanceof zq(e).Node}function Gq(e){return e instanceof Element||e instanceof zq(e).Element}function jq(e){return e instanceof HTMLElement||e instanceof zq(e).HTMLElement}function Hq(e){return"undefined"!==typeof ShadowRoot&&(e instanceof ShadowRoot||e instanceof zq(e).ShadowRoot)}function Wq(e){var t=Xq(e),n=t.overflow,r=t.overflowX,i=t.overflowY,a=t.display;return/auto|scroll|overlay|hidden|clip/.test(n+i+r)&&!["inline","contents"].includes(a)}function Zq(){return!("undefined"===typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function qq(e){return["html","body","#document"].includes(Fq(e))}function Xq(e){return zq(e).getComputedStyle(e)}function Yq(e){if("html"===Fq(e))return e;var t=e.assignedSlot||e.parentNode||Hq(e)&&e.host||Bq(e);return Hq(t)?t.host:t}function Kq(e){var t=Yq(e);return qq(t)?e.ownerDocument?e.ownerDocument.body:e.body:jq(t)&&Wq(t)?t:Kq(t)}function Jq(e,t,n){var r;void 0===t&&(t=[]),void 0===n&&(n=!0);var i=Kq(e),a=i===(null==(r=e.ownerDocument)?void 0:r.body),o=zq(i);return a?t.concat(o,o.visualViewport||[],Wq(i)?i:[],o.frameElement&&n?Jq(o.frameElement):[]):t.concat(i,Jq(i,[],n))}function Qq(e){var t=Xq(e),n=parseFloat(t.width)||0,r=parseFloat(t.height)||0,i=jq(e),a=i?e.offsetWidth:n,o=i?e.offsetHeight:r,s=Nq(n)!==a||Nq(r)!==o;return s&&(n=a,r=o),{width:n,height:r,$:s}}function $q(e){return Gq(e)?e:e.contextElement}function eX(e){var t=$q(e);if(!jq(t))return Oq(1);var n=t.getBoundingClientRect(),r=Qq(t),i=r.width,a=r.height,o=r.$,s=(o?Nq(n.width):n.width)/i,u=(o?Nq(n.height):n.height)/a;return s&&Number.isFinite(s)||(s=1),u&&Number.isFinite(u)||(u=1),{x:s,y:u}}var tX=Oq(0);function nX(e){var t=zq(e);return Zq()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:tX}function rX(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=!1);var i=e.getBoundingClientRect(),a=$q(e),o=Oq(1);t&&(r?Gq(r)&&(o=eX(r)):o=eX(e));var s=function(e,t,n){return void 0===t&&(t=!1),!(!n||t&&n!==zq(e))&&t}(a,n,r)?nX(a):Oq(0),u=(i.left+s.x)/o.x,l=(i.top+s.y)/o.y,c=i.width/o.x,h=i.height/o.y;if(a)for(var f=zq(a),d=r&&Gq(r)?zq(r):r,p=f.frameElement;p&&r&&d!==f;){var v=eX(p),m=p.getBoundingClientRect(),g=Xq(p),y=m.left+(p.clientLeft+parseFloat(g.paddingLeft))*v.x,b=m.top+(p.clientTop+parseFloat(g.paddingTop))*v.y;u*=v.x,l*=v.y,c*=v.x,h*=v.y,u+=y,l+=b,p=zq(p).frameElement}return Uq({width:c,height:h,x:u,y:l})}function iX(e,t,n,r){void 0===r&&(r={});var i=r,a=i.ancestorScroll,o=void 0===a||a,s=i.ancestorResize,u=void 0===s||s,l=i.elementResize,c=void 0===l?"function"===typeof ResizeObserver:l,h=i.layoutShift,f=void 0===h?"function"===typeof IntersectionObserver:h,d=i.animationFrame,p=void 0!==d&&d,v=$q(e),m=o||u?[].concat(cr(v?Jq(v):[]),cr(Jq(t))):[];m.forEach((function(e){o&&e.addEventListener("scroll",n,{passive:!0}),u&&e.addEventListener("resize",n)}));var g,y=v&&f?function(e,t){var n,r=null,i=Bq(e);function a(){clearTimeout(n),r&&r.disconnect(),r=null}return function o(s,u){void 0===s&&(s=!1),void 0===u&&(u=1),a();var l=e.getBoundingClientRect(),c=l.left,h=l.top,f=l.width,d=l.height;if(s||t(),f&&d){var p={rootMargin:-Iq(h)+"px "+-Iq(i.clientWidth-(c+f))+"px "+-Iq(i.clientHeight-(h+d))+"px "+-Iq(c)+"px",threshold:Dq(0,Lq(1,u))||1},v=!0;try{r=new IntersectionObserver(m,Mr(Mr({},p),{},{root:i.ownerDocument}))}catch(_2){r=new IntersectionObserver(m,p)}r.observe(e)}function m(e){var t=e[0].intersectionRatio;if(t!==u){if(!v)return o();t?o(!1,t):n=setTimeout((function(){o(!1,1e-7)}),100)}v=!1}}(!0),a}(v,n):null,b=-1,_=null;c&&(_=new ResizeObserver((function(e){var r=vr(e,1)[0];r&&r.target===v&&_&&(_.unobserve(t),cancelAnimationFrame(b),b=requestAnimationFrame((function(){_&&_.observe(t)}))),n()})),v&&!p&&_.observe(v),_.observe(t));var x=p?rX(e):null;return p&&function t(){var r=rX(e);!x||r.x===x.x&&r.y===x.y&&r.width===x.width&&r.height===x.height||n();x=r,g=requestAnimationFrame(t)}(),n(),function(){m.forEach((function(e){o&&e.removeEventListener("scroll",n),u&&e.removeEventListener("resize",n)})),y&&y(),_&&_.disconnect(),_=null,p&&cancelAnimationFrame(g)}}var aX=t.useLayoutEffect,oX=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],sX=function(){};function uX(e,t){return t?"-"===t[0]?e+t:e+"__"+t:e}function lX(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var a=[].concat(r);if(t&&e)for(var o in t)t.hasOwnProperty(o)&&t[o]&&a.push("".concat(uX(e,o)));return a.filter((function(e){return e})).map((function(e){return String(e).trim()})).join(" ")}var cX=function(e){return t=e,Array.isArray(t)?e.filter(Boolean):"object"===(0,hr.Z)(e)&&null!==e?[e]:[];var t},hX=function(e){return e.className,e.clearValue,e.cx,e.getStyles,e.getClassNames,e.getValue,e.hasValue,e.isMulti,e.isRtl,e.options,e.selectOption,e.selectProps,e.setValue,e.theme,Mr({},xF(e,oX))},fX=function(e,t,n){var r=e.cx,i=e.getStyles,a=e.getClassNames,o=e.className;return{css:i(t,e),className:r(null!==n&&void 0!==n?n:{},a(t,e),o)}};function dX(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function pX(e){return dX(e)?window.pageYOffset:e.scrollTop}function vX(e,t){dX(e)?window.scrollTo(0,t):e.scrollTop=t}function mX(e,t,n,r){return n*((e=e/r-1)*e*e+1)+t}function gX(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:sX,i=pX(e),a=t-i,o=10,s=0;function u(){var t=mX(s+=o,i,a,n);vX(e,t),s<n?window.requestAnimationFrame(u):r(e)}u()}function yX(e,t){var n=e.getBoundingClientRect(),r=t.getBoundingClientRect(),i=t.offsetHeight/3;r.bottom+i>n.bottom?vX(e,Math.min(t.offsetTop+t.clientHeight-e.offsetHeight+i,e.scrollHeight)):r.top-i<n.top&&vX(e,Math.max(t.offsetTop-i,0))}function bX(){try{return document.createEvent("TouchEvent"),!0}catch(_2){return!1}}var _X=!1,xX={get passive(){return _X=!0}},wX="undefined"!==typeof window?window:{};wX.addEventListener&&wX.removeEventListener&&(wX.addEventListener("p",sX,xX),wX.removeEventListener("p",sX,!1));var SX=_X;function MX(e){return null!=e}function kX(e,t,n){return e?t:n}function TX(e){var t=e.maxHeight,n=e.menuEl,r=e.minHeight,i=e.placement,a=e.shouldScroll,o=e.isFixedPosition,s=e.controlHeight,u=function(e){var t=getComputedStyle(e),n="absolute"===t.position,r=/(auto|scroll)/;if("fixed"===t.position)return document.documentElement;for(var i=e;i=i.parentElement;)if(t=getComputedStyle(i),(!n||"static"!==t.position)&&r.test(t.overflow+t.overflowY+t.overflowX))return i;return document.documentElement}(n),l={placement:"bottom",maxHeight:t};if(!n||!n.offsetParent)return l;var c,h=u.getBoundingClientRect().height,f=n.getBoundingClientRect(),d=f.bottom,p=f.height,v=f.top,m=n.offsetParent.getBoundingClientRect().top,g=o?window.innerHeight:dX(c=u)?window.innerHeight:c.clientHeight,y=pX(u),b=parseInt(getComputedStyle(n).marginBottom,10),_=parseInt(getComputedStyle(n).marginTop,10),x=m-_,w=g-v,S=x+y,M=h-y-v,k=d-g+y+b,T=y+v-_,E=160;switch(i){case"auto":case"bottom":if(w>=p)return{placement:"bottom",maxHeight:t};if(M>=p&&!o)return a&&gX(u,k,E),{placement:"bottom",maxHeight:t};if(!o&&M>=r||o&&w>=r)return a&&gX(u,k,E),{placement:"bottom",maxHeight:o?w-b:M-b};if("auto"===i||o){var C=t,A=o?x:S;return A>=r&&(C=Math.min(A-b-s,t)),{placement:"top",maxHeight:C}}if("bottom"===i)return a&&vX(u,k),{placement:"bottom",maxHeight:t};break;case"top":if(x>=p)return{placement:"top",maxHeight:t};if(S>=p&&!o)return a&&gX(u,T,E),{placement:"top",maxHeight:t};if(!o&&S>=r||o&&x>=r){var R=t;return(!o&&S>=r||o&&x>=r)&&(R=o?x-_:S-_),a&&gX(u,T,E),{placement:"top",maxHeight:R}}return{placement:"bottom",maxHeight:t};default:throw new Error('Invalid placement provided "'.concat(i,'".'))}return l}var EX=function(e){return"auto"===e?"bottom":e},CX=(0,t.createContext)(null),AX=function(e){var n=e.children,r=e.minMenuHeight,i=e.maxMenuHeight,a=e.menuPlacement,o=e.menuPosition,s=e.menuShouldScrollIntoView,u=e.theme,l=((0,t.useContext)(CX)||{}).setPortalPlacement,c=(0,t.useRef)(null),h=vr((0,t.useState)(i),2),f=h[0],d=h[1],p=vr((0,t.useState)(null),2),v=p[0],m=p[1],g=u.spacing.controlHeight;return aX((function(){var e=c.current;if(e){var t="fixed"===o,n=TX({maxHeight:i,menuEl:e,minHeight:r,placement:a,shouldScroll:s&&!t,isFixedPosition:t,controlHeight:g});d(n.maxHeight),m(n.placement),null===l||void 0===l||l(n.placement)}}),[i,a,o,s,r,l,g]),n({ref:c,placerProps:Mr(Mr({},e),{},{placement:v||EX(a),maxHeight:f})})},RX=function(e,t){var n=e.theme,r=n.spacing.baseUnit,i=n.colors;return Mr({textAlign:"center"},t?{}:{color:i.neutral40,padding:"".concat(2*r,"px ").concat(3*r,"px")})},PX=RX,LX=RX,DX=function(e){var t=e.children,n=e.innerProps;return Cq("div",bF({},fX(e,"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),n),t)};DX.defaultProps={children:"No options"};var NX=function(e){var t=e.children,n=e.innerProps;return Cq("div",bF({},fX(e,"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),n),t)};NX.defaultProps={children:"Loading..."};var IX,OX=["size"];var UX={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},FX=function(e){var t=e.size,n=xF(e,OX);return Cq("svg",bF({height:t,width:t,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:UX},n))},zX=function(e){return Cq(FX,bF({size:20},e),Cq("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},BX=function(e){return Cq(FX,bF({size:20},e),Cq("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},VX=function(e,t){var n=e.isFocused,r=e.theme,i=r.spacing.baseUnit,a=r.colors;return Mr({label:"indicatorContainer",display:"flex",transition:"color 150ms"},t?{}:{color:n?a.neutral60:a.neutral20,padding:2*i,":hover":{color:n?a.neutral80:a.neutral40}})},GX=VX,jX=VX,HX=Rq(IX||(IX=Pq(["\n  0%, 80%, 100% { opacity: 0; }\n  40% { opacity: 1; }\n"]))),WX=function(e){var t=e.delay,n=e.offset;return Cq("span",{css:Aq({animation:"".concat(HX," 1s ease-in-out ").concat(t,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:n?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},ZX=function(e){var t=e.innerProps,n=e.isRtl;return Cq("div",bF({},fX(e,"loadingIndicator",{indicator:!0,"loading-indicator":!0}),t),Cq(WX,{delay:0,offset:n}),Cq(WX,{delay:160,offset:!0}),Cq(WX,{delay:320,offset:!n}))};ZX.defaultProps={size:4};var qX=["data"],XX=["innerRef","isDisabled","isHidden","inputClassName"],YX={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},KX={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":Mr({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},YX)},JX=function(e){return Mr({label:"input",color:"inherit",background:0,opacity:e?0:1,width:"100%"},YX)},QX=function(e){var t=e.children,n=e.innerProps;return Cq("div",n,t)};var $X={ClearIndicator:function(e){var t=e.children,n=e.innerProps;return Cq("div",bF({},fX(e,"clearIndicator",{indicator:!0,"clear-indicator":!0}),n),t||Cq(zX,null))},Control:function(e){var t=e.children,n=e.isDisabled,r=e.isFocused,i=e.innerRef,a=e.innerProps,o=e.menuIsOpen;return Cq("div",bF({ref:i},fX(e,"control",{control:!0,"control--is-disabled":n,"control--is-focused":r,"control--menu-is-open":o}),a),t)},DropdownIndicator:function(e){var t=e.children,n=e.innerProps;return Cq("div",bF({},fX(e,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),n),t||Cq(BX,null))},DownChevron:BX,CrossIcon:zX,Group:function(e){var t=e.children,n=e.cx,r=e.getStyles,i=e.getClassNames,a=e.Heading,o=e.headingProps,s=e.innerProps,u=e.label,l=e.theme,c=e.selectProps;return Cq("div",bF({},fX(e,"group",{group:!0}),s),Cq(a,bF({},o,{selectProps:c,theme:l,getStyles:r,getClassNames:i,cx:n}),u),Cq("div",null,t))},GroupHeading:function(e){var t=hX(e);t.data;var n=xF(t,qX);return Cq("div",bF({},fX(e,"groupHeading",{"group-heading":!0}),n))},IndicatorsContainer:function(e){var t=e.children,n=e.innerProps;return Cq("div",bF({},fX(e,"indicatorsContainer",{indicators:!0}),n),t)},IndicatorSeparator:function(e){var t=e.innerProps;return Cq("span",bF({},t,fX(e,"indicatorSeparator",{"indicator-separator":!0})))},Input:function(e){var t=e.cx,n=e.value,r=hX(e),i=r.innerRef,a=r.isDisabled,o=r.isHidden,s=r.inputClassName,u=xF(r,XX);return Cq("div",bF({},fX(e,"input",{"input-container":!0}),{"data-value":n||""}),Cq("input",bF({className:t({input:!0},s),ref:i,style:JX(o),disabled:a},u)))},LoadingIndicator:ZX,Menu:function(e){var t=e.children,n=e.innerRef,r=e.innerProps;return Cq("div",bF({},fX(e,"menu",{menu:!0}),{ref:n},r),t)},MenuList:function(e){var t=e.children,n=e.innerProps,r=e.innerRef,i=e.isMulti;return Cq("div",bF({},fX(e,"menuList",{"menu-list":!0,"menu-list--is-multi":i}),{ref:r},n),t)},MenuPortal:function(e){var n=e.appendTo,r=e.children,i=e.controlElement,a=e.innerProps,o=e.menuPlacement,s=e.menuPosition,u=(0,t.useRef)(null),l=(0,t.useRef)(null),c=vr((0,t.useState)(EX(o)),2),h=c[0],f=c[1],d=(0,t.useMemo)((function(){return{setPortalPlacement:f}}),[]),p=vr((0,t.useState)(null),2),v=p[0],m=p[1],g=(0,t.useCallback)((function(){if(i){var e=function(e){var t=e.getBoundingClientRect();return{bottom:t.bottom,height:t.height,left:t.left,right:t.right,top:t.top,width:t.width}}(i),t="fixed"===s?0:window.pageYOffset,n=e[h]+t;n===(null===v||void 0===v?void 0:v.offset)&&e.left===(null===v||void 0===v?void 0:v.rect.left)&&e.width===(null===v||void 0===v?void 0:v.rect.width)||m({offset:n,rect:e})}}),[i,s,h,null===v||void 0===v?void 0:v.offset,null===v||void 0===v?void 0:v.rect.left,null===v||void 0===v?void 0:v.rect.width]);aX((function(){g()}),[g]);var y=(0,t.useCallback)((function(){"function"===typeof l.current&&(l.current(),l.current=null),i&&u.current&&(l.current=iX(i,u.current,g,{elementResize:"ResizeObserver"in window}))}),[i,g]);aX((function(){y()}),[y]);var b=(0,t.useCallback)((function(e){u.current=e,y()}),[y]);if(!n&&"fixed"!==s||!v)return null;var _=Cq("div",bF({ref:b},fX(Mr(Mr({},e),{},{offset:v.offset,position:s,rect:v.rect}),"menuPortal",{"menu-portal":!0}),a),r);return Cq(CX.Provider,{value:d},n?(0,XF.createPortal)(_,n):_)},LoadingMessage:NX,NoOptionsMessage:DX,MultiValue:function(e){var t=e.children,n=e.components,r=e.data,i=e.innerProps,a=e.isDisabled,o=e.removeProps,s=e.selectProps,u=n.Container,l=n.Label,c=n.Remove;return Cq(u,{data:r,innerProps:Mr(Mr({},fX(e,"multiValue",{"multi-value":!0,"multi-value--is-disabled":a})),i),selectProps:s},Cq(l,{data:r,innerProps:Mr({},fX(e,"multiValueLabel",{"multi-value__label":!0})),selectProps:s},t),Cq(c,{data:r,innerProps:Mr(Mr({},fX(e,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(t||"option")},o),selectProps:s}))},MultiValueContainer:QX,MultiValueLabel:QX,MultiValueRemove:function(e){var t=e.children,n=e.innerProps;return Cq("div",bF({role:"button"},n),t||Cq(zX,{size:14}))},Option:function(e){var t=e.children,n=e.isDisabled,r=e.isFocused,i=e.isSelected,a=e.innerRef,o=e.innerProps;return Cq("div",bF({},fX(e,"option",{option:!0,"option--is-disabled":n,"option--is-focused":r,"option--is-selected":i}),{ref:a,"aria-disabled":n},o),t)},Placeholder:function(e){var t=e.children,n=e.innerProps;return Cq("div",bF({},fX(e,"placeholder",{placeholder:!0}),n),t)},SelectContainer:function(e){var t=e.children,n=e.innerProps,r=e.isDisabled,i=e.isRtl;return Cq("div",bF({},fX(e,"container",{"--is-disabled":r,"--is-rtl":i}),n),t)},SingleValue:function(e){var t=e.children,n=e.isDisabled,r=e.innerProps;return Cq("div",bF({},fX(e,"singleValue",{"single-value":!0,"single-value--is-disabled":n}),r),t)},ValueContainer:function(e){var t=e.children,n=e.innerProps,r=e.isMulti,i=e.hasValue;return Cq("div",bF({},fX(e,"valueContainer",{"value-container":!0,"value-container--is-multi":r,"value-container--has-value":i}),n),t)}},eY=Number.isNaN||function(e){return"number"===typeof e&&e!==e};function tY(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(r=e[n],i=t[n],!(r===i||eY(r)&&eY(i)))return!1;var r,i;return!0}for(var nY={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},rY=function(e){return Cq("span",bF({css:nY},e))},iY={guidance:function(e){var t=e.isSearchable,n=e.isMulti,r=e.isDisabled,i=e.tabSelectsValue;switch(e.context){case"menu":return"Use Up and Down to choose options".concat(r?"":", press Enter to select the currently focused option",", press Escape to exit the menu").concat(i?", press Tab to select the option and exit the menu":"",".");case"input":return"".concat(e["aria-label"]||"Select"," is focused ").concat(t?",type to refine list":"",", press Down to open the menu, ").concat(n?" press left to focus selected values":"");case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(e){var t=e.action,n=e.label,r=void 0===n?"":n,i=e.labels,a=e.isDisabled;switch(t){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(r,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(i.length>1?"s":""," ").concat(i.join(","),", selected.");case"select-option":return"option ".concat(r,a?" is disabled. Select another option.":", selected.");default:return""}},onFocus:function(e){var t=e.context,n=e.focused,r=e.options,i=e.label,a=void 0===i?"":i,o=e.selectValue,s=e.isDisabled,u=e.isSelected,l=function(e,t){return e&&e.length?"".concat(e.indexOf(t)+1," of ").concat(e.length):""};if("value"===t&&o)return"value ".concat(a," focused, ").concat(l(o,n),".");if("menu"===t){var c=s?" disabled":"",h="".concat(u?"selected":"focused").concat(c);return"option ".concat(a," ").concat(h,", ").concat(l(r,n),".")}return""},onFilter:function(e){var t=e.inputValue,n=e.resultsMessage;return"".concat(n).concat(t?" for search term "+t:"",".")}},aY=function(e){var n=e.ariaSelection,r=e.focusedOption,i=e.focusedValue,a=e.focusableOptions,o=e.isFocused,s=e.selectValue,u=e.selectProps,l=e.id,c=u.ariaLiveMessages,h=u.getOptionLabel,f=u.inputValue,d=u.isMulti,p=u.isOptionDisabled,v=u.isSearchable,m=u.menuIsOpen,g=u.options,y=u.screenReaderStatus,b=u.tabSelectsValue,_=u["aria-label"],x=u["aria-live"],w=(0,t.useMemo)((function(){return Mr(Mr({},iY),c||{})}),[c]),S=(0,t.useMemo)((function(){var e,t="";if(n&&w.onChange){var r=n.option,i=n.options,a=n.removedValue,o=n.removedValues,u=n.value,l=a||r||(e=u,Array.isArray(e)?null:e),c=l?h(l):"",f=i||o||void 0,d=f?f.map(h):[],v=Mr({isDisabled:l&&p(l,s),label:c,labels:d},n);t=w.onChange(v)}return t}),[n,w,p,s,h]),M=(0,t.useMemo)((function(){var e="",t=r||i,n=!!(r&&s&&s.includes(r));if(t&&w.onFocus){var o={focused:t,label:h(t),isDisabled:p(t,s),isSelected:n,options:a,context:t===r?"menu":"value",selectValue:s};e=w.onFocus(o)}return e}),[r,i,h,p,w,a,s]),k=(0,t.useMemo)((function(){var e="";if(m&&g.length&&w.onFilter){var t=y({count:a.length});e=w.onFilter({inputValue:f,resultsMessage:t})}return e}),[a,f,m,w,g,y]),T=(0,t.useMemo)((function(){var e="";if(w.guidance){var t=i?"value":m?"menu":"input";e=w.guidance({"aria-label":_,context:t,isDisabled:r&&p(r,s),isMulti:d,isSearchable:v,tabSelectsValue:b})}return e}),[_,r,i,d,p,v,m,w,s,b]),E="".concat(M," ").concat(k," ").concat(T),C=Cq(t.Fragment,null,Cq("span",{id:"aria-selection"},S),Cq("span",{id:"aria-context"},E)),A="initial-input-focus"===(null===n||void 0===n?void 0:n.action);return Cq(t.Fragment,null,Cq(rY,{id:l},A&&C),Cq(rY,{"aria-live":x,"aria-atomic":"false","aria-relevant":"additions text"},o&&!A&&C))},oY=[{base:"A",letters:"A\u24b6\uff21\xc0\xc1\xc2\u1ea6\u1ea4\u1eaa\u1ea8\xc3\u0100\u0102\u1eb0\u1eae\u1eb4\u1eb2\u0226\u01e0\xc4\u01de\u1ea2\xc5\u01fa\u01cd\u0200\u0202\u1ea0\u1eac\u1eb6\u1e00\u0104\u023a\u2c6f"},{base:"AA",letters:"\ua732"},{base:"AE",letters:"\xc6\u01fc\u01e2"},{base:"AO",letters:"\ua734"},{base:"AU",letters:"\ua736"},{base:"AV",letters:"\ua738\ua73a"},{base:"AY",letters:"\ua73c"},{base:"B",letters:"B\u24b7\uff22\u1e02\u1e04\u1e06\u0243\u0182\u0181"},{base:"C",letters:"C\u24b8\uff23\u0106\u0108\u010a\u010c\xc7\u1e08\u0187\u023b\ua73e"},{base:"D",letters:"D\u24b9\uff24\u1e0a\u010e\u1e0c\u1e10\u1e12\u1e0e\u0110\u018b\u018a\u0189\ua779"},{base:"DZ",letters:"\u01f1\u01c4"},{base:"Dz",letters:"\u01f2\u01c5"},{base:"E",letters:"E\u24ba\uff25\xc8\xc9\xca\u1ec0\u1ebe\u1ec4\u1ec2\u1ebc\u0112\u1e14\u1e16\u0114\u0116\xcb\u1eba\u011a\u0204\u0206\u1eb8\u1ec6\u0228\u1e1c\u0118\u1e18\u1e1a\u0190\u018e"},{base:"F",letters:"F\u24bb\uff26\u1e1e\u0191\ua77b"},{base:"G",letters:"G\u24bc\uff27\u01f4\u011c\u1e20\u011e\u0120\u01e6\u0122\u01e4\u0193\ua7a0\ua77d\ua77e"},{base:"H",letters:"H\u24bd\uff28\u0124\u1e22\u1e26\u021e\u1e24\u1e28\u1e2a\u0126\u2c67\u2c75\ua78d"},{base:"I",letters:"I\u24be\uff29\xcc\xcd\xce\u0128\u012a\u012c\u0130\xcf\u1e2e\u1ec8\u01cf\u0208\u020a\u1eca\u012e\u1e2c\u0197"},{base:"J",letters:"J\u24bf\uff2a\u0134\u0248"},{base:"K",letters:"K\u24c0\uff2b\u1e30\u01e8\u1e32\u0136\u1e34\u0198\u2c69\ua740\ua742\ua744\ua7a2"},{base:"L",letters:"L\u24c1\uff2c\u013f\u0139\u013d\u1e36\u1e38\u013b\u1e3c\u1e3a\u0141\u023d\u2c62\u2c60\ua748\ua746\ua780"},{base:"LJ",letters:"\u01c7"},{base:"Lj",letters:"\u01c8"},{base:"M",letters:"M\u24c2\uff2d\u1e3e\u1e40\u1e42\u2c6e\u019c"},{base:"N",letters:"N\u24c3\uff2e\u01f8\u0143\xd1\u1e44\u0147\u1e46\u0145\u1e4a\u1e48\u0220\u019d\ua790\ua7a4"},{base:"NJ",letters:"\u01ca"},{base:"Nj",letters:"\u01cb"},{base:"O",letters:"O\u24c4\uff2f\xd2\xd3\xd4\u1ed2\u1ed0\u1ed6\u1ed4\xd5\u1e4c\u022c\u1e4e\u014c\u1e50\u1e52\u014e\u022e\u0230\xd6\u022a\u1ece\u0150\u01d1\u020c\u020e\u01a0\u1edc\u1eda\u1ee0\u1ede\u1ee2\u1ecc\u1ed8\u01ea\u01ec\xd8\u01fe\u0186\u019f\ua74a\ua74c"},{base:"OI",letters:"\u01a2"},{base:"OO",letters:"\ua74e"},{base:"OU",letters:"\u0222"},{base:"P",letters:"P\u24c5\uff30\u1e54\u1e56\u01a4\u2c63\ua750\ua752\ua754"},{base:"Q",letters:"Q\u24c6\uff31\ua756\ua758\u024a"},{base:"R",letters:"R\u24c7\uff32\u0154\u1e58\u0158\u0210\u0212\u1e5a\u1e5c\u0156\u1e5e\u024c\u2c64\ua75a\ua7a6\ua782"},{base:"S",letters:"S\u24c8\uff33\u1e9e\u015a\u1e64\u015c\u1e60\u0160\u1e66\u1e62\u1e68\u0218\u015e\u2c7e\ua7a8\ua784"},{base:"T",letters:"T\u24c9\uff34\u1e6a\u0164\u1e6c\u021a\u0162\u1e70\u1e6e\u0166\u01ac\u01ae\u023e\ua786"},{base:"TZ",letters:"\ua728"},{base:"U",letters:"U\u24ca\uff35\xd9\xda\xdb\u0168\u1e78\u016a\u1e7a\u016c\xdc\u01db\u01d7\u01d5\u01d9\u1ee6\u016e\u0170\u01d3\u0214\u0216\u01af\u1eea\u1ee8\u1eee\u1eec\u1ef0\u1ee4\u1e72\u0172\u1e76\u1e74\u0244"},{base:"V",letters:"V\u24cb\uff36\u1e7c\u1e7e\u01b2\ua75e\u0245"},{base:"VY",letters:"\ua760"},{base:"W",letters:"W\u24cc\uff37\u1e80\u1e82\u0174\u1e86\u1e84\u1e88\u2c72"},{base:"X",letters:"X\u24cd\uff38\u1e8a\u1e8c"},{base:"Y",letters:"Y\u24ce\uff39\u1ef2\xdd\u0176\u1ef8\u0232\u1e8e\u0178\u1ef6\u1ef4\u01b3\u024e\u1efe"},{base:"Z",letters:"Z\u24cf\uff3a\u0179\u1e90\u017b\u017d\u1e92\u1e94\u01b5\u0224\u2c7f\u2c6b\ua762"},{base:"a",letters:"a\u24d0\uff41\u1e9a\xe0\xe1\xe2\u1ea7\u1ea5\u1eab\u1ea9\xe3\u0101\u0103\u1eb1\u1eaf\u1eb5\u1eb3\u0227\u01e1\xe4\u01df\u1ea3\xe5\u01fb\u01ce\u0201\u0203\u1ea1\u1ead\u1eb7\u1e01\u0105\u2c65\u0250"},{base:"aa",letters:"\ua733"},{base:"ae",letters:"\xe6\u01fd\u01e3"},{base:"ao",letters:"\ua735"},{base:"au",letters:"\ua737"},{base:"av",letters:"\ua739\ua73b"},{base:"ay",letters:"\ua73d"},{base:"b",letters:"b\u24d1\uff42\u1e03\u1e05\u1e07\u0180\u0183\u0253"},{base:"c",letters:"c\u24d2\uff43\u0107\u0109\u010b\u010d\xe7\u1e09\u0188\u023c\ua73f\u2184"},{base:"d",letters:"d\u24d3\uff44\u1e0b\u010f\u1e0d\u1e11\u1e13\u1e0f\u0111\u018c\u0256\u0257\ua77a"},{base:"dz",letters:"\u01f3\u01c6"},{base:"e",letters:"e\u24d4\uff45\xe8\xe9\xea\u1ec1\u1ebf\u1ec5\u1ec3\u1ebd\u0113\u1e15\u1e17\u0115\u0117\xeb\u1ebb\u011b\u0205\u0207\u1eb9\u1ec7\u0229\u1e1d\u0119\u1e19\u1e1b\u0247\u025b\u01dd"},{base:"f",letters:"f\u24d5\uff46\u1e1f\u0192\ua77c"},{base:"g",letters:"g\u24d6\uff47\u01f5\u011d\u1e21\u011f\u0121\u01e7\u0123\u01e5\u0260\ua7a1\u1d79\ua77f"},{base:"h",letters:"h\u24d7\uff48\u0125\u1e23\u1e27\u021f\u1e25\u1e29\u1e2b\u1e96\u0127\u2c68\u2c76\u0265"},{base:"hv",letters:"\u0195"},{base:"i",letters:"i\u24d8\uff49\xec\xed\xee\u0129\u012b\u012d\xef\u1e2f\u1ec9\u01d0\u0209\u020b\u1ecb\u012f\u1e2d\u0268\u0131"},{base:"j",letters:"j\u24d9\uff4a\u0135\u01f0\u0249"},{base:"k",letters:"k\u24da\uff4b\u1e31\u01e9\u1e33\u0137\u1e35\u0199\u2c6a\ua741\ua743\ua745\ua7a3"},{base:"l",letters:"l\u24db\uff4c\u0140\u013a\u013e\u1e37\u1e39\u013c\u1e3d\u1e3b\u017f\u0142\u019a\u026b\u2c61\ua749\ua781\ua747"},{base:"lj",letters:"\u01c9"},{base:"m",letters:"m\u24dc\uff4d\u1e3f\u1e41\u1e43\u0271\u026f"},{base:"n",letters:"n\u24dd\uff4e\u01f9\u0144\xf1\u1e45\u0148\u1e47\u0146\u1e4b\u1e49\u019e\u0272\u0149\ua791\ua7a5"},{base:"nj",letters:"\u01cc"},{base:"o",letters:"o\u24de\uff4f\xf2\xf3\xf4\u1ed3\u1ed1\u1ed7\u1ed5\xf5\u1e4d\u022d\u1e4f\u014d\u1e51\u1e53\u014f\u022f\u0231\xf6\u022b\u1ecf\u0151\u01d2\u020d\u020f\u01a1\u1edd\u1edb\u1ee1\u1edf\u1ee3\u1ecd\u1ed9\u01eb\u01ed\xf8\u01ff\u0254\ua74b\ua74d\u0275"},{base:"oi",letters:"\u01a3"},{base:"ou",letters:"\u0223"},{base:"oo",letters:"\ua74f"},{base:"p",letters:"p\u24df\uff50\u1e55\u1e57\u01a5\u1d7d\ua751\ua753\ua755"},{base:"q",letters:"q\u24e0\uff51\u024b\ua757\ua759"},{base:"r",letters:"r\u24e1\uff52\u0155\u1e59\u0159\u0211\u0213\u1e5b\u1e5d\u0157\u1e5f\u024d\u027d\ua75b\ua7a7\ua783"},{base:"s",letters:"s\u24e2\uff53\xdf\u015b\u1e65\u015d\u1e61\u0161\u1e67\u1e63\u1e69\u0219\u015f\u023f\ua7a9\ua785\u1e9b"},{base:"t",letters:"t\u24e3\uff54\u1e6b\u1e97\u0165\u1e6d\u021b\u0163\u1e71\u1e6f\u0167\u01ad\u0288\u2c66\ua787"},{base:"tz",letters:"\ua729"},{base:"u",letters:"u\u24e4\uff55\xf9\xfa\xfb\u0169\u1e79\u016b\u1e7b\u016d\xfc\u01dc\u01d8\u01d6\u01da\u1ee7\u016f\u0171\u01d4\u0215\u0217\u01b0\u1eeb\u1ee9\u1eef\u1eed\u1ef1\u1ee5\u1e73\u0173\u1e77\u1e75\u0289"},{base:"v",letters:"v\u24e5\uff56\u1e7d\u1e7f\u028b\ua75f\u028c"},{base:"vy",letters:"\ua761"},{base:"w",letters:"w\u24e6\uff57\u1e81\u1e83\u0175\u1e87\u1e85\u1e98\u1e89\u2c73"},{base:"x",letters:"x\u24e7\uff58\u1e8b\u1e8d"},{base:"y",letters:"y\u24e8\uff59\u1ef3\xfd\u0177\u1ef9\u0233\u1e8f\xff\u1ef7\u1e99\u1ef5\u01b4\u024f\u1eff"},{base:"z",letters:"z\u24e9\uff5a\u017a\u1e91\u017c\u017e\u1e93\u1e95\u01b6\u0225\u0240\u2c6c\ua763"}],sY=new RegExp("["+oY.map((function(e){return e.letters})).join("")+"]","g"),uY={},lY=0;lY<oY.length;lY++)for(var cY=oY[lY],hY=0;hY<cY.letters.length;hY++)uY[cY.letters[hY]]=cY.base;var fY=function(e){return e.replace(sY,(function(e){return uY[e]}))},dY=function(e,t){void 0===t&&(t=tY);var n=null;function r(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(n&&n.lastThis===this&&t(r,n.lastArgs))return n.lastResult;var a=e.apply(this,r);return n={lastResult:a,lastArgs:r,lastThis:this},a}return r.clear=function(){n=null},r}(fY),pY=function(e){return e.replace(/^\s+|\s+$/g,"")},vY=function(e){return"".concat(e.label," ").concat(e.value)},mY=["innerRef"];function gY(e){var t=e.innerRef,n=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=Object.entries(e).filter((function(e){var t=vr(e,1)[0];return!n.includes(t)}));return i.reduce((function(e,t){var n=vr(t,2),r=n[0],i=n[1];return e[r]=i,e}),{})}(xF(e,mY),"onExited","in","enter","exit","appear");return Cq("input",bF({ref:t},n,{css:Aq({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var yY=["boxSizing","height","overflow","paddingRight","position"],bY={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function _Y(e){e.preventDefault()}function xY(e){e.stopPropagation()}function wY(){var e=this.scrollTop,t=this.scrollHeight,n=e+this.offsetHeight;0===e?this.scrollTop=1:n===t&&(this.scrollTop=e-1)}function SY(){return"ontouchstart"in window||navigator.maxTouchPoints}var MY=!("undefined"===typeof window||!window.document||!window.document.createElement),kY=0,TY={capture:!1,passive:!1};var EY=function(){return document.activeElement&&document.activeElement.blur()},CY={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function AY(e){var n=e.children,r=e.lockEnabled,i=e.captureEnabled,a=function(e){var n=e.isEnabled,r=e.onBottomArrive,i=e.onBottomLeave,a=e.onTopArrive,o=e.onTopLeave,s=(0,t.useRef)(!1),u=(0,t.useRef)(!1),l=(0,t.useRef)(0),c=(0,t.useRef)(null),h=(0,t.useCallback)((function(e,t){if(null!==c.current){var n=c.current,l=n.scrollTop,h=n.scrollHeight,f=n.clientHeight,d=c.current,p=t>0,v=h-f-l,m=!1;v>t&&s.current&&(i&&i(e),s.current=!1),p&&u.current&&(o&&o(e),u.current=!1),p&&t>v?(r&&!s.current&&r(e),d.scrollTop=h,m=!0,s.current=!0):!p&&-t>l&&(a&&!u.current&&a(e),d.scrollTop=0,m=!0,u.current=!0),m&&function(e){e.preventDefault(),e.stopPropagation()}(e)}}),[r,i,a,o]),f=(0,t.useCallback)((function(e){h(e,e.deltaY)}),[h]),d=(0,t.useCallback)((function(e){l.current=e.changedTouches[0].clientY}),[]),p=(0,t.useCallback)((function(e){var t=l.current-e.changedTouches[0].clientY;h(e,t)}),[h]),v=(0,t.useCallback)((function(e){if(e){var t=!!SX&&{passive:!1};e.addEventListener("wheel",f,t),e.addEventListener("touchstart",d,t),e.addEventListener("touchmove",p,t)}}),[p,d,f]),m=(0,t.useCallback)((function(e){e&&(e.removeEventListener("wheel",f,!1),e.removeEventListener("touchstart",d,!1),e.removeEventListener("touchmove",p,!1))}),[p,d,f]);return(0,t.useEffect)((function(){if(n){var e=c.current;return v(e),function(){m(e)}}}),[n,v,m]),function(e){c.current=e}}({isEnabled:void 0===i||i,onBottomArrive:e.onBottomArrive,onBottomLeave:e.onBottomLeave,onTopArrive:e.onTopArrive,onTopLeave:e.onTopLeave}),o=function(e){var n=e.isEnabled,r=e.accountForScrollbars,i=void 0===r||r,a=(0,t.useRef)({}),o=(0,t.useRef)(null),s=(0,t.useCallback)((function(e){if(MY){var t=document.body,n=t&&t.style;if(i&&yY.forEach((function(e){var t=n&&n[e];a.current[e]=t})),i&&kY<1){var r=parseInt(a.current.paddingRight,10)||0,o=document.body?document.body.clientWidth:0,s=window.innerWidth-o+r||0;Object.keys(bY).forEach((function(e){var t=bY[e];n&&(n[e]=t)})),n&&(n.paddingRight="".concat(s,"px"))}t&&SY()&&(t.addEventListener("touchmove",_Y,TY),e&&(e.addEventListener("touchstart",wY,TY),e.addEventListener("touchmove",xY,TY))),kY+=1}}),[i]),u=(0,t.useCallback)((function(e){if(MY){var t=document.body,n=t&&t.style;kY=Math.max(kY-1,0),i&&kY<1&&yY.forEach((function(e){var t=a.current[e];n&&(n[e]=t)})),t&&SY()&&(t.removeEventListener("touchmove",_Y,TY),e&&(e.removeEventListener("touchstart",wY,TY),e.removeEventListener("touchmove",xY,TY)))}}),[i]);return(0,t.useEffect)((function(){if(n){var e=o.current;return s(e),function(){u(e)}}}),[n,s,u]),function(e){o.current=e}}({isEnabled:r});return Cq(t.Fragment,null,r&&Cq("div",{onClick:EY,css:CY}),n((function(e){a(e),o(e)})))}var RY={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},PY=function(e){var t=e.name,n=e.onFocus;return Cq("input",{required:!0,name:t,tabIndex:-1,onFocus:n,css:RY,value:"",onChange:function(){}})},LY={clearIndicator:jX,container:function(e){var t=e.isDisabled;return{label:"container",direction:e.isRtl?"rtl":void 0,pointerEvents:t?"none":void 0,position:"relative"}},control:function(e,t){var n=e.isDisabled,r=e.isFocused,i=e.theme,a=i.colors,o=i.borderRadius;return Mr({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:i.spacing.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},t?{}:{backgroundColor:n?a.neutral5:a.neutral0,borderColor:n?a.neutral10:r?a.primary:a.neutral20,borderRadius:o,borderStyle:"solid",borderWidth:1,boxShadow:r?"0 0 0 1px ".concat(a.primary):void 0,"&:hover":{borderColor:r?a.primary:a.neutral30}})},dropdownIndicator:GX,group:function(e,t){var n=e.theme.spacing;return t?{}:{paddingBottom:2*n.baseUnit,paddingTop:2*n.baseUnit}},groupHeading:function(e,t){var n=e.theme,r=n.colors,i=n.spacing;return Mr({label:"group",cursor:"default",display:"block"},t?{}:{color:r.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:3*i.baseUnit,paddingRight:3*i.baseUnit,textTransform:"uppercase"})},indicatorsContainer:function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},indicatorSeparator:function(e,t){var n=e.isDisabled,r=e.theme,i=r.spacing.baseUnit,a=r.colors;return Mr({label:"indicatorSeparator",alignSelf:"stretch",width:1},t?{}:{backgroundColor:n?a.neutral10:a.neutral20,marginBottom:2*i,marginTop:2*i})},input:function(e,t){var n=e.isDisabled,r=e.value,i=e.theme,a=i.spacing,o=i.colors;return Mr(Mr({visibility:n?"hidden":"visible",transform:r?"translateZ(0)":""},KX),t?{}:{margin:a.baseUnit/2,paddingBottom:a.baseUnit/2,paddingTop:a.baseUnit/2,color:o.neutral80})},loadingIndicator:function(e,t){var n=e.isFocused,r=e.size,i=e.theme,a=i.colors,o=i.spacing.baseUnit;return Mr({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:r,lineHeight:1,marginRight:r,textAlign:"center",verticalAlign:"middle"},t?{}:{color:n?a.neutral60:a.neutral20,padding:2*o})},loadingMessage:LX,menu:function(e,t){var n,r=e.placement,i=e.theme,a=i.borderRadius,o=i.spacing,s=i.colors;return Mr((gr(n={label:"menu"},function(e){return e?{bottom:"top",top:"bottom"}[e]:"bottom"}(r),"100%"),gr(n,"position","absolute"),gr(n,"width","100%"),gr(n,"zIndex",1),n),t?{}:{backgroundColor:s.neutral0,borderRadius:a,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:o.menuGutter,marginTop:o.menuGutter})},menuList:function(e,t){var n=e.maxHeight,r=e.theme.spacing.baseUnit;return Mr({maxHeight:n,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},t?{}:{paddingBottom:r,paddingTop:r})},menuPortal:function(e){var t=e.rect,n=e.offset,r=e.position;return{left:t.left,position:r,top:n,width:t.width,zIndex:1}},multiValue:function(e,t){var n=e.theme,r=n.spacing,i=n.borderRadius,a=n.colors;return Mr({label:"multiValue",display:"flex",minWidth:0},t?{}:{backgroundColor:a.neutral10,borderRadius:i/2,margin:r.baseUnit/2})},multiValueLabel:function(e,t){var n=e.theme,r=n.borderRadius,i=n.colors,a=e.cropWithEllipsis;return Mr({overflow:"hidden",textOverflow:a||void 0===a?"ellipsis":void 0,whiteSpace:"nowrap"},t?{}:{borderRadius:r/2,color:i.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},multiValueRemove:function(e,t){var n=e.theme,r=n.spacing,i=n.borderRadius,a=n.colors,o=e.isFocused;return Mr({alignItems:"center",display:"flex"},t?{}:{borderRadius:i/2,backgroundColor:o?a.dangerLight:void 0,paddingLeft:r.baseUnit,paddingRight:r.baseUnit,":hover":{backgroundColor:a.dangerLight,color:a.danger}})},noOptionsMessage:PX,option:function(e,t){var n=e.isDisabled,r=e.isFocused,i=e.isSelected,a=e.theme,o=a.spacing,s=a.colors;return Mr({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},t?{}:{backgroundColor:i?s.primary:r?s.primary25:"transparent",color:n?s.neutral20:i?s.neutral0:"inherit",padding:"".concat(2*o.baseUnit,"px ").concat(3*o.baseUnit,"px"),":active":{backgroundColor:n?void 0:i?s.primary:s.primary50}})},placeholder:function(e,t){var n=e.theme,r=n.spacing,i=n.colors;return Mr({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},t?{}:{color:i.neutral50,marginLeft:r.baseUnit/2,marginRight:r.baseUnit/2})},singleValue:function(e,t){var n=e.isDisabled,r=e.theme,i=r.spacing,a=r.colors;return Mr({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t?{}:{color:n?a.neutral40:a.neutral80,marginLeft:i.baseUnit/2,marginRight:i.baseUnit/2})},valueContainer:function(e,t){var n=e.theme.spacing,r=e.isMulti,i=e.hasValue,a=e.selectProps.controlShouldRenderValue;return Mr({alignItems:"center",display:r&&i&&a?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},t?{}:{padding:"".concat(n.baseUnit/2,"px ").concat(2*n.baseUnit,"px")})}};var DY={borderRadius:4,colors:{primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},spacing:{baseUnit:4,controlHeight:38,menuGutter:8}},NY={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:bX(),captureMenuScroll:!bX(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:function(e){return function(t,n){if(t.data.__isNew__)return!0;var r=Mr({ignoreCase:!0,ignoreAccents:!0,stringify:vY,trim:!0,matchFrom:"any"},e),i=r.ignoreCase,a=r.ignoreAccents,o=r.stringify,s=r.trim,u=r.matchFrom,l=s?pY(n):n,c=s?pY(o(t)):o(t);return i&&(l=l.toLowerCase(),c=c.toLowerCase()),a&&(l=dY(l),c=fY(c)),"start"===u?c.substr(0,l.length)===l:c.indexOf(l)>-1}}(),formatGroupLabel:function(e){return e.label},getOptionLabel:function(e){return e.label},getOptionValue:function(e){return e.value},isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:function(e){return!!e.isDisabled},loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!function(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch(_2){return!1}}(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(e){var t=e.count;return"".concat(t," result").concat(1!==t?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function IY(e,t,n,r){return{type:"option",data:t,isDisabled:VY(e,t,n),isSelected:GY(e,t,n),label:zY(e,t),value:BY(e,t),index:r}}function OY(e,t){return e.options.map((function(n,r){if("options"in n){var i=n.options.map((function(n,r){return IY(e,n,t,r)})).filter((function(t){return FY(e,t)}));return i.length>0?{type:"group",data:n,options:i,index:r}:void 0}var a=IY(e,n,t,r);return FY(e,a)?a:void 0})).filter(MX)}function UY(e){return e.reduce((function(e,t){return"group"===t.type?e.push.apply(e,cr(t.options.map((function(e){return e.data})))):e.push(t.data),e}),[])}function FY(e,t){var n=e.inputValue,r=void 0===n?"":n,i=t.data,a=t.isSelected,o=t.label,s=t.value;return(!HY(e)||!a)&&jY(e,{label:o,value:s,data:i},r)}var zY=function(e,t){return e.getOptionLabel(t)},BY=function(e,t){return e.getOptionValue(t)};function VY(e,t,n){return"function"===typeof e.isOptionDisabled&&e.isOptionDisabled(t,n)}function GY(e,t,n){if(n.indexOf(t)>-1)return!0;if("function"===typeof e.isOptionSelected)return e.isOptionSelected(t,n);var r=BY(e,t);return n.some((function(t){return BY(e,t)===r}))}function jY(e,t,n){return!e.filterOption||e.filterOption(t,n)}var HY=function(e){var t=e.hideSelectedOptions,n=e.isMulti;return void 0===t?n:t},WY=1,ZY=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var t;if((0,u.Z)(this,r),(t=n.call(this,e)).state={ariaSelection:null,focusedOption:null,focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0},t.blockOptionHover=!1,t.isComposing=!1,t.commonProps=void 0,t.initialTouchX=0,t.initialTouchY=0,t.instancePrefix="",t.openAfterFocus=!1,t.scrollToFocusedOptionOnUpdate=!1,t.userIsDragging=void 0,t.controlRef=null,t.getControlRef=function(e){t.controlRef=e},t.focusedOptionRef=null,t.getFocusedOptionRef=function(e){t.focusedOptionRef=e},t.menuListRef=null,t.getMenuListRef=function(e){t.menuListRef=e},t.inputRef=null,t.getInputRef=function(e){t.inputRef=e},t.focus=t.focusInput,t.blur=t.blurInput,t.onChange=function(e,n){var r=t.props,i=r.onChange,a=r.name;n.name=a,t.ariaOnChange(e,n),i(e,n)},t.setValue=function(e,n,r){var i=t.props,a=i.closeMenuOnSelect,o=i.isMulti,s=i.inputValue;t.onInputChange("",{action:"set-value",prevInputValue:s}),a&&(t.setState({inputIsHiddenAfterUpdate:!o}),t.onMenuClose()),t.setState({clearFocusValueOnUpdate:!0}),t.onChange(e,{action:n,option:r})},t.selectOption=function(e){var n=t.props,r=n.blurInputOnSelect,i=n.isMulti,a=n.name,o=t.state.selectValue,s=i&&t.isOptionSelected(e,o),u=t.isOptionDisabled(e,o);if(s){var l=t.getOptionValue(e);t.setValue(o.filter((function(e){return t.getOptionValue(e)!==l})),"deselect-option",e)}else{if(u)return void t.ariaOnChange(e,{action:"select-option",option:e,name:a});i?t.setValue([].concat(cr(o),[e]),"select-option",e):t.setValue(e,"select-option")}r&&t.blurInput()},t.removeValue=function(e){var n=t.props.isMulti,r=t.state.selectValue,i=t.getOptionValue(e),a=r.filter((function(e){return t.getOptionValue(e)!==i})),o=kX(n,a,a[0]||null);t.onChange(o,{action:"remove-value",removedValue:e}),t.focusInput()},t.clearValue=function(){var e=t.state.selectValue;t.onChange(kX(t.props.isMulti,[],null),{action:"clear",removedValues:e})},t.popValue=function(){var e=t.props.isMulti,n=t.state.selectValue,r=n[n.length-1],i=n.slice(0,n.length-1),a=kX(e,i,i[0]||null);t.onChange(a,{action:"pop-value",removedValue:r})},t.getValue=function(){return t.state.selectValue},t.cx=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return lX.apply(void 0,[t.props.classNamePrefix].concat(n))},t.getOptionLabel=function(e){return zY(t.props,e)},t.getOptionValue=function(e){return BY(t.props,e)},t.getStyles=function(e,n){var r=t.props.unstyled,i=LY[e](n,r);i.boxSizing="border-box";var a=t.props.styles[e];return a?a(i,n):i},t.getClassNames=function(e,n){var r,i;return null===(r=(i=t.props.classNames)[e])||void 0===r?void 0:r.call(i,n)},t.getElementId=function(e){return"".concat(t.instancePrefix,"-").concat(e)},t.getComponents=function(){return e=t.props,Mr(Mr({},$X),e.components);var e},t.buildCategorizedOptions=function(){return OY(t.props,t.state.selectValue)},t.getCategorizedOptions=function(){return t.props.menuIsOpen?t.buildCategorizedOptions():[]},t.buildFocusableOptions=function(){return UY(t.buildCategorizedOptions())},t.getFocusableOptions=function(){return t.props.menuIsOpen?t.buildFocusableOptions():[]},t.ariaOnChange=function(e,n){t.setState({ariaSelection:Mr({value:e},n)})},t.onMenuMouseDown=function(e){0===e.button&&(e.stopPropagation(),e.preventDefault(),t.focusInput())},t.onMenuMouseMove=function(e){t.blockOptionHover=!1},t.onControlMouseDown=function(e){if(!e.defaultPrevented){var n=t.props.openMenuOnClick;t.state.isFocused?t.props.menuIsOpen?"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&t.onMenuClose():n&&t.openMenu("first"):(n&&(t.openAfterFocus=!0),t.focusInput()),"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&e.preventDefault()}},t.onDropdownIndicatorMouseDown=function(e){if((!e||"mousedown"!==e.type||0===e.button)&&!t.props.isDisabled){var n=t.props,r=n.isMulti,i=n.menuIsOpen;t.focusInput(),i?(t.setState({inputIsHiddenAfterUpdate:!r}),t.onMenuClose()):t.openMenu("first"),e.preventDefault()}},t.onClearIndicatorMouseDown=function(e){e&&"mousedown"===e.type&&0!==e.button||(t.clearValue(),e.preventDefault(),t.openAfterFocus=!1,"touchend"===e.type?t.focusInput():setTimeout((function(){return t.focusInput()})))},t.onScroll=function(e){"boolean"===typeof t.props.closeMenuOnScroll?e.target instanceof HTMLElement&&dX(e.target)&&t.props.onMenuClose():"function"===typeof t.props.closeMenuOnScroll&&t.props.closeMenuOnScroll(e)&&t.props.onMenuClose()},t.onCompositionStart=function(){t.isComposing=!0},t.onCompositionEnd=function(){t.isComposing=!1},t.onTouchStart=function(e){var n=e.touches,r=n&&n.item(0);r&&(t.initialTouchX=r.clientX,t.initialTouchY=r.clientY,t.userIsDragging=!1)},t.onTouchMove=function(e){var n=e.touches,r=n&&n.item(0);if(r){var i=Math.abs(r.clientX-t.initialTouchX),a=Math.abs(r.clientY-t.initialTouchY);t.userIsDragging=i>5||a>5}},t.onTouchEnd=function(e){t.userIsDragging||(t.controlRef&&!t.controlRef.contains(e.target)&&t.menuListRef&&!t.menuListRef.contains(e.target)&&t.blurInput(),t.initialTouchX=0,t.initialTouchY=0)},t.onControlTouchEnd=function(e){t.userIsDragging||t.onControlMouseDown(e)},t.onClearIndicatorTouchEnd=function(e){t.userIsDragging||t.onClearIndicatorMouseDown(e)},t.onDropdownIndicatorTouchEnd=function(e){t.userIsDragging||t.onDropdownIndicatorMouseDown(e)},t.handleInputChange=function(e){var n=t.props.inputValue,r=e.currentTarget.value;t.setState({inputIsHiddenAfterUpdate:!1}),t.onInputChange(r,{action:"input-change",prevInputValue:n}),t.props.menuIsOpen||t.onMenuOpen()},t.onInputFocus=function(e){t.props.onFocus&&t.props.onFocus(e),t.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(t.openAfterFocus||t.props.openMenuOnFocus)&&t.openMenu("first"),t.openAfterFocus=!1},t.onInputBlur=function(e){var n=t.props.inputValue;t.menuListRef&&t.menuListRef.contains(document.activeElement)?t.inputRef.focus():(t.props.onBlur&&t.props.onBlur(e),t.onInputChange("",{action:"input-blur",prevInputValue:n}),t.onMenuClose(),t.setState({focusedValue:null,isFocused:!1}))},t.onOptionHover=function(e){t.blockOptionHover||t.state.focusedOption===e||t.setState({focusedOption:e})},t.shouldHideSelectedOptions=function(){return HY(t.props)},t.onValueInputFocus=function(e){e.preventDefault(),e.stopPropagation(),t.focus()},t.onKeyDown=function(e){var n=t.props,r=n.isMulti,i=n.backspaceRemovesValue,a=n.escapeClearsValue,o=n.inputValue,s=n.isClearable,u=n.isDisabled,l=n.menuIsOpen,c=n.onKeyDown,h=n.tabSelectsValue,f=n.openMenuOnFocus,d=t.state,p=d.focusedOption,v=d.focusedValue,m=d.selectValue;if(!u&&("function"!==typeof c||(c(e),!e.defaultPrevented))){switch(t.blockOptionHover=!0,e.key){case"ArrowLeft":if(!r||o)return;t.focusValue("previous");break;case"ArrowRight":if(!r||o)return;t.focusValue("next");break;case"Delete":case"Backspace":if(o)return;if(v)t.removeValue(v);else{if(!i)return;r?t.popValue():s&&t.clearValue()}break;case"Tab":if(t.isComposing)return;if(e.shiftKey||!l||!h||!p||f&&t.isOptionSelected(p,m))return;t.selectOption(p);break;case"Enter":if(229===e.keyCode)break;if(l){if(!p)return;if(t.isComposing)return;t.selectOption(p);break}return;case"Escape":l?(t.setState({inputIsHiddenAfterUpdate:!1}),t.onInputChange("",{action:"menu-close",prevInputValue:o}),t.onMenuClose()):s&&a&&t.clearValue();break;case" ":if(o)return;if(!l){t.openMenu("first");break}if(!p)return;t.selectOption(p);break;case"ArrowUp":l?t.focusOption("up"):t.openMenu("last");break;case"ArrowDown":l?t.focusOption("down"):t.openMenu("first");break;case"PageUp":if(!l)return;t.focusOption("pageup");break;case"PageDown":if(!l)return;t.focusOption("pagedown");break;case"Home":if(!l)return;t.focusOption("first");break;case"End":if(!l)return;t.focusOption("last");break;default:return}e.preventDefault()}},t.instancePrefix="react-select-"+(t.props.instanceId||++WY),t.state.selectValue=cX(e.value),e.menuIsOpen&&t.state.selectValue.length){var i=t.buildFocusableOptions(),a=i.indexOf(t.state.selectValue[0]);t.state.focusedOption=i[a]}return t}return(0,l.Z)(r,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&yX(this.menuListRef,this.focusedOptionRef)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.isDisabled,r=t.menuIsOpen,i=this.state.isFocused;(i&&!n&&e.isDisabled||i&&r&&!e.menuIsOpen)&&this.focusInput(),i&&n&&!e.isDisabled?this.setState({isFocused:!1},this.onMenuClose):i||n||!e.isDisabled||this.inputRef!==document.activeElement||this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(yX(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(e,t){this.props.onInputChange(e,t)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(e){var t=this,n=this.state,r=n.selectValue,i=n.isFocused,a=this.buildFocusableOptions(),o="first"===e?0:a.length-1;if(!this.props.isMulti){var s=a.indexOf(r[0]);s>-1&&(o=s)}this.scrollToFocusedOptionOnUpdate=!(i&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:a[o]},(function(){return t.onMenuOpen()}))}},{key:"focusValue",value:function(e){var t=this.state,n=t.selectValue,r=t.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var i=n.indexOf(r);r||(i=-1);var a=n.length-1,o=-1;if(n.length){switch(e){case"previous":o=0===i?0:-1===i?a:i-1;break;case"next":i>-1&&i<a&&(o=i+1)}this.setState({inputIsHidden:-1!==o,focusedValue:n[o]})}}}},{key:"focusOption",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"first",t=this.props.pageSize,n=this.state.focusedOption,r=this.getFocusableOptions();if(r.length){var i=0,a=r.indexOf(n);n||(a=-1),"up"===e?i=a>0?a-1:r.length-1:"down"===e?i=(a+1)%r.length:"pageup"===e?(i=a-t)<0&&(i=0):"pagedown"===e?(i=a+t)>r.length-1&&(i=r.length-1):"last"===e&&(i=r.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:r[i],focusedValue:null})}}},{key:"getTheme",value:function(){return this.props.theme?"function"===typeof this.props.theme?this.props.theme(DY):Mr(Mr({},DY),this.props.theme):DY}},{key:"getCommonProps",value:function(){var e=this.clearValue,t=this.cx,n=this.getStyles,r=this.getClassNames,i=this.getValue,a=this.selectOption,o=this.setValue,s=this.props,u=s.isMulti,l=s.isRtl,c=s.options;return{clearValue:e,cx:t,getStyles:n,getClassNames:r,getValue:i,hasValue:this.hasValue(),isMulti:u,isRtl:l,options:c,selectOption:a,selectProps:s,setValue:o,theme:this.getTheme()}}},{key:"hasValue",value:function(){return this.state.selectValue.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var e=this.props,t=e.isClearable,n=e.isMulti;return void 0===t?n:t}},{key:"isOptionDisabled",value:function(e,t){return VY(this.props,e,t)}},{key:"isOptionSelected",value:function(e,t){return GY(this.props,e,t)}},{key:"filterOption",value:function(e,t){return jY(this.props,e,t)}},{key:"formatOptionLabel",value:function(e,t){if("function"===typeof this.props.formatOptionLabel){var n=this.props.inputValue,r=this.state.selectValue;return this.props.formatOptionLabel(e,{context:t,inputValue:n,selectValue:r})}return this.getOptionLabel(e)}},{key:"formatGroupLabel",value:function(e){return this.props.formatGroupLabel(e)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var e=this.props,n=e.isDisabled,r=e.isSearchable,i=e.inputId,a=e.inputValue,o=e.tabIndex,s=e.form,u=e.menuIsOpen,l=e.required,c=this.getComponents().Input,h=this.state,f=h.inputIsHidden,d=h.ariaSelection,p=this.commonProps,v=i||this.getElementId("input"),m=Mr(Mr(Mr({"aria-autocomplete":"list","aria-expanded":u,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":l,role:"combobox"},u&&{"aria-controls":this.getElementId("listbox"),"aria-owns":this.getElementId("listbox")}),!r&&{"aria-readonly":!0}),this.hasValue()?"initial-input-focus"===(null===d||void 0===d?void 0:d.action)&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return r?t.createElement(c,bF({},p,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:v,innerRef:this.getInputRef,isDisabled:n,isHidden:f,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:o,form:s,type:"text",value:a},m)):t.createElement(gY,bF({id:v,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:sX,onFocus:this.onInputFocus,disabled:n,tabIndex:o,inputMode:"none",form:s,value:""},m))}},{key:"renderPlaceholderOrValue",value:function(){var e=this,n=this.getComponents(),r=n.MultiValue,i=n.MultiValueContainer,a=n.MultiValueLabel,o=n.MultiValueRemove,s=n.SingleValue,u=n.Placeholder,l=this.commonProps,c=this.props,h=c.controlShouldRenderValue,f=c.isDisabled,d=c.isMulti,p=c.inputValue,v=c.placeholder,m=this.state,g=m.selectValue,y=m.focusedValue,b=m.isFocused;if(!this.hasValue()||!h)return p?null:t.createElement(u,bF({},l,{key:"placeholder",isDisabled:f,isFocused:b,innerProps:{id:this.getElementId("placeholder")}}),v);if(d)return g.map((function(n,s){var u=n===y,c="".concat(e.getOptionLabel(n),"-").concat(e.getOptionValue(n));return t.createElement(r,bF({},l,{components:{Container:i,Label:a,Remove:o},isFocused:u,isDisabled:f,key:c,index:s,removeProps:{onClick:function(){return e.removeValue(n)},onTouchEnd:function(){return e.removeValue(n)},onMouseDown:function(e){e.preventDefault()}},data:n}),e.formatOptionLabel(n,"value"))}));if(p)return null;var _=g[0];return t.createElement(s,bF({},l,{data:_,isDisabled:f}),this.formatOptionLabel(_,"value"))}},{key:"renderClearIndicator",value:function(){var e=this.getComponents().ClearIndicator,n=this.commonProps,r=this.props,i=r.isDisabled,a=r.isLoading,o=this.state.isFocused;if(!this.isClearable()||!e||i||!this.hasValue()||a)return null;var s={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return t.createElement(e,bF({},n,{innerProps:s,isFocused:o}))}},{key:"renderLoadingIndicator",value:function(){var e=this.getComponents().LoadingIndicator,n=this.commonProps,r=this.props,i=r.isDisabled,a=r.isLoading,o=this.state.isFocused;if(!e||!a)return null;return t.createElement(e,bF({},n,{innerProps:{"aria-hidden":"true"},isDisabled:i,isFocused:o}))}},{key:"renderIndicatorSeparator",value:function(){var e=this.getComponents(),n=e.DropdownIndicator,r=e.IndicatorSeparator;if(!n||!r)return null;var i=this.commonProps,a=this.props.isDisabled,o=this.state.isFocused;return t.createElement(r,bF({},i,{isDisabled:a,isFocused:o}))}},{key:"renderDropdownIndicator",value:function(){var e=this.getComponents().DropdownIndicator;if(!e)return null;var n=this.commonProps,r=this.props.isDisabled,i=this.state.isFocused,a={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return t.createElement(e,bF({},n,{innerProps:a,isDisabled:r,isFocused:i}))}},{key:"renderMenu",value:function(){var e=this,n=this.getComponents(),r=n.Group,i=n.GroupHeading,a=n.Menu,o=n.MenuList,s=n.MenuPortal,u=n.LoadingMessage,l=n.NoOptionsMessage,c=n.Option,h=this.commonProps,f=this.state.focusedOption,d=this.props,p=d.captureMenuScroll,v=d.inputValue,m=d.isLoading,g=d.loadingMessage,y=d.minMenuHeight,b=d.maxMenuHeight,_=d.menuIsOpen,x=d.menuPlacement,w=d.menuPosition,S=d.menuPortalTarget,M=d.menuShouldBlockScroll,k=d.menuShouldScrollIntoView,T=d.noOptionsMessage,E=d.onMenuScrollToTop,C=d.onMenuScrollToBottom;if(!_)return null;var A,R=function(n,r){var i=n.type,a=n.data,o=n.isDisabled,s=n.isSelected,u=n.label,l=n.value,d=f===a,p=o?void 0:function(){return e.onOptionHover(a)},v=o?void 0:function(){return e.selectOption(a)},m="".concat(e.getElementId("option"),"-").concat(r),g={id:m,onClick:v,onMouseMove:p,onMouseOver:p,tabIndex:-1};return t.createElement(c,bF({},h,{innerProps:g,data:a,isDisabled:o,isSelected:s,key:m,label:u,type:i,value:l,isFocused:d,innerRef:d?e.getFocusedOptionRef:void 0}),e.formatOptionLabel(n.data,"menu"))};if(this.hasOptions())A=this.getCategorizedOptions().map((function(n){if("group"===n.type){var a=n.data,o=n.options,s=n.index,u="".concat(e.getElementId("group"),"-").concat(s),l="".concat(u,"-heading");return t.createElement(r,bF({},h,{key:u,data:a,options:o,Heading:i,headingProps:{id:l,data:n.data},label:e.formatGroupLabel(n.data)}),n.options.map((function(e){return R(e,"".concat(s,"-").concat(e.index))})))}if("option"===n.type)return R(n,"".concat(n.index))}));else if(m){var P=g({inputValue:v});if(null===P)return null;A=t.createElement(u,h,P)}else{var L=T({inputValue:v});if(null===L)return null;A=t.createElement(l,h,L)}var D={minMenuHeight:y,maxMenuHeight:b,menuPlacement:x,menuPosition:w,menuShouldScrollIntoView:k},N=t.createElement(AX,bF({},h,D),(function(n){var r=n.ref,i=n.placerProps,s=i.placement,u=i.maxHeight;return t.createElement(a,bF({},h,D,{innerRef:r,innerProps:{onMouseDown:e.onMenuMouseDown,onMouseMove:e.onMenuMouseMove,id:e.getElementId("listbox")},isLoading:m,placement:s}),t.createElement(AY,{captureEnabled:p,onTopArrive:E,onBottomArrive:C,lockEnabled:M},(function(n){return t.createElement(o,bF({},h,{innerRef:function(t){e.getMenuListRef(t),n(t)},isLoading:m,maxHeight:u,focusedOption:f}),A)})))}));return S||"fixed"===w?t.createElement(s,bF({},h,{appendTo:S,controlElement:this.controlRef,menuPlacement:x,menuPosition:w}),N):N}},{key:"renderFormField",value:function(){var e=this,n=this.props,r=n.delimiter,i=n.isDisabled,a=n.isMulti,o=n.name,s=n.required,u=this.state.selectValue;if(o&&!i){if(s&&!this.hasValue())return t.createElement(PY,{name:o,onFocus:this.onValueInputFocus});if(a){if(r){var l=u.map((function(t){return e.getOptionValue(t)})).join(r);return t.createElement("input",{name:o,type:"hidden",value:l})}var c=u.length>0?u.map((function(n,r){return t.createElement("input",{key:"i-".concat(r),name:o,type:"hidden",value:e.getOptionValue(n)})})):t.createElement("input",{name:o,type:"hidden",value:""});return t.createElement("div",null,c)}var h=u[0]?this.getOptionValue(u[0]):"";return t.createElement("input",{name:o,type:"hidden",value:h})}}},{key:"renderLiveRegion",value:function(){var e=this.commonProps,n=this.state,r=n.ariaSelection,i=n.focusedOption,a=n.focusedValue,o=n.isFocused,s=n.selectValue,u=this.getFocusableOptions();return t.createElement(aY,bF({},e,{id:this.getElementId("live-region"),ariaSelection:r,focusedOption:i,focusedValue:a,isFocused:o,selectValue:s,focusableOptions:u}))}},{key:"render",value:function(){var e=this.getComponents(),n=e.Control,r=e.IndicatorsContainer,i=e.SelectContainer,a=e.ValueContainer,o=this.props,s=o.className,u=o.id,l=o.isDisabled,c=o.menuIsOpen,h=this.state.isFocused,f=this.commonProps=this.getCommonProps();return t.createElement(i,bF({},f,{className:s,innerProps:{id:u,onKeyDown:this.onKeyDown},isDisabled:l,isFocused:h}),this.renderLiveRegion(),t.createElement(n,bF({},f,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:l,isFocused:h,menuIsOpen:c}),t.createElement(a,bF({},f,{isDisabled:l}),this.renderPlaceholderOrValue(),this.renderInput()),t.createElement(r,bF({},f,{isDisabled:l}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=t.prevProps,r=t.clearFocusValueOnUpdate,i=t.inputIsHiddenAfterUpdate,a=t.ariaSelection,o=t.isFocused,s=t.prevWasFocused,u=e.options,l=e.value,c=e.menuIsOpen,h=e.inputValue,f=e.isMulti,d=cX(l),p={};if(n&&(l!==n.value||u!==n.options||c!==n.menuIsOpen||h!==n.inputValue)){var v=c?function(e,t){return UY(OY(e,t))}(e,d):[],m=r?function(e,t){var n=e.focusedValue,r=e.selectValue.indexOf(n);if(r>-1){if(t.indexOf(n)>-1)return n;if(r<t.length)return t[r]}return null}(t,d):null,g=function(e,t){var n=e.focusedOption;return n&&t.indexOf(n)>-1?n:t[0]}(t,v);p={selectValue:d,focusedOption:g,focusedValue:m,clearFocusValueOnUpdate:!1}}var y=null!=i&&e!==n?{inputIsHidden:i,inputIsHiddenAfterUpdate:void 0}:{},b=a,_=o&&s;return o&&!_&&(b={value:kX(f,d,d[0]||null),options:d,action:"initial-input-focus"},_=!s),"initial-input-focus"===(null===a||void 0===a?void 0:a.action)&&(b=null),Mr(Mr(Mr({},p),y),{},{prevProps:e,ariaSelection:b,prevWasFocused:_})}}]),r}(t.Component);ZY.defaultProps=NY;var qY=(0,t.forwardRef)((function(e,n){var r=function(e){var n=e.defaultInputValue,r=void 0===n?"":n,i=e.defaultMenuIsOpen,a=void 0!==i&&i,o=e.defaultValue,s=void 0===o?null:o,u=e.inputValue,l=e.menuIsOpen,c=e.onChange,h=e.onInputChange,f=e.onMenuClose,d=e.onMenuOpen,p=e.value,v=xF(e,eZ),m=vr((0,t.useState)(void 0!==u?u:r),2),g=m[0],y=m[1],b=vr((0,t.useState)(void 0!==l?l:a),2),_=b[0],x=b[1],w=vr((0,t.useState)(void 0!==p?p:s),2),S=w[0],M=w[1],k=(0,t.useCallback)((function(e,t){"function"===typeof c&&c(e,t),M(e)}),[c]),T=(0,t.useCallback)((function(e,t){var n;"function"===typeof h&&(n=h(e,t)),y(void 0!==n?n:e)}),[h]),E=(0,t.useCallback)((function(){"function"===typeof d&&d(),x(!0)}),[d]),C=(0,t.useCallback)((function(){"function"===typeof f&&f(),x(!1)}),[f]),A=void 0!==u?u:g,R=void 0!==l?l:_,P=void 0!==p?p:S;return Mr(Mr({},v),{},{inputValue:A,menuIsOpen:R,onChange:k,onInputChange:T,onMenuClose:C,onMenuOpen:E,value:P})}(e);return t.createElement(ZY,bF({ref:n},r))})),XY=qY,YY=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var i;return(0,u.Z)(this,r),(i=n.call(this,e))._button=void 0,i._button=t.createRef(),i}return(0,l.Z)(r,[{key:"render",value:function(){return(0,rr.jsx)("button",{className:"ClickButton",ref:this._button,onClick:this.props.onClick,style:this.props.style,children:this.props.buttonValue})}}]),r}(t.Component);function KY(e){if(!e)return!1;var t=e.parentElement;return!!t&&t.querySelector(":hover")===e}var JY,QY=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var i;(0,u.Z)(this,r),(i=n.call(this,e))._textInput=void 0,i._sliderInput=void 0,i.onTextInputChange=i.onTextInputChange.bind((0,c.Z)(i)),i.onTextInputKeyDown=i.onTextInputKeyDown.bind((0,c.Z)(i)),i.onSliderChange=i.onSliderChange.bind((0,c.Z)(i)),i._textInput=(0,t.createRef)(),i._sliderInput=(0,t.createRef)();var a=i.value().toString();return i.state={textValue:a,sliderValue:a,prevPropValue:a},i}return(0,l.Z)(r,[{key:"onTextInputChange",value:function(e){for(var t=e.currentTarget.value,n="",r=0,i=0;i<t.length;i++){var a=t[i];"0123456789".includes(a)?n+=a:0===r&&"."===a?(n+=a,r++):0===n.length&&"-"===a&&(n+=a)}this.setState({textValue:n})}},{key:"onTextInputKeyDown",value:function(e){if("enter"===e.key.toLowerCase()||"enter"===e.code.toLowerCase()){var t=e.target;if(t){var n=Lb(Number(t.value),this.min(),this.max()),r=this.props.onChange;this.setState({textValue:n.toString(),sliderValue:n.toString()},(function(){r&&r(Number(n))}))}}else"escape"!==e.key.toLowerCase()&&"escape"!==e.code.toLowerCase()||this.setState({textValue:this.state.sliderValue})}},{key:"onSliderChange",value:function(e){var t=this,n=e.currentTarget.value,r=this.props.onChange;this.setState({sliderValue:n,textValue:n},(function(){r&&r(Number(t.state.sliderValue))}))}},{key:"componentDidUpdate",value:function(e,t){if(!(KY(this._textInput.current)||function(e){if(!e)return!1;var t=e.parentElement;return!!t&&t.querySelector(":focus")===e}(this._textInput.current)||KY(this._sliderInput.current))&&this.value().toString()!==this.state.prevPropValue){var n=this.value().toString();this.setState({textValue:n,sliderValue:n,prevPropValue:n})}}},{key:"render",value:function(){var e;return e=this.props.label?(0,rr.jsx)("div",{className:"labelDiv",children:(0,rr.jsx)("label",{children:this.props.label})}):void 0,(0,rr.jsxs)("div",{className:"LabeledSlider",children:[e,(0,rr.jsxs)("div",{className:"inputDiv",children:[(0,rr.jsx)("input",{type:"text",value:this.state.textValue,onKeyDown:this.onTextInputKeyDown,onChange:this.onTextInputChange,ref:this._textInput}),(0,rr.jsx)("input",{type:"range",max:this.max(),min:this.min(),step:this.step(),value:this.state.sliderValue,onChange:this.onSliderChange,ref:this._sliderInput})]})]})}},{key:"min",value:function(){var e;return null!==(e=this.props.min)&&void 0!==e?e:0}},{key:"max",value:function(){var e;return Math.max(this.min(),null!==(e=this.props.max)&&void 0!==e?e:1)}},{key:"value",value:function(){var e=this.props.value;return Lb(void 0===e?this.min():e,this.min(),this.max())}},{key:"step",value:function(){return this.props.step}}]),r}(t.Component),$Y=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var i;return(0,u.Z)(this,r),(i=n.call(this,e))._button=void 0,i._button=t.createRef(),i}return(0,l.Z)(r,[{key:"render",value:function(){var e=this;return(0,rr.jsx)(DH,{className:"DragButton_".concat(this.props.className?this.props.className:""),onDragStartT:function(t){var n=e.props.onDragStart;if(n){var r=n(t);if(void 0!==r){var i=vr(r,2),a=i[0],o=i[1],s=e._button.current;if(s){var u=e.props.getParentDockLayout();u&&(JY=o,t.setData({tab:{id:a}},u),t.startDrag(s,s))}}}},onDragEndT:function(e){JY&&JY(e)},children:(0,rr.jsx)("button",{className:"DragButtonButton",ref:this._button,title:this.props.title,onClickCapture:this.props.onClick,style:this.props.style,children:this.props.buttonValue})})}}]),r}(t.Component);function eK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tK(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eK(Object(n),!0).forEach((function(t){aK(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eK(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function nK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rK(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function iK(e,t,n){return t&&rK(e.prototype,t),n&&rK(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function aK(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oK(){return oK=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},oK.apply(this,arguments)}function sK(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lK(e,t)}function uK(e){return uK=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},uK(e)}function lK(e,t){return lK=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},lK(e,t)}function cK(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function hK(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fK(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return hK(e)}function dK(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(_2){return!1}}();return function(){var n,r=uK(e);if(t){var i=uK(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return fK(this,n)}}function pK(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(x2){s=!0,i=x2}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}(e,t)||mK(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vK(e){return function(e){if(Array.isArray(e))return gK(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||mK(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mK(e,t){if(e){if("string"===typeof e)return gK(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gK(e,t):void 0}}function gK(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var yK=iK((function e(t){var n=this,r=t.expanded,i=void 0===r?[]:r,a=t.allowMultipleExpanded,o=void 0!==a&&a,s=t.allowZeroExpanded,u=void 0!==s&&s;nK(this,e),aK(this,"expanded",void 0),aK(this,"allowMultipleExpanded",void 0),aK(this,"allowZeroExpanded",void 0),aK(this,"toggleExpanded",(function(e){return n.isItemDisabled(e)?n:n.isItemExpanded(e)?n.augment({expanded:n.expanded.filter((function(t){return t!==e}))}):n.augment({expanded:n.allowMultipleExpanded?[].concat(vK(n.expanded),[e]):[e]})})),aK(this,"isItemDisabled",(function(e){var t=n.isItemExpanded(e),r=1===n.expanded.length;return Boolean(t&&!n.allowZeroExpanded&&r)})),aK(this,"isItemExpanded",(function(e){return-1!==n.expanded.indexOf(e)})),aK(this,"getPanelAttributes",(function(e,t){var r=null!==t&&void 0!==t?t:n.isItemExpanded(e);return{role:n.allowMultipleExpanded?void 0:"region","aria-hidden":n.allowMultipleExpanded?!r:void 0,"aria-labelledby":n.getButtonId(e),id:n.getPanelId(e),hidden:!r||void 0}})),aK(this,"getHeadingAttributes",(function(){return{role:"heading"}})),aK(this,"getButtonAttributes",(function(e,t){var r=null!==t&&void 0!==t?t:n.isItemExpanded(e),i=n.isItemDisabled(e);return{id:n.getButtonId(e),"aria-disabled":i,"aria-expanded":r,"aria-controls":n.getPanelId(e),role:"button",tabIndex:0}})),aK(this,"getPanelId",(function(e){return"accordion__panel-".concat(e)})),aK(this,"getButtonId",(function(e){return"accordion__heading-".concat(e)})),aK(this,"augment",(function(t){return new e(tK({expanded:n.expanded,allowMultipleExpanded:n.allowMultipleExpanded,allowZeroExpanded:n.allowZeroExpanded},t))})),this.expanded=i,this.allowMultipleExpanded=o,this.allowZeroExpanded=u})),bK=(0,t.createContext)(null),_K=function(e){sK(r,e);var n=dK(r);function r(){var e;nK(this,r);for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return aK(hK(e=n.call.apply(n,[this].concat(i))),"state",new yK({expanded:e.props.preExpanded,allowMultipleExpanded:e.props.allowMultipleExpanded,allowZeroExpanded:e.props.allowZeroExpanded})),aK(hK(e),"toggleExpanded",(function(t){e.setState((function(e){return e.toggleExpanded(t)}),(function(){e.props.onChange&&e.props.onChange(e.state.expanded)}))})),aK(hK(e),"isItemDisabled",(function(t){return e.state.isItemDisabled(t)})),aK(hK(e),"isItemExpanded",(function(t){return e.state.isItemExpanded(t)})),aK(hK(e),"getPanelAttributes",(function(t,n){return e.state.getPanelAttributes(t,n)})),aK(hK(e),"getHeadingAttributes",(function(){return e.state.getHeadingAttributes()})),aK(hK(e),"getButtonAttributes",(function(t,n){return e.state.getButtonAttributes(t,n)})),e}return iK(r,[{key:"render",value:function(){var e=this.state,n=e.allowZeroExpanded,r=e.allowMultipleExpanded;return(0,t.createElement)(bK.Provider,{value:{allowMultipleExpanded:r,allowZeroExpanded:n,toggleExpanded:this.toggleExpanded,isItemDisabled:this.isItemDisabled,isItemExpanded:this.isItemExpanded,getPanelAttributes:this.getPanelAttributes,getHeadingAttributes:this.getHeadingAttributes,getButtonAttributes:this.getButtonAttributes}},this.props.children||null)}}]),r}(t.PureComponent);aK(_K,"defaultProps",{allowMultipleExpanded:!1,allowZeroExpanded:!1});var xK,wK=function(e){sK(r,e);var n=dK(r);function r(){var e;nK(this,r);for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return aK(hK(e=n.call.apply(n,[this].concat(i))),"renderChildren",(function(t){return t?e.props.children(t):null})),e}return iK(r,[{key:"render",value:function(){return(0,t.createElement)(bK.Consumer,null,this.renderChildren)}}]),r}(t.PureComponent),SK=["className","allowMultipleExpanded","allowZeroExpanded","onChange","preExpanded"],MK=function(e){var n=e.className,r=void 0===n?"accordion":n,i=e.allowMultipleExpanded,a=e.allowZeroExpanded,o=e.onChange,s=e.preExpanded,u=cK(e,SK);return(0,t.createElement)(_K,{preExpanded:s,allowMultipleExpanded:i,allowZeroExpanded:a,onChange:o},(0,t.createElement)("div",oK({"data-accordion-component":"Accordion",className:r},u)))};!function(e){e.Accordion="Accordion",e.AccordionItem="AccordionItem",e.AccordionItemButton="AccordionItemButton",e.AccordionItemHeading="AccordionItemHeading",e.AccordionItemPanel="AccordionItemPanel"}(xK||(xK={}));var kK=xK,TK=0;var EK=t.useId||function(){var e=TK;return TK+=1,"raa-".concat(e)},CK=/[\u0009\u000a\u000c\u000d\u0020]/g;function AK(e){return""!==e&&!CK.test(e)||(console.error('uuid must be a valid HTML5 id but was given "'.concat(e,'", ASCII whitespaces are forbidden')),!1)}var RK=(0,t.createContext)(null),PK=function(e){var n=e.children,r=e.uuid,i=e.accordionContext,a=e.dangerouslySetExpanded,o=function(){i.toggleExpanded(r)},s=function(e){var i=null!==a&&void 0!==a?a:e.isItemExpanded(r),s=e.isItemDisabled(r),u=e.getPanelAttributes(r,a),l=e.getHeadingAttributes(r),c=e.getButtonAttributes(r,a);return(0,t.createElement)(RK.Provider,{value:{uuid:r,expanded:i,disabled:s,toggleExpanded:o,panelAttributes:u,headingAttributes:l,buttonAttributes:c}},n)};return(0,t.createElement)(wK,null,s)},LK=function(e){return(0,t.createElement)(wK,null,(function(n){return(0,t.createElement)(PK,oK({},e,{accordionContext:n}))}))},DK=function(e){var n=e.children,r=function(e){return e?n(e):null};return(0,t.createElement)(RK.Consumer,null,r)},NK=["uuid","dangerouslySetExpanded","className","activeClassName"],IK=function(e){var n=e.uuid,r=e.dangerouslySetExpanded,i=e.className,a=void 0===i?"accordion__item":i,o=e.activeClassName,s=cK(e,NK),u=pK((0,t.useState)(EK()),1)[0],l=null!==n&&void 0!==n?n:u,c=function(e){var n=e.expanded&&o?o:a;return(0,t.createElement)("div",oK({"data-accordion-component":"AccordionItem",className:n},s))};return AK(l.toString()),s.id&&AK(s.id),(0,t.createElement)(LK,{uuid:l,dangerouslySetExpanded:r},(0,t.createElement)(DK,null,c))};function OK(e){return e&&(e.matches('[data-accordion-component="Accordion"]')?e:OK(e.parentElement))}function UK(e){var t=OK(e);return t&&Array.from(t.querySelectorAll('[data-accordion-component="AccordionItemButton"]'))}IK.displayName=kK.AccordionItem;var FK="End",zK="Enter",BK="Home",VK=" ",GK="Spacebar",jK="ArrowUp",HK="ArrowDown",WK="ArrowLeft",ZK="ArrowRight",qK=["toggleExpanded","className"],XK=function(e){var n=e.toggleExpanded,r=e.className,i=void 0===r?"accordion__button":r,a=cK(e,qK);return a.id&&AK(a.id),(0,t.createElement)("div",oK({className:i},a,{role:"button",tabIndex:0,onClick:n,onKeyDown:function(e){var t=e.key;if(t!==zK&&t!==VK&&t!==GK||(e.preventDefault(),n()),e.target instanceof HTMLElement)switch(t){case BK:e.preventDefault(),function(e){var t=(UK(e)||[])[0];t&&t.focus()}(e.target);break;case FK:e.preventDefault(),function(e){var t=UK(e)||[],n=t[t.length-1];n&&n.focus()}(e.target);break;case WK:case jK:e.preventDefault(),function(e){var t=UK(e)||[],n=t.indexOf(e);if(-1!==n){var r=t[n-1];r&&r.focus()}}(e.target);break;case ZK:case HK:e.preventDefault(),function(e){var t=UK(e)||[],n=t.indexOf(e);if(-1!==n){var r=t[n+1];r&&r.focus()}}(e.target)}},"data-accordion-component":"AccordionItemButton"}))},YK=function(e){return(0,t.createElement)(DK,null,(function(n){var r=n.toggleExpanded,i=n.buttonAttributes;return(0,t.createElement)(XK,oK({toggleExpanded:r},e,i))}))},KK=function(e){sK(r,e);var n=dK(r);function r(){var e;nK(this,r);for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return aK(hK(e=n.call.apply(n,[this].concat(i))),"ref",void 0),aK(hK(e),"setRef",(function(t){e.ref=t})),e}return iK(r,[{key:"componentDidUpdate",value:function(){r.VALIDATE(this.ref)}},{key:"componentDidMount",value:function(){r.VALIDATE(this.ref)}},{key:"render",value:function(){return(0,t.createElement)("div",oK({"data-accordion-component":"AccordionItemHeading"},this.props,{ref:this.setRef}))}}],[{key:"VALIDATE",value:function(e){if(void 0===e)throw new Error("ref is undefined");if(1!==e.childElementCount||!e.firstElementChild||"AccordionItemButton"!==e.firstElementChild.getAttribute("data-accordion-component"))throw new Error("AccordionItemButton may contain only one child element, which must be an instance of AccordionItemButton.\n\nFrom the WAI-ARIA spec (https://www.w3.org/TR/wai-aria-practices-1.1/#accordion):\n\n\u201cThe button element is the only element inside the heading element. That is, if there are other visually persistent elements, they are not included inside the heading element.\u201d\n\n")}}]),r}(t.PureComponent);aK(KK,"defaultProps",{className:"accordion__heading","aria-level":3});var JK=function(e){return(0,t.createElement)(DK,null,(function(n){var r=n.headingAttributes;return e.id&&AK(e.id),(0,t.createElement)(KK,oK({},e,r))}))};JK.displayName=kK.AccordionItemHeading;var QK=["className","region","id"],$K=function(e){var n=e.className,r=void 0===n?"accordion__panel":n,i=e.region,a=e.id,o=cK(e,QK),s=function(e){var n=e.panelAttributes;a&&AK(a);var s=tK(tK({},n),{},{"aria-labelledby":i?n["aria-labelledby"]:void 0});return(0,t.createElement)("div",oK({"data-accordion-component":"AccordionItemPanel",className:r},o,s,{role:i?"region":void 0}))};return(0,t.createElement)(DK,null,s)},eJ=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).state={},r}return(0,l.Z)(n,[{key:"render",value:function(){var e=this;return(0,rr.jsxs)("div",{className:"CamerasPanel",children:[(0,rr.jsx)("label",{children:"Synchronize Cameras"}),(0,rr.jsx)("input",{type:"checkbox",checked:this.props.robotSceneManager.shouldSyncViews(),onChange:function(t){e.props.robotSceneManager.setShouldSyncViews(t.target.checked)}})]})}}]),n}(t.Component),tJ=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r,i,a;return(0,u.Z)(this,n),(a=t.call(this,e)).onTextInputChange=a.onTextInputChange.bind((0,c.Z)(a)),a.onTextInputKeyDown=a.onTextInputKeyDown.bind((0,c.Z)(a)),a.state={oldValue:null!==(r=a.props.value)&&void 0!==r?r:"",currValue:null!==(i=a.props.value)&&void 0!==i?i:""},a}return(0,l.Z)(n,[{key:"onTextInputChange",value:function(e){var t=e.currentTarget.value;this.props.filter&&(t=this.props.filter(t));var n=this.props.onChange;this.setState({currValue:t},(function(){n&&n(t)}))}},{key:"onTextInputKeyDown",value:function(e){if("enter"===e.key.toLowerCase()||"enter"===e.code.toLowerCase()){var t=e.target;if(t){var n=this.props.filter?this.props.filter(t.value):t.value,r=this.props.onChange,i=this.props.onReturnPressed;this.setState({oldValue:n,currValue:n},(function(){r&&r(n),i&&i(n)}))}}else"escape"!==e.key.toLowerCase()&&"escape"!==e.code.toLowerCase()||this.setState({currValue:this.state.oldValue})}},{key:"componentDidUpdate",value:function(e,t){e.value!==this.props.value&&void 0!==this.props.value&&this.setState({currValue:this.props.value})}},{key:"render",value:function(){return(0,rr.jsxs)("div",{className:"LabeledTextInput",children:[this.props.labelValue?(0,rr.jsx)("label",{children:this.props.labelValue}):null,(0,rr.jsx)("input",{type:"text",value:this.state.currValue,onKeyDown:this.onTextInputKeyDown,onChange:this.onTextInputChange})]})}}]),n}(t.Component);function nJ(){return(nJ=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function rJ(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)t.indexOf(n=a[r])>=0||(i[n]=e[n]);return i}function iJ(e){var n=(0,t.useRef)(e),r=(0,t.useRef)((function(e){n.current&&n.current(e)}));return n.current=e,r.current}var aJ=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=1),e>n?n:e<t?t:e},oJ=function(e){return"touches"in e},sJ=function(e){return e&&e.ownerDocument.defaultView||self},uJ=function(e,t,n){var r=e.getBoundingClientRect(),i=oJ(t)?function(e,t){for(var n=0;n<e.length;n++)if(e[n].identifier===t)return e[n];return e[0]}(t.touches,n):t;return{left:aJ((i.pageX-(r.left+sJ(e).pageXOffset))/r.width),top:aJ((i.pageY-(r.top+sJ(e).pageYOffset))/r.height)}},lJ=function(e){!oJ(e)&&e.preventDefault()},cJ=t.memo((function(e){var n=e.onMove,r=e.onKey,i=rJ(e,["onMove","onKey"]),a=(0,t.useRef)(null),o=iJ(n),s=iJ(r),u=(0,t.useRef)(null),l=(0,t.useRef)(!1),c=(0,t.useMemo)((function(){var e=function(e){lJ(e),(oJ(e)?e.touches.length>0:e.buttons>0)&&a.current?o(uJ(a.current,e,u.current)):n(!1)},t=function(){return n(!1)};function n(n){var r=l.current,i=sJ(a.current),o=n?i.addEventListener:i.removeEventListener;o(r?"touchmove":"mousemove",e),o(r?"touchend":"mouseup",t)}return[function(e){var t=e.nativeEvent,r=a.current;if(r&&(lJ(t),!function(e,t){return t&&!oJ(e)}(t,l.current)&&r)){if(oJ(t)){l.current=!0;var i=t.changedTouches||[];i.length&&(u.current=i[0].identifier)}r.focus(),o(uJ(r,t,u.current)),n(!0)}},function(e){var t=e.which||e.keyCode;t<37||t>40||(e.preventDefault(),s({left:39===t?.05:37===t?-.05:0,top:40===t?.05:38===t?-.05:0}))},n]}),[s,o]),h=c[0],f=c[1],d=c[2];return(0,t.useEffect)((function(){return d}),[d]),t.createElement("div",nJ({},i,{onTouchStart:h,onMouseDown:h,className:"react-colorful__interactive",ref:a,onKeyDown:f,tabIndex:0,role:"slider"}))})),hJ=function(e){return e.filter(Boolean).join(" ")},fJ=function(e){var n=e.color,r=e.left,i=e.top,a=void 0===i?.5:i,o=hJ(["react-colorful__pointer",e.className]);return t.createElement("div",{className:o,style:{top:100*a+"%",left:100*r+"%"}},t.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:n}}))},dJ=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=Math.pow(10,t)),Math.round(n*e)/n},pJ=(Math.PI,function(e){return wJ(vJ(e))}),vJ=function(e){return"#"===e[0]&&(e=e.substring(1)),e.length<6?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:4===e.length?dJ(parseInt(e[3]+e[3],16)/255,2):1}:{r:parseInt(e.substring(0,2),16),g:parseInt(e.substring(2,4),16),b:parseInt(e.substring(4,6),16),a:8===e.length?dJ(parseInt(e.substring(6,8),16)/255,2):1}},mJ=function(e){return xJ(bJ(e))},gJ=function(e){var t=e.s,n=e.v,r=e.a,i=(200-t)*n/100;return{h:dJ(e.h),s:dJ(i>0&&i<200?t*n/100/(i<=100?i:200-i)*100:0),l:dJ(i/2),a:dJ(r,2)}},yJ=function(e){var t=gJ(e);return"hsl("+t.h+", "+t.s+"%, "+t.l+"%)"},bJ=function(e){var t=e.h,n=e.s,r=e.v,i=e.a;t=t/360*6,n/=100,r/=100;var a=Math.floor(t),o=r*(1-n),s=r*(1-(t-a)*n),u=r*(1-(1-t+a)*n),l=a%6;return{r:dJ(255*[r,s,o,o,u,r][l]),g:dJ(255*[u,r,r,s,o,o][l]),b:dJ(255*[o,o,u,r,r,s][l]),a:dJ(i,2)}},_J=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},xJ=function(e){var t=e.r,n=e.g,r=e.b,i=e.a,a=i<1?_J(dJ(255*i)):"";return"#"+_J(t)+_J(n)+_J(r)+a},wJ=function(e){var t=e.r,n=e.g,r=e.b,i=e.a,a=Math.max(t,n,r),o=a-Math.min(t,n,r),s=o?a===t?(n-r)/o:a===n?2+(r-t)/o:4+(t-n)/o:0;return{h:dJ(60*(s<0?s+6:s)),s:dJ(a?o/a*100:0),v:dJ(a/255*100),a:i}},SJ=t.memo((function(e){var n=e.hue,r=e.onChange,i=hJ(["react-colorful__hue",e.className]);return t.createElement("div",{className:i},t.createElement(cJ,{onMove:function(e){r({h:360*e.left})},onKey:function(e){r({h:aJ(n+360*e.left,0,360)})},"aria-label":"Hue","aria-valuenow":dJ(n),"aria-valuemax":"360","aria-valuemin":"0"},t.createElement(fJ,{className:"react-colorful__hue-pointer",left:n/360,color:yJ({h:n,s:100,v:100,a:1})})))})),MJ=t.memo((function(e){var n=e.hsva,r=e.onChange,i={backgroundColor:yJ({h:n.h,s:100,v:100,a:1})};return t.createElement("div",{className:"react-colorful__saturation",style:i},t.createElement(cJ,{onMove:function(e){r({s:100*e.left,v:100-100*e.top})},onKey:function(e){r({s:aJ(n.s+100*e.left,0,100),v:aJ(n.v-100*e.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+dJ(n.s)+"%, Brightness "+dJ(n.v)+"%"},t.createElement(fJ,{className:"react-colorful__saturation-pointer",top:1-n.v/100,left:n.s/100,color:yJ(n)})))})),kJ=function(e,t){if(e===t)return!0;for(var n in e)if(e[n]!==t[n])return!1;return!0},TJ=function(e,t){return e.toLowerCase()===t.toLowerCase()||kJ(vJ(e),vJ(t))};function EJ(e,n,r){var i=iJ(r),a=(0,t.useState)((function(){return e.toHsva(n)})),o=a[0],s=a[1],u=(0,t.useRef)({color:n,hsva:o});(0,t.useEffect)((function(){if(!e.equal(n,u.current.color)){var t=e.toHsva(n);u.current={hsva:t,color:n},s(t)}}),[n,e]),(0,t.useEffect)((function(){var t;kJ(o,u.current.hsva)||e.equal(t=e.fromHsva(o),u.current.color)||(u.current={hsva:o,color:t},i(t))}),[o,e,i]);var l=(0,t.useCallback)((function(e){s((function(t){return Object.assign({},t,e)}))}),[]);return[o,l]}var CJ,AJ="undefined"!=typeof window?t.useLayoutEffect:t.useEffect,RJ=new Map,PJ=function(e){AJ((function(){var t=e.current?e.current.ownerDocument:document;if(void 0!==t&&!RJ.has(t)){var r=t.createElement("style");r.innerHTML='.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>\')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}',RJ.set(t,r);var i=CJ||n.nc;i&&r.setAttribute("nonce",i),t.head.appendChild(r)}}),[])},LJ=function(e){var n=e.className,r=e.colorModel,i=e.color,a=void 0===i?r.defaultColor:i,o=e.onChange,s=rJ(e,["className","colorModel","color","onChange"]),u=(0,t.useRef)(null);PJ(u);var l=EJ(r,a,o),c=l[0],h=l[1],f=hJ(["react-colorful",n]);return t.createElement("div",nJ({},s,{ref:u,className:f}),t.createElement(MJ,{hsva:c,onChange:h}),t.createElement(SJ,{hue:c.h,onChange:h,className:"react-colorful__last-control"}))},DJ={defaultColor:"000",toHsva:pJ,fromHsva:function(e){return mJ({h:e.h,s:e.s,v:e.v,a:1})},equal:TJ},NJ=function(e){return t.createElement(LJ,nJ({},e,{colorModel:DJ}))},IJ=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n,[{key:"render",value:function(){var e,t;return(0,rr.jsx)("div",{className:"LabeledCheckBox",style:this.props.style,children:this.props.labelOnRight?(0,rr.jsxs)(rr.Fragment,{children:[(0,rr.jsx)("input",{type:"checkbox",checked:this.props.checked,onChange:this.props.onChange,name:null!==(e=this.props.name)&&void 0!==e?e:""}),(0,rr.jsx)("label",{children:this.props.label})]}):(0,rr.jsxs)(rr.Fragment,{children:[(0,rr.jsx)("label",{children:this.props.label}),(0,rr.jsx)("input",{type:"checkbox",checked:this.props.checked,onChange:this.props.onChange,name:null!==(t=this.props.name)&&void 0!==t?t:""})]})})}}]),n}(t.Component);function OJ(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=OJ(e[t]))&&(r&&(r+=" "),r+=n);else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}var UJ=function(){for(var e,t,n=0,r="";n<arguments.length;)(e=arguments[n++])&&(t=OJ(e))&&(r&&(r+=" "),r+=t);return r};function FJ(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r={};return Object.keys(e).forEach((function(i){r[i]=e[i].reduce((function(e,r){if(r){var i=t(r);""!==i&&e.push(i),n&&n[r]&&e.push(n[r])}return e}),[]).join(" ")})),r}function zJ(e){for(var t="https://mui.com/production-error/?code="+e,n=1;n<arguments.length;n+=1)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+e+"; visit "+t+" for the full message."}function BJ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(t,e),n)}function VJ(e){if(e.type)return e;if("#"===e.charAt(0))return VJ(function(e){e=e.slice(1);var t=new RegExp(".{1,".concat(e.length>=6?2:1,"}"),"g"),n=e.match(t);return n&&1===n[0].length&&(n=n.map((function(e){return e+e}))),n?"rgb".concat(4===n.length?"a":"","(").concat(n.map((function(e,t){return t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3})).join(", "),")"):""}(e));var t=e.indexOf("("),n=e.substring(0,t);if(-1===["rgb","rgba","hsl","hsla","color"].indexOf(n))throw new Error(zJ(9,e));var r,i=e.substring(t+1,e.length-1);if("color"===n){if(r=(i=i.split(" ")).shift(),4===i.length&&"/"===i[3].charAt(0)&&(i[3]=i[3].slice(1)),-1===["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(r))throw new Error(zJ(10,r))}else i=i.split(",");return i=i.map((function(e){return parseFloat(e)})),{type:n,values:i,colorSpace:r}}function GJ(e){var t=e.type,n=e.colorSpace,r=e.values;return-1!==t.indexOf("rgb")?r=r.map((function(e,t){return t<3?parseInt(e,10):e})):-1!==t.indexOf("hsl")&&(r[1]="".concat(r[1],"%"),r[2]="".concat(r[2],"%")),r=-1!==t.indexOf("color")?"".concat(n," ").concat(r.join(" ")):"".concat(r.join(", ")),"".concat(t,"(").concat(r,")")}function jJ(e){var t="hsl"===(e=VJ(e)).type||"hsla"===e.type?VJ(function(e){var t=(e=VJ(e)).values,n=t[0],r=t[1]/100,i=t[2]/100,a=r*Math.min(i,1-i),o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e+n/30)%12;return i-a*Math.max(Math.min(t-3,9-t,1),-1)},s="rgb",u=[Math.round(255*o(0)),Math.round(255*o(8)),Math.round(255*o(4))];return"hsla"===e.type&&(s+="a",u.push(t[3])),GJ({type:s,values:u})}(e)).values:e.values;return t=t.map((function(t){return"color"!==e.type&&(t/=255),t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)})),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function HJ(e,t){return e=VJ(e),t=BJ(t),"rgb"!==e.type&&"hsl"!==e.type||(e.type+="a"),"color"===e.type?e.values[3]="/".concat(t):e.values[3]=t,GJ(e)}function WJ(e,t){if(e=VJ(e),t=BJ(t),-1!==e.type.indexOf("hsl"))e.values[2]*=1-t;else if(-1!==e.type.indexOf("rgb")||-1!==e.type.indexOf("color"))for(var n=0;n<3;n+=1)e.values[n]*=1-t;return GJ(e)}function ZJ(e,t){if(e=VJ(e),t=BJ(t),-1!==e.type.indexOf("hsl"))e.values[2]+=(100-e.values[2])*t;else if(-1!==e.type.indexOf("rgb"))for(var n=0;n<3;n+=1)e.values[n]+=(255-e.values[n])*t;else if(-1!==e.type.indexOf("color"))for(var r=0;r<3;r+=1)e.values[r]+=(1-e.values[r])*t;return GJ(e)}function qJ(e){if("string"!==typeof e)throw new Error(zJ(7));return e.charAt(0).toUpperCase()+e.slice(1)}var XJ=qJ,YJ=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,KJ=sq((function(e){return YJ.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91})),JJ=function(e){return"theme"!==e},QJ=function(e){return"string"===typeof e&&e.charCodeAt(0)>96?KJ:JJ},$J=function(e,t,n){var r;if(t){var i=t.shouldForwardProp;r=e.__emotion_forwardProp&&i?function(t){return e.__emotion_forwardProp(t)&&i(t)}:i}return"function"!==typeof r&&n&&(r=e.__emotion_forwardProp),r},eQ=function(e){var t=e.cache,n=e.serialized,r=e.isStringTag;return iq(t,n,r),bq((function(){return aq(t,n,r)})),null},tQ=function e(n,r){var i,a,o=n.__emotion_real===n,s=o&&n.__emotion_base||n;void 0!==r&&(i=r.label,a=r.target);var u=$J(n,r,o),l=u||QJ(s),c=!l("as");return function(){var h=arguments,f=o&&void 0!==n.__emotion_styles?n.__emotion_styles.slice(0):[];if(void 0!==i&&f.push("label:"+i+";"),null==h[0]||void 0===h[0].raw)f.push.apply(f,h);else{0,f.push(h[0][0]);for(var d=h.length,p=1;p<d;p++)f.push(h[p],h[0][p])}var v=wq((function(e,n,r){var i=c&&e.as||s,o="",h=[],d=e;if(null==e.theme){for(var p in d={},e)d[p]=e[p];d.theme=t.useContext(Sq)}"string"===typeof e.className?o=rq(n.registered,h,e.className):null!=e.className&&(o=e.className+" ");var v=gq(f.concat(h),n.registered,d);o+=n.key+"-"+v.name,void 0!==a&&(o+=" "+a);var m=c&&void 0===u?QJ(i):l,g={};for(var y in e)c&&"as"===y||m(y)&&(g[y]=e[y]);return g.className=o,g.ref=r,t.createElement(t.Fragment,null,t.createElement(eQ,{cache:n,serialized:v,isStringTag:"string"===typeof i}),t.createElement(i,g))}));return v.displayName=void 0!==i?i:"Styled("+("string"===typeof s?s:s.displayName||s.name||"Component")+")",v.defaultProps=n.defaultProps,v.__emotion_real=v,v.__emotion_base=s,v.__emotion_styles=f,v.__emotion_forwardProp=u,Object.defineProperty(v,"toString",{value:function(){return"."+a}}),v.withComponent=function(t,n){return e(t,bF({},r,n,{shouldForwardProp:$J(v,n,!0)})).apply(void 0,f)},v}}.bind();function nQ(e,t){return tQ(e,t)}["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){tQ[e]=tQ(e)}));var rQ=function(e,t){Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))};function iQ(e){return null!==e&&"object"===typeof e&&e.constructor===Object}function aQ(e){if(!iQ(e))return e;var t={};return Object.keys(e).forEach((function(n){t[n]=aQ(e[n])})),t}function oQ(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clone:!0},r=n.clone?bF({},e):e;return iQ(e)&&iQ(t)&&Object.keys(t).forEach((function(i){"__proto__"!==i&&(iQ(t[i])&&i in e&&iQ(e[i])?r[i]=oQ(e[i],t[i],n):n.clone?r[i]=iQ(t[i])?aQ(t[i]):t[i]:r[i]=t[i])})),r}var sQ=["values","unit","step"];function uQ(e){var t=e.values,n=void 0===t?{xs:0,sm:600,md:900,lg:1200,xl:1536}:t,r=e.unit,i=void 0===r?"px":r,a=e.step,o=void 0===a?5:a,s=_F(e,sQ),u=function(e){var t=Object.keys(e).map((function(t){return{key:t,val:e[t]}}))||[];return t.sort((function(e,t){return e.val-t.val})),t.reduce((function(e,t){return bF({},e,gr({},t.key,t.val))}),{})}(n),l=Object.keys(u);function c(e){var t="number"===typeof n[e]?n[e]:e;return"@media (min-width:".concat(t).concat(i,")")}function h(e){var t="number"===typeof n[e]?n[e]:e;return"@media (max-width:".concat(t-o/100).concat(i,")")}function f(e,t){var r=l.indexOf(t);return"@media (min-width:".concat("number"===typeof n[e]?n[e]:e).concat(i,") and ")+"(max-width:".concat((-1!==r&&"number"===typeof n[l[r]]?n[l[r]]:t)-o/100).concat(i,")")}return bF({keys:l,values:u,up:c,down:h,between:f,only:function(e){return l.indexOf(e)+1<l.length?f(e,l[l.indexOf(e)+1]):c(e)},not:function(e){var t=l.indexOf(e);return 0===t?c(l[1]):t===l.length-1?h(l[t]):f(e,l[l.indexOf(e)+1]).replace("@media","@media not all and")},unit:i},s)}var lQ={borderRadius:4},cQ={xs:0,sm:600,md:900,lg:1200,xl:1536},hQ={keys:["xs","sm","md","lg","xl"],up:function(e){return"@media (min-width:".concat(cQ[e],"px)")}};function fQ(e,t,n){var r=e.theme||{};if(Array.isArray(t)){var i=r.breakpoints||hQ;return t.reduce((function(e,r,a){return e[i.up(i.keys[a])]=n(t[a]),e}),{})}if("object"===typeof t){var a=r.breakpoints||hQ;return Object.keys(t).reduce((function(e,r){if(-1!==Object.keys(a.values||cQ).indexOf(r)){e[a.up(r)]=n(t[r],r)}else{var i=r;e[i]=t[i]}return e}),{})}return n(t)}function dQ(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=null==(e=t.keys)?void 0:e.reduce((function(e,n){return e[t.up(n)]={},e}),{});return n||{}}function pQ(e,t){return e.reduce((function(e,t){var n=e[t];return(!n||0===Object.keys(n).length)&&delete e[t],e}),t)}function vQ(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!t||"string"!==typeof t)return null;if(e&&e.vars&&n){var r="vars.".concat(t).split(".").reduce((function(e,t){return e&&e[t]?e[t]:null}),e);if(null!=r)return r}return t.split(".").reduce((function(e,t){return e&&null!=e[t]?e[t]:null}),e)}function mQ(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;return r="function"===typeof e?e(n):Array.isArray(e)?e[n]||i:vQ(e,n)||i,t&&(r=t(r,i,e)),r}var gQ=function(e){var t=e.prop,n=e.cssProperty,r=void 0===n?e.prop:n,i=e.themeKey,a=e.transform,o=function(e){if(null==e[t])return null;var n=e[t],o=vQ(e.theme,i)||{};return fQ(e,n,(function(e){var n=mQ(o,a,e);return e===n&&"string"===typeof e&&(n=mQ(o,a,"".concat(t).concat("default"===e?"":qJ(e)),e)),!1===r?n:gr({},r,n)}))};return o.propTypes={},o.filterProps=[t],o};var yQ=function(e,t){return t?oQ(e,t,{clone:!1}):e};var bQ={m:"margin",p:"padding"},_Q={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},xQ={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},wQ=function(e){var t={};return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}((function(e){if(e.length>2){if(!xQ[e])return[e];e=xQ[e]}var t=vr(e.split(""),2),n=t[0],r=t[1],i=bQ[n],a=_Q[r]||"";return Array.isArray(a)?a.map((function(e){return i+e})):[i+a]})),SQ=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],MQ=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],kQ=[].concat(SQ,MQ);function TQ(e,t,n,r){var i,a=null!=(i=vQ(e,t,!1))?i:n;return"number"===typeof a?function(e){return"string"===typeof e?e:a*e}:Array.isArray(a)?function(e){return"string"===typeof e?e:a[e]}:"function"===typeof a?a:function(){}}function EQ(e){return TQ(e,"spacing",8)}function CQ(e,t){if("string"===typeof t||null==t)return t;var n=e(Math.abs(t));return t>=0?n:"number"===typeof n?-n:"-".concat(n)}function AQ(e,t,n,r){if(-1===t.indexOf(n))return null;var i=function(e,t){return function(n){return e.reduce((function(e,r){return e[r]=CQ(t,n),e}),{})}}(wQ(n),r);return fQ(e,e[n],i)}function RQ(e,t){var n=EQ(e.theme);return Object.keys(e).map((function(r){return AQ(e,t,r,n)})).reduce(yQ,{})}function PQ(e){return RQ(e,SQ)}function LQ(e){return RQ(e,MQ)}function DQ(e){return RQ(e,kQ)}PQ.propTypes={},PQ.filterProps=SQ,LQ.propTypes={},LQ.filterProps=MQ,DQ.propTypes={},DQ.filterProps=kQ;function NQ(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;if(e.mui)return e;var t=EQ({spacing:e}),n=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=0===n.length?[1]:n;return i.map((function(e){var n=t(e);return"number"===typeof n?"".concat(n,"px"):n})).join(" ")};return n.mui=!0,n}var IQ=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.reduce((function(e,t){return t.filterProps.forEach((function(n){e[n]=t})),e}),{}),i=function(e){return Object.keys(e).reduce((function(t,n){return r[n]?yQ(t,r[n](e)):t}),{})};return i.propTypes={},i.filterProps=t.reduce((function(e,t){return e.concat(t.filterProps)}),[]),i};function OQ(e){return"number"!==typeof e?e:"".concat(e,"px solid")}var UQ=gQ({prop:"border",themeKey:"borders",transform:OQ}),FQ=gQ({prop:"borderTop",themeKey:"borders",transform:OQ}),zQ=gQ({prop:"borderRight",themeKey:"borders",transform:OQ}),BQ=gQ({prop:"borderBottom",themeKey:"borders",transform:OQ}),VQ=gQ({prop:"borderLeft",themeKey:"borders",transform:OQ}),GQ=gQ({prop:"borderColor",themeKey:"palette"}),jQ=gQ({prop:"borderTopColor",themeKey:"palette"}),HQ=gQ({prop:"borderRightColor",themeKey:"palette"}),WQ=gQ({prop:"borderBottomColor",themeKey:"palette"}),ZQ=gQ({prop:"borderLeftColor",themeKey:"palette"}),qQ=function(e){if(void 0!==e.borderRadius&&null!==e.borderRadius){var t=TQ(e.theme,"shape.borderRadius",4);return fQ(e,e.borderRadius,(function(e){return{borderRadius:CQ(t,e)}}))}return null};qQ.propTypes={},qQ.filterProps=["borderRadius"];IQ(UQ,FQ,zQ,BQ,VQ,GQ,jQ,HQ,WQ,ZQ,qQ);var XQ=function(e){if(void 0!==e.gap&&null!==e.gap){var t=TQ(e.theme,"spacing",8);return fQ(e,e.gap,(function(e){return{gap:CQ(t,e)}}))}return null};XQ.propTypes={},XQ.filterProps=["gap"];var YQ=function(e){if(void 0!==e.columnGap&&null!==e.columnGap){var t=TQ(e.theme,"spacing",8);return fQ(e,e.columnGap,(function(e){return{columnGap:CQ(t,e)}}))}return null};YQ.propTypes={},YQ.filterProps=["columnGap"];var KQ=function(e){if(void 0!==e.rowGap&&null!==e.rowGap){var t=TQ(e.theme,"spacing",8);return fQ(e,e.rowGap,(function(e){return{rowGap:CQ(t,e)}}))}return null};KQ.propTypes={},KQ.filterProps=["rowGap"];IQ(XQ,YQ,KQ,gQ({prop:"gridColumn"}),gQ({prop:"gridRow"}),gQ({prop:"gridAutoFlow"}),gQ({prop:"gridAutoColumns"}),gQ({prop:"gridAutoRows"}),gQ({prop:"gridTemplateColumns"}),gQ({prop:"gridTemplateRows"}),gQ({prop:"gridTemplateAreas"}),gQ({prop:"gridArea"}));function JQ(e,t){return"grey"===t?t:e}IQ(gQ({prop:"color",themeKey:"palette",transform:JQ}),gQ({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:JQ}),gQ({prop:"backgroundColor",themeKey:"palette",transform:JQ}));function QQ(e){return e<=1&&0!==e?"".concat(100*e,"%"):e}var $Q=gQ({prop:"width",transform:QQ}),e$=function(e){if(void 0!==e.maxWidth&&null!==e.maxWidth){return fQ(e,e.maxWidth,(function(t){var n,r,i=(null==(n=e.theme)||null==(n=n.breakpoints)||null==(n=n.values)?void 0:n[t])||cQ[t];return i?"px"!==(null==(r=e.theme)||null==(r=r.breakpoints)?void 0:r.unit)?{maxWidth:"".concat(i).concat(e.theme.breakpoints.unit)}:{maxWidth:i}:{maxWidth:QQ(t)}}))}return null};e$.filterProps=["maxWidth"];var t$=gQ({prop:"minWidth",transform:QQ}),n$=gQ({prop:"height",transform:QQ}),r$=gQ({prop:"maxHeight",transform:QQ}),i$=gQ({prop:"minHeight",transform:QQ}),a$=(gQ({prop:"size",cssProperty:"width",transform:QQ}),gQ({prop:"size",cssProperty:"height",transform:QQ}),IQ($Q,e$,t$,n$,r$,i$,gQ({prop:"boxSizing"})),{border:{themeKey:"borders",transform:OQ},borderTop:{themeKey:"borders",transform:OQ},borderRight:{themeKey:"borders",transform:OQ},borderBottom:{themeKey:"borders",transform:OQ},borderLeft:{themeKey:"borders",transform:OQ},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:qQ},color:{themeKey:"palette",transform:JQ},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:JQ},backgroundColor:{themeKey:"palette",transform:JQ},p:{style:LQ},pt:{style:LQ},pr:{style:LQ},pb:{style:LQ},pl:{style:LQ},px:{style:LQ},py:{style:LQ},padding:{style:LQ},paddingTop:{style:LQ},paddingRight:{style:LQ},paddingBottom:{style:LQ},paddingLeft:{style:LQ},paddingX:{style:LQ},paddingY:{style:LQ},paddingInline:{style:LQ},paddingInlineStart:{style:LQ},paddingInlineEnd:{style:LQ},paddingBlock:{style:LQ},paddingBlockStart:{style:LQ},paddingBlockEnd:{style:LQ},m:{style:PQ},mt:{style:PQ},mr:{style:PQ},mb:{style:PQ},ml:{style:PQ},mx:{style:PQ},my:{style:PQ},margin:{style:PQ},marginTop:{style:PQ},marginRight:{style:PQ},marginBottom:{style:PQ},marginLeft:{style:PQ},marginX:{style:PQ},marginY:{style:PQ},marginInline:{style:PQ},marginInlineStart:{style:PQ},marginInlineEnd:{style:PQ},marginBlock:{style:PQ},marginBlockStart:{style:PQ},marginBlockEnd:{style:PQ},displayPrint:{cssProperty:!1,transform:function(e){return{"@media print":{display:e}}}},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:XQ},rowGap:{style:KQ},columnGap:{style:YQ},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:QQ},maxWidth:{style:e$},minWidth:{transform:QQ},height:{transform:QQ},maxHeight:{transform:QQ},minHeight:{transform:QQ},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}}),o$=a$;var s$=function(){function e(e,t,n,r){var i,a=(gr(i={},e,t),gr(i,"theme",n),i),o=r[e];if(!o)return gr({},e,t);var s=o.cssProperty,u=void 0===s?e:s,l=o.themeKey,c=o.transform,h=o.style;if(null==t)return null;if("typography"===l&&"inherit"===t)return gr({},e,t);var f=vQ(n,l)||{};if(h)return h(a);return fQ(a,t,(function(t){var n=mQ(f,c,t);return t===n&&"string"===typeof t&&(n=mQ(f,c,"".concat(e).concat("default"===t?"":qJ(t)),t)),!1===u?n:gr({},u,n)}))}return function t(n){var r,i=n||{},a=i.sx,o=i.theme,s=void 0===o?{}:o;if(!a)return null;var u=null!=(r=s.unstable_sxConfig)?r:o$;function l(n){var r=n;if("function"===typeof n)r=n(s);else if("object"!==typeof n)return n;if(!r)return null;var i=dQ(s.breakpoints),a=Object.keys(i),o=i;return Object.keys(r).forEach((function(n){var i,a,l=(i=r[n],a=s,"function"===typeof i?i(a):i);if(null!==l&&void 0!==l)if("object"===typeof l)if(u[n])o=yQ(o,e(n,l,s,u));else{var c=fQ({theme:s},l,(function(e){return gr({},n,e)}));!function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.reduce((function(e,t){return e.concat(Object.keys(t))}),[]),i=new Set(r);return t.every((function(e){return i.size===Object.keys(e).length}))}(c,l)?o=yQ(o,c):o[n]=t({sx:l,theme:s})}else o=yQ(o,e(n,l,s,u))})),pQ(a,o)}return Array.isArray(a)?a.map(l):l(a)}}();s$.filterProps=["sx"];var u$=s$,l$=["breakpoints","palette","spacing","shape"];var c$=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.breakpoints,n=void 0===t?{}:t,r=e.palette,i=void 0===r?{}:r,a=e.spacing,o=e.shape,s=void 0===o?{}:o,u=_F(e,l$),l=uQ(n),c=NQ(a),h=oQ({breakpoints:l,direction:"ltr",components:{},palette:bF({mode:"light"},i),spacing:c,shape:bF({},lQ,s)},u),f=arguments.length,d=new Array(f>1?f-1:0),p=1;p<f;p++)d[p-1]=arguments[p];return(h=d.reduce((function(e,t){return oQ(e,t)}),h)).unstable_sxConfig=bF({},o$,null==u?void 0:u.unstable_sxConfig),h.unstable_sx=function(e){return u$({sx:e,theme:this})},h},h$=["variant"];function f$(e){return 0===e.length}function d$(e){var t=e.variant,n=_F(e,h$),r=t||"";return Object.keys(n).sort().forEach((function(t){r+="color"===t?f$(r)?e[t]:qJ(e[t]):"".concat(f$(r)?t:qJ(t)).concat(qJ(e[t].toString()))})),r}var p$=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function v$(e){return"string"===typeof e&&e.charCodeAt(0)>96}var m$=function(e,t){return t.components&&t.components[e]&&t.components[e].styleOverrides?t.components[e].styleOverrides:null},g$=function(e,t){var n=[];t&&t.components&&t.components[e]&&t.components[e].variants&&(n=t.components[e].variants);var r={};return n.forEach((function(e){var t=d$(e.props);r[t]=e.style})),r},y$=function(e,t,n,r){var i,a=e.ownerState,o=void 0===a?{}:a,s=[],u=null==n||null==(i=n.components)||null==(i=i[r])?void 0:i.variants;return u&&u.forEach((function(n){var r=!0;Object.keys(n.props).forEach((function(t){o[t]!==n.props[t]&&e[t]!==n.props[t]&&(r=!1)})),r&&s.push(t[d$(n.props)])})),s};function b$(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}var _$=c$(),x$=function(e){return e?e.charAt(0).toLowerCase()+e.slice(1):e};function w$(e){var t,n=e.defaultTheme,r=e.theme,i=e.themeId;return t=r,0===Object.keys(t).length?n:r[i]||r}function S$(e){return e?function(t,n){return n[e]}:null}function M$(e,t){var n;return bF({toolbar:(n={minHeight:56},gr(n,e.up("xs"),{"@media (orientation: landscape)":{minHeight:48}}),gr(n,e.up("sm"),{minHeight:64}),n)},t)}var k$={black:"#000",white:"#fff"},T$={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},E$={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},C$={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},A$={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},R$={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},P$={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},L$={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},D$=["mode","contrastThreshold","tonalOffset"],N$={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:k$.white,default:k$.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},I$={text:{primary:k$.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:k$.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function O$(e,t,n,r){var i=r.light||r,a=r.dark||1.5*r;e[t]||(e.hasOwnProperty(n)?e[t]=e[n]:"light"===t?e.light=ZJ(e.main,i):"dark"===t&&(e.dark=WJ(e.main,a)))}function U$(e){var t=e.mode,n=void 0===t?"light":t,r=e.contrastThreshold,i=void 0===r?3:r,a=e.tonalOffset,o=void 0===a?.2:a,s=_F(e,D$),u=e.primary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:R$[200],light:R$[50],dark:R$[400]}:{main:R$[700],light:R$[400],dark:R$[800]}}(n),l=e.secondary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:E$[200],light:E$[50],dark:E$[400]}:{main:E$[500],light:E$[300],dark:E$[700]}}(n),c=e.error||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:C$[500],light:C$[300],dark:C$[700]}:{main:C$[700],light:C$[400],dark:C$[800]}}(n),h=e.info||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:P$[400],light:P$[300],dark:P$[700]}:{main:P$[700],light:P$[500],dark:P$[900]}}(n),f=e.success||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:L$[400],light:L$[300],dark:L$[700]}:{main:L$[800],light:L$[500],dark:L$[900]}}(n),d=e.warning||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:A$[400],light:A$[300],dark:A$[700]}:{main:"#ed6c02",light:A$[500],dark:A$[900]}}(n);function p(e){var t=function(e,t){var n=jJ(e),r=jJ(t);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}(e,I$.text.primary)>=i?I$.text.primary:N$.text.primary;return t}var v=function(e){var t=e.color,n=e.name,r=e.mainShade,i=void 0===r?500:r,a=e.lightShade,s=void 0===a?300:a,u=e.darkShade,l=void 0===u?700:u;if(!(t=bF({},t)).main&&t[i]&&(t.main=t[i]),!t.hasOwnProperty("main"))throw new Error(zJ(11,n?" (".concat(n,")"):"",i));if("string"!==typeof t.main)throw new Error(zJ(12,n?" (".concat(n,")"):"",JSON.stringify(t.main)));return O$(t,"light",s,o),O$(t,"dark",l,o),t.contrastText||(t.contrastText=p(t.main)),t},m={dark:I$,light:N$};return oQ(bF({common:bF({},k$),mode:n,primary:v({color:u,name:"primary"}),secondary:v({color:l,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:v({color:c,name:"error"}),warning:v({color:d,name:"warning"}),info:v({color:h,name:"info"}),success:v({color:f,name:"success"}),grey:T$,contrastThreshold:i,getContrastText:p,augmentColor:v,tonalOffset:o},m[n]),s)}var F$=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function z$(e){return Math.round(1e5*e)/1e5}var B$={textTransform:"uppercase"},V$='"Roboto", "Helvetica", "Arial", sans-serif';function G$(e,t){var n="function"===typeof t?t(e):t,r=n.fontFamily,i=void 0===r?V$:r,a=n.fontSize,o=void 0===a?14:a,s=n.fontWeightLight,u=void 0===s?300:s,l=n.fontWeightRegular,c=void 0===l?400:l,h=n.fontWeightMedium,f=void 0===h?500:h,d=n.fontWeightBold,p=void 0===d?700:d,v=n.htmlFontSize,m=void 0===v?16:v,g=n.allVariants,y=n.pxToRem,b=_F(n,F$);var _=o/14,x=y||function(e){return"".concat(e/m*_,"rem")},w=function(e,t,n,r,a){return bF({fontFamily:i,fontWeight:e,fontSize:x(t),lineHeight:n},i===V$?{letterSpacing:"".concat(z$(r/t),"em")}:{},a,g)},S={h1:w(u,96,1.167,-1.5),h2:w(u,60,1.2,-.5),h3:w(c,48,1.167,0),h4:w(c,34,1.235,.25),h5:w(c,24,1.334,0),h6:w(f,20,1.6,.15),subtitle1:w(c,16,1.75,.15),subtitle2:w(f,14,1.57,.1),body1:w(c,16,1.5,.15),body2:w(c,14,1.43,.15),button:w(f,14,1.75,.4,B$),caption:w(c,12,1.66,.4),overline:w(c,12,2.66,1,B$),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return oQ(bF({htmlFontSize:m,pxToRem:x,fontFamily:i,fontSize:o,fontWeightLight:u,fontWeightRegular:c,fontWeightMedium:f,fontWeightBold:p},S),b,{clone:!1})}function j$(){return["".concat(arguments.length<=0?void 0:arguments[0],"px ").concat(arguments.length<=1?void 0:arguments[1],"px ").concat(arguments.length<=2?void 0:arguments[2],"px ").concat(arguments.length<=3?void 0:arguments[3],"px rgba(0,0,0,").concat(.2,")"),"".concat(arguments.length<=4?void 0:arguments[4],"px ").concat(arguments.length<=5?void 0:arguments[5],"px ").concat(arguments.length<=6?void 0:arguments[6],"px ").concat(arguments.length<=7?void 0:arguments[7],"px rgba(0,0,0,").concat(.14,")"),"".concat(arguments.length<=8?void 0:arguments[8],"px ").concat(arguments.length<=9?void 0:arguments[9],"px ").concat(arguments.length<=10?void 0:arguments[10],"px ").concat(arguments.length<=11?void 0:arguments[11],"px rgba(0,0,0,").concat(.12,")")].join(",")}var H$=["none",j$(0,2,1,-1,0,1,1,0,0,1,3,0),j$(0,3,1,-2,0,2,2,0,0,1,5,0),j$(0,3,3,-2,0,3,4,0,0,1,8,0),j$(0,2,4,-1,0,4,5,0,0,1,10,0),j$(0,3,5,-1,0,5,8,0,0,1,14,0),j$(0,3,5,-1,0,6,10,0,0,1,18,0),j$(0,4,5,-2,0,7,10,1,0,2,16,1),j$(0,5,5,-3,0,8,10,1,0,3,14,2),j$(0,5,6,-3,0,9,12,1,0,3,16,2),j$(0,6,6,-3,0,10,14,1,0,4,18,3),j$(0,6,7,-4,0,11,15,1,0,4,20,3),j$(0,7,8,-4,0,12,17,2,0,5,22,4),j$(0,7,8,-4,0,13,19,2,0,5,24,4),j$(0,7,9,-4,0,14,21,2,0,5,26,4),j$(0,8,9,-5,0,15,22,2,0,6,28,5),j$(0,8,10,-5,0,16,24,2,0,6,30,5),j$(0,8,11,-5,0,17,26,2,0,6,32,5),j$(0,9,11,-5,0,18,28,2,0,7,34,6),j$(0,9,12,-6,0,19,29,2,0,7,36,6),j$(0,10,13,-6,0,20,31,3,0,8,38,7),j$(0,10,13,-6,0,21,33,3,0,8,40,7),j$(0,10,14,-6,0,22,35,3,0,8,42,7),j$(0,11,14,-7,0,23,36,3,0,9,44,8),j$(0,11,15,-7,0,24,38,3,0,9,46,8)],W$=["duration","easing","delay"],Z$={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},q$={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function X$(e){return"".concat(Math.round(e),"ms")}function Y$(e){if(!e)return 0;var t=e/36;return Math.round(10*(4+15*Math.pow(t,.25)+t/5))}function K$(e){var t=bF({},Z$,e.easing),n=bF({},q$,e.duration);return bF({getAutoHeightDuration:Y$,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.duration,a=void 0===i?n.standard:i,o=r.easing,s=void 0===o?t.easeInOut:o,u=r.delay,l=void 0===u?0:u;_F(r,W$);return(Array.isArray(e)?e:[e]).map((function(e){return"".concat(e," ").concat("string"===typeof a?a:X$(a)," ").concat(s," ").concat("string"===typeof l?l:X$(l))})).join(",")}},e,{easing:t,duration:n})}var J$={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},Q$=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function $$(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.mixins,n=void 0===t?{}:t,r=e.palette,i=void 0===r?{}:r,a=e.transitions,o=void 0===a?{}:a,s=e.typography,u=void 0===s?{}:s,l=_F(e,Q$);if(e.vars)throw new Error(zJ(18));var c=U$(i),h=c$(e),f=oQ(h,{mixins:M$(h.breakpoints,n),palette:c,shadows:H$.slice(),typography:G$(c,u),transitions:K$(o),zIndex:bF({},J$)});f=oQ(f,l);for(var d=arguments.length,p=new Array(d>1?d-1:0),v=1;v<d;v++)p[v-1]=arguments[v];return(f=p.reduce((function(e,t){return oQ(e,t)}),f)).unstable_sxConfig=bF({},o$,null==l?void 0:l.unstable_sxConfig),f.unstable_sx=function(e){return u$({sx:e,theme:this})},f}var e0=$$(),t0="$$material",n0=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.themeId,n=e.defaultTheme,r=void 0===n?_$:n,i=e.rootShouldForwardProp,a=void 0===i?b$:i,o=e.slotShouldForwardProp,s=void 0===o?b$:o,u=function(e){return u$(bF({},e,{theme:w$(bF({},e,{defaultTheme:r,themeId:t}))}))};return u.__mui_systemSx=!0,function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};rQ(e,(function(e){return e.filter((function(e){return!(null!=e&&e.__mui_systemSx)}))}));var i,o=n.name,l=n.slot,c=n.skipVariantsResolver,h=n.skipSx,f=n.overridesResolver,d=void 0===f?S$(x$(l)):f,p=_F(n,p$),v=void 0!==c?c:l&&"Root"!==l&&"root"!==l||!1,m=h||!1;var g=b$;"Root"===l||"root"===l?g=a:l?g=s:v$(e)&&(g=void 0);var y=nQ(e,bF({shouldForwardProp:g,label:i},p)),b=function(n){for(var i=arguments.length,a=new Array(i>1?i-1:0),s=1;s<i;s++)a[s-1]=arguments[s];var l=a?a.map((function(e){return"function"===typeof e&&e.__emotion_real!==e?function(n){return e(bF({},n,{theme:w$(bF({},n,{defaultTheme:r,themeId:t}))}))}:e})):[],c=n;o&&d&&l.push((function(e){var n=w$(bF({},e,{defaultTheme:r,themeId:t})),i=m$(o,n);if(i){var a={};return Object.entries(i).forEach((function(t){var r=vr(t,2),i=r[0],o=r[1];a[i]="function"===typeof o?o(bF({},e,{theme:n})):o})),d(e,a)}return null})),o&&!v&&l.push((function(e){var n=w$(bF({},e,{defaultTheme:r,themeId:t}));return y$(e,g$(o,n),n,o)})),m||l.push(u);var h=l.length-a.length;if(Array.isArray(n)&&h>0){var f=new Array(h).fill("");(c=[].concat(cr(n),cr(f))).raw=[].concat(cr(n.raw),cr(f))}else"function"===typeof n&&n.__emotion_real!==n&&(c=function(e){return n(bF({},e,{theme:w$(bF({},e,{defaultTheme:r,themeId:t}))}))});var p=y.apply(void 0,[c].concat(cr(l)));return e.muiName&&(p.muiName=e.muiName),p};return y.withConfig&&(b.withConfig=y.withConfig),b}}({themeId:t0,defaultTheme:e0,rootShouldForwardProp:function(e){return b$(e)&&"classes"!==e}}),r0=n0;var i0=function(e){var n=e.controlled,r=e.default,i=(e.name,e.state,t.useRef(void 0!==n).current),a=vr(t.useState(r),2),o=a[0],s=a[1];return[i?n:o,t.useCallback((function(e){i||s(e)}),[])]};var a0=t.createContext(void 0);function o0(e,t){var n=bF({},t);return Object.keys(e).forEach((function(r){if(r.toString().match(/^(components|slots)$/))n[r]=bF({},e[r],n[r]);else if(r.toString().match(/^(componentsProps|slotProps)$/)){var i=e[r]||{},a=t[r];n[r]={},a&&Object.keys(a)?i&&Object.keys(i)?(n[r]=bF({},a),Object.keys(i).forEach((function(e){n[r][e]=o0(i[e],a[e])}))):n[r]=a:n[r]=i}else void 0===n[r]&&(n[r]=e[r])})),n}function s0(e){var t=e.theme,n=e.name,r=e.props;return t&&t.components&&t.components[n]&&t.components[n].defaultProps?o0(t.components[n].defaultProps,r):r}function u0(e){return 0===Object.keys(e).length}var l0=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=t.useContext(Sq);return!n||u0(n)?e:n},c0=c$();var h0=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c0;return l0(e)};function f0(e){return function(e){var t=e.props,n=e.name,r=e.defaultTheme,i=e.themeId,a=h0(r);return i&&(a=a[i]||a),s0({theme:a,name:n,props:t})}({props:e.props,name:e.name,defaultTheme:e0,themeId:t0})}function d0(e,t){"function"===typeof e?e(t):e&&(e.current=t)}var p0=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.useMemo((function(){return n.every((function(e){return null==e}))?null:function(e){n.forEach((function(t){d0(t,e)}))}}),n)},v0="undefined"!==typeof window?t.useLayoutEffect:t.useEffect;var m0,g0=function(e){var n=t.useRef(e);return v0((function(){n.current=e})),t.useCallback((function(){return n.current.apply(void 0,arguments)}),[])},y0=g0,b0=!0,_0=!1,x0={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function w0(e){e.metaKey||e.altKey||e.ctrlKey||(b0=!0)}function S0(){b0=!1}function M0(){"hidden"===this.visibilityState&&_0&&(b0=!0)}function k0(e){var t=e.target;try{return t.matches(":focus-visible")}catch(n){}return b0||function(e){var t=e.type,n=e.tagName;return!("INPUT"!==n||!x0[t]||e.readOnly)||"TEXTAREA"===n&&!e.readOnly||!!e.isContentEditable}(t)}var T0=function(){var e=t.useCallback((function(e){var t;null!=e&&((t=e.ownerDocument).addEventListener("keydown",w0,!0),t.addEventListener("mousedown",S0,!0),t.addEventListener("pointerdown",S0,!0),t.addEventListener("touchstart",S0,!0),t.addEventListener("visibilitychange",M0,!0))}),[]),n=t.useRef(!1);return{isFocusVisibleRef:n,onFocus:function(e){return!!k0(e)&&(n.current=!0,!0)},onBlur:function(){return!!n.current&&(_0=!0,window.clearTimeout(m0),m0=window.setTimeout((function(){_0=!1}),100),n.current=!1,!0)},ref:e}};var E0=t.createContext(null);function C0(e,n){var r=Object.create(null);return e&&t.Children.map(e,(function(e){return e})).forEach((function(e){r[e.key]=function(e){return n&&(0,t.isValidElement)(e)?n(e):e}(e)})),r}function A0(e,t,n){return null!=n[t]?n[t]:e.props[t]}function R0(e,n,r){var i=C0(e.children),a=function(e,t){function n(n){return n in t?t[n]:e[n]}e=e||{},t=t||{};var r,i=Object.create(null),a=[];for(var o in e)o in t?a.length&&(i[o]=a,a=[]):a.push(o);var s={};for(var u in t){if(i[u])for(r=0;r<i[u].length;r++){var l=i[u][r];s[i[u][r]]=n(l)}s[u]=n(u)}for(r=0;r<a.length;r++)s[a[r]]=n(a[r]);return s}(n,i);return Object.keys(a).forEach((function(o){var s=a[o];if((0,t.isValidElement)(s)){var u=o in n,l=o in i,c=n[o],h=(0,t.isValidElement)(c)&&!c.props.in;!l||u&&!h?l||!u||h?l&&u&&(0,t.isValidElement)(c)&&(a[o]=(0,t.cloneElement)(s,{onExited:r.bind(null,s),in:c.props.in,exit:A0(s,"exit",e),enter:A0(s,"enter",e)})):a[o]=(0,t.cloneElement)(s,{in:!1}):a[o]=(0,t.cloneElement)(s,{onExited:r.bind(null,s),in:!0,exit:A0(s,"exit",e),enter:A0(s,"enter",e)})}})),a}var P0=Object.values||function(e){return Object.keys(e).map((function(t){return e[t]}))},L0=function(e){var n,r;function i(t,n){var r,i=(r=e.call(this,t,n)||this).handleExited.bind((0,c.Z)(r));return r.state={contextValue:{isMounting:!0},handleExited:i,firstRender:!0},r}r=e,(n=i).prototype=Object.create(r.prototype),n.prototype.constructor=n,(0,Y_.Z)(n,r);var a=i.prototype;return a.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},a.componentWillUnmount=function(){this.mounted=!1},i.getDerivedStateFromProps=function(e,n){var r,i,a=n.children,o=n.handleExited;return{children:n.firstRender?(r=e,i=o,C0(r.children,(function(e){return(0,t.cloneElement)(e,{onExited:i.bind(null,e),in:!0,appear:A0(e,"appear",r),enter:A0(e,"enter",r),exit:A0(e,"exit",r)})}))):R0(e,a,o),firstRender:!1}},a.handleExited=function(e,t){var n=C0(this.props.children);e.key in n||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState((function(t){var n=bF({},t.children);return delete n[e.key],{children:n}})))},a.render=function(){var e=this.props,n=e.component,r=e.childFactory,i=_F(e,["component","childFactory"]),a=this.state.contextValue,o=P0(this.state.children).map(r);return delete i.appear,delete i.enter,delete i.exit,null===n?t.createElement(E0.Provider,{value:a},o):t.createElement(E0.Provider,{value:a},t.createElement(n,i,o))},i}(t.Component);L0.propTypes={},L0.defaultProps={component:"div",childFactory:function(e){return e}};var D0=L0;var N0=function(e){var n=e.className,r=e.classes,i=e.pulsate,a=void 0!==i&&i,o=e.rippleX,s=e.rippleY,u=e.rippleSize,l=e.in,c=e.onExited,h=e.timeout,f=vr(t.useState(!1),2),d=f[0],p=f[1],v=UJ(n,r.ripple,r.rippleVisible,a&&r.ripplePulsate),m={width:u,height:u,top:-u/2+s,left:-u/2+o},g=UJ(r.child,d&&r.childLeaving,a&&r.childPulsate);return l||d||p(!0),t.useEffect((function(){if(!l&&null!=c){var e=setTimeout(c,h);return function(){clearTimeout(e)}}}),[c,l,h]),(0,rr.jsx)("span",{className:v,style:m,children:(0,rr.jsx)("span",{className:g})})},I0=function(e){return e},O0=function(){var e=I0;return{configure:function(t){e=t},generate:function(t){return e(t)},reset:function(){e=I0}}}(),U0={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function F0(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui",r=U0[t];return r?"".concat(n,"-").concat(r):"".concat(O0.generate(e),"-").concat(t)}function z0(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui",r={};return t.forEach((function(t){r[t]=F0(e,t,n)})),r}var B0,V0,G0,j0,H0,W0,Z0,q0,X0=z0("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),Y0=["center","classes","className"],K0=Rq(H0||(H0=B0||(B0=Pq(["\n  0% {\n    transform: scale(0);\n    opacity: 0.1;\n  }\n\n  100% {\n    transform: scale(1);\n    opacity: 0.3;\n  }\n"])))),J0=Rq(W0||(W0=V0||(V0=Pq(["\n  0% {\n    opacity: 1;\n  }\n\n  100% {\n    opacity: 0;\n  }\n"])))),Q0=Rq(Z0||(Z0=G0||(G0=Pq(["\n  0% {\n    transform: scale(1);\n  }\n\n  50% {\n    transform: scale(0.92);\n  }\n\n  100% {\n    transform: scale(1);\n  }\n"])))),$0=r0("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),e1=r0(N0,{name:"MuiTouchRipple",slot:"Ripple"})(q0||(q0=j0||(j0=Pq(["\n  opacity: 0;\n  position: absolute;\n\n  &."," {\n    opacity: 0.3;\n    transform: scale(1);\n    animation-name: ",";\n    animation-duration: ","ms;\n    animation-timing-function: ",";\n  }\n\n  &."," {\n    animation-duration: ","ms;\n  }\n\n  & ."," {\n    opacity: 1;\n    display: block;\n    width: 100%;\n    height: 100%;\n    border-radius: 50%;\n    background-color: currentColor;\n  }\n\n  & ."," {\n    opacity: 0;\n    animation-name: ",";\n    animation-duration: ","ms;\n    animation-timing-function: ",";\n  }\n\n  & ."," {\n    position: absolute;\n    /* @noflip */\n    left: 0px;\n    top: 0;\n    animation-name: ",";\n    animation-duration: 2500ms;\n    animation-timing-function: ",";\n    animation-iteration-count: infinite;\n    animation-delay: 200ms;\n  }\n"]))),X0.rippleVisible,K0,550,(function(e){return e.theme.transitions.easing.easeInOut}),X0.ripplePulsate,(function(e){return e.theme.transitions.duration.shorter}),X0.child,X0.childLeaving,J0,550,(function(e){return e.theme.transitions.easing.easeInOut}),X0.childPulsate,Q0,(function(e){return e.theme.transitions.easing.easeInOut})),t1=t.forwardRef((function(e,n){var r=f0({props:e,name:"MuiTouchRipple"}),i=r.center,a=void 0!==i&&i,o=r.classes,s=void 0===o?{}:o,u=r.className,l=_F(r,Y0),c=vr(t.useState([]),2),h=c[0],f=c[1],d=t.useRef(0),p=t.useRef(null);t.useEffect((function(){p.current&&(p.current(),p.current=null)}),[h]);var v=t.useRef(!1),m=t.useRef(0),g=t.useRef(null),y=t.useRef(null);t.useEffect((function(){return function(){m.current&&clearTimeout(m.current)}}),[]);var b=t.useCallback((function(e){var t=e.pulsate,n=e.rippleX,r=e.rippleY,i=e.rippleSize,a=e.cb;f((function(e){return[].concat(cr(e),[(0,rr.jsx)(e1,{classes:{ripple:UJ(s.ripple,X0.ripple),rippleVisible:UJ(s.rippleVisible,X0.rippleVisible),ripplePulsate:UJ(s.ripplePulsate,X0.ripplePulsate),child:UJ(s.child,X0.child),childLeaving:UJ(s.childLeaving,X0.childLeaving),childPulsate:UJ(s.childPulsate,X0.childPulsate)},timeout:550,pulsate:t,rippleX:n,rippleY:r,rippleSize:i},d.current)])})),d.current+=1,p.current=a}),[s]),_=t.useCallback((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=t.pulsate,i=void 0!==r&&r,o=t.center,s=void 0===o?a||t.pulsate:o,u=t.fakeElement,l=void 0!==u&&u;if("mousedown"===(null==e?void 0:e.type)&&v.current)v.current=!1;else{"touchstart"===(null==e?void 0:e.type)&&(v.current=!0);var c,h,f,d=l?null:y.current,p=d?d.getBoundingClientRect():{width:0,height:0,left:0,top:0};if(s||void 0===e||0===e.clientX&&0===e.clientY||!e.clientX&&!e.touches)c=Math.round(p.width/2),h=Math.round(p.height/2);else{var _=e.touches&&e.touches.length>0?e.touches[0]:e,x=_.clientX,w=_.clientY;c=Math.round(x-p.left),h=Math.round(w-p.top)}if(s)(f=Math.sqrt((2*Math.pow(p.width,2)+Math.pow(p.height,2))/3))%2===0&&(f+=1);else{var S=2*Math.max(Math.abs((d?d.clientWidth:0)-c),c)+2,M=2*Math.max(Math.abs((d?d.clientHeight:0)-h),h)+2;f=Math.sqrt(Math.pow(S,2)+Math.pow(M,2))}null!=e&&e.touches?null===g.current&&(g.current=function(){b({pulsate:i,rippleX:c,rippleY:h,rippleSize:f,cb:n})},m.current=setTimeout((function(){g.current&&(g.current(),g.current=null)}),80)):b({pulsate:i,rippleX:c,rippleY:h,rippleSize:f,cb:n})}}),[a,b]),x=t.useCallback((function(){_({},{pulsate:!0})}),[_]),w=t.useCallback((function(e,t){if(clearTimeout(m.current),"touchend"===(null==e?void 0:e.type)&&g.current)return g.current(),g.current=null,void(m.current=setTimeout((function(){w(e,t)})));g.current=null,f((function(e){return e.length>0?e.slice(1):e})),p.current=t}),[]);return t.useImperativeHandle(n,(function(){return{pulsate:x,start:_,stop:w}}),[x,_,w]),(0,rr.jsx)($0,bF({className:UJ(X0.root,s.root,u),ref:y},l,{children:(0,rr.jsx)(D0,{component:null,exit:!0,children:h})}))})),n1=t1;function r1(e){return F0("MuiButtonBase",e)}var i1,a1=z0("MuiButtonBase",["root","disabled","focusVisible"]),o1=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],s1=r0("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:function(e,t){return t.root}})((gr(i1={display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"}},"&.".concat(a1.disabled),{pointerEvents:"none",cursor:"default"}),gr(i1,"@media print",{colorAdjust:"exact"}),i1)),u1=t.forwardRef((function(e,n){var r=f0({props:e,name:"MuiButtonBase"}),i=r.action,a=r.centerRipple,o=void 0!==a&&a,s=r.children,u=r.className,l=r.component,c=void 0===l?"button":l,h=r.disabled,f=void 0!==h&&h,d=r.disableRipple,p=void 0!==d&&d,v=r.disableTouchRipple,m=void 0!==v&&v,g=r.focusRipple,y=void 0!==g&&g,b=r.LinkComponent,_=void 0===b?"a":b,x=r.onBlur,w=r.onClick,S=r.onContextMenu,M=r.onDragLeave,k=r.onFocus,T=r.onFocusVisible,E=r.onKeyDown,C=r.onKeyUp,A=r.onMouseDown,R=r.onMouseLeave,P=r.onMouseUp,L=r.onTouchEnd,D=r.onTouchMove,N=r.onTouchStart,I=r.tabIndex,O=void 0===I?0:I,U=r.TouchRippleProps,F=r.touchRippleRef,z=r.type,B=_F(r,o1),V=t.useRef(null),G=t.useRef(null),j=p0(G,F),H=T0(),W=H.isFocusVisibleRef,Z=H.onFocus,q=H.onBlur,X=H.ref,Y=vr(t.useState(!1),2),K=Y[0],J=Y[1];f&&K&&J(!1),t.useImperativeHandle(i,(function(){return{focusVisible:function(){J(!0),V.current.focus()}}}),[]);var Q=vr(t.useState(!1),2),$=Q[0],ee=Q[1];t.useEffect((function(){ee(!0)}),[]);var te=$&&!p&&!f;function ne(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m;return y0((function(r){return t&&t(r),!n&&G.current&&G.current[e](r),!0}))}t.useEffect((function(){K&&y&&!p&&$&&G.current.pulsate()}),[p,y,K,$]);var re=ne("start",A),ie=ne("stop",S),ae=ne("stop",M),oe=ne("stop",P),se=ne("stop",(function(e){K&&e.preventDefault(),R&&R(e)})),ue=ne("start",N),le=ne("stop",L),ce=ne("stop",D),he=ne("stop",(function(e){q(e),!1===W.current&&J(!1),x&&x(e)}),!1),fe=y0((function(e){V.current||(V.current=e.currentTarget),Z(e),!0===W.current&&(J(!0),T&&T(e)),k&&k(e)})),de=function(){var e=V.current;return c&&"button"!==c&&!("A"===e.tagName&&e.href)},pe=t.useRef(!1),ve=y0((function(e){y&&!pe.current&&K&&G.current&&" "===e.key&&(pe.current=!0,G.current.stop(e,(function(){G.current.start(e)}))),e.target===e.currentTarget&&de()&&" "===e.key&&e.preventDefault(),E&&E(e),e.target===e.currentTarget&&de()&&"Enter"===e.key&&!f&&(e.preventDefault(),w&&w(e))})),me=y0((function(e){y&&" "===e.key&&G.current&&K&&!e.defaultPrevented&&(pe.current=!1,G.current.stop(e,(function(){G.current.pulsate(e)}))),C&&C(e),w&&e.target===e.currentTarget&&de()&&" "===e.key&&!e.defaultPrevented&&w(e)})),ge=c;"button"===ge&&(B.href||B.to)&&(ge=_);var ye={};"button"===ge?(ye.type=void 0===z?"button":z,ye.disabled=f):(B.href||B.to||(ye.role="button"),f&&(ye["aria-disabled"]=f));var be=p0(n,X,V);var _e=bF({},r,{centerRipple:o,component:c,disabled:f,disableRipple:p,disableTouchRipple:m,focusRipple:y,tabIndex:O,focusVisible:K}),xe=function(e){var t=e.disabled,n=e.focusVisible,r=e.focusVisibleClassName,i=FJ({root:["root",t&&"disabled",n&&"focusVisible"]},r1,e.classes);return n&&r&&(i.root+=" ".concat(r)),i}(_e);return(0,rr.jsxs)(s1,bF({as:ge,className:UJ(xe.root,u),ownerState:_e,onBlur:he,onClick:w,onContextMenu:ie,onFocus:fe,onKeyDown:ve,onKeyUp:me,onMouseDown:re,onMouseLeave:se,onMouseUp:oe,onDragLeave:ae,onTouchEnd:le,onTouchMove:ce,onTouchStart:ue,ref:be,tabIndex:f?-1:O,type:z},ye,B,{children:[s,te?(0,rr.jsx)(n1,bF({ref:j,center:o},U)):null]}))})),l1=u1;function c1(e){return F0("PrivateSwitchBase",e)}z0("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);var h1=["autoFocus","checked","checkedIcon","className","defaultChecked","disabled","disableFocusRipple","edge","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"],f1=r0(l1)((function(e){var t=e.ownerState;return bF({padding:9,borderRadius:"50%"},"start"===t.edge&&{marginLeft:"small"===t.size?-3:-12},"end"===t.edge&&{marginRight:"small"===t.size?-3:-12})})),d1=r0("input")({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),p1=t.forwardRef((function(e,n){var r=e.autoFocus,i=e.checked,a=e.checkedIcon,o=e.className,s=e.defaultChecked,u=e.disabled,l=e.disableFocusRipple,c=void 0!==l&&l,h=e.edge,f=void 0!==h&&h,d=e.icon,p=e.id,v=e.inputProps,m=e.inputRef,g=e.name,y=e.onBlur,b=e.onChange,_=e.onFocus,x=e.readOnly,w=e.required,S=void 0!==w&&w,M=e.tabIndex,k=e.type,T=e.value,E=_F(e,h1),C=vr(i0({controlled:i,default:Boolean(s),name:"SwitchBase",state:"checked"}),2),A=C[0],R=C[1],P=t.useContext(a0),L=u;P&&"undefined"===typeof L&&(L=P.disabled);var D="checkbox"===k||"radio"===k,N=bF({},e,{checked:A,disabled:L,disableFocusRipple:c,edge:f}),I=function(e){var t=e.classes,n=e.checked,r=e.disabled,i=e.edge;return FJ({root:["root",n&&"checked",r&&"disabled",i&&"edge".concat(XJ(i))],input:["input"]},c1,t)}(N);return(0,rr.jsxs)(f1,bF({component:"span",className:UJ(I.root,o),centerRipple:!0,focusRipple:!c,disabled:L,tabIndex:null,role:void 0,onFocus:function(e){_&&_(e),P&&P.onFocus&&P.onFocus(e)},onBlur:function(e){y&&y(e),P&&P.onBlur&&P.onBlur(e)},ownerState:N,ref:n},E,{children:[(0,rr.jsx)(d1,bF({autoFocus:r,checked:i,defaultChecked:s,className:I.input,disabled:L,id:D?p:void 0,name:g,onChange:function(e){if(!e.nativeEvent.defaultPrevented){var t=e.target.checked;R(t),b&&b(e,t)}},readOnly:x,ref:m,required:S,ownerState:N,tabIndex:M,type:k},"checkbox"===k&&void 0===T?{}:{value:T},v)),A?a:d]}))})),v1=p1;function m1(e){return F0("MuiSwitch",e)}var g1=z0("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),y1=["className","color","edge","size","sx"],b1=r0("span",{name:"MuiSwitch",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,n.edge&&t["edge".concat(XJ(n.edge))],t["size".concat(XJ(n.size))]]}})((function(e){var t,n=e.ownerState;return bF({display:"inline-flex",width:58,height:38,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"}},"start"===n.edge&&{marginLeft:-8},"end"===n.edge&&{marginRight:-8},"small"===n.size&&(gr(t={width:40,height:24,padding:7},"& .".concat(g1.thumb),{width:16,height:16}),gr(t,"& .".concat(g1.switchBase),gr({padding:4},"&.".concat(g1.checked),{transform:"translateX(16px)"})),t))})),_1=r0(v1,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:function(e,t){var n=e.ownerState;return[t.switchBase,gr({},"& .".concat(g1.input),t.input),"default"!==n.color&&t["color".concat(XJ(n.color))]]}})((function(e){var t,n=e.theme;return gr(t={position:"absolute",top:0,left:0,zIndex:1,color:n.vars?n.vars.palette.Switch.defaultColor:"".concat("light"===n.palette.mode?n.palette.common.white:n.palette.grey[300]),transition:n.transitions.create(["left","transform"],{duration:n.transitions.duration.shortest})},"&.".concat(g1.checked),{transform:"translateX(20px)"}),gr(t,"&.".concat(g1.disabled),{color:n.vars?n.vars.palette.Switch.defaultDisabledColor:"".concat("light"===n.palette.mode?n.palette.grey[100]:n.palette.grey[600])}),gr(t,"&.".concat(g1.checked," + .").concat(g1.track),{opacity:.5}),gr(t,"&.".concat(g1.disabled," + .").concat(g1.track),{opacity:n.vars?n.vars.opacity.switchTrackDisabled:"".concat("light"===n.palette.mode?.12:.2)}),gr(t,"& .".concat(g1.input),{left:"-100%",width:"300%"}),t}),(function(e){var t,n=e.theme,r=e.ownerState;return bF({"&:hover":{backgroundColor:n.vars?"rgba(".concat(n.vars.palette.action.activeChannel," / ").concat(n.vars.palette.action.hoverOpacity,")"):HJ(n.palette.action.active,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"default"!==r.color&&(gr(t={},"&.".concat(g1.checked),gr({color:(n.vars||n).palette[r.color].main,"&:hover":{backgroundColor:n.vars?"rgba(".concat(n.vars.palette[r.color].mainChannel," / ").concat(n.vars.palette.action.hoverOpacity,")"):HJ(n.palette[r.color].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"&.".concat(g1.disabled),{color:n.vars?n.vars.palette.Switch["".concat(r.color,"DisabledColor")]:"".concat("light"===n.palette.mode?ZJ(n.palette[r.color].main,.62):WJ(n.palette[r.color].main,.55))})),gr(t,"&.".concat(g1.checked," + .").concat(g1.track),{backgroundColor:(n.vars||n).palette[r.color].main}),t))})),x1=r0("span",{name:"MuiSwitch",slot:"Track",overridesResolver:function(e,t){return t.track}})((function(e){var t=e.theme;return{height:"100%",width:"100%",borderRadius:7,zIndex:-1,transition:t.transitions.create(["opacity","background-color"],{duration:t.transitions.duration.shortest}),backgroundColor:t.vars?t.vars.palette.common.onBackground:"".concat("light"===t.palette.mode?t.palette.common.black:t.palette.common.white),opacity:t.vars?t.vars.opacity.switchTrack:"".concat("light"===t.palette.mode?.38:.3)}})),w1=r0("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:function(e,t){return t.thumb}})((function(e){var t=e.theme;return{boxShadow:(t.vars||t).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"}})),S1=t.forwardRef((function(e,t){var n=f0({props:e,name:"MuiSwitch"}),r=n.className,i=n.color,a=void 0===i?"primary":i,o=n.edge,s=void 0!==o&&o,u=n.size,l=void 0===u?"medium":u,c=n.sx,h=_F(n,y1),f=bF({},n,{color:a,edge:s,size:l}),d=function(e){var t=e.classes,n=e.edge,r=e.size,i=e.color,a=e.checked,o=e.disabled;return bF({},t,FJ({root:["root",n&&"edge".concat(XJ(n)),"size".concat(XJ(r))],switchBase:["switchBase","color".concat(XJ(i)),a&&"checked",o&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},m1,t))}(f),p=(0,rr.jsx)(w1,{className:d.thumb,ownerState:f});return(0,rr.jsxs)(b1,{className:UJ(d.root,r),sx:c,ownerState:f,children:[(0,rr.jsx)(_1,bF({type:"checkbox",icon:p,checkedIcon:p,ref:t,ownerState:f},h,{classes:bF({},d,{root:d.switchBase})})),(0,rr.jsx)(x1,{className:d.track,ownerState:f})]})})),M1=S1,k1={option:function(e){return Mr(Mr({},e),{},{color:"black",fontSize:"15px"})},control:function(e){return Mr(Mr({},e),{},{height:"100%",width:"100%",fontSize:"15px",backgroundColor:"rgb(23, 24, 25)"})},container:function(e,t){return Mr(Mr({},e),{},{height:"100%",width:"100%",display:"inline-flex",fontSize:"15px"})},placeholder:function(e){return Mr(Mr({},e),{},{fontSize:"15px",color:"rgb(183, 183, 189)"})},singleValue:function(e){return Mr(Mr({},e),{},{color:"rgb(183, 183, 189)"})}},T1=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var i;(0,u.Z)(this,r),(i=n.call(this,e))._panel_resize_observer=void 0,i._graphDiv=void 0,i.dropdownRef=[],i._animationCsvUrlInput=void 0,i.selectedOptions=[],i.recalcTimeWarp=function(){lr.recalculateTimeWarping()},i.state={counter:0,panelHeight:620,panelWidth:1200,dropdowns:[!1,!1],baseScene:void 0,currRobot:new Map,currJoint:new Map,currRobotPart:new Set,need_update:!0,currWarpedScene:void 0,applyToAllScenes:!1,keyObject:""},i._graphDiv=(0,t.createRef)();for(var a=0;a<2;a++)i.dropdownRef[a]=(0,t.createRef)();return i._animationCsvUrlInput=(0,t.createRef)(),i.onUploadAnimationCSV=i.onUploadAnimationCSV.bind((0,c.Z)(i)),i.onLoadAnimationCSV=i.onLoadAnimationCSV.bind((0,c.Z)(i)),i}return(0,l.Z)(r,[{key:"genSceneOptions",value:function(){var e,t=[],n=this.props,r=n.robotSceneManager,i=n.robotScene,a=s(r.allManagedRobotScenes());try{for(a.s();!(e=a.n()).done;){var o=e.value;o===i||o.isTimeWarping()||t.push({value:o.id().value(),label:o.name()})}}catch(x2){a.e(x2)}finally{a.f()}return t}},{key:"genKeyObjectOptions",value:function(){var e=[],t=this.props.robotScene,n=this.state.baseScene;if(void 0===n)return e;var r,i=s(t.robots());try{for(i.s();!(r=i.n()).done;){var a=r.value;if(void 0!==n.getRobotByName(a.name())){e.push({value:a.id().value(),label:a.name()+"\n position"});var o,u=s(a.articuatedJoints());try{for(u.s();!(o=u.n()).done;){var l=o.value;e.push({value:l.id().value(),label:a.name()+"\n"+l.name()+" position"}),e.push({value:l.id().value(),label:a.name()+"\n"+l.name()+" angle"})}}catch(x2){u.e(x2)}finally{u.f()}var c,h=s(a.links());try{for(h.s();!(c=h.n()).done;){var f=c.value;e.push({value:f.id().value(),label:a.name()+"\n"+f.name()+" position"})}}catch(x2){h.e(x2)}finally{h.f()}}}}catch(x2){i.e(x2)}finally{i.f()}return e}},{key:"onChangeScene",value:function(e){this.deselectDropdowns(0);var t=e.value;if(t){var n=this.props.robotSceneManager,r=n.robotSceneById(t);r&&(n.activeRobotScenes().includes(r)||n.activateRobotScene(r),this.setState({baseScene:r}),this.selectDropdowns(0))}}},{key:"onChangeKeyObject",value:function(e){this.deselectDropdowns(1);var t=e.label;t&&(this.setState({keyObject:t}),this.selectDropdowns(1))}},{key:"componentDidUpdate",value:function(e){var t=this.props.robotScene;t!==e.robotScene&&!t.isTimeWarping()&&(this.dropdownRef[0].current.setValue(this.dropdownRef[0].current.state.prevProps.placeholder),this.deselectDropdowns(0))}},{key:"deselectDropdowns",value:function(e){this.state.dropdowns[e]=!1,1==e+1?this.selectedOptions=[]:void 0!=this.dropdownRef[e+1]&&this.dropdownRef[e+1].current.setValue(this.dropdownRef[e+1].current.state.prevProps.placeholder)}},{key:"selectDropdowns",value:function(e){this.state.dropdowns[e]=!0}},{key:"createNewGraphTab",value:function(e){}},{key:"onConfirm",value:function(e){for(var t=0;t<2;t++)if(!this.state.dropdowns[t])throw new Error("".concat(t," Not every dropdown is selected. Need to select all dropdowns to show the graph"));var n=this.props,r=n.robotScene,i=n.robotSceneManager,a=this.state,o=a.baseScene,s=a.keyObject,u=r?i.getManagedRobotSceneData(r):void 0;if(void 0!==u){var l=u.robotScene.clone(!0,!1,!1);this.setState({currWarpedScene:l}),l.setName(r.name()+" Time Warped Based On "+(null===o||void 0===o?void 0:o.name())),i.addManagedRobotScenes([{path:cr(u.path),robotScene:l,metrics:new Map(u.metrics)}]),l.setTimeWarpBase(o);var c=vr(s.split("\n"),2),h=c[0],f=vr(c[1].split(" "),2),d=f[0],p=f[1];if(0===d.length){var v=l.getRobotByName(h);null===v||void 0===v||v.setPositionIncludeInTimeWarpConsideration(!0)}else{var m,g=l.getJointByName(h,d);if(void 0===g)null===(m=g=l.getLinkByName(h,d))||void 0===m||m.setPosIncludeInTimeWarpConsideration(!0);else"angle"==p?g.setAngleIncludeInTimeWarpConsideration(!0):g.setPosIncludeInTimeWarpConsideration(!0)}l.setTimeWarpBase(void 0),l.setTimeWarpBase(o),l.setKeyObjects([s])}}},{key:"onTimeWarpBar",value:function(e){var t=this.props,n=t.robotScene;t.robotSceneManager;n.isTimeWarping()?this.props.addNewTimeWarpTimeBar(n.id().value()):void 0!==this.state.currWarpedScene&&this.props.addNewTimeWarpTimeBar(this.state.currWarpedScene.id().value())}},{key:"onAddGroup",value:function(){this.props.animationManager.addStoredAnimation(new Hb)}},{key:"deleteAnimationAssociatedwithRobot",value:function(e,t){for(var n=cr(e.animations()),r=0;r<n.length;r++)t===n[r].robot()&&(console.log("remove animations!!!!"),e.removeAnimation(n[r]))}},{key:"autoBindNewAnimationtoRobot",value:function(e){console.log("auto bind new animation with robot!!!");var t,n=e.robotNames(),r=s(this.props.robotScene.robots());try{for(r.s();!(t=r.n()).done;){var i=t.value;if(n.has(i.name())){0===this.props.animationManager.animationGroups.length&&this.onAddGroup();var a,o=s(Ib(this.props.animationManager.animationGroups()));try{for(o.s();!(a=o.n()).done;){var u=vr(a.value,2),l=(u[0],u[1]);this.deleteAnimationAssociatedwithRobot(l,i),l.addAnimation(new jb(i,e)),-1===this.props.animationManager.activeAnimations().indexOf(l)&&this.props.animationManager.addActiveAnimation(l)}}catch(x2){o.e(x2)}finally{o.f()}}}}catch(x2){r.e(x2)}finally{r.f()}}},{key:"onLoadAnimationCSV",value:function(){var e=pr(fr().mark((function e(){var t,n,r,i,a;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(document.querySelectorAll(".LoadCSVMessage").forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)})),!(t=this._animationCsvUrlInput.current)){e.next=15;break}if(!((n=t.value).length>0)){e.next=14;break}return e.t0=s,e.next=9,FR.loadFromURL(n,"ReloadCSV");case 9:e.t1=e.sent,r=(0,e.t0)(e.t1);try{for(r.s();!(i=r.n()).done;)a=i.value,this.props.robotSceneManager.addAnimationTable(a),this.autoBindNewAnimationtoRobot(a)}catch(x2){r.e(x2)}finally{r.f()}e.next=15;break;case 14:lr.error("Failed to load the animation CSV file: The URL for the animation CSV file was empty!");case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onUploadAnimationCSV",value:function(){var e=pr(fr().mark((function e(t){var n,r,i,a,o,u,l;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(document.querySelectorAll(".LoadCSVMessage").forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)})),!(n=t.currentTarget.files)){e.next=25;break}r=s(n),e.prev=5,r.s();case 7:if((i=r.n()).done){e.next=17;break}return a=i.value,e.t0=s,e.next=12,FR.loadFromLocalFile(a,"ReloadCSV");case 12:e.t1=e.sent,o=(0,e.t0)(e.t1);try{for(o.s();!(u=o.n()).done;)l=u.value,this.props.robotSceneManager.addAnimationTable(l),this.autoBindNewAnimationtoRobot(l)}catch(x2){o.e(x2)}finally{o.f()}case 15:e.next=7;break;case 17:e.next=22;break;case 19:e.prev=19,e.t2=e.catch(5),r.e(e.t2);case 22:return e.prev=22,r.f(),e.finish(22);case 25:case"end":return e.stop()}}),e,this,[[5,19,22,25]])})));return function(t){return e.apply(this,arguments)}}()},{key:"displayKeyObjects",value:function(e){var t;if(e){var n=this.props.robotScene.keyObjects();t=(0,rr.jsx)("div",{children:n.map((function(e){return(0,rr.jsx)("p",{children:e},e)}))})}else t=(0,rr.jsx)(XY,{placeholder:"Select key objects ...",ref:this.dropdownRef[1],options:this.genKeyObjectOptions(),onChange:this.onChangeKeyObject.bind(this),isSearchable:!0,styles:k1});return t}},{key:"displayBaseScene",value:function(e){var t;if(e){var n,r=this.props,i=r.robotScene,a=null===(n=r.robotSceneManager.robotSceneById(i.baseSceneId()))||void 0===n?void 0:n.name();t=(0,rr.jsx)("p",{children:a})}else t=(0,rr.jsx)(XY,{placeholder:"Select a base scene ...",ref:this.dropdownRef[0],options:this.genSceneOptions(),onChange:this.onChangeScene.bind(this),isSearchable:!0,styles:k1});return t}},{key:"onTraceSizeChange",value:function(){var e=this;return function(t){e.props.robotScene.setTraceSize(t),e.state.applyToAllScenes&&e.applyChangesToAll()}}},{key:"onAxisSizeChange",value:function(){var e=this;return function(t){e.props.robotScene.setAxisSize(t),e.state.applyToAllScenes&&e.applyChangesToAll()}}},{key:"onDensityChange",value:function(){var e=this;return function(t){e.props.robotScene.setDensity(t),e.state.applyToAllScenes&&e.applyChangesToAll()}}},{key:"onDirectionalLightChange",value:function(){var e=this;return function(t){e.props.robotScene.setDirectionalLightIntensity(t),e.state.applyToAllScenes&&e.applyChangesToAll()}}},{key:"onAmbientLightChange",value:function(){var e=this;return function(t){e.props.robotScene.setAmbientLightIntensity(t),e.state.applyToAllScenes&&e.applyChangesToAll()}}},{key:"onColorMapChange",value:function(e){this.props.robotScene.setBackgroundColor(e),this.state.applyToAllScenes&&this.applyChangesToAll()}},{key:"onCheckGroundPlane",value:function(e){this.props.robotScene.setGroundPlaneVisibility(e.currentTarget.checked),this.setState({need_update:!this.state.need_update}),this.state.applyToAllScenes&&this.applyChangesToAll()}},{key:"onCheckWorldFrame",value:function(e){this.props.robotScene.setWorldFrameObjectVisibility(e.currentTarget.checked),this.setState({need_update:!this.state.need_update}),this.state.applyToAllScenes&&this.applyChangesToAll()}},{key:"toggleWorldFrame",value:function(){this.props.robotScene.toggleWorldFrame(),this.setState({need_update:!this.state.need_update}),this.state.applyToAllScenes&&this.applyChangesToAll(),this.props.forceUpdateTabNames()}},{key:"toggleCameraType",value:function(){this.props.robotScene.toggleCameraType(),this.setState({need_update:!this.state.need_update}),this.state.applyToAllScenes&&this.applyChangesToAll(),this.props.forceUpdateTabNames()}},{key:"onCheckApplytoAll",value:function(e){this.setState({applyToAllScenes:e.currentTarget.checked}),this.applyChangesToAll()}},{key:"applyChangesToAll",value:function(){var e,t=this.props.robotScene,n=t.backgroundColor(),r=t.ambientLightIntensity(),i=t.directionalLightIntensity(),a=t.isGroundPlaneVisible(),o=t.worldFrame(),u=t.cameraType(),l=t.axisSize(),c=t.density(),h=t.isWorldFrameObjectVisible(),f=t.traceSize(),d=s(this.props.robotSceneManager.allManagedRobotScenes());try{for(d.s();!(e=d.n()).done;){var p=e.value;p.setBackgroundColor(n),p.setAmbientLightIntensity(r),p.setDirectionalLightIntensity(i),p.setGroundPlaneVisibility(a),p.setWorldFrame(o),p.setCameraType(u),p.setAxisSize(l),p.setDensity(c),p.setWorldFrameObjectVisibility(h),p.setTraceSize(f)}}catch(x2){d.e(x2)}finally{d.f()}}},{key:"render",value:function(){var e=this,t=this.props,n=t.robotScene,r=t.robotSceneManager,i=this.state.currWarpedScene,a={marginBottom:"0.5rem"},o={display:"flex",gap:"0.5rem",marginBottom:"0.5rem",height:"1em",alignItems:"center"},s=n.isTimeWarping(),u=n.axisSize(),l=n.density();return(0,rr.jsxs)("div",{className:"SceneOptionPanel",ref:this._graphDiv,children:[(0,rr.jsxs)("div",{className:"PopUpGroup",children:[(0,rr.jsx)(tJ,{labelValue:"Scene Name:",value:n.name(),onReturnPressed:function(t){n.setName(t),e.props.forceUpdateTabNames()}}),(0,rr.jsx)("button",{id:"open-popup",className:"OpenPop",onClick:function(){return lr.setPopupHelpPage(Xn.SceneOptionPanel)},children:(0,rr.jsx)(qn,{className:"Icon",icon:$n})})]}),(0,rr.jsx)("div",{children:(0,rr.jsx)($Y,{buttonValue:"Legend",title:"Click and drag to add a legend to the scene",className:"Legend",getParentDockLayout:this.props.getParentDockLayout,onDragStart:function(){return["SceneLegend&".concat(Cb(4),"&").concat(e.props.robotScene.id().value()),function(e){}]}})}),(0,rr.jsx)(MK,{allowZeroExpanded:!0,allowMultipleExpanded:!0,children:(0,rr.jsxs)(IK,{children:[(0,rr.jsx)(JK,{children:(0,rr.jsx)(YK,{style:{fontWeight:"bold"},children:"Scene Views"})}),(0,rr.jsx)($K,{children:(0,rr.jsxs)("div",{className:"SceneViews",children:[(0,rr.jsx)("div",{children:(0,rr.jsx)(IJ,{label:"Apply Changes to All Scenes",checked:this.state.applyToAllScenes,onChange:this.onCheckApplytoAll.bind(this)})}),(0,rr.jsx)(MK,{allowZeroExpanded:!0,allowMultipleExpanded:!0,children:(0,rr.jsxs)(IK,{children:[(0,rr.jsx)(JK,{children:(0,rr.jsx)(YK,{style:{fontWeight:"bold"},children:"Background Color:"})}),(0,rr.jsx)($K,{children:(0,rr.jsx)(NJ,{color:n.backgroundColor(),onChange:function(t){return e.onColorMapChange(t)}})})]})}),(0,rr.jsxs)("div",{children:[(0,rr.jsx)("div",{style:a,children:(0,rr.jsx)(eJ,{robotSceneManager:r})}),(0,rr.jsxs)("div",{style:o,children:[(0,rr.jsx)("label",{children:"World Frame:"}),(0,rr.jsx)("label",{children:"ROS"}),(0,rr.jsx)(M1,{checked:"THREE.js"===n.worldFrame(),onChange:this.toggleWorldFrame.bind(this)}),(0,rr.jsx)("label",{children:"THREE.js"})]}),(0,rr.jsxs)("div",{style:o,children:[(0,rr.jsx)("label",{children:"Camera Type:"}),(0,rr.jsx)("label",{children:"Perspective"}),(0,rr.jsx)(M1,{checked:"Orthographic"===n.cameraType(),onChange:this.toggleCameraType.bind(this)}),(0,rr.jsx)("label",{children:"Orthographic"})]})]}),(0,rr.jsx)("div",{children:(0,rr.jsx)(IJ,{label:"Show Ground Plane",checked:n.isGroundPlaneVisible(),onChange:this.onCheckGroundPlane.bind(this)})}),(0,rr.jsx)("div",{children:(0,rr.jsx)(IJ,{label:"Show World Frame",checked:n.isWorldFrameObjectVisible(),onChange:this.onCheckWorldFrame.bind(this)})}),(0,rr.jsxs)("div",{children:[(0,rr.jsx)(QY,{label:"Directional Light Intensity",value:n.directionalLightIntensity(),min:0,max:10,step:.1,onChange:this.onDirectionalLightChange()}),(0,rr.jsx)(QY,{label:"Ambient Light Intensity",value:n.ambientLightIntensity(),min:0,max:10,step:.1,onChange:this.onAmbientLightChange()})]}),(0,rr.jsxs)("div",{children:[(0,rr.jsx)(QY,{label:"Trace Size",value:n.traceSize(),min:1e-4,max:5,step:.001,onChange:this.onTraceSizeChange()},"trace size"),(0,rr.jsx)(QY,{label:"Axis Size",value:u,min:0,max:.2,step:.001,onChange:this.onAxisSizeChange()},"axis size"),(0,rr.jsx)(QY,{label:"Axis Density",value:l,min:1e-4,max:1,step:.001,onChange:this.onDensityChange()},"density")]})]})})]})}),(0,rr.jsx)(MK,{allowZeroExpanded:!0,allowMultipleExpanded:!0,children:(0,rr.jsxs)(IK,{children:[(0,rr.jsx)(JK,{children:(0,rr.jsx)(YK,{style:{fontWeight:"bold"},children:"Time Warping Options"})}),(0,rr.jsx)($K,{children:(0,rr.jsxs)("div",{children:[(0,rr.jsxs)("div",{className:"Select",children:[(0,rr.jsx)("span",{children:"Base Scene : "}),(0,rr.jsx)("div",{className:"Select-container",style:a,children:this.displayBaseScene(s)})]}),(0,rr.jsxs)("div",{className:"Select",children:[(0,rr.jsx)("span",{children:"Key Object : "}),(0,rr.jsx)("div",{className:"Select-container",style:a,children:this.displayKeyObjects(s)})]}),(0,rr.jsx)("div",{style:{marginBottom:"5px",display:"flex",alignItems:"center",justifyContent:"center"},children:!s&&(0,rr.jsx)(YY,{buttonValue:"Confirm",onClick:this.onConfirm.bind(this)})}),(0,rr.jsxs)("div",{className:"ButtonsContainer",style:{display:"flex",gap:"1rem"},children:[(0,rr.jsx)(YY,{buttonValue:"Warped Time Bar",onClick:this.onTimeWarpBar.bind(this)}),(0,rr.jsx)($Y,{className:"TimeWarp",title:"Click and drag to create a time warp graph",buttonValue:"Warping Graph",getParentDockLayout:this.props.getParentDockLayout,onDragStart:function(){var t=Cb(4),r=n.isTimeWarping()?n.id().value():null===i||void 0===i?void 0:i.id().value();return["TimeWarpedGraph&".concat(t,"&").concat(r,"&motion"),function(n){e.createNewGraphTab(t)}]}})]})]})})]})}),(0,rr.jsx)(MK,{allowZeroExpanded:!0,allowMultipleExpanded:!0,children:(0,rr.jsxs)(IK,{children:[(0,rr.jsx)(JK,{children:(0,rr.jsx)(YK,{style:{fontWeight:"bold"},children:"Edit Motion"})}),(0,rr.jsx)($K,{children:(0,rr.jsxs)("div",{className:"ReloadCSV",children:[(0,rr.jsx)("div",{children:(0,rr.jsx)($W,{label:"Replace with a local animation: ",accept:[".csv"],vertical:!1,onChange:this.onUploadAnimationCSV})}),(0,rr.jsxs)("div",{children:[(0,rr.jsx)("label",{children:"Replace with an online animation: "}),(0,rr.jsx)("input",{ref:this._animationCsvUrlInput,type:"text",placeholder:" URL "}),(0,rr.jsx)("input",{type:"button",value:"Load",onClick:this.onLoadAnimationCSV})]})]})})]})})]})}}]),r}(t.Component),E1=[{robot_name:"sawyer",url:"https://raw.githubusercontent.com/motion-comparator/examples/main/robots/sawyer/urdf/sawyer_gripper.urdf"},{robot_name:"fetch",url:"https://raw.githubusercontent.com/motion-comparator/examples/main/robots/fetch/urdf/fetch.urdf"},{robot_name:"mico",url:"https://raw.githubusercontent.com/motion-comparator/examples/main/robots/kinova/urdf/mico.urdf"},{robot_name:"ur5",url:"https://raw.githubusercontent.com/motion-comparator/examples/main/robots/ur5/urdf/ur5_gripper.urdf"},{robot_name:"spot arm",url:"https://raw.githubusercontent.com/motion-comparator/examples/main/robots/spot_arm/urdf/spot_arm.urdf"},{robot_name:"panda",url:"https://raw.githubusercontent.com/motion-comparator/examples/main/robots/panda/urdf/panda.urdf"},{robot_name:"bottle",url:"https://raw.githubusercontent.com/motion-comparator/examples/main/objects/glass_bottle.glb"},{robot_name:"table",url:"https://raw.githubusercontent.com/motion-comparator/examples/main/objects/side_table.glb"},{robot_name:"end-effector targets",url:"EETarget"}],C1=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var i;(0,u.Z)(this,r),(i=n.call(this,e))._urdfURLInput=void 0,i._jsonURLInput=void 0,i._importSceneURLInput=void 0,i._animationCsvUrlInput=void 0,i._exampleRobotInput=void 0,i._exampleRobotOptions=[],i.dropdownRef=void 0,i.state={savedLayout:void 0},i.dropdownRef=(0,t.createRef)(),i.onLoadURDFURL=i.onLoadURDFURL.bind((0,c.Z)(i)),i.onUploadJsonScene=i.onUploadJsonScene.bind((0,c.Z)(i)),i.onLoadAnimationCSV=i.onLoadAnimationCSV.bind((0,c.Z)(i)),i.onLoadSession=i.onLoadSession.bind((0,c.Z)(i)),i.onSaveSession=i.onSaveSession.bind((0,c.Z)(i)),i.onUploadSession=i.onUploadSession.bind((0,c.Z)(i)),i.onUploadAnimationCSV=i.onUploadAnimationCSV.bind((0,c.Z)(i)),i.onSelectExampleRobot=i.onSelectExampleRobot.bind((0,c.Z)(i)),i.currScene=i.currScene.bind((0,c.Z)(i)),i._animationCsvUrlInput=(0,t.createRef)(),i._urdfURLInput=(0,t.createRef)(),i._jsonURLInput=(0,t.createRef)(),i._importSceneURLInput=(0,t.createRef)(),i._exampleRobotInput=(0,t.createRef)();var a,o=s(E1);try{for(o.s();!(a=o.n()).done;){var l=a.value;i._exampleRobotOptions.push({value:l.url,label:l.robot_name})}}catch(x2){o.e(x2)}finally{o.f()}return i}return(0,l.Z)(r,[{key:"currScene",value:function(){return this.props.robotSceneManager.currRobotScene(!1)}},{key:"assureRobotScene",value:function(){return this.props.robotSceneManager.currRobotScene(!1)}},{key:"onLoadURDFURL",value:function(){var e=pr(fr().mark((function e(){var t,n,r;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(document.querySelectorAll(".LoadRobotMessage").forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)})),!(t=this._urdfURLInput.current)){e.next=13;break}if(!((n=t.value).length>0)){e.next=12;break}return e.next=8,this.currScene().loadRobotFromURL(n);case 8:r=e.sent,this.autoBindNewRobotwithAnimation(r),e.next=13;break;case 12:lr.error("Failed to load the URDF file: The URL for the URDF file was empty.");case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onUploadJsonScene",value:function(e){var t=e.currentTarget.files;t&&this.currScene().loadJsonFromLocalFile(t[0])}},{key:"onAddGroup",value:function(){this.props.animationManager.addStoredAnimation(new Hb)}},{key:"deleteAnimationAssociatedwithRobot",value:function(e,t){for(var n=cr(e.animations()),r=0;r<n.length;r++)t===n[r].robot()&&(console.log("remove animations!!!!"),e.removeAnimation(n[r]))}},{key:"autoBindNewRobotwithAnimation",value:function(e){0===this.props.animationManager.animationGroups.length&&this.onAddGroup();var t,n=s(Ib(this.props.animationManager.animationGroups()));try{for(n.s();!(t=n.n()).done;){var r,i=vr(t.value,2),a=(i[0],i[1]),o=s(this.props.robotSceneManager.animationTables());try{for(o.s();!(r=o.n()).done;){var u=r.value;u.robotNames().has(e.name())&&(a.addAnimation(new jb(e,u)),-1===this.props.animationManager.activeAnimations().indexOf(a)&&this.props.animationManager.addActiveAnimation(a))}}catch(x2){o.e(x2)}finally{o.f()}}}catch(x2){n.e(x2)}finally{n.f()}}},{key:"autoBindNewAnimationtoRobot",value:function(e){var t,n=e.robotNames(),r=new Set,i="",a=s(n);try{for(a.s();!(t=a.n()).done;){var o=t.value;r.add(o)}}catch(x2){a.e(x2)}finally{a.f()}var u,l=s(this.currScene().robots());try{for(l.s();!(u=l.n()).done;){var c=u.value;if(n.has(c.name())){r.delete(c.name()),i=i+c.name()+", ",0===this.props.animationManager.animationGroups.length&&this.onAddGroup();var h,f=s(Ib(this.props.animationManager.animationGroups()));try{for(f.s();!(h=f.n()).done;){var d=vr(h.value,2),p=(d[0],d[1]);this.deleteAnimationAssociatedwithRobot(p,c),p.addAnimation(new jb(c,e)),-1===this.props.animationManager.activeAnimations().indexOf(p)&&this.props.animationManager.addActiveAnimation(p)}}catch(x2){f.e(x2)}finally{f.f()}}}}catch(x2){l.e(x2)}finally{l.f()}var v=document.querySelector(".LoadAndSavePanel"),m=null===v||void 0===v?void 0:v.querySelector(".LoadCSV");if(i.length>0){var g="Successfully bind "+i,y=document.createElement("p");y.innerText=g,y.classList.add("LoadCSVMessage"),null===m||void 0===m||m.appendChild(y)}if(r.size>0){var b,_="",x=s(r);try{for(x.s();!(b=x.n()).done;){_=_+b.value+", "}}catch(x2){x.e(x2)}finally{x.f()}var w="Cannot find robot "+_,S=document.createElement("p");S.innerText=w,S.style.color="red",S.classList.add("LoadCSVMessage"),null===m||void 0===m||m.appendChild(S)}}},{key:"onLoadAnimationCSV",value:function(){var e=pr(fr().mark((function e(){var t,n,r,i,a;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(document.querySelectorAll(".LoadCSVMessage").forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)})),!(t=this._animationCsvUrlInput.current)){e.next=15;break}if(!((n=t.value).length>0)){e.next=14;break}return e.t0=s,e.next=9,FR.loadFromURL(n,"LoadCSV");case 9:e.t1=e.sent,r=(0,e.t0)(e.t1);try{for(r.s();!(i=r.n()).done;)a=i.value,this.props.robotSceneManager.addAnimationTable(a),this.autoBindNewAnimationtoRobot(a)}catch(x2){r.e(x2)}finally{r.f()}e.next=15;break;case 14:lr.error("Failed to load the animation CSV file: The URL for the animation CSV file was empty!");case 15:this.props.robotSceneManager.activateRobotScene(this.currScene());case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onUploadAnimationCSV",value:function(){var e=pr(fr().mark((function e(t){var n,r,i,a,o,u,l;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(document.querySelectorAll(".LoadCSVMessage").forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)})),!(n=t.currentTarget.files)){e.next=25;break}r=s(n),e.prev=5,r.s();case 7:if((i=r.n()).done){e.next=17;break}return a=i.value,e.t0=s,e.next=12,FR.loadFromLocalFile(a,"LoadCSV");case 12:e.t1=e.sent,o=(0,e.t0)(e.t1);try{for(o.s();!(u=o.n()).done;)l=u.value,this.props.robotSceneManager.addAnimationTable(l),this.autoBindNewAnimationtoRobot(l)}catch(x2){o.e(x2)}finally{o.f()}case 15:e.next=7;break;case 17:e.next=22;break;case 19:e.prev=19,e.t2=e.catch(5),r.e(e.t2);case 22:return e.prev=22,r.f(),e.finish(22);case 25:this.props.robotSceneManager.activateRobotScene(this.currScene());case 26:case"end":return e.stop()}}),e,this,[[5,19,22,25]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onUploadSession",value:function(){var e=pr(fr().mark((function e(t){var n,r,i,a;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.currentTarget.files){r=s(n);try{for(r.s();!(i=r.n()).done;)a=i.value,this.props.robotSceneManager.loadSessionFromLocalFile(a,this.props.onRestoreLayout)}catch(x2){r.e(x2)}finally{r.f()}}case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onSaveSession",value:function(){var e=pr(fr().mark((function e(){var t;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=this.props.robotSceneManager.saveSession()).layout=this.props.onSaveLayout(),zP(t,"session.json");case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onLoadSession",value:function(){var e=pr(fr().mark((function e(){var t,n;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=this._importSceneURLInput.current)&&((n=t.value).length>0?this.props.robotSceneManager.loadSessionFromURL(n,this.props.onRestoreLayout):lr.error("Failed to load the sessions: The URL for the sessions was empty."));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onSelectExampleRobot",value:function(){var e=pr(fr().mark((function e(){var t,n,r;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:document.querySelectorAll(".LoadRobotMessage").forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)})),(t=this.dropdownRef.current)&&t.props&&t.props.value&&(n=t.props.value.label,"EETarget"===(r=t.props.value.value)?this.currScene().addEETarget():r.length>0?this.currScene().loadRobotFromURL(r,n):lr.error("Failed to load the URDF file: The URL for the URDF file was empty."));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onSaveLayout",value:function(){var e=this.props.onSaveLayout(),t=JSON.stringify(e),n=JSON.parse(t);console.log(n),void 0!==n&&this.setState({savedLayout:n})}},{key:"render",value:function(){return(0,rr.jsxs)("div",{className:"LoadAndSavePanel",children:[(0,rr.jsxs)("div",{className:"PopUpGroup",children:[(0,rr.jsx)("h3",{children:(0,rr.jsxs)("label",{children:[" ",(0,rr.jsx)("b",{children:"  Load and save workspace and motion data "}),"  "]})}),(0,rr.jsx)("button",{id:"open-popup",className:"OpenPop",onClick:function(){return lr.setPopupHelpPage(Xn.LoadAndSavePanel)},children:(0,rr.jsx)(qn,{className:"Icon",icon:$n})})]}),(0,rr.jsx)("br",{}),(0,rr.jsxs)("div",{className:"Workspace",children:[(0,rr.jsx)("div",{className:"LS-label",children:(0,rr.jsxs)("label",{children:[" ",(0,rr.jsx)("b",{children:" Workspace "}),"  "]})}),(0,rr.jsx)("div",{className:"LS-container1",id:"UploadSession",children:(0,rr.jsx)($W,{label:"Upload: ",accept:[".json"],vertical:!1,onChange:this.onUploadSession})}),(0,rr.jsxs)("div",{className:"LS-container1",children:[(0,rr.jsx)("label",{children:" Load from a url: "}),(0,rr.jsx)("input",{ref:this._importSceneURLInput,type:"text",placeholder:" URL"}),(0,rr.jsx)("label",{children:" "}),(0,rr.jsx)("input",{type:"button",value:"Load",onClick:this.onLoadSession})]}),(0,rr.jsxs)("div",{className:"LS-container1",children:[(0,rr.jsx)("label",{children:" Download current workspace: "}),(0,rr.jsx)("input",{type:"button",value:"Download",onClick:this.onSaveSession})]})]}),(0,rr.jsx)("br",{}),(0,rr.jsxs)("div",{className:"MotionLoader",children:[(0,rr.jsx)("div",{className:"LS-label",children:(0,rr.jsxs)("label",{children:[" ",(0,rr.jsx)("b",{children:"  Motion "}),"  "]})}),(0,rr.jsxs)("div",{className:"LoadRobot",children:[(0,rr.jsxs)("label",{children:[" ",(0,rr.jsx)("b",{children:" Step 1: Load a robot URDF/object mesh: "}),"  "]}),(0,rr.jsx)("br",{}),(0,rr.jsxs)("div",{className:"Select",children:[(0,rr.jsx)("label",{children:"Example robot "}),(0,rr.jsx)("div",{className:"Select-container",children:(0,rr.jsx)(XY,{placeholder:"Select a robot ...",options:this._exampleRobotOptions,ref:this.dropdownRef,isSearchable:!0,styles:k1})}),(0,rr.jsx)("label",{children:"  "}),(0,rr.jsx)("input",{type:"button",value:"Confirm",onClick:this.onSelectExampleRobot})]}),(0,rr.jsxs)("div",{className:"LS-container1",children:[(0,rr.jsx)("label",{children:"Load online URDF: "}),(0,rr.jsx)("input",{ref:this._urdfURLInput,type:"text",placeholder:" URL "}),(0,rr.jsx)("label",{children:"  "}),(0,rr.jsx)("input",{type:"button",value:"Load",onClick:this.onLoadURDFURL})]})]}),(0,rr.jsxs)("div",{className:"LoadCSV",children:[(0,rr.jsxs)("label",{children:[" ",(0,rr.jsx)("b",{children:" Step 2: Load motion data (CSV): "}),"  "]}),(0,rr.jsx)("br",{}),(0,rr.jsx)("div",{className:"LS-container1",children:(0,rr.jsx)($W,{label:"Upload:  ",accept:[".csv"],vertical:!1,onChange:this.onUploadAnimationCSV})}),(0,rr.jsxs)("div",{className:"LS-container1",children:[(0,rr.jsx)("label",{children:"Load from a url: "}),(0,rr.jsx)("input",{ref:this._animationCsvUrlInput,type:"text",placeholder:" URL "}),(0,rr.jsx)("label",{children:"  "}),(0,rr.jsx)("input",{type:"button",value:"Load",onClick:this.onLoadAnimationCSV})]})]})]})]})}}]),r}(t.Component),A1=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};(0,u.Z)(this,e),this._canvas=void 0,this._camera=void 0,this._preprocess=void 0,this._postprocess=void 0,this._canvas=t,this._camera=n,this._preprocess=r,this._postprocess=i}return(0,l.Z)(e,[{key:"canvas",value:function(){return this._canvas}},{key:"camera",value:function(){return this._camera}},{key:"preprocess",value:function(){this._preprocess(this._canvas)}},{key:"postprocess",value:function(){this._postprocess(this._canvas)}}]),e}(),R1={type:"change"},P1={type:"start"},L1={type:"end"},D1=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e,r){var i;(0,u.Z)(this,n),i=t.call(this),void 0===r&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),r===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),i.object=e,i.domElement=r,i.domElement.style.touchAction="none",i.enabled=!0,i.target=new Ns,i.minDistance=0,i.maxDistance=1/0,i.minZoom=0,i.maxZoom=1/0,i.minPolarAngle=0,i.maxPolarAngle=Math.PI,i.minAzimuthAngle=-1/0,i.maxAzimuthAngle=1/0,i.enableDamping=!1,i.dampingFactor=.05,i.enableZoom=!0,i.zoomSpeed=1,i.enableRotate=!0,i.rotateSpeed=1,i.enablePan=!0,i.panSpeed=1,i.screenSpacePanning=!0,i.keyPanSpeed=7,i.autoRotate=!1,i.autoRotateSpeed=2,i.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},i.mouseButtons={LEFT:Tr.ROTATE,MIDDLE:Tr.DOLLY,RIGHT:Tr.PAN},i.touches={ONE:Er.ROTATE,TWO:Er.DOLLY_PAN},i.target0=i.target.clone(),i.position0=i.object.position.clone(),i.zoom0=i.object.zoom,i._domElementKeyEvents=null,i.getPolarAngle=function(){return h.phi},i.getAzimuthalAngle=function(){return h.theta},i.getDistance=function(){return this.object.position.distanceTo(this.target)},i.listenToKeyEvents=function(e){e.addEventListener("keydown",X),this._domElementKeyEvents=e},i.saveState=function(){a.target0.copy(a.target),a.position0.copy(a.object.position),a.zoom0=a.object.zoom},i.reset=function(){a.target.copy(a.target0),a.object.position.copy(a.position0),a.object.zoom=a.zoom0,a.object.updateProjectionMatrix(),a.dispatchEvent(R1),a.update(),s=o.NONE},i.update=function(){var t=new Ns,n=(new Ds).setFromUnitVectors(e.up,new Ns(0,1,0)),r=n.clone().invert(),i=new Ns,u=new Ds,c=2*Math.PI;return function(){var e=a.object.position;t.copy(e).sub(a.target),t.applyQuaternion(n),h.setFromVector3(t),a.autoRotate&&s===o.NONE&&C(2*Math.PI/60/60*a.autoRotateSpeed),a.enableDamping?(h.theta+=f.theta*a.dampingFactor,h.phi+=f.phi*a.dampingFactor):(h.theta+=f.theta,h.phi+=f.phi);var m=a.minAzimuthAngle,g=a.maxAzimuthAngle;return isFinite(m)&&isFinite(g)&&(m<-Math.PI?m+=c:m>Math.PI&&(m-=c),g<-Math.PI?g+=c:g>Math.PI&&(g-=c),h.theta=m<=g?Math.max(m,Math.min(g,h.theta)):h.theta>(m+g)/2?Math.max(m,h.theta):Math.min(g,h.theta)),h.phi=Math.max(a.minPolarAngle,Math.min(a.maxPolarAngle,h.phi)),h.makeSafe(),h.radius*=d,h.radius=Math.max(a.minDistance,Math.min(a.maxDistance,h.radius)),!0===a.enableDamping?a.target.addScaledVector(p,a.dampingFactor):a.target.add(p),t.setFromSpherical(h),t.applyQuaternion(r),e.copy(a.target).add(t),a.object.lookAt(a.target),!0===a.enableDamping?(f.theta*=1-a.dampingFactor,f.phi*=1-a.dampingFactor,p.multiplyScalar(1-a.dampingFactor)):(f.set(0,0,0),p.set(0,0,0)),d=1,!!(v||i.distanceToSquared(a.object.position)>l||8*(1-u.dot(a.object.quaternion))>l)&&(a.dispatchEvent(R1),i.copy(a.object.position),u.copy(a.object.quaternion),v=!1,!0)}}(),i.dispose=function(){a.domElement.removeEventListener("contextmenu",Y),a.domElement.removeEventListener("pointerdown",j),a.domElement.removeEventListener("pointercancel",Z),a.domElement.removeEventListener("wheel",q),a.domElement.removeEventListener("pointermove",H),a.domElement.removeEventListener("pointerup",W),null!==a._domElementKeyEvents&&a._domElementKeyEvents.removeEventListener("keydown",X)};var a=(0,c.Z)(i),o={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},s=o.NONE,l=1e-6,h=new Ig,f=new Ig,d=1,p=new Ns,v=!1,m=new gs,g=new gs,y=new gs,b=new gs,_=new gs,x=new gs,w=new gs,S=new gs,M=new gs,k=[],T={};function E(){return Math.pow(.95,a.zoomSpeed)}function C(e){f.theta-=e}function A(e){f.phi-=e}var R=function(){var e=new Ns;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),p.add(e)}}(),P=function(){var e=new Ns;return function(t,n){!0===a.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(a.object.up,e)),e.multiplyScalar(t),p.add(e)}}(),L=function(){var e=new Ns;return function(t,n){var r=a.domElement;if(a.object.isPerspectiveCamera){var i=a.object.position;e.copy(i).sub(a.target);var o=e.length();o*=Math.tan(a.object.fov/2*Math.PI/180),R(2*t*o/r.clientHeight,a.object.matrix),P(2*n*o/r.clientHeight,a.object.matrix)}else a.object.isOrthographicCamera?(R(t*(a.object.right-a.object.left)/a.object.zoom/r.clientWidth,a.object.matrix),P(n*(a.object.top-a.object.bottom)/a.object.zoom/r.clientHeight,a.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),a.enablePan=!1)}}();function D(e){a.object.isPerspectiveCamera?d/=e:a.object.isOrthographicCamera?(a.object.zoom=Math.max(a.minZoom,Math.min(a.maxZoom,a.object.zoom*e)),a.object.updateProjectionMatrix(),v=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),a.enableZoom=!1)}function N(e){a.object.isPerspectiveCamera?d*=e:a.object.isOrthographicCamera?(a.object.zoom=Math.max(a.minZoom,Math.min(a.maxZoom,a.object.zoom/e)),a.object.updateProjectionMatrix(),v=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),a.enableZoom=!1)}function I(e){m.set(e.clientX,e.clientY)}function O(e){b.set(e.clientX,e.clientY)}function U(){if(1===k.length)m.set(k[0].pageX,k[0].pageY);else{var e=.5*(k[0].pageX+k[1].pageX),t=.5*(k[0].pageY+k[1].pageY);m.set(e,t)}}function F(){if(1===k.length)b.set(k[0].pageX,k[0].pageY);else{var e=.5*(k[0].pageX+k[1].pageX),t=.5*(k[0].pageY+k[1].pageY);b.set(e,t)}}function z(){var e=k[0].pageX-k[1].pageX,t=k[0].pageY-k[1].pageY,n=Math.sqrt(e*e+t*t);w.set(0,n)}function B(e){if(1==k.length)g.set(e.pageX,e.pageY);else{var t=Q(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);g.set(n,r)}y.subVectors(g,m).multiplyScalar(a.rotateSpeed);var i=a.domElement;C(2*Math.PI*y.x/i.clientHeight),A(2*Math.PI*y.y/i.clientHeight),m.copy(g)}function V(e){if(1===k.length)_.set(e.pageX,e.pageY);else{var t=Q(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);_.set(n,r)}x.subVectors(_,b).multiplyScalar(a.panSpeed),L(x.x,x.y),b.copy(_)}function G(e){var t=Q(e),n=e.pageX-t.x,r=e.pageY-t.y,i=Math.sqrt(n*n+r*r);S.set(0,i),M.set(0,Math.pow(S.y/w.y,a.zoomSpeed)),D(M.y),w.copy(S)}function j(e){!1!==a.enabled&&(0===k.length&&(a.domElement.setPointerCapture(e.pointerId),a.domElement.addEventListener("pointermove",H),a.domElement.addEventListener("pointerup",W)),function(e){k.push(e)}(e),"touch"===e.pointerType?function(e){switch(J(e),k.length){case 1:switch(a.touches.ONE){case Er.ROTATE:if(!1===a.enableRotate)return;U(),s=o.TOUCH_ROTATE;break;case Er.PAN:if(!1===a.enablePan)return;F(),s=o.TOUCH_PAN;break;default:s=o.NONE}break;case 2:switch(a.touches.TWO){case Er.DOLLY_PAN:if(!1===a.enableZoom&&!1===a.enablePan)return;a.enableZoom&&z(),a.enablePan&&F(),s=o.TOUCH_DOLLY_PAN;break;case Er.DOLLY_ROTATE:if(!1===a.enableZoom&&!1===a.enableRotate)return;a.enableZoom&&z(),a.enableRotate&&U(),s=o.TOUCH_DOLLY_ROTATE;break;default:s=o.NONE}break;default:s=o.NONE}s!==o.NONE&&a.dispatchEvent(P1)}(e):function(e){var t;switch(e.button){case 0:t=a.mouseButtons.LEFT;break;case 1:t=a.mouseButtons.MIDDLE;break;case 2:t=a.mouseButtons.RIGHT;break;default:t=-1}switch(t){case Tr.DOLLY:if(!1===a.enableZoom)return;!function(e){w.set(e.clientX,e.clientY)}(e),s=o.DOLLY;break;case Tr.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===a.enablePan)return;O(e),s=o.PAN}else{if(!1===a.enableRotate)return;I(e),s=o.ROTATE}break;case Tr.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===a.enableRotate)return;I(e),s=o.ROTATE}else{if(!1===a.enablePan)return;O(e),s=o.PAN}break;default:s=o.NONE}s!==o.NONE&&a.dispatchEvent(P1)}(e))}function H(e){!1!==a.enabled&&("touch"===e.pointerType?function(e){switch(J(e),s){case o.TOUCH_ROTATE:if(!1===a.enableRotate)return;B(e),a.update();break;case o.TOUCH_PAN:if(!1===a.enablePan)return;V(e),a.update();break;case o.TOUCH_DOLLY_PAN:if(!1===a.enableZoom&&!1===a.enablePan)return;!function(e){a.enableZoom&&G(e),a.enablePan&&V(e)}(e),a.update();break;case o.TOUCH_DOLLY_ROTATE:if(!1===a.enableZoom&&!1===a.enableRotate)return;!function(e){a.enableZoom&&G(e),a.enableRotate&&B(e)}(e),a.update();break;default:s=o.NONE}}(e):function(e){if(!1===a.enabled)return;switch(s){case o.ROTATE:if(!1===a.enableRotate)return;!function(e){g.set(e.clientX,e.clientY),y.subVectors(g,m).multiplyScalar(a.rotateSpeed);var t=a.domElement;C(2*Math.PI*y.x/t.clientHeight),A(2*Math.PI*y.y/t.clientHeight),m.copy(g),a.update()}(e);break;case o.DOLLY:if(!1===a.enableZoom)return;!function(e){S.set(e.clientX,e.clientY),M.subVectors(S,w),M.y>0?D(E()):M.y<0&&N(E()),w.copy(S),a.update()}(e);break;case o.PAN:if(!1===a.enablePan)return;!function(e){_.set(e.clientX,e.clientY),x.subVectors(_,b).multiplyScalar(a.panSpeed),L(x.x,x.y),b.copy(_),a.update()}(e)}}(e))}function W(e){K(e),0===k.length&&(a.domElement.releasePointerCapture(e.pointerId),a.domElement.removeEventListener("pointermove",H),a.domElement.removeEventListener("pointerup",W)),a.dispatchEvent(L1),s=o.NONE}function Z(e){K(e)}function q(e){!1!==a.enabled&&!1!==a.enableZoom&&s===o.NONE&&(e.preventDefault(),a.dispatchEvent(P1),function(e){e.deltaY<0?N(E()):e.deltaY>0&&D(E()),a.update()}(e),a.dispatchEvent(L1))}function X(e){!1!==a.enabled&&!1!==a.enablePan&&function(e){var t=!1;switch(e.code){case a.keys.UP:L(0,a.keyPanSpeed),t=!0;break;case a.keys.BOTTOM:L(0,-a.keyPanSpeed),t=!0;break;case a.keys.LEFT:L(a.keyPanSpeed,0),t=!0;break;case a.keys.RIGHT:L(-a.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),a.update())}(e)}function Y(e){!1!==a.enabled&&e.preventDefault()}function K(e){delete T[e.pointerId];for(var t=0;t<k.length;t++)if(k[t].pointerId==e.pointerId)return void k.splice(t,1)}function J(e){var t=T[e.pointerId];void 0===t&&(t=new gs,T[e.pointerId]=t),t.set(e.pageX,e.pageY)}function Q(e){var t=e.pointerId===k[0].pointerId?k[1]:k[0];return T[t.pointerId]}return a.domElement.addEventListener("contextmenu",Y),a.domElement.addEventListener("pointerdown",j),a.domElement.addEventListener("pointercancel",Z),a.domElement.addEventListener("wheel",q,{passive:!1}),i.update(),i}return(0,l.Z)(n)}(rs);var N1=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var i;return(0,u.Z)(this,r),(i=n.call(this,e))._orbitView=void 0,i._orbitCamera=void 0,i._perspecCamera=void 0,i._orthoCamera=void 0,i._controls=void 0,i._canvasRef=void 0,i._resize_observer=void 0,i._raycaster=void 0,i._pointer=void 0,i._syncViewCallback=void 0,i._perspecCamera=new cb.PerspectiveCamera(50,window.innerWidth/window.innerHeight,.001,1e3),i._perspecCamera.position.set(3,3,3),i._perspecCamera.lookAt(0,0,0),i._perspecCamera.up.set(0,0,1),i._orthoCamera=new cb.OrthographicCamera(window.innerWidth/-500,window.innerWidth/500,window.innerHeight/500,window.innerHeight/-500,.001,1e3),i._orthoCamera.position.set(3,3,3),i._orthoCamera.lookAt(0,0,0),i._orthoCamera.up.set(0,0,1),i._orbitCamera=i._perspecCamera,i._controls=void 0,i._raycaster=new cb.Raycaster,i.onCanvasMouseDown=i.onCanvasMouseDown.bind((0,c.Z)(i)),i.onCanvasMouseMove=i.onCanvasMouseMove.bind((0,c.Z)(i)),i.onCanvasMouseOut=i.onCanvasMouseOut.bind((0,c.Z)(i)),i._pointer=new cb.Mesh(new cb.SphereGeometry(.01,30,30),new cb.MeshBasicMaterial({transparent:!0,opacity:.75,color:new cb.Color(16777215*Math.random())})),i._canvasRef=t.createRef(),i.initScene(i.props.robotScene),i}return(0,l.Z)(r,[{key:"canSelectRobot",value:function(){var e;return null!==(e=this.props.allowSelecting)&&void 0!==e&&e&&this.props.robotSceneManager.allowRobotSelection()}},{key:"addPointer",value:function(e,t){if(this.props.allowSelecting){var n=e.scene();-1===n.children.indexOf(this._pointer)&&n.add(this._pointer),this._pointer.position.copy(t),e.render()}}},{key:"removePointer",value:function(e){var t=e.scene();-1!==t.children.indexOf(this._pointer)&&(t.remove(this._pointer),e.render())}},{key:"initScene",value:function(e){e.runOnce(sr.INIT,(function(){e.scene().background=new cb.Color(e.backgroundColor()),e.scene().position.set(0,0,0);var t=16777215,n=new cb.DirectionalLight(t,e.directionalLightIntensity());n.castShadow=!0,n.shadow.mapSize.setScalar(1024),n.position.set(5,5,30),n.shadow.bias=-5e-4,n.lookAt(0,0,0),e.scene().add(n),e.setDirectionalLight(n);var r=new cb.AmbientLight(t,e.ambientLightIntensity());e.scene().add(r),e.setAmbientLight(r);var i=new cb.Mesh(new cb.PlaneBufferGeometry,new cb.ShadowMaterial({opacity:.25}));i.scale.setScalar(30),i.receiveShadow=!0,i.visible=e.isGroundPlaneVisible(),e.scene().add(i),e.setGroundPlane(i)}))}},{key:"onCanvasMouseOut",value:function(){this.props.robotSceneManager.allowRobotSelection()&&this.removePointer(this.props.robotScene)}},{key:"onCanvasMouseMove",value:function(e){if(this._canvasRef.current){var t=new cb.Vector2,n=e.target;if(n){var r=n,i=e.clientX-(e.clientX-e.offsetX),a=e.clientY-(e.clientY-e.offsetY);t.x=i/r.clientWidth*2-1,t.y=-a/r.clientHeight*2+1}var o,u=this.props.robotScene.robots(),l=[],c=new Map,h=s(u);try{for(h.s();!(o=h.n()).done;){var f=o.value;if(f.visible()){var d,p=s(f.meshes());try{for(p.s();!(d=p.n()).done;){var v=d.value;v.visible&&(c.set(v,f),l.push(v))}}catch(x2){p.e(x2)}finally{p.f()}}}}catch(x2){h.e(x2)}finally{h.f()}this._raycaster.setFromCamera(t,this._orbitCamera);var m=this._raycaster.intersectObjects(l);if(m.length>0){var g=m[0],y=c.get(g.object);y?this.canSelectRobot()&&this.props.robotScene.setHoveredRobot(y):(console.error("Intersected object was not a robot!"),this.props.robotScene.setHoveredRobot(void 0)),this.addPointer(this.props.robotScene,g.point)}else this.props.robotScene.setHoveredRobot(void 0),this.removePointer(this.props.robotScene)}}},{key:"onCanvasMouseDown",value:function(){var e,t=document.querySelectorAll(".RobotCanvasCanvas");if(t.forEach((function(e){return e.classList.remove("selected")})),(t=document.querySelectorAll(".GraphPanel")).forEach((function(e){return e.classList.remove("selected")})),null===(e=this._canvasRef.current)||void 0===e||e.classList.add("selected"),this.canSelectRobot()){var n,r=this.props.robotSceneManager,i=this.props.robotScene,a=s(r.allManagedRobotScenes());try{for(a.s();!(n=a.n()).done;){n.value.setSelectedRobot(void 0)}}catch(x2){a.e(x2)}finally{a.f()}i.setSelectedRobot(i.hoveredRobot()),r.setCurrRobotScene(i),void 0===i.hoveredRobot()?void 0!==this.props.setSceneOptionPanelActive&&this.props.setSceneOptionPanelActive():void 0!==this.props.setRobotOptionPanelActive&&this.props.setRobotOptionPanelActive();var o,u=s(r.allManagedRobotScenes());try{for(u.s();!(o=u.n()).done;){var l=o.value;l!==i&&l.setHoveredRobot(void 0)}}catch(x2){u.e(x2)}finally{u.f()}}}},{key:"updateOrbitControls",value:function(e,t){var n=this;void 0===this._controls||this._controls.dispose(),this._controls=new D1(this._orbitCamera,t);var r=this._controls.update.bind(this._controls);this._controls.update=function(){var t=r();return n.props.robotSceneManager.setCurrSyncViewpoint([n._orbitCamera.getWorldPosition(new cb.Vector3),(new cb.Quaternion).setFromEuler(n._orbitCamera.rotation)]),e.render(),t},this._controls.target.y=0,this._controls.enableDamping=!0,this._controls.dampingFactor=.5,this._controls.rotateSpeed=.5,this._controls.update()}},{key:"mount",value:function(e,t){var n=this;t&&(this.initScene(e),this.updateOrbitControls(e,t),this._syncViewCallback&&(this.props.robotSceneManager.removeSyncViewCallback(this._syncViewCallback),this._syncViewCallback=void 0),this._syncViewCallback=function(e){var t=vr(e,2),r=t[0],i=t[1];n._orbitCamera.position.copy(r),n._orbitCamera.rotation.setFromQuaternion(i),n.props.robotScene.render()},this.props.robotSceneManager.addSyncViewCallback(this._syncViewCallback),this._orbitView=new A1(t,this._orbitCamera,(function(e){var t=Math.floor(e.clientWidth),n=Math.floor(e.clientHeight);e.width===t&&e.height===n||(e.width=t,e.height=n)})),e.addView(this._orbitView),e.render(),t.addEventListener("mouseout",this.onCanvasMouseOut),t.addEventListener("mousemove",this.onCanvasMouseMove),t.addEventListener("click",this.onCanvasMouseDown),this._resize_observer&&this._resize_observer.unobserve(t),this._resize_observer=new ResizeObserver((function(){n.props.robotScene.render()})),this._resize_observer.observe(t))}},{key:"unmount",value:function(e,t){var n;(this._syncViewCallback&&(this.props.robotSceneManager.removeSyncViewCallback(this._syncViewCallback),this._syncViewCallback=void 0),this._controls&&(this._controls.dispose(),this._controls=void 0),this._orbitView&&(e.removeView(this._orbitView),this._orbitView=void 0),t)&&(t.removeEventListener("mouseout",this.onCanvasMouseOut),t.removeEventListener("mousemove",this.onCanvasMouseMove),t.removeEventListener("click",this.onCanvasMouseDown),null===(n=this._resize_observer)||void 0===n||n.unobserve(t));this.removePointer(e)}},{key:"componentDidUpdate",value:function(e){e.robotScene!==this.props.robotScene&&(this.unmount(e.robotScene,this._canvasRef.current),this.mount(this.props.robotScene,this._canvasRef.current)),this.props.robotScene.isToggleWorldFrame()&&("ROS"===this.props.robotScene.worldFrame()?this._orbitCamera.up.set(0,0,1):this._orbitCamera.up.set(0,1,0),this.unmount(e.robotScene,this._canvasRef.current),this.mount(this.props.robotScene,this._canvasRef.current),this.props.robotScene.finishToggleWorldFrame()),this.props.robotScene.isToggleCamera()&&("Orthographic"===this.props.robotScene.cameraType()?this._orbitCamera=this._orthoCamera:this._orbitCamera=this._perspecCamera,this.unmount(e.robotScene,this._canvasRef.current),this.mount(this.props.robotScene,this._canvasRef.current),this.props.robotScene.finishToggleCamera())}},{key:"componentDidMount",value:function(){var e,t=document.querySelectorAll(".RobotCanvasCanvas");t.forEach((function(e){return e.classList.remove("selected")})),(t=document.querySelectorAll(".GraphPanel")).forEach((function(e){return e.classList.remove("selected")})),null===(e=this._canvasRef.current)||void 0===e||e.classList.add("selected"),this.mount(this.props.robotScene,this._canvasRef.current)}},{key:"componentWillUnmount",value:function(){this.unmount(this.props.robotScene,this._canvasRef.current)}},{key:"decomposeId",value:function(e){var t=vr(e.split("&"),2),n=t[0],r=t[1],i=vr(n.split("#"),2);return[i[0],i[1],r]}},{key:"dragOverHandler",value:function(e){e.preventDefault()}},{key:"dropHandler",value:function(e){e.preventDefault();var t=e.dataTransfer.getData("text/plain"),n=vr(this.decomposeId(t),3),r=n[0],i=n[1],a=n[2],o=this.props.robotSceneManager.robotSceneById(r);if(void 0!==o){var s=o.getRobotByName(i);if(void 0!==s){var u=this.props.robotScene;if(void 0!==a){var l=s.jointMap().get(a);void 0===l&&(l=s.linkMap().get(a)),u===o?u.hasChildTrace(s,l)||u.addChildTrace(s,YU.frameRange(this.props.robotSceneManager.startTime(),this.props.robotSceneManager.endTime()),l):u.hasReceivedGhostTrace(s,l)||o.sendGhostTracesTo(s,YU.frameRange(this.props.robotSceneManager.startTime(),this.props.robotSceneManager.endTime()),l,u)}else{if(s.controlledCloneInScene(u));else s.addControlledClone(u).setOpacity(.5),u.render()}}}}},{key:"render",value:function(){return(0,rr.jsx)("div",{className:"RobotCanvas",onDrop:this.dropHandler.bind(this),onDragOver:this.dragOverHandler.bind(this),children:(0,rr.jsx)("canvas",{className:"RobotCanvasCanvas",ref:this._canvasRef})})}}]),r}(t.Component),I1=Vb(5e3),O1=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var i;(0,u.Z)(this,r),(i=n.call(this,e))._graphDiv=void 0,i.prevTimes=void 0,i.prevVals=void 0,i._graphDiv=(0,t.createRef)(),i.drawGraph.bind((0,c.Z)(i));var a=i.props;a.width,a.height;return i.state={prev_x:null,prev_y:null,margin:{top:20,right:10,bottom:40,left:60},prev_lines:new Map,time_min:-999,time_max:-999,val_concat:[],newCurr:i.props.currTime,mouseXCoord:-1,originalMouseXCoord:-1,currDragItem:null},i.prevTimes=i.props.times,i.prevVals=i.props.vals,i}return(0,l.Z)(r,[{key:"componentDidMount",value:function(){this._graphDiv.current&&this._graphDiv.current.children.length>0&&this._graphDiv.current.removeChild(this._graphDiv.current.children[0]);var e=this.props,t=e.height,n=e.width,r=this.drawGraph(!0,!0);r&&pO(this._graphDiv.current).append("svg").attr("width",n).attr("height",t).node().appendChild(r)}},{key:"componentDidUpdate",value:function(e){var t=e.startTime!==this.props.startTime||e.endTime!==this.props.endTime,n=e.lineWidth!==this.props.lineWidth,r=e.axisColor!==this.props.axisColor,i=!Zb().isEqual(new Set(e.line_colors),new Set(this.props.line_colors))&&e.line_colors.length===this.props.line_colors.length,a=e.height!==this.props.height||e.width!==this.props.width;if(e.times!==this.props.times||e.vals!==this.props.vals||a||i||t||n||r){this._graphDiv.current&&this._graphDiv.current.children.length>0&&this._graphDiv.current.removeChild(this._graphDiv.current.children[0]);var o=this.props,s=o.width,u=o.height,l=this.drawGraph(t,i,a,n);l&&pO(this._graphDiv.current).append("svg").attr("width",s).attr("height",u).node().appendChild(l)}}},{key:"filterData",value:function(e,t){var n=[],r=[],i=this.props,a=i.times,o=i.vals;if(0===a.length||0===o.length)return[[[0,8]],[[0,8]]];for(var s=0,u=a[0].length-1,l=0;l<a[0].length;l++)if(a[0][l]>=e){s=l;break}for(var c=a[0].length-1;c>=0;c--)if(a[0][c]<=t){u=c;break}for(var h=0;h<a.length;h++){var f=0;n[h]=[],r[h]=[];for(var d=s;d<u;d++)n[h][f]=a[h][d],r[h][f]=o[h][d],f++}return[n,r]}},{key:"prevMapChanged",value:function(){var e=this.props.prev_map,t=this.state.prev_lines;if(0===e.size)return!0;var n,r=s(e);try{for(r.s();!(n=r.n()).done;){if(!(vr(n.value,1)[0]in t))return!0}}catch(x2){r.e(x2)}finally{r.f()}return!1}},{key:"dragCurr",value:function(e){var t=this.state,n=t.time_min,i=t.time_max,a=t.margin,o=t.mouseXCoord,s=t.originalMouseXCoord,u=t.currDragItem,l=this.props.width-a.right-a.left,c=e.x;if(c>l&&this.state.mouseXCoord<0)this.setState({mouseXCoord:c,currDragItem:"curr"});else{if(c>l){if("curr"!==u)return;c=c-o+s}var h=r.TimeFromXPosition(l,n,i,c);h<n?h=n:h>i&&(h=i),this.props.onCurrChange(h)}}},{key:"dragStart",value:function(e){var t=this.state,n=t.time_min,i=t.time_max,a=t.margin,o=t.mouseXCoord,s=t.originalMouseXCoord,u=t.currDragItem,l=this.props.width-a.right-a.left,c=e.x;if(e.x<0&&(c=0),c>l&&this.state.mouseXCoord<0)this.setState({mouseXCoord:c,currDragItem:"start"});else{if(c>l){if("start"!==u)return;c=c-o+s}var h=r.TimeFromXPosition(l,n,i,c);h>i?h=i:h<n&&(h=n),this.props.onStartChange(h)}}},{key:"dragEnd",value:function(e){var t=this.state,n=t.time_min,i=t.time_max,a=t.margin,o=t.mouseXCoord,s=t.originalMouseXCoord,u=t.currDragItem,l=this.props.width-a.right-a.left,c=e.x;if(c>l&&this.state.mouseXCoord<0)this.setState({mouseXCoord:c,currDragItem:"end"});else{if(c>l){if("end"!==u)return;c=c-o+s}var h=r.TimeFromXPosition(l,n,i,c);h>i?h=i:h<n&&(h=n),this.props.onEndChange(h)}}},{key:"currMouse",value:function(e){this.setState({originalMouseXCoord:e.x})}},{key:"endMouse",value:function(e){this.setState({mouseXCoord:-1,originalMouseXCoord:-1})}},{key:"createOnClickHandler",value:function(e){var t=this;return function(){t.props.onDeleteChange&&t.props.onDeleteChange(e)}}},{key:"drawGraph",value:function(e,t,n,i){for(var a=this,o=this.props,s=(o.times,o.vals,o.startTime),u=o.endTime,l=o.currTime,c=(o.isZoom,o.isTimeWarp),h=(o.isDiff,o.line_names,o.line_colors),f=o.prev_map,d=o.line_ids,p=o.title,v=o.lineWidth,m=o.axisColor,g=o.onGraphUpdate,y=this.props.width,b=this.props.height,_=this.prevMapChanged(),x=this.state,w=x.margin,S=x.prev_lines,M=x.prev_x,k=x.prev_y,T=y-w.left-w.right,E=b-w.top-w.bottom,C=pO(this._graphDiv.current).append("svg").remove().attr("width",T+w.left+w.right).attr("height",E+w.top+w.bottom).append("g").attr("transform","translate(".concat(w.left,",     ").concat(w.top,")")),A=vr(this.filterData(s,u),2),R=A[0],P=A[1],L=[r.parseData(R[0],P[0])],D=1;D<R.length;D++)L.push(r.parseData(R[D],P[D]));var N,I,O=TO().on("start",(function(e){a.currMouse(e)})).on("drag",(function(e){a.dragCurr(e)})).on("end",(function(e){a.endMouse(e)})),U=r.concatData(R),F=r.concatData(P),z=(r.xPositionFromTime(T,JP(U),KP(U),s),r.xPositionFromTime(T,JP(U),KP(U),l));r.xPositionFromTime(T,JP(U),KP(U),u);C.append("rect").attr("x",z-1).attr("y",0).attr("width",2).attr("height",E).attr("fill","#b00").attr("fill-opacity","75%"),g(!1)||_||e||n||!M||!k||i?(N=CU().range([0,T]).domain(YP(U)),I=CU().range([E,0]).domain(YP(F))):(N=M,I=k);var B,V=sL(N).tickSize(0).tickPadding(10).tickValues(QP(JP(U),KP(U)+(KP(U)-JP(U))/8,(KP(U)-JP(U))/8)),G=uL(I).tickSize(0).tickPadding(10).tickValues(QP(JP(F),KP(F)+(KP(F)-JP(F))/8,(KP(F)-JP(F))/8)),j=C.append("g").attr("transform","translate(0, ".concat(E,")")).classed("GraphAxis",!0).call(V),H=C.append("g").classed("GraphAxis",!0).call(G),W=G.tickSizeInner(-T).tickPadding(10).tickFormat("").tickSizeOuter(0),Z=C.append("g").classed("GraphGrid",!0).call(W);H.select(".domain").attr("stroke-width",0),Z.select(".domain").attr("stroke-width",0),j.selectAll("line, path").style("stroke",m),H.selectAll("line, path").style("stroke",m),Z.selectAll("line, path").style("stroke",m),j.selectAll("text").style("fill",m),H.selectAll("text").style("fill",m);var q=WU().x((function(e){return N(e.times)})).y((function(e){return I(e.vals)}));if(c){if(2===L.length){var X=C.append("path").remove().append("path").data([L[1]]).attr("class","line").attr("fill","none").attr("stroke",h[1]).attr("stroke-width",v).attr("d",q).node();C.node().appendChild(X);var Y=C.append("path").remove().append("path").data([L[0]]).attr("class","line").attr("fill","none").attr("stroke",h[0]).attr("stroke-width",v).attr("d",q).node();C.node().appendChild(Y)}}else for(var K=0;K<L.length;K++)if(B=d[K],-1===f.get(B)||!S.has(B)||e||t||n||g(!1)||i){var J=C.append("path").remove().append("path").data([L[K]]).attr("class","line").attr("fill","none").attr("stroke",h[K]).attr("stroke-width",v).attr("d",q).node();C.node().appendChild(J),S.set(B,J)}else C.node().appendChild(S.get(B));var Q="Time",$=p;return c&&(Q="Base Scene Time",$="Time Warped Scene Time"),C.append("text").attr("class","xLabel").attr("fill",m).attr("text-anchor","middle").attr("x",.5*T).attr("y",E+35).text(Q),C.append("text").attr("class","yLabel").attr("fill",m).attr("text-anchor","middle").attr("y",-45).attr("x",-.5*E).attr("transform","rotate(-90)").text($),C.append("rect").attr("x",z-20).attr("y",0).attr("width",40).attr("height",E).attr("fill","#b00").attr("fill-opacity","0%").call(O),this.setState({prev_lines:S,prev_x:N,prev_y:I,time_min:JP(U),time_max:KP(U)}),g(!0),C.node()}},{key:"render",value:function(){var e=this.props,t=e.isZoom,n=e.isDiff,r=e.isTimeWarp,i=e.times,a=e.title,o=(e.selected,{display:"inline-block",marginBottom:"10px",color:e.axisColor});return(0,rr.jsxs)("div",{children:[t&&!n&&!r&&0!==i.length&&(0,rr.jsx)("p",{style:o,children:"Zoomed-in Pos/Vel/Acc/Jerk Graph"}),!t&&n&&!r&&(0,rr.jsx)("div",{style:{textAlign:"center"},children:(0,rr.jsxs)("p",{style:o,children:[a," Difference Graph"]})}),!t&&!n&&r&&(0,rr.jsxs)("p",{style:o,children:[a," Graph"]}),(0,rr.jsx)("div",{className:"lineGraph",ref:this._graphDiv})]})}}],[{key:"parseData",value:function(e,t){if(void 0==e||void 0==t)return I1("ERROR: undefined arrays!"),[];if(e.length!==t.length)return I1("ERROR: parseData param arrays length discrepancy"),[{times:-99999,vals:0}];for(var n=[],r=0;r<e.length;r++)n.push({times:e[r],vals:t[r]});return n}},{key:"concatData",value:function(e){for(var t=[],n=0;n<e.length;n++)t=t.concat(e[n]);return t}},{key:"xPositionFromTime",value:function(e,t,n,r){return(r-t)/(n-t)*e}},{key:"TimeFromXPosition",value:function(e,t,n,r){var i=r/e*(n-t);return i>n?i=n:i<t&&(i=t),i}}]),r}(t.Component),U1=Vb(5e3),F1=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var i;(0,u.Z)(this,r),(i=n.call(this,e))._panel_resize_observer=void 0,i._graphDiv=void 0,i.times=void 0,i.values=void 0,i.clickHandler=function(e){var t,n=document.querySelectorAll(".RobotCanvasCanvas");n.forEach((function(e){return e.classList.remove("selected")})),(n=document.querySelectorAll(".GraphPanel")).forEach((function(e){return e.classList.remove("selected")})),null===(t=i._graphDiv.current)||void 0===t||t.classList.add("selected"),i.props.graph.setCurrProperty(i.state.currProperty),i.props.robotSceneManager.setCurrGraph(i.props.graph.id()),i.props.setGraphOptionPanelActive()},i.getPositions.bind((0,c.Z)(i)),i.fillGraphData.bind((0,c.Z)(i));var a=i.props.robotSceneManager;return i.state={counter:0,graph_list:new Map,prev_times:{start:a.currStartTime(),end:a.currEndTime(),curr:a.currTime()},use_timeWarp:!1,line_names:[],line_ids:[],color_map:new Map,refresh:!1,currObjects:new Set,currProperty:i.props.graph.currProperty(),currScene:void 0,panelHeight:200,panelWidth:300,is_part_changed:new Map,need_update:!0,graph_update:!1,filter:i.props.graph.filter(),velocity_map:new Map,acceleration_map:new Map},i.times=[],i.values=[],i._graphDiv=(0,t.createRef)(),i}return(0,l.Z)(r,[{key:"getPositions",value:function(e,t,n,r,i,a){var o,s,u=this.props.robotSceneManager,l=u.robotSceneById(e),c=u.startTime(),h=u.endTime(),f=l.timeWarping();if(s=a&&f?f.timeWarpMap()[1]:YU.frameRange(c,h,20,2e3),void 0===n)return[(o=l.frameDataFor(t,s,void 0)).times,this.getNumArr(o.robotPositions,i)];if(n instanceof eP)return console.log("robot link"),[(o=l.frameDataFor(t,s,n)).times,this.getNumArr(o.linkPositions,i)];if(n instanceof $R)return console.log("robot joint"),o=l.frameDataFor(t,s,n),console.log("positions"),console.log(o),r?[o.times,o.jointAngles]:[o.times,this.getNumArr(o.jointPositions,i)];throw new Error("Unknown robot part type")}},{key:"getNumArr",value:function(e,t){var n=[];if("magnitude"===t)for(var r=0;r<e.length;r++){var i=e[r].x,a=e[r].y,o=e[r].z;n.push(Math.sqrt(i*i+a*a+o*o))}else for(var s=0;s<e.length;s++)n.push(e[s][t]);return n}},{key:"isAllJoints",value:function(e,t,n,r){if("x"!==n&&"y"!==n&&"z"!==n&&"angle"!==n&&"magnitude"!==n)return U1("invalid type in isAllJoints"),!1;var i,a=s(e.jointMap());try{for(a.s();!(i=a.n()).done;){var o=vr(i.value,1)[0];if(!t.has(o))return!1;if("angle"===n){if("position"===r&&!t.get(o).angle[0])return!1;if("velocity"===r&&!t.get(o).angle[1])return!1;if("acceleration"===r&&!t.get(o).angle[2])return!1;if("jerk"===r&&!t.get(o).angle[3])return!1}else{if(!("x"!==n&&"y"!==n&&"z"!==n&&"magnitude"!==n||t.get(o).position_type.includes(n)||"position"!==r))return!1;if(!("x"!==n&&"y"!==n&&"z"!==n&&"magnitude"!==n||t.get(o).velocity_type.includes(n)||"velocity"!==r))return!1;if(!("x"!==n&&"y"!==n&&"z"!==n&&"magnitude"!==n||t.get(o).acceleration_type.includes(n)||"acceleration"!==r))return!1;if(("x"===n||"y"===n||"z"===n||"magnitude"===n)&&!t.get(o).jerk_type.includes(n)&&"jerk"===r)return!1}}}catch(x2){a.e(x2)}finally{a.f()}return!0}},{key:"onGraphUpdate",value:function(e){var t=this.state.graph_update;return e?(this.setState({graph_update:!1}),!1):t}},{key:"booleanSum",value:function(e){var t,n=0,r=s(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n+=Number(i)}}catch(x2){r.e(x2)}finally{r.f()}return n}},{key:"isPartChanged",value:function(){var e,t=s(this.state.is_part_changed);try{for(t.s();!(e=t.n()).done;){if(-1===vr(e.value,2)[1])return!0}}catch(x2){t.e(x2)}finally{t.f()}return!1}},{key:"genChangeData",value:function(e,t,n){void 0===n&&(n=this.state.filter);var r=[];r[0]=[],r[1]=[];for(var i=[];n&&n>0&&t.length>1;){i[0]=t[0]/4+t[0]/2+t[1]/4;for(var a=1;a<t.length-1;a++)i[a]=t[a-1]/4+t[a]/2+t[a+1]/4;i[t.length-1]=t[t.length-1]/4+t[t.length-1]/2+t[t.length-2]/4,t=Zb().cloneDeep(i),n--}for(var o=0;o<e.length-1;o++)r[0][o]=e[o],r[1][o]=(t[o+1]-t[o])/(e[o+1]-e[o]);return r[0][e.length-1]=e[e.length-1],r[1][e.length-1]=r[1][e.length-2],r}},{key:"getPositionVector",value:function(e,t,n,r){var i,a,o=this.props.robotSceneManager,s=o.robotSceneById(e),u=o.startTime(),l=o.endTime(),c=s.timeWarping();if(a=r&&c?c.timeWarpMap()[1]:YU.frameRange(u,l,20,2e3),void 0===n)return[(i=s.frameDataFor(t,a,void 0)).times,i.robotPositions];if(n instanceof eP)return[(i=s.frameDataFor(t,a,n)).times,i.linkPositions];if(n instanceof $R)return[(i=s.frameDataFor(t,a,n)).times,i.jointPositions];throw new Error("Unknown robot part type")}},{key:"getVectorArray",value:function(e){for(var t=[[],[],[]],n=0;n<e.length;n++)t[0].push(e[n].x),t[1].push(e[n].y),t[2].push(e[n].z);return t}},{key:"getVelocityVector",value:function(e,t,n,r,i){var a=this.getPositionVector(e,t,n,r),o=vr(this.getVectorArray(a[1]),3),s=o[0],u=o[1],l=o[2],c=this.genChangeData(a[0],s)[1],h=this.genChangeData(a[0],u)[1],f=this.genChangeData(a[0],l)[1];return[a[0],c,h,f]}},{key:"getAccelerationVector",value:function(e,t,n,r,i){var a=vr(this.getVelocityVector(e,t,n,r,i),4),o=a[0],s=a[1],u=a[2],l=a[3];return[o,this.genChangeData(o,s)[1],this.genChangeData(o,u)[1],this.genChangeData(o,l)[1]]}},{key:"getJerkVector",value:function(e,t,n,r,i){var a=vr(this.getAccelerationVector(e,t,n,r,i),4),o=a[0],s=a[1],u=a[2],l=a[3];return[o,this.genChangeData(o,s)[1],this.genChangeData(o,u)[1],this.genChangeData(o,l)[1]]}},{key:"calculateMagitude",value:function(e,t,n){for(var r=[],i=0;i<e.length;i++)r.push(Math.sqrt(e[i]*e[i]+t[i]*t[i]+n[i]*n[i]));return r}},{key:"fillTimeValData",value:function(e,t,n,r){t.push(r),n.push(e)}},{key:"checkId",value:function(e,t,n){if(!t.has(e.value)){if(!t.has(e.value+"&tw"))return console.log("Error: ".concat(e," does not exist in is_part_changed but in graph_list!")),!1;n.value=!0,e.value+="&tw"}return!0}},{key:"fillGraphData",value:function(e,t,n){var r=this.state,i=r.graph_list,a=r.is_part_changed,o=r.color_map,u=(r.currScene,r.refresh),l=r.velocity_map,c=r.acceleration_map,h=this.props.robotSceneManager,f=this.props.graph,d=this.times,p=this.values,v=0,m=[],g=[],y=[],b=[],_=new Map,x="",w="",S=this.state.use_timeWarp,M=new Map;u||(_=Zb().cloneDeep(o));var k,T=s(i);try{for(T.s();!(k=T.n()).done;){for(var E=vr(k.value,2),C=E[0],A=E[1],R=vr(C.split("#"),2),P=R[0],L=R[1],D=A.position_type,N=A.velocity_type,I=A.acceleration_type,O=A.jerk_type,U=0;U<D.length;U++){var F;if(console.log("object position"+C),w="".concat(C,"&").concat(D[U],"&position"),this.checkId({value:w},a,{value:S})){var z=a.get(w);if(-1===z||n){var B=this.getPositions(P,A.robot,void 0,!1,D[U],S);m[v]=B[0],g[v]=B[1]}else m[v]=d[z],g[v]=p[z];M.set(D[U],v),a.set(w,v),x="".concat(null===(F=h.robotSceneById(P))||void 0===F?void 0:F.name(),"_").concat(L,"_").concat(D[U],"_Cartesian position").concat(S?"_tw":""),this.fillTimeValData(w,y,b,x),_.has(w)||_.set(w,f.getColor()),v++}}for(var V=0;V<N.length;V++){var G;if(S=!1,console.log("object velocity"+C),w="".concat(C,"&").concat(N[V],"&velocity"),this.checkId({value:w},a,{value:S})){var j=a.get(w);if(-1===j||n)if("magnitude"===N[V]){var H=this.getVelocityVector(P,A.robot,void 0,S);m[v]=H[0],g[v]=this.calculateMagitude(H[1],H[2],H[3])}else{var W=void 0,Z=M.get(N[V]);W=Z?[m[Z],g[Z]]:this.getPositions(P,A.robot,void 0,!1,N[V],S);var q=this.genChangeData(W[0],W[1]);l.set(C+"&"+N[V],this.genChangeData(W[0],W[1],0)),m[v]=q[0],g[v]=q[1]}else m[v]=d[j],g[v]=p[j];a.set(w,v),x="".concat(null===(G=h.robotSceneById(P))||void 0===G?void 0:G.name(),"_").concat(L,"_").concat(N[V],"_Cartesian velocity").concat(S?"_tw":""),this.fillTimeValData(w,y,b,x),_.has(w)||_.set(w,f.getColor()),v++}}for(var X=0;X<I.length;X++){var Y;if(S=!1,console.log("object acceleration"+C),w="".concat(C,"&").concat(I[X],"&acceleration"),this.checkId({value:w},a,{value:S})){var K=a.get(w);if(-1===K||n)if("magnitude"===I[X]){var J=this.getAccelerationVector(P,A.robot,void 0,S);m[v]=J[0],g[v]=this.calculateMagitude(J[1],J[2],J[3])}else{var Q=void 0,$=l.get(w);if($)Q=[$[0],$[1]];else{U1("no index for velocity");var ee=void 0,te=M.get(I[X]);te?(U1("has position"),ee=[m[te],g[te]]):(U1("no index for position"),ee=this.getPositions(P,A.robot,void 0,!1,I[X],S)),U1("computed velocity");var ne=this.genChangeData(ee[0],ee[1],0);l.set(C+"&"+I[X],ne),Q=[ne[0],ne[1]]}var re=this.genChangeData(Q[0],Q[1]);c.set(C+"&"+I[X],this.genChangeData(Q[0],Q[1],0)),m[v]=re[0],g[v]=re[1]}else m[v]=d[K],g[v]=p[K];a.set(w,v),x="".concat(null===(Y=h.robotSceneById(P))||void 0===Y?void 0:Y.name(),"_").concat(L,"_").concat(I[X],"_Cartesian acceleration").concat(S?"_tw":""),this.fillTimeValData(w,y,b,x),_.has(w)||_.set(w,f.getColor()),v++}}for(var ie=0;ie<O.length;ie++){var ae;if(console.log("object jerk"+C),S=!1,w="".concat(C,"&").concat(O[ie],"&jerk"),this.checkId({value:w},a,{value:S})){var oe=a.get(w);if(-1===oe||n)if("magnitude"===O[ie]){var se=this.getJerkVector(P,A.robot,void 0,S);m[v]=se[0],g[v]=this.calculateMagitude(se[1],se[2],se[3])}else{var ue=void 0,le=c.get(C+"&"+O[ie]);if(le)ue=[le[0],le[1]];else{var ce=void 0,he=l.get(C+"&"+O[ie]);if(he)ce=[he[0],he[1]];else{var fe=void 0,de=M.get(O[ie]);fe=de?[m[de],g[de]]:this.getPositions(P,A.robot,void 0,!1,O[ie],S);var pe=this.genChangeData(fe[0],fe[1],0);l.set(C+"&"+O[ie],pe),ce=[pe[0],pe[1]]}var ve=this.genChangeData(ce[0],ce[1],0);c.set(C+"&"+O[ie],ve),ue=[ve[0],ve[1]]}var me=this.genChangeData(ue[0],ue[1]);m[v]=me[0],g[v]=me[1]}else m[v]=d[oe],g[v]=p[oe];a.set(w,v),x="".concat(null===(ae=h.robotSceneById(P))||void 0===ae?void 0:ae.name(),"_").concat(L,"_").concat(O[ie],"_Cartesian jerk").concat(S?"_tw":""),this.fillTimeValData(w,y,b,x),_.has(w)||_.set(w,f.getColor()),v++}}var ge,ye=s(A.robotParts);try{for(ye.s();!(ge=ye.n()).done;){var be=vr(ge.value,2),_e=be[0],xe=be[1];if(S=!1,xe.angle[0]){var we;if(w=C+"&"+_e+"&angle&position",!this.checkId({value:w},a,{value:S}))continue;var Se=a.get(w);if(-1===Se||n){console.log("filter changes");var Me=this.getPositions(P,A.robot,xe.robotPart,!0,"x",S);m[v]=Me[0],g[v]=Me[1]}else m[v]=d[Se],g[v]=p[Se];a.set(w,v),x="".concat(null===(we=h.robotSceneById(P))||void 0===we?void 0:we.name(),"_").concat(L,"_\n").concat(_e,"_joint_position").concat(S?"_tw":""),this.fillTimeValData(w,y,b,x),_.has(w)||_.set(w,f.getColor()),v++}if(xe.angle[1]){var ke;if(w=C+"&"+_e+"&angle&velocity",!this.checkId({value:w},a,{value:S}))continue;var Te=a.get(w);if(-1===Te||n){var Ee=void 0;Ee=xe.angle[0]?[m[v-1],g[v-1]]:this.getPositions(P,A.robot,xe.robotPart,!0,"x",S);var Ce=this.genChangeData(Ee[0],Ee[1]);m[v]=Ce[0],g[v]=Ce[1]}else m[v]=d[Te],g[v]=p[Te];a.set(w,v),x="".concat(null===(ke=h.robotSceneById(P))||void 0===ke?void 0:ke.name(),"_").concat(L,"_\n").concat(_e,"_joint_velocity").concat(S?"_tw":""),this.fillTimeValData(w,y,b,x),_.has(w)||_.set(w,f.getColor()),v++}if(xe.angle[2]){var Ae,Re=C+"&"+_e+"&angle";if(w=Re+"&acceleration",!this.checkId({value:w},a,{value:S}))continue;var Pe=a.get(w);if(-1===Pe||n){var Le=void 0,De=l.get(Re);if(De)Le=[De[0],De[1]];else{console.log("no cache for velocity "+Re);var Ne=void 0,Ie=a.get(Re+"&position");Ie?(console.log("has position"),Ne=[m[Ie],g[Ie]]):Ne=this.getPositions(P,A.robot,xe.robotPart,!0,"x",S),console.log(m);var Oe=this.genChangeData(Ne[0],Ne[1],0);l.set(Re,Oe),Le=[Oe[0],Oe[1]]}var Ue=this.genChangeData(Le[0],Le[1]);c.set(Re,this.genChangeData(Le[0],Le[1],0)),m[v]=Ue[0],g[v]=Ue[1]}else m[v]=d[Pe],g[v]=p[Pe];a.set(w,v),x="".concat(null===(Ae=h.robotSceneById(P))||void 0===Ae?void 0:Ae.name(),"_").concat(L,"_\n").concat(_e,"_joint_acceleration").concat(S?"_tw":""),this.fillTimeValData(w,y,b,x),_.has(w)||_.set(w,f.getColor()),v++}if(xe.angle[3]){var Fe,ze=C+"&"+_e+"&angle";if(w=ze+"&jerk",!this.checkId({value:w},a,{value:S}))continue;var Be=a.get(w);if(-1===Be||n){var Ve=void 0,Ge=c.get(ze);if(Ge)Ve=[Ge[0],Ge[1]];else{var je=void 0,He=l.get(ze);if(He)je=[He[0],He[1]];else{U1("no cache for velocity "+ze);var We=void 0,Ze=a.get(ze+"&position");Ze?(U1("has position"),We=[m[Ze],g[Ze]]):We=this.getPositions(P,A.robot,xe.robotPart,!0,"x",S),U1("computed velocity");var qe=this.genChangeData(We[0],We[1],0);l.set(ze,qe),je=[qe[0],qe[1]]}var Xe=this.genChangeData(je[0],je[1]);c.set(ze,this.genChangeData(je[0],je[1],0)),Ve=[Xe[0],Xe[1]]}var Ye=this.genChangeData(Ve[0],Ve[1]);c.set(ze,this.genChangeData(Ve[0],Ve[1],0)),m[v]=Ye[0],g[v]=Ye[1]}else m[v]=d[Be],g[v]=p[Be];a.set(w,v),x="".concat(null===(Fe=h.robotSceneById(P))||void 0===Fe?void 0:Fe.name(),"_").concat(L,"_\n").concat(_e,"_joint_jerk").concat(S?"_tw":""),this.fillTimeValData(w,y,b,x),_.has(w)||_.set(w,f.getColor()),v++}for(var Ke=xe.position_type,Je=xe.velocity_type,Qe=xe.acceleration_type,$e=xe.jerk_type,et=new Map,tt=0;tt<Ke.length;tt++){var nt;if(S=!1,w=C+"&"+_e+"&"+Ke[tt]+"&position",console.log("id is "+w),this.checkId({value:w},a,{value:S})){var rt=a.get(w);if(console.log("generate positions"),-1===rt||n){console.log("new one");var it=this.getPositions(P,A.robot,xe.robotPart,!1,Ke[tt],S);console.log("positions"),console.log(it),m[v]=it[0],g[v]=it[1]}else console.log("old one"),m[v]=d[rt],g[v]=p[rt];et.set(Ke[tt],v),a.set(w,v),x="".concat(null===(nt=h.robotSceneById(P))||void 0===nt?void 0:nt.name(),"_").concat(L,"_").concat(_e,"_").concat(Ke[tt],"_Cartesian position").concat(S?"_tw":""),this.fillTimeValData(w,y,b,x),_.has(w)||_.set(w,f.getColor()),v++}}for(var at=0;at<Je.length;at++){var ot;S=!1;var st=C+"&"+_e+"&"+Je[at];if(w=st+"&velocity",console.log(w),this.checkId({value:w},a,{value:S})){var ut=a.get(w);if(-1===ut||n)if("magnitude"===Je[at]){var lt=this.getVelocityVector(P,A.robot,xe.robotPart,S);m[v]=lt[0],g[v]=this.calculateMagitude(lt[1],lt[2],lt[3])}else{var ct=void 0,ht=et.get(Je[at]);ct=ht?[m[ht],g[ht]]:this.getPositions(P,A.robot,xe.robotPart,!1,Je[at],S);var ft=this.genChangeData(ct[0],ct[1]);l.set(st,this.genChangeData(ct[0],ct[1],0)),m[v]=ft[0],g[v]=ft[1]}else m[v]=d[ut],g[v]=p[ut];a.set(w,v),x="".concat(null===(ot=h.robotSceneById(P))||void 0===ot?void 0:ot.name(),"_").concat(L,"_").concat(_e,"_").concat(Je[at],"_Cartesian velocity").concat(S?"_tw":""),this.fillTimeValData(w,y,b,x),_.has(w)||_.set(w,f.getColor()),v++}}for(var dt=0;dt<Qe.length;dt++){var pt;S=!1;var vt=C+"&"+_e+"&"+Qe[dt];if(w="".concat(vt,"&acceleration"),this.checkId({value:w},a,{value:S})){var mt=a.get(w);if(-1===mt||n)if("magnitude"===Qe[dt]){var gt=this.getAccelerationVector(P,A.robot,xe.robotPart,S);m[v]=gt[0],g[v]=this.calculateMagitude(gt[1],gt[2],gt[3])}else{var yt=void 0,bt=l.get(vt);if(bt)yt=[bt[0],bt[1]];else{U1("no cache for velocity "+vt);var _t=void 0,xt=et.get(Qe[dt]);xt?(U1("has position"),_t=[m[xt],g[xt]]):(U1("no index for position"),_t=this.getPositions(P,A.robot,xe.robotPart,!1,Qe[dt],S)),U1("computed velocity");var wt=this.genChangeData(_t[0],_t[1],0);l.set(vt,wt),yt=[wt[0],wt[1]]}var St=this.genChangeData(yt[0],yt[1]);c.set(vt,this.genChangeData(yt[0],yt[1],0)),m[v]=St[0],g[v]=St[1]}else m[v]=d[mt],g[v]=p[mt];a.set(w,v),x="".concat(null===(pt=h.robotSceneById(P))||void 0===pt?void 0:pt.name(),"_").concat(L,"_").concat(_e,"_").concat(Qe[dt],"_Cartesian acceleration").concat(S?"_tw":""),this.fillTimeValData(w,y,b,x),_.has(w)||_.set(w,f.getColor()),v++}}for(var Mt=0;Mt<$e.length;Mt++){var kt;S=!1;var Tt=C+"&"+_e+"&"+$e[Mt];if(w="".concat(Tt,"&jerk"),this.checkId({value:w},a,{value:S})){var Et=a.get(w);if(-1===Et||n)if("magnitude"===Qe[Mt]){var Ct=this.getJerkVector(P,A.robot,xe.robotPart,S);m[v]=Ct[0],g[v]=this.calculateMagitude(Ct[1],Ct[2],Ct[3])}else{var At=void 0,Rt=c.get(Tt);if(Rt)At=[Rt[0],Rt[1]];else{var Pt=void 0,Lt=l.get(Tt);if(Lt)Pt=[Lt[0],Lt[1]];else{var Dt=void 0,Nt=et.get($e[Mt]);Dt=Nt?[m[Nt],g[Nt]]:this.getPositions(P,A.robot,xe.robotPart,!1,$e[Mt],S);var It=this.genChangeData(Dt[0],Dt[1],0);l.set(Tt,It),Pt=[It[0],It[1]]}var Ot=this.genChangeData(Pt[0],Pt[1],0);c.set(Tt,Ot),At=[Ot[0],Ot[1]]}var Ut=this.genChangeData(At[0],At[1]);m[v]=Ut[0],g[v]=Ut[1]}else m[v]=d[Et],g[v]=p[Et];a.set(w,v),x="".concat(null===(kt=h.robotSceneById(P))||void 0===kt?void 0:kt.name(),"_").concat(L,"_").concat(_e,"_").concat($e[Mt],"_Cartesian jerk").concat(S?"_tw":""),this.fillTimeValData(w,y,b,x),_.has(w)||_.set(w,f.getColor()),v++}}}}catch(x2){ye.e(x2)}finally{ye.f()}}}catch(x2){T.e(x2)}finally{T.f()}d=m,p=g,this.times=d,this.values=p,this.setState({prev_times:{start:h.currStartTime(),end:h.currEndTime(),curr:h.currTime()},line_names:y,line_ids:b,color_map:_,refresh:!1,is_part_changed:a,need_update:!1,velocity_map:l,acceleration_map:c}),this.props.graph.setLineNames(y),this.props.graph.setLineIds(b);for(var Ft=[],zt=0,Bt=b;zt<Bt.length;zt++){var Vt=Bt[zt];Ft.push(_.get(Vt))}this.props.graph.setLineColors(Ft)}},{key:"componentWillUnmount",value:function(){this._panel_resize_observer&&this._panel_resize_observer.disconnect()}},{key:"componentDidMount",value:function(){var e,t=this,n=document.querySelectorAll(".RobotCanvasCanvas");n.forEach((function(e){return e.classList.remove("selected")})),(n=document.querySelectorAll(".GraphPanel")).forEach((function(e){return e.classList.remove("selected")})),null===(e=this._graphDiv.current)||void 0===e||e.classList.add("selected"),this._panel_resize_observer=new ResizeObserver((function(e){t.setState({panelWidth:e[0].contentRect.width,panelHeight:.85*e[0].contentRect.height})})),this._graphDiv&&this._graphDiv.current&&this._panel_resize_observer.observe(this._graphDiv.current);var r,i=this.props.graph,a=[],o=s(i.lineIds());try{for(o.s();!(r=o.n()).done;){var u=r.value,l=vr(this.decomposeEventName(u),5),c=l[0],h=l[1],f=l[2],d=(l[3],l[4],c+"#"+h+"&"+f);a.push(d)}}catch(x2){o.e(x2)}finally{o.f()}this.addNewLines(a,i.currProperty())}},{key:"componentDidUpdate",value:function(e){var t=this.props.graph.deleteLine();if(void 0!==t){var n=vr(t.split("&"),4),i=n[0],a=n[1];n[2],n[3];this.state.currObjects.has(i+"&"+a)&&(r.removeRobotPartFromGraph(t,this.props.robotSceneManager),this.state.currObjects.delete(i+"&"+a),this.OnChangeGraph([t],!1),this.props.graph.setDeleteLine(void 0,void 0))}var o=this.state,s=o.prev_times,u=o.refresh,l=o.need_update,c=s.start!==this.props.robotSceneManager.currStartTime()||s.end!==this.props.robotSceneManager.currEndTime();c&&this.setState({prev_times:{start:this.props.robotSceneManager.currStartTime(),end:this.props.robotSceneManager.currEndTime(),curr:this.props.robotSceneManager.currTime()}});var h=s.curr!==this.props.robotSceneManager.currTime();if((h||u||l)&&this.fillGraphData(c,h),this.props.force_update!==e.force_update&&this.setState({need_update:!0}),this.props.robotSceneManager.getCurrGraph()===this.props.graph){var f=this.props,d=f.eventName,p=f.add;(d!==e.eventName||p!==e.add)&&this.onChangeGraphWithManyLines(d,p),this.props.graph.filter()!==this.state.filter&&(this.setState({filter:this.props.graph.filter()}),this.onChangeFilter(this.props.graph.filter()))}}},{key:"decomposeEventName",value:function(e){var t=vr(e.split("&"),4),n=t[0],r=t[1],i=t[2],a=t[3],o=vr(n.split("#"),2);return[o[0],o[1],r,i,a]}},{key:"convertStringToDataType",value:function(e){if("position"!==e&&"velocity"!==e&&"acceleration"!==e&&"jerk"!==e)throw Error("".concat(e," is not a property!!!!"));return e}},{key:"onChangeGraphWithManyLines",value:function(e,t){this.setState({currProperty:e[0]}),this.state.graph_list.clear(),this.props.graph.resetColor(),this.state.color_map.clear(),this.state.is_part_changed.clear();var n,r=[],i=mb(e[0]),a=s(this.state.currObjects);try{for(a.s();!(n=a.n()).done;){var o=n.value;r.push(o+i)}}catch(x2){a.e(x2)}finally{a.f()}this.OnChangeGraph(r,t)}},{key:"OnChangeGraph",value:function(e,t){var n,r=s(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.OnChangeGraphHelper(i,t)}}catch(x2){r.e(x2)}finally{r.f()}this.fillGraphData()}},{key:"OnChangeGraphHelper",value:function(e,t){console.log("on change graph called in GraphPanel"),console.log("event name is "+e);var n=this.decomposeEventName(e),i=this.props.robotSceneManager,a=i.robotSceneById(n[0]);if(void 0!=a){console.log("scene id is "+n[0]);var o=n[1];if(void 0!=o){console.log("robot name is "+o);var s=n[2];if(void 0!=s){console.log("part name is "+s);var u=n[3];if(void 0!=u&&(console.log("current specific prop is "+u),"rotation"!==n[4])){var l=this.convertStringToDataType(n[4]);if(void 0!=l){console.log("current data type is "+l);var c=n[0]+"#"+o,h=this.state,f=h.graph_list,d=h.is_part_changed,p=h.use_timeWarp,v=this.state.line_ids,m=a.id().value(),g=f.get(c);if(p&&(e+="&tw"),v.includes(e)?d.set(e,v.indexOf(e)):d.set(e,-1),t||(d.delete(e),this.state.color_map.delete(e)),g){var y=g.robotParts.get(s);if(y){if("angle"===u)"position"===l?y.angle[0]=!y.angle[0]:"velocity"===l?y.angle[1]=!y.angle[1]:"acceleration"===l?y.angle[2]=!y.angle[2]:"jerk"===l&&(y.angle[3]=!y.angle[3]);else if("x"===u||"y"===u||"z"===u||"magnitude"===u){var b;if("position"===l)b=y.position_type;else if("velocity"===l)b=y.velocity_type;else if("acceleration"===l)b=y.acceleration_type;else{if("jerk"!==l)return void U1("Error: Checkbox invalid data type: "+l);b=y.jerk_type}var _=b.indexOf(u);-1!==_?b.splice(_,1):b.push(u),b.sort(),"position"===l?y.position_type=b:"velocity"===l?y.velocity_type=b:"acceleration"===l?y.acceleration_type=b:"jerk"===l&&(y.jerk_type=b)}y.angle||y.position_type.length||y.velocity_type.length||y.acceleration_type.length||y.jerk_type.length?g.robotParts.set(s,y):g.robotParts.delete(s)}else{var x;if(0===g.robot.jointMap().size&&0===g.robot.linkMap().size)x=void 0;else if(!(x=g.robot.jointMap().get(s))&&!(x=g.robot.linkMap().get(s)))return void U1("Error: robot joint name cannot be found");var w={robotPart:x,position_type:"position"===l&&("x"===u||"y"===u||"z"===u||"magnitude"===u)?[u]:[],velocity_type:"velocity"===l&&("x"===u||"y"===u||"z"===u||"magnitude"===u)?[u]:[],acceleration_type:"acceleration"===l&&("x"===u||"y"===u||"z"===u||"magnitude"===u)?[u]:[],jerk_type:"jerk"===l&&("x"===u||"y"===u||"z"===u||"magnitude"===u)?[u]:[],angle:["position"===l&&"angle"===u,"velocity"===l&&"angle"===u,"acceleration"===l&&"angle"===u,"jerk"===l&&"angle"===u]};g.robotParts.set(s,w)}g.robotParts.size||g.position_type.length||g.velocity_type.length||g.acceleration_type.length||g.jerk_type.length?f.set(c,g):f.delete(c)}else{var S=r.getRobotByName(i.robotSceneById(m),o);if(!S)return void U1("Error: robot name cannot be found");var M,k={robotScene:m,robot:S,position_type:[],velocity_type:[],acceleration_type:[],jerk_type:[],robotParts:new Map};if(0===k.robot.jointMap().size&&0===k.robot.linkMap().size)M=void 0;else if(!(M=k.robot.jointMap().get(s))&&!(M=k.robot.linkMap().get(s)))return void U1("Error: robot joint name cannot be found");var T={robotPart:M,position_type:"position"===l&&("x"===u||"y"===u||"z"===u||"magnitude"===u)?[u]:[],velocity_type:"velocity"===l&&("x"===u||"y"===u||"z"===u||"magnitude"===u)?[u]:[],acceleration_type:"acceleration"===l&&("x"===u||"y"===u||"z"===u||"magnitude"===u)?[u]:[],jerk_type:"jerk"===l&&("x"===u||"y"===u||"z"===u||"magnitude"===u)?[u]:[],angle:["position"===l&&"angle"===u,"velocity"===l&&"angle"===u,"acceleration"===l&&"angle"===u,"jerk"===l&&"angle"===u]};k.robotParts.set(s,T),f.set(c,k)}this.setState({graph_list:f,is_part_changed:d,graph_update:!0})}}}}}}},{key:"onCheckUseTW",value:function(e){var t=this.state.use_timeWarp;this.setState({use_timeWarp:!t,graph_update:!0,need_update:!0})}},{key:"onChangeFilter",value:function(e){console.log("on change filter"),this.setState({filter:e,graph_update:!0}),this.fillGraphData(!1,!1,!0)}},{key:"onCurrTimeChange",value:function(e){e<=this.props.robotSceneManager.currEndTime()&&e>=this.props.robotSceneManager.currStartTime()&&this.props.robotSceneManager.setCurrTime(e)}},{key:"onStartTimeChange",value:function(e){this.props.robotSceneManager.currTime()<e&&this.props.robotSceneManager.setCurrTime(e),this.props.robotSceneManager.currEndTime()>=e&&this.props.robotSceneManager.setCurrStartTime(e)}},{key:"onEndTimeChange",value:function(e){this.props.robotSceneManager.currTime()>e&&this.props.robotSceneManager.setCurrTime(e),this.props.robotSceneManager.currStartTime()<=e&&this.props.robotSceneManager.setCurrEndTime(e)}},{key:"onDeleteChange",value:function(e){var t=vr(e.split("&"),4),n=t[0],r=t[1];t[2],t[3];this.state.currObjects.delete(n+"&"+r),this.OnChangeGraph([e],!1)}},{key:"dragOverHandler",value:function(e){e.preventDefault()}},{key:"dropHandler",value:function(e){e.preventDefault();var t=e.dataTransfer.getData("text/plain");this.addNewLines([t],this.state.currProperty)}},{key:"addNewLines",value:function(e,t){var n,r=mb(t),i=this.state.currObjects,a=[],o=s(e);try{for(o.s();!(n=o.n()).done;){var u=n.value;if(!i.has(u)){i.add(u);var l=vr(this.decomposeId(u),3),c=l[0],h=l[1],f=l[2],d=this.props.robotSceneManager,p=d.robotSceneById(c);if(void 0!==p){d.isActiveRobotScene(p)||d.activateRobotScene(p);var v=p.getJointByName(h,f);if(void 0===v&&(v=p.getLinkByName(h,f)),void 0!==v)v.addToGraph();else{var m=p.getRobotByName(h);void 0!==m&&m.addToGraph()}}a.push(u+r)}}}catch(x2){o.e(x2)}finally{o.f()}a.length>0&&this.OnChangeGraph(a,!0)}},{key:"decomposeId",value:function(e){var t=vr(e.split("&"),2),n=t[0],r=t[1],i=vr(n.split("#"),2);return[i[0],i[1],r]}},{key:"render",value:function(){var e,t=this,n=this.times,r=this.values,i=this.state,a=i.color_map,o=i.is_part_changed,u=i.prev_times,l=i.panelHeight,c=i.panelWidth,h=i.currProperty,f=i.line_names,d=i.line_ids,p=[],v=s(d);try{for(v.s();!(e=v.n()).done;){var m=e.value;p.push(a.get(m))}}catch(x2){v.e(x2)}finally{v.f()}var g=vr(h.split("&"),3),y=g[1],b=g[2],_=b+" in "+y;"rotation"===b&&(_="the rotation can only be shown in difference"),b.startsWith("joint")&&(_=b);var x=this.props.robotSceneManager.getCurrGraph()===this.props.graph;return(0,rr.jsxs)("div",{className:"GraphPanel",ref:this._graphDiv,onDrop:this.dropHandler.bind(this),onDragOver:this.dragOverHandler.bind(this),onClick:this.clickHandler.bind(this),style:{backgroundColor:this.props.graph.backgroundColor()},children:[(0,rr.jsxs)("div",{className:"LegendMessage",children:[(0,rr.jsx)($Y,{buttonValue:"Legend",className:"Legend",getParentDockLayout:this.props.getParentDockLayout,onDragStart:function(){return["LineGraphLegend&".concat(Cb(4),"&").concat(t.props.graph.id()),function(e){}]}}),(0,rr.jsx)("div",{className:"PopUpGroup",children:(0,rr.jsx)("button",{id:"open-popup",className:"OpenPop",onClick:function(){return lr.setPopupHelpPage(Xn.GraphPanel)},children:(0,rr.jsx)(qn,{className:"Icon",icon:$n})})})]}),(0,rr.jsx)(O1,{times:n,vals:r,startTime:u.start,endTime:u.end,currTime:u.curr,isZoom:!1,isDiff:!1,isTimeWarp:!1,line_names:f,line_colors:p,title:_,width:c,height:l,line_ids:d,prev_map:o,selected:x,lineWidth:this.props.graph.lineWidth(),axisColor:this.props.graph.axisColor(),onGraphUpdate:this.onGraphUpdate.bind(this),onCurrChange:this.onCurrTimeChange.bind(this),onStartChange:this.onStartTimeChange.bind(this),onEndChange:this.onEndTimeChange.bind(this),onDeleteChange:this.onDeleteChange.bind(this)})]})}}],[{key:"getRobotByName",value:function(e,t){for(var n=e.robots(),r=0;r<n.length;r++)if(n[r].name()===t)return n[r]}},{key:"removeRobotPartFromGraph",value:function(e,t){var n=vr(e.split("#"),2),r=n[0],i=vr(n[1].split("&"),3),a=i[0],o=i[1],s=t.robotSceneById(r);if(void 0!==s){var u=s.getJointByName(a,o);if(void 0===u&&(u=s.getLinkByName(a,o)),void 0!==u)u.removeFromGraph();else{var l=s.getRobotByName(a);void 0!==l&&l.removeFromGraph()}lr.render(),lr.updateUI(),console.log(u)}}}]),r}(t.Component),z1=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var i;(0,u.Z)(this,r),(i=n.call(this,e))._panel_resize_observer=void 0,i._graphDiv=void 0,i.times=void 0,i.values=void 0,i.line_ids_diff=[],i.currProperty=void 0,i.clickHandler=function(){var e,t=document.querySelectorAll(".RobotCanvasCanvas");t.forEach((function(e){return e.classList.remove("selected")})),(t=document.querySelectorAll(".GraphPanel")).forEach((function(e){return e.classList.remove("selected")})),null===(e=i._graphDiv.current)||void 0===e||e.classList.add("selected"),i.props.setGraphOptionPanelActive(),i.props.graph.setCurrProperty(i.currProperty),i.props.robotSceneManager.setCurrGraph(i.props.graph.id())},i.fillGraphData.bind((0,c.Z)(i));var a=i.props.robotSceneManager;return i.state={counter:0,diff_times:[],diff_values:[],line_names_diff:[],line_ids:[],prev_times:{start:a.currStartTime(),end:a.currEndTime(),curr:a.currTime()},use_timeWarp:!1,color_map:new Map,currObjects:[],panelHeight:200,panelWidth:300,need_update:!0,graph_update:!1,is_part_changed:new Map,filter:i.props.graph.filter()},i._graphDiv=(0,t.createRef)(),i.times=[],i.values=[],i.currProperty=i.props.graph.currProperty(),i}return(0,l.Z)(r,[{key:"onGraphUpdate",value:function(e){var t=this.state.graph_update;return e?(this.setState({graph_update:!1}),!1):t}},{key:"getRotations",value:function(e,t,n,r){var i,a,o=this.props.robotSceneManager,s=o.robotSceneById(e),u=o.startTime(),l=o.endTime(),c=s.timeWarping();if(a=r&&c?c.timeWarpMap()[1]:YU.frameRange(u,l,20,2e3),void 0===n)return[(i=s.frameDataFor(t,a,void 0)).times,i.robotRotations];if(n instanceof eP)return[(i=s.frameDataFor(t,a,n)).times,i.linkRotations];if(n instanceof $R)return[(i=s.frameDataFor(t,a,n)).times,i.jointRotations];throw new Error("Unknown robot part type")}},{key:"getPositions",value:function(e,t,n,r,i,a){var o,s,u=this.props.robotSceneManager,l=u.robotSceneById(e),c=u.startTime(),h=u.endTime(),f=l.timeWarping();if(s=a&&f?f.timeWarpMap()[1]:YU.frameRange(c,h,20,2e3),void 0===n)return[(o=l.frameDataFor(t,s,void 0)).times,this.getNumArr(o.robotPositions,i)];if(n instanceof eP)return[(o=l.frameDataFor(t,s,n)).times,this.getNumArr(o.linkPositions,i)];if(n instanceof $R)return o=l.frameDataFor(t,s,n),r?[o.times,o.jointAngles]:[o.times,this.getNumArr(o.jointPositions,i)];throw new Error("Unknown robot part type")}},{key:"getVelocity",value:function(e,t,n,r,i,a){if("magnitude"===i){var o=this.getVelocityVector(e,t,n,a);return[o[0],this.calculateMagitude(o[1],o[2],o[3])]}var s=this.getPositions(e,t,n,r,i,a);return this.genChangeData(s[0],s[1])}},{key:"getAcceleration",value:function(e,t,n,r,i,a){if("magnitude"===i){var o=this.getAccelerationVector(e,t,n,a);return[o[0],this.calculateMagitude(o[1],o[2],o[3])]}var s=this.getVelocity(e,t,n,r,i,a);return this.genChangeData(s[0],s[1])}},{key:"getJerk",value:function(e,t,n,r,i,a){if("magnitude"===i){var o=this.getJerkVector(e,t,n,a);return[o[0],this.calculateMagitude(o[1],o[2],o[3])]}var s=this.getAcceleration(e,t,n,r,i,a);return this.genChangeData(s[0],s[1])}},{key:"getPositionVector",value:function(e,t,n,r){var i,a,o=this.props.robotSceneManager,s=o.robotSceneById(e),u=o.startTime(),l=o.endTime(),c=s.timeWarping();if(a=r&&c?c.timeWarpMap()[1]:YU.frameRange(u,l,20,2e3),void 0===n)return[(i=s.frameDataFor(t,a,void 0)).times,i.robotPositions];if(n instanceof eP)return[(i=s.frameDataFor(t,a,n)).times,i.linkPositions];if(n instanceof $R)return[(i=s.frameDataFor(t,a,n)).times,i.jointPositions];throw new Error("Unknown robot part type")}},{key:"getVectorArray",value:function(e){for(var t=[[],[],[]],n=0;n<e.length;n++)t[0].push(e[n].x),t[1].push(e[n].y),t[2].push(e[n].z);return t}},{key:"getVelocityVector",value:function(e,t,n,r,i){var a=this.getPositionVector(e,t,n,r),o=vr(this.getVectorArray(a[1]),3),s=o[0],u=o[1],l=o[2],c=this.genChangeData(a[0],s)[1],h=this.genChangeData(a[0],u)[1],f=this.genChangeData(a[0],l)[1];return[a[0],c,h,f]}},{key:"getAccelerationVector",value:function(e,t,n,r,i){var a=vr(this.getVelocityVector(e,t,n,r,i),4),o=a[0],s=a[1],u=a[2],l=a[3];return[o,this.genChangeData(o,s)[1],this.genChangeData(o,u)[1],this.genChangeData(o,l)[1]]}},{key:"getJerkVector",value:function(e,t,n,r,i){var a=vr(this.getAccelerationVector(e,t,n,r,i),4),o=a[0],s=a[1],u=a[2],l=a[3];return[o,this.genChangeData(o,s)[1],this.genChangeData(o,u)[1],this.genChangeData(o,l)[1]]}},{key:"calculateMagitude",value:function(e,t,n){for(var r=[],i=0;i<e.length;i++)r.push(Math.sqrt(e[i]*e[i]+t[i]*t[i]+n[i]*n[i]));return r}},{key:"getPositionsBounded",value:function(e,t,n,r,i,a){var o,s,u,l=this.props.robotSceneManager,c=l.robotSceneById(e),h=l.currStartTime(),f=l.currEndTime()+.1;a?s=YU.frameRange(h,f,20,2e3,null===(u=c.timeWarping())||void 0===u?void 0:u.timeWarp):s=YU.frameRange(h,f,20,2e3);if(void 0===n)return[(o=c.frameDataFor(t,s,void 0)).times,this.getNumArr(o.robotPositions,i)];if(n instanceof eP)return[(o=c.frameDataFor(t,s,n)).times,this.getNumArr(o.linkPositions,i)];if(n instanceof $R)return o=c.frameDataFor(t,s,n),r?[o.times,o.jointAngles]:[o.times,this.getNumArr(o.jointPositions,i)];throw new Error("Unknown robot part type")}},{key:"getNumArr",value:function(e,t){var n=[];if("magnitude"===t)for(var r=0;r<e.length;r++){var i=e[r].x,a=e[r].y,o=e[r].z;n.push(Math.sqrt(i*i+a*a+o*o))}else for(var s=0;s<e.length;s++)n.push(e[s][t]);return n}},{key:"genChangeData",value:function(e,t,n){void 0===n&&(n=this.state.filter);var r=[[],[]];r[0]=[],r[1]=[];for(var i=[];n&&n>0&&t.length>1;){i[0]=t[0]/4+t[0]/2+t[1]/4;for(var a=1;a<t.length-1;a++)i[a]=t[a-1]/4+t[a]/2+t[a+1]/4;i[t.length-1]=t[t.length-1]/4+t[t.length-1]/2+t[t.length-2]/4,t=Zb().cloneDeep(i),n--}for(var o=0;o<e.length-1;o++)r[0][o]=e[o],r[1][o]=(t[o+1]-t[o])/(e[o+1]-e[o]);return r[0][e.length-1]=e[e.length-1],r[1][e.length-1]=r[1][e.length-2],r}},{key:"calculateDifference",value:function(e,t){if("number"===typeof e&&"number"===typeof t)return t-e;if(e instanceof Ds&&t instanceof Ds){e=e.normalize();var n=(t=t.normalize()).clone().multiply(e.clone().invert()),r=2*Math.acos(n.w);return r>Math.PI&&(r=2*Math.PI-r),r}return 0}},{key:"decomposePropertyName",value:function(e){var t=vr(e.split("&"),3);return[t[1],t[2]]}},{key:"fillGraphData",value:function(e,t,n){console.log("fill graph data is called");var r=mb(this.currProperty),i=this.state,a=i.currObjects,o=i.is_part_changed,u=i.line_ids,l=i.use_timeWarp,c=i.color_map,h=this.props.robotSceneManager,f=vr(this.decomposePropertyName(r),2),d=f[0],p=f[1];if(void 0!=d){console.log("current specific prop is "+d);var v=!1;if("angle"==d&&(v=!0),void 0!==p){var m=this.convertStringToDataType(p);if(void 0!=m){console.log("current data type is "+m);var g=[],y=[],b=this.times,_=this.values,x=0,w=[],S=[],M=[],k=new Map;k=Zb().cloneDeep(c);var T,E=s(a);try{for(E.s();!(T=E.n()).done;){var C=T.value;console.log("fillGraphData called in DifferenceGraphPanel");var A=this.decomposeDragButtonId(C),R=A[0],P=h.robotSceneById(R);if(void 0==P)return;console.log("scene id is "+R);var L=A[1];if(void 0==L)return;var D=P.getRobotByName(L);if(void 0===D)return;console.log("robot name is "+L);var N=A[2];if(void 0==N)return;var I=D.jointMap().get(N);if(void 0===I&&void 0===(I=D.linkMap().get(N))){if(N!==L)return;I=void 0}console.log("part name is "+N);A[0];var O=C+r;u.includes(O)?o.set(O,u.indexOf(O)):o.set(O,-1);var U=o.get(O);if(-1===U||n){var F=v?"x":this.convertStringToVectorKey(d);if("rotation"===m){var z=this.getRotations(R,D,I,l);g[x]=z[0],y[x]=z[1]}else if("position"===m){var B=this.getPositions(R,D,I,v,F,l);g[x]=B[0],y[x]=B[1]}else if("velocity"===m){var V=this.getVelocity(R,D,I,v,F,l);g[x]=V[0],y[x]=V[1]}else if("acceleration"===m){var G=this.getAcceleration(R,D,I,v,F,l);g[x]=G[0],y[x]=G[1]}else if("jerk"===m){var j=this.getJerk(R,D,I,v,F,l);g[x]=j[0],y[x]=j[1]}else console.log("wrong data type")}else g[x]=b[U],y[x]=_[U];var H="".concat(P.name(),"_").concat(L,"_").concat(N);S[x]=O,M[x]=H,o.set(O,x++)}}catch(x2){E.e(x2)}finally{E.f()}if(2===y.length&&2===g.length&&y[0].length===y[1].length){console.log("Can draw diff"),w[0]=[],w[1]=[];for(var W=0;W<y[0].length;W++)w[0][W]=0,w[1][W]=this.calculateDifference(y[0][W],y[1][W]),k.has(S[W])||k.set(S[W],this.props.graph.getColor());this.line_ids_diff=S,this.setState({line_names_diff:M}),this.props.graph.setLineNames(M),this.props.graph.setLineIds(S);var Z,q=[],X=s(S);try{for(X.s();!(Z=X.n()).done;){var Y=Z.value;q.push(k.get(Y))}}catch(x2){X.e(x2)}finally{X.f()}this.props.graph.setLineColors(q)}b=g,_=y,this.times=b,this.values=_,this.setState({diff_values:w,diff_times:g,prev_times:{start:h.currStartTime(),end:h.currEndTime(),curr:h.currTime()},color_map:k,is_part_changed:o,need_update:!1})}}}}},{key:"componentWillUnmount",value:function(){this._panel_resize_observer&&this._panel_resize_observer.disconnect()}},{key:"componentDidMount",value:function(){var e,t=this,n=document.querySelectorAll(".RobotCanvasCanvas");n.forEach((function(e){return e.classList.remove("selected")})),(n=document.querySelectorAll(".GraphPanel")).forEach((function(e){return e.classList.remove("selected")})),null===(e=this._graphDiv.current)||void 0===e||e.classList.add("selected"),this._panel_resize_observer=new ResizeObserver((function(e){t.setState({panelWidth:e[0].contentRect.width,panelHeight:.85*e[0].contentRect.height})})),this._graphDiv&&this._graphDiv.current&&this._panel_resize_observer.observe(this._graphDiv.current);var r=this.props.graph;this.currProperty=r.currProperty();var i,a=s(r.lineIds());try{for(a.s();!(i=a.n()).done;){var o=i.value,u=vr(this.decomposeEventName(o),5),l=u[0],c=u[1],h=u[2],f=(u[3],u[4],l+"#"+c+"&"+h);this.addNewLine(f,r.currProperty())}}catch(x2){a.e(x2)}finally{a.f()}}},{key:"componentDidUpdate",value:function(e){var t=this.state,n=t.prev_times,r=t.need_update,i=n.start!==this.props.robotSceneManager.currStartTime()||n.end!==this.props.robotSceneManager.currEndTime(),a=n.curr!==this.props.robotSceneManager.currTime();if(i&&this.setState({prev_times:{start:this.props.robotSceneManager.currStartTime(),end:this.props.robotSceneManager.currEndTime(),curr:this.props.robotSceneManager.currTime()}}),(a||r)&&this.fillGraphData(i,a),this.props.force_update!==e.force_update&&this.setState({need_update:!0}),this.props.robotSceneManager.getCurrGraph()===this.props.graph){var o=this.props,s=o.eventName,u=o.add;(s!==e.eventName||u!==e.add)&&(this.currProperty=s[0],this.props.graph.resetColor(),this.fillGraphData()),this.props.graph.filter()!==this.state.filter&&(this.setState({filter:this.props.graph.filter()}),this.onChangeFilter(this.props.graph.filter()))}}},{key:"onChangeFilter",value:function(e){console.log("on change filter"),this.setState({filter:e,graph_update:!0}),this.fillGraphData(!1,!1,!0)}},{key:"decomposeEventName",value:function(e){var t=vr(e.split("&"),4),n=t[0],r=t[1],i=t[2],a=t[3],o=vr(n.split("#"),2);return[o[0],o[1],r,i,a]}},{key:"convertStringToDataType",value:function(e){if("position"!==e&&"velocity"!==e&&"acceleration"!==e&&"jerk"!==e&&"rotation"!==e)throw Error("".concat(e," is not a property!!!!"));return e}},{key:"convertStringToVectorKey",value:function(e){if("x"!==e&&"y"!==e&&"z"!==e&&"magnitude"!==e)throw Error("".concat(e," is not a property!!!!"));return e}},{key:"onCheckUseTW",value:function(e){var t=this.state.use_timeWarp;this.setState({use_timeWarp:!t,graph_update:!0,need_update:!0})}},{key:"onCurrTimeChange",value:function(e){e<=this.props.robotSceneManager.currEndTime()&&e>=this.props.robotSceneManager.currStartTime()&&this.props.robotSceneManager.setCurrTime(e)}},{key:"onStartTimeChange",value:function(e){this.props.robotSceneManager.currTime()<e&&this.props.robotSceneManager.setCurrTime(e),this.props.robotSceneManager.currEndTime()>=e&&this.props.robotSceneManager.setCurrStartTime(e)}},{key:"onEndTimeChange",value:function(e){this.props.robotSceneManager.currTime()>e&&this.props.robotSceneManager.setCurrTime(e),this.props.robotSceneManager.currStartTime()<=e&&this.props.robotSceneManager.setCurrEndTime(e)}},{key:"onDeleteChange",value:function(e){}},{key:"dragOverHandler",value:function(e){e.preventDefault()}},{key:"dropHandler",value:function(e){e.preventDefault();e.target;var t=e.dataTransfer.getData("text/plain"),n=mb(this.currProperty);this.addNewLine(t,n)}},{key:"addNewLine",value:function(e,t){var n=vr(this.decomposeId(e),3),r=n[0],i=n[1],a=n[2],o=this.props.robotSceneManager,s=o.robotSceneById(r);if(void 0!==s){o.isActiveRobotScene(s)||o.activateRobotScene(s);var u=s.getJointByName(i,a);if(void 0===u&&(u=s.getLinkByName(i,a)),void 0!==u)u.addToGraph();else{var l=s.getRobotByName(i);void 0!==l&&l.addToGraph()}}var c=this.state.currObjects;c.length>2||(c.push(e),this.line_ids_diff.push(e+t),2===this.line_ids_diff.length&&this.fillGraphData(),this.setState({currObjects:this.state.currObjects}))}},{key:"decomposeId",value:function(e){var t=vr(e.split("&"),2),n=t[0],r=t[1],i=vr(n.split("#"),2);return[i[0],i[1],r]}},{key:"decomposeDragButtonId",value:function(e){var t=vr(e.split("&"),2),n=t[0],r=t[1],i=vr(n.split("#"),2);return[i[0],i[1],r]}},{key:"decomposeLineId",value:function(e){var t=vr(e.split("&"),4),n=t[0],r=t[1],i=t[2],a=t[3],o=vr(n.split("#"),2);return[o[0],o[1],r,i,a]}},{key:"showDiffLineNames",value:function(){for(var e=this.state.currObjects,t=[],n=0;n<2;n++)if(void 0!==e[n]){var r,i=vr(this.decomposeDragButtonId(e[n]),3),a=i[0],o=i[1],s=i[2],u=null===(r=this.props.robotSceneManager.robotSceneById(a))||void 0===r?void 0:r.name();t[n]=u+"_"+o+"_"+s}return(0,rr.jsxs)("div",{children:[void 0!==t[0]&&(0,rr.jsxs)("p",{children:["the first (reference) line is ",t[0]]}),void 0!==t[1]&&(0,rr.jsxs)("p",{children:["the second line is ",t[1]]})]})}},{key:"render",value:function(){var e,t=this,n=this.state,r=n.diff_values,i=n.diff_times,a=(n.use_timeWarp,n.color_map),o=(n.prev_times,n.panelHeight),u=n.panelWidth,l=n.line_names_diff,c=this.currProperty,h=this.props.is_part_changed,f=this.props.robotSceneManager,d=this.line_ids_diff,p=[],v=s(d);try{for(v.s();!(e=v.n()).done;){var m=e.value;p.push(a.get(m))}}catch(x2){v.e(x2)}finally{v.f()}var g=vr(c.split("&"),3),y=g[1],b=g[2],_=b+" in "+y;"rotation"===b&&(_="Rotational"),b.startsWith("joint")&&(_=b);var x=this.props.robotSceneManager.getCurrGraph()===this.props.graph;return(0,rr.jsxs)("div",{className:"GraphPanel",ref:this._graphDiv,onDrop:this.dropHandler.bind(this),onDragOver:this.dragOverHandler.bind(this),onClick:this.clickHandler.bind(this),style:{backgroundColor:this.props.graph.backgroundColor(),overflow:"auto"},children:[(0,rr.jsxs)("div",{className:"LegendMessage",children:[(0,rr.jsx)($Y,{buttonValue:"Legend",className:"Legend",title:"Click and drag to open the legend",getParentDockLayout:this.props.getParentDockLayout,onDragStart:function(){return["LineGraphLegend&".concat(Cb(4),"&").concat(t.props.graph.id()),function(e){}]}}),(0,rr.jsx)("button",{id:"open-popup",className:"OpenPop",onClick:function(){return lr.setPopupHelpPage(Xn.DifferenceGraphPanel)},children:(0,rr.jsx)(qn,{className:"Icon",icon:$n})})]}),this.showDiffLineNames(),(0,rr.jsx)(O1,{times:i,vals:r,startTime:f.currStartTime(),endTime:f.currEndTime(),currTime:f.currTime(),isZoom:!1,isDiff:!0,isTimeWarp:!1,line_names:l,line_colors:p,title:_,width:u,height:o,line_ids:d,prev_map:h,selected:x,lineWidth:this.props.graph.lineWidth(),axisColor:this.props.graph.axisColor(),onGraphUpdate:this.onGraphUpdate.bind(this),onCurrChange:this.onCurrTimeChange.bind(this),onStartChange:this.onStartTimeChange.bind(this),onEndChange:this.onEndTimeChange.bind(this),onDeleteChange:this.onDeleteChange.bind(this)})]})}}]),r}(t.Component),B1=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).genGoToSceneCallback=function(e){return function(){r.props.robotSceneManager.setCurrRobotScene(e)}},r.state={expanded:!1},r}return(0,l.Z)(n,[{key:"render",value:function(){var e=this.props.robotSceneManager,t=e.currRobotScene(),n=t?e.getManagedRobotSceneData(t):void 0;return(0,rr.jsx)("div",{className:"SceneSelectorPanel",children:this.props.canEdit?(0,rr.jsxs)("div",{className:"ButtonGroup",style:{display:"flex",gap:"10px"},children:[(0,rr.jsx)("input",{className:"Button",type:"button",value:"New Scene",onClick:function(){var t=e.addDefaultManagedRobotScene();e.setCurrRobotScene(t)}}),(0,rr.jsx)("input",{className:"Button",type:"button",value:"Clone Scene",onClick:function(t){if(void 0!==n){var r=n.robotScene.clone(!0,!1,!0);e.addManagedRobotScenes([{path:cr(n.path),robotScene:r,metrics:new Map(n.metrics)}])}}})]}):null})}}]),n}(t.Component),V1=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var i;return(0,u.Z)(this,r),(i=n.call(this,e))._button=void 0,i._button=t.createRef(),i}return(0,l.Z)(r,[{key:"render",value:function(){return(0,rr.jsx)("button",{className:"DeleteButton",ref:this._button,onClick:this.props.onClick,style:this.props.style,id:this.props.id,children:(0,rr.jsx)(qn,{className:"TrashIcon",icon:Jn})})}}]),r}(t.Component),G1=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).genGoToSceneCallback=function(e,t){return t.stopPropagation(),function(){r.props.robotSceneManager.setCurrRobotScene(e),console.log("shit"),r.props.robotSceneManager.isActiveRobotScene(e)||(console.log("hello"),r.props.robotSceneManager.activateRobotScene(e))}},r.state={selectedScenes:new Map,selectedRobots:new Map},r}return(0,l.Z)(n,[{key:"componentDidMount",value:function(){document.getElementById("SelectionPanel"),document.getElementById("group1")}},{key:"genSceneOptions",value:function(){var e,t=[],n=s(this.props.robotSceneManager.allManagedRobotScenes());try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push({value:r.id().value(),label:r.name()})}}catch(x2){n.e(x2)}finally{n.f()}return t}},{key:"genRobotOptions",value:function(e){var t=[];if(null!=e){var n,r=s(e.robots());try{for(r.s();!(n=r.n()).done;){var i=n.value;t.push({value:i.id().value(),label:i.name(),ghost:!1})}}catch(x2){r.e(x2)}finally{r.f()}var a,o=s(e.ghostRobots());try{for(o.s();!(a=o.n()).done;){var u=a.value;t.push({value:u.id().value(),label:u.name()+"-ghost",ghost:!0})}}catch(x2){o.e(x2)}finally{o.f()}}return t}},{key:"genRobotPartOptions",value:function(e,t){if(null!=e&&void 0!=t){var n=F1.getRobotByName(e,t);if(void 0!==(null===n||void 0===n?void 0:n.objectType))return this.genPartOptions(t,n)}}},{key:"genPartOptions",value:function(e,t){var n=[];0!==t.getArticuatedJointMap().size&&n.push({value:"Articulated Joints",label:"Articulated Joints",inScene:!1,inGraph:!1});var r,i=s(t.getArticuatedJointMap());try{for(i.s();!(r=i.n()).done;){var a=vr(r.value,2),o=a[0],u=a[1];n.push({value:"".concat(e,"&").concat(o),label:o,inScene:u.isInScene(),inGraph:u.isInGraph()})}}catch(x2){i.e(x2)}finally{i.f()}0!==t.getFixedJointMap().size&&n.push({value:"Fixed Joints",label:"Fixed Joints",inScene:!1,inGraph:!1});var l,c=s(t.getFixedJointMap());try{for(c.s();!(l=c.n()).done;){var h=vr(l.value,2),f=h[0],d=h[1];n.push({value:"".concat(e,"&").concat(f),label:f,inScene:d.isInScene(),inGraph:d.isInGraph()})}}catch(x2){c.e(x2)}finally{c.f()}0!==t.linkMap().size&&n.push({value:"Links",label:"Links",inScene:!1,inGraph:!1});var p,v=s(t.linkMap());try{for(v.s();!(p=v.n()).done;){var m=vr(p.value,2),g=m[0],y=m[1];n.push({value:"".concat(e,"&").concat(g),label:g,inScene:y.isInScene(),inGraph:y.isInGraph()})}}catch(x2){v.e(x2)}finally{v.f()}return n.push({value:"Robot",label:"Robot",inScene:!1,inGraph:!1}),n.push({value:"".concat(e,"&").concat(e),label:"".concat(e),inScene:t.isInScene(),inGraph:t.isInGraph()}),n}},{key:"dragStartHandler",value:function(e){e.dataTransfer.setData("text/plain",e.target.id)}},{key:"appendRobotPartOptions",value:function(e,t,n){var r,i=this,a=e.id().value()+"#"+n,o=this.state.selectedRobots.get(a);return void 0!==o&&o?null===(r=this.genRobotPartOptions(e,t))||void 0===r?void 0:r.map((function(t){return(0,rr.jsx)($K,{children:i.genRobotPartList(e,t)})})):void 0}},{key:"genRobotPartList",value:function(e,t){return"Articulated Joints"===t.value||"Fixed Joints"===t.value||"Links"===t.value||"Robot"===t.value?(0,rr.jsx)("div",{children:t.value}):(0,rr.jsxs)("div",{style:{marginLeft:"-10px",display:"inline-block",whiteSpace:"nowrap"},children:[t.inScene&&(0,rr.jsx)("span",{children:"S\xa0"}),!t.inScene&&(0,rr.jsx)("span",{children:"\xa0 \xa0"}),t.inGraph&&(0,rr.jsx)("span",{children:"G\xa0"}),!t.inGraph&&(0,rr.jsx)("span",{children:"\xa0 \xa0"}),(0,rr.jsx)("button",{className:"DragButton_RobotPart",title:"Click and drop it to a 3D scene or a 2D graph to see its traces",id:e.id().value()+"#"+t.value,draggable:"true",onDragStart:this.dragStartHandler,children:t.label})]})}},{key:"onSelectRobot",value:function(e,t,n){n.stopPropagation(),this.props.setRobotOptionPanelActive(),void 0!==e&&(this.props.robotSceneManager.setCurrRobotScene(e),this.props.robotSceneManager.isActiveRobotScene(e)||this.props.robotSceneManager.activateRobotScene(e),void 0!==t&&e.setSelectedRobot(t))}},{key:"appendRobotOptions",value:function(e){var t=this,n=this.state.selectedScenes.get(e.id().value());return void 0!==n&&n?(0,rr.jsx)(MK,{allowZeroExpanded:!0,allowMultipleExpanded:!0,onChange:this.onChangeRobot.bind(this),children:this.genRobotOptions(e).map((function(n){return(0,rr.jsxs)(IK,{uuid:e.id().value()+"#"+n.value,children:[(0,rr.jsx)(JK,{children:(0,rr.jsxs)(YK,{children:[(0,rr.jsx)(V1,{onClick:function(r){return t.onDelete(r,e.id().value()+"#"+n.value,"robot",n.ghost)}}),(0,rr.jsx)("button",{className:"DragButton_Robot",title:"Click and drop it to a 3D scene or a 2D graph to add a ghost",id:e.id().value()+"#"+n.label,draggable:"true",onDragStart:t.dragStartHandler,onClick:function(r){return t.onSelectRobot(e,e.robotById(n.value),r)},children:n.label})]})}),t.appendRobotPartOptions(e,n.label,n.value)]},e.id().value()+"#"+n.value)}))}):void 0}},{key:"onChangeRobot",value:function(e){var t,n=new Map,r=s(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n.set(i,!0)}}catch(x2){r.e(x2)}finally{r.f()}this.setState({selectedRobots:n})}},{key:"onChangeScene",value:function(e){var t,n=new Map,r=s(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n.set(i,!0)}}catch(x2){r.e(x2)}finally{r.f()}this.setState({selectedScenes:n})}},{key:"onDelete",value:function(e,t,n,r){e.stopPropagation();var i=this.props.robotSceneManager;if("scene"===n){var a=this.props.robotSceneManager.robotSceneById(t);a&&i.removeRobotScene(a)}else if("robot"===n){var o=vr(t.split("#"),2),s=o[0],u=o[1],l=this.props.robotSceneManager.robotSceneById(s);if(l)if(void 0!==r&&!0===r)l.removeGhostRobot(u);else{var c=l.robotById(u);c&&l.removeChildRobot(c)}}}},{key:"onSelectScene",value:function(e,t){t.stopPropagation(),this.props.robotSceneManager.setCurrRobotScene(e),this.props.robotSceneManager.isActiveRobotScene(e)||this.props.robotSceneManager.activateRobotScene(e),this.props.setSceneOptionPanelActive()}},{key:"render",value:function(){var e=this,t=(this.state.selectedScenes,this.props.robotSceneManager),n=t.allManagedRobotScenes();return(0,rr.jsxs)("div",{className:"SelectionPanel",id:"SelectionPanel",children:[(0,rr.jsxs)("div",{style:{marginBottom:"10px"},id:"group1",className:"PopUpGroup",children:[(0,rr.jsx)("button",{id:"open-popup",className:"OpenPop",onClick:function(){return lr.setPopupHelpPage(Xn.SelectionPanel)},children:(0,rr.jsx)(qn,{className:"Icon",icon:$n})}),(0,rr.jsx)(B1,{getParentDockLayout:this.props.getParentDockLayout,canEdit:!0,robotSceneManager:t})]}),(0,rr.jsx)(MK,{allowZeroExpanded:!0,allowMultipleExpanded:!0,onChange:this.onChangeScene.bind(this),children:n.map((function(n){return(0,rr.jsxs)(IK,{uuid:n.id().value(),children:[(0,rr.jsx)(JK,{children:(0,rr.jsxs)(YK,{children:[(0,rr.jsx)(V1,{id:n.id().value(),onClick:function(t){return e.onDelete(t,n.id().value(),"scene")}}),(0,rr.jsx)($Y,{title:"Click and drag to open the scene",className:"Scene",buttonValue:n.name(),getParentDockLayout:e.props.getParentDockLayout,onClick:function(t){return e.onSelectScene(n,t)},onDragStart:function(){t.setAllowRobotSelection(!1);return["RobotScene&".concat(Cb(4),"&").concat(n.id().value()),function(e){t.setAllowRobotSelection(!0),t.isActiveRobotScene(n)||t.activateRobotScene(n),t.setCurrRobotScene(n)}]}},"".concat(n.name()))]})}),(0,rr.jsx)($K,{children:e.appendRobotOptions(n)})]},n.id().value())}))})]})}}]),n}(t.Component),j1=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var i;(0,u.Z)(this,r),(i=n.call(this,e))._panel_resize_observer=void 0,i._graphDiv=void 0,i.data_types=["joint position","joint velocity","joint acceleration","joint jerk","Cartesian position","Cartesian velocity","Cartesian acceleration","Cartesian jerk","rotation"],i.speci_property_types=["magnitude","x","y","z","angle"],i.selectedOptions=[],i.dropdownRef=[],i.currDataType=void 0,i.currSpeciProperty=void 0,i.state={counter:0,panelHeight:620,panelWidth:1200,dropdowns:[!1,!1],currScene:null,currRobot:new Map,currJoint:new Map,need_update:!0,currSelectedGraph:void 0},i._graphDiv=(0,t.createRef)();for(var a=0;a<2;a++)i.dropdownRef[a]=(0,t.createRef)();return i.currDataType=i.data_types[0],i.currSpeciProperty=i.speci_property_types[0],i}return(0,l.Z)(r,[{key:"booleanSum",value:function(e){var t,n=0,r=s(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n+=Number(i)}}catch(x2){r.e(x2)}finally{r.f()}return n}},{key:"genPropertyOptions",value:function(){var e,t=[],n=this.props.robotSceneManager.getCurrGraph(),r=s(this.data_types);try{for(r.s();!(e=r.n()).done;){var i=e.value;("rotation"!==i||void 0===n||n.isDiff())&&t.push({value:i,label:i})}}catch(x2){r.e(x2)}finally{r.f()}return t}},{key:"genSpeciPropertyOptions",value:function(){var e,t=[],n=s(this.speci_property_types);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push({value:r,label:r})}}catch(x2){n.e(x2)}finally{n.f()}return t}},{key:"componentDidUpdate",value:function(e){this.props.robotSceneManager.getCurrGraph()!==this.state.currSelectedGraph&&(this.setState({currSelectedGraph:this.props.robotSceneManager.getCurrGraph()}),this.setOptions())}},{key:"deselectDropdowns",value:function(e){this.state.dropdowns[e]=!1,void 0!=this.dropdownRef[e+1]&&void 0!=this.dropdownRef[e+1].current&&this.dropdownRef[e+1].current.setValue(this.dropdownRef[e+1].current.state.prevProps.placeholder)}},{key:"selectDropdowns",value:function(e){this.state.dropdowns[e]=!0}},{key:"onChangeProperty",value:function(e){this.deselectDropdowns(0);var t=e.value;t&&(this.currDataType=t,this.selectDropdowns(0),"rotation"===t?(this.selectDropdowns(1),this.onUpdate(t,"x")):"position"!==t&&(this.selectDropdowns(1),this.currSpeciProperty="magnitude",this.dropdownRef[1].current.setValue({value:"magnitude",label:"magnitude"}),this.onUpdate(t,"magnitude")))}},{key:"onChangeSpeciProperty",value:function(e){this.state.dropdowns[1]=!1;var t=e.value;t&&(this.currSpeciProperty=t,this.selectDropdowns(1),this.onUpdate(this.currDataType,t))}},{key:"onUpdate",value:function(e,t){for(var n,r=0;r<2;r++)if(!this.state.dropdowns[r])throw new Error("".concat(r," Not every dropdown is selected. Need to select all dropdowns to show the graph"));console.log("on Update");var i=[];i[0]="&"+t+"&"+e,null===(n=this.props.robotSceneManager.getCurrGraph())||void 0===n||n.setCurrProperty(i[0]),this.props.updateGraphPropertyPanelState(i,!0,void 0,void 0)}},{key:"decomposeEventName",value:function(e){var t=vr(e.split("&"),4),n=t[0],r=t[1],i=t[2],a=t[3],o=vr(n.split("#"),2);return[o[0],o[1],r,i,a]}},{key:"convertOptionListtoSpeciProperties",value:function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n].name;if("x"!==r&&"y"!==r&&"z"!==r&&"angle"!==r)throw Error("".concat(r," is not a valid specific property"));t[n]=r}return t}},{key:"setOptions",value:function(){var e=this.props.robotSceneManager.getCurrGraph();if(void 0!==e){var t=vr(e.currProperty().split("&"),3),n=t[1],r=t[2];this.dropdownRef[0].current.setValue({value:r,label:r}),this.dropdownRef[1].current.setValue({value:n,label:n})}}},{key:"createNewGraphTab",value:function(e,t){var n=new sF(e,t,!1);this.props.updateGraphPropertyPanelState(void 0,void 0,void 0,n)}},{key:"onChangeFilter",value:function(e){var t;console.log("on change filter"),this.props.forceUpdateTabNames(),null===(t=this.props.robotSceneManager.getCurrGraph())||void 0===t||t.setFilter(e)}},{key:"onChangeLineWidth",value:function(e){var t;null===(t=this.props.robotSceneManager.getCurrGraph())||void 0===t||t.setLineWidth(e)}},{key:"onBackgroundColorChange",value:function(e){var t;null===(t=this.props.robotSceneManager.getCurrGraph())||void 0===t||t.setBackgroundColor(e),this.props.forceUpdateTabNames()}},{key:"onAxisColorChange",value:function(e){var t;null===(t=this.props.robotSceneManager.getCurrGraph())||void 0===t||t.setAxisColor(e),this.props.forceUpdateTabNames()}},{key:"render",value:function(){var e=this,t=(this.props.filter_prop,{display:"flex"});this.currDataType.startsWith("joint")&&(t={display:"none"});var n=this.props.robotSceneManager.getCurrGraph();return(0,rr.jsxs)("div",{className:"GraphOptionPanel",ref:this._graphDiv,children:[(0,rr.jsxs)("div",{style:{marginBottom:"5px"},className:"PopUpGroup",children:[(0,rr.jsx)(tJ,{labelValue:"Name:",value:null===n||void 0===n?void 0:n.name(),onReturnPressed:function(t){null===n||void 0===n||n.setName(t),e.props.forceUpdateTabNames()}}),(0,rr.jsx)("button",{id:"open-popup",className:"OpenPop",onClick:function(){return lr.setPopupHelpPage(Xn.GraphOptionPanel)},children:(0,rr.jsx)(qn,{className:"Icon",icon:$n})})]}),(0,rr.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,rr.jsx)("span",{style:{fontWeight:"bold"},children:"Make Selections"}),(0,rr.jsxs)("div",{className:"Select",children:[(0,rr.jsx)("span",{children:"Property: "}),(0,rr.jsx)("div",{className:"Select-container",children:(0,rr.jsx)(XY,{placeholder:"Select a property ...",ref:this.dropdownRef[0],options:this.genPropertyOptions(),onChange:this.onChangeProperty.bind(this),isSearchable:!0,styles:k1})})]}),(0,rr.jsxs)("div",{className:"Select",style:t,children:[(0,rr.jsx)("span",{children:"Details:"}),(0,rr.jsx)("div",{className:"Select-container",children:(0,rr.jsx)(XY,{placeholder:"Select a specific property ...",ref:this.dropdownRef[1],options:this.genSpeciPropertyOptions(),onChange:this.onChangeSpeciProperty.bind(this),isSearchable:!0,styles:k1})})]})]}),(0,rr.jsx)(MK,{allowZeroExpanded:!0,allowMultipleExpanded:!0,children:(0,rr.jsxs)(IK,{children:[(0,rr.jsx)(JK,{children:(0,rr.jsx)(YK,{style:{fontWeight:"bold"},children:"Graph Views"})}),(0,rr.jsx)($K,{children:(0,rr.jsxs)("div",{className:"GraphViews",children:[(0,rr.jsx)(QY,{label:"Convolution Filtering Level: ",min:0,max:10,step:1,value:null===n||void 0===n?void 0:n.filter(),onChange:this.onChangeFilter.bind(this)}),(0,rr.jsx)(QY,{label:"Line width: ",min:.1,max:10,step:.1,value:null===n||void 0===n?void 0:n.lineWidth(),onChange:this.onChangeLineWidth.bind(this)}),(0,rr.jsx)(MK,{allowZeroExpanded:!0,allowMultipleExpanded:!0,children:(0,rr.jsxs)(IK,{children:[(0,rr.jsx)(JK,{children:(0,rr.jsx)(YK,{style:{fontWeight:"bold"},children:"Background Color:"})}),(0,rr.jsx)($K,{children:(0,rr.jsx)(NJ,{color:null===n||void 0===n?void 0:n.backgroundColor(),onChange:function(t){return e.onBackgroundColorChange(t)}})})]})}),(0,rr.jsx)(MK,{allowZeroExpanded:!0,allowMultipleExpanded:!0,children:(0,rr.jsxs)(IK,{children:[(0,rr.jsx)(JK,{children:(0,rr.jsx)(YK,{style:{fontWeight:"bold"},children:"Axis Color:"})}),(0,rr.jsx)($K,{children:(0,rr.jsx)(NJ,{color:null===n||void 0===n?void 0:n.axisColor(),onChange:function(t){return e.onAxisColorChange(t)}})})]})})]})})]})}),(0,rr.jsxs)("div",{className:"ButtonsContainer",children:[(0,rr.jsx)($Y,{buttonValue:"New Graph",title:"Click and drag to create a new graph",getParentDockLayout:this.props.getParentDockLayout,onDragStart:function(){var t=Cb(4);return["Graph&".concat(t,"&motion"),function(n){e.createNewGraphTab(t,!1)}]}}),(0,rr.jsx)($Y,{buttonValue:"Difference Graph",title:"Click and drag to create a new difference graph",getParentDockLayout:this.props.getParentDockLayout,onDragStart:function(){var t=Cb(4);return["DifferenceGraph&".concat(t,"&motion"),function(n){e.createNewGraphTab(t,!0)}]}})]})]})}}]),r}(t.Component),H1=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).jointAngleCallbackGen=r.jointAngleCallbackGen.bind((0,c.Z)(r)),r.onSizeChange=r.onSizeChange.bind((0,c.Z)(r)),r.positionCallbackGen=r.positionCallbackGen.bind((0,c.Z)(r)),r.toggleRotType=r.toggleRotType.bind((0,c.Z)(r)),r.toggleAngleType=r.toggleAngleType.bind((0,c.Z)(r)),r.state={rotationType:"Euler",angleType:"Degree"},r}return(0,l.Z)(n,[{key:"toggleRotType",value:function(){this.setState({rotationType:"Quaternion"===this.state.rotationType?"Euler":"Quaternion"})}},{key:"toggleAngleType",value:function(){this.setState({angleType:"Degree"===this.state.angleType?"Radian":"Degree"})}},{key:"onSizeChange",value:function(e){var t=this;return function(n){e?t.props.robot.setScaleOffset(new cb.Vector3(n,n,n)):t.props.robot.setScale(new cb.Vector3(n,n,n)),t.props.robotScene.render()}}},{key:"positionCallbackGen",value:function(e,t){var n=this;return"x"!==e&&"y"!==e&&"z"!==e&&(console.error('Postion "'.concat(e,'" is not one of "x", "y", "z"!')),e="x"),function(r){var i,a=n.props.robot,o=[(i=t?a.getPositionOffset():a.getPosition()).x,i.y,i.z],s=o[0],u=o[1],l=o[2];"x"===e?s=r:"y"===e?u=r:"z"===e&&(l=r),t?a.setPositionOffset(new cb.Vector3(s,u,l)):a.setPosition(new cb.Vector3(s,u,l))}}},{key:"rotationCallbackGen",value:function(e,t,n,r){var i=this;return"x"!==e&&"y"!==e&&"z"!==e&&"w"!==e&&(console.error('Rotation axis "'.concat(e,'" is not one of ["x", "y", "z", "w"]!')),e="x"),function(a){var o,s=i.props.robot;if(o=t?s.getQuaternionOffset().clone():s.getQuaternion().clone(),"Euler"===n){var u=i.props.robot.eulerRotation();if(console.log("before"),console.log(u),console.log(o),"Degree"===r&&(a=Sb(a)),"x"===e)u.x=a;else if("y"===e)u.y=a;else if("z"===e)u.z=a;else if("w"===e)return;o.setFromEuler(u),console.log("after"),console.log(u),console.log(o)}else"Quaternion"===n&&("x"===e?o.x=a:"y"===e?o.y=a:"z"===e?o.z=a:"w"===e&&(o.w=a));t?s.setQuaternionOffset(o):s.setQuaternion(o)}}},{key:"jointAngleCallbackGen",value:function(e,t){return function(n){"Degree"===t?e.setAngle(Sb(n)):e.setAngle(n)}}},{key:"render",value:function(){var e=this,t=this.state.rotationType,n=this.state.angleType,r=[],i=this.props.robot,a=i.idValue();!function(o){var s=o?i.getScaleOffset():i.getScale();r.push((0,rr.jsx)(QY,{label:"".concat(o?"":"Relative ","Scale"),min:0,max:2,step:.001,value:s.x,onChange:e.onSizeChange(o)},"".concat(a," ").concat(o?"Absolute":"Relative"," Scale")));for(var u=0,l=["x","y","z"];u<l.length;u++){var c=l[u],h=void 0;h=o?i.getPositionOffset():i.getPosition();var f=void 0;"x"===c?f=h.x:"y"===c?f=h.y:"z"===c&&(f=h.z),r.push((0,rr.jsx)(QY,{label:"".concat(o?"":"Relative ","Position ").concat(c.toUpperCase()),value:f,min:-3,max:3,step:.001,onChange:e.positionCallbackGen(c,o)},"".concat(a," ").concat(o?"Absolute":"Relative"," ").concat(c," Position")))}for(var d=.001,p=0,v=["x","y","z","w"];p<v.length;p++){var m=v[p],g=m,y=0,b=void 0,_=1,x=-1;if(b=o?i.getQuaternionOffset():i.getQuaternion(),"Euler"===t){var w=e.props.robot.eulerRotation();if("x"===g)y=w.x;else if("y"===g)y=w.y;else{if("z"!==g){if("w"===g)continue;console.error('Unknown axis "'.concat(g,'"'));continue}y=w.z}"Degree"===n?(y=Mb(y),_=360,x=-360):(_=2*Math.PI,x=2*-Math.PI,d=Math.PI/180*.001)}else if("Quaternion"===t)if("x"===g)y=b.x;else if("y"===g)y=b.y;else if("z"===g)y=b.z;else{if("w"!==g){console.error('Unknown axis "'.concat(g,'"'));continue}y=b.w}r.push((0,rr.jsx)(QY,{label:"".concat(o?"":"Relative ","Rotation ").concat(g.toUpperCase()),value:y,min:x,max:_,step:d,onChange:e.rotationCallbackGen(g,o,t,n)},"".concat(a," ").concat(o?"Absolute":"Relative"," ").concat(m," Rotation")))}}(!0);var o,u=s(this.props.robot.getArticuatedJointMap());try{for(u.s();!(o=u.n()).done;){var l=vr(o.value,2),c=l[0],h=l[1],f=h.minAngle(),d=h.maxAngle(),p=h.angle(),v=Math.PI/180*.001;"Degree"===n&&(f=Mb(f),d=Mb(d),p=Mb(p),v=.001),r.push((0,rr.jsx)(QY,{label:"Joint "+c,min:f,max:d,value:p,step:v,onChange:this.jointAngleCallbackGen(h,n)},"".concat(h.idValue()," Rotation")))}}catch(x2){u.e(x2)}finally{u.f()}return(0,rr.jsxs)("div",{className:"RobotJointsPanel",children:[(0,rr.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,rr.jsxs)("button",{onClick:this.toggleRotType,children:[this.state.rotationType," Rotations "]}),"Euler"===this.state.rotationType&&(0,rr.jsx)("button",{onClick:this.toggleAngleType,children:this.state.angleType})]}),(0,rr.jsx)("div",{children:r})]})}}]),n}(t.Component),W1=function(e){(0,h.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).onAddGroup=r.onAddGroup.bind((0,c.Z)(r)),r.state={updateCnt:0},r}return(0,l.Z)(n,[{key:"update",value:function(){this.setState({updateCnt:(this.state.updateCnt+1)%1e6})}},{key:"onAddGroup",value:function(){this.props.animationManager.addStoredAnimation(new Hb),this.update()}},{key:"render",value:function(){var e,t,n=this.props.robotScene.robots(),r=this.props.robotSceneManager.animationTables(),i=this.props.animationManager.animationGroups(),a="",o="This tab is used to bind animations to objects. You can not do this at a moment because ";0===n.length?a=o+"you need to load in at least one object before you can bind an animation to it.":0===r.length?a=o+"you need to load in at least one animation before you can bind it to an object.":0===i.length&&this.onAddGroup();var u,l=s(Ib(this.props.animationManager.animationGroups()));try{for(l.s();!(u=l.n()).done;){var c,h=vr(u.value,2),f=(h[0],s(Ib(h[1].animations())));try{for(f.s();!(c=f.n()).done;){var d=vr(c.value,2),p=(d[0],d[1]);p.robot()===this.props.robot&&(t=p)}}catch(x2){f.e(x2)}finally{f.f()}}}catch(x2){l.e(x2)}finally{l.f()}return(0,rr.jsx)("div",{className:"AnimationEditor",children:a.length>0?(0,rr.jsx)("label",{children:a}):(0,rr.jsx)("div",{children:(0,rr.jsx)(tJ,{labelValue:"Offset:",value:"".concat(null===(e=t)||void 0===e?void 0:e.offset()),filter:Db,onReturnPressed:function(e){var n,r=parseFloat(e);isNaN(r)||(null===(n=t)||void 0===n||n.setOffset(r))}})})})}}]),n}(t.Component),Z1=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var i;return(0,u.Z)(this,r),(i=n.call(this,e))._table=void 0,i._table=t.createRef(),i}return(0,l.Z)(r,[{key:"render",value:function(){console.log("render");var e,t,n=this.props,r=n.animationManager,i=(n.robotSceneManager,n.robot),a=s(Ib(r.animationGroups()));try{for(a.s();!(t=a.n()).done;){var o,u=vr(t.value,2),l=(u[0],s(Ib(u[1].animations())));try{for(l.s();!(o=l.n()).done;){var c=vr(o.value,2),h=(c[0],c[1]);h.robot()===i&&(e=h)}}catch(x2){l.e(x2)}finally{l.f()}}}catch(x2){a.e(x2)}finally{a.f()}if(void 0!==e){for(var f=e.animationTable().toCSV().slice(0,10),d=0;d<f.length;d++)for(var p=0;p<f[d].length;p++)isNaN(Number(f[d][p]))||(f[d][p]=Number(f[d][p]).toFixed(3));return(0,rr.jsxs)("div",{className:"DataTable",children:[(0,rr.jsx)("span",{children:"Note: The data table only shows the first 10 rows of the data"}),(0,rr.jsx)("table",{children:(0,rr.jsx)("tbody",{children:f.map((function(e,t){return(0,rr.jsx)("tr",{children:e.map((function(e,t){return(0,rr.jsx)("td",{style:{paddingRight:"10px"},children:e})}))},t)}))})})]})}}}]),r}(t.Component),q1=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var i;(0,u.Z)(this,r),(i=n.call(this,e))._panel_resize_observer=void 0,i._graphDiv=void 0,i.data_types=["position","velocity","acceleration","jerk"],i.speci_property_types=["x","y","z","angle"],i.selectedOptions=[],i.dropdownRef=[];i.props.robotSceneManager;i.state={counter:0,panelHeight:620,panelWidth:1200,dropdowns:[!1,!1],currDataType:i.data_types[0],currSpeciProperty:i.speci_property_types[0],need_update:!0,show_data:!1},i._graphDiv=(0,t.createRef)();for(var a=0;a<2;a++)i.dropdownRef[a]=(0,t.createRef)();return i.onShowRobot=i.onShowRobot.bind((0,c.Z)(i)),i.onOpacityChange=i.onOpacityChange.bind((0,c.Z)(i)),i}return(0,l.Z)(r,[{key:"booleanSum",value:function(e){var t,n=0,r=s(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n+=Number(i)}}catch(x2){r.e(x2)}finally{r.f()}return n}},{key:"componentDidUpdate",value:function(e){}},{key:"deselectDropdowns",value:function(e){this.state.dropdowns[e]=!1,void 0!=this.dropdownRef[e+1]&&this.dropdownRef[e+1].current.setValue(this.dropdownRef[e+1].current.state.prevProps.placeholder)}},{key:"selectDropdowns",value:function(e){this.state.dropdowns[e]=!0}},{key:"onChangeProperty",value:function(e){this.deselectDropdowns(0);var t=e.value;t&&(this.setState({currDataType:t}),this.selectDropdowns(0))}},{key:"onChangeSpeciProperty",value:function(e){this.state.dropdowns[1]=!1;var t=e.value;if(t){this.setState({currSpeciProperty:t}),this.selectDropdowns(1);var n=this.state.currDataType;this.onUpdate(n,t)}}},{key:"onUpdate",value:function(e,t){for(var n=0;n<2;n++)if(!this.state.dropdowns[n])throw new Error("".concat(n," Not every dropdown is selected. Need to select all dropdowns to show the graph"));console.log("on Update")}},{key:"decomposeEventName",value:function(e){var t=vr(e.split("&"),4),n=t[0],r=t[1],i=t[2],a=t[3],o=vr(n.split("#"),2);return[o[0],o[1],r,i,a]}},{key:"onShowRobot",value:function(e){var t=this.props.robotSceneManager.currRobotScene();if(void 0!==t){var n=t.selectedRobot();void 0!==n&&(n.setVisible(e.currentTarget.checked),lr.updateUI())}}},{key:"onOpacityChange",value:function(e){var t=e.currentTarget.valueAsNumber;if(t){var n=this.props.robotSceneManager.currRobotScene();if(void 0===n)return;var r=n.selectedRobot();if(void 0===r)return;r.setOpacity(t),this.forceUpdate()}}},{key:"onShowData",value:function(){this.setState({show_data:!this.state.show_data})}},{key:"render",value:function(){var e=this.props.robotSceneManager.currRobotScene();if(void 0===e)return(0,rr.jsx)("div",{className:"RobotOptionPanel",children:"This tab is for selecting which robot (if any) you would like. You do not have an robot selected currently, so this cannot be done. Please select an robot."},Cb(4));var t=e.selectedRobot();if(void 0===t)return(0,rr.jsx)("div",{className:"RobotOptionPanel",children:"This tab is for selecting which robot (if any) you would like. You do not have an robot selected currently, so this cannot be done. Please select an robot."},Cb(4));var n=t.opacity();return(0,rr.jsxs)("div",{className:"RobotOptionPanel",ref:this._graphDiv,children:[(0,rr.jsxs)("div",{className:"PopUpGroup",children:[(0,rr.jsx)(tJ,{labelValue:"Name:",value:t.name(),onReturnPressed:function(e){t.setName(e)}}),(0,rr.jsx)("button",{id:"open-popup",className:"OpenPop",onClick:function(){return lr.setPopupHelpPage(Xn.RobotOptionPanel)},children:(0,rr.jsx)(qn,{className:"Icon",icon:$n})})]}),(0,rr.jsx)(MK,{allowZeroExpanded:!0,allowMultipleExpanded:!0,children:(0,rr.jsxs)(IK,{children:[(0,rr.jsx)(JK,{children:(0,rr.jsx)(YK,{style:{fontWeight:"bold"},children:"Robot Appearance"})}),(0,rr.jsx)($K,{children:(0,rr.jsx)("div",{className:"RobotSelectorPanel",children:(0,rr.jsxs)("div",{className:"RobotPanel",style:{marginBottom:"10px"},children:[(0,rr.jsx)(IJ,{label:"Show Object",checked:t.visible(),onChange:this.onShowRobot}),(0,rr.jsxs)("div",{children:[(0,rr.jsx)("div",{children:(0,rr.jsxs)("label",{children:["Robot Opacity: ",n]})}),(0,rr.jsx)("div",{children:(0,rr.jsx)("input",{type:"range",min:-.01,step:.01,max:1,value:n,onChange:this.onOpacityChange})})]})]})})})]})}),(0,rr.jsx)(MK,{allowZeroExpanded:!0,allowMultipleExpanded:!0,children:(0,rr.jsxs)(IK,{children:[(0,rr.jsx)(JK,{children:(0,rr.jsx)(YK,{style:{fontWeight:"bold"},children:"Edit Object Positions/Robot Joints"})}),(0,rr.jsx)($K,{children:(0,rr.jsx)(H1,{robotScene:e,robot:t})})]})}),(0,rr.jsx)(MK,{allowZeroExpanded:!0,allowMultipleExpanded:!0,children:(0,rr.jsxs)(IK,{children:[(0,rr.jsx)(JK,{children:(0,rr.jsx)(YK,{style:{fontWeight:"bold"},children:"Edit Motion Data"})}),(0,rr.jsx)($K,{children:(0,rr.jsxs)("div",{children:[(0,rr.jsx)(W1,{robotScene:e,animationManager:this.props.animationManager,robotSceneManager:this.props.robotSceneManager,robot:t}),(0,rr.jsx)("button",{onClick:this.onShowData.bind(this),style:{marginTop:"1rem"},children:"show raw data"}),this.state.show_data&&(0,rr.jsx)(Z1,{robotScene:e,animationManager:this.props.animationManager,robotSceneManager:this.props.robotSceneManager,robot:t})]})})]})})]})}}]),r}(t.Component),X1=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var i;(0,u.Z)(this,r),(i=n.call(this,e))._panel_resize_observer=void 0,i._graphDiv=void 0,i.times=void 0,i.values=void 0,i.clickHandler=function(){var e,t=document.querySelectorAll(".RobotCanvasCanvas");t.forEach((function(e){return e.classList.remove("selected")})),(t=document.querySelectorAll(".GraphPanel")).forEach((function(e){return e.classList.remove("selected")})),null===(e=i._graphDiv.current)||void 0===e||e.classList.add("selected"),i.props.setGraphOptionPanelActive(),i.props.robotSceneManager.setCurrGraph(i.props.graph.id())},i.fillGraphData.bind((0,c.Z)(i));var a=i.props.robotSceneManager;return i.state={counter:0,zoomed_times:[],zoomed_values:[],prev_times:{start:a.currStartTime(),end:a.currEndTime(),curr:a.currTime()},show_zoomed:!1,line_names:[],line_ids:[],color_map:new Map,refresh:!1,clear:!1,currScene:void 0,panelHeight:200,panelWidth:300,need_update:!0,graph_update:!1},i.times=[],i.values=[],i._graphDiv=(0,t.createRef)(),i}return(0,l.Z)(r,[{key:"onGraphUpdate",value:function(e){var t=this.state.graph_update;return e?(this.setState({graph_update:!1}),!1):t}},{key:"interpolate",value:function(e,t,n,r,i){if(n===e)return i;var a=(t-e)/(n-e);return a*i+(1-a)*r}},{key:"fillGraphData",value:function(e,t,n){console.log("fill graph data is called");var r=this.state,i=(r.zoomed_times,r.zoomed_values,r.refresh,r.clear),a=(r.show_zoomed,this.props.robotScene),o=this.props.robotSceneManager,u=this.times,l=this.values;if(i)return u=[],l=[],this.times=u,this.values=l,void this.setState({zoomed_times:[],zoomed_values:[],line_names:[],line_ids:[],clear:!1,need_update:!1});var c=[],h=[],f=[],d=[],p=new Map;if(this.props.isTimeWarp){var v;if(void 0===a)return;var m=null===(v=a.timeWarping())||void 0===v?void 0:v.timeWarpMap(),g=o.startTime(),y=o.endTime();m&&2===m.length?(c.push(m[0].concat()),h.push(m[1].concat())):(c.push([g,y]),h.push([g,y]));var b,_=[],x=s(c[0]);try{for(x.s();!(b=x.n()).done;){var w=b.value;_.push(this.interpolate(g,w,y,g,y))}}catch(x2){x.e(x2)}finally{x.f()}c.push(c[0]),h.push(_),f=["time warp","reference"],d=["warp","ref"],p.set("time warp","#99f"),p.set("reference","green"),u=[],l=[],this.times=c,this.values=h,this.setState({zoomed_times:[],zoomed_values:[],prev_times:{start:o.currStartTime(),end:o.currEndTime(),curr:o.currTime()},line_names:f,line_ids:d,color_map:p,need_update:!1}),this.props.graph.setLineNames(f),this.props.graph.setLineIds(d);for(var S=[],M=0,k=f;M<k.length;M++){var T=k[M];S.push(p.get(T))}this.props.graph.setLineColors(S)}else;}},{key:"componentWillUnmount",value:function(){this._panel_resize_observer&&this._panel_resize_observer.disconnect()}},{key:"componentDidMount",value:function(){var e=this;this._panel_resize_observer=new ResizeObserver((function(t){e.setState({panelWidth:t[0].contentRect.width,panelHeight:.85*t[0].contentRect.height})})),this._graphDiv&&this._graphDiv.current&&this._panel_resize_observer.observe(this._graphDiv.current),this.fillGraphData()}},{key:"componentDidUpdate",value:function(e){var t=this.state,n=t.prev_times,r=t.refresh,i=t.clear,a=t.need_update,o=n.start!==this.props.robotSceneManager.currStartTime()||n.end!==this.props.robotSceneManager.currEndTime(),s=n.curr!==this.props.robotSceneManager.currTime();o&&this.setState({prev_times:{start:this.props.robotSceneManager.currStartTime(),end:this.props.robotSceneManager.currEndTime(),curr:this.props.robotSceneManager.currTime()}}),(s||r||i||a)&&this.fillGraphData(o,s),this.props.force_update!==e.force_update&&this.setState({need_update:!0}),this.props.robotSceneManager.getCurrGraph(),this.props.graph}},{key:"onCurrTimeChange",value:function(e){e<=this.props.robotSceneManager.currEndTime()&&e>=this.props.robotSceneManager.currStartTime()&&this.props.robotSceneManager.setCurrTime(e)}},{key:"onStartTimeChange",value:function(e){this.props.robotSceneManager.currTime()<e&&this.props.robotSceneManager.setCurrTime(e),this.props.robotSceneManager.currEndTime()>=e&&this.props.robotSceneManager.setCurrStartTime(e)}},{key:"onEndTimeChange",value:function(e){this.props.robotSceneManager.currTime()>e&&this.props.robotSceneManager.setCurrTime(e),this.props.robotSceneManager.currStartTime()<=e&&this.props.robotSceneManager.setCurrEndTime(e)}},{key:"render",value:function(){var e,t=this,n=this.times,r=this.values,i=this.props.robotScene,a=this.state,o=(a.zoomed_times,a.color_map),u=a.prev_times,l=a.panelHeight,c=a.panelWidth,h=a.line_names,f=a.line_ids,d=[],p=s(h);try{for(p.s();!(e=p.n()).done;){var v=e.value;d.push(o.get(v))}}catch(x2){p.e(x2)}finally{p.f()}var m=this.props.robotSceneManager.getCurrGraph()===this.props.graph,g=void 0===i?"Time Warp":i.name();return(0,rr.jsxs)("div",{className:"GraphPanel",ref:this._graphDiv,onClick:this.clickHandler.bind(this),style:{backgroundColor:this.props.graph.backgroundColor(),overflow:"auto"},children:[(0,rr.jsxs)("div",{className:"LegendMessage",children:[(0,rr.jsx)($Y,{buttonValue:"Legend",title:"Click and drag to open the legend",className:"Legend",getParentDockLayout:this.props.getParentDockLayout,onDragStart:function(){return["LineGraphLegend&".concat(Cb(4),"&").concat(t.props.graph.id()),function(e){}]}}),(0,rr.jsx)("button",{id:"open-popup",className:"OpenPop",onClick:function(){return lr.setPopupHelpPage(Xn.TimeWarpedGraphPanel)},children:(0,rr.jsx)(qn,{className:"Icon",icon:$n})})]}),(0,rr.jsx)(O1,{times:n,vals:r,startTime:u.start,endTime:u.end,currTime:u.curr,isZoom:!1,isDiff:!1,isTimeWarp:!0,line_names:h,line_colors:d,title:g,width:c,height:l,line_ids:f,prev_map:new Map,selected:m,lineWidth:this.props.graph.lineWidth(),axisColor:this.props.graph.axisColor(),onGraphUpdate:this.onGraphUpdate.bind(this),onCurrChange:this.onCurrTimeChange.bind(this),onStartChange:this.onStartTimeChange.bind(this),onEndChange:this.onEndTimeChange.bind(this)})]})}}]),r}(t.Component),Y1=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var i;return(0,u.Z)(this,r),(i=n.call(this,e))._graphDiv=void 0,i._panel_resize_observer=void 0,i.w=void 0,i.h=void 0,i._graphDiv=(0,t.createRef)(),i.drawGraph.bind((0,c.Z)(i)),i.state={margin:{top:20,right:60,bottom:40,left:60},prev_lines:new Map,line_names:i.props.graph.lineNames(),line_ids:i.props.graph.lineIds(),line_colors:i.props.graph.lineColors(),panelHeight:0,panelWidth:294},i.w=0,i.h=0,i}return(0,l.Z)(r,[{key:"componentWillUnmount",value:function(){this._panel_resize_observer&&this._panel_resize_observer.disconnect()}},{key:"componentDidMount",value:function(){var e=this;this._panel_resize_observer=new ResizeObserver((function(t){e.setState({panelWidth:t[0].contentRect.width,panelHeight:t[0].contentRect.height}),e._graphDiv.current&&e._graphDiv.current.children.length>0&&e._graphDiv.current.removeChild(e._graphDiv.current.children[0]);var n=e.drawGraph(t[0].contentRect.width,t[0].contentRect.height);n&&pO(e._graphDiv.current).append("svg").attr("width",e.w).attr("height",e.h).node().appendChild(n)})),this._graphDiv&&this._graphDiv.current&&this._panel_resize_observer.observe(this._graphDiv.current),this._graphDiv.current&&this._graphDiv.current.children.length>0&&this._graphDiv.current.removeChild(this._graphDiv.current.children[0]);var t=this.drawGraph();t&&pO(this._graphDiv.current).append("svg").attr("width",this.w).attr("height",this.h).node().appendChild(t)}},{key:"componentDidUpdate",value:function(e){var t=!Zb().isEqual(new Set(this.state.line_colors),new Set(this.props.graph.lineColors()))||this.state.line_colors.length!==this.props.graph.lineColors().length,n=!Zb().isEqual(new Set(this.state.line_names),new Set(this.props.graph.lineNames()))||this.state.line_names.length!==this.props.graph.lineNames().length;if(t||n){this._graphDiv.current&&this._graphDiv.current.children.length>0&&this._graphDiv.current.removeChild(this._graphDiv.current.children[0]),this.setState({line_names:this.props.graph.lineNames(),line_ids:this.props.graph.lineIds(),line_colors:this.props.graph.lineColors()});var r=this.drawGraph();r&&pO(this._graphDiv.current).append("svg").attr("width",this.w).attr("height",this.h).node().appendChild(r)}}},{key:"createOnClickHandler",value:function(e,t){var n=this;return function(){n.props.graph.setDeleteLine(e,t),n.props.updateLegendState(!0)}}},{key:"drawGraph",value:function(e,t){var n=this,r=this.props.graph,i=r.lineNames(),a=r.lineIds(),o=r.lineColors(),s=this.state,u=(s.margin,s.prev_lines),l=s.panelHeight,c=s.panelWidth,h=void 0===e?c:e,f=void 0===t?l:t,d=h,p=pO(this._graphDiv.current).append("svg").remove().attr("width",h).attr("height",f).append("g"),v=5;v+=18;for(var m=function(e){p.append("circle").attr("fill",o[e]).attr("cx",15).attr("cy",v).attr("r",8);var t=i[e];if(!r.isDiff()&&!r.isTimeWarp()){var s=.99*d-16;p.append("foreignObject").attr("x",0+s).attr("y",v-8).attr("width",15).attr("height",17).attr("class","white-icon").style("cursor","pointer").on("click",n.createOnClickHandler(a[e],o[e])).html('\n  <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512">\n    \x3c!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --\x3e\n    <path d="M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z"/>\n  </svg>\n')}var u=.9*d-16-16,l=20*Math.ceil(7*t.length/u),c=p.append("foreignObject").attr("x",25).attr("y",v-8).attr("width",u).attr("height",l);a[e],c.append("xhtml:div").style("font-weight",600).style("font-size","13px").style("max-width","100%").style("color",o[e]).html('<p style="word-wrap: break-word; margin: 0;">'.concat(t,"</p>")),v+=l+5},g=0;g<i.length;g++)m(g);return this.w=h,this.h=50*(i.length+1)+100,this.setState({prev_lines:u}),p.node()}},{key:"render",value:function(){return(0,rr.jsx)("div",{children:(0,rr.jsx)("div",{className:"Legend",ref:this._graphDiv})})}}]),r}(t.Component),K1=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var i;return(0,u.Z)(this,r),(i=n.call(this,e))._graphDiv=void 0,i._panel_resize_observer=void 0,i.w=void 0,i.h=void 0,i._graphDiv=(0,t.createRef)(),i.drawGraph.bind((0,c.Z)(i)),i.state={margin:{top:20,right:60,bottom:40,left:60},prev_lines:new Map,panelHeight:0,panelWidth:294},i.w=0,i.h=0,i}return(0,l.Z)(r,[{key:"componentWillUnmount",value:function(){this._panel_resize_observer&&this._panel_resize_observer.disconnect()}},{key:"componentDidMount",value:function(){var e=this;this._panel_resize_observer=new ResizeObserver((function(t){e.setState({panelWidth:t[0].contentRect.width,panelHeight:t[0].contentRect.height}),e._graphDiv.current&&e._graphDiv.current.children.length>0&&e._graphDiv.current.removeChild(e._graphDiv.current.children[0]);var n=e.drawGraph(t[0].contentRect.width,t[0].contentRect.height);n&&pO(e._graphDiv.current).append("svg").attr("width",e.w).attr("height",e.h).node().appendChild(n)})),this._graphDiv&&this._graphDiv.current&&this._panel_resize_observer.observe(this._graphDiv.current),this._graphDiv.current&&this._graphDiv.current.children.length>0&&this._graphDiv.current.removeChild(this._graphDiv.current.children[0]);var t=this.drawGraph();t&&pO(this._graphDiv.current).append("svg").attr("width",this.w).attr("height",this.h).node().appendChild(t)}},{key:"componentDidUpdate",value:function(e){if(this.props.robotScene.update()){this._graphDiv.current&&this._graphDiv.current.children.length>0&&this._graphDiv.current.removeChild(this._graphDiv.current.children[0]);var t=this.drawGraph();console.log("width "+this.w+" height "+this.h),t&&pO(this._graphDiv.current).append("svg").attr("width",this.w).attr("height",this.h).node().appendChild(t),this.props.robotScene.setUpdate(!1)}}},{key:"onDeleteTraceHandler",value:function(e){var t=this;return function(){var n=vr(e.split("&"),2),r=n[0],i=n[1],a=vr(r.split("#"),2),o=a[0],s=a[1],u=t.props,l=u.robotScene,c=u.robotSceneManager.robotSceneById(o);if(void 0!==c){var h=c.robotById(s);if(void 0!==h){var f=h.jointMap().get(i);void 0===f&&void 0===(f=h.linkMap().get(i))&&i!==h.name()||(c===l?l.removeChildTrace(h,f):c.removeGhostTracesFrom(h,f,l))}}}}},{key:"onDeleteArrowHandler",value:function(e){var t=this;return function(){t.props.robotScene.removeArrow(e)}}},{key:"getTraceName",value:function(e){var t,n=e.robot(),r=e.robotPart();return(null===(t=n.parentScene())||void 0===t?void 0:t.name())+"_"+n.name()+"_"+(null===r||void 0===r?void 0:r.name())}},{key:"createLineNames",value:function(e,t){var n,r=[],i=[],a=[],o=[],u=[],l=[],c=(this.props.robotScene,s(e));try{for(c.s();!(n=c.n()).done;){var h,f,d,p,v=n.value,m=v.robot(),g=v.robotPart(),y=(null===(h=m.parentScene())||void 0===h?void 0:h.name())+"_"+m.name()+"_"+(null===g||void 0===g?void 0:g.name()),b=(null===(f=m.parentScene())||void 0===f?void 0:f.id().value())+"#"+m.id().value()+"&"+(null===g||void 0===g?void 0:g.name());if(void 0===g)y=(null===(d=m.parentScene())||void 0===d?void 0:d.name())+"_"+m.name()+"_"+m.name(),b=(null===(p=m.parentScene())||void 0===p?void 0:p.id().value())+"#"+m.id().value()+"&"+m.name();var _=v.color();r.push(y),i.push(b),a.push(_)}}catch(x2){c.e(x2)}finally{c.f()}var x,w=s(t);try{for(w.s();!(x=w.n()).done;){var S=x.value,M="From "+this.getTraceName(S.traceFrom())+" to "+this.getTraceName(S.traceTo()),k=S.id(),T=S.color();o.push(M),u.push(k),l.push(T)}}catch(x2){w.e(x2)}finally{w.f()}return[r,i,a,o,u,l]}},{key:"drawGraph",value:function(e,t){var n=this,r=this.props.robotScene,i=this.state,a=(i.margin,i.prev_lines),o=i.panelHeight,s=i.panelWidth,u=r.getAllTraces(),l=r.getAllArrows(),c=vr(this.createLineNames(u,l),6),h=c[0],f=c[1],d=c[2],p=c[3],v=c[4],m=c[5],g=void 0===e?s:e,y=void 0===t?o:t,b=g,_=pO(this._graphDiv.current).append("svg").remove().attr("width",g).attr("height",y).append("g"),x=5;_.append("foreignObject").attr("x",15).attr("y",x).attr("width",50).attr("height",30).append("xhtml:div").style("font-weight",600).style("font-size","13px").style("max-width","100%").style("color","white").html('<p style="word-wrap: break-word; margin: 0;">Traces:</p>');var w=_.append("g").attr("class","context-menu").style("display","none");document.addEventListener("click",(function(){w.style("display","none")}));var S=w.append("g").attr("class","option").style("cursor","pointer").on("click",(function(){console.log("Option 1 clicked")}));S.append("rect").attr("width",140).attr("height",20).attr("fill","white"),S.append("text").attr("x",60).attr("y",10).attr("text-anchor","middle").attr("dominant-baseline","central").style("font-size","12px").style("fill","black").text("Select for compare");var M=w.append("g").attr("class","option").attr("transform","translate(0,".concat(20,")")).style("cursor","pointer").on("click",(function(){console.log("Option 2 clicked")}));M.append("rect").attr("width",140).attr("height",20).attr("fill","white"),M.append("text").attr("x",70).attr("y",10).attr("text-anchor","middle").attr("dominant-baseline","central").style("font-size","12px").style("fill","black").text("Compare with selected");var k='\n  <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512">\n    \x3c!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --\x3e\n    <path d="M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z"/>\n  </svg>\n';x+=30;for(var T=function(e){_.append("circle").attr("fill",d[e]).attr("cx",15).attr("cy",x).attr("r",8);var t=h[e],i=.99*b-16;_.append("foreignObject").attr("x",0+i).attr("y",x-8).attr("width",15).attr("height",17).attr("class","white-icon").style("cursor","pointer").on("click",n.onDeleteTraceHandler(f[e])).html(k);var a,o=.9*b-16-16,s=20*Math.ceil(7*t.length/o),l=_.append("foreignObject").attr("x",25).attr("y",x-8).attr("width",o).attr("height",s);a=u[e],l.append("xhtml:div").style("font-weight",600).style("font-size","13px").style("max-width","100%").style("color",d[e]).html('<p style="word-wrap: break-word; margin: 0;">'.concat(t,"</p>")).on("contextmenu",(function(e){e.preventDefault();var t=_.node().getBoundingClientRect(),n=e.pageX-t.left,i=e.pageY-t.top;w.attr("transform","translate(".concat(n,", ").concat(i,")")),w.style("display","block"),S.on("click",(function(){r.setTraceFrom(a)})),M.on("click",(function(){r.setTraceTo(a)})),_.node().appendChild(w.node())})),x+=s+5},E=0;E<h.length;E++)T(E);l.length>0&&(_.append("foreignObject").attr("x",15).attr("y",x).attr("width",200).attr("height",30).append("xhtml:div").style("font-weight",600).style("font-size","13px").style("max-width","100%").style("color","white").html('<p style="word-wrap: break-word; margin: 0;">Difference between Traces:</p>'),x+=30);for(var C=function(e){_.append("circle").attr("fill",m[e]).attr("cx",15).attr("cy",x).attr("r",8);var t=p[e],r=.99*b-16;_.append("foreignObject").attr("x",0+r).attr("y",x-8).attr("width",15).attr("height",17).attr("class","white-icon").style("cursor","pointer").on("click",n.onDeleteArrowHandler(v[e])).html(k);var i=.9*b-16-16,a=20*Math.ceil(7*t.length/i),o=_.append("foreignObject").attr("x",25).attr("y",x-8).attr("width",i).attr("height",a);l[e],o.append("xhtml:div").style("font-weight",600).style("font-size","13px").style("max-width","100%").style("color",m[e]).html('<p style="word-wrap: break-word; margin: 0;">'.concat(t,"</p>")),x+=a+5},A=0;A<p.length;A++)C(A);return this.w=g,this.h=50*(h.length+p.length+1)+100,this.setState({prev_lines:a}),_.node()}},{key:"render",value:function(){return(0,rr.jsx)("div",{children:(0,rr.jsx)("div",{className:"Legend",ref:this._graphDiv})})}}]),r}(t.Component),J1=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var i;return(0,u.Z)(this,r),(i=n.call(this,e))._panel_resize_observer=void 0,i._quaternionDiv=void 0,i.state={counter:0,update:!1},i._quaternionDiv=(0,t.createRef)(),i}return(0,l.Z)(r,[{key:"componentDidUpdate",value:function(e){}},{key:"onBackgroundColorChange",value:function(e){var t;null===(t=this.props.currQuaternionSpaceScene)||void 0===t||t.setBackgroundColor(e)}},{key:"onLineGroupColorChange",value:function(e){var t;null===(t=this.props.currQuaternionSpaceScene)||void 0===t||t.setLineGroupColor(e)}},{key:"onChangeLineOpacity",value:function(e){var t;null===(t=this.props.currQuaternionSpaceScene)||void 0===t||t.setLineGroupOpacity(e)}},{key:"onCheckWorldFrame",value:function(e){var t;null===(t=this.props.currQuaternionSpaceScene)||void 0===t||t.setWorldFrameObjectVisibility(e.currentTarget.checked),this.setState({update:!this.state.update})}},{key:"render",value:function(){var e=this,t=this.props.currQuaternionSpaceScene;return(0,rr.jsxs)("div",{className:"SceneOptionPanel",ref:this._quaternionDiv,children:[(0,rr.jsxs)("div",{style:{marginBottom:"1rem"},className:"PopUpGroup",children:[(0,rr.jsx)(tJ,{labelValue:"Name:",value:void 0===t?"No Scene":t.name(),onReturnPressed:function(n){void 0!==t&&(t.setName(n),e.props.forceUpdateTabNames())}}),(0,rr.jsx)("button",{id:"open-popup",className:"OpenPop",onClick:function(){return lr.setPopupHelpPage(Xn.QSceneOptionPanel)},children:(0,rr.jsx)(qn,{className:"Icon",icon:$n})})]}),(0,rr.jsxs)("div",{className:"ButtonsContainer",style:{display:"flex",gap:"1rem"},children:[(0,rr.jsx)($Y,{buttonValue:"New Quaternion Space",title:"Click and drag to create a new quaternion space",className:"Legend",getParentDockLayout:this.props.getParentDockLayout,onDragStart:function(){var e=(new Yb).value();return["QuaternionSpaceScene&".concat(e,"&motion"),function(e){}]}}),(0,rr.jsx)($Y,{buttonValue:"Legend",className:"Legend",getParentDockLayout:this.props.getParentDockLayout,onDragStart:function(){var e=void 0===t?Cb(4):t.id().value();return["QuaternionSpaceLegend&".concat(Cb(4),"&").concat(e),function(e){}]}})]}),(0,rr.jsx)("div",{children:(0,rr.jsx)(IJ,{label:"Show World Frame",checked:null===t||void 0===t?void 0:t.isWorldFrameObjectVisible(),onChange:this.onCheckWorldFrame.bind(this)})}),(0,rr.jsx)(QY,{label:"Opacity of Longitude and Latitude: ",min:0,max:1,step:.01,value:null===t||void 0===t?void 0:t.lineGroupOpacity(),onChange:this.onChangeLineOpacity.bind(this)}),(0,rr.jsx)(MK,{allowZeroExpanded:!0,allowMultipleExpanded:!0,children:(0,rr.jsxs)(IK,{children:[(0,rr.jsx)(JK,{children:(0,rr.jsx)(YK,{style:{fontWeight:"bold"},children:"Background Color:"})}),(0,rr.jsx)($K,{children:(0,rr.jsx)(NJ,{color:null===t||void 0===t?void 0:t.backgroundColor(),onChange:function(t){return e.onBackgroundColorChange(t)}})})]})}),(0,rr.jsx)(MK,{allowZeroExpanded:!0,allowMultipleExpanded:!0,children:(0,rr.jsxs)(IK,{children:[(0,rr.jsx)(JK,{children:(0,rr.jsx)(YK,{style:{fontWeight:"bold"},children:"Longitude and Latitude Color:"})}),(0,rr.jsx)($K,{children:(0,rr.jsx)(NJ,{color:null===t||void 0===t?void 0:t.lineGroupColor(),onChange:function(t){return e.onLineGroupColorChange(t)}})})]})})]})}}]),r}(t.Component),Q1=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var i;return(0,u.Z)(this,r),(i=n.call(this,e))._orbitView=void 0,i._orbitCamera=void 0,i._canvasRef=void 0,i._resize_observer=void 0,i._raycaster=void 0,i._pointer=void 0,i._syncViewCallback=void 0,i._orbitCamera=new cb.PerspectiveCamera(50,window.innerWidth/window.innerHeight,.001,1e3),i._orbitCamera.position.set(2,2,2),i._orbitCamera.lookAt(0,0,0),i._orbitCamera.up.set(0,0,1),i._raycaster=new cb.Raycaster,i.onCanvasMouseDown=i.onCanvasMouseDown.bind((0,c.Z)(i)),i._pointer=new cb.Mesh(new cb.SphereGeometry(.01,30,30),new cb.MeshBasicMaterial({transparent:!0,opacity:.75,color:new cb.Color(16777215*Math.random())})),i._canvasRef=t.createRef(),i.initScene(i.props.quaternionSpaceScene),i}return(0,l.Z)(r,[{key:"canSelectRobot",value:function(){var e;return null!==(e=this.props.allowSelecting)&&void 0!==e&&e&&this.props.robotSceneManager.allowRobotSelection()}},{key:"addPointer",value:function(e,t){if(this.props.allowSelecting){var n=e.scene();-1===n.children.indexOf(this._pointer)&&n.add(this._pointer),this._pointer.position.copy(t),e.render()}}},{key:"removePointer",value:function(e){var t=e.scene();-1!==t.children.indexOf(this._pointer)&&(t.remove(this._pointer),e.render())}},{key:"initScene",value:function(e){e.runOnce(sr.INIT,(function(){e.scene().background=new cb.Color(e.backgroundColor()),e.scene().position.set(0,0,0);var t=16777215,n=new cb.DirectionalLight(t,1);n.castShadow=!0,n.shadow.mapSize.setScalar(1024),n.position.set(5,5,30),n.shadow.bias=-5e-4,n.lookAt(0,0,0),e.scene().add(n);var r=new cb.AmbientLight(t,.2);e.scene().add(r);var i=new cb.Mesh(new cb.PlaneBufferGeometry,new cb.ShadowMaterial({opacity:.25}));i.scale.setScalar(30),i.receiveShadow=!0,e.scene().add(i)}))}},{key:"onCanvasMouseDown",value:function(){var e,t=document.querySelectorAll(".RobotCanvasCanvas");t.forEach((function(e){return e.classList.remove("selected")})),(t=document.querySelectorAll(".GraphPanel")).forEach((function(e){return e.classList.remove("selected")})),null===(e=this._canvasRef.current)||void 0===e||e.classList.add("selected"),this.props.robotSceneManager.setCurrQuaternionSpaceScene(this.props.quaternionSpaceScene.id().value()),this.props.setQuaternionSceneOptionPanelActive()}},{key:"mount",value:function(e,t){var n=this;if(t){this.initScene(e);var r=new D1(this._orbitCamera,t),i=r.update.bind(r);r.update=function(){var t=i();return n.props.robotSceneManager.setCurrSyncViewpoint([n._orbitCamera.getWorldPosition(new cb.Vector3),(new cb.Quaternion).setFromEuler(n._orbitCamera.rotation)]),e.render(),t},r.target.y=0,r.enableDamping=!0,r.dampingFactor=.5,r.rotateSpeed=.5,r.update(),this._syncViewCallback&&(this.props.robotSceneManager.removeSyncViewCallback(this._syncViewCallback),this._syncViewCallback=void 0),this._syncViewCallback=function(e){var t=vr(e,2),r=t[0],i=t[1];n._orbitCamera.position.copy(r),n._orbitCamera.rotation.setFromQuaternion(i),n.props.quaternionSpaceScene.render()},this._orbitView=new A1(t,this._orbitCamera,(function(e){var t=Math.floor(e.clientWidth),n=Math.floor(e.clientHeight);e.width===t&&e.height===n||(e.width=t,e.height=n)})),e.addView(this._orbitView),e.render(),t.addEventListener("click",this.onCanvasMouseDown),this._resize_observer&&this._resize_observer.unobserve(t),this._resize_observer=new ResizeObserver((function(){n.props.quaternionSpaceScene.render()})),this._resize_observer.observe(t)}}},{key:"unmount",value:function(e,t){var n;(this._syncViewCallback&&(this.props.robotSceneManager.removeSyncViewCallback(this._syncViewCallback),this._syncViewCallback=void 0),this._orbitView&&(e.removeView(this._orbitView),this._orbitView=void 0),t)&&(t.removeEventListener("click",this.onCanvasMouseDown),null===(n=this._resize_observer)||void 0===n||n.unobserve(t));this.removePointer(e)}},{key:"componentDidUpdate",value:function(e){e.quaternionSpaceScene!==this.props.quaternionSpaceScene&&(this.unmount(e.quaternionSpaceScene,this._canvasRef.current),this.mount(this.props.quaternionSpaceScene,this._canvasRef.current))}},{key:"componentDidMount",value:function(){var e,t=document.querySelectorAll(".RobotCanvasCanvas");t.forEach((function(e){return e.classList.remove("selected")})),(t=document.querySelectorAll(".GraphPanel")).forEach((function(e){return e.classList.remove("selected")})),null===(e=this._canvasRef.current)||void 0===e||e.classList.add("selected"),this.mount(this.props.quaternionSpaceScene,this._canvasRef.current)}},{key:"componentWillUnmount",value:function(){this.unmount(this.props.quaternionSpaceScene,this._canvasRef.current)}},{key:"decomposeId",value:function(e){var t=vr(e.split("&"),2),n=t[0],r=t[1],i=vr(n.split("#"),2);return[i[0],i[1],r]}},{key:"dragOverHandler",value:function(e){e.preventDefault()}},{key:"dropHandler",value:function(e){e.preventDefault();var t=e.dataTransfer.getData("text/plain"),n=vr(this.decomposeId(t),3),r=n[0],i=n[1],a=n[2],o=this.props.robotSceneManager.robotSceneById(r);if(void 0!==o){this.props.robotSceneManager.isActiveRobotScene(o)||this.props.robotSceneManager.activateRobotScene(o);var s=o.getRobotByName(i);if(void 0!==s){var u=this.props.quaternionSpaceScene;if(void 0!==a){var l=s.jointMap().get(a);void 0===l&&(l=s.linkMap().get(a)),u.hasChildTrace(s,l)||u.addChildTrace(o,s,YU.frameRange(this.props.robotSceneManager.startTime(),this.props.robotSceneManager.endTime()),l)}}}}},{key:"render",value:function(){return(0,rr.jsx)("div",{className:"RobotCanvas",onDrop:this.dropHandler.bind(this),onDragOver:this.dragOverHandler.bind(this),children:(0,rr.jsx)("canvas",{className:"RobotCanvasCanvas",ref:this._canvasRef})})}}]),r}(t.Component),$1=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var i;return(0,u.Z)(this,r),(i=n.call(this,e))._graphDiv=void 0,i._panel_resize_observer=void 0,i.w=void 0,i.h=void 0,i._graphDiv=(0,t.createRef)(),i.drawGraph.bind((0,c.Z)(i)),i.state={margin:{top:20,right:60,bottom:40,left:60},prev_lines:new Map,panelHeight:0,panelWidth:294},i.w=0,i.h=0,i}return(0,l.Z)(r,[{key:"componentWillUnmount",value:function(){this._panel_resize_observer&&this._panel_resize_observer.disconnect()}},{key:"componentDidMount",value:function(){var e=this;this._panel_resize_observer=new ResizeObserver((function(t){e.setState({panelWidth:t[0].contentRect.width,panelHeight:t[0].contentRect.height}),e._graphDiv.current&&e._graphDiv.current.children.length>0&&e._graphDiv.current.removeChild(e._graphDiv.current.children[0]);var n=e.drawGraph(t[0].contentRect.width,t[0].contentRect.height);n&&pO(e._graphDiv.current).append("svg").attr("width",e.w).attr("height",e.h).node().appendChild(n)})),this._graphDiv&&this._graphDiv.current&&this._panel_resize_observer.observe(this._graphDiv.current),this._graphDiv.current&&this._graphDiv.current.children.length>0&&this._graphDiv.current.removeChild(this._graphDiv.current.children[0]);var t=this.drawGraph();t&&pO(this._graphDiv.current).append("svg").attr("width",this.w).attr("height",this.h).node().appendChild(t)}},{key:"componentDidUpdate",value:function(e){if(this.props.quaternionSpaceScene.update()){this._graphDiv.current&&this._graphDiv.current.children.length>0&&this._graphDiv.current.removeChild(this._graphDiv.current.children[0]);var t=this.drawGraph();t&&pO(this._graphDiv.current).append("svg").attr("width",this.w).attr("height",this.h).node().appendChild(t),this.props.quaternionSpaceScene.setUpdate(!1)}}},{key:"onDeleteTraceHandler",value:function(e){var t=this;return function(){var n=vr(e.split("&"),2),r=n[0],i=n[1],a=vr(r.split("#"),2),o=a[0],s=a[1],u=t.props,l=u.quaternionSpaceScene,c=u.robotSceneManager.robotSceneById(o);if(void 0!==c){var h=c.robotById(s);if(void 0!==h){var f=h.jointMap().get(i);void 0===f&&void 0===(f=h.linkMap().get(i))&&i!==h.name()||l.removeChildTrace(h,f)}}}}},{key:"getTraceName",value:function(e){var t,n=e.robot(),r=e.robotPart();return(null===(t=n.parentScene())||void 0===t?void 0:t.name())+"_"+n.name()+"_"+(null===r||void 0===r?void 0:r.name())}},{key:"createLineNames",value:function(e){var t,n=[],r=[],i=[],a=(this.props.quaternionSpaceScene,s(e));try{for(a.s();!(t=a.n()).done;){var o,u,l,c,h=t.value,f=h.robot(),d=h.robotPart(),p=(null===(o=f.parentScene())||void 0===o?void 0:o.name())+"_"+f.name()+"_"+(null===d||void 0===d?void 0:d.name()),v=(null===(u=f.parentScene())||void 0===u?void 0:u.id().value())+"#"+f.id().value()+"&"+(null===d||void 0===d?void 0:d.name());if(void 0===d)p=(null===(l=f.parentScene())||void 0===l?void 0:l.name())+"_"+f.name()+"_"+f.name(),v=(null===(c=f.parentScene())||void 0===c?void 0:c.id().value())+"#"+f.id().value()+"&"+f.name();var m=h.color();n.push(p),r.push(v),i.push(m)}}catch(x2){a.e(x2)}finally{a.f()}return[n,r,i]}},{key:"drawGraph",value:function(e,t){var n=this,r=this.props.quaternionSpaceScene,i=this.state,a=(i.margin,i.prev_lines),o=i.panelHeight,s=i.panelWidth,u=r.getAllTraces(),l=vr(this.createLineNames(u),3),c=l[0],h=l[1],f=l[2],d=void 0===e?s:e,p=void 0===t?o:t,v=d,m=pO(this._graphDiv.current).append("svg").remove().attr("width",d).attr("height",p).append("g"),g=5;m.append("foreignObject").attr("x",15).attr("y",g).attr("width",50).attr("height",30).append("xhtml:div").style("font-weight",600).style("font-size","13px").style("max-width","100%").style("color","white").html('<p style="word-wrap: break-word; margin: 0;">Traces:</p>');var y=m.append("g").attr("class","context-menu").style("display","none");document.addEventListener("click",(function(){y.style("display","none")}));var b=y.append("g").attr("class","option").style("cursor","pointer").on("click",(function(){console.log("Option 1 clicked")}));b.append("rect").attr("width",80).attr("height",20).attr("fill","white"),b.append("text").attr("x",40).attr("y",10).attr("text-anchor","middle").attr("dominant-baseline","central").style("font-size","12px").style("fill","black").text("Flip Trace");g+=30;for(var _=function(e){m.append("circle").attr("fill",f[e]).attr("cx",15).attr("cy",g).attr("r",8);var t=c[e],r=.99*v-16;m.append("foreignObject").attr("x",0+r).attr("y",g-8).attr("width",15).attr("height",17).attr("class","white-icon").style("cursor","pointer").on("click",n.onDeleteTraceHandler(h[e])).html('\n  <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512">\n    \x3c!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --\x3e\n    <path d="M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z"/>\n  </svg>\n');var i,a=.9*v-16-16,o=20*Math.ceil(7*t.length/a),s=m.append("foreignObject").attr("x",25).attr("y",g-8).attr("width",a).attr("height",o);i=u[e],s.append("xhtml:div").style("font-weight",600).style("font-size","13px").style("max-width","100%").style("color",f[e]).html('<p style="word-wrap: break-word; margin: 0;">'.concat(t,"</p>")).on("contextmenu",(function(e){e.preventDefault();var t=m.node().getBoundingClientRect(),n=e.pageX-t.left,r=e.pageY-t.top;y.attr("transform","translate(".concat(n,", ").concat(r,")")),y.style("display","block"),b.on("click",(function(){i.flipTrace()})),m.node().appendChild(y.node())})),g+=o+5},x=0;x<c.length;x++)_(x);return this.w=d,this.h=50*(c.length+1)+100,this.setState({prev_lines:a}),m.node()}},{key:"render",value:function(){return(0,rr.jsx)("div",{children:(0,rr.jsx)("div",{className:"Legend",ref:this._graphDiv})})}}]),r}(t.Component),e2=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var i;return(0,u.Z)(this,r),(i=n.call(this,e))._panel_resize_observer=void 0,i._graphDiv=void 0,i.state={counter:0,panelHeight:620,panelWidth:1200,currRobot:new Map,need_update:!0},i._graphDiv=(0,t.createRef)(),i}return(0,l.Z)(r,[{key:"componentDidUpdate",value:function(e){}},{key:"onChangeLineWidth",value:function(e){var t;null===(t=this.props.robotSceneManager.getCurrUmapGraph())||void 0===t||t.setLineWidth(e)}},{key:"onBackgroundColorChange",value:function(e){var t;null===(t=this.props.robotSceneManager.getCurrUmapGraph())||void 0===t||t.setBackgroundColor(e),this.props.forceUpdateTabNames()}},{key:"onAxisColorChange",value:function(e){var t;null===(t=this.props.robotSceneManager.getCurrUmapGraph())||void 0===t||t.setAxisColor(e),this.props.forceUpdateTabNames()}},{key:"render",value:function(){var e=this,t=this.props.currSelectedGraph;return(0,rr.jsxs)("div",{className:"GraphOptionPanel",ref:this._graphDiv,children:[(0,rr.jsxs)("div",{style:{marginBottom:"5px"},className:"PopUpGroup",children:[(0,rr.jsx)(tJ,{labelValue:"Name:",value:void 0===t?"No Umap Graph":t.name(),onReturnPressed:function(n){void 0!==t&&(t.setName(n),e.props.forceUpdateTabNames())}}),(0,rr.jsx)("button",{id:"open-popup",className:"OpenPop",onClick:function(){return lr.setPopupHelpPage(Xn.UmapGraphOptionPanel)},children:(0,rr.jsx)(qn,{className:"Icon",icon:$n})})]}),(0,rr.jsx)("div",{className:"ButtonsContainer",children:(0,rr.jsx)($Y,{buttonValue:"New Umap Graph",title:"Click and drag to create a new Umap Graph",getParentDockLayout:this.props.getParentDockLayout,onDragStart:function(){var e=Cb(4);return["UmapGraph&".concat(e,"&motion"),function(e){}]}})}),(0,rr.jsxs)("div",{children:[(0,rr.jsx)(QY,{label:"Line width: ",min:.1,max:10,step:.1,value:null===t||void 0===t?void 0:t.lineWidth(),onChange:this.onChangeLineWidth.bind(this)}),(0,rr.jsx)(MK,{allowZeroExpanded:!0,allowMultipleExpanded:!0,children:(0,rr.jsxs)(IK,{children:[(0,rr.jsx)(JK,{children:(0,rr.jsx)(YK,{style:{fontWeight:"bold"},children:"Background Color:"})}),(0,rr.jsx)($K,{children:(0,rr.jsx)(NJ,{color:null===t||void 0===t?void 0:t.backgroundColor(),onChange:function(t){return e.onBackgroundColorChange(t)}})})]})}),(0,rr.jsx)(MK,{allowZeroExpanded:!0,allowMultipleExpanded:!0,children:(0,rr.jsxs)(IK,{children:[(0,rr.jsx)(JK,{children:(0,rr.jsx)(YK,{style:{fontWeight:"bold"},children:"Axis Color:"})}),(0,rr.jsx)($K,{children:(0,rr.jsx)(NJ,{color:null===t||void 0===t?void 0:t.axisColor(),onChange:function(t){return e.onAxisColorChange(t)}})})]})})]})]})}}]),r}(t.Component),t2=n(1842),n2=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var i;(0,u.Z)(this,r),(i=n.call(this,e))._graphDiv=void 0,i._graphDiv=(0,t.createRef)(),i.drawGraph.bind((0,c.Z)(i));var a=i.props;a.width,a.height;return i.state={prev_x:null,prev_y:null,margin:{top:0,right:10,bottom:20,left:10},time_min:-999,time_max:-999,val_concat:[],newCurr:i.props.currTime,mouseXCoord:-1,originalMouseXCoord:-1,currDragItem:null},i}return(0,l.Z)(r,[{key:"componentDidMount",value:function(){this._graphDiv.current&&this._graphDiv.current.children.length>0&&this._graphDiv.current.removeChild(this._graphDiv.current.children[0]);var e=this.props,t=e.height,n=e.width,r=this.drawGraph(!0,!0);r&&pO(this._graphDiv.current).append("svg").attr("width",n).attr("height",t).node().appendChild(r)}},{key:"componentDidUpdate",value:function(e){var t=e.startTime!==this.props.startTime||e.endTime!==this.props.endTime,n=!Zb().isEqual(new Set(e.line_colors),new Set(this.props.line_colors))&&e.line_colors.length===this.props.line_colors.length,r=e.height!==this.props.height||e.width!==this.props.width,i=e.currTime!==this.props.currTime,a=e.lineWidth!==this.props.lineWidth,o=e.axisColor!==this.props.axisColor;if(e.times!==this.props.times||e.xVals!==this.props.xVals||r||n||a||o||t||i){this._graphDiv.current&&this._graphDiv.current.children.length>0&&this._graphDiv.current.removeChild(this._graphDiv.current.children[0]);var s=this.props,u=s.width,l=s.height,c=this.drawGraph(t,n,r);c&&pO(this._graphDiv.current).append("svg").attr("width",u).attr("height",l).node().appendChild(c)}}},{key:"filterData",value:function(e,t){var n=[],r=[],i=[],a=this.props,o=a.times,s=a.xVals,u=a.yVals;if(0===o.length)return[[[0]],[[0]],[[0]]];for(var l=0;l<o.length;l++){var c=0;n[l]=[],r[l]=[],i[l]=[];var h=bb(o[l],e),f=yb(o[l],t);void 0===h&&(h=0),void 0===f&&(f=o[l].length-1);for(var d=h;d<f;d++)n[l][c]=o[l][d],r[l][c]=s[l][d],i[l][c]=u[l][d],c++}return[n,r,i]}},{key:"parseData",value:function(e,t){for(var n=[],r=0;r<e.length;r++)n.push({x:e[r],y:t[r]});return n}},{key:"concatData",value:function(e){for(var t=[],n=0;n<e.length;n++)t=t.concat(e[n]);return t}},{key:"calculateOffset",value:function(e,t,n,r){return n===t?0:(r-t)/(n-t)*e}},{key:"getCurrTimeIndex",value:function(e,t){return vb(e,t)}},{key:"getCurrCoordinate",value:function(e,t,n,r,i){var a=e,o=e+1;if(o>=t.length)return[t[t.length-1],n[t.length-1]];if(-1===a)return[t[0],n[0]];var s=function(e,t,n){return e*(1-n)+t*n},u=(r-i[a])/(i[o]-i[a]);return[s(t[a],t[o],u),s(n[a],n[o],u)]}},{key:"currMouse",value:function(e){this.setState({originalMouseXCoord:e.x})}},{key:"endMouse",value:function(e){this.setState({mouseXCoord:-1,originalMouseXCoord:-1})}},{key:"calculateDistance",value:function(e,t){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))}},{key:"filterDataByDistance",value:function(e){var t=[];if(0==e.length)return t;var n=[];n.push(e[0]);for(var r=1;r<e.length;r++)this.calculateDistance(e[r],e[r-1])<=2?n.push(e[r]):(t.push(n),(n=[]).push(e[r]));return n.length>0&&t.push(n),t}},{key:"drawGraph",value:function(e,t,n){for(var r=this.props,i=r.times,a=r.xVals,o=r.yVals,u=r.startTime,l=r.endTime,c=r.currTime,h=r.isTimeWarp,f=r.lineWidth,d=r.axisColor,p=(r.line_names,r.line_colors),v=r.line_ids,m=r.onGraphUpdate,g=this.props.width,y=this.props.height,b=this.state,_=b.margin,x=(b.prev_x,b.prev_y,g-_.left-_.right),w=y-_.top-_.bottom,S=pO(this._graphDiv.current).append("svg").remove().attr("width",x+_.left+_.right).attr("height",w+_.top+_.bottom).append("g").attr("transform","translate(".concat(_.left,",     ").concat(_.top,")")),M=vr(this.filterData(u,l),3),k=(M[0],M[1]),T=M[2],E=[this.parseData(k[0],T[0])],C=1;C<k.length;C++)E.push(this.parseData(k[C],T[C])),console.log(C+" "+E[C].length);for(var A,R,P=this.concatData(k),L=this.concatData(T),D=0;D<a.length;D++){var N=this.getCurrTimeIndex(i[D],c),I=vr(this.getCurrCoordinate(N,a[D],o[D],c,i[D]),2),O=I[0],U=I[1],F=this.calculateOffset(x,JP(P),KP(P),O),z=this.calculateOffset(w,JP(L),KP(L),U);S.append("circle").attr("cx",F).attr("cy",w-z).attr("r",4).attr("fill","#b00").attr("fill-opacity","75%")}m(!1),A=CU().range([0,x]).domain(YP(P)),R=CU().range([w,0]).domain(YP(L));var B,V=sL(A).tickSize(0).tickValues([]),G=uL(R).tickSize(0).tickValues([]),j=(B=A,oL(1,B)).tickSize(0).tickValues([]),H=function(e){return oL(2,e)}(R).tickSize(0).tickValues([]),W=S.append("g").attr("transform","translate(0, ".concat(w,")")).classed("GraphAxis",!0).call(V),Z=S.append("g").classed("GraphAxis",!0).call(G),q=S.append("g").classed("GraphAxis",!0).call(j),X=S.append("g").attr("transform","translate(".concat(x,", 0)")).classed("GraphAxis",!0).call(H);W.selectAll("line, path").style("stroke",d),Z.selectAll("line, path").style("stroke",d),q.selectAll("line, path").style("stroke",d),X.selectAll("line, path").style("stroke",d);var Y=WU().x((function(e){return A(e.x)})).y((function(e){return R(e.y)}));if(h){var K=S.append("path").remove().append("path").data([E[1]]).attr("class","line").attr("fill","none").attr("stroke",p[1]).attr("stroke-width",f).attr("d",Y).node();S.node().appendChild(K);var J=S.append("path").remove().append("path").data([E[0]]).attr("class","line").attr("fill","none").attr("stroke",p[0]).attr("stroke-width",f).attr("d",Y).node();S.node().appendChild(J)}else for(var Q=0;Q<E.length;Q++){v[Q];var $,ee=s(this.filterDataByDistance(E[Q]));try{for(ee.s();!($=ee.n()).done;){var te=$.value,ne=S.append("path").remove().append("path").data([te]).attr("class","line").attr("fill","none").attr("stroke",p[Q]).attr("stroke-width",f).attr("d",Y).node();S.node().appendChild(ne)}}catch(x2){ee.e(x2)}finally{ee.f()}}return this.setState({prev_x:A,prev_y:R}),m(!0),S.node()}},{key:"render",value:function(){var e=this.props;e.isTimeWarp,e.times,e.selected,e.axisColor;return(0,rr.jsxs)("div",{children:[(0,rr.jsx)("div",{style:{textAlign:"center"}}),(0,rr.jsx)("div",{className:"UmapGraph",ref:this._graphDiv})]})}}],[{key:"TimeFromXPosition",value:function(e,t,n,r){var i=r/e*(n-t);return i>n?i=n:i<t&&(i=t),i}}]),r}(t.Component),r2=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var i;(0,u.Z)(this,r),(i=n.call(this,e))._panel_resize_observer=void 0,i._graphDiv=void 0,i.times=void 0,i.xVals=void 0,i.yVals=void 0,i.clickHandler=function(){var e,t=document.querySelectorAll(".RobotCanvasCanvas");t.forEach((function(e){return e.classList.remove("selected")})),(t=document.querySelectorAll(".GraphPanel")).forEach((function(e){return e.classList.remove("selected")})),null===(e=i._graphDiv.current)||void 0===e||e.classList.add("selected"),i.props.robotSceneManager.setCurrUmapGraph(i.props.graph.id()),i.props.setUmapGraphOptionPanelActive()},i.fillGraphData.bind((0,c.Z)(i));var a=i.props.robotSceneManager;return i.state={counter:0,line_names:[],line_ids:[],line_colors:[],prev_times:{start:a.currStartTime(),end:a.currEndTime(),curr:a.currTime()},use_timeWarp:!1,color_map:new Map,currRobots:new Map,panelHeight:200,panelWidth:300,need_update:!0,graph_update:!1},i._graphDiv=(0,t.createRef)(),i.times=[],i.xVals=[],i.yVals=[],i}return(0,l.Z)(r,[{key:"onGraphUpdate",value:function(e){var t=this.state.graph_update;return e?(this.setState({graph_update:!1}),!1):t}},{key:"getAllArticulatedJointsPositions",value:function(e,t,n){var r,i=this.props.robotSceneManager,a=i.startTime(),o=i.endTime(),u=e.timeWarping();r=n&&u?u.timeWarpMap()[1]:YU.frameRange(a,o,20,2e3);var l,c=[],h=[],f=[],d=s(t.getArticuatedJointMap());try{for(d.s();!(l=d.n()).done;){var p=vr(l.value,2)[1],v=e.frameDataFor(t,r,p);f.push(v.jointAngles),h=v.times}}catch(x2){d.e(x2)}finally{d.f()}if(f.length>0)for(var m=0;m<f[0].length;m++){for(var g=[],y=0;y<f.length;y++)g.push(f[y][m]);c.push(g)}return[h,c]}},{key:"convertJointDataToUmap",value:function(e){return new t2.u({nNeighbors:30,minDist:.1,spread:.1}).fit(e)}},{key:"generateLineName",value:function(e){var t=vr(this.decomposeId(e),2),n=t[0],r=t[1],i=this.props.robotSceneManager.robotSceneById(n);return(null===i||void 0===i?void 0:i.name())+"_"+r}},{key:"decomposeUmapData",value:function(e){for(var t=[],n=[],r=0;r<e.length;r++)t.push(e[r][0]),n.push(e[r][1]);return[t,n]}},{key:"compareJointData",value:function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(Math.abs(e[n]-t[n])>.01)return!1;return!0}},{key:"filterUmapData",value:function(e,t){for(var n=1;n<e.length;n++)this.compareJointData(e[n-1],e[n])&&(t[n]=t[n-1]);return t}},{key:"filterJointData",value:function(e,t){for(var n=[],r=[],i=0;i<e.length;i++)0!==i&&this.compareJointData(e[i-1],e[i])||(n.push(e[i]),r.push(t[i]));return[n,r]}},{key:"fillGraphData",value:function(){var e=this.state,t=e.currRobots,n=e.color_map,r=[],i=[],a=[];this.xVals=[],this.yVals=[],this.times=[];var o,u=[],l=[],c=[],h=s(t);try{for(h.s();!(o=h.n()).done;){var f=vr(o.value,2),d=(f[0],vr(f[1],2)),v=d[0],m=d[1],g=vr(this.filterJointData(m,v),2),y=g[0],b=g[1];u=u.concat(y),l.push(b),p()(y.length===b.length),c.push(y.length)}}catch(x2){h.e(x2)}finally{h.f()}if(0!==u.length){var _,x=this.convertJointDataToUmap(u),w=0,S=0,M=s(t);try{for(M.s();!(_=M.n()).done;){var k=vr(_.value,2),T=k[0],E=vr(k[1],2),C=E[0];E[1];r.push(this.generateLineName(T)),i.push(T),a.push(n.get(T));var A=x.slice(w,w+c[S]),R=vr(this.decomposeUmapData(A),2),P=R[0],L=R[1];p()(P.length===c[S]),p()(L.length===c[S]);for(var D=0,N=[],I=[],O=[],U=0;U<C.length;U++)D+1<l[S].length&&C[U]>=l[S][D+1]&&D++,N.push(P[D]),I.push(L[D]),O.push(C[U]);this.xVals.push(N),this.yVals.push(I),this.times.push(C),w+=c[S],S++}}catch(x2){M.e(x2)}finally{M.f()}}this.props.graph.setLineNames(r),this.props.graph.setLineIds(i),this.props.graph.setLineColors(a),this.setState({line_names:r,line_colors:a,line_ids:i,need_update:!1})}},{key:"componentWillUnmount",value:function(){this._panel_resize_observer&&this._panel_resize_observer.disconnect()}},{key:"componentDidMount",value:function(){var e,t=this,n=document.querySelectorAll(".RobotCanvasCanvas");n.forEach((function(e){return e.classList.remove("selected")})),(n=document.querySelectorAll(".GraphPanel")).forEach((function(e){return e.classList.remove("selected")})),null===(e=this._graphDiv.current)||void 0===e||e.classList.add("selected"),this._panel_resize_observer=new ResizeObserver((function(e){t.setState({panelWidth:e[0].contentRect.width,panelHeight:.9*e[0].contentRect.height})})),this._graphDiv&&this._graphDiv.current&&this._panel_resize_observer.observe(this._graphDiv.current);var r,i=[],a=s(this.props.graph.lineIds());try{for(a.s();!(r=a.n()).done;){var o=r.value,u=vr(this.decomposeId(o),2),l=u[0]+"#"+u[1];this.changeLines(l,!0),i.push(l)}}catch(x2){a.e(x2)}finally{a.f()}}},{key:"componentDidUpdate",value:function(e){var t=this.props.graph.deleteLine();void 0!==t&&this.state.currRobots.has(t)&&(this.state.currRobots.delete(t),this.changeLines(t,!1),this.props.graph.setDeleteLine(void 0,void 0));var n=this.state,r=n.prev_times,i=(n.need_update,r.start!==this.props.robotSceneManager.currStartTime()||r.end!==this.props.robotSceneManager.currEndTime()),a=r.curr!==this.props.robotSceneManager.currTime();(i||a)&&this.setState({prev_times:{start:this.props.robotSceneManager.currStartTime(),end:this.props.robotSceneManager.currEndTime(),curr:this.props.robotSceneManager.currTime()}}),this.props.force_update!==e.force_update&&this.setState({need_update:!0})}},{key:"onCurrTimeChange",value:function(e){e<=this.props.robotSceneManager.currEndTime()&&e>=this.props.robotSceneManager.currStartTime()&&this.props.robotSceneManager.setCurrTime(e)}},{key:"onStartTimeChange",value:function(e){this.props.robotSceneManager.currTime()<e&&this.props.robotSceneManager.setCurrTime(e),this.props.robotSceneManager.currEndTime()>=e&&this.props.robotSceneManager.setCurrStartTime(e)}},{key:"onEndTimeChange",value:function(e){this.props.robotSceneManager.currTime()>e&&this.props.robotSceneManager.setCurrTime(e),this.props.robotSceneManager.currStartTime()<=e&&this.props.robotSceneManager.setCurrEndTime(e)}},{key:"changeLines",value:function(e,t){if(!this.state.currRobots.has(e)){var n=vr(this.decomposeId(e),2),r=n[0],i=n[1],a=this.props.robotSceneManager,o=a.robotSceneById(r);if(void 0!==o){a.isActiveRobotScene(o)||a.activateRobotScene(o);var s=o.getRobotByName(i);if(void 0!==s){if(t){var u=vr(this.getAllArticulatedJointsPositions(o,s),2),l=u[0],c=u[1];this.state.currRobots.set(e,[l,c]),this.state.color_map.set(e,this.props.graph.getColor())}else this.state.currRobots.delete(e),this.state.color_map.delete(e);this.fillGraphData()}}}}},{key:"dragOverHandler",value:function(e){e.preventDefault()}},{key:"dropHandler",value:function(e){e.preventDefault();e.target;var t=e.dataTransfer.getData("text/plain");this.changeLines(t,!0)}},{key:"decomposeId",value:function(e){var t=vr(e.split("#"),2);return[t[0],t[1]]}},{key:"decomposeDragButtonId",value:function(e){var t=vr(e.split("&"),2),n=t[0],r=t[1],i=vr(n.split("#"),2);return[i[0],i[1],r]}},{key:"render",value:function(){var e=this,t=this.state,n=t.line_names,r=t.line_ids,i=t.line_colors,a=(t.use_timeWarp,t.color_map,t.prev_times),o=t.panelHeight,s=t.panelWidth;this.props.isTimeWarp;return(0,rr.jsxs)("div",{className:"GraphPanel",ref:this._graphDiv,onDrop:this.dropHandler.bind(this),onDragOver:this.dragOverHandler.bind(this),onClick:this.clickHandler.bind(this),style:{backgroundColor:this.props.graph.backgroundColor()},children:[(0,rr.jsxs)("div",{className:"LegendMessage",children:[(0,rr.jsx)($Y,{buttonValue:"Legend",className:"Legend",title:"Click and drag to open the legend",getParentDockLayout:this.props.getParentDockLayout,onDragStart:function(){return["UmapLegend&".concat(Cb(4),"&").concat(e.props.graph.id()),function(e){}]}}),(0,rr.jsx)("button",{id:"open-popup",className:"OpenPop",onClick:function(){return lr.setPopupHelpPage(Xn.UmapGraphPanel)},children:(0,rr.jsx)(qn,{className:"Icon",icon:$n})})]}),(0,rr.jsx)(n2,{times:this.times,xVals:this.xVals,yVals:this.yVals,startTime:a.start,endTime:a.end,currTime:a.curr,isTimeWarp:!1,line_names:n,line_colors:i,width:s,height:o,line_ids:r,selected:this.props.robotSceneManager.getCurrUmapGraph()===this.props.graph,lineWidth:this.props.graph.lineWidth(),axisColor:this.props.graph.axisColor(),onGraphUpdate:this.onGraphUpdate.bind(this),onCurrChange:this.onCurrTimeChange.bind(this),onStartChange:this.onStartTimeChange.bind(this),onEndChange:this.onEndTimeChange.bind(this)})]})}}]),r}(t.Component),i2=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var i;return(0,u.Z)(this,r),(i=n.call(this,e))._graphDiv=void 0,i._panel_resize_observer=void 0,i.w=void 0,i.h=void 0,i._graphDiv=(0,t.createRef)(),i.drawGraph.bind((0,c.Z)(i)),i.state={margin:{top:20,right:60,bottom:40,left:60},prev_lines:new Map,line_names:i.props.graph.lineNames(),line_ids:i.props.graph.lineIds(),line_colors:i.props.graph.lineColors(),panelHeight:0,panelWidth:294},i.w=0,i.h=0,i}return(0,l.Z)(r,[{key:"componentWillUnmount",value:function(){this._panel_resize_observer&&this._panel_resize_observer.disconnect()}},{key:"componentDidMount",value:function(){var e=this;this._panel_resize_observer=new ResizeObserver((function(t){e.setState({panelWidth:t[0].contentRect.width,panelHeight:t[0].contentRect.height}),e._graphDiv.current&&e._graphDiv.current.children.length>0&&e._graphDiv.current.removeChild(e._graphDiv.current.children[0]);var n=e.drawGraph(t[0].contentRect.width,t[0].contentRect.height);n&&pO(e._graphDiv.current).append("svg").attr("width",e.w).attr("height",e.h).node().appendChild(n)})),this._graphDiv&&this._graphDiv.current&&this._panel_resize_observer.observe(this._graphDiv.current),this._graphDiv.current&&this._graphDiv.current.children.length>0&&this._graphDiv.current.removeChild(this._graphDiv.current.children[0]);var t=this.drawGraph();t&&pO(this._graphDiv.current).append("svg").attr("width",this.w).attr("height",this.h).node().appendChild(t)}},{key:"componentDidUpdate",value:function(e){var t=!Zb().isEqual(new Set(this.state.line_colors),new Set(this.props.graph.lineColors()))||this.state.line_colors.length!==this.props.graph.lineColors().length,n=!Zb().isEqual(new Set(this.state.line_names),new Set(this.props.graph.lineNames()))||this.state.line_names.length!==this.props.graph.lineNames().length;if(t||n){this._graphDiv.current&&this._graphDiv.current.children.length>0&&this._graphDiv.current.removeChild(this._graphDiv.current.children[0]),this.setState({line_names:this.props.graph.lineNames(),line_ids:this.props.graph.lineIds(),line_colors:this.props.graph.lineColors()});var r=this.drawGraph();r&&pO(this._graphDiv.current).append("svg").attr("width",this.w).attr("height",this.h).node().appendChild(r)}}},{key:"createOnClickHandler",value:function(e,t){var n=this;return function(){n.props.graph.setDeleteLine(e,t),n.props.updateLegendState(!0)}}},{key:"drawGraph",value:function(e,t){var n=this,r=this.props.graph,i=r.lineNames(),a=r.lineIds(),o=r.lineColors(),s=this.state,u=(s.margin,s.prev_lines),l=s.panelHeight,c=s.panelWidth,h=void 0===e?c:e,f=void 0===t?l:t,d=h,p=pO(this._graphDiv.current).append("svg").remove().attr("width",h).attr("height",f).append("g"),v=5;v+=18;for(var m=function(e){p.append("circle").attr("fill",o[e]).attr("cx",15).attr("cy",v).attr("r",8);var t=i[e],r=.99*d-16;p.append("foreignObject").attr("x",0+r).attr("y",v-8).attr("width",15).attr("height",17).attr("class","white-icon").style("cursor","pointer").on("click",n.createOnClickHandler(a[e],o[e])).html('\n  <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512">\n    \x3c!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --\x3e\n    <path d="M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z"/>\n  </svg>\n');var s=.9*d-16-16,u=20*Math.ceil(7*t.length/s),l=p.append("foreignObject").attr("x",25).attr("y",v-8).attr("width",s).attr("height",u);a[e],l.append("xhtml:div").style("font-weight",600).style("font-size","13px").style("max-width","100%").style("color",o[e]).html('<p style="word-wrap: break-word; margin: 0;">'.concat(t,"</p>")),v+=u+5},g=0;g<i.length;g++)m(g);return this.w=h,this.h=50*(i.length+1)+100,this.setState({prev_lines:u}),p.node()}},{key:"render",value:function(){return(0,rr.jsx)("div",{children:(0,rr.jsx)("div",{className:"Legend",ref:this._graphDiv})})}}]),r}(t.Component),a2="Time Bar",o2="Load&Save",s2="Home",u2="Selection",l2="Graph Options",c2="Scene Options",h2="Robot Options",f2=Cb(4),d2="Graph&".concat(f2,"&motion"),p2="Quaternion Options",v2="UMAP Options",m2=t.createContext(),g2=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(e){var i;(0,u.Z)(this,r),(i=n.call(this,e))._layoutRef=void 0,i.hasTabById=function(e){var t=i._layoutRef.current;return!!t&&void 0!==t.find(e)},i.removeTabById=function(e){var t=i._layoutRef.current;if(t){var n=t.find(e);void 0!==n&&t.dockMove(n,null,"remove")}},i.robotSceneIdParts=function(e){var t,n=e.indexOf("&"),r=e.slice(0,n),i=e.slice(n+1,e.length),a=void 0;if(-1!==(n=i.indexOf("&"))?(a=i.slice(0,n),t=i.slice(n+1,i.length)):t=i,void 0===a)throw new Error("RobotScene with undefined ID in DockLayout");return[r,a,t]},i.getDefaultLayout=function(){var e="vertical";return{dockbox:{mode:e,children:[{mode:"horizontal",children:[{tabs:[{id:u2}]},{size:700,tabs:[{id:s2}]},{size:300,mode:e,children:[{tabs:[{id:o2},{id:c2},{id:h2},{id:l2},{id:p2},{id:v2}]},{size:250,tabs:[{id:d2}]}]}]},{size:30,tabs:[{id:a2}]}]}}},i.getLayout=function(){var e=i._layoutRef.current;return e||void 0},i.missingTab=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Missing Tab";return setTimeout(i.removeTabById,0,e),(0,rr.jsx)("div",{children:t},e)},i.tabWrap=function(e){return function(t){var n=t.id,r=e(n);return void 0!==r?r:(setTimeout(i.removeTabById,0,n),{id:n,closable:!0,cached:!0,title:"Missing Tab",content:(0,rr.jsx)("div",{children:"Missing Tab Data"},"Undefined Tab!")})}},i.loadTab=function(e){if(void 0===e)return console.error("Undefined ID"),{closable:!0,title:"Undefined Tab",content:(0,rr.jsx)("div",{},"Undefined Tab!")};if(e===a2)return{id:a2,title:a2,cached:!0,content:(0,rr.jsx)(m2.Consumer,{children:function(e){return(0,rr.jsx)(QW,{robotSceneManager:e.robotSceneManager,robotScene:e.robotScene,event_x:i.state.event_x,global:!0})}})};if(e.startsWith("TimeWarpTimeBar")){var t=e.substring("TimeWarpTimeBar".length),n=i.props.robotSceneManager.robotSceneById(t),r=null===n||void 0===n?void 0:n.name();return{id:e,title:void 0===r?"Animate Timewarp":r+" Time Bar",cached:!0,closable:!0,content:(0,rr.jsx)(m2.Consumer,{children:function(e){return(0,rr.jsx)(QW,{robotSceneManager:e.robotSceneManager,robotScene:e.robotScene,event_x:i.state.event_x,currTimeBar_prop:"double",global:!1,targetSceneId:t})}})}}if(e===o2)return{id:o2,title:o2,content:(0,rr.jsx)(m2.Consumer,{children:function(e){return(0,rr.jsx)(C1,{robotSceneManager:e.robotSceneManager,animationManager:e.robotScene.animationManager(),onSaveLayout:i.onSaveLayout.bind((0,c.Z)(i)),onRestoreLayout:i.onRestoreLayout.bind((0,c.Z)(i))})}})};if(e===s2)return{id:s2,title:s2,content:i.createHomeTab()};if(e===l2){var a=i.props.robotSceneManager;return{id:l2,title:l2,content:(0,rr.jsx)(m2.Consumer,{children:function(e){return(0,rr.jsx)(j1,{robotSceneManager:a,updateGraphPropertyPanelState:i.updateGraphPropertyPanelState.bind((0,c.Z)(i)),filter_prop:i.state.filter,getParentDockLayout:e.getParentDockLayout,forceUpdateTabNames:i.forceUpdateTabNames.bind((0,c.Z)(i))})}})}}if(e===c2){i.props.robotSceneManager;return{id:c2,title:c2,content:(0,rr.jsx)(m2.Consumer,{children:function(e){return(0,rr.jsx)(T1,{getParentDockLayout:e.getParentDockLayout,robotSceneManager:e.robotSceneManager,robotScene:e.robotScene,animationManager:e.robotScene.animationManager(),addNewTimeWarpTimeBar:i.addNewTimeWarpTimeBar.bind((0,c.Z)(i)),forceUpdateTabNames:i.forceUpdateTabNames.bind((0,c.Z)(i))})}})}}if(e===h2){var o=i.props.robotSceneManager;return{id:h2,title:h2,content:(0,rr.jsx)(m2.Consumer,{children:function(e){return(0,rr.jsx)(q1,{robotSceneManager:o,getParentDockLayout:e.getParentDockLayout,animationManager:e.robotScene.animationManager()})}})}}if(e===p2){var s=i.props.robotSceneManager;return{id:p2,title:p2,content:(0,rr.jsx)(m2.Consumer,{children:function(e){return(0,rr.jsx)(J1,{robotSceneManager:s,getParentDockLayout:e.getParentDockLayout,forceUpdateTabNames:i.forceUpdateTabNames.bind((0,c.Z)(i)),currQuaternionSpaceScene:s.getCurrQuaternionSpaceScene()})}})}}if(e===v2){var u=i.props.robotSceneManager;return{id:v2,title:v2,content:(0,rr.jsx)(m2.Consumer,{children:function(e){return(0,rr.jsx)(e2,{robotSceneManager:u,getParentDockLayout:e.getParentDockLayout,currSelectedGraph:u.getCurrUmapGraph(),forceUpdateTabNames:i.forceUpdateTabNames.bind((0,c.Z)(i))})}})}}if(e===u2)return{id:u2,title:u2,content:(0,rr.jsx)(m2.Consumer,{children:function(e){return(0,rr.jsx)(G1,{robotSceneManager:e.robotSceneManager,getParentDockLayout:e.getParentDockLayout,setSceneOptionPanelActive:i.setSceneOptionPanelActive.bind((0,c.Z)(i)),setRobotOptionPanelActive:i.setRobotOptionPanelActive.bind((0,c.Z)(i))})}})};if(e===d2){var l=vr(e.split("&"),3),h=l[1],f=(l[2],i.props.robotSceneManager),d=f.getGraphById(h);return void 0===d&&(d=new sF(h,!1,!1),f.addGraph(d),f.setCurrGraph(d.id())),{id:e,closable:!0,cached:!0,title:d.name(),content:(0,rr.jsx)(m2.Consumer,{children:function(e){if(void 0!==d)return(0,rr.jsx)(F1,{robotSceneManager:f,getParentDockLayout:e.getParentDockLayout,eventName:i.state.eventName,add:i.state.add,filter_prop:i.state.filter,is_part_changed:i.state.is_part_changed,force_update:i.state.force_update,graph:d,graph_update:i.state.graph_update,setGraphOptionPanelActive:i.setGraphOptionPanelActive.bind((0,c.Z)(i))},h)}})}}if(e.startsWith("Graph")){var p=vr(e.split("&"),3),v=p[1],m=(p[2],i.props.robotSceneManager),g=m.getGraphById(v);return void 0===g&&(g=new sF(v,!1,!1),m.addGraph(g),m.setCurrGraph(g.id())),{id:e,closable:!0,cached:!0,title:g.name(),content:(0,rr.jsx)(m2.Consumer,{children:function(e){if(void 0!==g)return(0,rr.jsx)(F1,{robotSceneManager:m,getParentDockLayout:e.getParentDockLayout,eventName:i.state.eventName,add:i.state.add,filter_prop:i.state.filter,is_part_changed:i.state.is_part_changed,force_update:i.state.force_update,graph:g,graph_update:i.state.graph_update,setGraphOptionPanelActive:i.setGraphOptionPanelActive.bind((0,c.Z)(i))},v)}})}}if(e.startsWith("DifferenceGraph")){var y=vr(e.split("&"),3),b=y[1],_=(y[2],i.props.robotSceneManager),x=_.getGraphById(b);return void 0===x&&(x=new sF(b,!0,!1),_.addGraph(x),_.setCurrGraph(x.id())),{id:e,closable:!0,cached:!0,title:x.name(),content:(0,rr.jsx)(m2.Consumer,{children:function(e){if(void 0!==x)return(0,rr.jsx)(z1,{robotSceneManager:_,getParentDockLayout:e.getParentDockLayout,is_part_changed:i.state.is_part_changed,eventName:i.state.eventName,add:i.state.add,filter_prop:i.state.filter,force_update:i.state.force_update,graph:x,setGraphOptionPanelActive:i.setGraphOptionPanelActive.bind((0,c.Z)(i))},b)}})}}if(e.startsWith("TimeWarpedGraph")){var w=vr(e.split("&"),4),S=w[1],M=w[2],k=(w[3],i.props.robotSceneManager),T=k.robotSceneById(M);if(void 0===T)return;var E=k.getGraphById(S);return void 0===E&&(E=new sF(S,!1,!0),k.addGraph(E)),{id:e,closable:!0,cached:!0,title:E.name(),content:(0,rr.jsx)(m2.Consumer,{children:function(e){if(void 0!==E)return(0,rr.jsx)(X1,{robotSceneManager:k,robotScene:T,isTimeWarp:!0,force_update:i.state.force_update,getParentDockLayout:e.getParentDockLayout,graph:E,setGraphOptionPanelActive:i.setGraphOptionPanelActive.bind((0,c.Z)(i))},S)}})}}if(e.startsWith("UmapGraph")){var C=vr(e.split("&"),3),A=C[1],R=C[2],P=i.props.robotSceneManager,L=P.getUmapGraphById(A);return void 0===L&&(L=new lF(A),P.addUmapGraph(L),P.setCurrUmapGraph(A)),{id:e,closable:!0,cached:!0,title:L.name(),content:(0,rr.jsx)(m2.Consumer,{children:function(e){if(void 0!==L)return(0,rr.jsx)(r2,{robotSceneManager:P,isTimeWarp:"warp"===R,getParentDockLayout:e.getParentDockLayout,force_update:i.state.force_update,graph:L,setUmapGraphOptionPanelActive:i.setUmapGraphOptionPanelActive.bind((0,c.Z)(i))},A)}})}}if(e.startsWith("LineGraphLegend")){var D=vr(e.split("&"),3),N=(D[1],D[2]),I=i.props.robotSceneManager.getGraphById(N);if(void 0===I)return;return{id:e,closable:!0,cached:!0,title:"Legend of "+I.name(),content:(0,rr.jsx)(m2.Consumer,{children:function(e){if(void 0!==I)return(0,rr.jsx)(Y1,{graph:I,updateLegendState:i.updateLegendState.bind((0,c.Z)(i))})}})}}if(e.startsWith("SceneLegend")){var O=vr(e.split("&"),3),U=(O[1],O[2]),F=i.props.robotSceneManager,z=F.robotSceneById(U);return{id:e,closable:!0,cached:!0,title:"Legend of "+(null===z||void 0===z?void 0:z.name()),content:(0,rr.jsx)(m2.Consumer,{children:function(e){if(void 0!==z)return(0,rr.jsx)(K1,{robotSceneManager:F,robotScene:z})}})}}if(e.startsWith("QuaternionSpaceLegend")){var B=vr(e.split("&"),3),V=(B[1],B[2]),G=i.props.robotSceneManager,j=G.getQuaternionSpaceSceneById(V);if(void 0===j)return;return{id:e,closable:!0,cached:!0,title:"Legend of "+(null===j||void 0===j?void 0:j.name()),content:(0,rr.jsx)(m2.Consumer,{children:function(e){if(void 0!==j)return(0,rr.jsx)($1,{robotSceneManager:G,quaternionSpaceScene:j})}})}}if(e.startsWith("UmapLegend")){var H=vr(e.split("&"),3),W=(H[1],H[2]),Z=i.props.robotSceneManager.getUmapGraphById(W);if(void 0===Z)return;return{id:e,closable:!0,cached:!0,title:"Legend of "+Z.name(),content:(0,rr.jsx)(m2.Consumer,{children:function(e){if(void 0!==Z)return(0,rr.jsx)(i2,{graph:Z,updateLegendState:i.updateLegendState.bind((0,c.Z)(i))})}})}}if(e.startsWith("RobotScene")){var q=vr(i.robotSceneIdParts(e),3),X=q[1],Y=q[2],K=i.props.robotSceneManager,J=K.robotSceneById(Y);if(void 0===J)return;var Q=J,$=e;return{id:e,closable:!0,cached:!0,title:J.name(),content:(0,rr.jsx)(m2.Consumer,{children:function(){return K.hasManagedRobotScene(Q)?(0,rr.jsx)(N1,{allowSelecting:!0,robotScene:Q,robotSceneManager:K,setSceneOptionPanelActive:i.setSceneOptionPanelActive.bind((0,c.Z)(i)),setRobotOptionPanelActive:i.setRobotOptionPanelActive.bind((0,c.Z)(i))},X):i.missingTab($,"Missing Scene")}})}}if(e.startsWith("QuaternionSpaceScene")){var ee=vr(e.split("&"),3),te=ee[1],ne=(ee[2],i.props.robotSceneManager),re=ne.getQuaternionSpaceSceneById(te);return void 0===re&&(re=new aF(ne,te),ne.setCurrQuaternionSpaceScene(te)),{id:e,closable:!0,cached:!0,title:re.name(),content:(0,rr.jsx)(m2.Consumer,{children:function(){if(void 0!==re)return(0,rr.jsx)(Q1,{allowSelecting:!0,quaternionSpaceScene:re,robotSceneManager:ne,setQuaternionSceneOptionPanelActive:i.setQuaternionSceneOptionPanelActive.bind((0,c.Z)(i))},te)}})}}return console.error('Unknown tab with id "'.concat(e,'"')),{id:e,closable:!0,title:"Unknown Tab",content:i.missingTab(e,"Missing Tab")}},i.onLayoutChange=function(e,t,n){if(e!==i.state.layoutBase){if(null!==t&&void 0!==t&&t.startsWith("RobotScene")&&"remove"===n){var r=vr(i.robotSceneIdParts(t),3)[2],a=i.props.robotSceneManager,o=a.robotSceneById(r);o&&a.deactivateRobotScene(o)}if(null!==t&&void 0!==t&&(t.startsWith("Graph")||t.startsWith("DifferenceGraph")||t===d2)&&"remove"===n){var u=vr(t.split("&"),3),l=u[1],c=(u[2],i.props.robotSceneManager),h=c.getGraphById(l);if(void 0!==h){c.removeGraph(l);var f,d=s(h.lineIds());try{for(d.s();!(f=d.n()).done;){var p=f.value;F1.removeRobotPartFromGraph(p,i.props.robotSceneManager)}}catch(x2){d.e(x2)}finally{d.f()}}}if(null!==t&&void 0!==t&&t.startsWith("QuaternionSpaceScene")&&"remove"===n){var v=vr(t.split("&"),3),m=v[1];v[2];i.props.robotSceneManager.removeQuaternionSpaceScene(m)}i.setState({layoutBase:e})}},i._layoutRef=t.createRef(),i.state={layoutBase:i.getDefaultLayout(),eventName:[],add:!0,clear:!1,refresh:!1,line_names:[],times:[],values:[],line_ids:[],legend:!0,need_update:!0,filter:0,show_diff:!1,diff_line_ids:[],is_part_changed:new Map,clear_options:!1,event_x:0,time_warp_time_bars:[],force_update:!1,graph_update:!1};var a=new sF(f2,!1,!1);return i.props.robotSceneManager.addGraph(a),i.props.robotSceneManager.setCurrGraph(f2),i.drag=i.drag.bind((0,c.Z)(i)),i.onRestoreLayout=i.onRestoreLayout.bind((0,c.Z)(i)),i}return(0,l.Z)(r,[{key:"addNewTimeWarpTimeBar",value:function(e){var t,n="TimeWarpTimeBar"+e,r=Mr({},this.state.layoutBase);null===(t=r.dockbox.children[1].tabs)||void 0===t||t.push({id:n}),this.setState({layoutBase:r})}},{key:"onSaveLayout",value:function(){var e=this.getLayout();return null===e||void 0===e?void 0:e.saveLayout()}},{key:"onRestoreLayout",value:function(e){var t;(console.log("restore layout"),void 0!==this.getLayout()&&void 0!==e)&&(console.log(e),null===(t=this._layoutRef.current)||void 0===t||t.loadLayout(e),this.setState({layoutBase:e}))}},{key:"setSceneOptionPanelActive",value:function(){var e;null===(e=this.getLayout())||void 0===e||e.updateTab(c2,null,!0)}},{key:"setRobotOptionPanelActive",value:function(){var e;null===(e=this.getLayout())||void 0===e||e.updateTab(h2,null,!0)}},{key:"setGraphOptionPanelActive",value:function(){var e;null===(e=this.getLayout())||void 0===e||e.updateTab(l2,null,!0)}},{key:"setQuaternionSceneOptionPanelActive",value:function(){var e;null===(e=this.getLayout())||void 0===e||e.updateTab(p2,null,!0)}},{key:"setUmapGraphOptionPanelActive",value:function(){var e;null===(e=this.getLayout())||void 0===e||e.updateTab(v2,null,!0)}},{key:"forceUpdateTabNames",value:function(){var e=Mr({},this.state.layoutBase);this.setState({layoutBase:e,force_update:!this.state.force_update})}},{key:"updateLegendState",value:function(e){this.setState({graph_update:void 0===e?this.state.graph_update:e})}},{key:"updateGraphPropertyPanelState",value:function(e,t,n,r,i,a){this.setState({eventName:void 0===e?this.state.eventName:e,add:void 0===t?this.state.add:t,filter:void 0===n?this.state.filter:n,legend:void 0===i?this.state.legend:i,clear_options:void 0===a?this.state.clear_options:a})}},{key:"onClickImage",value:function(e){this.props.robotSceneManager.loadSessionFromURL(e,this.onRestoreLayout)}},{key:"createHomeTab",value:function(){var e=this;return(0,rr.jsx)("div",{className:"HomeTab",children:(0,rr.jsxs)("div",{style:{textAlign:"center"},children:[(0,rr.jsx)("h1",{children:"\ud83d\udc4b Welcome to Motion Comparator"}),(0,rr.jsx)("br",{}),(0,rr.jsx)("p",{children:" Motion Comparator helps roboticists "}),(0,rr.jsx)("p",{children:" visualize \ud83d\udc40, understand \ud83d\udca1, compare \ud83d\udd0d, and communiate \ud83d\udcac "}),(0,rr.jsx)("p",{children:" robot motions. "}),(0,rr.jsx)("br",{}),(0,rr.jsxs)("div",{className:"PopUpGroup",style:{justifyContent:"center",alignItems:"center"},children:[(0,rr.jsx)("h3",{children:"Click on the help icon to get started"}),(0,rr.jsx)("button",{id:"open-popup",className:"OpenPop",onClick:function(){return lr.setPopupHelpPage(Xn.Home)},children:(0,rr.jsx)(qn,{className:"Icon",icon:$n})})]}),(0,rr.jsx)("br",{}),(0,rr.jsx)("h3",{children:"Also explore the examples below "}),(0,rr.jsxs)("div",{className:"ExampleImageGroup",children:[(0,rr.jsx)("img",{src:"https://raw.githubusercontent.com/motion-comparator/examples/main/workspaces/panda_pick_and_place/panda_pick_and_place.png",className:"ExampleImage",alt:"Panda Pick and Place"}),(0,rr.jsx)("div",{className:"ExampleImageOverlay",onClick:function(){return e.onClickImage("https://raw.githubusercontent.com/motion-comparator/examples/main/workspaces/panda_pick_and_place/panda_pick_and_place.json")},children:(0,rr.jsx)("div",{className:"ExampleImageOverlayText",children:"Pick and Place Motions of Panda Robot "})})]}),(0,rr.jsxs)("div",{className:"ExampleImageGroup",children:[(0,rr.jsx)("img",{src:"https://raw.githubusercontent.com/motion-comparator/examples/main/workspaces/mico_legible/mico_legible.png",className:"ExampleImage",alt:"Mico Legible"}),(0,rr.jsx)("div",{className:"ExampleImageOverlay",onClick:function(){return e.onClickImage("https://raw.githubusercontent.com/motion-comparator/examples/main/workspaces/mico_legible/mico_legible.json")},children:(0,rr.jsx)("div",{className:"ExampleImageOverlayText",children:"Legible Motions of Mico Robot "})})]}),(0,rr.jsxs)("div",{className:"ExampleImageGroup",children:[(0,rr.jsx)("img",{src:"https://raw.githubusercontent.com/motion-comparator/examples/main/workspaces/spot_arm_sweep/spot_arm_sweep.png",className:"ExampleImage",alt:"Pick and Place"}),(0,rr.jsx)("div",{className:"ExampleImageOverlay",onClick:function(){return e.onClickImage("https://raw.githubusercontent.com/motion-comparator/examples/main/workspaces/spot_arm_sweep/spot_arm_sweep.json")},children:(0,rr.jsx)("div",{className:"ExampleImageOverlayText",children:"Sweeping Motions of Spot Robot "})})]}),(0,rr.jsxs)("div",{className:"ExampleImageGroup",children:[(0,rr.jsx)("img",{src:"https://raw.githubusercontent.com/motion-comparator/examples/main/workspaces/sawyer_teleop/sawyer_teleop.png",className:"ExampleImage",alt:"Pick and Place"}),(0,rr.jsx)("div",{className:"ExampleImageOverlay",onClick:function(){return e.onClickImage("https://raw.githubusercontent.com/motion-comparator/examples/main/workspaces/sawyer_teleop/sawyer_teleop.json")},children:(0,rr.jsx)("div",{className:"ExampleImageOverlayText",children:"Teleoperation of Sawyer Robot "})})]}),(0,rr.jsx)("br",{}),(0,rr.jsx)("br",{}),(0,rr.jsx)("a",{href:"https://github.com/motion-comparator/MotionComparator",target:"_blank",rel:"noopener noreferrer",children:(0,rr.jsx)("img",{src:"https://raw.githubusercontent.com/tandpfun/skill-icons/main/icons/Github-Light.svg",className:"GithubIcon",alt:"Github"})})]})})}},{key:"drag",value:function(e){var t=e.target.className;"string"===typeof t&&t.includes("-option")||this.setState({event_x:e.pageX})}},{key:"render",value:function(){var e=this.props.robotSceneManager,t=this.props.robotSceneManager.currRobotScene(!1),n=t.selectedRobot();this._layoutRef.current;return(0,rr.jsx)("div",{className:"RobotWorkspace",onMouseMove:this.drag,children:(0,rr.jsx)(m2.Provider,{value:{robotSceneManager:e,robotScene:t,selectedRobot:n,getParentDockLayout:this.getLayout},children:(0,rr.jsx)(jW,{ref:this._layoutRef,layout:this.state.layoutBase,onLayoutChange:this.onLayoutChange,loadTab:this.tabWrap(this.loadTab)})})})}}]),r}(t.Component),y2=function(e){(0,h.Z)(r,e);var n=(0,f.Z)(r);function r(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,u.Z)(this,r),(e=n.call(this,i))._disallowUpdateUI=void 0,e._workspaceRef=void 0,e.goToPage=e.goToPage.bind((0,c.Z)(e)),e.currPage=e.currPage.bind((0,c.Z)(e)),e.href=e.href.bind((0,c.Z)(e)),e.updateUI=e.updateUI.bind((0,c.Z)(e)),e.error=e.error.bind((0,c.Z)(e)),e._disallowUpdateUI=0;var a,o,s=new fF,l=e.href(),h=l.split("?");if(1===h.length)a=ur.BUILD_PAGE;else if(2===h.length){a=ur.BUILD_PAGE;var f=h[1];o=f}else a=ur.BUILD_PAGE,e.warn("More than one question mark \"?\" in this page's URL. Did you mean to go to the view/playback page instead? If so, include only 1 question mark at the end of the website's url and put the url to the json of the scene you want to go to after it.");return e.state={currPageName:a,robotSceneManager:s,jsonURL:o,uiUpdateCnt:0,currPopupHelpPage:{page:Xn.None},prev_times:{startTime:s.startTime(),endTime:s.endTime()}},e._workspaceRef=t.createRef(),e}return(0,l.Z)(r,[{key:"recalculateTimeWarping",value:function(){var e,t=s(this.state.robotSceneManager.allManagedRobotScenes());try{for(t.s();!(e=t.n()).done;){var n=e.value;if(n.isTimeWarping()){var r=n.currTimeWarpBase();n.setTimeWarpBase(void 0),n.setTimeWarpBase(r)}}}catch(x2){t.e(x2)}finally{t.f()}}},{key:"robotSceneManager",value:function(){return this.state.robotSceneManager}},{key:"addAnimationTable",value:function(e){this.state.robotSceneManager.addAnimationTable(e)}},{key:"removeAnimationTable",value:function(e){this.state.robotSceneManager.removeAnimationTable(e)}},{key:"renderScenes",value:function(){var e;null===(e=this.state.robotSceneManager.currRobotScene())||void 0===e||e.render()}},{key:"href",value:function(){return window.location.href}},{key:"goToPage",value:function(e){this.setState({currPageName:e})}},{key:"currPage",value:function(){return this.state.currPageName}},{key:"error",value:function(e){console.error(e)}},{key:"warn",value:function(e){console.warn(e)}},{key:"popupHelpPage",value:function(){return this.state.currPopupHelpPage}},{key:"setPopupHelpPage",value:function(e){var t="string"===typeof e?{page:e}:e;this.setState({currPopupHelpPage:t})}},{key:"updateUI",value:function(){this._disallowUpdateUI<=0&&this.setState({uiUpdateCnt:(this.state.uiUpdateCnt+1)%1e9}),this._disallowUpdateUI<0&&console.warn("disallowUpdateUI is less than 0!")}},{key:"allowUpdateUI",value:function(){this._disallowUpdateUI+=1}},{key:"disallowUpdateUI",value:function(){this._disallowUpdateUI-=1}},{key:"componentDidMount",value:function(){var e=this;if(lr.setApp(this),this.state.jsonURL){var t,n=this.state.jsonURL;null===(t=this.state.robotSceneManager.currRobotScene())||void 0===t||t.runOnce("Load:".concat(n),(function(){var t;e.state.robotSceneManager.loadSessionFromURL(n,null===(t=e._workspaceRef.current)||void 0===t?void 0:t.onRestoreLayout)}))}}},{key:"componentDidUpdate",value:function(){var e=this.state.prev_times,t=e.startTime,n=e.endTime,r=this.state.robotSceneManager,i=[r.startTime(),r.endTime()],a=i[0],o=i[1];t===a&&n===o||(this.recalculateTimeWarping(),this.setState({prev_times:{startTime:a,endTime:o}}))}},{key:"render",value:function(){return(0,rr.jsxs)("div",{className:"App",children:[(0,rr.jsx)("div",{className:"BuildPage",children:(0,rr.jsx)(g2,{ref:this._workspaceRef,robotSceneManager:this.state.robotSceneManager})}),ir(this.state.currPopupHelpPage)]})}}]),r}(t.Component),b2=function(e){e&&e instanceof Function&&n.e(787).then(n.bind(n,787)).then((function(t){var n=t.getCLS,r=t.getFID,i=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),r(e),i(e),a(e),o(e)}))};i.createRoot(document.getElementById("root")).render((0,rr.jsx)(t.StrictMode,{children:(0,rr.jsx)(y2,{})})),b2()}()}();
//# sourceMappingURL=main.5851a392.js.map